{"home.repos.pwc.inspect_result.nikhil-iyer-97_wide-minima-density-hypothesis.None.knee_lr_schedule.KneeLRScheduler.__init__": [[6, 23], ["knee_lr_schedule.KneeLRScheduler.get_lr", "isinstance", "TypeError", "type"], "methods", ["home.repos.pwc.inspect_result.nikhil-iyer-97_wide-minima-density-hypothesis.None.knee_lr_schedule.KneeLRScheduler.get_lr"], ["    ", "def", "__init__", "(", "self", ",", "optimizer", ",", "peak_lr", ",", "warmup_steps", "=", "0", ",", "explore_steps", "=", "0", ",", "total_steps", "=", "0", ")", ":", "\n", "        ", "self", ".", "optimizer", "=", "optimizer", "\n", "self", ".", "peak_lr", "=", "peak_lr", "\n", "self", ".", "warmup_steps", "=", "warmup_steps", "\n", "self", ".", "explore_steps", "=", "explore_steps", "\n", "self", ".", "total_steps", "=", "total_steps", "\n", "self", ".", "decay_steps", "=", "self", ".", "total_steps", "-", "(", "self", ".", "explore_steps", "+", "self", ".", "warmup_steps", ")", "\n", "self", ".", "current_step", "=", "1", "\n", "\n", "assert", "self", ".", "decay_steps", ">=", "0", "\n", "\n", "for", "param_group", "in", "self", ".", "optimizer", ".", "param_groups", ":", "\n", "            ", "param_group", "[", "'lr'", "]", "=", "self", ".", "get_lr", "(", "self", ".", "current_step", ")", "\n", "\n", "", "if", "not", "isinstance", "(", "self", ".", "optimizer", ",", "Optimizer", ")", ":", "\n", "            ", "raise", "TypeError", "(", "'{} is not an Optimizer'", ".", "format", "(", "\n", "type", "(", "self", ".", "optimizer", ")", ".", "__name__", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.nikhil-iyer-97_wide-minima-density-hypothesis.None.knee_lr_schedule.KneeLRScheduler.get_lr": [[24, 32], ["max"], "methods", ["None"], ["", "", "def", "get_lr", "(", "self", ",", "global_step", ")", ":", "\n", "        ", "if", "global_step", "<=", "self", ".", "warmup_steps", ":", "\n", "            ", "return", "self", ".", "peak_lr", "*", "global_step", "/", "self", ".", "warmup_steps", "\n", "", "elif", "global_step", "<=", "(", "self", ".", "explore_steps", "+", "self", ".", "warmup_steps", ")", ":", "\n", "            ", "return", "self", ".", "peak_lr", "\n", "", "else", ":", "\n", "            ", "slope", "=", "-", "1", "*", "self", ".", "peak_lr", "/", "self", ".", "decay_steps", "\n", "return", "max", "(", "0.0", ",", "self", ".", "peak_lr", "+", "slope", "*", "(", "global_step", "-", "(", "self", ".", "explore_steps", "+", "self", ".", "warmup_steps", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.nikhil-iyer-97_wide-minima-density-hypothesis.None.knee_lr_schedule.KneeLRScheduler.step": [[33, 37], ["knee_lr_schedule.KneeLRScheduler.get_lr"], "methods", ["home.repos.pwc.inspect_result.nikhil-iyer-97_wide-minima-density-hypothesis.None.knee_lr_schedule.KneeLRScheduler.get_lr"], ["", "", "def", "step", "(", "self", ")", ":", "\n", "        ", "self", ".", "current_step", "+=", "1", "\n", "for", "param_group", "in", "self", ".", "optimizer", ".", "param_groups", ":", "\n", "            ", "param_group", "[", "'lr'", "]", "=", "self", ".", "get_lr", "(", "self", ".", "current_step", ")", "", "", "", "", ""]]}