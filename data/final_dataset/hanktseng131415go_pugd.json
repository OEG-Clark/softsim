{"home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.main.train": [[122, 170], ["print", "net.train", "enumerate", "inputs.to.to", "targets.to.to", "optimizer.zero_grad", "criterion.item", "net.max", "targets.to.size", "predicted.eq().sum().item", "utils.progress_bar", "net", "criterion", "criterion.backward", "optimizer.step", "net", "criterion", "criterion.backward", "optimizer.first_step", "net", "criterion", "criterion.backward", "optimizer.second_step", "len", "net", "criterion", "criterion.backward", "predicted.eq().sum", "predicted.eq"], "function", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.main.train", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.progress_bar", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.step", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.first_step", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.second_step"], ["def", "train", "(", "epoch", ")", ":", "\n", "    ", "print", "(", "'Epoch:{0}/{1}'", ".", "format", "(", "epoch", ",", "args", ".", "epochs", ")", ")", "\n", "net", ".", "train", "(", ")", "\n", "\n", "train_loss", "=", "0", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "\n", "for", "batch_idx", ",", "(", "inputs", ",", "targets", ")", "in", "enumerate", "(", "trainloader", ")", ":", "\n", "        ", "inputs", "=", "inputs", ".", "to", "(", "device", ")", "\n", "targets", "=", "targets", ".", "to", "(", "device", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "if", "args", ".", "mode", "==", "'closure'", ":", "\n", "\n", "            ", "def", "closure", "(", ")", ":", "\n", "\n", "                ", "outputs", "=", "net", "(", "inputs", ")", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "\n", "", "outputs", "=", "net", "(", "inputs", ")", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", "closure", ")", "\n", "\n", "", "else", ":", "\n", "\n", "            ", "outputs", "=", "net", "(", "inputs", ")", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "first_step", "(", ")", "\n", "\n", "outputs", "=", "net", "(", "inputs", ")", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "second_step", "(", "zero_grad", "=", "True", ")", "\n", "\n", "\n", "", "train_loss", "+=", "loss", ".", "item", "(", ")", "\n", "_", ",", "predicted", "=", "outputs", ".", "max", "(", "1", ")", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "\n", "progress_bar", "(", "batch_idx", ",", "len", "(", "trainloader", ")", ",", "'train_Loss: %.3f | train_Acc: %.3f%% (%d/%d)'", "\n", "%", "(", "train_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", ",", "correct", ",", "total", ")", ")", "\n", "\n", "", "return", "train_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.main.test": [[171, 212], ["net.eval", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "enumerate", "print", "torch.save", "torch.save", "torch.save", "torch.save", "print", "inputs.to.to", "targets.to.to", "net", "criterion", "criterion.item", "net.max", "targets.to.size", "predicted.eq().sum().item", "acc_list.append", "utils.progress_bar", "print", "print", "net.state_dict", "os.path.isdir", "os.mkdir", "len", "predicted.eq().sum", "round", "round", "numpy.mean", "numpy.std", "predicted.eq"], "function", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.progress_bar"], ["", "def", "test", "(", "epoch", ")", ":", "\n", "    ", "global", "best_acc", "\n", "net", ".", "eval", "(", ")", "\n", "test_loss", "=", "0", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "acc_list", "=", "[", "]", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "for", "batch_idx", ",", "(", "inputs", ",", "targets", ")", "in", "enumerate", "(", "testloader", ")", ":", "\n", "            ", "inputs", "=", "inputs", ".", "to", "(", "device", ")", "\n", "targets", "=", "targets", ".", "to", "(", "device", ")", "\n", "outputs", "=", "net", "(", "inputs", ")", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "\n", "test_loss", "+=", "loss", ".", "item", "(", ")", "\n", "_", ",", "predicted", "=", "outputs", ".", "max", "(", "1", ")", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "acc_list", ".", "append", "(", "100.", "*", "correct", "/", "total", ")", "\n", "\n", "progress_bar", "(", "batch_idx", ",", "len", "(", "testloader", ")", ",", "'test_Loss: %.3f | test_Acc: %.3f%% (%d/%d)'", "\n", "%", "(", "test_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", ",", "correct", ",", "total", ")", ")", "\n", "print", "(", ")", "\n", "print", "(", "'>>>best acc: {0}, mean: {1}, std: {2}'", ".", "format", "(", "best_acc", ",", "round", "(", "np", ".", "mean", "(", "acc_list", ")", ",", "2", ")", ",", "round", "(", "np", ".", "std", "(", "acc_list", ")", ",", "2", ")", ")", ")", "\n", "\n", "# Save checkpoint.", "\n", "", "", "acc", "=", "100.", "*", "correct", "/", "total", "\n", "if", "acc", ">", "best_acc", ":", "\n", "        ", "print", "(", "'Saving..'", ")", "\n", "state", "=", "{", "\n", "'net'", ":", "net", ".", "state_dict", "(", ")", ",", "\n", "'acc'", ":", "acc", ",", "\n", "'epoch'", ":", "epoch", ",", "\n", "}", "\n", "if", "not", "os", ".", "path", ".", "isdir", "(", "save_path", "+", "'/checkpoint'", ")", ":", "\n", "            ", "os", ".", "mkdir", "(", "save_path", "+", "'/checkpoint'", ")", "\n", "", "torch", ".", "save", "(", "state", ",", "save_path", "+", "'/checkpoint/ckpt.pth'", ")", "\n", "best_acc", "=", "acc", "\n", "print", "(", "'>>>best acc:'", ",", "best_acc", ")", "\n", "\n", "", "return", "test_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", ",", "best_acc", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.__init__": [[10, 19], ["dict", "super().__init__", "base_optimizer"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets.__init__"], ["    ", "def", "__init__", "(", "self", ",", "params", ",", "base_optimizer", ",", "**", "kwargs", ")", ":", "\n", "\n", "        ", "defaults", "=", "dict", "(", "**", "kwargs", ")", "\n", "super", "(", "PUGD", ",", "self", ")", ".", "__init__", "(", "params", ",", "defaults", ")", "\n", "\n", "self", ".", "base_optimizer", "=", "base_optimizer", "(", "self", ".", "param_groups", ",", "**", "kwargs", ")", "\n", "self", ".", "param_groups", "=", "self", ".", "base_optimizer", ".", "param_groups", "\n", "self", ".", "wd", "=", "self", ".", "param_groups", "[", "0", "]", "[", "'weight_decay'", "]", "\n", "self", ".", "mom", "=", "self", ".", "param_groups", "[", "0", "]", "[", "'momentum'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.step": [[20, 28], ["torch.no_grad", "pugd.PUGD.first_step", "closure", "pugd.PUGD.second_step", "torch.enable_grad"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.first_step", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.second_step"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "step", "(", "self", ",", "closure", "=", "None", ")", ":", "\n", "        ", "assert", "closure", "is", "not", "None", ",", "'There should be a closure'", "\n", "\n", "closure", "=", "torch", ".", "enable_grad", "(", ")", "(", "closure", ")", "\n", "self", ".", "first_step", "(", ")", "\n", "closure", "(", ")", "\n", "self", ".", "second_step", "(", "zero_grad", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.xp_step": [[29, 44], ["torch.no_grad", "pugd.PUGD._grad_norm", "pugd.PUGD.base_optimizer.step", "enumerate", "pugd.PUGD.zero_grad"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD._grad_norm", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.step"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "xp_step", "(", "self", ",", "zero_grad", "=", "True", ")", ":", "\n", "        ", "'''UGD = NGD-FW in Tensor'''", "\n", "grad_norm", "=", "self", ".", "_grad_norm", "(", ")", "\n", "\n", "for", "group", "in", "self", ".", "param_groups", ":", "\n", "\n", "            ", "for", "i", ",", "p", "in", "enumerate", "(", "group", "[", "\"params\"", "]", ")", ":", "\n", "                ", "if", "p", ".", "grad", "is", "None", ":", "continue", "\n", "\n", "p", ".", "grad", "=", "p", ".", "grad", "/", "(", "grad_norm", "+", "1e-12", ")", "\n", "\n", "", "", "self", ".", "base_optimizer", ".", "step", "(", ")", "\n", "\n", "if", "zero_grad", ":", "self", ".", "zero_grad", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.first_step": [[45, 56], ["torch.no_grad", "pugd.PUGD._abs_grad_norm", "enumerate", "p.add_", "torch.abs"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD._abs_grad_norm"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "first_step", "(", "self", ")", ":", "\n", "\n", "        ", "abs_grad_norm", "=", "self", ".", "_abs_grad_norm", "(", ")", "\n", "for", "group", "in", "self", ".", "param_groups", ":", "\n", "\n", "            ", "for", "i", ",", "p", "in", "enumerate", "(", "group", "[", "\"params\"", "]", ")", ":", "\n", "                ", "if", "p", ".", "grad", "is", "None", ":", "continue", "\n", "\n", "self", ".", "state", "[", "i", "]", "[", "\"e_w\"", "]", "=", "torch", ".", "abs", "(", "p", ")", "*", "p", ".", "grad", "/", "(", "abs_grad_norm", "+", "1e-12", ")", "\n", "p", ".", "add_", "(", "self", ".", "state", "[", "i", "]", "[", "\"e_w\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.second_step": [[57, 74], ["torch.no_grad", "pugd.PUGD._grad_norm", "pugd.PUGD.base_optimizer.step", "pugd.PUGD.cpu", "enumerate", "pugd.PUGD.zero_grad", "p.sub_"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD._grad_norm", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD.step"], ["", "", "", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "second_step", "(", "self", ",", "zero_grad", "=", "False", ")", ":", "\n", "\n", "        ", "grad_norm", "=", "self", ".", "_grad_norm", "(", ")", "\n", "for", "group", "in", "self", ".", "param_groups", ":", "\n", "\n", "            ", "for", "i", ",", "p", "in", "enumerate", "(", "group", "[", "\"params\"", "]", ")", ":", "\n", "                ", "if", "p", ".", "grad", "is", "None", ":", "continue", "\n", "\n", "p", ".", "sub_", "(", "self", ".", "state", "[", "i", "]", "[", "\"e_w\"", "]", ")", "\n", "p", ".", "grad", "=", "p", ".", "grad", "/", "(", "grad_norm", "+", "1e-12", ")", "\n", "\n", "", "", "self", ".", "base_optimizer", ".", "step", "(", ")", "\n", "\n", "if", "zero_grad", ":", "self", ".", "zero_grad", "(", ")", "\n", "\n", "return", "grad_norm", ".", "cpu", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD._grad_norm": [[75, 86], ["torch.norm", "torch.stack", "p.grad.norm().to", "p.grad.norm"], "methods", ["None"], ["", "def", "_grad_norm", "(", "self", ")", ":", "\n", "        ", "shared_device", "=", "self", ".", "param_groups", "[", "0", "]", "[", "\"params\"", "]", "[", "0", "]", ".", "device", "\n", "norm", "=", "torch", ".", "norm", "(", "\n", "torch", ".", "stack", "(", "[", "\n", "p", ".", "grad", ".", "norm", "(", "p", "=", "2", ")", ".", "to", "(", "shared_device", ")", "\n", "for", "group", "in", "self", ".", "param_groups", "for", "p", "in", "group", "[", "\"params\"", "]", "\n", "if", "p", ".", "grad", "is", "not", "None", "\n", "]", ")", ",", "\n", "p", "=", "2", "\n", ")", "\n", "return", "norm", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.pugd.PUGD._abs_grad_norm": [[87, 98], ["torch.norm", "torch.stack", "torch.abs"], "methods", ["None"], ["", "def", "_abs_grad_norm", "(", "self", ")", ":", "\n", "        ", "shared_device", "=", "self", ".", "param_groups", "[", "0", "]", "[", "\"params\"", "]", "[", "0", "]", ".", "device", "\n", "norm", "=", "torch", ".", "norm", "(", "\n", "torch", ".", "stack", "(", "[", "\n", "(", "torch", ".", "abs", "(", "p", ")", "*", "p", ".", "grad", ")", ".", "norm", "(", "p", "=", "2", ")", ".", "to", "(", "shared_device", ")", "\n", "for", "group", "in", "self", ".", "param_groups", "for", "p", "in", "group", "[", "\"params\"", "]", "\n", "if", "p", ".", "grad", "is", "not", "None", "\n", "]", ")", ",", "\n", "p", "=", "2", "\n", ")", "\n", "return", "norm", "\n", "", "", ""]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.get_mean_and_std": [[16, 29], ["torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "print", "torch.zeros.div_", "torch.zeros.div_", "range", "len", "len", "inputs[].mean", "inputs[].std"], "function", ["None"], ["def", "get_mean_and_std", "(", "dataset", ")", ":", "\n", "    ", "'''Compute the mean and std value of dataset.'''", "\n", "dataloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "dataset", ",", "batch_size", "=", "1", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "mean", "=", "torch", ".", "zeros", "(", "3", ")", "\n", "std", "=", "torch", ".", "zeros", "(", "3", ")", "\n", "print", "(", "'==> Computing mean and std..'", ")", "\n", "for", "inputs", ",", "targets", "in", "dataloader", ":", "\n", "        ", "for", "i", "in", "range", "(", "3", ")", ":", "\n", "            ", "mean", "[", "i", "]", "+=", "inputs", "[", ":", ",", "i", ",", ":", ",", ":", "]", ".", "mean", "(", ")", "\n", "std", "[", "i", "]", "+=", "inputs", "[", ":", ",", "i", ",", ":", ",", ":", "]", ".", "std", "(", ")", "\n", "", "", "mean", ".", "div_", "(", "len", "(", "dataset", ")", ")", "\n", "std", ".", "div_", "(", "len", "(", "dataset", ")", ")", "\n", "return", "mean", ",", "std", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.init_params": [[30, 44], ["net.modules", "isinstance", "torch.kaiming_normal", "isinstance", "torch.constant", "torch.constant", "torch.constant", "isinstance", "torch.normal", "torch.constant"], "function", ["None"], ["", "def", "init_params", "(", "net", ")", ":", "\n", "    ", "'''Init layer parameters.'''", "\n", "for", "m", "in", "net", ".", "modules", "(", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "init", ".", "kaiming_normal", "(", "m", ".", "weight", ",", "mode", "=", "'fan_out'", ")", "\n", "if", "m", ".", "bias", ":", "\n", "                ", "init", ".", "constant", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "            ", "init", ".", "constant", "(", "m", ".", "weight", ",", "1", ")", "\n", "init", ".", "constant", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "init", ".", "normal", "(", "m", ".", "weight", ",", "std", "=", "1e-3", ")", "\n", "if", "m", ".", "bias", ":", "\n", "                ", "init", ".", "constant", "(", "m", ".", "bias", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.progress_bar": [[52, 94], ["int", "sys.stdout.write", "range", "sys.stdout.write", "range", "sys.stdout.write", "time.time", "L.append", "L.append", "sys.stdout.write", "range", "range", "sys.stdout.write", "sys.stdout.flush", "time.time", "int", "sys.stdout.write", "sys.stdout.write", "L.append", "sys.stdout.write", "sys.stdout.write", "sys.stdout.write", "sys.stdout.write", "utils.format_time", "utils.format_time", "len", "int", "int"], "function", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.format_time", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.format_time"], ["def", "progress_bar", "(", "current", ",", "total", ",", "msg", "=", "None", ")", ":", "\n", "    ", "global", "last_time", ",", "begin_time", "\n", "if", "current", "==", "0", ":", "\n", "        ", "begin_time", "=", "time", ".", "time", "(", ")", "# Reset for new bar.", "\n", "\n", "", "cur_len", "=", "int", "(", "TOTAL_BAR_LENGTH", "*", "current", "/", "total", ")", "\n", "rest_len", "=", "int", "(", "TOTAL_BAR_LENGTH", "-", "cur_len", ")", "-", "1", "\n", "\n", "sys", ".", "stdout", ".", "write", "(", "' ['", ")", "\n", "for", "i", "in", "range", "(", "cur_len", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'='", ")", "\n", "", "sys", ".", "stdout", ".", "write", "(", "'>'", ")", "\n", "for", "i", "in", "range", "(", "rest_len", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'.'", ")", "\n", "", "sys", ".", "stdout", ".", "write", "(", "']'", ")", "\n", "\n", "cur_time", "=", "time", ".", "time", "(", ")", "\n", "step_time", "=", "cur_time", "-", "last_time", "\n", "last_time", "=", "cur_time", "\n", "tot_time", "=", "cur_time", "-", "begin_time", "\n", "\n", "L", "=", "[", "]", "\n", "L", ".", "append", "(", "'  Step: %s'", "%", "format_time", "(", "step_time", ")", ")", "\n", "L", ".", "append", "(", "' | Tot: %s'", "%", "format_time", "(", "tot_time", ")", ")", "\n", "if", "msg", ":", "\n", "        ", "L", ".", "append", "(", "' | '", "+", "msg", ")", "\n", "\n", "", "msg", "=", "''", ".", "join", "(", "L", ")", "\n", "sys", ".", "stdout", ".", "write", "(", "msg", ")", "\n", "for", "i", "in", "range", "(", "term_width", "-", "int", "(", "TOTAL_BAR_LENGTH", ")", "-", "len", "(", "msg", ")", "-", "3", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "' '", ")", "\n", "\n", "# Go back to the center of the bar.", "\n", "", "for", "i", "in", "range", "(", "term_width", "-", "int", "(", "TOTAL_BAR_LENGTH", "/", "2", ")", "+", "2", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'\\b'", ")", "\n", "", "sys", ".", "stdout", ".", "write", "(", "' %d/%d '", "%", "(", "current", "+", "1", ",", "total", ")", ")", "\n", "\n", "if", "current", "<", "total", "-", "1", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'\\r'", ")", "\n", "", "else", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'\\n'", ")", "\n", "", "sys", ".", "stdout", ".", "flush", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.None.utils.format_time": [[95, 126], ["int", "int", "int", "int", "int", "str", "str", "str", "str", "str"], "function", ["None"], ["", "def", "format_time", "(", "seconds", ")", ":", "\n", "    ", "days", "=", "int", "(", "seconds", "/", "3600", "/", "24", ")", "\n", "seconds", "=", "seconds", "-", "days", "*", "3600", "*", "24", "\n", "hours", "=", "int", "(", "seconds", "/", "3600", ")", "\n", "seconds", "=", "seconds", "-", "hours", "*", "3600", "\n", "minutes", "=", "int", "(", "seconds", "/", "60", ")", "\n", "seconds", "=", "seconds", "-", "minutes", "*", "60", "\n", "secondsf", "=", "int", "(", "seconds", ")", "\n", "seconds", "=", "seconds", "-", "secondsf", "\n", "millis", "=", "int", "(", "seconds", "*", "1000", ")", "\n", "\n", "f", "=", "''", "\n", "i", "=", "1", "\n", "if", "days", ">", "0", ":", "\n", "        ", "f", "+=", "str", "(", "days", ")", "+", "'D'", "\n", "i", "+=", "1", "\n", "", "if", "hours", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "hours", ")", "+", "'h'", "\n", "i", "+=", "1", "\n", "", "if", "minutes", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "minutes", ")", "+", "'m'", "\n", "i", "+=", "1", "\n", "", "if", "secondsf", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "secondsf", ")", "+", "'s'", "\n", "i", "+=", "1", "\n", "", "if", "millis", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "millis", ")", "+", "'ms'", "\n", "i", "+=", "1", "\n", "", "if", "f", "==", "''", ":", "\n", "        ", "f", "=", "'0ms'", "\n", "", "return", "f", "", "", ""]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upa_block.__init__": [[13, 38], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "upanets.CPA", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "int", "int", "int", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "int", "int"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ",", "cat", "=", "False", ",", "same", "=", "False", ",", "w", "=", "2", ",", "l", "=", "2", ")", ":", "\n", "\n", "        ", "super", "(", "upa_block", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "cat", "=", "cat", "\n", "self", ".", "stride", "=", "stride", "\n", "self", ".", "planes", "=", "planes", "\n", "self", ".", "same", "=", "same", "\n", "self", ".", "cnn", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "int", "(", "planes", "*", "w", ")", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "int", "(", "planes", "*", "w", ")", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "int", "(", "planes", "*", "w", ")", ",", "planes", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "planes", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "\n", "if", "l", "==", "1", ":", "\n", "            ", "w", "=", "1", "\n", "self", ".", "cnn", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "int", "(", "planes", "*", "w", ")", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "int", "(", "planes", "*", "w", ")", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", ")", "\n", "\n", "", "self", ".", "att", "=", "CPA", "(", "in_planes", ",", "planes", ",", "stride", ",", "same", "=", "same", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upa_block.forward": [[39, 48], ["upanets.upa_block.cnn", "upanets.upa_block.att", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "out", "=", "self", ".", "cnn", "(", "x", ")", "\n", "out", "=", "self", ".", "att", "(", "x", ",", "out", ")", "\n", "\n", "if", "self", ".", "cat", "==", "True", ":", "\n", "            ", "out", "=", "torch", ".", "cat", "(", "[", "x", ",", "out", "]", ",", "1", ")", "\n", "\n", "", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.CPA.__init__": [[79, 98], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Linear", "torch.Linear", "torch.Linear", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AvgPool2d", "torch.AvgPool2d", "torch.AvgPool2d"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets.__init__"], ["def", "__init__", "(", "self", ",", "in_dim", ",", "dim", ",", "stride", "=", "1", ",", "same", "=", "False", ",", "sc_x", "=", "True", ")", ":", "\n", "\n", "        ", "super", "(", "CPA", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "dim", "=", "dim", "\n", "self", ".", "stride", "=", "stride", "\n", "self", ".", "same", "=", "same", "\n", "self", ".", "sc_x", "=", "sc_x", "\n", "\n", "self", ".", "cp_ffc", "=", "nn", ".", "Linear", "(", "in_dim", ",", "dim", ")", "\n", "self", ".", "bn", "=", "nn", ".", "BatchNorm2d", "(", "dim", ")", "\n", "\n", "if", "self", ".", "stride", "==", "2", "or", "self", ".", "same", "==", "True", ":", "\n", "            ", "if", "sc_x", "==", "True", ":", "\n", "                ", "self", ".", "cp_ffc_sc", "=", "nn", ".", "Linear", "(", "in_dim", ",", "dim", ")", "\n", "self", ".", "bn_sc", "=", "nn", ".", "BatchNorm2d", "(", "dim", ")", "\n", "\n", "", "if", "self", ".", "stride", "==", "2", ":", "\n", "                ", "self", ".", "avgpool", "=", "nn", ".", "AvgPool2d", "(", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.CPA.forward": [[99, 132], ["einops.rearrange", "upanets.CPA.cp_ffc", "einops.rearrange", "upanets.CPA.bn", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "upanets.CPA.avgpool", "einops.rearrange", "upanets.CPA.cp_ffc_sc", "einops.rearrange", "upanets.CPA.bn_sc", "upanets.CPA.size", "upanets.CPA.size"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ",", "sc_x", ")", ":", "\n", "\n", "        ", "_", ",", "c", ",", "w", ",", "h", "=", "x", ".", "shape", "\n", "out", "=", "rearrange", "(", "x", ",", "'b c w h -> b w h c'", ",", "c", "=", "c", ",", "w", "=", "w", ",", "h", "=", "h", ")", "\n", "out", "=", "self", ".", "cp_ffc", "(", "out", ")", "\n", "out", "=", "rearrange", "(", "out", ",", "'b w h c-> b c w h'", ",", "c", "=", "self", ".", "dim", ",", "w", "=", "w", ",", "h", "=", "h", ")", "\n", "out", "=", "self", ".", "bn", "(", "out", ")", "\n", "\n", "if", "out", ".", "shape", "==", "sc_x", ".", "shape", ":", "\n", "            ", "if", "self", ".", "sc_x", "==", "True", ":", "\n", "                ", "out", "=", "sc_x", "+", "out", "\n", "", "out", "=", "F", ".", "layer_norm", "(", "out", ",", "out", ".", "size", "(", ")", "[", "1", ":", "]", ")", "\n", "\n", "", "else", ":", "\n", "            ", "out", "=", "F", ".", "layer_norm", "(", "out", ",", "out", ".", "size", "(", ")", "[", "1", ":", "]", ")", "\n", "if", "self", ".", "sc_x", "==", "True", ":", "\n", "                ", "x", "=", "sc_x", "\n", "\n", "", "", "if", "self", ".", "stride", "==", "2", "or", "self", ".", "same", "==", "True", ":", "\n", "            ", "if", "self", ".", "sc_x", "==", "True", ":", "\n", "                ", "_", ",", "c", ",", "w", ",", "h", "=", "x", ".", "shape", "\n", "x", "=", "rearrange", "(", "x", ",", "'b c w h -> b w h c'", ",", "c", "=", "c", ",", "w", "=", "w", ",", "h", "=", "h", ")", "\n", "x", "=", "self", ".", "cp_ffc_sc", "(", "x", ")", "\n", "x", "=", "rearrange", "(", "x", ",", "'b w h c-> b c w h'", ",", "c", "=", "self", ".", "dim", ",", "w", "=", "w", ",", "h", "=", "h", ")", "\n", "x", "=", "self", ".", "bn_sc", "(", "x", ")", "\n", "out", "=", "out", "+", "x", "\n", "\n", "", "if", "self", ".", "same", "==", "True", ":", "\n", "                ", "return", "out", "\n", "\n", "", "out", "=", "self", ".", "avgpool", "(", "out", ")", "\n", "\n", "", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.SPA.__init__": [[137, 143], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets.__init__"], ["def", "__init__", "(", "self", ",", "img", ",", "out", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "SPA", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "sp_ffc", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Linear", "(", "img", "**", "2", ",", "out", "**", "2", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.SPA.forward": [[145, 154], ["einops.rearrange", "upanets.SPA.sp_ffc", "einops.rearrange", "int", "int"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "_", ",", "c", ",", "w", ",", "h", "=", "x", ".", "shape", "\n", "x", "=", "rearrange", "(", "x", ",", "'b c w h -> b c (w h)'", ",", "c", "=", "c", ",", "w", "=", "w", ",", "h", "=", "h", ")", "\n", "x", "=", "self", ".", "sp_ffc", "(", "x", ")", "\n", "_", ",", "c", ",", "l", "=", "x", ".", "shape", "\n", "out", "=", "rearrange", "(", "x", ",", "'b c (w h) -> b c w h'", ",", "c", "=", "c", ",", "w", "=", "int", "(", "l", "**", "0.5", ")", ",", "h", "=", "int", "(", "l", "**", "0.5", ")", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets.__init__": [[156, 187], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "upanets.CPA", "upanets.upanets._make_layer", "upanets.upanets._make_layer", "upanets.upanets._make_layer", "upanets.upanets._make_layer", "upanets.SPA", "upanets.SPA", "upanets.SPA", "upanets.SPA", "upanets.SPA", "torch.Linear", "torch.Linear", "torch.Linear", "torch.BatchNorm1d", "torch.BatchNorm1d", "torch.BatchNorm1d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "int", "int", "int", "int", "int", "int", "int", "int", "int", "int", "int", "int"], "methods", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets.__init__", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets._make_layer", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets._make_layer", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets._make_layer", "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "filter_nums", ",", "num_classes", "=", "100", ",", "img", "=", "32", ")", ":", "\n", "\n", "        ", "super", "(", "upanets", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "in_planes", "=", "filter_nums", "\n", "self", ".", "filters", "=", "filter_nums", "\n", "w", "=", "2", "\n", "\n", "self", ".", "root", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "3", ",", "int", "(", "self", ".", "in_planes", "*", "w", ")", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "int", "(", "self", ".", "in_planes", "*", "w", ")", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "int", "(", "self", ".", "in_planes", "*", "w", ")", ",", "self", ".", "in_planes", "*", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "in_planes", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", ")", "\n", "self", ".", "emb", "=", "CPA", "(", "3", ",", "self", ".", "in_planes", ",", "same", "=", "True", ")", "\n", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "int", "(", "self", ".", "filters", "*", "1", ")", ",", "num_blocks", "[", "0", "]", ",", "1", ")", "\n", "self", ".", "layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "int", "(", "self", ".", "filters", "*", "2", ")", ",", "num_blocks", "[", "1", "]", ",", "2", ")", "\n", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "int", "(", "self", ".", "filters", "*", "4", ")", ",", "num_blocks", "[", "2", "]", ",", "2", ")", "\n", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "int", "(", "self", ".", "filters", "*", "8", ")", ",", "num_blocks", "[", "3", "]", ",", "2", ")", "\n", "\n", "self", ".", "spa0", "=", "SPA", "(", "img", ")", "\n", "self", ".", "spa1", "=", "SPA", "(", "img", ")", "\n", "self", ".", "spa2", "=", "SPA", "(", "int", "(", "img", "*", "0.5", ")", ")", "\n", "self", ".", "spa3", "=", "SPA", "(", "int", "(", "img", "*", "0.25", ")", ")", "\n", "self", ".", "spa4", "=", "SPA", "(", "int", "(", "img", "*", "0.125", ")", ")", "\n", "\n", "self", ".", "linear", "=", "nn", ".", "Linear", "(", "int", "(", "self", ".", "filters", "*", "31", ")", ",", "num_classes", ")", "\n", "self", ".", "bn", "=", "nn", ".", "BatchNorm1d", "(", "int", "(", "self", ".", "filters", "*", "31", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets._make_layer": [[188, 212], ["enumerate", "torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "strides.append", "block", "layers.append", "layers.append", "strides.append", "block", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "self", ".", "planes", "=", "planes", "\n", "planes", "=", "planes", "//", "num_blocks", "\n", "\n", "for", "i", ",", "stride", "in", "enumerate", "(", "strides", ")", ":", "\n", "\n", "            ", "if", "i", "==", "0", "and", "stride", "==", "1", ":", "\n", "                ", "layers", ".", "append", "(", "block", "(", "self", ".", "planes", ",", "self", ".", "planes", ",", "stride", ",", "same", "=", "True", ")", ")", "\n", "strides", ".", "append", "(", "1", ")", "\n", "self", ".", "in_planes", "=", "self", ".", "planes", "\n", "\n", "", "elif", "i", "!=", "0", "and", "stride", "==", "1", ":", "\n", "                ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ",", "cat", "=", "True", ")", ")", "\n", "self", ".", "in_planes", "=", "self", ".", "in_planes", "+", "planes", "\n", "\n", "", "else", ":", "\n", "                ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "self", ".", "planes", ",", "stride", ")", ")", "\n", "strides", ".", "append", "(", "1", ")", "\n", "self", ".", "in_planes", "=", "self", ".", "planes", "\n", "\n", "", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.upanets.forward": [[213, 254], ["upanets.upanets.root", "upanets.upanets.emb", "upanets.upanets.layer1", "upanets.upanets.layer2", "upanets.upanets.layer3", "upanets.upanets.layer4", "upanets.upanets.spa0", "upanets.upanets.spa1", "upanets.upanets.spa2", "upanets.upanets.spa3", "upanets.upanets.spa4", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.layer_norm", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "upanets.upanets.view", "upanets.upanets.bn", "upanets.upanets.linear", "upanets.upanets.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size", "torch.layer_norm.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "out01", "=", "self", ".", "root", "(", "x", ")", "\n", "out0", "=", "self", ".", "emb", "(", "x", ",", "out01", ")", "\n", "\n", "out1", "=", "self", ".", "layer1", "(", "out0", ")", "\n", "out2", "=", "self", ".", "layer2", "(", "out1", ")", "\n", "out3", "=", "self", ".", "layer3", "(", "out2", ")", "\n", "out4", "=", "self", ".", "layer4", "(", "out3", ")", "\n", "\n", "out0_spa", "=", "self", ".", "spa0", "(", "out0", ")", "\n", "out1_spa", "=", "self", ".", "spa1", "(", "out1", ")", "\n", "out2_spa", "=", "self", ".", "spa2", "(", "out2", ")", "\n", "out3_spa", "=", "self", ".", "spa3", "(", "out3", ")", "\n", "out4_spa", "=", "self", ".", "spa4", "(", "out4", ")", "\n", "\n", "out0_gap", "=", "F", ".", "avg_pool2d", "(", "out0", ",", "out0", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "out1_gap", "=", "F", ".", "avg_pool2d", "(", "out1", ",", "out1", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "out2_gap", "=", "F", ".", "avg_pool2d", "(", "out2", ",", "out2", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "out3_gap", "=", "F", ".", "avg_pool2d", "(", "out3", ",", "out3", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "out4_gap", "=", "F", ".", "avg_pool2d", "(", "out4", ",", "out4", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "\n", "out0", "=", "out0_gap", "+", "out0_spa", "\n", "out1", "=", "out1_gap", "+", "out1_spa", "\n", "out2", "=", "out2_gap", "+", "out2_spa", "\n", "out3", "=", "out3_gap", "+", "out3_spa", "\n", "out4", "=", "out4_gap", "+", "out4_spa", "\n", "\n", "out0", "=", "F", ".", "layer_norm", "(", "out0", ",", "out0", ".", "size", "(", ")", "[", "1", ":", "]", ")", "\n", "out1", "=", "F", ".", "layer_norm", "(", "out1", ",", "out1", ".", "size", "(", ")", "[", "1", ":", "]", ")", "\n", "out2", "=", "F", ".", "layer_norm", "(", "out2", ",", "out2", ".", "size", "(", ")", "[", "1", ":", "]", ")", "\n", "out3", "=", "F", ".", "layer_norm", "(", "out3", ",", "out3", ".", "size", "(", ")", "[", "1", ":", "]", ")", "\n", "out4", "=", "F", ".", "layer_norm", "(", "out4", ",", "out4", ".", "size", "(", ")", "[", "1", ":", "]", ")", "\n", "\n", "out", "=", "torch", ".", "cat", "(", "[", "out4", ",", "out3", ",", "out2", ",", "out1", ",", "out0", "]", ",", "1", ")", "\n", "\n", "out", "=", "out", ".", "view", "(", "out", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "out", "=", "self", ".", "bn", "(", "out", ")", "# please exclude when using the test function", "\n", "out", "=", "self", ".", "linear", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.UPANets": [[255, 258], ["upanets.upanets", "int", "int", "int", "int"], "function", ["None"], ["", "", "def", "UPANets", "(", "f", ",", "c", "=", "100", ",", "block", "=", "1", ",", "img", "=", "32", ")", ":", "\n", "\n", "    ", "return", "upanets", "(", "upa_block", ",", "[", "int", "(", "4", "*", "block", ")", ",", "int", "(", "4", "*", "block", ")", ",", "int", "(", "4", "*", "block", ")", ",", "int", "(", "4", "*", "block", ")", "]", ",", "f", ",", "num_classes", "=", "c", ",", "img", "=", "img", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.test": [[259, 264], ["upanets.UPANets", "UPANets.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.hanktseng131415go_pugd.models.upanets.UPANets"], ["", "def", "test", "(", ")", ":", "\n", "\n", "    ", "net", "=", "UPANets", "(", "16", ",", "10", ",", "1", ",", "64", ")", "\n", "y", "=", "net", "(", "torch", ".", "randn", "(", "1", ",", "3", ",", "64", ",", "64", ")", ")", "\n", "print", "(", "y", ".", "size", "(", ")", ")", "\n", "\n"]]}