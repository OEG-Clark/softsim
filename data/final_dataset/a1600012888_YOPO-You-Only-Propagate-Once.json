{"home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.__init__": [[35, 38], ["misc.AvgMeter.reset"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.reset"], ["def", "__init__", "(", "self", ",", "name", "=", "'No name'", ")", ":", "\n", "        ", "self", ".", "name", "=", "name", "\n", "self", ".", "reset", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.reset": [[39, 44], ["None"], "methods", ["None"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "self", ".", "sum", "=", "0", "\n", "self", ".", "mean", "=", "0", "\n", "self", ".", "num", "=", "0", "\n", "self", ".", "now", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.update": [[45, 54], ["math.isnan", "print", "float"], "methods", ["None"], ["", "def", "update", "(", "self", ",", "mean_var", ",", "count", "=", "1", ")", ":", "\n", "        ", "if", "math", ".", "isnan", "(", "mean_var", ")", ":", "\n", "            ", "mean_var", "=", "1e6", "\n", "print", "(", "'Avgmeter getting Nan!'", ")", "\n", "", "self", ".", "now", "=", "mean_var", "\n", "self", ".", "num", "+=", "count", "\n", "\n", "self", ".", "sum", "+=", "mean_var", "*", "count", "\n", "self", ".", "mean", "=", "float", "(", "self", ".", "sum", ")", "/", "self", ".", "num", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy": [[6, 28], ["max", "output.size", "output.topk", "pred.t.t", "pred.t.eq", "target.view().expand_as", "is_correct[].view().float().sum", "ans.append", "is_correct[].view().float().sum.mul_", "target.view", "is_correct[].view().float", "is_correct[].view"], "function", ["None"], ["def", "torch_accuracy", "(", "output", ",", "target", ",", "topk", "=", "(", "1", ",", ")", ")", "->", "List", "[", "torch", ".", "Tensor", "]", ":", "\n", "    ", "'''\n    param output, target: should be torch Variable\n    '''", "\n", "# assert isinstance(output, torch.cuda.Tensor), 'expecting Torch Tensor'", "\n", "# assert isinstance(target, torch.Tensor), 'expecting Torch Tensor'", "\n", "# print(type(output))", "\n", "\n", "topn", "=", "max", "(", "topk", ")", "\n", "batch_size", "=", "output", ".", "size", "(", "0", ")", "\n", "\n", "_", ",", "pred", "=", "output", ".", "topk", "(", "topn", ",", "1", ",", "True", ",", "True", ")", "\n", "pred", "=", "pred", ".", "t", "(", ")", "\n", "\n", "is_correct", "=", "pred", ".", "eq", "(", "target", ".", "view", "(", "1", ",", "-", "1", ")", ".", "expand_as", "(", "pred", ")", ")", "\n", "\n", "ans", "=", "[", "]", "\n", "for", "i", "in", "topk", ":", "\n", "        ", "is_correct_i", "=", "is_correct", "[", ":", "i", "]", ".", "view", "(", "-", "1", ")", ".", "float", "(", ")", ".", "sum", "(", "0", ",", "keepdim", "=", "True", ")", "\n", "ans", ".", "append", "(", "is_correct_i", ".", "mul_", "(", "100.0", "/", "batch_size", ")", ")", "\n", "\n", "", "return", "ans", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.save_args": [[55, 66], ["os.path.join", "os.path.join", "open", "json.dump"], "function", ["None"], ["", "", "def", "save_args", "(", "args", ",", "save_dir", "=", "None", ")", ":", "\n", "    ", "if", "save_dir", "==", "None", ":", "\n", "        ", "param_path", "=", "os", ".", "path", ".", "join", "(", "args", ".", "resume", ",", "\"params.json\"", ")", "\n", "", "else", ":", "\n", "        ", "param_path", "=", "os", ".", "path", ".", "join", "(", "save_dir", ",", "'params.json'", ")", "\n", "\n", "#logger.info(\"[*] MODEL dir: %s\" % args.resume)", "\n", "#logger.info(\"[*] PARAM path: %s\" % param_path)", "\n", "\n", "", "with", "open", "(", "param_path", ",", "'w'", ")", "as", "fp", ":", "\n", "        ", "json", ".", "dump", "(", "args", ".", "__dict__", ",", "fp", ",", "indent", "=", "4", ",", "sort_keys", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.mkdir": [[68, 72], ["os.path.exists", "print", "os.mkdir"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.mkdir"], ["", "", "def", "mkdir", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "print", "(", "'creating dir {}'", ".", "format", "(", "path", ")", ")", "\n", "os", ".", "mkdir", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.save_checkpoint": [[73, 84], ["os.path.exists", "torch.save", "os.path.join", "misc.make_symlink", "net.state_dict", "optimizer.state_dict", "lr_scheduler.state_dict", "print", "file_name.split"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.make_symlink"], ["", "", "def", "save_checkpoint", "(", "now_epoch", ",", "net", ",", "optimizer", ",", "lr_scheduler", ",", "file_name", ")", ":", "\n", "    ", "checkpoint", "=", "{", "'epoch'", ":", "now_epoch", ",", "\n", "'state_dict'", ":", "net", ".", "state_dict", "(", ")", ",", "\n", "'optimizer_state_dict'", ":", "optimizer", ".", "state_dict", "(", ")", ",", "\n", "'lr_scheduler_state_dict'", ":", "lr_scheduler", ".", "state_dict", "(", ")", "}", "\n", "if", "os", ".", "path", ".", "exists", "(", "file_name", ")", ":", "\n", "        ", "print", "(", "'Overwriting {}'", ".", "format", "(", "file_name", ")", ")", "\n", "", "torch", ".", "save", "(", "checkpoint", ",", "file_name", ")", "\n", "link_name", "=", "os", ".", "path", ".", "join", "(", "'/'", ",", "*", "file_name", ".", "split", "(", "os", ".", "path", ".", "sep", ")", "[", ":", "-", "1", "]", ",", "'last.checkpoint'", ")", "\n", "#print(link_name)", "\n", "make_symlink", "(", "source", "=", "file_name", ",", "link_name", "=", "link_name", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.load_checkpoint": [[85, 102], ["os.path.isfile", "print", "torch.load", "print", "print", "net.load_state_dict", "print", "optimizer.load_state_dict", "print", "lr_scheduler.load_state_dict"], "function", ["None"], ["", "def", "load_checkpoint", "(", "file_name", ",", "net", "=", "None", ",", "optimizer", "=", "None", ",", "lr_scheduler", "=", "None", ")", ":", "\n", "    ", "if", "os", ".", "path", ".", "isfile", "(", "file_name", ")", ":", "\n", "        ", "print", "(", "\"=> loading checkpoint '{}'\"", ".", "format", "(", "file_name", ")", ")", "\n", "check_point", "=", "torch", ".", "load", "(", "file_name", ")", "\n", "if", "net", "is", "not", "None", ":", "\n", "            ", "print", "(", "'Loading network state dict'", ")", "\n", "net", ".", "load_state_dict", "(", "check_point", "[", "'state_dict'", "]", ")", "\n", "", "if", "optimizer", "is", "not", "None", ":", "\n", "            ", "print", "(", "'Loading optimizer state dict'", ")", "\n", "optimizer", ".", "load_state_dict", "(", "check_point", "[", "'optimizer_state_dict'", "]", ")", "\n", "", "if", "lr_scheduler", "is", "not", "None", ":", "\n", "            ", "print", "(", "'Loading lr_scheduler state dict'", ")", "\n", "lr_scheduler", ".", "load_state_dict", "(", "check_point", "[", "'lr_scheduler_state_dict'", "]", ")", "\n", "\n", "", "return", "check_point", "[", "'epoch'", "]", "\n", "", "else", ":", "\n", "        ", "print", "(", "\"=> no checkpoint found at '{}'\"", ".", "format", "(", "file_name", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.make_symlink": [[104, 116], ["os.path.exists", "os.path.exists", "os.remove", "os.symlink", "print"], "function", ["None"], ["", "", "def", "make_symlink", "(", "source", ",", "link_name", ")", ":", "\n", "    ", "'''\n    Note: overwriting enabled!\n    '''", "\n", "if", "os", ".", "path", ".", "exists", "(", "link_name", ")", ":", "\n", "#print(\"Link name already exist! Removing '{}' and overwriting\".format(link_name))", "\n", "        ", "os", ".", "remove", "(", "link_name", ")", "\n", "", "if", "os", ".", "path", ".", "exists", "(", "source", ")", ":", "\n", "        ", "os", ".", "symlink", "(", "source", ",", "link_name", ")", "\n", "return", "\n", "", "else", ":", "\n", "        ", "print", "(", "'Source path not exists'", ")", "\n", "#print('SymLink Wrong!')", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.add_path": [[118, 122], ["print", "sys.path.append"], "function", ["None"], ["", "", "def", "add_path", "(", "path", ")", ":", "\n", "    ", "if", "path", "not", "in", "sys", ".", "path", ":", "\n", "        ", "print", "(", "'Adding {}'", ".", "format", "(", "path", ")", ")", "\n", "sys", ".", "path", ".", "append", "(", "path", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.attack_base.AttackBase.attack": [[6, 15], ["None"], "methods", ["None"], ["    ", "@", "abstractmethod", "\n", "def", "attack", "(", "self", ",", "net", ",", "inp", ",", "label", ",", "target", "=", "None", ")", ":", "\n", "        ", "'''\n\n        :param inp: batched images\n        :param target: specify the indexes of target class, None represents untargeted attack\n        :return: batched adversaril images\n        '''", "\n", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.attack_base.AttackBase.to": [[16, 19], ["None"], "methods", ["None"], ["", "@", "abstractmethod", "\n", "def", "to", "(", "self", ",", "device", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.attack_base.clip_eta": [[22, 51], ["torch.device", "torch.no_grad", "torch.tensor().to", "torch.tensor().to", "torch.tensor().to", "torch.clamp", "torch.norm", "torch.max", "torch.max.unsqueeze_", "torch.max.unsqueeze_", "torch.max.unsqueeze_", "torch.min", "torch.tensor", "torch.tensor", "torch.tensor", "torch.clamp.reshape", "torch.clamp.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["", "", "def", "clip_eta", "(", "eta", ",", "norm", ",", "eps", ",", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ")", ":", "\n", "    ", "'''\n    helper functions to project eta into epsilon norm ball\n    :param eta: Perturbation tensor (should be of size(N, C, H, W))\n    :param norm: which norm. should be in [1, 2, np.inf]\n    :param eps: epsilon, bound of the perturbation\n    :return: Projected perturbation\n    '''", "\n", "\n", "assert", "norm", "in", "[", "1", ",", "2", ",", "np", ".", "inf", "]", ",", "\"norm should be in [1, 2, np.inf]\"", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "avoid_zero_div", "=", "torch", ".", "tensor", "(", "1e-12", ")", ".", "to", "(", "DEVICE", ")", "\n", "eps", "=", "torch", ".", "tensor", "(", "eps", ")", ".", "to", "(", "DEVICE", ")", "\n", "one", "=", "torch", ".", "tensor", "(", "1.0", ")", ".", "to", "(", "DEVICE", ")", "\n", "\n", "if", "norm", "==", "np", ".", "inf", ":", "\n", "            ", "eta", "=", "torch", ".", "clamp", "(", "eta", ",", "-", "eps", ",", "eps", ")", "\n", "", "else", ":", "\n", "            ", "normalize", "=", "torch", ".", "norm", "(", "eta", ".", "reshape", "(", "eta", ".", "size", "(", "0", ")", ",", "-", "1", ")", ",", "p", "=", "norm", ",", "dim", "=", "-", "1", ",", "keepdim", "=", "False", ")", "\n", "normalize", "=", "torch", ".", "max", "(", "normalize", ",", "avoid_zero_div", ")", "\n", "\n", "normalize", ".", "unsqueeze_", "(", "dim", "=", "-", "1", ")", "\n", "normalize", ".", "unsqueeze_", "(", "dim", "=", "-", "1", ")", "\n", "normalize", ".", "unsqueeze_", "(", "dim", "=", "-", "1", ")", "\n", "\n", "factor", "=", "torch", ".", "min", "(", "one", ",", "eps", "/", "normalize", ")", "\n", "eta", "=", "eta", "*", "factor", "\n", "", "", "return", "eta", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.attack_base.test_clip": [[52, 64], ["torch.rand().cuda", "zip", "print", "attack_base.clip_eta", "print", "torch.rand"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.attack_base.clip_eta"], ["", "def", "test_clip", "(", ")", ":", "\n", "\n", "    ", "a", "=", "torch", ".", "rand", "(", "(", "10", ",", "3", ",", "28", ",", "28", ")", ")", ".", "cuda", "(", ")", "\n", "\n", "epss", "=", "[", "0.1", ",", "0.5", ",", "1", "]", "\n", "\n", "norms", "=", "[", "1", ",", "2", ",", "np", ".", "inf", "]", "\n", "for", "e", ",", "n", "in", "zip", "(", "epss", ",", "norms", ")", ":", "\n", "        ", "print", "(", "e", ",", "n", ")", "\n", "c", "=", "clip_eta", "(", "a", ",", "n", ",", "e", ",", "True", ")", "\n", "\n", "print", "(", "c", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.__init__": [[23, 42], ["torch.device", "torch.tensor", "torch.tensor", "torch.nn.CrossEntropyLoss().to", "mean.to", "std.to", "numpy.array().astype", "numpy.array().astype", "torch.nn.CrossEntropyLoss", "numpy.array", "numpy.array"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["    ", "def", "__init__", "(", "self", ",", "eps", "=", "6", "/", "255.0", ",", "sigma", "=", "3", "/", "255.0", ",", "nb_iter", "=", "20", ",", "\n", "norm", "=", "np", ".", "inf", ",", "DEVICE", "=", "torch", ".", "device", "(", "'cpu'", ")", ",", "\n", "mean", "=", "torch", ".", "tensor", "(", "np", ".", "array", "(", "[", "0", "]", ")", ".", "astype", "(", "np", ".", "float32", ")", "[", "np", ".", "newaxis", ",", ":", ",", "np", ".", "newaxis", ",", "np", ".", "newaxis", "]", ")", ",", "\n", "std", "=", "torch", ".", "tensor", "(", "np", ".", "array", "(", "[", "1.0", "]", ")", ".", "astype", "(", "np", ".", "float32", ")", "[", "np", ".", "newaxis", ",", ":", ",", "np", ".", "newaxis", ",", "np", ".", "newaxis", "]", ")", ",", "random_start", "=", "True", ")", ":", "\n", "        ", "'''\n        :param eps: maximum distortion of adversarial examples\n        :param sigma: single step size\n        :param nb_iter: number of attack iterations\n        :param norm: which norm to bound the perturbations\n        '''", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "nb_iter", "=", "nb_iter", "\n", "self", ".", "norm", "=", "norm", "\n", "self", ".", "criterion", "=", "torch", ".", "nn", ".", "CrossEntropyLoss", "(", ")", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "DEVICE", "=", "DEVICE", "\n", "self", ".", "_mean", "=", "mean", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "_std", "=", "std", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "random_start", "=", "random_start", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.single_attack": [[43, 80], ["net", "torch.clamp", "attack.attack_base.clip_eta", "torch.sum", "[].sign", "pgd.IPGD.criterion", "[].sign", "torch.autograd.grad", "torch.autograd.grad"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.attack_base.clip_eta"], ["", "def", "single_attack", "(", "self", ",", "net", ",", "inp", ",", "label", ",", "eta", ",", "target", "=", "None", ")", ":", "\n", "        ", "'''\n        Given the original image and the perturbation computed so far, computes\n        a new perturbation.\n        :param net:\n        :param inp: original image\n        :param label:\n        :param eta: perturbation computed so far\n        :return: a new perturbation\n        '''", "\n", "\n", "adv_inp", "=", "inp", "+", "eta", "\n", "\n", "#net.zero_grad()", "\n", "\n", "pred", "=", "net", "(", "adv_inp", ")", "\n", "if", "target", "is", "not", "None", ":", "\n", "            ", "targets", "=", "torch", ".", "sum", "(", "pred", "[", ":", ",", "target", "]", ")", "\n", "grad_sign", "=", "torch", ".", "autograd", ".", "grad", "(", "targets", ",", "adv_in", ",", "only_inputs", "=", "True", ",", "retain_graph", "=", "False", ")", "[", "0", "]", ".", "sign", "(", ")", "\n", "\n", "", "else", ":", "\n", "            ", "loss", "=", "self", ".", "criterion", "(", "pred", ",", "label", ")", "\n", "grad_sign", "=", "torch", ".", "autograd", ".", "grad", "(", "loss", ",", "adv_inp", ",", "\n", "only_inputs", "=", "True", ",", "retain_graph", "=", "False", ")", "[", "0", "]", ".", "sign", "(", ")", "\n", "\n", "", "adv_inp", "=", "adv_inp", "+", "grad_sign", "*", "(", "self", ".", "sigma", "/", "self", ".", "_std", ")", "\n", "tmp_adv_inp", "=", "adv_inp", "*", "self", ".", "_std", "+", "self", ".", "_mean", "\n", "\n", "tmp_inp", "=", "inp", "*", "self", ".", "_std", "+", "self", ".", "_mean", "\n", "tmp_adv_inp", "=", "torch", ".", "clamp", "(", "tmp_adv_inp", ",", "0", ",", "1", ")", "## clip into 0-1", "\n", "#tmp_adv_inp = (tmp_adv_inp - self._mean) / self._std", "\n", "tmp_eta", "=", "tmp_adv_inp", "-", "tmp_inp", "\n", "tmp_eta", "=", "clip_eta", "(", "tmp_eta", ",", "norm", "=", "self", ".", "norm", ",", "eps", "=", "self", ".", "eps", ",", "DEVICE", "=", "self", ".", "DEVICE", ")", "\n", "\n", "eta", "=", "tmp_eta", "/", "self", ".", "_std", "\n", "\n", "return", "eta", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.attack": [[81, 104], ["pgd.IPGD.to", "net.eval", "range", "torch.clamp", "torch.FloatTensor().uniform_", "torch.zeros_like", "pgd.IPGD.single_attack", "torch.FloatTensor"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.single_attack"], ["", "def", "attack", "(", "self", ",", "net", ",", "inp", ",", "label", ",", "target", "=", "None", ")", ":", "\n", "\n", "        ", "if", "self", ".", "random_start", ":", "\n", "            ", "eta", "=", "torch", ".", "FloatTensor", "(", "*", "inp", ".", "shape", ")", ".", "uniform_", "(", "-", "self", ".", "eps", ",", "self", ".", "eps", ")", "\n", "", "else", ":", "\n", "            ", "eta", "=", "torch", ".", "zeros_like", "(", "inp", ")", "\n", "", "eta", "=", "eta", ".", "to", "(", "self", ".", "DEVICE", ")", "\n", "eta", "=", "(", "eta", "-", "self", ".", "_mean", ")", "/", "self", ".", "_std", "\n", "net", ".", "eval", "(", ")", "\n", "\n", "inp", ".", "requires_grad", "=", "True", "\n", "eta", ".", "requires_grad", "=", "True", "\n", "for", "i", "in", "range", "(", "self", ".", "nb_iter", ")", ":", "\n", "            ", "eta", "=", "self", ".", "single_attack", "(", "net", ",", "inp", ",", "label", ",", "eta", ",", "target", ")", "\n", "#print(i)", "\n", "\n", "#print(eta.max())", "\n", "", "adv_inp", "=", "inp", "+", "eta", "\n", "tmp_adv_inp", "=", "adv_inp", "*", "self", ".", "_std", "+", "self", ".", "_mean", "\n", "tmp_adv_inp", "=", "torch", ".", "clamp", "(", "tmp_adv_inp", ",", "0", ",", "1", ")", "\n", "adv_inp", "=", "(", "tmp_adv_inp", "-", "self", ".", "_mean", ")", "/", "self", ".", "_std", "\n", "\n", "return", "adv_inp", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to": [[105, 110], ["pgd.IPGD._mean.to", "pgd.IPGD._std.to", "pgd.IPGD.criterion.to"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["", "def", "to", "(", "self", ",", "device", ")", ":", "\n", "        ", "self", ".", "DEVICE", "=", "device", "\n", "self", ".", "_mean", "=", "self", ".", "_mean", ".", "to", "(", "device", ")", "\n", "self", ".", "_std", "=", "self", ".", "_std", ".", "to", "(", "device", ")", "\n", "self", ".", "criterion", "=", "self", ".", "criterion", ".", "to", "(", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.test_IPGD": [[111, 113], ["None"], "function", ["None"], ["", "", "def", "test_IPGD", "(", ")", ":", "\n", "    ", "pass", "\n", "", "if", "__name__", "==", "'__main__'", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.abs_current_dir": [[14, 17], ["os.path.realpath"], "methods", ["None"], ["@", "property", "\n", "def", "abs_current_dir", "(", "self", ")", ":", "\n", "        ", "return", "os", ".", "path", ".", "realpath", "(", "'./'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.log_dir": [[18, 23], ["os.path.join", "os.path.exists", "os.mkdir"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.mkdir"], ["", "@", "property", "\n", "def", "log_dir", "(", "self", ")", ":", "\n", "        ", "if", "not", "os", ".", "path", ".", "exists", "(", "'./log'", ")", ":", "\n", "            ", "os", ".", "mkdir", "(", "'./log'", ")", "\n", "", "return", "os", ".", "path", ".", "join", "(", "self", ".", "abs_current_dir", ",", "'log'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.model_dir": [[24, 32], ["os.path.join", "os.path.exists", "os.mkdir"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.mkdir"], ["", "@", "property", "\n", "def", "model_dir", "(", "self", ")", ":", "\n", "        ", "log_dir", "=", "self", ".", "log_dir", "\n", "model_dir", "=", "os", ".", "path", ".", "join", "(", "log_dir", ",", "'models'", ")", "\n", "#print(model_dir)", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "model_dir", ")", ":", "\n", "            ", "os", ".", "mkdir", "(", "model_dir", ")", "\n", "", "return", "model_dir", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.lib_dir": [[33, 36], ["None"], "methods", ["None"], ["", "@", "abstractproperty", "\n", "def", "lib_dir", "(", "self", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.num_epochs": [[38, 41], ["None"], "methods", ["None"], ["", "@", "abstractproperty", "\n", "def", "num_epochs", "(", "self", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.val_interval": [[42, 49], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "val_interval", "(", "self", ")", ":", "\n", "        ", "'''\n        Specify how many epochs between two validation steps\n        Return <= 0 means no validation phase\n        '''", "\n", "return", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.create_optimizer": [[50, 57], ["None"], "methods", ["None"], ["", "@", "abstractmethod", "\n", "def", "create_optimizer", "(", "self", ",", "params", ")", "->", "torch", ".", "optim", ".", "Optimizer", ":", "\n", "        ", "'''\n        params (iterable): iterable of parameters to optimize or dicts defining\n                           parameter groups\n        '''", "\n", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.create_lr_scheduler": [[58, 61], ["None"], "methods", ["None"], ["", "@", "abstractmethod", "\n", "def", "create_lr_scheduler", "(", "self", ",", "optimizer", ":", "torch", ".", "optim", ".", "Optimizer", ")", "->", "torch", ".", "optim", ".", "lr_scheduler", ".", "_LRScheduler", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.create_loss_function": [[62, 65], ["None"], "methods", ["None"], ["", "@", "abstractmethod", "\n", "def", "create_loss_function", "(", "self", ")", "->", "torch", ".", "nn", ".", "modules", ".", "loss", ".", "_Loss", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.create_attack_method": [[67, 73], ["None"], "methods", ["None"], ["", "def", "create_attack_method", "(", "self", ",", "*", "inputs", ")", ":", "\n", "        ", "'''\n        Perform adversarial training against xxx adversary\n        Return None means natural training\n        '''", "\n", "return", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.create_evaluation_attack_method": [[76, 82], ["None"], "methods", ["None"], ["", "def", "create_evaluation_attack_method", "(", "self", ",", "*", "inputs", ")", ":", "\n", "        ", "'''\n        evaluating the robustness of model against xxx adversary\n        Return None means only measuring clean accuracy\n        '''", "\n", "return", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.SGDOptimizerMaker.__init__": [[88, 92], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "lr", "=", "0.1", ",", "momentum", "=", "0.9", ",", "weight_decay", "=", "1e-4", ")", ":", "\n", "        ", "self", ".", "lr", "=", "lr", "\n", "self", ".", "momentum", "=", "momentum", "\n", "self", ".", "weight_decay", "=", "weight_decay", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.SGDOptimizerMaker.__call__": [[93, 95], ["torch.optim.SGD"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "params", ")", ":", "\n", "        ", "return", "torch", ".", "optim", ".", "SGD", "(", "params", ",", "lr", "=", "self", ".", "lr", ",", "momentum", "=", "self", ".", "momentum", ",", "weight_decay", "=", "self", ".", "weight_decay", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.PieceWiseConstantLrSchedulerMaker.__init__": [[99, 102], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "milestones", ":", "List", "[", "int", "]", ",", "gamma", ":", "float", "=", "0.1", ")", ":", "\n", "        ", "self", ".", "milestones", "=", "milestones", "\n", "self", ".", "gamma", "=", "gamma", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.PieceWiseConstantLrSchedulerMaker.__call__": [[103, 105], ["torch.optim.lr_scheduler.MultiStepLR"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "optimizer", ")", ":", "\n", "        ", "return", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", "(", "optimizer", ",", "milestones", "=", "self", ".", "milestones", ",", "gamma", "=", "self", ".", "gamma", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.IPGDAttackMethodMaker.__init__": [[108, 115], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "eps", ",", "sigma", ",", "nb_iters", ",", "norm", ",", "mean", ",", "std", ")", ":", "\n", "        ", "self", ".", "eps", "=", "eps", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "nb_iters", "=", "nb_iters", "\n", "self", ".", "norm", "=", "norm", "\n", "self", ".", "mean", "=", "mean", "\n", "self", ".", "std", "=", "std", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.IPGDAttackMethodMaker.__call__": [[116, 123], ["os.path.join", "IPGD", "sys.path.append", "os.path.realpath().split", "os.path.realpath"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "DEVICE", ")", ":", "\n", "        ", "father_dir", "=", "os", ".", "path", ".", "join", "(", "'/'", ",", "*", "os", ".", "path", ".", "realpath", "(", "__file__", ")", ".", "split", "(", "os", ".", "path", ".", "sep", ")", "[", ":", "-", "2", "]", ")", "\n", "# print(father_dir)", "\n", "if", "not", "father_dir", "in", "sys", ".", "path", ":", "\n", "            ", "sys", ".", "path", ".", "append", "(", "father_dir", ")", "\n", "", "from", "attack", ".", "pgd", "import", "IPGD", "\n", "return", "IPGD", "(", "self", ".", "eps", ",", "self", ".", "sigma", ",", "self", ".", "nb_iters", ",", "self", ".", "norm", ",", "DEVICE", ",", "self", ".", "mean", ",", "self", ".", "std", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.LambdaLrSchedulerMaker.__init__": [[127, 132], ["callable"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "func", ",", "last_epoch", "=", "-", "1", ")", ":", "\n", "        ", "assert", "callable", "(", "func", ")", "\n", "\n", "self", ".", "func", "=", "func", "\n", "self", ".", "last_epoch", "=", "last_epoch", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.LambdaLrSchedulerMaker.__call__": [[133, 137], ["LambdaLR"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "parameters", ")", ":", "\n", "        ", "from", "torch", ".", "optim", ".", "lr_scheduler", "import", "LambdaLR", "\n", "lr_schduler", "=", "LambdaLR", "(", "parameters", ",", "self", ".", "func", ",", "self", ".", "last_epoch", ")", "\n", "return", "lr_schduler", "\n", "", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.train.train_one_epoch": [[12, 70], ["torch.device", "net.train", "tqdm.tqdm", "tqdm.tqdm.set_description", "enumerate", "data.to.to", "label.to.to", "optimizer.zero_grad", "collections.OrderedDict", "net", "criterion", "criterion.backward", "optimizer.step", "utils.misc.torch_accuracy", "acc[].item", "criterion.item", "tqdm.tqdm.set_postfix", "AttackMethod.attack", "optimizer.zero_grad", "net.train", "net", "criterion", "utils.misc.torch_accuracy", "acc[].item", "criterion.item"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.attack", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy"], ["def", "train_one_epoch", "(", "net", ",", "batch_generator", ",", "optimizer", ",", "\n", "criterion", ",", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ",", "\n", "descrip_str", "=", "'Training'", ",", "AttackMethod", "=", "None", ",", "adv_coef", "=", "1.0", ")", ":", "\n", "    ", "'''\n\n    :param attack_freq:  Frequencies of training with adversarial examples. -1 indicates natural training\n    :param AttackMethod: the attack method, None represents natural training\n    :return:  None    #(clean_acc, adv_acc)\n    '''", "\n", "net", ".", "train", "(", ")", "\n", "pbar", "=", "tqdm", "(", "batch_generator", ")", "\n", "advacc", "=", "-", "1", "\n", "advloss", "=", "-", "1", "\n", "cleanacc", "=", "-", "1", "\n", "cleanloss", "=", "-", "1", "\n", "pbar", ".", "set_description", "(", "descrip_str", ")", "\n", "for", "i", ",", "(", "data", ",", "label", ")", "in", "enumerate", "(", "pbar", ")", ":", "\n", "        ", "data", "=", "data", ".", "to", "(", "DEVICE", ")", "\n", "label", "=", "label", ".", "to", "(", "DEVICE", ")", "\n", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "TotalLoss", "=", "0", "\n", "\n", "if", "AttackMethod", "is", "not", "None", ":", "\n", "            ", "adv_inp", "=", "AttackMethod", ".", "attack", "(", "net", ",", "data", ",", "label", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "net", ".", "train", "(", ")", "\n", "pred", "=", "net", "(", "adv_inp", ")", "\n", "loss", "=", "criterion", "(", "pred", ",", "label", ")", "\n", "\n", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "advacc", "=", "acc", "[", "0", "]", ".", "item", "(", ")", "\n", "advloss", "=", "loss", ".", "item", "(", ")", "\n", "#TotalLoss = TotalLoss + loss * adv_coef", "\n", "(", "loss", "*", "adv_coef", ")", ".", "backward", "(", ")", "\n", "\n", "\n", "", "pred", "=", "net", "(", "data", ")", "\n", "\n", "loss", "=", "criterion", "(", "pred", ",", "label", ")", "\n", "#TotalLoss = TotalLoss + loss", "\n", "loss", ".", "backward", "(", ")", "\n", "#TotalLoss.backward()", "\n", "#param = next(net.parameters())", "\n", "#grad_mean = torch.mean(param.grad)", "\n", "\n", "optimizer", ".", "step", "(", ")", "\n", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "cleanacc", "=", "acc", "[", "0", "]", ".", "item", "(", ")", "\n", "cleanloss", "=", "loss", ".", "item", "(", ")", "\n", "#pbar_dic['grad'] = '{}'.format(grad_mean)", "\n", "pbar_dic", "[", "'Acc'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanacc", ")", "\n", "pbar_dic", "[", "'loss'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanloss", ")", "\n", "pbar_dic", "[", "'AdvAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "advacc", ")", "\n", "pbar_dic", "[", "'Advloss'", "]", "=", "'{:.2f}'", ".", "format", "(", "advloss", ")", "\n", "pbar", ".", "set_postfix", "(", "pbar_dic", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.train.eval_one_epoch": [[72, 104], ["torch.device", "net.eval", "tqdm.tqdm", "utils.misc.AvgMeter", "utils.misc.AvgMeter", "tqdm.tqdm.set_description", "data.to.to", "label.to.to", "collections.OrderedDict", "tqdm.tqdm.set_postfix", "torch.no_grad", "net", "utils.misc.torch_accuracy", "utils.misc.AvgMeter.update", "AttackMethod.attack", "acc[].item", "torch.no_grad", "net", "utils.misc.torch_accuracy", "utils.misc.AvgMeter.update", "acc[].item"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.update", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.attack", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.update"], ["", "", "def", "eval_one_epoch", "(", "net", ",", "batch_generator", ",", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ",", "AttackMethod", "=", "None", ")", ":", "\n", "    ", "net", ".", "eval", "(", ")", "\n", "pbar", "=", "tqdm", "(", "batch_generator", ")", "\n", "clean_accuracy", "=", "AvgMeter", "(", ")", "\n", "adv_accuracy", "=", "AvgMeter", "(", ")", "\n", "\n", "pbar", ".", "set_description", "(", "'Evaluating'", ")", "\n", "for", "(", "data", ",", "label", ")", "in", "pbar", ":", "\n", "        ", "data", "=", "data", ".", "to", "(", "DEVICE", ")", "\n", "label", "=", "label", ".", "to", "(", "DEVICE", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "pred", "=", "net", "(", "data", ")", "\n", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "clean_accuracy", ".", "update", "(", "acc", "[", "0", "]", ".", "item", "(", ")", ")", "\n", "\n", "", "if", "AttackMethod", "is", "not", "None", ":", "\n", "            ", "adv_inp", "=", "AttackMethod", ".", "attack", "(", "net", ",", "data", ",", "label", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "pred", "=", "net", "(", "adv_inp", ")", "\n", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "adv_accuracy", ".", "update", "(", "acc", "[", "0", "]", ".", "item", "(", ")", ")", "\n", "\n", "", "", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "pbar_dic", "[", "'CleanAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "clean_accuracy", ".", "mean", ")", "\n", "pbar_dic", "[", "'AdvAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "adv_accuracy", ".", "mean", ")", "\n", "\n", "pbar", ".", "set_postfix", "(", "pbar_dic", ")", "\n", "\n", "adv_acc", "=", "adv_accuracy", ".", "mean", "if", "AttackMethod", "is", "not", "None", "else", "0", "\n", "", "return", "clean_accuracy", ".", "mean", ",", "adv_acc", "\n", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.BasicBlock.__init__": [[19, 31], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "BasicBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "\n", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", ")", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "expansion", "*", "planes", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.BasicBlock.forward": [[33, 39], ["torch.relu", "torch.relu", "torch.relu", "cifar_resnet18.BasicBlock.bn2", "cifar_resnet18.BasicBlock.shortcut", "torch.relu", "torch.relu", "torch.relu", "cifar_resnet18.BasicBlock.bn1", "cifar_resnet18.BasicBlock.conv2", "cifar_resnet18.BasicBlock.conv1"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "self", ".", "conv1", "(", "x", ")", ")", ")", "\n", "out", "=", "self", ".", "bn2", "(", "self", ".", "conv2", "(", "out", ")", ")", "\n", "out", "+=", "self", ".", "shortcut", "(", "x", ")", "\n", "out", "=", "F", ".", "relu", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.Bottleneck.__init__": [[44, 58], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "Bottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "expansion", "*", "planes", ")", "\n", "\n", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", ")", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "expansion", "*", "planes", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.Bottleneck.forward": [[60, 67], ["torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "cifar_resnet18.Bottleneck.bn3", "cifar_resnet18.Bottleneck.shortcut", "torch.relu", "torch.relu", "torch.relu", "cifar_resnet18.Bottleneck.bn1", "cifar_resnet18.Bottleneck.bn2", "cifar_resnet18.Bottleneck.conv3", "cifar_resnet18.Bottleneck.conv1", "cifar_resnet18.Bottleneck.conv2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "self", ".", "conv1", "(", "x", ")", ")", ")", "\n", "out", "=", "F", ".", "relu", "(", "self", ".", "bn2", "(", "self", ".", "conv2", "(", "out", ")", ")", ")", "\n", "out", "=", "self", ".", "bn3", "(", "self", ".", "conv3", "(", "out", ")", ")", "\n", "out", "+=", "self", ".", "shortcut", "(", "x", ")", "\n", "out", "=", "F", ".", "relu", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.ResNet.__init__": [[70, 81], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "cifar_resnet18.ResNet._make_layer", "cifar_resnet18.ResNet._make_layer", "cifar_resnet18.ResNet._make_layer", "cifar_resnet18.ResNet._make_layer", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "ResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "64", ")", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "linear", "=", "nn", ".", "Linear", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.ResNet._make_layer": [[82, 89], ["torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.ResNet.forward": [[90, 100], ["torch.relu", "torch.relu", "torch.relu", "cifar_resnet18.ResNet.layer1", "cifar_resnet18.ResNet.layer2", "cifar_resnet18.ResNet.layer3", "cifar_resnet18.ResNet.layer4", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "cifar_resnet18.ResNet.view", "cifar_resnet18.ResNet.linear", "cifar_resnet18.ResNet.bn1", "cifar_resnet18.ResNet.size", "cifar_resnet18.ResNet.conv1"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "self", ".", "conv1", "(", "x", ")", ")", ")", "\n", "out", "=", "self", ".", "layer1", "(", "out", ")", "\n", "out", "=", "self", ".", "layer2", "(", "out", ")", "\n", "out", "=", "self", ".", "layer3", "(", "out", ")", "\n", "out", "=", "self", ".", "layer4", "(", "out", ")", "\n", "out", "=", "F", ".", "avg_pool2d", "(", "out", ",", "4", ")", "\n", "out", "=", "out", ".", "view", "(", "out", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "out", "=", "self", ".", "linear", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.cifar_resnet18": [[102, 104], ["cifar_resnet18.ResNet"], "function", ["None"], ["", "", "def", "cifar_resnet18", "(", "*", "args", ",", "**", "kargs", ")", ":", "\n", "    ", "return", "ResNet", "(", "BasicBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.ResNet34": [[105, 107], ["cifar_resnet18.ResNet"], "function", ["None"], ["", "def", "ResNet34", "(", ")", ":", "\n", "    ", "return", "ResNet", "(", "BasicBlock", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.ResNet50": [[108, 110], ["cifar_resnet18.ResNet"], "function", ["None"], ["", "def", "ResNet50", "(", ")", ":", "\n", "    ", "return", "ResNet", "(", "Bottleneck", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.ResNet101": [[111, 113], ["cifar_resnet18.ResNet"], "function", ["None"], ["", "def", "ResNet101", "(", ")", ":", "\n", "    ", "return", "ResNet", "(", "Bottleneck", ",", "[", "3", ",", "4", ",", "23", ",", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.ResNet152": [[114, 116], ["cifar_resnet18.ResNet"], "function", ["None"], ["", "def", "ResNet152", "(", ")", ":", "\n", "    ", "return", "ResNet", "(", "Bottleneck", ",", "[", "3", ",", "8", ",", "36", ",", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.cifar_resnet18.test": [[118, 122], ["ResNet18", "ResNet18.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["None"], ["", "def", "test", "(", ")", ":", "\n", "    ", "net", "=", "ResNet18", "(", ")", "\n", "y", "=", "net", "(", "torch", ".", "randn", "(", "1", ",", "3", ",", "32", ",", "32", ")", ")", "\n", "print", "(", "y", ".", "size", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActBlock.__init__": [[16, 26], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActBlock.forward": [[28, 35], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.conv1", "network.PreActBlock.conv2", "network.PreActBlock.bn1", "hasattr", "network.PreActBlock.shortcut", "torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.bn2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActResNet.__init__": [[39, 57], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.GlobalpoolFC", "network.PreActResNet.other_layers.append"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "PreActResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "layer_one", "=", "self", ".", "conv1", "\n", "\n", "\n", "self", ".", "other_layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "other_layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "\n", "self", ".", "linear", "=", "GlobalpoolFC", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "linear", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActResNet._make_layer": [[58, 67], ["torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "network.PreActResNet.other_layers.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "layers", "[", "-", "1", "]", ")", "\n", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActResNet.forward": [[68, 92], ["network.PreActResNet.layer_one", "network.PreActResNet.layer_one_out.requires_grad_", "network.PreActResNet.layer_one_out.retain_grad", "layer"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "x", "=", "self", ".", "layer_one", "(", "x", ")", "\n", "self", ".", "layer_one_out", "=", "x", "\n", "self", ".", "layer_one_out", ".", "requires_grad_", "(", ")", "\n", "self", ".", "layer_one_out", ".", "retain_grad", "(", ")", "\n", "x", "=", "self", ".", "layer_one_out", "\n", "\n", "for", "layer", "in", "self", ".", "other_layers", ":", "\n", "            ", "x", "=", "layer", "(", "x", ")", "\n", "\n", "\n", "", "'''\n        out = self.conv1(x)\n        out = self.layer1(out)\n        out = self.layer2(out)\n        out = self.layer3(out)\n        out = self.layer4(out)\n        out = F.avg_pool2d(out, 4)\n        out = out.view(out.size(0), -1)\n        out = self.linear(out)\n        return out\n        '''", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.GlobalpoolFC.__init__": [[95, 99], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_in", ",", "num_class", ")", ":", "\n", "        ", "super", "(", "GlobalpoolFC", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "num_in", ",", "num_class", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.GlobalpoolFC.forward": [[100, 105], ["network.GlobalpoolFC.pool", "network.GlobalpoolFC.reshape", "network.GlobalpoolFC.fc"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "pool", "(", "x", ")", "\n", "y", "=", "y", ".", "reshape", "(", "y", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "y", "=", "self", ".", "fc", "(", "y", ")", "\n", "return", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActBottleneck.__init__": [[119, 131], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActBottleneck.forward": [[133, 141], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.conv1", "network.PreActBottleneck.conv2", "network.PreActBottleneck.conv3", "network.PreActBottleneck.bn1", "hasattr", "network.PreActBottleneck.shortcut", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.bn2", "network.PreActBottleneck.bn3"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "=", "self", ".", "conv3", "(", "F", ".", "relu", "(", "self", ".", "bn3", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActResNet18": [[107, 109], ["network.PreActResNet"], "function", ["None"], ["", "", "def", "PreActResNet18", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.PreActResNet34": [[111, 113], ["network.PreActResNet"], "function", ["None"], ["", "def", "PreActResNet34", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.create_network": [[142, 144], ["network.PreActResNet18"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["", "", "def", "create_network", "(", ")", ":", "\n", "    ", "return", "PreActResNet18", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.network.test": [[146, 150], ["network.PreActResNet18", "PreActResNet18.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["", "def", "test", "(", ")", ":", "\n", "    ", "net", "=", "PreActResNet18", "(", ")", "\n", "y", "=", "net", "(", "(", "torch", ".", "randn", "(", "1", ",", "3", ",", "32", ",", "32", ")", ")", ")", "\n", "print", "(", "y", ".", "size", "(", ")", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.small_cnn.SmallCNN.__init__": [[15, 61], ["torch.Module.__init__", "torch.ReLU", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.ModuleList", "small_cnn.SmallCNN.other_layers.append", "small_cnn.SmallCNN.other_layers.append", "small_cnn.SmallCNN.modules", "torch.init.constant_", "torch.init.constant_", "collections.OrderedDict", "collections.OrderedDict", "collections.OrderedDict", "isinstance", "torch.init.kaiming_normal_", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.Conv2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.MaxPool2d", "torch.Linear", "torch.Dropout", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "drop", "=", "0.5", ")", ":", "\n", "        ", "super", "(", "SmallCNN", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "num_channels", "=", "1", "\n", "self", ".", "num_labels", "=", "10", "\n", "\n", "activ", "=", "nn", ".", "ReLU", "(", "True", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "self", ".", "num_channels", ",", "32", ",", "3", ")", "\n", "self", ".", "layer_one", "=", "nn", ".", "Sequential", "(", "OrderedDict", "(", "[", "\n", "(", "'conv1'", ",", "self", ".", "conv1", ")", ",", "\n", "(", "'relu1'", ",", "activ", ")", ",", "]", ")", ")", "\n", "\n", "\n", "self", ".", "feature_extractor", "=", "nn", ".", "Sequential", "(", "OrderedDict", "(", "[", "\n", "(", "'conv2'", ",", "nn", ".", "Conv2d", "(", "32", ",", "32", ",", "3", ")", ")", ",", "\n", "(", "'relu2'", ",", "activ", ")", ",", "\n", "(", "'maxpool1'", ",", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ")", ")", ",", "\n", "(", "'conv3'", ",", "nn", ".", "Conv2d", "(", "32", ",", "64", ",", "3", ")", ")", ",", "\n", "(", "'relu3'", ",", "activ", ")", ",", "\n", "(", "'conv4'", ",", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "3", ")", ")", ",", "\n", "(", "'relu4'", ",", "activ", ")", ",", "\n", "(", "'maxpool2'", ",", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ")", ")", ",", "\n", "]", ")", ")", "\n", "\n", "self", ".", "classifier", "=", "nn", ".", "Sequential", "(", "OrderedDict", "(", "[", "\n", "(", "'fc1'", ",", "nn", ".", "Linear", "(", "64", "*", "4", "*", "4", ",", "200", ")", ")", ",", "\n", "(", "'relu1'", ",", "activ", ")", ",", "\n", "(", "'drop'", ",", "nn", ".", "Dropout", "(", "drop", ")", ")", ",", "\n", "(", "'fc2'", ",", "nn", ".", "Linear", "(", "200", ",", "200", ")", ")", ",", "\n", "(", "'relu2'", ",", "activ", ")", ",", "\n", "(", "'fc3'", ",", "nn", ".", "Linear", "(", "200", ",", "self", ".", "num_labels", ")", ")", ",", "\n", "]", ")", ")", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "feature_extractor", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "classifier", ")", "\n", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "(", "nn", ".", "Conv2d", ")", ")", ":", "\n", "                ", "nn", ".", "init", ".", "kaiming_normal_", "(", "m", ".", "weight", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "nn", ".", "init", ".", "constant_", "(", "self", ".", "classifier", ".", "fc3", ".", "weight", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "self", ".", "classifier", ".", "fc3", ".", "bias", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.small_cnn.SmallCNN.forward": [[62, 70], ["small_cnn.SmallCNN.layer_one", "small_cnn.SmallCNN.layer_one_out.requires_grad_", "small_cnn.SmallCNN.layer_one_out.retain_grad", "small_cnn.SmallCNN.feature_extractor", "small_cnn.SmallCNN.classifier", "small_cnn.SmallCNN.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "y", "=", "self", ".", "layer_one", "(", "input", ")", "\n", "self", ".", "layer_one_out", "=", "y", "\n", "self", ".", "layer_one_out", ".", "requires_grad_", "(", ")", "\n", "self", ".", "layer_one_out", ".", "retain_grad", "(", ")", "\n", "features", "=", "self", ".", "feature_extractor", "(", "y", ")", "\n", "logits", "=", "self", ".", "classifier", "(", "features", ".", "view", "(", "-", "1", ",", "64", "*", "4", "*", "4", ")", ")", "\n", "return", "logits", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.small_cnn.create_network": [[71, 73], ["small_cnn.SmallCNN"], "function", ["None"], ["", "", "def", "create_network", "(", ")", ":", "\n", "    ", "return", "SmallCNN", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.small_cnn.test": [[75, 79], ["small_cnn.create_network", "create_network.", "print", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["", "def", "test", "(", ")", ":", "\n", "    ", "net", "=", "create_network", "(", ")", "\n", "y", "=", "net", "(", "(", "torch", ".", "randn", "(", "1", ",", "1", ",", "28", ",", "28", ")", ")", ")", "\n", "print", "(", "y", ".", "size", "(", ")", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.BasicBlock.__init__": [[18, 32], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_planes", ",", "out_planes", ",", "stride", ",", "dropRate", "=", "0.0", ")", ":", "\n", "        ", "super", "(", "BasicBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "relu1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "out_planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "out_planes", ")", "\n", "self", ".", "relu2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "out_planes", ",", "out_planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "droprate", "=", "dropRate", "\n", "self", ".", "equalInOut", "=", "(", "in_planes", "==", "out_planes", ")", "\n", "self", ".", "convShortcut", "=", "(", "not", "self", ".", "equalInOut", ")", "and", "nn", ".", "Conv2d", "(", "in_planes", ",", "out_planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "0", ",", "bias", "=", "False", ")", "or", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.BasicBlock.forward": [[33, 43], ["wide_resnet.BasicBlock.relu2", "wide_resnet.BasicBlock.conv2", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "wide_resnet.BasicBlock.relu1", "wide_resnet.BasicBlock.relu1", "wide_resnet.BasicBlock.bn2", "torch.dropout", "torch.dropout", "torch.dropout", "wide_resnet.BasicBlock.bn1", "wide_resnet.BasicBlock.bn1", "wide_resnet.BasicBlock.conv1", "wide_resnet.BasicBlock.convShortcut"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "if", "not", "self", ".", "equalInOut", ":", "\n", "            ", "x", "=", "self", ".", "relu1", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "", "else", ":", "\n", "            ", "out", "=", "self", ".", "relu1", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "", "out", "=", "self", ".", "relu2", "(", "self", ".", "bn2", "(", "self", ".", "conv1", "(", "out", "if", "self", ".", "equalInOut", "else", "x", ")", ")", ")", "\n", "if", "self", ".", "droprate", ">", "0", ":", "\n", "            ", "out", "=", "F", ".", "dropout", "(", "out", ",", "p", "=", "self", ".", "droprate", ",", "training", "=", "self", ".", "training", ")", "\n", "", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "return", "torch", ".", "add", "(", "x", "if", "self", ".", "equalInOut", "else", "self", ".", "convShortcut", "(", "x", ")", ",", "out", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.NetworkBlock.__init__": [[46, 49], ["torch.Module.__init__", "wide_resnet.NetworkBlock._make_layer"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "nb_layers", ",", "in_planes", ",", "out_planes", ",", "block", ",", "stride", ",", "dropRate", "=", "0.0", ")", ":", "\n", "        ", "super", "(", "NetworkBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layer", "=", "self", ".", "_make_layer", "(", "block", ",", "in_planes", ",", "out_planes", ",", "nb_layers", ",", "stride", ",", "dropRate", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.NetworkBlock._make_layer": [[50, 55], ["range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "int", "layers.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "in_planes", ",", "out_planes", ",", "nb_layers", ",", "stride", ",", "dropRate", ")", ":", "\n", "        ", "layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "int", "(", "nb_layers", ")", ")", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "i", "==", "0", "and", "in_planes", "or", "out_planes", ",", "out_planes", ",", "i", "==", "0", "and", "stride", "or", "1", ",", "dropRate", ")", ")", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.NetworkBlock.forward": [[56, 58], ["wide_resnet.NetworkBlock.layer"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "layer", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.WideResNet.__init__": [[61, 104], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "wide_resnet.NetworkBlock", "wide_resnet.WideResNet.other_layers.append", "wide_resnet.NetworkBlock", "wide_resnet.WideResNet.other_layers.append", "wide_resnet.NetworkBlock", "wide_resnet.WideResNet.other_layers.append", "wide_resnet.NetworkBlock", "wide_resnet.WideResNet.other_layers.append", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "wide_resnet.WideResNet.other_layers.append", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Linear", "torch.Linear", "torch.Linear", "wide_resnet.WideResNet.other_layers.append"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "depth", "=", "28", ",", "num_classes", "=", "10", ",", "widen_factor", "=", "10", ",", "dropRate", "=", "0.0", ")", ":", "\n", "        ", "super", "(", "WideResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "nChannels", "=", "[", "16", ",", "16", "*", "widen_factor", ",", "32", "*", "widen_factor", ",", "64", "*", "widen_factor", "]", "\n", "assert", "(", "(", "depth", "-", "4", ")", "%", "6", "==", "0", ")", "\n", "n", "=", "(", "depth", "-", "4", ")", "/", "6", "\n", "block", "=", "BasicBlock", "\n", "# 1st conv before any network block", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "nChannels", "[", "0", "]", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "layer_one", "=", "self", ".", "conv1", "\n", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "# 1st block", "\n", "self", ".", "block1", "=", "NetworkBlock", "(", "n", ",", "nChannels", "[", "0", "]", ",", "nChannels", "[", "1", "]", ",", "block", ",", "1", ",", "dropRate", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "block1", ")", "\n", "# 1st sub-block", "\n", "self", ".", "sub_block1", "=", "NetworkBlock", "(", "n", ",", "nChannels", "[", "0", "]", ",", "nChannels", "[", "1", "]", ",", "block", ",", "1", ",", "dropRate", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "sub_block1", ")", "\n", "# 2nd block", "\n", "self", ".", "block2", "=", "NetworkBlock", "(", "n", ",", "nChannels", "[", "1", "]", ",", "nChannels", "[", "2", "]", ",", "block", ",", "2", ",", "dropRate", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "block2", ")", "\n", "# 3rd block", "\n", "self", ".", "block3", "=", "NetworkBlock", "(", "n", ",", "nChannels", "[", "2", "]", ",", "nChannels", "[", "3", "]", ",", "block", ",", "2", ",", "dropRate", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "block3", ")", "\n", "# global average pooling and classifier", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "nChannels", "[", "3", "]", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "bn1", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "nChannels", "[", "3", "]", ",", "num_classes", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "fc", ")", "\n", "self", ".", "nChannels", "=", "nChannels", "[", "3", "]", "\n", "\n", "'''\n        for m in self.modules():\n            if isinstance(m, nn.Conv2d):\n                n = m.kernel_size[0] * m.kernel_size[1] * m.out_channels\n                m.weight.data.normal_(0, math.sqrt(2. / n))\n            elif isinstance(m, nn.BatchNorm2d):\n                m.weight.data.fill_(1)\n                m.bias.data.zero_()\n            elif isinstance(m, nn.Linear):\n                m.bias.data.zero_()\n        '''", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.WideResNet.forward": [[105, 119], ["wide_resnet.WideResNet.conv1", "wide_resnet.WideResNet.layer_one_out.requires_grad_", "wide_resnet.WideResNet.layer_one_out.retain_grad", "wide_resnet.WideResNet.block1", "wide_resnet.WideResNet.block2", "wide_resnet.WideResNet.block3", "wide_resnet.WideResNet.relu", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "out.view.view.view", "wide_resnet.WideResNet.fc", "wide_resnet.WideResNet.bn1"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "ret_cls1", "=", "True", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv1", "(", "x", ")", "\n", "self", ".", "layer_one_out", "=", "out", "\n", "self", ".", "layer_one_out", ".", "requires_grad_", "(", ")", "\n", "self", ".", "layer_one_out", ".", "retain_grad", "(", ")", "\n", "out", "=", "self", ".", "block1", "(", "out", ")", "\n", "out", "=", "self", ".", "block2", "(", "out", ")", "\n", "out", "=", "self", ".", "block3", "(", "out", ")", "\n", "out", "=", "self", ".", "relu", "(", "self", ".", "bn1", "(", "out", ")", ")", "\n", "out", "=", "F", ".", "avg_pool2d", "(", "out", ",", "8", ")", "\n", "out", "=", "out", ".", "view", "(", "-", "1", ",", "self", ".", "nChannels", ")", "\n", "\n", "y", "=", "self", ".", "fc", "(", "out", ")", "\n", "return", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.wide_resnet.create_network": [[121, 125], ["wide_resnet.WideResNet"], "function", ["None"], ["", "", "def", "create_network", "(", ")", ":", "\n", "    ", "net", "=", "WideResNet", "(", ")", "\n", "\n", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActBlock.__init__": [[15, 25], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActBlock.forward": [[27, 34], ["torch.relu", "torch.relu", "torch.relu", "preact_resnet.PreActBlock.conv1", "preact_resnet.PreActBlock.conv2", "preact_resnet.PreActBlock.bn1", "hasattr", "preact_resnet.PreActBlock.shortcut", "torch.relu", "torch.relu", "torch.relu", "preact_resnet.PreActBlock.bn2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActResNet.__init__": [[38, 57], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "preact_resnet.PreActResNet.layers.append", "preact_resnet.PreActResNet._make_layer", "preact_resnet.PreActResNet._make_layer", "preact_resnet.PreActResNet._make_layer", "preact_resnet.PreActResNet._make_layer", "preact_resnet.GlobalpoolFC", "preact_resnet.PreActResNet.layers.append", "preact_resnet.PreActResNet.is_trainable.append"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "PreActResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "layers", ".", "append", "(", "self", ".", "conv1", ")", "\n", "self", ".", "is_trainable", "=", "[", "True", "]", "\n", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "\n", "self", ".", "linear", "=", "GlobalpoolFC", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "self", ".", "layers", ".", "append", "(", "self", ".", "linear", ")", "\n", "self", ".", "is_trainable", ".", "append", "(", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActResNet._make_layer": [[58, 67], ["torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "preact_resnet.PreActResNet.layers.append", "preact_resnet.PreActResNet.is_trainable.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n", "self", ".", "layers", ".", "append", "(", "layers", "[", "-", "1", "]", ")", "\n", "self", ".", "is_trainable", ".", "append", "(", "True", ")", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActResNet.forward": [[68, 88], ["preact_resnet.PreActResNet.inputs.append", "layer", "preact_resnet.PreActResNet.inputs.append"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "self", ".", "inputs", "=", "[", "]", "\n", "self", ".", "inputs", ".", "append", "(", "x", ")", "\n", "\n", "for", "layer", "in", "self", ".", "layers", ":", "\n", "            ", "x", "=", "layer", "(", "x", ")", "\n", "self", ".", "inputs", ".", "append", "(", "x", ")", "\n", "\n", "", "'''\n        out = self.conv1(x)\n        out = self.layer1(out)\n        out = self.layer2(out)\n        out = self.layer3(out)\n        out = self.layer4(out)\n        out = F.avg_pool2d(out, 4)\n        out = out.view(out.size(0), -1)\n        out = self.linear(out)\n        return out\n        '''", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.GlobalpoolFC.__init__": [[92, 96], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_in", ",", "num_class", ")", ":", "\n", "        ", "super", "(", "GlobalpoolFC", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "num_in", ",", "num_class", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.GlobalpoolFC.forward": [[97, 102], ["preact_resnet.GlobalpoolFC.pool", "preact_resnet.GlobalpoolFC.reshape", "preact_resnet.GlobalpoolFC.fc"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "pool", "(", "x", ")", "\n", "y", "=", "y", ".", "reshape", "(", "y", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "y", "=", "self", ".", "fc", "(", "y", ")", "\n", "return", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActBottleneck.__init__": [[116, 128], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActBottleneck.forward": [[130, 138], ["torch.relu", "torch.relu", "torch.relu", "preact_resnet.PreActBottleneck.conv1", "preact_resnet.PreActBottleneck.conv2", "preact_resnet.PreActBottleneck.conv3", "preact_resnet.PreActBottleneck.bn1", "hasattr", "preact_resnet.PreActBottleneck.shortcut", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "preact_resnet.PreActBottleneck.bn2", "preact_resnet.PreActBottleneck.bn3"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "=", "self", ".", "conv3", "(", "F", ".", "relu", "(", "self", ".", "bn3", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActResNet18": [[104, 106], ["preact_resnet.PreActResNet"], "function", ["None"], ["", "", "def", "PreActResNet18", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.PreActResNet34": [[108, 110], ["preact_resnet.PreActResNet"], "function", ["None"], ["", "def", "PreActResNet34", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.base_model.preact_resnet.test": [[140, 144], ["preact_resnet.PreActResNet18", "PreActResNet18.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["", "", "def", "test", "(", ")", ":", "\n", "    ", "net", "=", "PreActResNet18", "(", ")", "\n", "y", "=", "net", "(", "(", "torch", ".", "randn", "(", "1", ",", "3", ",", "32", ",", "32", ")", ")", ")", "\n", "print", "(", "y", ".", "size", "(", ")", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.config.add_path": [[9, 13], ["print", "sys.path.append"], "function", ["None"], ["    ", "'''\n    Base class for training\n    '''", "\n", "\n", "# directory handling", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.training_function.FastGradientLayerOneTrainer.__init__": [[15, 22], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "Hamiltonian_func", ",", "param_optimizer", ",", "\n", "inner_steps", "=", "2", ",", "sigma", "=", "0.008", ",", "eps", "=", "0.03", ")", ":", "\n", "        ", "self", ".", "inner_steps", "=", "inner_steps", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "Hamiltonian_func", "=", "Hamiltonian_func", "\n", "self", ".", "param_optimizer", "=", "param_optimizer", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.training_function.FastGradientLayerOneTrainer.step": [[23, 59], ["p.detach.detach.detach", "range", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "loss.backward", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "[].sign", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "eta.detach.detach.detach", "eta.detach.detach.requires_grad_", "eta.detach.detach.retain_grad", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad"], "methods", ["None"], ["", "def", "step", "(", "self", ",", "inp", ",", "p", ",", "eta", ")", ":", "\n", "        ", "'''\n        Perform Iterative Sign Gradient on eta\n\n        ret: inp + eta\n        '''", "\n", "\n", "p", "=", "p", ".", "detach", "(", ")", "\n", "\n", "for", "i", "in", "range", "(", "self", ".", "inner_steps", ")", ":", "\n", "            ", "tmp_inp", "=", "inp", "+", "eta", "\n", "tmp_inp", "=", "torch", ".", "clamp", "(", "tmp_inp", ",", "0", ",", "1", ")", "\n", "H", "=", "self", ".", "Hamiltonian_func", "(", "tmp_inp", ",", "p", ")", "\n", "\n", "eta_grad_sign", "=", "torch", ".", "autograd", ".", "grad", "(", "H", ",", "eta", ",", "only_inputs", "=", "True", ",", "retain_graph", "=", "False", ")", "[", "0", "]", ".", "sign", "(", ")", "\n", "\n", "eta", "=", "eta", "-", "eta_grad_sign", "*", "self", ".", "sigma", "\n", "\n", "eta", "=", "torch", ".", "clamp", "(", "eta", ",", "-", "1.0", "*", "self", ".", "eps", ",", "self", ".", "eps", ")", "\n", "eta", "=", "torch", ".", "clamp", "(", "inp", "+", "eta", ",", "0.0", ",", "1.0", ")", "-", "inp", "\n", "eta", "=", "eta", ".", "detach", "(", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "eta", ".", "retain_grad", "(", ")", "\n", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "", "yofo_inp", "=", "eta", "+", "inp", "\n", "yofo_inp", "=", "torch", ".", "clamp", "(", "yofo_inp", ",", "0", ",", "1", ")", "\n", "\n", "loss", "=", "-", "1.0", "*", "self", ".", "Hamiltonian_func", "(", "yofo_inp", ",", "p", ")", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "#self.param_optimizer.step()", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "return", "yofo_inp", ",", "eta", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.training_function.train_one_epoch": [[63, 134], ["torch.device", "torch.device", "torch.device", "net.train", "tqdm.tqdm", "tqdm.tqdm.set_description", "enumerate", "data.to.to", "label.to.to", "torch.FloatTensor().uniform_", "torch.FloatTensor().uniform_", "torch.FloatTensor().uniform_", "eta.to.to", "eta.to.requires_grad_", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "range", "optimizer.step", "LayerOneTrainner.param_optimizer.step", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "tqdm.tqdm.set_postfix", "collections.OrderedDict", "net", "criterion", "TotalLoss.backward", "LayerOneTrainner.step", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.no_grad", "torch.no_grad", "torch.no_grad", "eta.to.detach", "utils.misc.torch_accuracy", "acc[].item", "criterion.item", "net", "[].item", "utils.misc.torch_accuracy"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy"], ["", "", "def", "train_one_epoch", "(", "net", ",", "batch_generator", ",", "optimizer", ",", "\n", "criterion", ",", "LayerOneTrainner", ",", "K", ",", "\n", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ",", "descrip_str", "=", "'Training'", ")", ":", "\n", "    ", "'''\n\n    :param attack_freq:  Frequencies of training with adversarial examples. -1 indicates natural training\n    :param AttackMethod: the attack method, None represents natural training\n    :return:  None    #(clean_acc, adv_acc)\n    '''", "\n", "net", ".", "train", "(", ")", "\n", "pbar", "=", "tqdm", "(", "batch_generator", ")", "\n", "yofoacc", "=", "-", "1", "\n", "cleanacc", "=", "-", "1", "\n", "cleanloss", "=", "-", "1", "\n", "pbar", ".", "set_description", "(", "descrip_str", ")", "\n", "for", "i", ",", "(", "data", ",", "label", ")", "in", "enumerate", "(", "pbar", ")", ":", "\n", "        ", "data", "=", "data", ".", "to", "(", "DEVICE", ")", "\n", "label", "=", "label", ".", "to", "(", "DEVICE", ")", "\n", "\n", "eta", "=", "torch", ".", "FloatTensor", "(", "*", "data", ".", "shape", ")", ".", "uniform_", "(", "-", "config", ".", "eps", ",", "config", ".", "eps", ")", "\n", "eta", "=", "eta", ".", "to", "(", "label", ".", "device", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "for", "j", "in", "range", "(", "K", ")", ":", "\n", "#optimizer.zero_grad()", "\n", "\n", "            ", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "TotalLoss", "=", "0", "\n", "\n", "pred", "=", "net", "(", "data", "+", "eta", ".", "detach", "(", ")", ")", "\n", "\n", "loss", "=", "criterion", "(", "pred", ",", "label", ")", "\n", "TotalLoss", "=", "TotalLoss", "+", "loss", "\n", "wgrad", "=", "net", ".", "conv1", ".", "weight", ".", "grad", "\n", "#bgrad = net.conv1.bias.grad", "\n", "TotalLoss", ".", "backward", "(", ")", "\n", "net", ".", "conv1", ".", "weight", ".", "grad", "=", "wgrad", "\n", "#net.conv1.bias.grad = bgrad", "\n", "#param = next(net.parameters())", "\n", "#grad_mean = torch.mean(param.grad)", "\n", "\n", "#optimizer.step()", "\n", "#optimizer.zero_grad()", "\n", "\n", "p", "=", "-", "1.0", "*", "net", ".", "layer_one_out", ".", "grad", "\n", "yofo_inp", ",", "eta", "=", "LayerOneTrainner", ".", "step", "(", "data", ",", "p", ",", "eta", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "if", "j", "==", "0", ":", "\n", "                    ", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "cleanacc", "=", "acc", "[", "0", "]", ".", "item", "(", ")", "\n", "cleanloss", "=", "loss", ".", "item", "(", ")", "\n", "\n", "", "if", "j", "==", "K", "-", "1", ":", "\n", "                    ", "yofo_pred", "=", "net", "(", "yofo_inp", ")", "\n", "yofoacc", "=", "torch_accuracy", "(", "yofo_pred", ",", "label", ",", "(", "1", ",", ")", ")", "[", "0", "]", ".", "item", "(", ")", "\n", "#pbar_dic['grad'] = '{}'.format(grad_mean)", "\n", "\n", "", "", "", "optimizer", ".", "step", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "step", "(", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "pbar_dic", "[", "'Acc'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanacc", ")", "\n", "pbar_dic", "[", "'loss'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanloss", ")", "\n", "pbar_dic", "[", "'YofoAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "yofoacc", ")", "\n", "pbar", ".", "set_postfix", "(", "pbar_dic", ")", "\n", "\n", "", "return", "cleanacc", ",", "yofoacc", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.network.create_network": [[4, 6], ["base_model.wide_resnet.WideResNet"], "function", ["None"], ["\n", "import", "torch", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.network.test": [[8, 12], ["network.create_network", "create_network.", "print", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["import", "torch", ".", "nn", ".", "functional", "as", "F", "\n", "\n", "\n", "\n", "class", "PreActBlock", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.dataset.create_train_dataset": [[5, 19], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.RandomCrop", "torchvision.RandomHorizontalFlip", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.dataset.create_test_dataset": [[19, 28], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "testset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "False", ",", "download", "=", "True", ",", "transform", "=", "transform_test", ")", "\n", "#testset = torchvision.datasets.MNIST(root=root, train=False, download=True, transform=transform_test)", "\n", "testloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "testset", ",", "batch_size", "=", "100", ",", "shuffle", "=", "False", ",", "num_workers", "=", "2", ")", "\n", "return", "testloader", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.loss.Hamiltonian.__init__": [[9, 13], ["torch.nn.modules.loss._Loss.__init__"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "layer", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "Hamiltonian", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layer", "=", "layer", "\n", "self", ".", "reg_cof", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.loss.Hamiltonian.forward": [[15, 25], ["loss.Hamiltonian.layer", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "p", ")", ":", "\n", "\n", "        ", "y", "=", "self", ".", "layer", "(", "x", ")", "\n", "#l2 = cal_l2_norm(self.layer)", "\n", "\n", "#print(y.shape, p.shape)", "\n", "H", "=", "torch", ".", "sum", "(", "y", "*", "p", ")", "\n", "\n", "#H = H - self.reg_cof * l2", "\n", "return", "H", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.loss.CrossEntropyWithWeightPenlty.__init__": [[29, 35], ["torch.nn.modules.loss._Loss.__init__", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["    ", "def", "__init__", "(", "self", ",", "module", ",", "DEVICE", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "CrossEntropyWithWeightPenlty", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "reg_cof", "=", "reg_cof", "\n", "self", ".", "criterion", "=", "nn", ".", "CrossEntropyLoss", "(", ")", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "module", "=", "module", "\n", "#print(modules, 'dwadaQ!')", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.loss.CrossEntropyWithWeightPenlty.__call__": [[37, 48], ["loss.CrossEntropyWithWeightPenlty.criterion", "loss.cal_l2_norm"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm"], ["", "def", "__call__", "(", "self", ",", "pred", ",", "label", ")", ":", "\n", "        ", "cross_loss", "=", "self", ".", "criterion", "(", "pred", ",", "label", ")", "\n", "weight_loss", "=", "0", "\n", "#for module in self.module:", "\n", "#    print(module)", "\n", "#    weight_loss = weight_loss + cal_l2_norm(module)", "\n", "\n", "weight_loss", "=", "cal_l2_norm", "(", "self", ".", "module", ")", "\n", "\n", "loss", "=", "cross_loss", "+", "self", ".", "reg_cof", "*", "weight_loss", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.yopo-5-3.loss.cal_l2_norm": [[49, 56], ["layer.named_parameters", "torch.norm", "torch.norm", "torch.norm"], "function", ["None"], ["", "", "def", "cal_l2_norm", "(", "layer", ":", "torch", ".", "nn", ".", "Module", ")", ":", "\n", " ", "loss", "=", "0.", "\n", "for", "name", ",", "param", "in", "layer", ".", "named_parameters", "(", ")", ":", "\n", "     ", "if", "name", "==", "'weight'", ":", "\n", "         ", "loss", "=", "loss", "+", "0.5", "*", "torch", ".", "norm", "(", "param", ",", ")", "**", "2", "\n", "\n", "", "", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.pgd10.config.add_path": [[8, 12], ["print", "sys.path.append"], "function", ["None"], ["class", "TrainingConfigBase", "(", "metaclass", "=", "ABCMeta", ")", ":", "\n", "    ", "'''\n    Base class for training\n    '''", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.pgd10.network.create_network": [[4, 6], ["base_model.wide_resnet.WideResNet"], "function", ["None"], ["\n", "import", "torch", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.pgd10.network.test": [[8, 12], ["network.create_network", "create_network.", "print", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["import", "torch", ".", "nn", ".", "functional", "as", "F", "\n", "\n", "\n", "\n", "class", "PreActBlock", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.pgd10.dataset.create_train_dataset": [[5, 19], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.RandomCrop", "torchvision.RandomHorizontalFlip", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.pgd10.dataset.create_test_dataset": [[19, 28], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "testset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "False", ",", "download", "=", "True", ",", "transform", "=", "transform_test", ")", "\n", "#testset = torchvision.datasets.MNIST(root=root, train=False, download=True, transform=transform_test)", "\n", "testloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "testset", ",", "batch_size", "=", "100", ",", "shuffle", "=", "False", ",", "num_workers", "=", "2", ")", "\n", "return", "testloader", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.config.add_path": [[8, 12], ["print", "sys.path.append"], "function", ["None"], ["class", "TrainingConfigBase", "(", "metaclass", "=", "ABCMeta", ")", ":", "\n", "    ", "'''\n    Base class for training\n    '''", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActBlock.__init__": [[16, 26], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActBlock.forward": [[28, 35], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.conv1", "network.PreActBlock.conv2", "network.PreActBlock.bn1", "hasattr", "network.PreActBlock.shortcut", "torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.bn2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActResNet.__init__": [[39, 57], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.GlobalpoolFC", "network.PreActResNet.other_layers.append"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "PreActResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "layer_one", "=", "self", ".", "conv1", "\n", "\n", "\n", "self", ".", "other_layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "other_layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "\n", "self", ".", "linear", "=", "GlobalpoolFC", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "linear", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActResNet._make_layer": [[58, 67], ["torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "network.PreActResNet.other_layers.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "layers", "[", "-", "1", "]", ")", "\n", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActResNet.forward": [[68, 92], ["network.PreActResNet.layer_one", "network.PreActResNet.layer_one_out.requires_grad_", "network.PreActResNet.layer_one_out.retain_grad", "layer"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "x", "=", "self", ".", "layer_one", "(", "x", ")", "\n", "self", ".", "layer_one_out", "=", "x", "\n", "self", ".", "layer_one_out", ".", "requires_grad_", "(", ")", "\n", "self", ".", "layer_one_out", ".", "retain_grad", "(", ")", "\n", "x", "=", "self", ".", "layer_one_out", "\n", "\n", "for", "layer", "in", "self", ".", "other_layers", ":", "\n", "            ", "x", "=", "layer", "(", "x", ")", "\n", "\n", "\n", "", "'''\n        out = self.conv1(x)\n        out = self.layer1(out)\n        out = self.layer2(out)\n        out = self.layer3(out)\n        out = self.layer4(out)\n        out = F.avg_pool2d(out, 4)\n        out = out.view(out.size(0), -1)\n        out = self.linear(out)\n        return out\n        '''", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.GlobalpoolFC.__init__": [[95, 99], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_in", ",", "num_class", ")", ":", "\n", "        ", "super", "(", "GlobalpoolFC", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "num_in", ",", "num_class", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.GlobalpoolFC.forward": [[100, 105], ["network.GlobalpoolFC.pool", "network.GlobalpoolFC.reshape", "network.GlobalpoolFC.fc"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "pool", "(", "x", ")", "\n", "y", "=", "y", ".", "reshape", "(", "y", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "y", "=", "self", ".", "fc", "(", "y", ")", "\n", "return", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActBottleneck.__init__": [[119, 131], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActBottleneck.forward": [[133, 141], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.conv1", "network.PreActBottleneck.conv2", "network.PreActBottleneck.conv3", "network.PreActBottleneck.bn1", "hasattr", "network.PreActBottleneck.shortcut", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.bn2", "network.PreActBottleneck.bn3"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "=", "self", ".", "conv3", "(", "F", ".", "relu", "(", "self", ".", "bn3", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActResNet18": [[107, 109], ["network.PreActResNet"], "function", ["None"], ["", "", "def", "PreActResNet18", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.PreActResNet34": [[111, 113], ["network.PreActResNet"], "function", ["None"], ["", "def", "PreActResNet34", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.create_network": [[142, 144], ["network.PreActResNet18"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["", "", "def", "create_network", "(", ")", ":", "\n", "    ", "return", "PreActResNet18", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.network.test": [[146, 150], ["network.PreActResNet18", "PreActResNet18.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["", "def", "test", "(", ")", ":", "\n", "    ", "net", "=", "PreActResNet18", "(", ")", "\n", "y", "=", "net", "(", "(", "torch", ".", "randn", "(", "1", ",", "3", ",", "32", ",", "32", ")", ")", ")", "\n", "print", "(", "y", ".", "size", "(", ")", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.dataset.create_train_dataset": [[5, 19], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.RandomCrop", "torchvision.RandomHorizontalFlip", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.pgd10.dataset.create_test_dataset": [[19, 28], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "testset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "False", ",", "download", "=", "True", ",", "transform", "=", "transform_test", ")", "\n", "#testset = torchvision.datasets.MNIST(root=root, train=False, download=True, transform=transform_test)", "\n", "testloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "testset", ",", "batch_size", "=", "100", ",", "shuffle", "=", "False", ",", "num_workers", "=", "2", ")", "\n", "return", "testloader", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.config.add_path": [[9, 13], ["print", "sys.path.append"], "function", ["None"], ["    ", "'''\n    Base class for training\n    '''", "\n", "\n", "# directory handling", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.training_function.FastGradientLayerOneTrainer.__init__": [[15, 22], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "Hamiltonian_func", ",", "param_optimizer", ",", "\n", "inner_steps", "=", "2", ",", "sigma", "=", "0.008", ",", "eps", "=", "0.03", ")", ":", "\n", "        ", "self", ".", "inner_steps", "=", "inner_steps", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "Hamiltonian_func", "=", "Hamiltonian_func", "\n", "self", ".", "param_optimizer", "=", "param_optimizer", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.training_function.FastGradientLayerOneTrainer.step": [[23, 59], ["p.detach.detach.detach", "range", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "loss.backward", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "[].sign", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "eta.detach.detach.detach", "eta.detach.detach.requires_grad_", "eta.detach.detach.retain_grad", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad"], "methods", ["None"], ["", "def", "step", "(", "self", ",", "inp", ",", "p", ",", "eta", ")", ":", "\n", "        ", "'''\n        Perform Iterative Sign Gradient on eta\n\n        ret: inp + eta\n        '''", "\n", "\n", "p", "=", "p", ".", "detach", "(", ")", "\n", "\n", "for", "i", "in", "range", "(", "self", ".", "inner_steps", ")", ":", "\n", "            ", "tmp_inp", "=", "inp", "+", "eta", "\n", "tmp_inp", "=", "torch", ".", "clamp", "(", "tmp_inp", ",", "0", ",", "1", ")", "\n", "H", "=", "self", ".", "Hamiltonian_func", "(", "tmp_inp", ",", "p", ")", "\n", "\n", "eta_grad_sign", "=", "torch", ".", "autograd", ".", "grad", "(", "H", ",", "eta", ",", "only_inputs", "=", "True", ",", "retain_graph", "=", "False", ")", "[", "0", "]", ".", "sign", "(", ")", "\n", "\n", "eta", "=", "eta", "-", "eta_grad_sign", "*", "self", ".", "sigma", "\n", "\n", "eta", "=", "torch", ".", "clamp", "(", "eta", ",", "-", "1.0", "*", "self", ".", "eps", ",", "self", ".", "eps", ")", "\n", "eta", "=", "torch", ".", "clamp", "(", "inp", "+", "eta", ",", "0.0", ",", "1.0", ")", "-", "inp", "\n", "eta", "=", "eta", ".", "detach", "(", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "eta", ".", "retain_grad", "(", ")", "\n", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "", "yofo_inp", "=", "eta", "+", "inp", "\n", "yofo_inp", "=", "torch", ".", "clamp", "(", "yofo_inp", ",", "0", ",", "1", ")", "\n", "\n", "loss", "=", "-", "1.0", "*", "self", ".", "Hamiltonian_func", "(", "yofo_inp", ",", "p", ")", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "#self.param_optimizer.step()", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "return", "yofo_inp", ",", "eta", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.training_function.train_one_epoch": [[63, 134], ["torch.device", "torch.device", "torch.device", "net.train", "tqdm.tqdm", "tqdm.tqdm.set_description", "enumerate", "data.to.to", "label.to.to", "torch.FloatTensor().uniform_", "torch.FloatTensor().uniform_", "torch.FloatTensor().uniform_", "eta.to.to", "eta.to.requires_grad_", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "range", "optimizer.step", "LayerOneTrainner.param_optimizer.step", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "tqdm.tqdm.set_postfix", "collections.OrderedDict", "net", "criterion", "TotalLoss.backward", "LayerOneTrainner.step", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.no_grad", "torch.no_grad", "torch.no_grad", "eta.to.detach", "utils.misc.torch_accuracy", "acc[].item", "criterion.item", "net", "[].item", "utils.misc.torch_accuracy"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy"], ["", "", "def", "train_one_epoch", "(", "net", ",", "batch_generator", ",", "optimizer", ",", "\n", "criterion", ",", "LayerOneTrainner", ",", "K", ",", "\n", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ",", "descrip_str", "=", "'Training'", ")", ":", "\n", "    ", "'''\n\n    :param attack_freq:  Frequencies of training with adversarial examples. -1 indicates natural training\n    :param AttackMethod: the attack method, None represents natural training\n    :return:  None    #(clean_acc, adv_acc)\n    '''", "\n", "net", ".", "train", "(", ")", "\n", "pbar", "=", "tqdm", "(", "batch_generator", ")", "\n", "yofoacc", "=", "-", "1", "\n", "cleanacc", "=", "-", "1", "\n", "cleanloss", "=", "-", "1", "\n", "pbar", ".", "set_description", "(", "descrip_str", ")", "\n", "for", "i", ",", "(", "data", ",", "label", ")", "in", "enumerate", "(", "pbar", ")", ":", "\n", "        ", "data", "=", "data", ".", "to", "(", "DEVICE", ")", "\n", "label", "=", "label", ".", "to", "(", "DEVICE", ")", "\n", "\n", "eta", "=", "torch", ".", "FloatTensor", "(", "*", "data", ".", "shape", ")", ".", "uniform_", "(", "-", "config", ".", "eps", ",", "config", ".", "eps", ")", "\n", "eta", "=", "eta", ".", "to", "(", "label", ".", "device", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "for", "j", "in", "range", "(", "K", ")", ":", "\n", "#optimizer.zero_grad()", "\n", "\n", "            ", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "TotalLoss", "=", "0", "\n", "\n", "pred", "=", "net", "(", "data", "+", "eta", ".", "detach", "(", ")", ")", "\n", "\n", "loss", "=", "criterion", "(", "pred", ",", "label", ")", "\n", "TotalLoss", "=", "TotalLoss", "+", "loss", "\n", "wgrad", "=", "net", ".", "conv1", ".", "weight", ".", "grad", "\n", "#bgrad = net.conv1.bias.grad", "\n", "TotalLoss", ".", "backward", "(", ")", "\n", "net", ".", "conv1", ".", "weight", ".", "grad", "=", "wgrad", "\n", "#net.conv1.bias.grad = bgrad", "\n", "#param = next(net.parameters())", "\n", "#grad_mean = torch.mean(param.grad)", "\n", "\n", "#optimizer.step()", "\n", "#optimizer.zero_grad()", "\n", "\n", "p", "=", "-", "1.0", "*", "net", ".", "layer_one_out", ".", "grad", "\n", "yofo_inp", ",", "eta", "=", "LayerOneTrainner", ".", "step", "(", "data", ",", "p", ",", "eta", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "if", "j", "==", "0", ":", "\n", "                    ", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "cleanacc", "=", "acc", "[", "0", "]", ".", "item", "(", ")", "\n", "cleanloss", "=", "loss", ".", "item", "(", ")", "\n", "\n", "", "if", "j", "==", "K", "-", "1", ":", "\n", "                    ", "yofo_pred", "=", "net", "(", "yofo_inp", ")", "\n", "yofoacc", "=", "torch_accuracy", "(", "yofo_pred", ",", "label", ",", "(", "1", ",", ")", ")", "[", "0", "]", ".", "item", "(", ")", "\n", "#pbar_dic['grad'] = '{}'.format(grad_mean)", "\n", "\n", "", "", "", "optimizer", ".", "step", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "step", "(", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "pbar_dic", "[", "'Acc'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanacc", ")", "\n", "pbar_dic", "[", "'loss'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanloss", ")", "\n", "pbar_dic", "[", "'YofoAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "yofoacc", ")", "\n", "pbar", ".", "set_postfix", "(", "pbar_dic", ")", "\n", "\n", "", "return", "cleanacc", ",", "yofoacc", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActBlock.__init__": [[16, 26], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActBlock.forward": [[28, 35], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.conv1", "network.PreActBlock.conv2", "network.PreActBlock.bn1", "hasattr", "network.PreActBlock.shortcut", "torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.bn2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActResNet.__init__": [[39, 57], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.GlobalpoolFC", "network.PreActResNet.other_layers.append"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "PreActResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "layer_one", "=", "self", ".", "conv1", "\n", "\n", "\n", "self", ".", "other_layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "other_layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "\n", "self", ".", "linear", "=", "GlobalpoolFC", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "linear", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActResNet._make_layer": [[58, 67], ["torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "network.PreActResNet.other_layers.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "layers", "[", "-", "1", "]", ")", "\n", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActResNet.forward": [[68, 80], ["network.PreActResNet.layer_one", "network.PreActResNet.layer_one_out.requires_grad_", "network.PreActResNet.layer_one_out.retain_grad", "layer"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "x", "=", "self", ".", "layer_one", "(", "x", ")", "\n", "self", ".", "layer_one_out", "=", "x", "\n", "self", ".", "layer_one_out", ".", "requires_grad_", "(", ")", "\n", "self", ".", "layer_one_out", ".", "retain_grad", "(", ")", "\n", "x", "=", "self", ".", "layer_one_out", "\n", "\n", "for", "layer", "in", "self", ".", "other_layers", ":", "\n", "            ", "x", "=", "layer", "(", "x", ")", "\n", "\n", "\n", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.GlobalpoolFC.__init__": [[84, 88], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], []], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.GlobalpoolFC.forward": [[89, 94], ["network.GlobalpoolFC.pool", "network.GlobalpoolFC.reshape", "network.GlobalpoolFC.fc"], "methods", ["None"], ["\n", "return", "x", "\n", "\n", "", "", "class", "GlobalpoolFC", "(", "nn", ".", "Module", ")", ":", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActBottleneck.__init__": [[108, 120], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ")", "\n", "\n", "\n", "", "def", "PreActResNet34", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n", "\n", "", "class", "PreActBottleneck", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "'''Pre-activation version of the original Bottleneck module.'''", "\n", "expansion", "=", "4", "\n", "\n", "def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActBottleneck.forward": [[122, 130], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.conv1", "network.PreActBottleneck.conv2", "network.PreActBottleneck.conv3", "network.PreActBottleneck.bn1", "hasattr", "network.PreActBottleneck.shortcut", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.bn2", "network.PreActBottleneck.bn3"], "methods", ["None"], ["self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActResNet18": [[96, 98], ["network.PreActResNet"], "function", ["None"], ["        ", "super", "(", "GlobalpoolFC", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "num_in", ",", "num_class", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.PreActResNet34": [[100, 102], ["network.PreActResNet"], "function", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "pool", "(", "x", ")", "\n", "y", "=", "y", ".", "reshape", "(", "y", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.create_network": [[131, 133], ["network.PreActResNet18"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], [")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.network.test": [[135, 139], ["network.PreActResNet18", "PreActResNet18.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "=", "self", ".", "conv3", "(", "F", ".", "relu", "(", "self", ".", "bn3", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.dataset.create_train_dataset": [[5, 19], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.RandomCrop", "torchvision.RandomHorizontalFlip", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.dataset.create_test_dataset": [[19, 28], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "testset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "False", ",", "download", "=", "True", ",", "transform", "=", "transform_test", ")", "\n", "#testset = torchvision.datasets.MNIST(root=root, train=False, download=True, transform=transform_test)", "\n", "testloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "testset", ",", "batch_size", "=", "100", ",", "shuffle", "=", "False", ",", "num_workers", "=", "2", ")", "\n", "return", "testloader", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.loss.Hamiltonian.__init__": [[9, 13], ["torch.nn.modules.loss._Loss.__init__"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "layer", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "Hamiltonian", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layer", "=", "layer", "\n", "self", ".", "reg_cof", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.loss.Hamiltonian.forward": [[15, 25], ["loss.Hamiltonian.layer", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "p", ")", ":", "\n", "\n", "        ", "y", "=", "self", ".", "layer", "(", "x", ")", "\n", "#l2 = cal_l2_norm(self.layer)", "\n", "\n", "#print(y.shape, p.shape)", "\n", "H", "=", "torch", ".", "sum", "(", "y", "*", "p", ")", "\n", "\n", "#H = H - self.reg_cof * l2", "\n", "return", "H", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.loss.CrossEntropyWithWeightPenlty.__init__": [[29, 35], ["torch.nn.modules.loss._Loss.__init__", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["    ", "def", "__init__", "(", "self", ",", "module", ",", "DEVICE", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "CrossEntropyWithWeightPenlty", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "reg_cof", "=", "reg_cof", "\n", "self", ".", "criterion", "=", "nn", ".", "CrossEntropyLoss", "(", ")", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "module", "=", "module", "\n", "#print(modules, 'dwadaQ!')", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.loss.CrossEntropyWithWeightPenlty.__call__": [[37, 48], ["loss.CrossEntropyWithWeightPenlty.criterion", "loss.cal_l2_norm"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm"], ["", "def", "__call__", "(", "self", ",", "pred", ",", "label", ")", ":", "\n", "        ", "cross_loss", "=", "self", ".", "criterion", "(", "pred", ",", "label", ")", "\n", "weight_loss", "=", "0", "\n", "#for module in self.module:", "\n", "#    print(module)", "\n", "#    weight_loss = weight_loss + cal_l2_norm(module)", "\n", "\n", "weight_loss", "=", "cal_l2_norm", "(", "self", ".", "module", ")", "\n", "\n", "loss", "=", "cross_loss", "+", "self", ".", "reg_cof", "*", "weight_loss", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.yopo-5-3.loss.cal_l2_norm": [[49, 56], ["layer.named_parameters", "torch.norm", "torch.norm", "torch.norm"], "function", ["None"], ["", "", "def", "cal_l2_norm", "(", "layer", ":", "torch", ".", "nn", ".", "Module", ")", ":", "\n", " ", "loss", "=", "0.", "\n", "for", "name", ",", "param", "in", "layer", ".", "named_parameters", "(", ")", ":", "\n", "     ", "if", "name", "==", "'weight'", ":", "\n", "         ", "loss", "=", "loss", "+", "0.5", "*", "torch", ".", "norm", "(", "param", ",", ")", "**", "2", "\n", "\n", "", "", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.natural.config.add_path": [[8, 12], ["print", "sys.path.append"], "function", ["None"], ["class", "TrainingConfigBase", "(", "metaclass", "=", "ABCMeta", ")", ":", "\n", "    ", "'''\n    Base class for training\n    '''", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.natural.network.create_network": [[4, 6], ["base_model.wide_resnet.WideResNet"], "function", ["None"], ["\n", "import", "torch", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.natural.network.test": [[8, 12], ["network.create_network", "create_network.", "print", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["import", "torch", ".", "nn", ".", "functional", "as", "F", "\n", "\n", "\n", "\n", "class", "PreActBlock", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.natural.dataset.create_train_dataset": [[5, 19], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.RandomCrop", "torchvision.RandomHorizontalFlip", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.wide34.natural.dataset.create_test_dataset": [[19, 28], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "testset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "False", ",", "download", "=", "True", ",", "transform", "=", "transform_test", ")", "\n", "#testset = torchvision.datasets.MNIST(root=root, train=False, download=True, transform=transform_test)", "\n", "testloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "testset", ",", "batch_size", "=", "100", ",", "shuffle", "=", "False", ",", "num_workers", "=", "2", ")", "\n", "return", "testloader", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pgd40.config.add_path": [[7, 11], ["print", "sys.path.append"], "function", ["None"], ["\n", "class", "TrainingConfigBase", "(", "metaclass", "=", "ABCMeta", ")", ":", "\n", "    ", "'''\n    Base class for training\n    '''", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pgd40.network.create_network": [[5, 7], ["base_model.small_cnn.SmallCNN"], "function", ["None"], ["\n", "import", "torch", "\n", "import", "torch", ".", "nn", "as", "nn", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pgd40.network.test": [[9, 13], ["network.create_network", "create_network.", "print", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["\n", "\n", "\n", "class", "PreActBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "'''Pre-activation version of the BasicBlock.'''", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pgd40.dataset.create_train_dataset": [[5, 14], ["torchvision.Compose", "torchvision.datasets.MNIST", "torchvision.datasets.MNIST", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pgd40.dataset.create_test_dataset": [[14, 21], ["torchvision.Compose", "torchvision.datasets.MNIST", "torchvision.datasets.MNIST", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.config.add_path": [[8, 12], ["print", "sys.path.append"], "function", ["None"], ["class", "TrainingConfigBase", "(", "metaclass", "=", "ABCMeta", ")", ":", "\n", "    ", "'''\n    Base class for training\n    '''", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.training_function.FastGradientLayerOneTrainer.__init__": [[15, 22], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "Hamiltonian_func", ",", "param_optimizer", ",", "\n", "inner_steps", "=", "2", ",", "sigma", "=", "0.008", ",", "eps", "=", "0.03", ")", ":", "\n", "        ", "self", ".", "inner_steps", "=", "inner_steps", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "Hamiltonian_func", "=", "Hamiltonian_func", "\n", "self", ".", "param_optimizer", "=", "param_optimizer", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.training_function.FastGradientLayerOneTrainer.step": [[23, 59], ["p.detach.detach.detach", "range", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "loss.backward", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "[].sign", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "eta.detach.detach.detach", "eta.detach.detach.requires_grad_", "eta.detach.detach.retain_grad", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad"], "methods", ["None"], ["", "def", "step", "(", "self", ",", "inp", ",", "p", ",", "eta", ")", ":", "\n", "        ", "'''\n        Perform Iterative Sign Gradient on eta\n\n        ret: inp + eta\n        '''", "\n", "\n", "p", "=", "p", ".", "detach", "(", ")", "\n", "\n", "for", "i", "in", "range", "(", "self", ".", "inner_steps", ")", ":", "\n", "            ", "tmp_inp", "=", "inp", "+", "eta", "\n", "tmp_inp", "=", "torch", ".", "clamp", "(", "tmp_inp", ",", "0", ",", "1", ")", "\n", "H", "=", "self", ".", "Hamiltonian_func", "(", "tmp_inp", ",", "p", ")", "\n", "\n", "eta_grad_sign", "=", "torch", ".", "autograd", ".", "grad", "(", "H", ",", "eta", ",", "only_inputs", "=", "True", ",", "retain_graph", "=", "False", ")", "[", "0", "]", ".", "sign", "(", ")", "\n", "\n", "eta", "=", "eta", "-", "eta_grad_sign", "*", "self", ".", "sigma", "\n", "\n", "eta", "=", "torch", ".", "clamp", "(", "eta", ",", "-", "1.0", "*", "self", ".", "eps", ",", "self", ".", "eps", ")", "\n", "eta", "=", "torch", ".", "clamp", "(", "inp", "+", "eta", ",", "0.0", ",", "1.0", ")", "-", "inp", "\n", "eta", "=", "eta", ".", "detach", "(", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "eta", ".", "retain_grad", "(", ")", "\n", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "", "yofo_inp", "=", "eta", "+", "inp", "\n", "yofo_inp", "=", "torch", ".", "clamp", "(", "yofo_inp", ",", "0", ",", "1", ")", "\n", "\n", "loss", "=", "-", "1.0", "*", "self", ".", "Hamiltonian_func", "(", "yofo_inp", ",", "p", ")", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "#self.param_optimizer.step()", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "return", "yofo_inp", ",", "eta", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.training_function.train_one_epoch": [[63, 125], ["torch.device", "torch.device", "torch.device", "net.train", "tqdm.tqdm", "tqdm.tqdm.set_description", "enumerate", "data.to.to", "label.to.to", "torch.FloatTensor().uniform_", "torch.FloatTensor().uniform_", "torch.FloatTensor().uniform_", "eta.to.to", "eta.to.requires_grad_", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "range", "optimizer.step", "LayerOneTrainner.param_optimizer.step", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "tqdm.tqdm.set_postfix", "collections.OrderedDict", "net", "criterion", "TotalLoss.backward", "LayerOneTrainner.step", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.no_grad", "torch.no_grad", "torch.no_grad", "eta.to.detach", "utils.misc.torch_accuracy", "acc[].item", "criterion.item", "net", "[].item", "utils.misc.torch_accuracy"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy"], ["", "", "def", "train_one_epoch", "(", "net", ",", "batch_generator", ",", "optimizer", ",", "\n", "criterion", ",", "LayerOneTrainner", ",", "K", ",", "\n", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ",", "descrip_str", "=", "'Training'", ")", ":", "\n", "    ", "'''\n\n    :param attack_freq:  Frequencies of training with adversarial examples. -1 indicates natural training\n    :param AttackMethod: the attack method, None represents natural training\n    :return:  None    #(clean_acc, adv_acc)\n    '''", "\n", "net", ".", "train", "(", ")", "\n", "pbar", "=", "tqdm", "(", "batch_generator", ")", "\n", "yofoacc", "=", "-", "1", "\n", "cleanacc", "=", "-", "1", "\n", "cleanloss", "=", "-", "1", "\n", "pbar", ".", "set_description", "(", "descrip_str", ")", "\n", "for", "i", ",", "(", "data", ",", "label", ")", "in", "enumerate", "(", "pbar", ")", ":", "\n", "        ", "data", "=", "data", ".", "to", "(", "DEVICE", ")", "\n", "label", "=", "label", ".", "to", "(", "DEVICE", ")", "\n", "\n", "eta", "=", "torch", ".", "FloatTensor", "(", "*", "data", ".", "shape", ")", ".", "uniform_", "(", "-", "config", ".", "eps", ",", "config", ".", "eps", ")", "\n", "eta", "=", "eta", ".", "to", "(", "label", ".", "device", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "for", "j", "in", "range", "(", "K", ")", ":", "\n", "#optimizer.zero_grad()", "\n", "\n", "            ", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "TotalLoss", "=", "0", "\n", "\n", "pred", "=", "net", "(", "data", "+", "eta", ".", "detach", "(", ")", ")", "\n", "\n", "loss", "=", "criterion", "(", "pred", ",", "label", ")", "\n", "TotalLoss", "=", "TotalLoss", "+", "loss", "\n", "wgrad", "=", "net", ".", "conv1", ".", "weight", ".", "grad", "\n", "#bgrad = net.conv1.bias.grad", "\n", "TotalLoss", ".", "backward", "(", ")", "\n", "net", ".", "conv1", ".", "weight", ".", "grad", "=", "wgrad", "\n", "#net.conv1.bias.grad = bgrad", "\n", "#param = next(net.parameters())", "\n", "#grad_mean = torch.mean(param.grad)", "\n", "\n", "#optimizer.step()", "\n", "#optimizer.zero_grad()", "\n", "\n", "p", "=", "-", "1.0", "*", "net", ".", "layer_one_out", ".", "grad", "\n", "yofo_inp", ",", "eta", "=", "LayerOneTrainner", ".", "step", "(", "data", ",", "p", ",", "eta", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "if", "j", "==", "0", ":", "\n", "                    ", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "cleanacc", "=", "acc", "[", "0", "]", ".", "item", "(", ")", "\n", "cleanloss", "=", "loss", ".", "item", "(", ")", "\n", "\n", "", "if", "j", "==", "K", "-", "1", ":", "\n", "                    ", "yofo_pred", "=", "net", "(", "yofo_inp", ")", "\n", "yofoacc", "=", "torch_accuracy", "(", "yofo_pred", ",", "label", ",", "(", "1", ",", ")", ")", "[", "0", "]", ".", "item", "(", ")", "\n", "#pbar_dic['grad'] = '{}'.format(grad_mean)", "\n", "\n", "", "", "", "optimizer", ".", "step", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "step", "(", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.network.SmallCNN.__init__": [[7, 53], ["torch.Module.__init__", "torch.ReLU", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.ModuleList", "network.SmallCNN.other_layers.append", "network.SmallCNN.other_layers.append", "network.SmallCNN.modules", "torch.init.constant_", "torch.init.constant_", "collections.OrderedDict", "collections.OrderedDict", "collections.OrderedDict", "isinstance", "torch.init.kaiming_normal_", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.Conv2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.MaxPool2d", "torch.Linear", "torch.Dropout", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["import", "torch", ".", "nn", "as", "nn", "\n", "import", "torch", ".", "nn", ".", "functional", "as", "F", "\n", "\n", "\n", "\n", "class", "PreActBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "'''Pre-activation version of the BasicBlock.'''", "\n", "expansion", "=", "1", "\n", "\n", "def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n", "\n", "", "", "class", "PreActResNet", "(", "nn", ".", "Module", ")", ":", "\n", "\n", "    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "PreActResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "layer_one", "=", "self", ".", "conv1", "\n", "\n", "\n", "self", ".", "other_layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "other_layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.network.SmallCNN.forward": [[54, 62], ["network.SmallCNN.layer_one", "network.SmallCNN.layer_one_out.requires_grad_", "network.SmallCNN.layer_one_out.retain_grad", "network.SmallCNN.feature_extractor", "network.SmallCNN.classifier", "network.SmallCNN.view"], "methods", ["None"], ["\n", "self", ".", "linear", "=", "GlobalpoolFC", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "linear", ")", "\n", "\n", "", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.network.create_network": [[63, 65], ["network.SmallCNN"], "function", ["None"], ["self", ".", "other_layers", ".", "append", "(", "layers", "[", "-", "1", "]", ")", "\n", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.network.test": [[67, 71], ["network.create_network", "create_network.", "print", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "x", "=", "self", ".", "layer_one", "(", "x", ")", "\n", "self", ".", "layer_one_out", "=", "x", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.dataset.create_train_dataset": [[5, 14], ["torchvision.Compose", "torchvision.datasets.MNIST", "torchvision.datasets.MNIST", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.dataset.create_test_dataset": [[14, 21], ["torchvision.Compose", "torchvision.datasets.MNIST", "torchvision.datasets.MNIST", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.loss.Hamiltonian.__init__": [[9, 13], ["torch.nn.modules.loss._Loss.__init__"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "layer", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "Hamiltonian", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layer", "=", "layer", "\n", "self", ".", "reg_cof", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.loss.Hamiltonian.forward": [[15, 20], ["loss.Hamiltonian.layer", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "p", ")", ":", "\n", "\n", "        ", "y", "=", "self", ".", "layer", "(", "x", ")", "\n", "#l2 = cal_l2_norm(self.layer)", "\n", "\n", "#print(y.shape, p.shape)", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.loss.CrossEntropyWithWeightPenlty.__init__": [[24, 30], ["torch.nn.modules.loss._Loss.__init__", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["return", "H", "\n", "\n", "\n", "\n", "", "", "class", "CrossEntropyWithWeightPenlty", "(", "_Loss", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "module", ",", "DEVICE", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "CrossEntropyWithWeightPenlty", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.loss.CrossEntropyWithWeightPenlty.__call__": [[31, 37], ["loss.CrossEntropyWithWeightPenlty.criterion", "loss.cal_l2_norm"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm"], ["\n", "self", ".", "reg_cof", "=", "reg_cof", "\n", "self", ".", "criterion", "=", "nn", ".", "CrossEntropyLoss", "(", ")", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "module", "=", "module", "\n", "#print(modules, 'dwadaQ!')", "\n", "\n", "", "def", "__call__", "(", "self", ",", "pred", ",", "label", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.YOPO-5-10.loss.cal_l2_norm": [[38, 45], ["layer.named_parameters", "torch.norm", "torch.norm", "torch.norm"], "function", ["None"], ["        ", "cross_loss", "=", "self", ".", "criterion", "(", "pred", ",", "label", ")", "\n", "weight_loss", "=", "0", "\n", "#for module in self.module:", "\n", "#    print(module)", "\n", "#    weight_loss = weight_loss + cal_l2_norm(module)", "\n", "\n", "weight_loss", "=", "cal_l2_norm", "(", "self", ".", "module", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.config.add_path": [[9, 13], ["print", "sys.path.append"], "function", ["None"], ["    ", "'''\n    Base class for training\n    '''", "\n", "\n", "# directory handling", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.training_function.FastGradientLayerOneTrainer.__init__": [[16, 23], ["None"], "methods", ["None"], ["inner_steps", "=", "2", ",", "sigma", "=", "0.008", ",", "eps", "=", "0.03", ")", ":", "\n", "        ", "self", ".", "inner_steps", "=", "inner_steps", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "Hamiltonian_func", "=", "Hamiltonian_func", "\n", "self", ".", "param_optimizer", "=", "param_optimizer", "\n", "\n", "", "def", "step", "(", "self", ",", "inp", ",", "p", ",", "eta", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.training_function.FastGradientLayerOneTrainer.step": [[24, 52], ["p.detach.detach.detach", "range", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "loss.backward", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "eta_grad.sign", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "eta.detach.detach.detach", "eta.detach.detach.requires_grad_", "eta.detach.detach.retain_grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "loss.cal_l2_norm"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm"], ["        ", "'''\n        Perform Iterative Sign Gradient on eta\n\n        ret: inp + eta\n        '''", "\n", "\n", "p", "=", "p", ".", "detach", "(", ")", "\n", "\n", "for", "i", "in", "range", "(", "self", ".", "inner_steps", ")", ":", "\n", "            ", "tmp_inp", "=", "inp", "+", "eta", "\n", "tmp_inp", "=", "torch", ".", "clamp", "(", "tmp_inp", ",", "0", ",", "1", ")", "\n", "H", "=", "self", ".", "Hamiltonian_func", "(", "tmp_inp", ",", "p", ")", "\n", "\n", "eta_grad_sign", "=", "torch", ".", "autograd", ".", "grad", "(", "H", ",", "eta", ",", "only_inputs", "=", "True", ",", "retain_graph", "=", "False", ")", "[", "0", "]", ".", "sign", "(", ")", "\n", "\n", "eta", "=", "eta", "-", "eta_grad_sign", "*", "self", ".", "sigma", "\n", "\n", "eta", "=", "torch", ".", "clamp", "(", "eta", ",", "-", "1.0", "*", "self", ".", "eps", ",", "self", ".", "eps", ")", "\n", "eta", "=", "torch", ".", "clamp", "(", "inp", "+", "eta", ",", "0.0", ",", "1.0", ")", "-", "inp", "\n", "eta", "=", "eta", ".", "detach", "(", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "eta", ".", "retain_grad", "(", ")", "\n", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "", "yofo_inp", "=", "eta", "+", "inp", "\n", "yofo_inp", "=", "torch", ".", "clamp", "(", "yofo_inp", ",", "0", ",", "1", ")", "\n", "\n", "loss", "=", "-", "1.0", "*", "self", ".", "Hamiltonian_func", "(", "yofo_inp", ",", "p", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.training_function.train_one_epoch": [[54, 122], ["torch.device", "torch.device", "torch.device", "torch.device", "net.train", "tqdm.tqdm", "tqdm.tqdm.set_description", "torch.nn.KLDivLoss", "torch.nn.KLDivLoss", "torch.nn.KLDivLoss", "torch.nn.KLDivLoss", "enumerate", "data.to.to", "label.to.to", "net.eval", "eta.requires_grad_", "torch.softmax().detach", "range", "net.train", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "net", "utils.misc.torch_accuracy", "acc[].item", "criterion", "net", "trades_criterion.backward", "optimizer.step", "LayerOneTrainner.param_optimizer.step", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "collections.OrderedDict", "tqdm.tqdm.set_postfix", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "net", "LayerOneTrainner.step", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.nn.KLDivLoss.", "criterion.item", "kl_loss.item", "criterion.item", "torch.softmax", "torch.enable_grad", "torch.enable_grad", "torch.enable_grad", "torch.enable_grad", "torch.nn.KLDivLoss.", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.log_softmax", "torch.softmax", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "net", "eta.detach", "torch.log_softmax", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "net", "criterion", "[].item", "eta.detach", "torch.randn().cuda", "torch.randn().cuda", "torch.randn().cuda", "torch.randn().cuda", "utils.misc.torch_accuracy", "torch.randn", "torch.randn", "torch.randn", "torch.randn"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy"], ["loss", ".", "backward", "(", ")", "\n", "#self.param_optimizer.step()", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "return", "yofo_inp", ",", "eta", "\n", "\n", "\n", "\n", "\n", "", "", "def", "train_one_epoch", "(", "net", ",", "batch_generator", ",", "optimizer", ",", "\n", "criterion", ",", "LayerOneTrainner", ",", "K", ",", "\n", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ",", "descrip_str", "=", "'Training'", ")", ":", "\n", "    ", "'''\n\n    :param attack_freq:  Frequencies of training with adversarial examples. -1 indicates natural training\n    :param AttackMethod: the attack method, None represents natural training\n    :return:  None    #(clean_acc, adv_acc)\n    '''", "\n", "net", ".", "train", "(", ")", "\n", "pbar", "=", "tqdm", "(", "batch_generator", ")", "\n", "yofoacc", "=", "-", "1", "\n", "cleanacc", "=", "-", "1", "\n", "cleanloss", "=", "-", "1", "\n", "pbar", ".", "set_description", "(", "descrip_str", ")", "\n", "for", "i", ",", "(", "data", ",", "label", ")", "in", "enumerate", "(", "pbar", ")", ":", "\n", "        ", "data", "=", "data", ".", "to", "(", "DEVICE", ")", "\n", "label", "=", "label", ".", "to", "(", "DEVICE", ")", "\n", "\n", "eta", "=", "torch", ".", "FloatTensor", "(", "*", "data", ".", "shape", ")", ".", "uniform_", "(", "-", "config", ".", "eps", ",", "config", ".", "eps", ")", "\n", "eta", "=", "eta", ".", "to", "(", "label", ".", "device", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "for", "j", "in", "range", "(", "K", ")", ":", "\n", "#optimizer.zero_grad()", "\n", "\n", "            ", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "TotalLoss", "=", "0", "\n", "\n", "pred", "=", "net", "(", "data", "+", "eta", ".", "detach", "(", ")", ")", "\n", "\n", "loss", "=", "criterion", "(", "pred", ",", "label", ")", "\n", "TotalLoss", "=", "TotalLoss", "+", "loss", "\n", "wgrad", "=", "net", ".", "conv1", ".", "weight", ".", "grad", "\n", "#bgrad = net.conv1.bias.grad", "\n", "TotalLoss", ".", "backward", "(", ")", "\n", "net", ".", "conv1", ".", "weight", ".", "grad", "=", "wgrad", "\n", "#net.conv1.bias.grad = bgrad", "\n", "#param = next(net.parameters())", "\n", "#grad_mean = torch.mean(param.grad)", "\n", "\n", "#optimizer.step()", "\n", "#optimizer.zero_grad()", "\n", "\n", "p", "=", "-", "1.0", "*", "net", ".", "layer_one_out", ".", "grad", "\n", "yofo_inp", ",", "eta", "=", "LayerOneTrainner", ".", "step", "(", "data", ",", "p", ",", "eta", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "if", "j", "==", "0", ":", "\n", "                    ", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "cleanacc", "=", "acc", "[", "0", "]", ".", "item", "(", ")", "\n", "cleanloss", "=", "loss", ".", "item", "(", ")", "\n", "\n", "", "if", "j", "==", "K", "-", "1", ":", "\n", "                    ", "yofo_pred", "=", "net", "(", "yofo_inp", ")", "\n", "yofoacc", "=", "torch_accuracy", "(", "yofo_pred", ",", "label", ",", "(", "1", ",", ")", ")", "[", "0", "]", ".", "item", "(", ")", "\n", "#pbar_dic['grad'] = '{}'.format(grad_mean)", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActBlock.__init__": [[16, 26], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActBlock.forward": [[28, 35], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.conv1", "network.PreActBlock.conv2", "network.PreActBlock.bn1", "hasattr", "network.PreActBlock.shortcut", "torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.bn2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActResNet.__init__": [[39, 57], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.GlobalpoolFC", "network.PreActResNet.other_layers.append"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "PreActResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "layer_one", "=", "self", ".", "conv1", "\n", "\n", "\n", "self", ".", "other_layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "other_layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "\n", "self", ".", "linear", "=", "GlobalpoolFC", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "linear", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActResNet._make_layer": [[58, 67], ["torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "network.PreActResNet.other_layers.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "layers", "[", "-", "1", "]", ")", "\n", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActResNet.forward": [[68, 80], ["network.PreActResNet.layer_one", "network.PreActResNet.layer_one_out.requires_grad_", "network.PreActResNet.layer_one_out.retain_grad", "layer"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "x", "=", "self", ".", "layer_one", "(", "x", ")", "\n", "self", ".", "layer_one_out", "=", "x", "\n", "self", ".", "layer_one_out", ".", "requires_grad_", "(", ")", "\n", "self", ".", "layer_one_out", ".", "retain_grad", "(", ")", "\n", "x", "=", "self", ".", "layer_one_out", "\n", "\n", "for", "layer", "in", "self", ".", "other_layers", ":", "\n", "            ", "x", "=", "layer", "(", "x", ")", "\n", "\n", "\n", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.GlobalpoolFC.__init__": [[84, 88], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], []], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.GlobalpoolFC.forward": [[89, 94], ["network.GlobalpoolFC.pool", "network.GlobalpoolFC.reshape", "network.GlobalpoolFC.fc"], "methods", ["None"], ["\n", "return", "x", "\n", "\n", "", "", "class", "GlobalpoolFC", "(", "nn", ".", "Module", ")", ":", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActBottleneck.__init__": [[108, 120], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ")", "\n", "\n", "\n", "", "def", "PreActResNet34", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n", "\n", "", "class", "PreActBottleneck", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "'''Pre-activation version of the original Bottleneck module.'''", "\n", "expansion", "=", "4", "\n", "\n", "def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActBottleneck.forward": [[122, 130], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.conv1", "network.PreActBottleneck.conv2", "network.PreActBottleneck.conv3", "network.PreActBottleneck.bn1", "hasattr", "network.PreActBottleneck.shortcut", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.bn2", "network.PreActBottleneck.bn3"], "methods", ["None"], ["self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActResNet18": [[96, 98], ["network.PreActResNet"], "function", ["None"], ["        ", "super", "(", "GlobalpoolFC", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "num_in", ",", "num_class", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.PreActResNet34": [[100, 102], ["network.PreActResNet"], "function", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "pool", "(", "x", ")", "\n", "y", "=", "y", ".", "reshape", "(", "y", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.create_network": [[131, 133], ["network.PreActResNet18"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], [")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.network.test": [[135, 139], ["network.PreActResNet18", "PreActResNet18.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "=", "self", ".", "conv3", "(", "F", ".", "relu", "(", "self", ".", "bn3", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.dataset.create_train_dataset": [[5, 17], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.RandomCrop", "torchvision.RandomHorizontalFlip", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.dataset.create_test_dataset": [[17, 24], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "testset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "False", ",", "download", "=", "True", ",", "transform", "=", "transform_test", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.loss.Hamiltonian.__init__": [[9, 13], ["torch.nn.modules.loss._Loss.__init__"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "layer", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "Hamiltonian", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layer", "=", "layer", "\n", "self", ".", "reg_cof", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.loss.Hamiltonian.forward": [[15, 20], ["loss.Hamiltonian.layer", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "p", ")", ":", "\n", "\n", "        ", "y", "=", "self", ".", "layer", "(", "x", ")", "\n", "#l2 = cal_l2_norm(self.layer)", "\n", "\n", "#print(y.shape, p.shape)", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.loss.CrossEntropyWithWeightPenlty.__init__": [[24, 30], ["torch.nn.modules.loss._Loss.__init__", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["return", "H", "\n", "\n", "\n", "\n", "", "", "class", "CrossEntropyWithWeightPenlty", "(", "_Loss", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "module", ",", "DEVICE", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "CrossEntropyWithWeightPenlty", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.loss.CrossEntropyWithWeightPenlty.__call__": [[31, 39], ["loss.CrossEntropyWithWeightPenlty.criterion", "loss.cal_l2_norm"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm"], ["\n", "self", ".", "reg_cof", "=", "reg_cof", "\n", "self", ".", "criterion", "=", "nn", ".", "CrossEntropyLoss", "(", ")", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "module", "=", "module", "\n", "#print(modules, 'dwadaQ!')", "\n", "\n", "", "def", "__call__", "(", "self", ",", "pred", ",", "label", ")", ":", "\n", "        ", "cross_loss", "=", "self", ".", "criterion", "(", "pred", ",", "label", ")", "\n", "weight_loss", "=", "0", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-3-4.loss.cal_l2_norm": [[40, 47], ["layer.named_parameters", "torch.norm", "torch.norm", "torch.norm"], "function", ["None"], ["#for module in self.module:", "\n", "#    print(module)", "\n", "#    weight_loss = weight_loss + cal_l2_norm(module)", "\n", "\n", "weight_loss", "=", "cal_l2_norm", "(", "self", ".", "module", ")", "\n", "\n", "loss", "=", "cross_loss", "+", "self", ".", "reg_cof", "*", "weight_loss", "\n", "return", "loss", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.config.add_path": [[8, 12], ["print", "sys.path.append"], "function", ["None"], ["class", "TrainingConfigBase", "(", "metaclass", "=", "ABCMeta", ")", ":", "\n", "    ", "'''\n    Base class for training\n    '''", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.__init__": [[16, 23], ["None"], "methods", ["None"], ["inner_steps", "=", "2", ",", "sigma", "=", "0.008", ",", "eps", "=", "0.03", ")", ":", "\n", "        ", "self", ".", "inner_steps", "=", "inner_steps", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "Hamiltonian_func", "=", "Hamiltonian_func", "\n", "self", ".", "param_optimizer", "=", "param_optimizer", "\n", "\n", "", "def", "step", "(", "self", ",", "inp", ",", "p", ",", "eta", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step": [[24, 57], ["p.detach.detach.detach", "range", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "loss.backward", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "eta_grad.sign", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "eta.detach.detach.detach", "eta.detach.detach.requires_grad_", "eta.detach.detach.retain_grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "training_function.FastGradientLayerOneTrainer.Hamiltonian_func", "loss.cal_l2_norm"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm"], ["        ", "'''\n        Perform Iterative Sign Gradient on eta\n\n        ret: inp + eta\n        '''", "\n", "\n", "p", "=", "p", ".", "detach", "(", ")", "\n", "\n", "for", "i", "in", "range", "(", "self", ".", "inner_steps", ")", ":", "\n", "            ", "tmp_inp", "=", "inp", "+", "eta", "\n", "tmp_inp", "=", "torch", ".", "clamp", "(", "tmp_inp", ",", "0", ",", "1", ")", "\n", "H", "=", "self", ".", "Hamiltonian_func", "(", "tmp_inp", ",", "p", ")", "\n", "\n", "eta_grad_sign", "=", "torch", ".", "autograd", ".", "grad", "(", "H", ",", "eta", ",", "only_inputs", "=", "True", ",", "retain_graph", "=", "False", ")", "[", "0", "]", ".", "sign", "(", ")", "\n", "\n", "eta", "=", "eta", "-", "eta_grad_sign", "*", "self", ".", "sigma", "\n", "\n", "eta", "=", "torch", ".", "clamp", "(", "eta", ",", "-", "1.0", "*", "self", ".", "eps", ",", "self", ".", "eps", ")", "\n", "eta", "=", "torch", ".", "clamp", "(", "inp", "+", "eta", ",", "0.0", ",", "1.0", ")", "-", "inp", "\n", "eta", "=", "eta", ".", "detach", "(", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "eta", ".", "retain_grad", "(", ")", "\n", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n", "", "yofo_inp", "=", "eta", "+", "inp", "\n", "yofo_inp", "=", "torch", ".", "clamp", "(", "yofo_inp", ",", "0", ",", "1", ")", "\n", "\n", "loss", "=", "-", "1.0", "*", "self", ".", "Hamiltonian_func", "(", "yofo_inp", ",", "p", ")", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "#self.param_optimizer.step()", "\n", "#self.param_optimizer.zero_grad()", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.train_one_epoch": [[59, 132], ["torch.device", "torch.device", "torch.device", "torch.device", "net.train", "tqdm.tqdm", "tqdm.tqdm.set_description", "torch.nn.KLDivLoss", "torch.nn.KLDivLoss", "torch.nn.KLDivLoss", "torch.nn.KLDivLoss", "enumerate", "data.to.to", "label.to.to", "net.eval", "eta.requires_grad_", "torch.softmax().detach", "range", "net.train", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "net", "utils.misc.torch_accuracy", "acc[].item", "criterion", "net", "trades_criterion.backward", "optimizer.step", "LayerOneTrainner.param_optimizer.step", "optimizer.zero_grad", "LayerOneTrainner.param_optimizer.zero_grad", "collections.OrderedDict", "tqdm.tqdm.set_postfix", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "net", "LayerOneTrainner.step", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.nn.KLDivLoss.", "criterion.item", "kl_loss.item", "criterion.item", "torch.softmax", "torch.enable_grad", "torch.enable_grad", "torch.enable_grad", "torch.enable_grad", "torch.nn.KLDivLoss.", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.log_softmax", "torch.softmax", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "net", "eta.detach", "torch.log_softmax", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "net", "criterion", "[].item", "eta.detach", "torch.randn().cuda", "torch.randn().cuda", "torch.randn().cuda", "torch.randn().cuda", "utils.misc.torch_accuracy", "torch.randn", "torch.randn", "torch.randn", "torch.randn"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy"], ["\n", "\n", "\n", "\n", "", "", "def", "train_one_epoch", "(", "net", ",", "batch_generator", ",", "optimizer", ",", "\n", "criterion", ",", "LayerOneTrainner", ",", "K", ",", "\n", "DEVICE", "=", "torch", ".", "device", "(", "'cuda:0'", ")", ",", "descrip_str", "=", "'Training'", ")", ":", "\n", "    ", "'''\n\n    :param attack_freq:  Frequencies of training with adversarial examples. -1 indicates natural training\n    :param AttackMethod: the attack method, None represents natural training\n    :return:  None    #(clean_acc, adv_acc)\n    '''", "\n", "net", ".", "train", "(", ")", "\n", "pbar", "=", "tqdm", "(", "batch_generator", ")", "\n", "yofoacc", "=", "-", "1", "\n", "cleanacc", "=", "-", "1", "\n", "cleanloss", "=", "-", "1", "\n", "pbar", ".", "set_description", "(", "descrip_str", ")", "\n", "for", "i", ",", "(", "data", ",", "label", ")", "in", "enumerate", "(", "pbar", ")", ":", "\n", "        ", "data", "=", "data", ".", "to", "(", "DEVICE", ")", "\n", "label", "=", "label", ".", "to", "(", "DEVICE", ")", "\n", "\n", "eta", "=", "torch", ".", "FloatTensor", "(", "*", "data", ".", "shape", ")", ".", "uniform_", "(", "-", "config", ".", "eps", ",", "config", ".", "eps", ")", "\n", "eta", "=", "eta", ".", "to", "(", "label", ".", "device", ")", "\n", "eta", ".", "requires_grad_", "(", ")", "\n", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "for", "j", "in", "range", "(", "K", ")", ":", "\n", "#optimizer.zero_grad()", "\n", "\n", "            ", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "TotalLoss", "=", "0", "\n", "\n", "pred", "=", "net", "(", "data", "+", "eta", ".", "detach", "(", ")", ")", "\n", "\n", "loss", "=", "criterion", "(", "pred", ",", "label", ")", "\n", "TotalLoss", "=", "TotalLoss", "+", "loss", "\n", "wgrad", "=", "net", ".", "conv1", ".", "weight", ".", "grad", "\n", "#bgrad = net.conv1.bias.grad", "\n", "TotalLoss", ".", "backward", "(", ")", "\n", "net", ".", "conv1", ".", "weight", ".", "grad", "=", "wgrad", "\n", "#net.conv1.bias.grad = bgrad", "\n", "#param = next(net.parameters())", "\n", "#grad_mean = torch.mean(param.grad)", "\n", "\n", "#optimizer.step()", "\n", "#optimizer.zero_grad()", "\n", "\n", "p", "=", "-", "1.0", "*", "net", ".", "layer_one_out", ".", "grad", "\n", "yofo_inp", ",", "eta", "=", "LayerOneTrainner", ".", "step", "(", "data", ",", "p", ",", "eta", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "if", "j", "==", "0", ":", "\n", "                    ", "acc", "=", "torch_accuracy", "(", "pred", ",", "label", ",", "(", "1", ",", ")", ")", "\n", "cleanacc", "=", "acc", "[", "0", "]", ".", "item", "(", ")", "\n", "cleanloss", "=", "loss", ".", "item", "(", ")", "\n", "\n", "", "if", "j", "==", "K", "-", "1", ":", "\n", "                    ", "yofo_pred", "=", "net", "(", "yofo_inp", ")", "\n", "yofoacc", "=", "torch_accuracy", "(", "yofo_pred", ",", "label", ",", "(", "1", ",", ")", ")", "[", "0", "]", ".", "item", "(", ")", "\n", "#pbar_dic['grad'] = '{}'.format(grad_mean)", "\n", "\n", "", "", "", "optimizer", ".", "step", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "step", "(", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "LayerOneTrainner", ".", "param_optimizer", ".", "zero_grad", "(", ")", "\n", "pbar_dic", "[", "'Acc'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanacc", ")", "\n", "pbar_dic", "[", "'loss'", "]", "=", "'{:.2f}'", ".", "format", "(", "cleanloss", ")", "\n", "pbar_dic", "[", "'YofoAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "yofoacc", ")", "\n", "pbar", ".", "set_postfix", "(", "pbar_dic", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActBlock.__init__": [[16, 26], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "in_planes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActBlock.forward": [[28, 35], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.conv1", "network.PreActBlock.conv2", "network.PreActBlock.bn1", "hasattr", "network.PreActBlock.shortcut", "torch.relu", "torch.relu", "torch.relu", "network.PreActBlock.bn2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "bn1", "(", "x", ")", ")", "\n", "shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet.__init__": [[39, 57], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.PreActResNet._make_layer", "network.GlobalpoolFC", "network.PreActResNet.other_layers.append"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "num_blocks", ",", "num_classes", "=", "10", ")", ":", "\n", "        ", "super", "(", "PreActResNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_planes", "=", "64", "\n", "\n", "self", ".", "other_layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "layer_one", "=", "self", ".", "conv1", "\n", "\n", "\n", "self", ".", "other_layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "num_blocks", "[", "0", "]", ",", "stride", "=", "1", ")", "\n", "self", ".", "other_layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "num_blocks", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "num_blocks", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "other_layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "num_blocks", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "\n", "self", ".", "linear", "=", "GlobalpoolFC", "(", "512", "*", "block", ".", "expansion", ",", "num_classes", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "self", ".", "linear", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet._make_layer": [[58, 67], ["torch.Sequential", "torch.Sequential", "torch.Sequential", "layers.append", "network.PreActResNet.other_layers.append", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "num_blocks", ",", "stride", ")", ":", "\n", "        ", "strides", "=", "[", "stride", "]", "+", "[", "1", "]", "*", "(", "num_blocks", "-", "1", ")", "\n", "layers", "=", "[", "]", "\n", "for", "stride", "in", "strides", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_planes", ",", "planes", ",", "stride", ")", ")", "\n", "self", ".", "other_layers", ".", "append", "(", "layers", "[", "-", "1", "]", ")", "\n", "\n", "self", ".", "in_planes", "=", "planes", "*", "block", ".", "expansion", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet.forward": [[68, 80], ["network.PreActResNet.layer_one", "network.PreActResNet.layer_one_out.requires_grad_", "network.PreActResNet.layer_one_out.retain_grad", "layer"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "x", "=", "self", ".", "layer_one", "(", "x", ")", "\n", "self", ".", "layer_one_out", "=", "x", "\n", "self", ".", "layer_one_out", ".", "requires_grad_", "(", ")", "\n", "self", ".", "layer_one_out", ".", "retain_grad", "(", ")", "\n", "x", "=", "self", ".", "layer_one_out", "\n", "\n", "for", "layer", "in", "self", ".", "other_layers", ":", "\n", "            ", "x", "=", "layer", "(", "x", ")", "\n", "\n", "\n", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.GlobalpoolFC.__init__": [[84, 88], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], []], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.GlobalpoolFC.forward": [[89, 94], ["network.GlobalpoolFC.pool", "network.GlobalpoolFC.reshape", "network.GlobalpoolFC.fc"], "methods", ["None"], ["\n", "return", "x", "\n", "\n", "", "", "class", "GlobalpoolFC", "(", "nn", ".", "Module", ")", ":", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActBottleneck.__init__": [[108, 120], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ")", "\n", "\n", "\n", "", "def", "PreActResNet34", "(", ")", ":", "\n", "    ", "return", "PreActResNet", "(", "PreActBlock", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ")", "\n", "\n", "\n", "", "class", "PreActBottleneck", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "'''Pre-activation version of the original Bottleneck module.'''", "\n", "expansion", "=", "4", "\n", "\n", "def", "__init__", "(", "self", ",", "in_planes", ",", "planes", ",", "stride", "=", "1", ")", ":", "\n", "        ", "super", "(", "PreActBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActBottleneck.forward": [[122, 130], ["torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.conv1", "network.PreActBottleneck.conv2", "network.PreActBottleneck.conv3", "network.PreActBottleneck.bn1", "hasattr", "network.PreActBottleneck.shortcut", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "network.PreActBottleneck.bn2", "network.PreActBottleneck.bn3"], "methods", ["None"], ["self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n", "if", "stride", "!=", "1", "or", "in_planes", "!=", "self", ".", "expansion", "*", "planes", ":", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_planes", ",", "self", ".", "expansion", "*", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18": [[96, 98], ["network.PreActResNet"], "function", ["None"], ["        ", "super", "(", "GlobalpoolFC", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "num_in", ",", "num_class", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet34": [[100, 102], ["network.PreActResNet"], "function", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "pool", "(", "x", ")", "\n", "y", "=", "y", ".", "reshape", "(", "y", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.create_network": [[131, 133], ["network.PreActResNet18"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], [")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.test": [[135, 139], ["network.PreActResNet18", "PreActResNet18.", "print", "torch.randn", "torch.randn", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["shortcut", "=", "self", ".", "shortcut", "(", "out", ")", "if", "hasattr", "(", "self", ",", "'shortcut'", ")", "else", "x", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "conv2", "(", "F", ".", "relu", "(", "self", ".", "bn2", "(", "out", ")", ")", ")", "\n", "out", "=", "self", ".", "conv3", "(", "F", ".", "relu", "(", "self", ".", "bn3", "(", "out", ")", ")", ")", "\n", "out", "+=", "shortcut", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.dataset.create_train_dataset": [[5, 17], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.RandomCrop", "torchvision.RandomHorizontalFlip", "torchvision.ToTensor"], "function", ["None"], ["def", "create_train_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "\n", "    ", "transform_train", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "RandomCrop", "(", "32", ",", "padding", "=", "4", ")", ",", "\n", "transforms", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "\n", "trainset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "True", ",", "download", "=", "True", ",", "transform", "=", "transform_train", ")", "\n", "#trainset = torchvision.datasets.MNIST(root=root, train=True, download=True, transform=transform_train)", "\n", "trainloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "trainset", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.dataset.create_test_dataset": [[17, 24], ["torchvision.Compose", "torchvision.datasets.CIFAR10", "torchvision.datasets.CIFAR10", "torch.utils.data.DataLoader", "torchvision.ToTensor"], "function", ["None"], ["\n", "return", "trainloader", "\n", "", "def", "create_test_dataset", "(", "batch_size", "=", "128", ",", "root", "=", "'../data'", ")", ":", "\n", "    ", "transform_test", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "#transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),", "\n", "]", ")", "\n", "testset", "=", "torchvision", ".", "datasets", ".", "CIFAR10", "(", "root", "=", "root", ",", "train", "=", "False", ",", "download", "=", "True", ",", "transform", "=", "transform_test", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.Hamiltonian.__init__": [[9, 13], ["torch.nn.modules.loss._Loss.__init__"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__"], ["    ", "def", "__init__", "(", "self", ",", "layer", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "Hamiltonian", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layer", "=", "layer", "\n", "self", ".", "reg_cof", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.Hamiltonian.forward": [[14, 19], ["loss.Hamiltonian.layer", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "p", ")", ":", "\n", "\n", "        ", "y", "=", "self", ".", "layer", "(", "x", ")", "\n", "#l2 = cal_l2_norm(self.layer)", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__": [[22, 28], ["torch.nn.modules.loss._Loss.__init__", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss().to", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__init__", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["\n", "#H = H - self.reg_cof * l2", "\n", "return", "H", "\n", "\n", "\n", "\n", "", "", "class", "CrossEntropyWithWeightPenlty", "(", "_Loss", ")", ":", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.CrossEntropyWithWeightPenlty.__call__": [[29, 35], ["loss.CrossEntropyWithWeightPenlty.criterion", "loss.cal_l2_norm"], "methods", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm"], ["    ", "def", "__init__", "(", "self", ",", "module", ",", "DEVICE", ",", "reg_cof", "=", "1e-4", ")", ":", "\n", "        ", "super", "(", "CrossEntropyWithWeightPenlty", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "reg_cof", "=", "reg_cof", "\n", "self", ".", "criterion", "=", "nn", ".", "CrossEntropyLoss", "(", ")", ".", "to", "(", "DEVICE", ")", "\n", "self", ".", "module", "=", "module", "\n", "#print(modules, 'dwadaQ!')", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.loss.cal_l2_norm": [[37, 44], ["layer.named_parameters", "torch.norm", "torch.norm", "torch.norm"], "function", ["None"], ["", "def", "__call__", "(", "self", ",", "pred", ",", "label", ")", ":", "\n", "        ", "cross_loss", "=", "self", ".", "criterion", "(", "pred", ",", "label", ")", "\n", "weight_loss", "=", "0", "\n", "#for module in self.module:", "\n", "#    print(module)", "\n", "#    weight_loss = weight_loss + cal_l2_norm(module)", "\n", "\n", "weight_loss", "=", "cal_l2_norm", "(", "self", ".", "module", ")", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.config.add_path": [[8, 12], ["print", "sys.path.append"], "function", ["None"], ["class", "TrainingConfigBase", "(", "metaclass", "=", "ABCMeta", ")", ":", "\n", "    ", "'''\n    Base class for training\n    '''", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network": [[5, 8], ["base_model.preact_resnet.PreActResNet18"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.network.PreActResNet18"], ["\n", "import", "torch", "\n", "import", "torch", ".", "nn", "as", "nn", "\n", "import", "torch", ".", "nn", ".", "functional", "as", "F", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.test": [[10, 14], ["network.create_network", "create_network.", "print", "torch.randn", "net.size"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["\n", "\n", "class", "PreActBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "'''Pre-activation version of the BasicBlock.'''", "\n", "expansion", "=", "1", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.squared_l2_norm": [[9, 12], ["x.view"], "function", ["None"], ["def", "squared_l2_norm", "(", "x", ")", ":", "\n", "    ", "flattened", "=", "x", ".", "view", "(", "x", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "return", "(", "flattened", "**", "2", ")", ".", "sum", "(", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.l2_norm": [[14, 16], ["squared_l2_norm().sqrt", "trades.squared_l2_norm"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.squared_l2_norm"], ["", "def", "l2_norm", "(", "x", ")", ":", "\n", "    ", "return", "squared_l2_norm", "(", "x", ")", ".", "sqrt", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.trades_loss": [[18, 87], ["torch.KLDivLoss", "model.eval", "len", "model.train", "torch.autograd.Variable", "optimizer.zero_grad", "model", "model", "torch.cross_entropy", "[].item", "[].item", "x_natural.detach", "range", "torch.clamp", "torch.clamp", "torch.clamp", "nn.KLDivLoss.", "F.cross_entropy.item", "loss_robust.item", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "torch.randn().cuda().detach().to", "torch.clamp.requires_grad_", "torch.min", "torch.min", "torch.min", "torch.clamp", "torch.clamp", "torch.clamp", "range", "torch.clamp", "torch.clamp", "torch.clamp", "torch.log_softmax", "torch.softmax", "torch.enable_grad", "torch.enable_grad", "torch.enable_grad", "nn.KLDivLoss.", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "torch.clamp.detach", "torch.max", "torch.max", "torch.max", "torch.clamp.requires_grad_", "range", "torch.clamp", "torch.clamp", "torch.clamp", "utils.misc.torch_accuracy", "utils.misc.torch_accuracy", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "torch.randn().cuda().detach", "torch.log_softmax", "torch.softmax", "torch.sign", "torch.sign", "torch.sign", "torch.enable_grad", "torch.enable_grad", "torch.enable_grad", "nn.KLDivLoss.", "torch.autograd.grad", "torch.autograd.grad", "torch.autograd.grad", "trades.l2_norm", "trades.l2_norm", "model", "model", "grad.detach", "torch.log_softmax", "torch.softmax", "x_adv[].detach", "torch.randn().cuda", "torch.randn().cuda", "torch.randn().cuda", "model", "model", "trades.l2_norm", "torch.randn", "torch.randn", "torch.randn"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.torch_accuracy", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.l2_norm", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.l2_norm", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.l2_norm"], ["", "def", "trades_loss", "(", "model", ",", "\n", "x_natural", ",", "\n", "y", ",", "\n", "optimizer", ",", "\n", "device", ",", "\n", "step_size", "=", "0.003", ",", "\n", "epsilon", "=", "0.031", ",", "\n", "perturb_steps", "=", "10", ",", "\n", "beta", "=", "1.0", ",", "\n", "distance", "=", "'l_inf'", ")", ":", "\n", "# define KL-loss", "\n", "    ", "criterion_kl", "=", "nn", ".", "KLDivLoss", "(", "size_average", "=", "False", ")", "\n", "model", ".", "eval", "(", ")", "\n", "batch_size", "=", "len", "(", "x_natural", ")", "\n", "# generate adversarial example", "\n", "x_adv", "=", "x_natural", ".", "detach", "(", ")", "+", "0.001", "*", "torch", ".", "randn", "(", "x_natural", ".", "shape", ")", ".", "cuda", "(", ")", ".", "detach", "(", ")", ".", "to", "(", "device", ")", "\n", "if", "distance", "==", "'l_inf'", ":", "\n", "# logits_natural = model(x_natural).detach()", "\n", "\n", "        ", "for", "_", "in", "range", "(", "perturb_steps", ")", ":", "\n", "            ", "x_adv", ".", "requires_grad_", "(", ")", "\n", "with", "torch", ".", "enable_grad", "(", ")", ":", "\n", "                ", "loss_kl", "=", "criterion_kl", "(", "F", ".", "log_softmax", "(", "model", "(", "x_adv", ")", ",", "dim", "=", "1", ")", ",", "\n", "F", ".", "softmax", "(", "model", "(", "x_natural", ")", ",", "dim", "=", "1", ")", ")", "\n", "# loss_kl = criterion_kl(F.log_softmax(model(x_adv), dim=1),", "\n", "#                        F.softmax(logits_natural, dim=1))", "\n", "\n", "", "grad", "=", "torch", ".", "autograd", ".", "grad", "(", "loss_kl", ",", "[", "x_adv", "]", ")", "[", "0", "]", "\n", "x_adv", "=", "x_adv", ".", "detach", "(", ")", "+", "step_size", "*", "torch", ".", "sign", "(", "grad", ".", "detach", "(", ")", ")", "\n", "x_adv", "=", "torch", ".", "min", "(", "torch", ".", "max", "(", "x_adv", ",", "x_natural", "-", "epsilon", ")", ",", "x_natural", "+", "epsilon", ")", "\n", "x_adv", "=", "torch", ".", "clamp", "(", "x_adv", ",", "0.0", ",", "1.0", ")", "\n", "\n", "", "", "elif", "distance", "==", "'l_2'", ":", "\n", "        ", "for", "_", "in", "range", "(", "perturb_steps", ")", ":", "\n", "            ", "x_adv", ".", "requires_grad_", "(", ")", "\n", "with", "torch", ".", "enable_grad", "(", ")", ":", "\n", "                ", "loss_kl", "=", "criterion_kl", "(", "F", ".", "log_softmax", "(", "model", "(", "x_adv", ")", ",", "dim", "=", "1", ")", ",", "\n", "F", ".", "softmax", "(", "model", "(", "x_natural", ")", ",", "dim", "=", "1", ")", ")", "\n", "", "grad", "=", "torch", ".", "autograd", ".", "grad", "(", "loss_kl", ",", "[", "x_adv", "]", ")", "[", "0", "]", "\n", "for", "idx_batch", "in", "range", "(", "batch_size", ")", ":", "\n", "                ", "grad_idx", "=", "grad", "[", "idx_batch", "]", "\n", "grad_idx_norm", "=", "l2_norm", "(", "grad_idx", ")", "\n", "grad_idx", "/=", "(", "grad_idx_norm", "+", "1e-8", ")", "\n", "x_adv", "[", "idx_batch", "]", "=", "x_adv", "[", "idx_batch", "]", ".", "detach", "(", ")", "+", "step_size", "*", "grad_idx", "\n", "eta_x_adv", "=", "x_adv", "[", "idx_batch", "]", "-", "x_natural", "[", "idx_batch", "]", "\n", "norm_eta", "=", "l2_norm", "(", "eta_x_adv", ")", "\n", "if", "norm_eta", ">", "epsilon", ":", "\n", "                    ", "eta_x_adv", "=", "eta_x_adv", "*", "epsilon", "/", "l2_norm", "(", "eta_x_adv", ")", "\n", "", "x_adv", "[", "idx_batch", "]", "=", "x_natural", "[", "idx_batch", "]", "+", "eta_x_adv", "\n", "", "x_adv", "=", "torch", ".", "clamp", "(", "x_adv", ",", "0.0", ",", "1.0", ")", "\n", "", "", "else", ":", "\n", "        ", "x_adv", "=", "torch", ".", "clamp", "(", "x_adv", ",", "0.0", ",", "1.0", ")", "\n", "\n", "", "model", ".", "train", "(", ")", "\n", "\n", "x_adv", "=", "Variable", "(", "torch", ".", "clamp", "(", "x_adv", ",", "0.0", ",", "1.0", ")", ",", "requires_grad", "=", "False", ")", "\n", "# zero gradient", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "# calculate robust loss", "\n", "logits", "=", "model", "(", "x_natural", ")", "\n", "adv_logits", "=", "model", "(", "x_adv", ")", "\n", "loss_natural", "=", "F", ".", "cross_entropy", "(", "logits", ",", "y", ")", "\n", "loss_robust", "=", "(", "1.0", "/", "batch_size", ")", "*", "criterion_kl", "(", "F", ".", "log_softmax", "(", "adv_logits", ",", "dim", "=", "1", ")", ",", "\n", "F", ".", "softmax", "(", "logits", ",", "dim", "=", "1", ")", ")", "\n", "loss", "=", "loss_natural", "+", "beta", "*", "loss_robust", "\n", "\n", "cleanacc", "=", "torch_accuracy", "(", "logits", ",", "y", ",", "(", "1", ",", ")", ")", "[", "0", "]", ".", "item", "(", ")", "\n", "tradesacc", "=", "torch_accuracy", "(", "adv_logits", ",", "y", ",", "(", "1", ",", ")", ")", "[", "0", "]", ".", "item", "(", ")", "\n", "return", "loss", ",", "loss_natural", ".", "item", "(", ")", ",", "loss_robust", ".", "item", "(", ")", ",", "cleanacc", ",", "tradesacc", "\n", "", ""]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train": [[47, 81], ["model.train", "tqdm.tqdm", "tqdm.tqdm.set_description", "utils.misc.AvgMeter", "utils.misc.AvgMeter", "enumerate", "optimizer.zero_grad", "trades.trades_loss", "loss.backward", "optimizer.step", "utils.misc.AvgMeter.update", "utils.misc.AvgMeter.update", "collections.OrderedDict", "tqdm.tqdm.set_postfix", "data.to", "target.to", "config.args"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.trades.trades_loss", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.pre-res18.TRADES-YOPO-2-5.training_function.FastGradientLayerOneTrainer.step", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.update", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.utils.misc.AvgMeter.update", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to"], ["def", "train", "(", "args", ",", "model", ",", "device", ",", "train_loader", ",", "optimizer", ",", "epoch", ",", "descrip_str", "=", "'Training'", ")", ":", "\n", "    ", "model", ".", "train", "(", ")", "\n", "pbar", "=", "tqdm", "(", "train_loader", ")", "\n", "pbar", ".", "set_description", "(", "descrip_str", ")", "\n", "\n", "CleanAccMeter", "=", "AvgMeter", "(", ")", "\n", "TradesAccMeter", "=", "AvgMeter", "(", ")", "\n", "for", "batch_idx", ",", "(", "data", ",", "target", ")", "in", "enumerate", "(", "pbar", ")", ":", "\n", "        ", "data", ",", "target", "=", "data", ".", "to", "(", "device", ")", ",", "target", ".", "to", "(", "device", ")", "\n", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "# calculate robust loss", "\n", "loss", ",", "cleanloss", ",", "klloss", ",", "cleanacc", ",", "tradesacc", "=", "trades_loss", "(", "model", "=", "model", ",", "\n", "x_natural", "=", "data", ",", "\n", "y", "=", "target", ",", "\n", "optimizer", "=", "optimizer", ",", "\n", "device", "=", "device", ",", "\n", "step_size", "=", "args", ".", "step_size", ",", "\n", "epsilon", "=", "args", ".", "epsilon", ",", "\n", "perturb_steps", "=", "args", ".", "num_steps", ",", "\n", "beta", "=", "args", ".", "beta", ",", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "\n", "CleanAccMeter", ".", "update", "(", "cleanacc", ")", "\n", "TradesAccMeter", ".", "update", "(", "tradesacc", ")", "\n", "\n", "pbar_dic", "=", "OrderedDict", "(", ")", "\n", "pbar_dic", "[", "'cleanloss'", "]", "=", "'{:.3f}'", ".", "format", "(", "cleanloss", ")", "\n", "pbar_dic", "[", "'klloss'", "]", "=", "'{:.3f}'", ".", "format", "(", "klloss", ")", "\n", "pbar_dic", "[", "'CleanAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "CleanAccMeter", ".", "mean", ")", "\n", "pbar_dic", "[", "'TradesAcc'", "]", "=", "'{:.2f}'", ".", "format", "(", "TradesAccMeter", ".", "mean", ")", "\n", "pbar", ".", "set_postfix", "(", "pbar_dic", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.adjust_learning_rate": [[83, 94], ["None"], "function", ["None"], ["", "", "def", "adjust_learning_rate", "(", "optimizer", ",", "epoch", ")", ":", "\n", "    ", "\"\"\"decrease the learning rate\"\"\"", "\n", "lr", "=", "args", ".", "lr", "\n", "if", "epoch", ">=", "75", ":", "\n", "        ", "lr", "=", "args", ".", "lr", "*", "0.1", "\n", "", "elif", "epoch", ">=", "90", ":", "\n", "        ", "lr", "=", "args", ".", "lr", "*", "0.01", "\n", "", "elif", "epoch", ">=", "100", ":", "\n", "        ", "lr", "=", "args", ".", "lr", "*", "0.001", "\n", "", "for", "param_group", "in", "optimizer", ".", "param_groups", ":", "\n", "        ", "param_group", "[", "'lr'", "]", "=", "lr", "\n", "\n"]], "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.main": [[96, 120], ["network.create_network().to", "torch.SGD", "config.config.create_evaluation_attack_method", "range", "create_network().to.parameters", "train_trades_cifar10.adjust_learning_rate", "time.time", "train_trades_cifar10.train", "training.train.eval_one_epoch", "network.create_network", "time.time", "torch.save", "torch.save", "torch.save", "torch.save", "create_network().to.state_dict", "os.path.join"], "function", ["home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.attack.pgd.IPGD.to", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.config.TrainingConfigBase.create_evaluation_attack_method", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.adjust_learning_rate", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.train_trades_cifar10.train", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.training.train.eval_one_epoch", "home.repos.pwc.inspect_result.a1600012888_YOPO-You-Only-Propagate-Once.baseline.res-pre18.TRADES.10step.network.create_network"], ["", "", "def", "main", "(", ")", ":", "\n", "    ", "model", "=", "create_network", "(", ")", ".", "to", "(", "device", ")", "\n", "\n", "optimizer", "=", "optim", ".", "SGD", "(", "model", ".", "parameters", "(", ")", ",", "lr", "=", "args", ".", "lr", ",", "momentum", "=", "args", ".", "momentum", ",", "weight_decay", "=", "args", ".", "weight_decay", ")", "\n", "\n", "EvalAttack", "=", "config", ".", "create_evaluation_attack_method", "(", "device", ")", "\n", "\n", "now_train_time", "=", "0", "\n", "for", "epoch", "in", "range", "(", "1", ",", "args", ".", "epochs", "+", "1", ")", ":", "\n", "# adjust learning rate for SGD", "\n", "        ", "adjust_learning_rate", "(", "optimizer", ",", "epoch", ")", "\n", "\n", "s_time", "=", "time", "(", ")", "\n", "descrip_str", "=", "'Training epoch: {}/{}'", ".", "format", "(", "epoch", ",", "args", ".", "epochs", ")", "\n", "# adversarial training", "\n", "train", "(", "args", ",", "model", ",", "device", ",", "train_loader", ",", "optimizer", ",", "epoch", ",", "descrip_str", ")", "\n", "now_train_time", "+=", "time", "(", ")", "-", "s_time", "\n", "\n", "acc", ",", "advacc", "=", "eval_one_epoch", "(", "model", ",", "test_loader", ",", "device", ",", "EvalAttack", ")", "\n", "\n", "# save checkpoint", "\n", "if", "epoch", "%", "args", ".", "save_freq", "==", "0", ":", "\n", "            ", "torch", ".", "save", "(", "model", ".", "state_dict", "(", ")", ",", "\n", "os", ".", "path", ".", "join", "(", "config", ".", "model_dir", ",", "'model-wideres-epoch{}.pt'", ".", "format", "(", "epoch", ")", ")", ")", "\n", "\n"]]}