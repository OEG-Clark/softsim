{"home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.get_hidden_states_before": [[35, 42], ["tensorflow.zeros", "tensorflow.concat"], "methods", ["None"], ["    ", "def", "get_hidden_states_before", "(", "self", ",", "hidden_states", ",", "step", ",", "shape", ",", "hidden_size", ")", ":", "\n", "#padding :/zeros", "\n", "        ", "padding", "=", "tf", ".", "zeros", "(", "(", "shape", "[", "0", "]", ",", "step", ",", "hidden_size", ")", ",", "dtype", "=", "tf", ".", "float32", ")", "\n", "#remove last steps", "\n", "displaced_hidden_states", "=", "hidden_states", "[", ":", ",", ":", "-", "step", ",", ":", "]", "\n", "#concat padding", "\n", "return", "tf", ".", "concat", "(", "[", "padding", ",", "displaced_hidden_states", "]", ",", "axis", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.get_hidden_states_after": [[43, 50], ["tensorflow.zeros", "tensorflow.concat"], "methods", ["None"], ["", "def", "get_hidden_states_after", "(", "self", ",", "hidden_states", ",", "step", ",", "shape", ",", "hidden_size", ")", ":", "\n", "#padding zeros", "\n", "        ", "padding", "=", "tf", ".", "zeros", "(", "(", "shape", "[", "0", "]", ",", "step", ",", "hidden_size", ")", ",", "dtype", "=", "tf", ".", "float32", ")", "\n", "#remove last steps", "\n", "displaced_hidden_states", "=", "hidden_states", "[", ":", ",", "step", ":", ",", ":", "]", "\n", "#concat padding", "\n", "return", "tf", ".", "concat", "(", "[", "displaced_hidden_states", ",", "padding", "]", ",", "axis", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.sum_together": [[51, 59], ["None"], "methods", ["None"], ["", "def", "sum_together", "(", "self", ",", "l", ")", ":", "\n", "        ", "combined_state", "=", "None", "\n", "for", "tensor", "in", "l", ":", "\n", "            ", "if", "combined_state", "==", "None", ":", "\n", "                ", "combined_state", "=", "tensor", "\n", "", "else", ":", "\n", "                ", "combined_state", "=", "combined_state", "+", "tensor", "\n", "", "", "return", "combined_state", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.slstm_cell": [[60, 306], ["tensorflow.expand_dims", "tensorflow.expand_dims", "tensorflow.shape", "tensorflow.identity", "tensorflow.nn.dropout", "tensorflow.reshape", "tensorflow.nn.tanh", "tensorflow.nn.dropout", "tensorflow.matmul", "tensorflow.reshape", "tensorflow.nn.softmax", "tensorflow.range", "tensorflow.cast", "tensorflow.nn.embedding_lookup", "tensorflow.reshape", "tensorflow.concat", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.reduce_mean", "tensorflow.reduce_mean", "range", "tensorflow.nn.dropout", "tensorflow.nn.dropout", "tensorflow.name_scope", "tensorflow.cast", "tensorflow.variable_scope", "tensorflow.get_variable", "tensorflow.get_variable", "tensorflow.get_variable", "tensorflow.variable_scope", "tensorflow.nn.bidirectional_dynamic_rnn", "tensorflow.concat", "tensorflow.matmul", "tensorflow.reshape", "tensorflow.transpose", "tensorflow.reduce_sum", "tensorflow.reduce_mean", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.nn.sigmoid", "tensorflow.nn.sigmoid", "tensorflow.nn.sigmoid", "tensorflow.nn.softmax", "model.Classifer.sum_together", "model.Classifer.sum_together", "model.Classifer.sum_together", "model.Classifer.sum_together", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.concat", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.nn.sigmoid", "tensorflow.nn.sigmoid", "tensorflow.nn.sigmoid", "tensorflow.nn.sigmoid", "tensorflow.nn.sigmoid", "tensorflow.nn.sigmoid", "tensorflow.concat", "tensorflow.nn.softmax", "tensorflow.split", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.fill", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.where", "tensorflow.reshape", "tensorflow.where", "tensorflow.reshape", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.name_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.cast", "tensorflow.sequence_mask", "tensorflow.variable_scope", "tensorflow.contrib.rnn.BasicLSTMCell", "tensorflow.contrib.rnn.DropoutWrapper", "tensorflow.variable_scope", "tensorflow.contrib.rnn.BasicLSTMCell", "tensorflow.contrib.rnn.DropoutWrapper", "tensorflow.matmul", "tensorflow.tile", "tensorflow.reshape", "tensorflow.concat", "tensorflow.reduce_sum", "tensorflow.nn.tanh", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.reshape", "tensorflow.tile", "tensorflow.tile", "tensorflow.expand_dims", "tensorflow.expand_dims", "tensorflow.expand_dims", "tensorflow.expand_dims", "tensorflow.expand_dims", "tensorflow.squeeze", "tensorflow.squeeze", "tensorflow.squeeze", "tensorflow.squeeze", "tensorflow.squeeze", "tensorflow.nn.tanh", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.sequence_mask", "tensorflow.contrib.layers.xavier_initializer", "tensorflow.contrib.layers.xavier_initializer", "tensorflow.reshape", "tensorflow.expand_dims", "tensorflow.squeeze", "model.Classifer.get_hidden_states_before", "range", "model.Classifer.get_hidden_states_after", "range", "model.Classifer.get_hidden_states_before", "range", "model.Classifer.get_hidden_states_after", "range", "tensorflow.expand_dims", "tensorflow.expand_dims", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.expand_dims", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul"], "methods", ["home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.sum_together", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.sum_together", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.sum_together", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.sum_together", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.get_hidden_states_before", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.get_hidden_states_after", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.get_hidden_states_before", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.get_hidden_states_after"], ["", "def", "slstm_cell", "(", "self", ",", "name_scope_name", ",", "hidden_size", ",", "lengths", ",", "initial_hidden_states", ",", "initial_cell_states", ",", "config", ")", ":", "\n", "        ", "with", "tf", ".", "name_scope", "(", "name_scope_name", ")", ":", "\n", "#forget gate for left ", "\n", "            ", "with", "tf", ".", "name_scope", "(", "\"f1_gate\"", ")", ":", "\n", "#current", "\n", "                ", "Wxf1", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxf\"", ")", "\n", "#left right", "\n", "Whf1", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "2", "*", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Whf\"", ")", "\n", "#initial state", "\n", "Wif1", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wif\"", ")", "\n", "#dummy node", "\n", "Wdf1", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wdf\"", ")", "\n", "#forget gate for right ", "\n", "", "with", "tf", ".", "name_scope", "(", "\"f2_gate\"", ")", ":", "\n", "                ", "Wxf2", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxf\"", ")", "\n", "Whf2", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "2", "*", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Whf\"", ")", "\n", "Wif2", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wif\"", ")", "\n", "Wdf2", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wdf\"", ")", "\n", "#forget gate for inital states     ", "\n", "", "with", "tf", ".", "name_scope", "(", "\"f3_gate\"", ")", ":", "\n", "                ", "Wxf3", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxf\"", ")", "\n", "Whf3", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "2", "*", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Whf\"", ")", "\n", "Wif3", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wif\"", ")", "\n", "Wdf3", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wdf\"", ")", "\n", "#forget gate for dummy states     ", "\n", "", "with", "tf", ".", "name_scope", "(", "\"f4_gate\"", ")", ":", "\n", "                ", "Wxf4", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxf\"", ")", "\n", "Whf4", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "2", "*", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Whf\"", ")", "\n", "Wif4", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wif\"", ")", "\n", "Wdf4", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wdf\"", ")", "\n", "#input gate for current state     ", "\n", "", "with", "tf", ".", "name_scope", "(", "\"i_gate\"", ")", ":", "\n", "                ", "Wxi", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxi\"", ")", "\n", "Whi", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "2", "*", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Whi\"", ")", "\n", "Wii", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wii\"", ")", "\n", "Wdi", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wdi\"", ")", "\n", "#input gate for output gate", "\n", "", "with", "tf", ".", "name_scope", "(", "\"o_gate\"", ")", ":", "\n", "                ", "Wxo", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxo\"", ")", "\n", "Who", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "2", "*", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Who\"", ")", "\n", "Wio", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wio\"", ")", "\n", "Wdo", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wdo\"", ")", "\n", "#bias for the gates    ", "\n", "", "with", "tf", ".", "name_scope", "(", "\"biases\"", ")", ":", "\n", "                ", "bi", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bi\"", ")", "\n", "bo", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bo\"", ")", "\n", "bf1", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bf1\"", ")", "\n", "bf2", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bf2\"", ")", "\n", "bf3", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bf3\"", ")", "\n", "bf4", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bf4\"", ")", "\n", "\n", "#dummy node gated attention parameters", "\n", "#input gate for dummy state", "\n", "", "with", "tf", ".", "name_scope", "(", "\"gated_d_gate\"", ")", ":", "\n", "                ", "gated_Wxd", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxf\"", ")", "\n", "gated_Whd", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Whf\"", ")", "\n", "#output gate", "\n", "", "with", "tf", ".", "name_scope", "(", "\"gated_o_gate\"", ")", ":", "\n", "                ", "gated_Wxo", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxo\"", ")", "\n", "gated_Who", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Who\"", ")", "\n", "#forget gate for states of word", "\n", "", "with", "tf", ".", "name_scope", "(", "\"gated_f_gate\"", ")", ":", "\n", "                ", "gated_Wxf", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Wxo\"", ")", "\n", "gated_Whf", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", ",", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"Who\"", ")", "\n", "#biases", "\n", "", "with", "tf", ".", "name_scope", "(", "\"gated_biases\"", ")", ":", "\n", "                ", "gated_bd", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bi\"", ")", "\n", "gated_bo", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bo\"", ")", "\n", "gated_bf", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "hidden_size", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"bo\"", ")", "\n", "\n", "#filters for attention        ", "\n", "", "", "mask_softmax_score", "=", "tf", ".", "cast", "(", "tf", ".", "sequence_mask", "(", "lengths", ")", ",", "tf", ".", "float32", ")", "*", "1e25", "-", "1e25", "\n", "mask_softmax_score_expanded", "=", "tf", ".", "expand_dims", "(", "mask_softmax_score", ",", "dim", "=", "2", ")", "\n", "#filter invalid steps", "\n", "sequence_mask", "=", "tf", ".", "expand_dims", "(", "tf", ".", "cast", "(", "tf", ".", "sequence_mask", "(", "lengths", ")", ",", "tf", ".", "float32", ")", ",", "axis", "=", "2", ")", "\n", "#filter embedding states", "\n", "initial_hidden_states", "=", "initial_hidden_states", "*", "sequence_mask", "\n", "initial_cell_states", "=", "initial_cell_states", "*", "sequence_mask", "\n", "#record shape of the batch", "\n", "shape", "=", "tf", ".", "shape", "(", "initial_hidden_states", ")", "\n", "batch_size", ",", "seq_len", "=", "shape", "[", "0", "]", ",", "shape", "[", "1", "]", "\n", "keep_word_emb", "=", "tf", ".", "identity", "(", "initial_hidden_states", ")", "\n", "\n", "with", "tf", ".", "variable_scope", "(", "\"layer_cal\"", ",", "initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "xavier_initializer", "(", ")", ")", ":", "\n", "            ", "self", ".", "layer_w", "=", "tf", ".", "get_variable", "(", "\"layer_w\"", ",", "[", "hidden_size", ",", "config", ".", "layer_emb_size", "]", ")", "\n", "self", ".", "layer_b", "=", "tf", ".", "get_variable", "(", "\"layer_b\"", ",", "[", "config", ".", "layer_emb_size", "]", ")", "\n", "self", ".", "restore_w", "=", "tf", ".", "get_variable", "(", "\"restore_w\"", ",", "[", "config", ".", "layer_emb_size", ",", "hidden_size", "]", ")", "\n", "\n", "\n", "", "with", "tf", ".", "variable_scope", "(", "\"first-bi-lstm\"", ",", "initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "xavier_initializer", "(", ")", ")", ":", "\n", "            ", "with", "tf", ".", "variable_scope", "(", "'fw'", ")", ":", "\n", "                ", "fw_lstm0", "=", "tf", ".", "contrib", ".", "rnn", ".", "BasicLSTMCell", "(", "config", ".", "hidden_size_lstm", ",", "forget_bias", "=", "0.0", ")", "\n", "fw_lstm0", "=", "tf", ".", "contrib", ".", "rnn", ".", "DropoutWrapper", "(", "fw_lstm0", ",", "output_keep_prob", "=", "config", ".", "rnn_keep_prob", ")", "\n", "\n", "", "with", "tf", ".", "variable_scope", "(", "'bw'", ")", ":", "\n", "                ", "bw_lstm0", "=", "tf", ".", "contrib", ".", "rnn", ".", "BasicLSTMCell", "(", "config", ".", "hidden_size_lstm", ",", "forget_bias", "=", "0.0", ")", "\n", "bw_lstm0", "=", "tf", ".", "contrib", ".", "rnn", ".", "DropoutWrapper", "(", "bw_lstm0", ",", "output_keep_prob", "=", "config", ".", "rnn_keep_prob", ")", "\n", "\n", "", "(", "fw0", ",", "bw0", ")", ",", "_", "=", "tf", ".", "nn", ".", "bidirectional_dynamic_rnn", "(", "fw_lstm0", ",", "bw_lstm0", ",", "inputs", "=", "initial_hidden_states", ",", "sequence_length", "=", "lengths", ",", "time_major", "=", "False", ",", "dtype", "=", "tf", ".", "float32", ")", "\n", "lstm_output", "=", "tf", ".", "concat", "(", "[", "fw0", ",", "bw0", "]", ",", "axis", "=", "-", "1", ")", "\n", "\n", "", "initial_hidden_states", "=", "tf", ".", "nn", ".", "dropout", "(", "lstm_output", ",", "config", ".", "rnn_keep_prob", ")", "\n", "layer_rep", "=", "tf", ".", "reshape", "(", "initial_hidden_states", ",", "[", "-", "1", ",", "config", ".", "hidden_size", "]", ")", "# [b*s, hidden_size]", "\n", "layer_rep", "=", "tf", ".", "matmul", "(", "layer_rep", ",", "self", ".", "layer_w", ")", "+", "self", ".", "layer_b", "\n", "layer_rep", "=", "tf", ".", "nn", ".", "tanh", "(", "layer_rep", ")", "\n", "# add  a small droupout", "\n", "layer_rep", "=", "tf", ".", "nn", ".", "dropout", "(", "layer_rep", ",", "0.9", ")", "\n", "# restore to hidden size", "\n", "# predict depths", "\n", "input_hidden_states", "=", "tf", ".", "reshape", "(", "tf", ".", "matmul", "(", "layer_rep", ",", "self", ".", "restore_w", ")", ",", "[", "batch_size", ",", "seq_len", ",", "hidden_size", "]", ")", "*", "sequence_mask", "\n", "input_cell_states", "=", "input_hidden_states", "\n", "layer_logits", "=", "tf", ".", "matmul", "(", "layer_rep", ",", "tf", ".", "transpose", "(", "self", ".", "layer_embedding", ",", "[", "1", ",", "0", "]", ")", ")", "# [b*s, layer_dim]  [layer_dim, layer_num]", "\n", "layer_logits", "=", "tf", ".", "reshape", "(", "layer_logits", ",", "[", "batch_size", ",", "seq_len", ",", "config", ".", "layer", "]", ")", "\n", "layer_logits", "=", "tf", ".", "nn", ".", "softmax", "(", "layer_logits", ",", "axis", "=", "-", "1", ")", "# [b, s, layer]", "\n", "index", "=", "tf", ".", "range", "(", "0", ",", "config", ".", "layer", ",", "dtype", "=", "tf", ".", "float32", ")", "# [0, 1, 2, ...]", "\n", "pred_layer_ids", "=", "tf", ".", "cast", "(", "tf", ".", "reduce_sum", "(", "tf", ".", "reshape", "(", "index", ",", "[", "1", ",", "1", ",", "-", "1", "]", ")", "*", "layer_logits", ",", "axis", "=", "-", "1", ")", ",", "tf", ".", "int32", ")", "# [b, s]", "\n", "layer_emb", "=", "tf", ".", "nn", ".", "embedding_lookup", "(", "self", ".", "layer_embedding", ",", "pred_layer_ids", ")", "# [b, s, layer_emb]   ", "\n", "pred_layer_ids", "=", "tf", ".", "reshape", "(", "pred_layer_ids", ",", "[", "-", "1", "]", ")", "\n", "\n", "#initial embedding states", "\n", "input_emb", "=", "tf", ".", "concat", "(", "[", "keep_word_emb", ",", "layer_emb", "]", ",", "-", "1", ")", "\n", "embedding_hidden_state", "=", "tf", ".", "reshape", "(", "input_emb", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "\n", "embedding_cell_state", "=", "tf", ".", "reshape", "(", "input_emb", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "\n", "\n", "#inital dummy node states", "\n", "dummynode_hidden_states", "=", "tf", ".", "reduce_mean", "(", "input_emb", ",", "axis", "=", "1", ")", "\n", "dummynode_cell_states", "=", "tf", ".", "reduce_mean", "(", "input_emb", ",", "axis", "=", "1", ")", "\n", "\n", "for", "i", "in", "range", "(", "config", ".", "layer", ")", ":", "\n", "#update dummy node states", "\n", "#average states", "\n", "            ", "combined_word_hidden_state", "=", "tf", ".", "reduce_mean", "(", "input_hidden_states", ",", "axis", "=", "1", ")", "# [b, hidden]", "\n", "reshaped_hidden_output", "=", "tf", ".", "reshape", "(", "input_hidden_states", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "# [b,*s, hidden + layer_emb]", "\n", "#copy dummy states for computing forget gate", "\n", "# [b*s, h+layer]", "\n", "transformed_dummynode_hidden_states", "=", "tf", ".", "reshape", "(", "tf", ".", "tile", "(", "tf", ".", "expand_dims", "(", "dummynode_hidden_states", ",", "axis", "=", "1", ")", ",", "[", "1", ",", "shape", "[", "1", "]", ",", "1", "]", ")", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "\n", "#input gate", "\n", "gated_d_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "dummynode_hidden_states", ",", "gated_Wxd", ")", "+", "tf", ".", "matmul", "(", "combined_word_hidden_state", ",", "gated_Whd", ")", "+", "gated_bd", "\n", ")", "\n", "#output gate", "\n", "gated_o_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "dummynode_hidden_states", ",", "gated_Wxo", ")", "+", "tf", ".", "matmul", "(", "combined_word_hidden_state", ",", "gated_Who", ")", "+", "gated_bo", "\n", ")", "\n", "#forget gate for hidden states", "\n", "gated_f_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "transformed_dummynode_hidden_states", ",", "gated_Wxf", ")", "+", "tf", ".", "matmul", "(", "reshaped_hidden_output", ",", "gated_Whf", ")", "+", "gated_bf", "\n", ")", "\n", "\n", "#softmax on each hidden dimension ", "\n", "reshaped_gated_f_t", "=", "tf", ".", "reshape", "(", "gated_f_t", ",", "[", "shape", "[", "0", "]", ",", "shape", "[", "1", "]", ",", "hidden_size", "]", ")", "+", "mask_softmax_score_expanded", "\n", "gated_softmax_scores", "=", "tf", ".", "nn", ".", "softmax", "(", "tf", ".", "concat", "(", "[", "reshaped_gated_f_t", ",", "tf", ".", "expand_dims", "(", "gated_d_t", ",", "dim", "=", "1", ")", "]", ",", "axis", "=", "1", ")", ",", "axis", "=", "1", ")", "\n", "#split the softmax scores", "\n", "new_reshaped_gated_f_t", "=", "gated_softmax_scores", "[", ":", ",", ":", "shape", "[", "1", "]", ",", ":", "]", "\n", "new_gated_d_t", "=", "gated_softmax_scores", "[", ":", ",", "shape", "[", "1", "]", ":", ",", ":", "]", "\n", "#new dummy states", "\n", "dummy_c_t", "=", "tf", ".", "reduce_sum", "(", "new_reshaped_gated_f_t", "*", "input_cell_states", ",", "axis", "=", "1", ")", "+", "tf", ".", "squeeze", "(", "new_gated_d_t", ",", "axis", "=", "1", ")", "*", "dummynode_cell_states", "\n", "dummy_h_t", "=", "gated_o_t", "*", "tf", ".", "nn", ".", "tanh", "(", "dummy_c_t", ")", "# [b, h+layer]", "\n", "#update word node states", "\n", "#get states before", "\n", "input_hidden_states_before", "=", "[", "tf", ".", "reshape", "(", "self", ".", "get_hidden_states_before", "(", "input_hidden_states", ",", "step", "+", "1", ",", "shape", ",", "hidden_size", ")", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "for", "step", "in", "range", "(", "self", ".", "config", ".", "step", ")", "]", "\n", "input_hidden_states_before", "=", "self", ".", "sum_together", "(", "input_hidden_states_before", ")", "\n", "input_hidden_states_after", "=", "[", "tf", ".", "reshape", "(", "self", ".", "get_hidden_states_after", "(", "input_hidden_states", ",", "step", "+", "1", ",", "shape", ",", "hidden_size", ")", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "for", "step", "in", "range", "(", "self", ".", "config", ".", "step", ")", "]", "\n", "input_hidden_states_after", "=", "self", ".", "sum_together", "(", "input_hidden_states_after", ")", "\n", "#get states after", "\n", "input_cell_states_before", "=", "[", "tf", ".", "reshape", "(", "self", ".", "get_hidden_states_before", "(", "input_cell_states", ",", "step", "+", "1", ",", "shape", ",", "hidden_size", ")", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "for", "step", "in", "range", "(", "self", ".", "config", ".", "step", ")", "]", "\n", "input_cell_states_before", "=", "self", ".", "sum_together", "(", "input_cell_states_before", ")", "\n", "input_cell_states_after", "=", "[", "tf", ".", "reshape", "(", "self", ".", "get_hidden_states_after", "(", "input_cell_states", ",", "step", "+", "1", ",", "shape", ",", "hidden_size", ")", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "for", "step", "in", "range", "(", "self", ".", "config", ".", "step", ")", "]", "\n", "input_cell_states_after", "=", "self", ".", "sum_together", "(", "input_cell_states_after", ")", "\n", "\n", "#reshape for matmul", "\n", "input_hidden_states", "=", "tf", ".", "reshape", "(", "input_hidden_states", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "# [b*s, h+layer]", "\n", "input_cell_states", "=", "tf", ".", "reshape", "(", "input_cell_states", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "# [b*s, h+layer]", "\n", "\n", "#concat before and after hidden states", "\n", "concat_before_after", "=", "tf", ".", "concat", "(", "[", "input_hidden_states_before", ",", "input_hidden_states_after", "]", ",", "axis", "=", "-", "1", ")", "\n", "\n", "#copy dummy node states ", "\n", "transformed_dummynode_hidden_states", "=", "tf", ".", "reshape", "(", "tf", ".", "tile", "(", "tf", ".", "expand_dims", "(", "dummynode_hidden_states", ",", "axis", "=", "1", ")", ",", "[", "1", ",", "shape", "[", "1", "]", ",", "1", "]", ")", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "\n", "transformed_dummynode_cell_states", "=", "tf", ".", "reshape", "(", "tf", ".", "tile", "(", "tf", ".", "expand_dims", "(", "dummynode_cell_states", ",", "axis", "=", "1", ")", ",", "[", "1", ",", "shape", "[", "1", "]", ",", "1", "]", ")", ",", "[", "-", "1", ",", "hidden_size", "]", ")", "\n", "\n", "f1_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "input_hidden_states", ",", "Wxf1", ")", "+", "tf", ".", "matmul", "(", "concat_before_after", ",", "Whf1", ")", "+", "\n", "tf", ".", "matmul", "(", "embedding_hidden_state", ",", "Wif1", ")", "+", "tf", ".", "matmul", "(", "transformed_dummynode_hidden_states", ",", "Wdf1", ")", "+", "bf1", "\n", ")", "\n", "\n", "f2_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "input_hidden_states", ",", "Wxf2", ")", "+", "tf", ".", "matmul", "(", "concat_before_after", ",", "Whf2", ")", "+", "\n", "tf", ".", "matmul", "(", "embedding_hidden_state", ",", "Wif2", ")", "+", "tf", ".", "matmul", "(", "transformed_dummynode_hidden_states", ",", "Wdf2", ")", "+", "bf2", "\n", ")", "\n", "\n", "f3_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "input_hidden_states", ",", "Wxf3", ")", "+", "tf", ".", "matmul", "(", "concat_before_after", ",", "Whf3", ")", "+", "\n", "tf", ".", "matmul", "(", "embedding_hidden_state", ",", "Wif3", ")", "+", "tf", ".", "matmul", "(", "transformed_dummynode_hidden_states", ",", "Wdf3", ")", "+", "bf3", "\n", ")", "\n", "\n", "f4_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "input_hidden_states", ",", "Wxf4", ")", "+", "tf", ".", "matmul", "(", "concat_before_after", ",", "Whf4", ")", "+", "\n", "tf", ".", "matmul", "(", "embedding_hidden_state", ",", "Wif4", ")", "+", "tf", ".", "matmul", "(", "transformed_dummynode_hidden_states", ",", "Wdf4", ")", "+", "bf4", "\n", ")", "\n", "\n", "i_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "input_hidden_states", ",", "Wxi", ")", "+", "tf", ".", "matmul", "(", "concat_before_after", ",", "Whi", ")", "+", "\n", "tf", ".", "matmul", "(", "embedding_hidden_state", ",", "Wii", ")", "+", "tf", ".", "matmul", "(", "transformed_dummynode_hidden_states", ",", "Wdi", ")", "+", "bi", "\n", ")", "\n", "\n", "o_t", "=", "tf", ".", "nn", ".", "sigmoid", "(", "\n", "tf", ".", "matmul", "(", "input_hidden_states", ",", "Wxo", ")", "+", "tf", ".", "matmul", "(", "concat_before_after", ",", "Who", ")", "+", "\n", "tf", ".", "matmul", "(", "embedding_hidden_state", ",", "Wio", ")", "+", "tf", ".", "matmul", "(", "transformed_dummynode_hidden_states", ",", "Wdo", ")", "+", "bo", "\n", ")", "\n", "\n", "f1_t", ",", "f2_t", ",", "f3_t", ",", "f4_t", ",", "i_t", "=", "tf", ".", "expand_dims", "(", "f1_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "expand_dims", "(", "f2_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "expand_dims", "(", "f3_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "expand_dims", "(", "f4_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "expand_dims", "(", "i_t", ",", "axis", "=", "1", ")", "\n", "\n", "\n", "five_gates", "=", "tf", ".", "concat", "(", "[", "f1_t", ",", "f2_t", ",", "f3_t", ",", "f4_t", ",", "i_t", "]", ",", "axis", "=", "1", ")", "\n", "five_gates", "=", "tf", ".", "nn", ".", "softmax", "(", "five_gates", ",", "dim", "=", "1", ")", "\n", "f1_t", ",", "f2_t", ",", "f3_t", ",", "f4_t", ",", "i_t", "=", "tf", ".", "split", "(", "five_gates", ",", "num_or_size_splits", "=", "5", ",", "axis", "=", "1", ")", "\n", "\n", "f1_t", ",", "f2_t", ",", "f3_t", ",", "f4_t", ",", "i_t", "=", "tf", ".", "squeeze", "(", "f1_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "squeeze", "(", "f2_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "squeeze", "(", "f3_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "squeeze", "(", "f4_t", ",", "axis", "=", "1", ")", ",", "tf", ".", "squeeze", "(", "i_t", ",", "axis", "=", "1", ")", "\n", "\n", "c_t", "=", "(", "f1_t", "*", "input_cell_states_before", ")", "+", "(", "f2_t", "*", "input_cell_states_after", ")", "+", "(", "f3_t", "*", "embedding_cell_state", ")", "+", "(", "f4_t", "*", "transformed_dummynode_cell_states", ")", "+", "(", "i_t", "*", "input_cell_states", ")", "\n", "\n", "h_t", "=", "o_t", "*", "tf", ".", "nn", ".", "tanh", "(", "c_t", ")", "\n", "#update states", "\n", "output_hidden_states", "=", "tf", ".", "reshape", "(", "h_t", ",", "[", "shape", "[", "0", "]", ",", "shape", "[", "1", "]", ",", "hidden_size", "]", ")", "\n", "output_cell_states", "=", "tf", ".", "reshape", "(", "c_t", ",", "[", "shape", "[", "0", "]", ",", "shape", "[", "1", "]", ",", "hidden_size", "]", ")", "\n", "output_hidden_states", "=", "output_hidden_states", "*", "sequence_mask", "\n", "output_cell_states", "=", "output_cell_states", "*", "sequence_mask", "\n", "\n", "dummynode_hidden_states", "=", "dummy_h_t", "\n", "dummynode_cell_states", "=", "dummy_c_t", "\n", "\n", "cur_layer_ids", "=", "tf", ".", "fill", "(", "[", "shape", "[", "0", "]", "*", "shape", "[", "1", "]", "]", ",", "i", ")", "\n", "output_hidden_states", "=", "tf", ".", "reshape", "(", "output_hidden_states", ",", "[", "shape", "[", "0", "]", "*", "shape", "[", "1", "]", ",", "hidden_size", "]", ")", "\n", "output_cell_states", "=", "tf", ".", "reshape", "(", "output_cell_states", ",", "[", "shape", "[", "0", "]", "*", "shape", "[", "1", "]", ",", "hidden_size", "]", ")", "\n", "\n", "input_hidden_states", "=", "tf", ".", "where", "(", "cur_layer_ids", "<", "pred_layer_ids", ",", "output_hidden_states", ",", "input_hidden_states", ")", "\n", "input_hidden_states", "=", "tf", ".", "reshape", "(", "input_hidden_states", ",", "[", "shape", "[", "0", "]", ",", "shape", "[", "1", "]", ",", "hidden_size", "]", ")", "\n", "\n", "input_cell_states", "=", "tf", ".", "where", "(", "cur_layer_ids", "<", "pred_layer_ids", ",", "output_cell_states", ",", "input_cell_states", ")", "\n", "input_cell_states", "=", "tf", ".", "reshape", "(", "input_cell_states", ",", "[", "shape", "[", "0", "]", ",", "shape", "[", "1", "]", ",", "hidden_size", "]", ")", "\n", "\n", "", "input_hidden_states", "=", "tf", ".", "nn", ".", "dropout", "(", "input_hidden_states", ",", "config", ".", "rnn_keep_prob", ")", "\n", "input_cell_states", "=", "tf", ".", "nn", ".", "dropout", "(", "input_cell_states", ",", "config", ".", "rnn_keep_prob", ")", "\n", "\n", "return", "input_hidden_states", ",", "input_cell_states", ",", "dummynode_hidden_states", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.__init__": [[309, 391], ["tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.shape", "tensorflow.concat", "tensorflow.reshape", "tensorflow.identity", "tensorflow.nn.dropout", "tensorflow.nn.dropout", "model.Classifer.slstm_cell", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.concat", "tensorflow.nn.relu", "tensorflow.argmax", "tensorflow.equal", "tensorflow.reduce_sum", "tensorflow.nn.sparse_softmax_cross_entropy_with_logits", "tensorflow.trainable_variables", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.gradients", "tensorflow.clip_by_global_norm", "tensorflow.train.AdamOptimizer", "tensorflow.train.AdamOptimizer.apply_gradients", "tensorflow.variable_scope", "tensorflow.Variable", "tensorflow.nn.embedding_lookup", "tensorflow.variable_scope", "tensorflow.get_variable", "tensorflow.variable_scope", "tensorflow.get_variable", "tensorflow.nn.embedding_lookup", "tensorflow.sequence_mask", "cnn.masked_conv1d_and_max", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.shape", "tensorflow.shape", "tensorflow.name_scope", "tensorflow.expand_dims", "tensorflow.to_float", "tensorflow.name_scope", "tensorflow.to_float", "tensorflow.reshape", "tensorflow.tile", "tensorflow.concat", "tensorflow.map_fn", "tensorflow.matmul", "tensorflow.cast", "tensorflow.reduce_mean", "zip", "model.load_glove", "tensorflow.reduce_sum", "tensorflow.nn.l2_loss", "tensorflow.contrib.layers.xavier_initializer", "tensorflow.contrib.layers.xavier_initializer", "tensorflow.reduce_max", "tensorflow.cast"], "methods", ["home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.slstm_cell", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.load_glove"], ["", "def", "__init__", "(", "self", ",", "config", ",", "session", ")", ":", "\n", "#inputs: features, mask, keep_prob, labels", "\n", "        ", "self", ".", "input_data", "=", "tf", ".", "placeholder", "(", "tf", ".", "int32", ",", "[", "None", ",", "None", "]", ",", "name", "=", "\"inputs\"", ")", "\n", "self", ".", "labels", "=", "tf", ".", "placeholder", "(", "tf", ".", "int64", ",", "[", "None", ",", "]", ",", "name", "=", "\"labels\"", ")", "\n", "self", ".", "mask", "=", "tf", ".", "placeholder", "(", "tf", ".", "int32", ",", "[", "None", ",", "]", ",", "name", "=", "\"mask\"", ")", "\n", "self", ".", "dropout", "=", "self", ".", "keep_prob", "=", "keep_prob", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "name", "=", "\"keep_prob\"", ")", "\n", "self", ".", "chars", "=", "tf", ".", "placeholder", "(", "tf", ".", "int32", ",", "[", "None", ",", "None", ",", "None", "]", ",", "name", "=", "\"input_char\"", ")", "\n", "self", ".", "char_mask", "=", "tf", ".", "placeholder", "(", "tf", ".", "int32", ",", "[", "None", ",", "None", "]", ",", "name", "=", "\"char_mask\"", ")", "\n", "self", ".", "max_word_len", "=", "tf", ".", "placeholder", "(", "tf", ".", "int32", ",", "[", "]", ",", "name", "=", "\"max_length_word\"", ")", "\n", "\n", "self", ".", "config", "=", "config", "\n", "shape", "=", "tf", ".", "shape", "(", "self", ".", "input_data", ")", "\n", "with", "tf", ".", "variable_scope", "(", "\"word_embedding\"", ")", ":", "\n", "            ", "self", ".", "embedding", "=", "tf", ".", "Variable", "(", "load_glove", "(", "self", ".", "config", ".", "glove_path", ")", ",", "\n", "dtype", "=", "tf", ".", "float32", ",", "\n", "name", "=", "\"embedding\"", ",", "\n", "trainable", "=", "config", ".", "embedding_trainable", "\n", ")", "\n", "input_words", "=", "tf", ".", "nn", ".", "embedding_lookup", "(", "self", ".", "embedding", ",", "self", ".", "input_data", ")", "\n", "", "with", "tf", ".", "variable_scope", "(", "\"layer_embedding\"", ",", "reuse", "=", "tf", ".", "AUTO_REUSE", ")", ":", "\n", "            ", "self", ".", "layer_embedding", "=", "tf", ".", "get_variable", "(", "\"layer_embedding\"", ",", "[", "self", ".", "config", ".", "layer", ",", "self", ".", "config", ".", "layer_emb_size", "]", ",", "initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "xavier_initializer", "(", ")", ")", "\n", "\n", "", "with", "tf", ".", "variable_scope", "(", "\"char_embedding\"", ")", ":", "\n", "            ", "char_emb", "=", "tf", ".", "get_variable", "(", "\"char_embedding\"", ",", "\n", "[", "self", ".", "config", ".", "char_size", ",", "self", ".", "config", ".", "char_emb_size", "]", ",", "\n", "initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "xavier_initializer", "(", ")", "\n", ")", "\n", "char_inputs", "=", "tf", ".", "nn", ".", "embedding_lookup", "(", "char_emb", ",", "self", ".", "chars", ")", "\n", "mask_weights", "=", "tf", ".", "sequence_mask", "(", "self", ".", "char_mask", ",", "maxlen", "=", "self", ".", "max_word_len", ")", "\n", "char_cnn_emb", "=", "masked_conv1d_and_max", "(", "char_inputs", ",", "mask_weights", ",", "self", ".", "config", ".", "char_emb_size", ",", "3", ",", "self", ".", "config", ".", "char_emb_size", ")", "\n", "\n", "", "concated_inputs", "=", "tf", ".", "concat", "(", "[", "input_words", ",", "char_cnn_emb", "]", ",", "-", "1", ")", "\n", "final_inputs", "=", "tf", ".", "reshape", "(", "concated_inputs", ",", "[", "shape", "[", "0", "]", ",", "-", "1", ",", "self", ".", "config", ".", "char_emb_size", "+", "300", "]", ")", "\n", "initial_hidden_states", "=", "final_inputs", "\n", "initial_cell_states", "=", "tf", ".", "identity", "(", "initial_hidden_states", ")", "\n", "initial_hidden_states", "=", "tf", ".", "nn", ".", "dropout", "(", "initial_hidden_states", ",", "keep_prob", ")", "\n", "initial_cell_states", "=", "tf", ".", "nn", ".", "dropout", "(", "initial_cell_states", ",", "keep_prob", ")", "\n", "\n", "#create layers ", "\n", "new_hidden_states", ",", "new_cell_state", ",", "dummynode_hidden_states", "=", "self", ".", "slstm_cell", "(", "\"slstm\"", ",", "config", ".", "hidden_size", ",", "self", ".", "mask", ",", "initial_hidden_states", ",", "initial_cell_states", ",", "config", ")", "\n", "\n", "softmax_w", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "3", "*", "(", "config", ".", "hidden_size", ")", ",", "config", ".", "num_label", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"softmax_w\"", ")", "\n", "softmax_b", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "config", ".", "num_label", "]", ",", "mean", "=", "0.0", ",", "stddev", "=", "0.1", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ",", "name", "=", "\"softmax_b\"", ")", "\n", "batch_size", "=", "tf", ".", "shape", "(", "new_hidden_states", ")", "[", "0", "]", "\n", "sent_size", "=", "tf", ".", "shape", "(", "new_hidden_states", ")", "[", "1", "]", "\n", "\n", "with", "tf", ".", "name_scope", "(", "\"mean\"", ")", ":", "\n", "            ", "mask_weight", "=", "tf", ".", "expand_dims", "(", "self", ".", "mask", ",", "-", "1", ")", "\n", "mask_weight", "=", "tf", ".", "to_float", "(", "mask_weight", ")", "\n", "mean_emb", "=", "tf", ".", "reduce_sum", "(", "new_hidden_states", ",", "axis", "=", "-", "2", ")", "/", "mask_weight", "\n", "\n", "", "with", "tf", ".", "name_scope", "(", "\"max\"", ")", ":", "\n", "            ", "float_mask", "=", "tf", ".", "to_float", "(", "self", ".", "mask", ")", "\n", "reshaped_mask", "=", "tf", ".", "reshape", "(", "float_mask", ",", "shape", "=", "[", "batch_size", ",", "1", ",", "1", "]", ")", "\n", "tile_mask", "=", "tf", ".", "tile", "(", "reshaped_mask", ",", "[", "1", ",", "sent_size", ",", "(", "config", ".", "hidden_size", ")", "*", "1", "]", ")", "\n", "concat_hidden", "=", "tf", ".", "concat", "(", "[", "new_hidden_states", ",", "tile_mask", "]", ",", "axis", "=", "-", "2", ")", "\n", "max_emb", "=", "tf", ".", "map_fn", "(", "lambda", "x", ":", "tf", ".", "reduce_max", "(", "x", "[", ":", "tf", ".", "cast", "(", "x", "[", "-", "1", "]", "[", "-", "1", "]", ",", "tf", ".", "int32", ")", "]", ",", "axis", "=", "-", "2", ")", ",", "concat_hidden", ")", "\n", "\n", "", "sent_emb", "=", "tf", ".", "concat", "(", "[", "mean_emb", ",", "max_emb", ",", "dummynode_hidden_states", "]", ",", "axis", "=", "-", "1", ")", "\n", "representation", "=", "tf", ".", "nn", ".", "relu", "(", "sent_emb", ")", "\n", "\n", "\n", "self", ".", "logits", "=", "tf", ".", "matmul", "(", "representation", ",", "softmax_w", ")", "+", "softmax_b", "\n", "#operators for prediction", "\n", "self", ".", "prediction", "=", "tf", ".", "argmax", "(", "self", ".", "logits", ",", "1", ")", "\n", "correct_prediction", "=", "tf", ".", "equal", "(", "self", ".", "prediction", ",", "self", ".", "labels", ")", "\n", "self", ".", "accuracy", "=", "tf", ".", "reduce_sum", "(", "tf", ".", "cast", "(", "correct_prediction", ",", "tf", ".", "float32", ")", ")", "\n", "\n", "#cross entropy loss", "\n", "self", ".", "loss", "=", "tf", ".", "nn", ".", "sparse_softmax_cross_entropy_with_logits", "(", "labels", "=", "self", ".", "labels", ",", "logits", "=", "self", ".", "logits", ")", "\n", "self", ".", "cost", "=", "tf", ".", "reduce_mean", "(", "self", ".", "loss", ")", "+", "config", ".", "l2_beta", "*", "tf", ".", "nn", ".", "l2_loss", "(", "self", ".", "embedding", ")", "\n", "\n", "#designate training variables", "\n", "tvars", "=", "tf", ".", "trainable_variables", "(", ")", "\n", "self", ".", "lr", "=", "tf", ".", "Variable", "(", "0.0", ",", "trainable", "=", "False", ")", "\n", "self", ".", "global_step", "=", "tf", ".", "Variable", "(", "0", ",", "dtype", "=", "tf", ".", "int32", ",", "trainable", "=", "False", ")", "\n", "\n", "grads", "=", "tf", ".", "gradients", "(", "self", ".", "cost", ",", "tvars", ")", "\n", "grads", ",", "_", "=", "tf", ".", "clip_by_global_norm", "(", "grads", ",", "config", ".", "max_grad_norm", ")", "\n", "self", ".", "grads", "=", "grads", "\n", "optimizer", "=", "tf", ".", "train", ".", "AdamOptimizer", "(", "config", ".", "learning_rate", ")", "\n", "self", ".", "train_op", "=", "optimizer", ".", "apply_gradients", "(", "zip", "(", "self", ".", "grads", ",", "tvars", ")", ",", "global_step", "=", "self", ".", "global_step", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.assign_lr": [[393, 395], ["session.run", "tensorflow.assign"], "methods", ["None"], ["", "def", "assign_lr", "(", "self", ",", "session", ",", "lr_value", ")", ":", "\n", "        ", "session", ".", "run", "(", "tf", ".", "assign", "(", "self", ".", "lr", ",", "lr_value", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.load_glove": [[19, 31], ["open", "numpy.asarray", "all_vectors.append", "float", "len", "print", "print", "line.strip().split", "line.strip().split", "line.strip", "line.strip"], "function", ["None"], ["def", "load_glove", "(", "glove_path", ")", ":", "\n", "    ", "with", "open", "(", "glove_path", ",", "\"r\"", ",", "encoding", "=", "\"utf-8\"", ")", "as", "glove_f", ":", "\n", "        ", "all_vectors", "=", "[", "]", "\n", "for", "line", "in", "glove_f", ":", "\n", "            ", "try", ":", "\n", "                ", "vectors", "=", "[", "float", "(", "word", ")", "for", "word", "in", "line", ".", "strip", "(", ")", ".", "split", "(", ")", "[", "1", ":", "]", "]", "\n", "all_vectors", ".", "append", "(", "vectors", ")", "\n", "assert", "len", "(", "vectors", ")", "==", "300", "\n", "", "except", "Exception", "as", "e", ":", "\n", "                ", "print", "(", "\"Warning : incomplete glove vector!\"", ")", "\n", "print", "(", "line", ".", "strip", "(", ")", ".", "split", "(", ")", ")", "\n", "", "", "return", "np", ".", "asarray", "(", "all_vectors", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.get_minibatches_idx": [[396, 411], ["numpy.arange", "range", "numpy.random.shuffle", "minibatches.append", "minibatches.append"], "function", ["None"], ["", "", "def", "get_minibatches_idx", "(", "n_samples", ",", "batch_size", ",", "shuffle", "=", "True", ")", ":", "\n", "    ", "idx_list", "=", "np", ".", "arange", "(", "n_samples", ",", "dtype", "=", "\"int32\"", ")", "\n", "\n", "if", "shuffle", ":", "\n", "        ", "np", ".", "random", ".", "shuffle", "(", "idx_list", ")", "\n", "\n", "", "minibatches", "=", "[", "]", "\n", "minibatch_start", "=", "0", "\n", "for", "i", "in", "range", "(", "n_samples", "//", "batch_size", ")", ":", "\n", "        ", "minibatches", ".", "append", "(", "idx_list", "[", "minibatch_start", ":", "\n", "minibatch_start", "+", "batch_size", "]", ")", "\n", "minibatch_start", "+=", "batch_size", "\n", "", "if", "(", "minibatch_start", "!=", "n_samples", ")", ":", "\n", "        ", "minibatches", ".", "append", "(", "idx_list", "[", "minibatch_start", ":", "]", ")", "\n", "", "return", "minibatches", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.run_epoch": [[412, 442], ["len", "model.get_minibatches_idx", "general_utils.Progbar", "enumerate", "data_utils.pad_sequences", "data_utils.pad_sequences", "session.run", "len", "len", "general_utils.Progbar.update", "saver.save"], "function", ["home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.get_minibatches_idx"], ["", "def", "run_epoch", "(", "session", ",", "config", ",", "model", ",", "data", ",", "eval_op", ",", "keep_prob", ",", "is_training", ",", "saver", "=", "None", ")", ":", "\n", "    ", "n_samples", "=", "len", "(", "data", "[", "0", "]", ")", "\n", "minibatches", "=", "get_minibatches_idx", "(", "n_samples", ",", "config", ".", "batch_size", ",", "shuffle", "=", "config", ".", "shuffle", ")", "\n", "correct", "=", "0.", "\n", "total", "=", "0", "\n", "total_cost", "=", "0", "\n", "prog", "=", "Progbar", "(", "target", "=", "len", "(", "minibatches", ")", ")", "\n", "for", "i", ",", "idx", "in", "enumerate", "(", "minibatches", ")", ":", "\n", "        ", "x", "=", "data", "[", "0", "]", "[", "idx", "]", "\n", "chars", "=", "data", "[", "3", "]", "[", "idx", "]", "\n", "x", ",", "mask", "=", "pad_sequences", "(", "x", ",", "0", ",", "max_seq_len", "=", "config", ".", "max_seq_len", ")", "\n", "if", "[", "]", "in", "chars", ":", "\n", "            ", "continue", "\n", "", "chars", ",", "char_mask", ",", "max_word_len", "=", "pad_sequences", "(", "chars", ",", "pad_tok", "=", "0", ",", "nlevels", "=", "2", ",", "max_seq_len", "=", "config", ".", "max_seq_len", ",", "max_word_len", "=", "config", ".", "max_word_len", ")", "\n", "\n", "y", "=", "data", "[", "1", "]", "[", "idx", "]", "\n", "max_word_len", "=", "max_word_len", "if", "max_word_len", "<", "config", ".", "max_word_len", "else", "config", ".", "max_word_len", "\n", "\n", "global_step", ",", "count", ",", "_", ",", "cost", "=", "session", ".", "run", "(", "[", "model", ".", "global_step", ",", "model", ".", "accuracy", ",", "eval_op", ",", "model", ".", "cost", "]", ",", "{", "model", ".", "input_data", ":", "x", ",", "model", ".", "labels", ":", "y", ",", "model", ".", "mask", ":", "mask", ",", "model", ".", "keep_prob", ":", "keep_prob", ",", "model", ".", "chars", ":", "chars", ",", "model", ".", "char_mask", ":", "char_mask", ",", "model", ".", "max_word_len", ":", "max_word_len", "}", ")", "\n", "correct", "+=", "count", "\n", "total", "+=", "len", "(", "idx", ")", "\n", "total_cost", "+=", "cost", "\n", "if", "is_training", ":", "\n", "            ", "prog", ".", "update", "(", "i", "+", "1", ",", "[", "(", "\"train loss\"", ",", "cost", ")", ",", "(", "\"step\"", ",", "global_step", ")", "]", ")", "\n", "", "if", "global_step", "%", "config", ".", "save_step", "==", "0", "and", "saver", ":", "\n", "           ", "saver", ".", "save", "(", "session", ",", "config", ".", "save_path", ",", "global_step", "=", "global_step", ")", "\n", "", "del", "cost", "\n", "", "accuracy", "=", "correct", "/", "total", "\n", "return", "accuracy", ",", "total_cost", ",", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.train_test_model": [[443, 454], ["model.assign_lr", "print", "time.time", "model.run_epoch", "print", "max", "time.time", "model.run_epoch", "print", "tensorflow.no_op", "session.run", "time.time", "time.time"], "function", ["home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.Classifer.assign_lr", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.run_epoch", "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.run_epoch"], ["", "def", "train_test_model", "(", "config", ",", "epoch_id", ",", "session", ",", "model", ",", "train_dataset", ",", "test_dataset", ",", "saver", "=", "None", ")", ":", "\n", "    ", "lr_decay", "=", "config", ".", "lr_decay", "**", "max", "(", "epoch_id", "-", "config", ".", "max_epoch", ",", "0.0", ")", "\n", "model", ".", "assign_lr", "(", "session", ",", "config", ".", "learning_rate", "*", "lr_decay", ")", "\n", "print", "(", "\"Epoch: %d Learning rate: %.5f\"", "%", "(", "epoch_id", "+", "1", ",", "session", ".", "run", "(", "model", ".", "lr", ")", ")", ")", "\n", "start_time", "=", "time", ".", "time", "(", ")", "\n", "train_acc", ",", "total_loss", "=", "run_epoch", "(", "session", ",", "config", ",", "model", ",", "train_dataset", ",", "model", ".", "train_op", ",", "config", ".", "keep_prob", ",", "True", ",", "saver", ")", "\n", "print", "(", "\"Train Accuracy = %.2f  loss: %.2f  time = %.2f seconds\\n\"", "%", "(", "100", "*", "train_acc", ",", "total_loss", ",", "time", ".", "time", "(", ")", "-", "start_time", ")", ")", "\n", "if", "epoch_id", "%", "config", ".", "eval_step", "==", "0", ":", "\n", "        ", "start_time", "=", "time", ".", "time", "(", ")", "\n", "test_acc", ",", "_", "=", "run_epoch", "(", "session", ",", "config", ",", "model", ",", "test_dataset", ",", "tf", ".", "no_op", "(", ")", ",", "1", ",", "False", ")", "\n", "print", "(", "\"Eval Accuracy = %.2f  time: %.3f\\n\"", "%", "(", "100", "*", "test_acc", ",", "time", ".", "time", "(", ")", "-", "start_time", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Adaxry_Depth-Adaptive-GRN.None.model.word_to_vec": [[456, 459], ["session.run", "tensorflow.assign"], "function", ["None"], ["", "", "def", "word_to_vec", "(", "matrix", ",", "session", ",", "config", ",", "*", "args", ")", ":", "\n", "    ", "for", "model", "in", "args", ":", "\n", "        ", "session", ".", "run", "(", "tf", ".", "assign", "(", "model", ".", "embedding", ",", "matrix", ")", ")", "\n", "\n"]]}