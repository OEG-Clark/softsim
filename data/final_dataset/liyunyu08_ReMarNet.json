{"home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.New_Net.__init__": [[85, 90], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "UIUC_ReMarNet.RelationNetwork", "UIUC_ReMarNet.Classifier_2", "list", "model.children"], "methods", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.Classifier_2.__init__"], ["    ", "def", "__init__", "(", "self", ",", "model", ")", ":", "\n", "        ", "super", "(", "New_Net", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "features", "=", "nn", ".", "Sequential", "(", "*", "list", "(", "model", ".", "children", "(", ")", ")", "[", ":", "-", "1", "]", ")", "\n", "self", ".", "classifier_1", "=", "RelationNetwork", "(", ")", "\n", "self", ".", "classifier_2", "=", "Classifier_2", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.New_Net.forward": [[92, 99], ["UIUC_ReMarNet.New_Net.features", "UIUC_ReMarNet.New_Net.features", "UIUC_ReMarNet.New_Net.classifier_1", "UIUC_ReMarNet.New_Net.view", "UIUC_ReMarNet.New_Net.classifier_2", "UIUC_ReMarNet.New_Net.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "query_samples", ",", "train_samples", ")", ":", "\n", "        ", "x_train", "=", "self", ".", "features", "(", "train_samples", ")", "\n", "x_query", "=", "self", ".", "features", "(", "query_samples", ")", "\n", "x_1", "=", "self", ".", "classifier_1", "(", "x_query", ",", "x_train", ")", "\n", "x", "=", "x_train", ".", "view", "(", "x_train", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "x_2", "=", "self", ".", "classifier_2", "(", "x", ")", "\n", "return", "x_1", ",", "x_2", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.RelationNetwork.__init__": [[103, 117], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d"], "methods", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.Classifier_2.__init__"], ["def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "RelationNetwork", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layer1", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "1024", ",", "64", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "64", ",", "momentum", "=", "1", ",", "affine", "=", "True", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "MaxPool2d", "(", "2", ")", ")", "\n", "self", ".", "layer2", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "64", ",", "momentum", "=", "1", ",", "affine", "=", "True", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "MaxPool2d", "(", "2", ")", ")", "\n", "self", ".", "fc1", "=", "nn", ".", "Linear", "(", "64", ",", "32", ")", "\n", "self", ".", "fc2", "=", "nn", ".", "Linear", "(", "32", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.RelationNetwork.forward": [[119, 127], ["UIUC_ReMarNet.RelationNetwork.Calculation", "UIUC_ReMarNet.RelationNetwork.layer1", "UIUC_ReMarNet.RelationNetwork.layer2", "torch.sigmoid.view", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid.size", "UIUC_ReMarNet.RelationNetwork.fc1", "UIUC_ReMarNet.RelationNetwork.fc2"], "methods", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.RelationNetwork.Calculation"], ["", "def", "forward", "(", "self", ",", "query_samples", ",", "train_samples", ")", ":", "\n", "        ", "x", "=", "self", ".", "Calculation", "(", "query_samples", ",", "train_samples", ")", "\n", "out", "=", "self", ".", "layer1", "(", "x", ")", "\n", "out", "=", "self", ".", "layer2", "(", "out", ")", "\n", "out", "=", "out", ".", "view", "(", "out", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "out", "=", "F", ".", "relu", "(", "self", ".", "fc1", "(", "out", ")", ")", "\n", "out", "=", "F", ".", "sigmoid", "(", "self", ".", "fc2", "(", "out", ")", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.RelationNetwork.Calculation": [[129, 135], ["query_samples.unsqueeze().repeat", "train_samples.unsqueeze().repeat", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "torch.cat().view", "len", "len", "query_samples.unsqueeze", "train_samples.unsqueeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "Calculation", "(", "self", ",", "query_samples", ",", "train_samples", ")", ":", "\n", "        ", "sample_features_ext", "=", "query_samples", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "len", "(", "train_samples", ")", ",", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "batch_features_ext", "=", "train_samples", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "len", "(", "query_samples", ")", ",", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "batch_features_ext", "=", "torch", ".", "transpose", "(", "batch_features_ext", ",", "0", ",", "1", ")", "\n", "relation_pairs", "=", "torch", ".", "cat", "(", "(", "sample_features_ext", ",", "batch_features_ext", ")", ",", "2", ")", ".", "view", "(", "-", "1", ",", "512", "*", "2", ",", "7", ",", "7", ")", "\n", "return", "relation_pairs", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.Classifier_2.__init__": [[137, 141], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.Classifier_2.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Classifier_2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "fc1", "=", "nn", ".", "Linear", "(", "25088", ",", "Last_FC_num", ")", "\n", "self", ".", "fc2", "=", "nn", ".", "Linear", "(", "Last_FC_num", ",", "class_num", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.Classifier_2.forward": [[142, 147], ["UIUC_ReMarNet.Classifier_2.fc1", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "UIUC_ReMarNet.Classifier_2.fc2"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "fc1", "(", "x", ")", "\n", "x", "=", "F", ".", "relu", "(", "x", ")", "\n", "x", "=", "self", ".", "fc2", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.train": [[149, 210], ["print", "net.train", "enumerate", "results_train_file.write", "results_train_file.flush", "print", "optimizer.zero_grad", "queryloader.__iter__().next", "torch.autograd.Variable().cuda", "net", "outputs_1.view.view", "mse", "criterion", "loss.backward", "optimizer.step", "loss.item", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "targets.size", "predicted_1.eq().cpu().sum", "predicted_2.eq().cpu().sum", "predicted.eq().cpu().sum", "torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable", "correct_1.numpy", "correct_2.numpy", "correct.numpy", "train_samples.cuda", "targets.cuda", "queryloader.__iter__", "query_samples.cuda", "query_labels.cuda", "torch.autograd.Variable", "predicted_1.eq().cpu", "predicted_2.eq().cpu", "predicted.eq().cpu", "torch.zeros().scatter_", "torch.zeros().scatter_", "torch.zeros().scatter_", "torch.zeros().scatter_", "targets.cpu().view", "predicted_1.eq", "predicted_2.eq", "predicted.eq", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "len", "targets.cpu"], "function", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.train"], ["", "", "def", "train", "(", "epoch", ",", "net", ",", "dataset", ")", ":", "\n", "    ", "print", "(", "'\\nEpoch: %d'", "%", "epoch", ")", "\n", "net", ".", "train", "(", ")", "\n", "train_loss", "=", "0", "\n", "correct", "=", "0", "\n", "correct_1", "=", "0", "\n", "correct_2", "=", "0", "\n", "total", "=", "0", "\n", "idx", "=", "0", "\n", "for", "batch_idx", ",", "(", "train_samples", ",", "targets", ")", "in", "enumerate", "(", "trainloader", ")", ":", "\n", "        ", "idx", "=", "batch_idx", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "if", "use_cuda", ":", "\n", "            ", "train_samples", ",", "targets", "=", "train_samples", ".", "cuda", "(", ")", ",", "targets", ".", "cuda", "(", ")", "\n", "\n", "", "train_samples", ",", "targets", "=", "Variable", "(", "train_samples", ")", ",", "Variable", "(", "targets", ")", "\n", "query_samples", ",", "query_labels", "=", "queryloader", ".", "__iter__", "(", ")", ".", "next", "(", ")", "\n", "\n", "if", "use_cuda", ":", "\n", "            ", "query_samples", ",", "query_labels", "=", "query_samples", ".", "cuda", "(", ")", ",", "query_labels", ".", "cuda", "(", ")", "\n", "\n", "", "query_samples", ",", "query_labels", "=", "Variable", "(", "query_samples", ")", ",", "Variable", "(", "query_labels", ")", "\n", "one_hot_labels", "=", "Variable", "(", "torch", ".", "zeros", "(", "len", "(", "train_samples", ")", ",", "class_num", ")", ".", "scatter_", "(", "1", ",", "targets", ".", "cpu", "(", ")", ".", "view", "(", "-", "1", ",", "1", ")", ",", "1", ")", ")", ".", "cuda", "(", ")", "\n", "\n", "\n", "outputs_1", ",", "outputs_2", "=", "net", "(", "query_samples", ",", "train_samples", ")", "# RN , FC", "\n", "outputs_1", "=", "outputs_1", ".", "view", "(", "-", "1", ",", "class_num", ")", "\n", "outputs", "=", "outputs_1", "+", "outputs_2", "\n", "\n", "loss1", "=", "mse", "(", "outputs_1", ",", "one_hot_labels", ")", "\n", "loss2", "=", "criterion", "(", "outputs_2", ",", "targets", ")", "\n", "loss", "=", "loss1", "+", "loss2", "\n", "loss", ".", "backward", "(", ")", "\n", "\n", "optimizer", ".", "step", "(", ")", "\n", "train_loss", "+=", "loss", ".", "item", "(", ")", "\n", "\n", "_", ",", "predicted_1", "=", "torch", ".", "max", "(", "outputs_1", ".", "data", ",", "1", ")", "\n", "_", ",", "predicted_2", "=", "torch", ".", "max", "(", "outputs_2", ".", "data", ",", "1", ")", "\n", "_", ",", "predicted", "=", "torch", ".", "max", "(", "outputs", ".", "data", ",", "1", ")", "\n", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "\n", "\n", "correct_1", "+=", "predicted_1", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "correct_2", "+=", "predicted_2", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "\n", "", "train_acc_1", "=", "1.", "*", "correct_1", ".", "numpy", "(", ")", "/", "total", "\n", "train_acc_2", "=", "1.", "*", "correct_2", ".", "numpy", "(", ")", "/", "total", "\n", "train_acc", "=", "1.", "*", "correct", ".", "numpy", "(", ")", "/", "total", "\n", "train_loss", "=", "train_loss", "/", "(", "idx", "+", "1", ")", "\n", "\n", "results_train_file", ".", "write", "(", "'%d, %.4f, %.4f, %.4f, %.4f\\n'", "%", "(", "epoch", ",", "train_acc_1", ",", "train_acc_2", ",", "train_acc", ",", "train_loss", ")", ")", "\n", "results_train_file", ".", "flush", "(", ")", "\n", "\n", "\n", "print", "(", "'loss: {}, acc_1: {}%, acc_2: {}%, acc: {}%'", ".", "format", "(", "\n", "train_loss", ",", "100.", "*", "correct_1", "/", "total", ",", "100.", "*", "correct_2", "/", "total", ",", "100.", "*", "correct", "/", "total", ")", ")", "\n", "return", "train_acc", ",", "train_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_ReMarNet.test": [[212, 266], ["net.eval", "enumerate", "results_test_file.write", "results_test_file.flush", "print", "queryloader.__iter__().next", "torch.autograd.Variable().cuda", "net", "outputs_1.view.view", "mse", "criterion", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "targets.size", "predicted_1.eq().cpu().sum", "predicted_2.eq().cpu().sum", "predicted.eq().cpu().sum", "loss.item", "torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable", "correct_1.numpy", "correct_2.numpy", "correct.numpy", "test_samples.cuda", "targets.cuda", "queryloader.__iter__", "query_samples.cuda", "query_labels.cuda", "torch.autograd.Variable", "predicted_1.eq().cpu", "predicted_2.eq().cpu", "predicted.eq().cpu", "torch.zeros().scatter_", "torch.zeros().scatter_", "torch.zeros().scatter_", "torch.zeros().scatter_", "targets.cpu().view", "predicted_1.eq", "predicted_2.eq", "predicted.eq", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "len", "targets.cpu"], "function", ["None"], ["", "def", "test", "(", "epoch", ",", "net", ",", "dataset", ")", ":", "\n", "    ", "net", ".", "eval", "(", ")", "\n", "test_loss", "=", "0", "\n", "correct", "=", "0", "\n", "correct_1", "=", "0", "\n", "correct_2", "=", "0", "\n", "total", "=", "0", "\n", "idx", "=", "0", "\n", "for", "batch_idx", ",", "(", "test_samples", ",", "targets", ")", "in", "enumerate", "(", "dataset", ")", ":", "\n", "        ", "idx", "=", "batch_idx", "\n", "if", "use_cuda", ":", "\n", "            ", "test_samples", ",", "targets", "=", "test_samples", ".", "cuda", "(", ")", ",", "targets", ".", "cuda", "(", ")", "\n", "\n", "", "test_samples", ",", "targets", "=", "Variable", "(", "test_samples", ")", ",", "Variable", "(", "targets", ")", "\n", "query_samples", ",", "query_labels", "=", "queryloader", ".", "__iter__", "(", ")", ".", "next", "(", ")", "\n", "\n", "if", "use_cuda", ":", "\n", "            ", "query_samples", ",", "query_labels", "=", "query_samples", ".", "cuda", "(", ")", ",", "query_labels", ".", "cuda", "(", ")", "\n", "\n", "", "query_samples", ",", "query_labels", "=", "Variable", "(", "query_samples", ")", ",", "Variable", "(", "query_labels", ")", "\n", "one_hot_labels", "=", "Variable", "(", "torch", ".", "zeros", "(", "len", "(", "test_samples", ")", ",", "class_num", ")", ".", "scatter_", "(", "1", ",", "targets", ".", "cpu", "(", ")", ".", "view", "(", "-", "1", ",", "1", ")", ",", "1", ")", ")", ".", "cuda", "(", ")", "\n", "\n", "outputs_1", ",", "outputs_2", "=", "net", "(", "query_samples", ",", "test_samples", ")", "\n", "outputs_1", "=", "outputs_1", ".", "view", "(", "-", "1", ",", "class_num", ")", "\n", "outputs", "=", "outputs_1", "+", "outputs_2", "\n", "\n", "loss1", "=", "mse", "(", "outputs_1", ",", "one_hot_labels", ")", "\n", "loss2", "=", "criterion", "(", "outputs_2", ",", "targets", ")", "\n", "loss", "=", "loss1", "+", "loss2", "\n", "\n", "_", ",", "predicted_1", "=", "torch", ".", "max", "(", "outputs_1", ".", "data", ",", "1", ")", "\n", "_", ",", "predicted_2", "=", "torch", ".", "max", "(", "outputs_2", ".", "data", ",", "1", ")", "\n", "_", ",", "predicted", "=", "torch", ".", "max", "(", "outputs", ".", "data", ",", "1", ")", "\n", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "\n", "correct_1", "+=", "predicted_1", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "correct_2", "+=", "predicted_2", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "\n", "test_loss", "+=", "loss", ".", "item", "(", ")", "\n", "\n", "\n", "", "test_loss", "=", "test_loss", "/", "(", "idx", "+", "1", ")", "\n", "test_acc_1", "=", "1.", "*", "correct_1", ".", "numpy", "(", ")", "/", "total", "\n", "test_acc_2", "=", "1.", "*", "correct_2", ".", "numpy", "(", ")", "/", "total", "\n", "test_acc", "=", "1.", "*", "correct", ".", "numpy", "(", ")", "/", "total", "\n", "results_test_file", ".", "write", "(", "'%d, %.4f, %.4f, %.4f, %.4f\\n'", "%", "(", "epoch", ",", "test_acc_1", ",", "test_acc_2", ",", "test_acc", ",", "test_loss", ")", ")", "\n", "results_test_file", ".", "flush", "(", ")", "\n", "\n", "print", "(", "'loss: {}, acc_1: {}%, acc_2: {}%, acc: {}%'", ".", "format", "(", "\n", "test_loss", ",", "100.", "*", "correct_1", "/", "total", ",", "100.", "*", "correct_2", "/", "total", ",", "100.", "*", "correct", "/", "total", ")", ")", "\n", "\n", "return", "test_acc", ",", "test_acc_1", ",", "test_acc_2", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.New_Net.__init__": [[78, 82], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "UIUC_Baseline.Classifier_2", "list", "model.children"], "methods", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.Classifier_2.__init__"], ["    ", "def", "__init__", "(", "self", ",", "model", ")", ":", "\n", "        ", "super", "(", "New_Net", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "features", "=", "nn", ".", "Sequential", "(", "*", "list", "(", "model", ".", "children", "(", ")", ")", "[", ":", "-", "1", "]", ")", "\n", "self", ".", "classifier_2", "=", "Classifier_2", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.New_Net.forward": [[84, 89], ["UIUC_Baseline.New_Net.features", "UIUC_Baseline.New_Net.view", "UIUC_Baseline.New_Net.classifier_2", "UIUC_Baseline.New_Net.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "train_samples", ")", ":", "\n", "        ", "x_train", "=", "self", ".", "features", "(", "train_samples", ")", "\n", "x", "=", "x_train", ".", "view", "(", "x_train", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "x_2", "=", "self", ".", "classifier_2", "(", "x", ")", "\n", "return", "x_2", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.Classifier_2.__init__": [[92, 96], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.Classifier_2.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Classifier_2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "fc1", "=", "nn", ".", "Linear", "(", "25088", ",", "Last_FC_num", ")", "\n", "self", ".", "fc2", "=", "nn", ".", "Linear", "(", "Last_FC_num", ",", "class_num", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.Classifier_2.forward": [[97, 102], ["UIUC_Baseline.Classifier_2.fc1", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "UIUC_Baseline.Classifier_2.fc2"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "fc1", "(", "x", ")", "\n", "x", "=", "F", ".", "relu", "(", "x", ")", "\n", "x", "=", "self", ".", "fc2", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.train": [[104, 139], ["print", "net.train", "enumerate", "results_train_file.write", "results_train_file.flush", "print", "optimizer.zero_grad", "net", "criterion", "criterion.backward", "optimizer.step", "criterion.item", "torch.max", "torch.max", "torch.max", "torch.max", "targets.size", "predicted.eq().cpu().sum", "torch.autograd.Variable", "torch.autograd.Variable", "correct.numpy", "train_samples.cuda", "targets.cuda", "predicted.eq().cpu", "predicted.eq"], "function", ["home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.train"], ["", "", "def", "train", "(", "epoch", ",", "net", ",", "dataset", ")", ":", "\n", "    ", "print", "(", "'\\nEpoch: %d'", "%", "epoch", ")", "\n", "net", ".", "train", "(", ")", "\n", "train_loss", "=", "0", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "idx", "=", "0", "\n", "for", "batch_idx", ",", "(", "train_samples", ",", "targets", ")", "in", "enumerate", "(", "trainloader", ")", ":", "\n", "        ", "idx", "=", "batch_idx", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "if", "use_cuda", ":", "\n", "            ", "train_samples", ",", "targets", "=", "train_samples", ".", "cuda", "(", ")", ",", "targets", ".", "cuda", "(", ")", "\n", "\n", "", "train_samples", ",", "targets", "=", "Variable", "(", "train_samples", ")", ",", "Variable", "(", "targets", ")", "\n", "outputs", "=", "net", "(", "train_samples", ")", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "train_loss", "+=", "loss", ".", "item", "(", ")", "\n", "_", ",", "predicted", "=", "torch", ".", "max", "(", "outputs", ".", "data", ",", "1", ")", "\n", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "\n", "\n", "", "train_acc", "=", "1.", "*", "correct", ".", "numpy", "(", ")", "/", "total", "\n", "train_loss", "=", "train_loss", "/", "(", "idx", "+", "1", ")", "\n", "results_train_file", ".", "write", "(", "'%d,  %.4f, %.4f\\n'", "%", "(", "epoch", ",", "train_acc", ",", "train_loss", ")", ")", "\n", "results_train_file", ".", "flush", "(", ")", "\n", "\n", "\n", "print", "(", "'loss: {}, acc: {}%'", ".", "format", "(", "\n", "train_loss", ",", "100.", "*", "correct", "/", "total", ")", ")", "\n", "return", "train_acc", ",", "train_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.liyunyu08_ReMarNet.None.UIUC_Baseline.test": [[141, 171], ["net.eval", "enumerate", "results_test_file.write", "results_test_file.flush", "print", "net", "criterion", "torch.max", "torch.max", "torch.max", "torch.max", "targets.size", "predicted.eq().cpu().sum", "criterion.item", "torch.autograd.Variable", "torch.autograd.Variable", "correct.numpy", "test_samples.cuda", "targets.cuda", "predicted.eq().cpu", "predicted.eq"], "function", ["None"], ["", "def", "test", "(", "epoch", ",", "net", ",", "dataset", ")", ":", "\n", "    ", "net", ".", "eval", "(", ")", "\n", "test_loss", "=", "0", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "idx", "=", "0", "\n", "for", "batch_idx", ",", "(", "test_samples", ",", "targets", ")", "in", "enumerate", "(", "dataset", ")", ":", "\n", "        ", "idx", "=", "batch_idx", "\n", "if", "use_cuda", ":", "\n", "            ", "test_samples", ",", "targets", "=", "test_samples", ".", "cuda", "(", ")", ",", "targets", ".", "cuda", "(", ")", "\n", "\n", "", "test_samples", ",", "targets", "=", "Variable", "(", "test_samples", ")", ",", "Variable", "(", "targets", ")", "\n", "\n", "outputs", "=", "net", "(", "test_samples", ")", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "_", ",", "predicted", "=", "torch", ".", "max", "(", "outputs", ".", "data", ",", "1", ")", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ".", "data", ")", ".", "cpu", "(", ")", ".", "sum", "(", ")", "\n", "test_loss", "+=", "loss", ".", "item", "(", ")", "\n", "\n", "\n", "", "test_loss", "=", "test_loss", "/", "(", "idx", "+", "1", ")", "\n", "test_acc", "=", "1.", "*", "correct", ".", "numpy", "(", ")", "/", "total", "\n", "results_test_file", ".", "write", "(", "'%d, %.4f, %.4f\\n'", "%", "(", "epoch", ",", "test_acc", ",", "test_loss", ")", ")", "\n", "results_test_file", ".", "flush", "(", ")", "\n", "\n", "print", "(", "'loss: {},  acc: {}%'", ".", "format", "(", "\n", "test_loss", ",", "100.", "*", "correct", "/", "total", ")", ")", "\n", "\n", "return", "test_acc", "\n", "\n"]]}