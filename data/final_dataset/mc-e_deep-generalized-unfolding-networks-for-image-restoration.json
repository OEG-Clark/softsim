{"home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.config.Config.__init__": [[56, 90], ["yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "config.Config._C.merge_from_file", "config.Config._C.merge_from_list", "config.Config._C.freeze"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.freeze"], ["def", "__init__", "(", "self", ",", "config_yaml", ":", "str", ",", "config_override", ":", "List", "[", "Any", "]", "=", "[", "]", ")", ":", "\n", "\n", "        ", "self", ".", "_C", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "GPU", "=", "[", "0", "]", "\n", "self", ".", "_C", ".", "VERBOSE", "=", "False", "\n", "\n", "self", ".", "_C", ".", "MODEL", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "MODEL", ".", "MODE", "=", "'global'", "\n", "self", ".", "_C", ".", "MODEL", ".", "SESSION", "=", "'ps128_bs1'", "\n", "\n", "self", ".", "_C", ".", "OPTIM", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BATCH_SIZE", "=", "1", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NUM_EPOCHS", "=", "100", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NEPOCH_DECAY", "=", "[", "100", "]", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_INITIAL", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_MIN", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BETA1", "=", "0.5", "\n", "\n", "self", ".", "_C", ".", "TRAINING", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_AFTER_EVERY", "=", "3", "\n", "self", ".", "_C", ".", "TRAINING", ".", "RESUME", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_IMAGES", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_DIR", "=", "'images_dir/train'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_DIR", "=", "'images_dir/val'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_DIR", "=", "'checkpoints'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_PS", "=", "64", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_PS", "=", "64", "\n", "\n", "# Override parameter values from YAML file first, then from override list.", "\n", "self", ".", "_C", ".", "merge_from_file", "(", "config_yaml", ")", "\n", "self", ".", "_C", ".", "merge_from_list", "(", "config_override", ")", "\n", "\n", "# Make an instantiated object of this class immutable.", "\n", "self", ".", "_C", ".", "freeze", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.config.Config.dump": [[91, 100], ["config.Config._C.dump", "open"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.dump"], ["", "def", "dump", "(", "self", ",", "file_path", ":", "str", ")", ":", "\n", "        ", "r\"\"\"Save config at the specified file path.\n\n        Parameters\n        ----------\n        file_path: str\n            (YAML) path to save config at.\n        \"\"\"", "\n", "self", ".", "_C", ".", "dump", "(", "stream", "=", "open", "(", "file_path", ",", "\"w\"", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.config.Config.__getattr__": [[101, 103], ["config.Config._C.__getattr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__getattr__"], ["", "def", "__getattr__", "(", "self", ",", "attr", ":", "str", ")", ":", "\n", "        ", "return", "self", ".", "_C", ".", "__getattr__", "(", "attr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.config.Config.__repr__": [[104, 106], ["config.Config._C.__repr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__repr__"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "_C", ".", "__repr__", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.CALayer.__init__": [[21, 31], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n", "self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.CALayer.forward": [[33, 37], ["DGUNet_deblock.CALayer.avg_pool", "DGUNet_deblock.CALayer.conv_du"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.CAB.__init__": [[42, 51], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet_deblock.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_deblock.conv", "DGUNet_deblock.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.CAB.forward": [[52, 57], ["DGUNet_deblock.CAB.body", "DGUNet_deblock.CAB.CA"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "=", "self", ".", "CA", "(", "res", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.SAM.__init__": [[62, 67], ["torch.Module.__init__", "DGUNet_deblock.conv", "DGUNet_deblock.conv", "DGUNet_deblock.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.SAM.forward": [[68, 75], ["DGUNet_deblock.SAM.conv1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet_deblock.SAM.conv2", "DGUNet_deblock.SAM.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n", "x2", "=", "torch", ".", "sigmoid", "(", "self", ".", "conv3", "(", "img", ")", ")", "\n", "x1", "=", "x1", "*", "x2", "\n", "x1", "=", "x1", "+", "x", "\n", "return", "x1", ",", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.UNetConvBlock.__init__": [[77, 98], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet_deblock.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_1", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_2", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "csff_dec", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "if", "use_HIN", ":", "\n", "            ", "self", ".", "norm", "=", "nn", ".", "InstanceNorm2d", "(", "out_size", "//", "2", ",", "affine", "=", "True", ")", "\n", "", "self", ".", "use_HIN", "=", "use_HIN", "\n", "\n", "if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.UNetConvBlock.forward": [[99, 118], ["DGUNet_deblock.UNetConvBlock.conv_1", "DGUNet_deblock.UNetConvBlock.relu_1", "DGUNet_deblock.UNetConvBlock.relu_2", "DGUNet_deblock.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_deblock.UNetConvBlock.conv_2", "DGUNet_deblock.UNetConvBlock.downsample", "DGUNet_deblock.UNetConvBlock.csff_dec", "DGUNet_deblock.UNetConvBlock.norm", "DGUNet_deblock.UNetConvBlock.csff_enc"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n", "\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n", "", "out", "=", "self", ".", "relu_1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_2", "(", "self", ".", "conv_2", "(", "out", ")", ")", "\n", "\n", "out", "+=", "self", ".", "identity", "(", "x", ")", "\n", "if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n", "", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n", "return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.UNetUpBlock.__init__": [[121, 125], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet_deblock.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.UNetUpBlock.forward": [[126, 132], ["DGUNet_deblock.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_deblock.UNetUpBlock.conv_block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "#         print('merge',x.shape,bridge.shape)", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.Encoder.__init__": [[136, 145], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_deblock.Encoder.body.append", "DGUNet_deblock.Encoder.body.append", "DGUNet_deblock.UNetConvBlock", "DGUNet_deblock.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "#             downsample = True if (i+1) < depth else False", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.Encoder.forward": [[146, 163], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "return", "res", ",", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.Decoder.__init__": [[166, 174], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_deblock.Decoder.body.append", "DGUNet_deblock.Decoder.skip_conv.append", "DGUNet_deblock.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.Decoder.forward": [[175, 182], ["enumerate", "up", "res.append"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.DownSample.__init__": [[187, 191], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.DownSample.forward": [[192, 195], ["DGUNet_deblock.DownSample.down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.UpSample.__init__": [[198, 202], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.UpSample.forward": [[203, 206], ["DGUNet_deblock.UpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.SkipUpSample.__init__": [[209, 213], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "SkipUpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.SkipUpSample.forward": [[214, 218], ["DGUNet_deblock.SkipUpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.ORB.__init__": [[223, 229], ["torch.Module.__init__", "modules_body.append", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_deblock.CAB", "DGUNet_deblock.conv", "range"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.ORB.forward": [[230, 234], ["DGUNet_deblock.ORB.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.ORSNet.__init__": [[238, 261], ["torch.Module.__init__", "DGUNet_deblock.ORB", "DGUNet_deblock.ORB", "DGUNet_deblock.ORB", "DGUNet_deblock.UpSample", "DGUNet_deblock.UpSample", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "DGUNet_deblock.UpSample", "DGUNet_deblock.UpSample", "DGUNet_deblock.UpSample", "DGUNet_deblock.UpSample"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORSNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "orb1", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb2", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb3", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "\n", "self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n", "self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n", "self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n", "\n", "\n", "self", ".", "conv_enc1", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc2", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.ORSNet.forward": [[262, 273], ["DGUNet_deblock.ORSNet.orb1", "DGUNet_deblock.ORSNet.orb2", "DGUNet_deblock.ORSNet.orb3", "DGUNet_deblock.ORSNet.conv_dec1", "DGUNet_deblock.ORSNet.conv_dec2", "DGUNet_deblock.ORSNet.conv_dec3", "DGUNet_deblock.ORSNet.conv_enc1", "DGUNet_deblock.ORSNet.conv_enc2", "DGUNet_deblock.ORSNet.up_dec1", "DGUNet_deblock.ORSNet.conv_enc3", "DGUNet_deblock.ORSNet.up_dec2", "DGUNet_deblock.ORSNet.up_enc1", "DGUNet_deblock.ORSNet.up_enc2"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n", "        ", "x", "=", "self", ".", "orb1", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc1", "(", "encoder_outs", "[", "0", "]", ")", "+", "self", ".", "conv_dec1", "(", "decoder_outs", "[", "-", "1", "]", ")", "\n", "\n", "x", "=", "self", ".", "orb2", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc2", "(", "self", ".", "up_enc1", "(", "encoder_outs", "[", "1", "]", ")", ")", "+", "self", ".", "conv_dec2", "(", "self", ".", "up_dec1", "(", "decoder_outs", "[", "-", "2", "]", ")", ")", "\n", "\n", "x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.ResBlock.__init__": [[280, 298], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet_deblock.conv", "DGUNet_deblock.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n", "bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "act", ")", "\n", "\n", "", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "m", ")", "\n", "self", ".", "res_scale", "=", "res_scale", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.ResBlock.forward": [[299, 304], ["DGUNet_deblock.ResBlock.body().mul", "DGUNet_deblock.ResBlock.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.MPRBlock.__init__": [[307, 327], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_deblock.Encoder", "DGUNet_deblock.Decoder", "DGUNet_deblock.SAM", "DGUNet_deblock.ResBlock", "DGUNet_deblock.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_deblock.conv", "DGUNet_deblock.conv", "DGUNet_deblock.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "block_size", "=", "32", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "block_size", "=", "block_size", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.MPRBlock.forward": [[327, 350], ["torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "x_k_1.view.view.view", "torch.fold().contiguous.view().permute().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "DGUNet_deblock.MPRBlock.shallow_feat", "DGUNet_deblock.MPRBlock.concat", "DGUNet_deblock.MPRBlock.stage_encoder", "DGUNet_deblock.MPRBlock.stage_decoder", "DGUNet_deblock.MPRBlock.sam", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.unfold().permute", "torch.unfold().permute", "torch.unfold().permute", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute", "torch.fold", "torch.fold", "torch.fold", "torch.unfold", "torch.unfold", "torch.unfold", "torch.fold().contiguous.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "F", ".", "unfold", "(", "stage_img", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "# (b,l,cwh)", "\n", "l", "=", "x_k_1", ".", "shape", "[", "1", "]", "\n", "x_k_1", "=", "x_k_1", ".", "view", "(", "b", "*", "l", ",", "-", "1", ")", "\n", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "l", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "#view(b,l,w,h)", "\n", "r_k", "=", "F", ".", "fold", "(", "r_k", ",", "output_size", "=", "(", "w", ",", "h", ")", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "contiguous", "(", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.DGUNet.__init__": [[353, 384], ["torch.Module.__init__", "print", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "DGUNet_deblock.MPRBlock", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_deblock.Encoder", "DGUNet_deblock.Decoder", "DGUNet_deblock.SAM", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_deblock.conv", "DGUNet_deblock.conv", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "DGUNet_deblock.conv", "DGUNet_deblock.CAB", "DGUNet_deblock.conv", "DGUNet_deblock.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "numpy.ceil().astype", "numpy.ceil"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ",", "block_size", "=", "32", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "block_size", "=", "block_size", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "nums_stages", "=", "nums_stages", "\n", "self", ".", "stage_model", "=", "MPRBlock", "(", "\n", "in_c", "=", "in_c", ",", "out_c", "=", "in_c", ",", "n_feat", "=", "n_feat", ",", "scale_unetfeats", "=", "scale_unetfeats", ",", "kernel_size", "=", "kernel_size", ",", "\n", "reduction", "=", "reduction", ",", "bias", "=", "bias", "\n", ")", "\n", "self", ".", "shallow_feat_final", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage1_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "False", ")", "\n", "self", ".", "stage1_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam12", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "r0", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "self", ".", "r_final", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat_final", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "tail", "=", "conv", "(", "n_feat", "+", "scale_orsnetfeats", ",", "out_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.DGUNet.forward": [[385, 440], ["torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "blocks.view.view.view", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "DGUNet_deblock.DGUNet.shallow_feat1", "DGUNet_deblock.DGUNet.stage1_encoder", "DGUNet_deblock.DGUNet.stage1_decoder", "DGUNet_deblock.DGUNet.sam12", "output_.append", "range", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "x_k_1.view.view.view", "torch.fold().contiguous.view().permute().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "DGUNet_deblock.DGUNet.shallow_feat_final", "DGUNet_deblock.DGUNet.concat_final", "output_.append", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "DGUNet_deblock.DGUNet.stage_model", "output_.append", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_deblock.DGUNet.tail", "torch.unfold().permute", "torch.unfold().permute", "torch.unfold().permute", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute", "torch.fold", "torch.fold", "torch.fold", "torch.unfold().permute", "torch.unfold().permute", "torch.unfold().permute", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute", "torch.fold", "torch.fold", "torch.fold", "torch.unfold", "torch.unfold", "torch.unfold", "torch.fold().contiguous.view", "torch.unfold", "torch.unfold", "torch.unfold", "torch.fold().contiguous.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "img", ")", ":", "\n", "        ", "output_", "=", "[", "]", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 1---------------------", "\n", "##-------------------------------------------", "\n", "b", ",", "c", ",", "w", ",", "h", "=", "img", ".", "shape", "\n", "blocks", "=", "F", ".", "unfold", "(", "img", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "# (b,l,cwh)", "\n", "l", "=", "blocks", ".", "shape", "[", "1", "]", "\n", "blocks", "=", "blocks", ".", "view", "(", "b", "*", "l", ",", "-", "1", ")", "\n", "PhiTPhi", "=", "torch", ".", "mm", "(", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ",", "self", ".", "Phi", ")", "# torch.mm(Phix, Phi)", "\n", "Phix", "=", "torch", ".", "mm", "(", "blocks", ",", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ")", "# compression result", "\n", "PhiTb", "=", "torch", ".", "mm", "(", "Phix", ",", "self", ".", "Phi", ")", "#.view(b,l,-1).permute(0, 2, 1).contiguous()", "\n", "\n", "# compute r_0", "\n", "x_0", "=", "PhiTb", "#.view(b,-1)", "\n", "x", "=", "x_0", "-", "self", ".", "r0", "*", "torch", ".", "mm", "(", "x_0", ",", "PhiTPhi", ")", "\n", "r_0", "=", "x", "+", "self", ".", "r0", "*", "PhiTb", "\n", "r_0", "=", "r_0", ".", "view", "(", "b", ",", "l", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "#view(b,l,w,h)", "\n", "r_0", "=", "F", ".", "fold", "(", "r_0", ",", "output_size", "=", "(", "w", ",", "h", ")", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "contiguous", "(", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat1", "(", "r_0", ")", "\n", "## Process features of all 4 patches with Encoder of Stage 1", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage1_encoder", "(", "x", ")", "\n", "## Pass features through Decoder of Stage 1", "\n", "f_decoder", "=", "self", ".", "stage1_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply Supervised Attention Module (SAM)", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam12", "(", "f_decoder", "[", "-", "1", "]", ",", "r_0", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 2_k-1---------------------", "\n", "##-------------------------------------------", "\n", "for", "_", "in", "range", "(", "self", ".", "nums_stages", ")", ":", "\n", "            ", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "=", "self", ".", "stage_model", "(", "stage_img", ",", "img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "##-------------------------------------------", "\n", "##-------------- Stage k---------------------", "\n", "##-------------------------------------------", "\n", "# compute r_k", "\n", "", "x_k_1", "=", "F", ".", "unfold", "(", "stage_img", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "# (b,l,cwh)", "\n", "x_k_1", "=", "x_k_1", ".", "view", "(", "b", "*", "l", ",", "-", "1", ")", "\n", "x", "=", "x_k_1", "-", "self", ".", "r_final", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r_final", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "l", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "#view(b,l,w,h)", "\n", "r_k", "=", "F", ".", "fold", "(", "r_k", ",", "output_size", "=", "(", "w", ",", "h", ")", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "contiguous", "(", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat_final", "(", "r_k", ")", "\n", "## Concatenate SAM features", "\n", "x_cat", "=", "self", ".", "concat_final", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "stage_img", "=", "self", ".", "tail", "(", "x_cat", ")", "+", "r_k", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "return", "output_", "[", ":", ":", "-", "1", "]", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.conv": [[9, 13], ["torch.Conv2d"], "function", ["None"], ["def", "conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "bias", "=", "False", ",", "stride", "=", "1", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.conv_down": [[14, 17], ["torch.Conv2d"], "function", ["None"], ["", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n", "    ", "layer", "=", "nn", ".", "Conv2d", "(", "in_chn", ",", "out_chn", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "bias", ")", "\n", "return", "layer", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_deblock.default_conv": [[274, 278], ["torch.Conv2d"], "function", ["None"], ["", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus.RandomDataset.__init__": [[157, 160], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data", ",", "length", ")", ":", "\n", "        ", "self", ".", "data", "=", "data", "\n", "self", ".", "len", "=", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus.RandomDataset.__getitem__": [[161, 163], ["torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "return", "torch", ".", "Tensor", "(", "self", ".", "data", "[", "index", ",", ":", "]", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus.RandomDataset.__len__": [[164, 166], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "len", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus.col2im_CS_py": [[95, 105], ["numpy.zeros", "range", "range", "X_col[].reshape"], "function", ["None"], ["def", "col2im_CS_py", "(", "X_col", ",", "row", ",", "col", ",", "row_new", ",", "col_new", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "patch_size", "\n", "X0_rec", "=", "np", ".", "zeros", "(", "[", "row_new", ",", "col_new", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "X0_rec", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", "=", "X_col", "[", ":", ",", "count", "]", ".", "reshape", "(", "[", "block_size", ",", "block_size", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "X_rec", "=", "X0_rec", "[", ":", "row", ",", ":", "col", "]", "\n", "return", "X_rec", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus.psnr": [[107, 115], ["img1.astype", "img2.astype", "numpy.mean", "math.log10", "math.sqrt"], "function", ["None"], ["", "def", "psnr", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "img1", ".", "astype", "(", "np", ".", "float32", ")", "\n", "img2", ".", "astype", "(", "np", ".", "float32", ")", "\n", "mse", "=", "np", ".", "mean", "(", "(", "img1", "-", "img2", ")", "**", "2", ")", "\n", "if", "mse", "==", "0", ":", "\n", "        ", "return", "100", "\n", "", "PIXEL_MAX", "=", "255.0", "\n", "return", "20", "*", "math", ".", "log10", "(", "PIXEL_MAX", "/", "math", ".", "sqrt", "(", "mse", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus.imread_CS_py": [[117, 127], ["numpy.concatenate", "numpy.concatenate", "numpy.mod", "numpy.mod", "numpy.zeros", "numpy.zeros"], "function", ["None"], ["", "def", "imread_CS_py", "(", "Iorg", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "patch_size", "\n", "[", "row", ",", "col", "]", "=", "Iorg", ".", "shape", "\n", "row_pad", "=", "block_size", "-", "np", ".", "mod", "(", "row", ",", "block_size", ")", "\n", "col_pad", "=", "block_size", "-", "np", ".", "mod", "(", "col", ",", "block_size", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Iorg", ",", "np", ".", "zeros", "(", "[", "row", ",", "col_pad", "]", ")", ")", ",", "axis", "=", "1", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Ipad", ",", "np", ".", "zeros", "(", "[", "row_pad", ",", "col", "+", "col_pad", "]", ")", ")", ",", "axis", "=", "0", ")", "\n", "[", "row_new", ",", "col_new", "]", "=", "Ipad", ".", "shape", "\n", "\n", "return", "[", "Iorg", ",", "row", ",", "col", ",", "Ipad", ",", "row_new", ",", "col_new", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus.img2col_py": [[129, 141], ["int", "numpy.zeros", "range", "range", "Ipad[].reshape"], "function", ["None"], ["", "def", "img2col_py", "(", "Ipad", ",", "block_size", ")", ":", "\n", "    ", "[", "row", ",", "col", "]", "=", "Ipad", ".", "shape", "\n", "row_block", "=", "row", "/", "block_size", "\n", "col_block", "=", "col", "/", "block_size", "\n", "block_num", "=", "int", "(", "row_block", "*", "col_block", ")", "\n", "img_col", "=", "np", ".", "zeros", "(", "[", "block_size", "**", "2", ",", "block_num", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "img_col", "[", ":", ",", "count", "]", "=", "Ipad", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", ".", "reshape", "(", "[", "-", "1", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "return", "img_col", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.CALayer.__init__": [[22, 32], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n", "self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.CALayer.forward": [[34, 38], ["DGUNet_plus.CALayer.avg_pool", "DGUNet_plus.CALayer.conv_du"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.CAB.__init__": [[43, 52], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet_plus.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.CAB.forward": [[53, 58], ["DGUNet_plus.CAB.body", "DGUNet_plus.CAB.CA"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "=", "self", ".", "CA", "(", "res", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.SAM.__init__": [[63, 68], ["torch.Module.__init__", "DGUNet_plus.conv", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.SAM.forward": [[69, 76], ["DGUNet_plus.SAM.conv1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet_plus.SAM.conv2", "DGUNet_plus.SAM.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n", "x2", "=", "torch", ".", "sigmoid", "(", "self", ".", "conv3", "(", "img", ")", ")", "\n", "x1", "=", "x1", "*", "x2", "\n", "x1", "=", "x1", "+", "x", "\n", "return", "x1", ",", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.UNetConvBlock.__init__": [[78, 99], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet_plus.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_1", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_2", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "csff_dec", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "if", "use_HIN", ":", "\n", "            ", "self", ".", "norm", "=", "nn", ".", "InstanceNorm2d", "(", "out_size", "//", "2", ",", "affine", "=", "True", ")", "\n", "", "self", ".", "use_HIN", "=", "use_HIN", "\n", "\n", "if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.UNetConvBlock.forward": [[100, 119], ["DGUNet_plus.UNetConvBlock.conv_1", "DGUNet_plus.UNetConvBlock.relu_1", "DGUNet_plus.UNetConvBlock.relu_2", "DGUNet_plus.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetConvBlock.conv_2", "DGUNet_plus.UNetConvBlock.downsample", "DGUNet_plus.UNetConvBlock.csff_dec", "DGUNet_plus.UNetConvBlock.norm", "DGUNet_plus.UNetConvBlock.csff_enc"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n", "\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n", "", "out", "=", "self", ".", "relu_1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_2", "(", "self", ".", "conv_2", "(", "out", ")", ")", "\n", "\n", "out", "+=", "self", ".", "identity", "(", "x", ")", "\n", "if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n", "", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n", "return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.UNetUpBlock.__init__": [[122, 126], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.UNetUpBlock.forward": [[127, 132], ["DGUNet_plus.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetUpBlock.conv_block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.Encoder.__init__": [[137, 145], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.UNetConvBlock", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.Encoder.forward": [[146, 163], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "return", "res", ",", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.Decoder.__init__": [[166, 174], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Decoder.body.append", "DGUNet_plus.Decoder.skip_conv.append", "DGUNet_plus.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.Decoder.forward": [[175, 182], ["enumerate", "up", "res.append"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.DownSample.__init__": [[187, 191], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.DownSample.forward": [[192, 195], ["DGUNet_plus.DownSample.down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.UpSample.__init__": [[198, 202], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.UpSample.forward": [[203, 206], ["DGUNet_plus.UpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.SkipUpSample.__init__": [[209, 213], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "SkipUpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.SkipUpSample.forward": [[214, 218], ["DGUNet_plus.SkipUpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.ORB.__init__": [[223, 229], ["torch.Module.__init__", "modules_body.append", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.CAB", "DGUNet_plus.conv", "range"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.ORB.forward": [[230, 234], ["DGUNet_plus.ORB.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.ORSNet.__init__": [[238, 261], ["torch.Module.__init__", "DGUNet_plus.ORB", "DGUNet_plus.ORB", "DGUNet_plus.ORB", "DGUNet_plus.UpSample", "DGUNet_plus.UpSample", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "DGUNet_plus.UpSample", "DGUNet_plus.UpSample", "DGUNet_plus.UpSample", "DGUNet_plus.UpSample"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORSNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "orb1", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb2", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb3", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "\n", "self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n", "self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n", "self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n", "\n", "\n", "self", ".", "conv_enc1", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc2", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.ORSNet.forward": [[262, 273], ["DGUNet_plus.ORSNet.orb1", "DGUNet_plus.ORSNet.orb2", "DGUNet_plus.ORSNet.orb3", "DGUNet_plus.ORSNet.conv_dec1", "DGUNet_plus.ORSNet.conv_dec2", "DGUNet_plus.ORSNet.conv_dec3", "DGUNet_plus.ORSNet.conv_enc1", "DGUNet_plus.ORSNet.conv_enc2", "DGUNet_plus.ORSNet.up_dec1", "DGUNet_plus.ORSNet.conv_enc3", "DGUNet_plus.ORSNet.up_dec2", "DGUNet_plus.ORSNet.up_enc1", "DGUNet_plus.ORSNet.up_enc2"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n", "        ", "x", "=", "self", ".", "orb1", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc1", "(", "encoder_outs", "[", "0", "]", ")", "+", "self", ".", "conv_dec1", "(", "decoder_outs", "[", "-", "1", "]", ")", "\n", "\n", "x", "=", "self", ".", "orb2", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc2", "(", "self", ".", "up_enc1", "(", "encoder_outs", "[", "1", "]", ")", ")", "+", "self", ".", "conv_dec2", "(", "self", ".", "up_dec1", "(", "decoder_outs", "[", "-", "2", "]", ")", ")", "\n", "\n", "x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.ResBlock.__init__": [[280, 298], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet_plus.conv", "DGUNet_plus.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n", "bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "act", ")", "\n", "\n", "", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "m", ")", "\n", "self", ".", "res_scale", "=", "res_scale", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.ResBlock.forward": [[299, 304], ["DGUNet_plus.ResBlock.body().mul", "DGUNet_plus.ResBlock.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.MPRBlock.__init__": [[307, 326], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.SAM", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_plus.conv", "DGUNet_plus.conv", "DGUNet_plus.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.MPRBlock.forward": [[326, 345], ["stage_img.view", "r_k.view.view.view", "DGUNet_plus.MPRBlock.shallow_feat", "DGUNet_plus.MPRBlock.concat", "DGUNet_plus.MPRBlock.stage_encoder", "DGUNet_plus.MPRBlock.stage_decoder", "DGUNet_plus.MPRBlock.sam", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.DGUNet.__init__": [[348, 377], ["torch.Module.__init__", "print", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.SAM", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_plus.conv", "DGUNet_plus.conv", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.DGUNet.body.append", "DGUNet_plus.conv", "DGUNet_plus.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "DGUNet_plus.MPRBlock", "numpy.ceil().astype", "numpy.ceil"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "nums_stages", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "MPRBlock", "(", "\n", "in_c", "=", "in_c", ",", "out_c", "=", "in_c", ",", "n_feat", "=", "n_feat", ",", "scale_unetfeats", "=", "scale_unetfeats", ",", "kernel_size", "=", "kernel_size", ",", "\n", "reduction", "=", "reduction", ",", "bias", "=", "bias", "\n", ")", ")", "\n", "", "self", ".", "shallow_feat_final", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage1_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "False", ")", "\n", "self", ".", "stage1_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam12", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "r0", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "self", ".", "r_final", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat_final", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "tail", "=", "conv", "(", "n_feat", "+", "scale_orsnetfeats", ",", "out_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.DGUNet.forward": [[378, 426], ["torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm.view", "torch.mm.view", "torch.mm.view", "r_0.view.view.view", "DGUNet_plus.DGUNet.shallow_feat1", "DGUNet_plus.DGUNet.stage1_encoder", "DGUNet_plus.DGUNet.stage1_decoder", "DGUNet_plus.DGUNet.sam12", "output_.append", "stage_img.view", "r_k.view.view.view", "DGUNet_plus.DGUNet.shallow_feat_final", "DGUNet_plus.DGUNet.concat_final", "output_.append", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "img.view", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "stage_model", "output_.append", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.DGUNet.tail", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "img", ")", ":", "\n", "        ", "output_", "=", "[", "]", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 1---------------------", "\n", "##-------------------------------------------", "\n", "b", ",", "c", ",", "w", ",", "h", "=", "img", ".", "shape", "\n", "PhiTPhi", "=", "torch", ".", "mm", "(", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ",", "self", ".", "Phi", ")", "# torch.mm(Phix, Phi)", "\n", "Phix", "=", "torch", ".", "mm", "(", "img", ".", "view", "(", "b", ",", "-", "1", ")", ",", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ")", "# compression result", "\n", "PhiTb", "=", "torch", ".", "mm", "(", "Phix", ",", "self", ".", "Phi", ")", "\n", "# compute r_0", "\n", "x_0", "=", "PhiTb", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_0", "-", "self", ".", "r0", "*", "torch", ".", "mm", "(", "x_0", ",", "PhiTPhi", ")", "\n", "r_0", "=", "x", "+", "self", ".", "r0", "*", "PhiTb", "\n", "r_0", "=", "r_0", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat1", "(", "r_0", ")", "\n", "## Process features of all 4 patches with Encoder of Stage 1", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage1_encoder", "(", "x", ")", "\n", "## Pass features through Decoder of Stage 1", "\n", "f_decoder", "=", "self", ".", "stage1_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply Supervised Attention Module (SAM)", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam12", "(", "f_decoder", "[", "-", "1", "]", ",", "r_0", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 2_k-1---------------------", "\n", "##-------------------------------------------", "\n", "for", "stage_model", "in", "self", ".", "body", ":", "\n", "            ", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "=", "stage_model", "(", "stage_img", ",", "img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "##-------------------------------------------", "\n", "##-------------- Stage k---------------------", "\n", "##-------------------------------------------", "\n", "# compute r_k", "\n", "", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_k_1", "-", "self", ".", "r_final", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r_final", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat_final", "(", "r_k", ")", "\n", "## Concatenate SAM features", "\n", "x_cat", "=", "self", ".", "concat_final", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "stage_img", "=", "self", ".", "tail", "(", "x_cat", ")", "+", "r_k", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "return", "output_", "[", ":", ":", "-", "1", "]", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.conv": [[10, 14], ["torch.Conv2d"], "function", ["None"], ["def", "conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "bias", "=", "False", ",", "stride", "=", "1", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.conv_down": [[15, 18], ["torch.Conv2d"], "function", ["None"], ["", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n", "    ", "layer", "=", "nn", ".", "Conv2d", "(", "in_chn", ",", "out_chn", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "bias", ")", "\n", "return", "layer", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus.default_conv": [[274, 278], ["torch.Conv2d"], "function", ["None"], ["", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset.__init__": [[22, 33], ["torch.utils.data.Dataset.__init__", "os.path.join", "os.path.join", "glob.glob", "list", "csdata_fast.SlowDataset.prepare_cache", "os.path.exists", "os.makedirs"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.prepare_cache"], ["    ", "def", "__init__", "(", "self", ",", "args", ",", "train", "=", "True", ")", ":", "# __init__\u662f\u521d\u59cb\u5316\u8be5\u7c7b\u7684\u4e00\u4e9b\u57fa\u7840\u53c2\u6570", "\n", "        ", "super", "(", "SlowDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "args", "=", "args", "\n", "self", ".", "train", "=", "train", "\n", "self", ".", "image_folder", "=", "os", ".", "path", ".", "join", "(", "'.'", ",", "args", ".", "data_dir", ")", "\n", "self", ".", "bin_image_folder", "=", "os", ".", "path", ".", "join", "(", "'.'", ",", "args", ".", "data_dir", "+", "'bin'", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "self", ".", "bin_image_folder", ")", ":", "os", ".", "makedirs", "(", "self", ".", "bin_image_folder", ",", "exist_ok", "=", "True", ")", "\n", "self", ".", "ext", "=", "'/*%s'", "%", "args", ".", "ext", "\n", "self", ".", "file_names", "=", "glob", ".", "glob", "(", "self", ".", "image_folder", "+", "self", ".", "ext", ")", "\n", "self", ".", "bin_file_names", "=", "list", "(", ")", "\n", "self", ".", "prepare_cache", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset.prepare_cache": [[34, 42], ["fname.replace().replace", "csdata_fast.SlowDataset.bin_file_names.append", "os.path.exists", "imageio.imread", "numpy.save", "print", "fname.replace"], "methods", ["None"], ["", "def", "prepare_cache", "(", "self", ")", ":", "\n", "        ", "for", "fname", "in", "self", ".", "file_names", ":", "\n", "            ", "bin_fname", "=", "fname", ".", "replace", "(", "self", ".", "image_folder", ",", "self", ".", "bin_image_folder", ")", ".", "replace", "(", "self", ".", "args", ".", "ext", ",", "'.npy'", ")", "\n", "self", ".", "bin_file_names", ".", "append", "(", "bin_fname", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "bin_fname", ")", ":", "\n", "                ", "img", "=", "imageio", ".", "imread", "(", "fname", ")", "\n", "np", ".", "save", "(", "bin_fname", ",", "img", ")", "\n", "print", "(", "f'{bin_fname} prepared!'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset.__len__": [[43, 45], ["len"], "methods", ["None"], ["", "", "", "def", "__len__", "(", "self", ")", ":", "# \u8fd4\u56de\u6574\u4e2a\u6570\u636e\u96c6\u7684\u5927\u5c0f", "\n", "        ", "return", "len", "(", "self", ".", "file_names", ")", "*", "200", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset.get_ndarray": [[46, 49], ["functools.lru_cache", "numpy.load"], "methods", ["None"], ["", "@", "lru_cache", "(", "maxsize", "=", "400", ")", "\n", "def", "get_ndarray", "(", "self", ",", "fname", ")", ":", "\n", "        ", "return", "np", ".", "load", "(", "fname", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset.__getitem__": [[50, 80], ["torch.Tensor", "random.randint", "random.randint", "img.repeat.repeat.permute", "csdata_fast.SlowDataset.augment", "csdata_fast.SlowDataset.get_ndarray", "img.repeat.repeat.unsqueeze", "[].unsqueeze", "img.repeat.repeat.numpy", "img.repeat.repeat.repeat", "csdata_fast.rgb2ycbcr", "len"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.augment", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.get_ndarray", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.rgb2ycbcr"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "rgb_range", "=", "self", ".", "args", ".", "rgb_range", "\n", "n_channels", "=", "self", ".", "args", ".", "n_channels", "\n", "\n", "# img = torch.Tensor(np.load(self.file_names[index]))", "\n", "img", "=", "torch", ".", "Tensor", "(", "self", ".", "get_ndarray", "(", "self", ".", "bin_file_names", "[", "index", "%", "len", "(", "self", ".", "file_names", ")", "]", ")", ")", "\n", "\n", "if", "img", ".", "numpy", "(", ")", ".", "ndim", "==", "2", ":", "\n", "            ", "img", "=", "img", ".", "unsqueeze", "(", "2", ")", "\n", "\n", "", "c", "=", "img", ".", "shape", "[", "2", "]", "\n", "# input rgb image output y chanel", "\n", "if", "n_channels", "==", "1", "and", "c", "==", "3", ":", "\n", "            ", "img", "=", "rgb2ycbcr", "(", "img", ")", "[", ":", ",", ":", ",", "0", "]", ".", "unsqueeze", "(", "2", ")", "\n", "", "elif", "n_channels", "==", "3", "and", "c", "==", "1", ":", "\n", "            ", "img", "=", "img", ".", "repeat", "(", "1", ",", "1", ",", "3", ")", "\n", "\n", "", "w", ",", "h", ",", "_", "=", "img", ".", "shape", "\n", "th", "=", "tw", "=", "self", ".", "args", ".", "patch_size", "\n", "\n", "i", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "tw", ")", "\n", "j", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "th", ")", "\n", "img", "=", "img", "[", "i", ":", "i", "+", "tw", ",", "j", ":", "j", "+", "th", ",", ":", "]", "\n", "\n", "img_tensor", "=", "img", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "img_tensor", "=", "img_tensor", "*", "rgb_range", "/", "255.0", "\n", "\n", "img_tensor", "=", "self", ".", "augment", "(", "img_tensor", ")", "\n", "\n", "return", "img_tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset.augment": [[82, 96], ["img.permute.permute.flip", "img.permute.permute.flip", "img.permute.permute.permute", "random.random", "random.random", "random.random"], "methods", ["None"], ["", "def", "augment", "(", "self", ",", "img", ",", "hflip", "=", "True", ",", "rot", "=", "True", ")", ":", "\n", "\n", "        ", "hflip", "=", "hflip", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "vflip", "=", "rot", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "rot90", "=", "rot", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "\n", "if", "hflip", ":", "\n", "            ", "img", "=", "img", ".", "flip", "(", "[", "1", "]", ")", "\n", "", "if", "vflip", ":", "\n", "            ", "img", "=", "img", ".", "flip", "(", "[", "0", "]", ")", "\n", "", "if", "rot90", ":", "\n", "            ", "img", "=", "img", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "\n", "", "return", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset2.__init__": [[98, 109], ["torch.utils.data.Dataset.__init__", "os.path.join", "os.path.join", "glob.glob", "list", "csdata_fast.SlowDataset2.prepare_cache", "os.path.exists", "os.makedirs"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.prepare_cache"], ["    ", "def", "__init__", "(", "self", ",", "args", ",", "train", "=", "True", ")", ":", "# __init__\u662f\u521d\u59cb\u5316\u8be5\u7c7b\u7684\u4e00\u4e9b\u57fa\u7840\u53c2\u6570", "\n", "        ", "super", "(", "SlowDataset2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "args", "=", "args", "\n", "self", ".", "train", "=", "train", "\n", "self", ".", "image_folder", "=", "os", ".", "path", ".", "join", "(", "'.'", ",", "args", ".", "data_dir", ")", "\n", "self", ".", "bin_image_folder", "=", "os", ".", "path", ".", "join", "(", "'.'", ",", "args", ".", "data_dir", "+", "'bin'", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "self", ".", "bin_image_folder", ")", ":", "os", ".", "makedirs", "(", "self", ".", "bin_image_folder", ",", "exist_ok", "=", "True", ")", "\n", "self", ".", "ext", "=", "'/*%s'", "%", "args", ".", "ext", "\n", "self", ".", "file_names", "=", "glob", ".", "glob", "(", "self", ".", "image_folder", "+", "self", ".", "ext", ")", "\n", "self", ".", "bin_file_names", "=", "list", "(", ")", "\n", "self", ".", "prepare_cache", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset2.prepare_cache": [[110, 118], ["fname.replace().replace", "csdata_fast.SlowDataset2.bin_file_names.append", "os.path.exists", "imageio.imread", "numpy.save", "print", "fname.replace"], "methods", ["None"], ["", "def", "prepare_cache", "(", "self", ")", ":", "\n", "        ", "for", "fname", "in", "self", ".", "file_names", ":", "\n", "            ", "bin_fname", "=", "fname", ".", "replace", "(", "self", ".", "image_folder", ",", "self", ".", "bin_image_folder", ")", ".", "replace", "(", "self", ".", "args", ".", "ext", ",", "'.npy'", ")", "\n", "self", ".", "bin_file_names", ".", "append", "(", "bin_fname", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "bin_fname", ")", ":", "\n", "                ", "img", "=", "imageio", ".", "imread", "(", "fname", ")", "\n", "np", ".", "save", "(", "bin_fname", ",", "img", ")", "\n", "print", "(", "f'{bin_fname} prepared!'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset2.__len__": [[119, 121], ["len"], "methods", ["None"], ["", "", "", "def", "__len__", "(", "self", ")", ":", "# \u8fd4\u56de\u6574\u4e2a\u6570\u636e\u96c6\u7684\u5927\u5c0f", "\n", "        ", "return", "len", "(", "self", ".", "file_names", ")", "*", "200", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset2.get_ndarray": [[122, 125], ["functools.lru_cache", "numpy.load"], "methods", ["None"], ["", "@", "lru_cache", "(", "maxsize", "=", "400", ")", "\n", "def", "get_ndarray", "(", "self", ",", "fname", ")", ":", "\n", "        ", "return", "np", ".", "load", "(", "fname", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset2.__getitem__": [[126, 156], ["torch.Tensor", "random.randint", "random.randint", "img.repeat.repeat.permute", "csdata_fast.SlowDataset2.augment", "csdata_fast.SlowDataset2.get_ndarray", "img.repeat.repeat.unsqueeze", "[].unsqueeze", "img.repeat.repeat.numpy", "img.repeat.repeat.repeat", "csdata_fast.rgb2ycbcr", "len"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.augment", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.get_ndarray", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.rgb2ycbcr"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "rgb_range", "=", "self", ".", "args", ".", "rgb_range", "\n", "n_channels", "=", "self", ".", "args", ".", "n_channels", "\n", "\n", "# img = torch.Tensor(np.load(self.file_names[index]))", "\n", "img", "=", "torch", ".", "Tensor", "(", "self", ".", "get_ndarray", "(", "self", ".", "bin_file_names", "[", "index", "%", "len", "(", "self", ".", "file_names", ")", "]", ")", ")", "\n", "\n", "if", "img", ".", "numpy", "(", ")", ".", "ndim", "==", "2", ":", "\n", "            ", "img", "=", "img", ".", "unsqueeze", "(", "2", ")", "\n", "\n", "", "c", "=", "img", ".", "shape", "[", "2", "]", "\n", "# input rgb image output y chanel", "\n", "if", "n_channels", "==", "1", "and", "c", "==", "3", ":", "\n", "            ", "img", "=", "rgb2ycbcr", "(", "img", ")", "[", ":", ",", ":", ",", "0", "]", ".", "unsqueeze", "(", "2", ")", "\n", "", "elif", "n_channels", "==", "3", "and", "c", "==", "1", ":", "\n", "            ", "img", "=", "img", ".", "repeat", "(", "1", ",", "1", ",", "3", ")", "\n", "\n", "", "w", ",", "h", ",", "_", "=", "img", ".", "shape", "\n", "th", "=", "tw", "=", "self", ".", "args", ".", "patch_size", "\n", "\n", "i", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "tw", ")", "\n", "j", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "th", ")", "\n", "img", "=", "img", "[", "i", ":", "i", "+", "tw", ",", "j", ":", "j", "+", "th", ",", ":", "]", "\n", "\n", "img_tensor", "=", "img", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "img_tensor", "=", "img_tensor", "*", "rgb_range", "/", "255.0", "\n", "\n", "img_tensor", "=", "self", ".", "augment", "(", "img_tensor", ")", "\n", "\n", "return", "img_tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.SlowDataset2.augment": [[158, 172], ["img.permute.permute.flip", "img.permute.permute.flip", "img.permute.permute.permute", "random.random", "random.random", "random.random"], "methods", ["None"], ["", "def", "augment", "(", "self", ",", "img", ",", "hflip", "=", "True", ",", "rot", "=", "True", ")", ":", "\n", "\n", "        ", "hflip", "=", "hflip", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "vflip", "=", "rot", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "rot90", "=", "rot", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "\n", "if", "hflip", ":", "\n", "            ", "img", "=", "img", ".", "flip", "(", "[", "1", "]", ")", "\n", "", "if", "vflip", ":", "\n", "            ", "img", "=", "img", ".", "flip", "(", "[", "0", "]", ")", "\n", "", "if", "rot90", ":", "\n", "            ", "img", "=", "img", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "\n", "", "return", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast.rgb2ycbcr": [[13, 19], ["ycbcr_from_rgb.transpose", "rgb.float"], "function", ["None"], ["def", "rgb2ycbcr", "(", "rgb", ")", ":", "\n", "    ", "arr", "=", "rgb", ".", "float", "(", ")", "/", "255.0", "@", "ycbcr_from_rgb", ".", "transpose", "(", "1", ",", "0", ")", "\n", "arr", "[", "...", ",", "0", "]", "+=", "16", "\n", "arr", "[", "...", ",", "1", "]", "+=", "128", "\n", "arr", "[", "...", ",", "2", "]", "+=", "128", "\n", "return", "arr", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.CALayer.__init__": [[22, 32], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n", "self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.CALayer.forward": [[34, 38], ["DGUNet.CALayer.avg_pool", "DGUNet.CALayer.conv_du"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.CAB.__init__": [[43, 52], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.CAB.forward": [[53, 58], ["DGUNet.CAB.body", "DGUNet.CAB.CA"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "=", "self", ".", "CA", "(", "res", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.SAM.__init__": [[63, 68], ["torch.Module.__init__", "DGUNet.conv", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.SAM.forward": [[69, 76], ["DGUNet.SAM.conv1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet.SAM.conv2", "DGUNet.SAM.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n", "x2", "=", "torch", ".", "sigmoid", "(", "self", ".", "conv3", "(", "img", ")", ")", "\n", "x1", "=", "x1", "*", "x2", "\n", "x1", "=", "x1", "+", "x", "\n", "return", "x1", ",", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.UNetConvBlock.__init__": [[78, 99], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_1", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_2", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "csff_dec", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "if", "use_HIN", ":", "\n", "            ", "self", ".", "norm", "=", "nn", ".", "InstanceNorm2d", "(", "out_size", "//", "2", ",", "affine", "=", "True", ")", "\n", "", "self", ".", "use_HIN", "=", "use_HIN", "\n", "\n", "if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.UNetConvBlock.forward": [[100, 119], ["DGUNet.UNetConvBlock.conv_1", "DGUNet.UNetConvBlock.relu_1", "DGUNet.UNetConvBlock.relu_2", "DGUNet.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetConvBlock.conv_2", "DGUNet.UNetConvBlock.downsample", "DGUNet.UNetConvBlock.csff_dec", "DGUNet.UNetConvBlock.norm", "DGUNet.UNetConvBlock.csff_enc"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n", "\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n", "", "out", "=", "self", ".", "relu_1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_2", "(", "self", ".", "conv_2", "(", "out", ")", ")", "\n", "\n", "out", "+=", "self", ".", "identity", "(", "x", ")", "\n", "if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n", "", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n", "return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.UNetUpBlock.__init__": [[122, 126], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.UNetUpBlock.forward": [[127, 132], ["DGUNet.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetUpBlock.conv_block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.Encoder.__init__": [[137, 145], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Encoder.body.append", "DGUNet.Encoder.body.append", "DGUNet.UNetConvBlock", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.Encoder.forward": [[146, 163], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "return", "res", ",", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.Decoder.__init__": [[166, 174], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Decoder.body.append", "DGUNet.Decoder.skip_conv.append", "DGUNet.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.Decoder.forward": [[175, 182], ["enumerate", "up", "res.append"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.DownSample.__init__": [[187, 191], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.DownSample.forward": [[192, 195], ["DGUNet.DownSample.down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.UpSample.__init__": [[198, 202], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.UpSample.forward": [[203, 206], ["DGUNet.UpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.SkipUpSample.__init__": [[209, 213], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "SkipUpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.SkipUpSample.forward": [[214, 218], ["DGUNet.SkipUpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.ORB.__init__": [[223, 229], ["torch.Module.__init__", "modules_body.append", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.CAB", "DGUNet.conv", "range"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.ORB.forward": [[230, 234], ["DGUNet.ORB.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.ORSNet.__init__": [[238, 261], ["torch.Module.__init__", "DGUNet.ORB", "DGUNet.ORB", "DGUNet.ORB", "DGUNet.UpSample", "DGUNet.UpSample", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "DGUNet.UpSample", "DGUNet.UpSample", "DGUNet.UpSample", "DGUNet.UpSample"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORSNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "orb1", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb2", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb3", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "\n", "self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n", "self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n", "self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n", "\n", "\n", "self", ".", "conv_enc1", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc2", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.ORSNet.forward": [[262, 273], ["DGUNet.ORSNet.orb1", "DGUNet.ORSNet.orb2", "DGUNet.ORSNet.orb3", "DGUNet.ORSNet.conv_dec1", "DGUNet.ORSNet.conv_dec2", "DGUNet.ORSNet.conv_dec3", "DGUNet.ORSNet.conv_enc1", "DGUNet.ORSNet.conv_enc2", "DGUNet.ORSNet.up_dec1", "DGUNet.ORSNet.conv_enc3", "DGUNet.ORSNet.up_dec2", "DGUNet.ORSNet.up_enc1", "DGUNet.ORSNet.up_enc2"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n", "        ", "x", "=", "self", ".", "orb1", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc1", "(", "encoder_outs", "[", "0", "]", ")", "+", "self", ".", "conv_dec1", "(", "decoder_outs", "[", "-", "1", "]", ")", "\n", "\n", "x", "=", "self", ".", "orb2", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc2", "(", "self", ".", "up_enc1", "(", "encoder_outs", "[", "1", "]", ")", ")", "+", "self", ".", "conv_dec2", "(", "self", ".", "up_dec1", "(", "decoder_outs", "[", "-", "2", "]", ")", ")", "\n", "\n", "x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.ResBlock.__init__": [[280, 298], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet.conv", "DGUNet.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n", "bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "act", ")", "\n", "\n", "", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "m", ")", "\n", "self", ".", "res_scale", "=", "res_scale", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.ResBlock.forward": [[299, 304], ["DGUNet.ResBlock.body().mul", "DGUNet.ResBlock.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.MPRBlock.__init__": [[307, 326], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "DGUNet.ResBlock", "DGUNet.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.MPRBlock.forward": [[326, 345], ["stage_img.view", "r_k.view.view.view", "DGUNet.MPRBlock.shallow_feat", "DGUNet.MPRBlock.concat", "DGUNet.MPRBlock.stage_encoder", "DGUNet.MPRBlock.stage_decoder", "DGUNet.MPRBlock.sam", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.DGUNet.__init__": [[348, 377], ["torch.Module.__init__", "print", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "DGUNet.MPRBlock", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.conv", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "DGUNet.conv", "DGUNet.CAB", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "numpy.ceil().astype", "numpy.ceil"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "nums_stages", "=", "nums_stages", "\n", "self", ".", "stage_model", "=", "MPRBlock", "(", "\n", "in_c", "=", "in_c", ",", "out_c", "=", "in_c", ",", "n_feat", "=", "n_feat", ",", "scale_unetfeats", "=", "scale_unetfeats", ",", "kernel_size", "=", "kernel_size", ",", "\n", "reduction", "=", "reduction", ",", "bias", "=", "bias", "\n", ")", "\n", "self", ".", "shallow_feat_final", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage1_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "False", ")", "\n", "self", ".", "stage1_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam12", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "r0", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "self", ".", "r_final", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat_final", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "tail", "=", "conv", "(", "n_feat", "+", "scale_orsnetfeats", ",", "out_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.DGUNet.forward": [[378, 427], ["torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm.view", "torch.mm.view", "torch.mm.view", "r_0.view.view.view", "DGUNet.DGUNet.shallow_feat1", "DGUNet.DGUNet.stage1_encoder", "DGUNet.DGUNet.stage1_decoder", "DGUNet.DGUNet.sam12", "output_.append", "range", "stage_img.view", "r_k.view.view.view", "DGUNet.DGUNet.shallow_feat_final", "DGUNet.DGUNet.concat_final", "output_.append", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "img.view", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "DGUNet.DGUNet.stage_model", "output_.append", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.DGUNet.tail", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "img", ")", ":", "\n", "        ", "output_", "=", "[", "]", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 1---------------------", "\n", "##-------------------------------------------", "\n", "b", ",", "c", ",", "w", ",", "h", "=", "img", ".", "shape", "\n", "PhiTPhi", "=", "torch", ".", "mm", "(", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ",", "self", ".", "Phi", ")", "# torch.mm(Phix, Phi)", "\n", "Phix", "=", "torch", ".", "mm", "(", "img", ".", "view", "(", "b", ",", "-", "1", ")", ",", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ")", "# compression result", "\n", "PhiTb", "=", "torch", ".", "mm", "(", "Phix", ",", "self", ".", "Phi", ")", "\n", "# compute r_0", "\n", "x_0", "=", "PhiTb", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_0", "-", "self", ".", "r0", "*", "torch", ".", "mm", "(", "x_0", ",", "PhiTPhi", ")", "\n", "r_0", "=", "x", "+", "self", ".", "r0", "*", "PhiTb", "\n", "r_0", "=", "r_0", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat1", "(", "r_0", ")", "\n", "## Process features of all 4 patches with Encoder of Stage 1", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage1_encoder", "(", "x", ")", "\n", "## Pass features through Decoder of Stage 1", "\n", "f_decoder", "=", "self", ".", "stage1_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply Supervised Attention Module (SAM)", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam12", "(", "f_decoder", "[", "-", "1", "]", ",", "r_0", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 2_k-1---------------------", "\n", "##-------------------------------------------", "\n", "for", "_", "in", "range", "(", "self", ".", "nums_stages", ")", ":", "\n", "            ", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "=", "self", ".", "stage_model", "(", "stage_img", ",", "img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "##-------------------------------------------", "\n", "##-------------- Stage k---------------------", "\n", "##-------------------------------------------", "\n", "# compute r_k", "\n", "", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_k_1", "-", "self", ".", "r_final", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r_final", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat_final", "(", "r_k", ")", "\n", "## Concatenate SAM features", "\n", "x_cat", "=", "self", ".", "concat_final", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "stage_img", "=", "self", ".", "tail", "(", "x_cat", ")", "+", "r_k", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "return", "output_", "[", ":", ":", "-", "1", "]", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.conv": [[10, 14], ["torch.Conv2d"], "function", ["None"], ["def", "conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "bias", "=", "False", ",", "stride", "=", "1", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.conv_down": [[15, 18], ["torch.Conv2d"], "function", ["None"], ["", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n", "    ", "layer", "=", "nn", ".", "Conv2d", "(", "in_chn", ",", "out_chn", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "bias", ")", "\n", "return", "layer", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet.default_conv": [[274, 278], ["torch.Conv2d"], "function", ["None"], ["", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus_deblock.RandomDataset.__init__": [[162, 165], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data", ",", "length", ")", ":", "\n", "        ", "self", ".", "data", "=", "data", "\n", "self", ".", "len", "=", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus_deblock.RandomDataset.__getitem__": [[166, 168], ["torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "return", "torch", ".", "Tensor", "(", "self", ".", "data", "[", "index", ",", ":", "]", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus_deblock.RandomDataset.__len__": [[169, 171], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "len", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus_deblock.col2im_CS_py": [[100, 110], ["numpy.zeros", "range", "range", "X_col[].reshape"], "function", ["None"], ["def", "col2im_CS_py", "(", "X_col", ",", "row", ",", "col", ",", "row_new", ",", "col_new", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "X0_rec", "=", "np", ".", "zeros", "(", "[", "row_new", ",", "col_new", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "X0_rec", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", "=", "X_col", "[", ":", ",", "count", "]", ".", "reshape", "(", "[", "block_size", ",", "block_size", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "X_rec", "=", "X0_rec", "[", ":", "row", ",", ":", "col", "]", "\n", "return", "X_rec", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus_deblock.psnr": [[112, 120], ["img1.astype", "img2.astype", "numpy.mean", "math.log10", "math.sqrt"], "function", ["None"], ["", "def", "psnr", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "img1", ".", "astype", "(", "np", ".", "float32", ")", "\n", "img2", ".", "astype", "(", "np", ".", "float32", ")", "\n", "mse", "=", "np", ".", "mean", "(", "(", "img1", "-", "img2", ")", "**", "2", ")", "\n", "if", "mse", "==", "0", ":", "\n", "        ", "return", "100", "\n", "", "PIXEL_MAX", "=", "255.0", "\n", "return", "20", "*", "math", ".", "log10", "(", "PIXEL_MAX", "/", "math", ".", "sqrt", "(", "mse", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus_deblock.imread_CS_py": [[122, 132], ["numpy.concatenate", "numpy.concatenate", "numpy.mod", "numpy.mod", "numpy.zeros", "numpy.zeros"], "function", ["None"], ["", "def", "imread_CS_py", "(", "Iorg", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "[", "row", ",", "col", "]", "=", "Iorg", ".", "shape", "\n", "row_pad", "=", "block_size", "-", "np", ".", "mod", "(", "row", ",", "block_size", ")", "\n", "col_pad", "=", "block_size", "-", "np", ".", "mod", "(", "col", ",", "block_size", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Iorg", ",", "np", ".", "zeros", "(", "[", "row", ",", "col_pad", "]", ")", ")", ",", "axis", "=", "1", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Ipad", ",", "np", ".", "zeros", "(", "[", "row_pad", ",", "col", "+", "col_pad", "]", ")", ")", ",", "axis", "=", "0", ")", "\n", "[", "row_new", ",", "col_new", "]", "=", "Ipad", ".", "shape", "\n", "\n", "return", "[", "Iorg", ",", "row", ",", "col", ",", "Ipad", ",", "row_new", ",", "col_new", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_plus_deblock.img2col_py": [[134, 146], ["int", "numpy.zeros", "range", "range", "Ipad[].reshape"], "function", ["None"], ["", "def", "img2col_py", "(", "Ipad", ",", "block_size", ")", ":", "\n", "    ", "[", "row", ",", "col", "]", "=", "Ipad", ".", "shape", "\n", "row_block", "=", "row", "/", "block_size", "\n", "col_block", "=", "col", "/", "block_size", "\n", "block_num", "=", "int", "(", "row_block", "*", "col_block", ")", "\n", "img_col", "=", "np", ".", "zeros", "(", "[", "block_size", "**", "2", ",", "block_num", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "img_col", "[", ":", ",", "count", "]", "=", "Ipad", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", ".", "reshape", "(", "[", "-", "1", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "return", "img_col", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train.RandomDataset.__init__": [[157, 160], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data", ",", "length", ")", ":", "\n", "        ", "self", ".", "data", "=", "data", "\n", "self", ".", "len", "=", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train.RandomDataset.__getitem__": [[161, 163], ["torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "return", "torch", ".", "Tensor", "(", "self", ".", "data", "[", "index", ",", ":", "]", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train.RandomDataset.__len__": [[164, 166], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "len", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train.col2im_CS_py": [[95, 105], ["numpy.zeros", "range", "range", "X_col[].reshape"], "function", ["None"], ["def", "col2im_CS_py", "(", "X_col", ",", "row", ",", "col", ",", "row_new", ",", "col_new", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "patch_size", "\n", "X0_rec", "=", "np", ".", "zeros", "(", "[", "row_new", ",", "col_new", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "X0_rec", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", "=", "X_col", "[", ":", ",", "count", "]", ".", "reshape", "(", "[", "block_size", ",", "block_size", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "X_rec", "=", "X0_rec", "[", ":", "row", ",", ":", "col", "]", "\n", "return", "X_rec", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train.psnr": [[107, 115], ["img1.astype", "img2.astype", "numpy.mean", "math.log10", "math.sqrt"], "function", ["None"], ["", "def", "psnr", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "img1", ".", "astype", "(", "np", ".", "float32", ")", "\n", "img2", ".", "astype", "(", "np", ".", "float32", ")", "\n", "mse", "=", "np", ".", "mean", "(", "(", "img1", "-", "img2", ")", "**", "2", ")", "\n", "if", "mse", "==", "0", ":", "\n", "        ", "return", "100", "\n", "", "PIXEL_MAX", "=", "255.0", "\n", "return", "20", "*", "math", ".", "log10", "(", "PIXEL_MAX", "/", "math", ".", "sqrt", "(", "mse", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train.imread_CS_py": [[117, 127], ["numpy.concatenate", "numpy.concatenate", "numpy.mod", "numpy.mod", "numpy.zeros", "numpy.zeros"], "function", ["None"], ["", "def", "imread_CS_py", "(", "Iorg", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "patch_size", "\n", "[", "row", ",", "col", "]", "=", "Iorg", ".", "shape", "\n", "row_pad", "=", "block_size", "-", "np", ".", "mod", "(", "row", ",", "block_size", ")", "\n", "col_pad", "=", "block_size", "-", "np", ".", "mod", "(", "col", ",", "block_size", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Iorg", ",", "np", ".", "zeros", "(", "[", "row", ",", "col_pad", "]", ")", ")", ",", "axis", "=", "1", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Ipad", ",", "np", ".", "zeros", "(", "[", "row_pad", ",", "col", "+", "col_pad", "]", ")", ")", ",", "axis", "=", "0", ")", "\n", "[", "row_new", ",", "col_new", "]", "=", "Ipad", ".", "shape", "\n", "\n", "return", "[", "Iorg", ",", "row", ",", "col", ",", "Ipad", ",", "row_new", ",", "col_new", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train.img2col_py": [[129, 141], ["int", "numpy.zeros", "range", "range", "Ipad[].reshape"], "function", ["None"], ["", "def", "img2col_py", "(", "Ipad", ",", "block_size", ")", ":", "\n", "    ", "[", "row", ",", "col", "]", "=", "Ipad", ".", "shape", "\n", "row_block", "=", "row", "/", "block_size", "\n", "col_block", "=", "col", "/", "block_size", "\n", "block_num", "=", "int", "(", "row_block", "*", "col_block", ")", "\n", "img_col", "=", "np", ".", "zeros", "(", "[", "block_size", "**", "2", ",", "block_num", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "img_col", "[", ":", ",", "count", "]", "=", "Ipad", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", ".", "reshape", "(", "[", "-", "1", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "return", "img_col", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.RandomDataset.__init__": [[169, 172], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data", ",", "length", ")", ":", "\n", "        ", "self", ".", "data", "=", "data", "\n", "self", ".", "len", "=", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.RandomDataset.__getitem__": [[173, 175], ["torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "return", "torch", ".", "Tensor", "(", "self", ".", "data", "[", "index", ",", ":", "]", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.RandomDataset.__len__": [[176, 178], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "len", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.col2im_CS_py": [[107, 117], ["numpy.zeros", "range", "range", "X_col[].reshape"], "function", ["None"], ["def", "col2im_CS_py", "(", "X_col", ",", "row", ",", "col", ",", "row_new", ",", "col_new", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "X0_rec", "=", "np", ".", "zeros", "(", "[", "row_new", ",", "col_new", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "X0_rec", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", "=", "X_col", "[", ":", ",", "count", "]", ".", "reshape", "(", "[", "block_size", ",", "block_size", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "X_rec", "=", "X0_rec", "[", ":", "row", ",", ":", "col", "]", "\n", "return", "X_rec", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.psnr": [[119, 127], ["img1.astype", "img2.astype", "numpy.mean", "math.log10", "math.sqrt"], "function", ["None"], ["", "def", "psnr", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "img1", ".", "astype", "(", "np", ".", "float32", ")", "\n", "img2", ".", "astype", "(", "np", ".", "float32", ")", "\n", "mse", "=", "np", ".", "mean", "(", "(", "img1", "-", "img2", ")", "**", "2", ")", "\n", "if", "mse", "==", "0", ":", "\n", "        ", "return", "100", "\n", "", "PIXEL_MAX", "=", "255.0", "\n", "return", "20", "*", "math", ".", "log10", "(", "PIXEL_MAX", "/", "math", ".", "sqrt", "(", "mse", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.imread_CS_py": [[129, 139], ["numpy.concatenate", "numpy.concatenate", "numpy.mod", "numpy.mod", "numpy.zeros", "numpy.zeros"], "function", ["None"], ["", "def", "imread_CS_py", "(", "Iorg", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "[", "row", ",", "col", "]", "=", "Iorg", ".", "shape", "\n", "row_pad", "=", "block_size", "-", "np", ".", "mod", "(", "row", ",", "block_size", ")", "\n", "col_pad", "=", "block_size", "-", "np", ".", "mod", "(", "col", ",", "block_size", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Iorg", ",", "np", ".", "zeros", "(", "[", "row", ",", "col_pad", "]", ")", ")", ",", "axis", "=", "1", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Ipad", ",", "np", ".", "zeros", "(", "[", "row_pad", ",", "col", "+", "col_pad", "]", ")", ")", ",", "axis", "=", "0", ")", "\n", "[", "row_new", ",", "col_new", "]", "=", "Ipad", ".", "shape", "\n", "\n", "return", "[", "Iorg", ",", "row", ",", "col", ",", "Ipad", ",", "row_new", ",", "col_new", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.img2col_py": [[141, 153], ["int", "numpy.zeros", "range", "range", "Ipad[].reshape"], "function", ["None"], ["", "def", "img2col_py", "(", "Ipad", ",", "block_size", ")", ":", "\n", "    ", "[", "row", ",", "col", "]", "=", "Ipad", ".", "shape", "\n", "row_block", "=", "row", "/", "block_size", "\n", "col_block", "=", "col", "/", "block_size", "\n", "block_num", "=", "int", "(", "row_block", "*", "col_block", ")", "\n", "img_col", "=", "np", ".", "zeros", "(", "[", "block_size", "**", "2", ",", "block_num", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "img_col", "[", ":", ",", "count", "]", "=", "Ipad", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", ".", "reshape", "(", "[", "-", "1", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "return", "img_col", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.augment_img_tensor": [[179, 194], ["img.size", "img.data.cpu().numpy", "test_plus.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["", "", "def", "augment_img_tensor", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "img_size", "=", "img", ".", "size", "(", ")", "\n", "img_np", "=", "img", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "1", ",", "2", ",", "0", ")", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "2", ",", "3", ",", "1", ",", "0", ")", ")", "\n", "", "img_np", "=", "augment_img", "(", "img_np", ",", "mode", "=", "mode", ")", "\n", "img_tensor", "=", "torch", ".", "from_numpy", "(", "np", ".", "ascontiguousarray", "(", "img_np", ")", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "3", ",", "2", ",", "0", ",", "1", ")", "\n", "\n", "", "return", "img_tensor", ".", "type_as", "(", "img", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.augment_img": [[196, 213], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["", "def", "augment_img", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "if", "mode", "==", "0", ":", "\n", "        ", "return", "img", "\n", "", "elif", "mode", "==", "1", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ")", ")", "\n", "", "elif", "mode", "==", "2", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "img", ")", "\n", "", "elif", "mode", "==", "3", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", "\n", "", "elif", "mode", "==", "4", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", ")", "\n", "", "elif", "mode", "==", "5", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ")", "\n", "", "elif", "mode", "==", "6", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", "\n", "", "elif", "mode", "==", "7", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test_plus.test_x8": [[214, 224], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test_plus.augment_img_tensor", "test_plus.augment_img_tensor", "test_plus.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["", "", "def", "test_x8", "(", "model", ",", "L", ")", ":", "\n", "    ", "E_list", "=", "[", "model", "(", "augment_img_tensor", "(", "L", ",", "mode", "=", "i", ")", ")", "[", "0", "]", "for", "i", "in", "range", "(", "8", ")", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "E_list", ")", ")", ":", "\n", "        ", "if", "i", "==", "3", "or", "i", "==", "5", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "8", "-", "i", ")", "\n", "", "else", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "i", ")", "\n", "", "", "output_cat", "=", "torch", ".", "stack", "(", "E_list", ",", "dim", "=", "0", ")", "\n", "E", "=", "output_cat", ".", "mean", "(", "dim", "=", "0", ",", "keepdim", "=", "False", ")", "\n", "return", "E", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.RandomDataset.__init__": [[169, 172], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data", ",", "length", ")", ":", "\n", "        ", "self", ".", "data", "=", "data", "\n", "self", ".", "len", "=", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.RandomDataset.__getitem__": [[173, 175], ["torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "return", "torch", ".", "Tensor", "(", "self", ".", "data", "[", "index", ",", ":", "]", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.RandomDataset.__len__": [[176, 178], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "len", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.col2im_CS_py": [[107, 117], ["numpy.zeros", "range", "range", "X_col[].reshape"], "function", ["None"], ["def", "col2im_CS_py", "(", "X_col", ",", "row", ",", "col", ",", "row_new", ",", "col_new", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "X0_rec", "=", "np", ".", "zeros", "(", "[", "row_new", ",", "col_new", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "X0_rec", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", "=", "X_col", "[", ":", ",", "count", "]", ".", "reshape", "(", "[", "block_size", ",", "block_size", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "X_rec", "=", "X0_rec", "[", ":", "row", ",", ":", "col", "]", "\n", "return", "X_rec", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.psnr": [[119, 127], ["img1.astype", "img2.astype", "numpy.mean", "math.log10", "math.sqrt"], "function", ["None"], ["", "def", "psnr", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "img1", ".", "astype", "(", "np", ".", "float32", ")", "\n", "img2", ".", "astype", "(", "np", ".", "float32", ")", "\n", "mse", "=", "np", ".", "mean", "(", "(", "img1", "-", "img2", ")", "**", "2", ")", "\n", "if", "mse", "==", "0", ":", "\n", "        ", "return", "100", "\n", "", "PIXEL_MAX", "=", "255.0", "\n", "return", "20", "*", "math", ".", "log10", "(", "PIXEL_MAX", "/", "math", ".", "sqrt", "(", "mse", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.imread_CS_py": [[129, 139], ["numpy.concatenate", "numpy.concatenate", "numpy.mod", "numpy.mod", "numpy.zeros", "numpy.zeros"], "function", ["None"], ["", "def", "imread_CS_py", "(", "Iorg", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "[", "row", ",", "col", "]", "=", "Iorg", ".", "shape", "\n", "row_pad", "=", "block_size", "-", "np", ".", "mod", "(", "row", ",", "block_size", ")", "\n", "col_pad", "=", "block_size", "-", "np", ".", "mod", "(", "col", ",", "block_size", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Iorg", ",", "np", ".", "zeros", "(", "[", "row", ",", "col_pad", "]", ")", ")", ",", "axis", "=", "1", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Ipad", ",", "np", ".", "zeros", "(", "[", "row_pad", ",", "col", "+", "col_pad", "]", ")", ")", ",", "axis", "=", "0", ")", "\n", "[", "row_new", ",", "col_new", "]", "=", "Ipad", ".", "shape", "\n", "\n", "return", "[", "Iorg", ",", "row", ",", "col", ",", "Ipad", ",", "row_new", ",", "col_new", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.img2col_py": [[141, 153], ["int", "numpy.zeros", "range", "range", "Ipad[].reshape"], "function", ["None"], ["", "def", "img2col_py", "(", "Ipad", ",", "block_size", ")", ":", "\n", "    ", "[", "row", ",", "col", "]", "=", "Ipad", ".", "shape", "\n", "row_block", "=", "row", "/", "block_size", "\n", "col_block", "=", "col", "/", "block_size", "\n", "block_num", "=", "int", "(", "row_block", "*", "col_block", ")", "\n", "img_col", "=", "np", ".", "zeros", "(", "[", "block_size", "**", "2", ",", "block_num", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "img_col", "[", ":", ",", "count", "]", "=", "Ipad", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", ".", "reshape", "(", "[", "-", "1", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "return", "img_col", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.augment_img_tensor": [[179, 194], ["img.size", "img.data.cpu().numpy", "test.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["", "", "def", "augment_img_tensor", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "img_size", "=", "img", ".", "size", "(", ")", "\n", "img_np", "=", "img", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "1", ",", "2", ",", "0", ")", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "2", ",", "3", ",", "1", ",", "0", ")", ")", "\n", "", "img_np", "=", "augment_img", "(", "img_np", ",", "mode", "=", "mode", ")", "\n", "img_tensor", "=", "torch", ".", "from_numpy", "(", "np", ".", "ascontiguousarray", "(", "img_np", ")", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "3", ",", "2", ",", "0", ",", "1", ")", "\n", "\n", "", "return", "img_tensor", ".", "type_as", "(", "img", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.augment_img": [[196, 213], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["", "def", "augment_img", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "if", "mode", "==", "0", ":", "\n", "        ", "return", "img", "\n", "", "elif", "mode", "==", "1", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ")", ")", "\n", "", "elif", "mode", "==", "2", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "img", ")", "\n", "", "elif", "mode", "==", "3", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", "\n", "", "elif", "mode", "==", "4", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", ")", "\n", "", "elif", "mode", "==", "5", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ")", "\n", "", "elif", "mode", "==", "6", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", "\n", "", "elif", "mode", "==", "7", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.test.test_x8": [[214, 224], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test.augment_img_tensor", "test.augment_img_tensor", "test.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["", "", "def", "test_x8", "(", "model", ",", "L", ")", ":", "\n", "    ", "E_list", "=", "[", "model", "(", "augment_img_tensor", "(", "L", ",", "mode", "=", "i", ")", ")", "[", "0", "]", "for", "i", "in", "range", "(", "8", ")", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "E_list", ")", ")", ":", "\n", "        ", "if", "i", "==", "3", "or", "i", "==", "5", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "8", "-", "i", ")", "\n", "", "else", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "i", ")", "\n", "", "", "output_cat", "=", "torch", ".", "stack", "(", "E_list", ",", "dim", "=", "0", ")", "\n", "E", "=", "output_cat", ".", "mean", "(", "dim", "=", "0", ",", "keepdim", "=", "False", ")", "\n", "return", "E", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.__init__": [[22, 33], ["torch.utils.data.Dataset.__init__", "os.path.join", "os.path.join", "glob.glob", "list", "csdata_fast2.SlowDataset.prepare_cache", "os.path.exists", "os.makedirs"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.prepare_cache"], ["    ", "def", "__init__", "(", "self", ",", "args", ",", "train", "=", "True", ")", ":", "# __init__\u662f\u521d\u59cb\u5316\u8be5\u7c7b\u7684\u4e00\u4e9b\u57fa\u7840\u53c2\u6570", "\n", "        ", "super", "(", "SlowDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "args", "=", "args", "\n", "self", ".", "train", "=", "train", "\n", "self", ".", "image_folder", "=", "os", ".", "path", ".", "join", "(", "'.'", ",", "args", ".", "data_dir", ")", "\n", "self", ".", "bin_image_folder", "=", "os", ".", "path", ".", "join", "(", "'.'", ",", "args", ".", "data_dir", "+", "'bin'", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "self", ".", "bin_image_folder", ")", ":", "os", ".", "makedirs", "(", "self", ".", "bin_image_folder", ",", "exist_ok", "=", "True", ")", "\n", "self", ".", "ext", "=", "'/*%s'", "%", "args", ".", "ext", "\n", "self", ".", "file_names", "=", "glob", ".", "glob", "(", "self", ".", "image_folder", "+", "self", ".", "ext", ")", "\n", "self", ".", "bin_file_names", "=", "list", "(", ")", "\n", "self", ".", "prepare_cache", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.prepare_cache": [[34, 42], ["fname.replace().replace", "csdata_fast2.SlowDataset.bin_file_names.append", "os.path.exists", "imageio.imread", "numpy.save", "print", "fname.replace"], "methods", ["None"], ["", "def", "prepare_cache", "(", "self", ")", ":", "\n", "        ", "for", "fname", "in", "self", ".", "file_names", ":", "\n", "            ", "bin_fname", "=", "fname", ".", "replace", "(", "self", ".", "image_folder", ",", "self", ".", "bin_image_folder", ")", ".", "replace", "(", "self", ".", "args", ".", "ext", ",", "'.npy'", ")", "\n", "self", ".", "bin_file_names", ".", "append", "(", "bin_fname", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "bin_fname", ")", ":", "\n", "                ", "img", "=", "imageio", ".", "imread", "(", "fname", ")", "\n", "np", ".", "save", "(", "bin_fname", ",", "img", ")", "\n", "print", "(", "f'{bin_fname} prepared!'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.__len__": [[43, 45], ["len"], "methods", ["None"], ["", "", "", "def", "__len__", "(", "self", ")", ":", "# \u8fd4\u56de\u6574\u4e2a\u6570\u636e\u96c6\u7684\u5927\u5c0f", "\n", "        ", "return", "len", "(", "self", ".", "file_names", ")", "*", "200", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.get_ndarray": [[46, 49], ["functools.lru_cache", "numpy.load"], "methods", ["None"], ["", "@", "lru_cache", "(", "maxsize", "=", "400", ")", "\n", "def", "get_ndarray", "(", "self", ",", "fname", ")", ":", "\n", "        ", "return", "np", ".", "load", "(", "fname", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.__getitem__": [[50, 80], ["torch.Tensor", "random.randint", "random.randint", "img.repeat.repeat.permute", "csdata_fast2.SlowDataset.augment", "csdata_fast2.SlowDataset.get_ndarray", "img.repeat.repeat.unsqueeze", "[].unsqueeze", "img.repeat.repeat.numpy", "img.repeat.repeat.repeat", "csdata_fast2.rgb2ycbcr", "len"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.augment", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.get_ndarray", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.rgb2ycbcr"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "rgb_range", "=", "self", ".", "args", ".", "rgb_range", "\n", "n_channels", "=", "self", ".", "args", ".", "n_channels", "\n", "\n", "# img = torch.Tensor(np.load(self.file_names[index]))", "\n", "img", "=", "torch", ".", "Tensor", "(", "self", ".", "get_ndarray", "(", "self", ".", "bin_file_names", "[", "index", "%", "len", "(", "self", ".", "file_names", ")", "]", ")", ")", "\n", "\n", "if", "img", ".", "numpy", "(", ")", ".", "ndim", "==", "2", ":", "\n", "            ", "img", "=", "img", ".", "unsqueeze", "(", "2", ")", "\n", "\n", "", "c", "=", "img", ".", "shape", "[", "2", "]", "\n", "# input rgb image output y chanel", "\n", "if", "n_channels", "==", "1", "and", "c", "==", "3", ":", "\n", "            ", "img", "=", "rgb2ycbcr", "(", "img", ")", "[", ":", ",", ":", ",", "0", "]", ".", "unsqueeze", "(", "2", ")", "\n", "", "elif", "n_channels", "==", "3", "and", "c", "==", "1", ":", "\n", "            ", "img", "=", "img", ".", "repeat", "(", "1", ",", "1", ",", "3", ")", "\n", "\n", "", "w", ",", "h", ",", "_", "=", "img", ".", "shape", "\n", "th", "=", "tw", "=", "self", ".", "args", ".", "im_size", "\n", "\n", "i", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "tw", ")", "\n", "j", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "th", ")", "\n", "img", "=", "img", "[", "i", ":", "i", "+", "tw", ",", "j", ":", "j", "+", "th", ",", ":", "]", "\n", "\n", "img_tensor", "=", "img", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "img_tensor", "=", "img_tensor", "*", "rgb_range", "/", "255.0", "\n", "\n", "img_tensor", "=", "self", ".", "augment", "(", "img_tensor", ")", "\n", "\n", "return", "img_tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.SlowDataset.augment": [[82, 96], ["img.permute.permute.flip", "img.permute.permute.flip", "img.permute.permute.permute", "random.random", "random.random", "random.random"], "methods", ["None"], ["", "def", "augment", "(", "self", ",", "img", ",", "hflip", "=", "True", ",", "rot", "=", "True", ")", ":", "\n", "\n", "        ", "hflip", "=", "hflip", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "vflip", "=", "rot", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "rot90", "=", "rot", "and", "random", ".", "random", "(", ")", "<", "0.5", "\n", "\n", "if", "hflip", ":", "\n", "            ", "img", "=", "img", ".", "flip", "(", "[", "1", "]", ")", "\n", "", "if", "vflip", ":", "\n", "            ", "img", "=", "img", ".", "flip", "(", "[", "0", "]", ")", "\n", "", "if", "rot90", ":", "\n", "            ", "img", "=", "img", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "\n", "", "return", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.csdata_fast2.rgb2ycbcr": [[13, 19], ["ycbcr_from_rgb.transpose", "rgb.float"], "function", ["None"], ["def", "rgb2ycbcr", "(", "rgb", ")", ":", "\n", "    ", "arr", "=", "rgb", ".", "float", "(", ")", "/", "255.0", "@", "ycbcr_from_rgb", ".", "transpose", "(", "1", ",", "0", ")", "\n", "arr", "[", "...", ",", "0", "]", "+=", "16", "\n", "arr", "[", "...", ",", "1", "]", "+=", "128", "\n", "arr", "[", "...", ",", "2", "]", "+=", "128", "\n", "return", "arr", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.CALayer.__init__": [[22, 32], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n", "self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.CALayer.forward": [[34, 38], ["DGUNet_plus_deblock.CALayer.avg_pool", "DGUNet_plus_deblock.CALayer.conv_du"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.CAB.__init__": [[43, 52], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet_plus_deblock.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.CAB.forward": [[53, 58], ["DGUNet_plus_deblock.CAB.body", "DGUNet_plus_deblock.CAB.CA"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "=", "self", ".", "CA", "(", "res", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.SAM.__init__": [[63, 68], ["torch.Module.__init__", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.SAM.forward": [[69, 76], ["DGUNet_plus_deblock.SAM.conv1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet_plus_deblock.SAM.conv2", "DGUNet_plus_deblock.SAM.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n", "x2", "=", "torch", ".", "sigmoid", "(", "self", ".", "conv3", "(", "img", ")", ")", "\n", "x1", "=", "x1", "*", "x2", "\n", "x1", "=", "x1", "+", "x", "\n", "return", "x1", ",", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.UNetConvBlock.__init__": [[78, 99], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet_plus_deblock.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_1", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_2", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "csff_dec", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "if", "use_HIN", ":", "\n", "            ", "self", ".", "norm", "=", "nn", ".", "InstanceNorm2d", "(", "out_size", "//", "2", ",", "affine", "=", "True", ")", "\n", "", "self", ".", "use_HIN", "=", "use_HIN", "\n", "\n", "if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.UNetConvBlock.forward": [[100, 119], ["DGUNet_plus_deblock.UNetConvBlock.conv_1", "DGUNet_plus_deblock.UNetConvBlock.relu_1", "DGUNet_plus_deblock.UNetConvBlock.relu_2", "DGUNet_plus_deblock.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus_deblock.UNetConvBlock.conv_2", "DGUNet_plus_deblock.UNetConvBlock.downsample", "DGUNet_plus_deblock.UNetConvBlock.csff_dec", "DGUNet_plus_deblock.UNetConvBlock.norm", "DGUNet_plus_deblock.UNetConvBlock.csff_enc"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n", "\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n", "", "out", "=", "self", ".", "relu_1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_2", "(", "self", ".", "conv_2", "(", "out", ")", ")", "\n", "\n", "out", "+=", "self", ".", "identity", "(", "x", ")", "\n", "if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n", "", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n", "return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.UNetUpBlock.__init__": [[122, 126], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet_plus_deblock.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.UNetUpBlock.forward": [[127, 133], ["DGUNet_plus_deblock.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus_deblock.UNetUpBlock.conv_block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "#         print('merge',x.shape,bridge.shape)", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.Encoder.__init__": [[138, 147], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus_deblock.Encoder.body.append", "DGUNet_plus_deblock.Encoder.body.append", "DGUNet_plus_deblock.UNetConvBlock", "DGUNet_plus_deblock.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "#             downsample = True if (i+1) < depth else False", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.Encoder.forward": [[148, 168], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "#                 print(encoder_outs[i].shape,decoder_outs[-i-1].shape)", "\n", "#                 exit(0)", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "#                     print(i,len(encoder_outs),len(decoder_outs))", "\n", "                    ", "x", "=", "down", "(", "x", ")", "#,encoder_outs[i],decoder_outs[-i-1])", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "return", "res", ",", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.Decoder.__init__": [[171, 179], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus_deblock.Decoder.body.append", "DGUNet_plus_deblock.Decoder.skip_conv.append", "DGUNet_plus_deblock.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.Decoder.forward": [[180, 190], ["enumerate", "up", "res.append"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "#         for b in bridges:", "\n", "#             print(b.shape)", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "#             print(x.shape)", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.DownSample.__init__": [[195, 199], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.DownSample.forward": [[200, 203], ["DGUNet_plus_deblock.DownSample.down"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.UpSample.__init__": [[206, 210], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.UpSample.forward": [[211, 214], ["DGUNet_plus_deblock.UpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.SkipUpSample.__init__": [[217, 221], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "SkipUpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.SkipUpSample.forward": [[222, 226], ["DGUNet_plus_deblock.SkipUpSample.up"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.ORB.__init__": [[231, 237], ["torch.Module.__init__", "modules_body.append", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus_deblock.CAB", "DGUNet_plus_deblock.conv", "range"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.ORB.forward": [[238, 242], ["DGUNet_plus_deblock.ORB.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.ORSNet.__init__": [[246, 269], ["torch.Module.__init__", "DGUNet_plus_deblock.ORB", "DGUNet_plus_deblock.ORB", "DGUNet_plus_deblock.ORB", "DGUNet_plus_deblock.UpSample", "DGUNet_plus_deblock.UpSample", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "DGUNet_plus_deblock.UpSample", "DGUNet_plus_deblock.UpSample", "DGUNet_plus_deblock.UpSample", "DGUNet_plus_deblock.UpSample"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORSNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "orb1", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb2", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "self", ".", "orb3", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "\n", "self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n", "self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n", "self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n", "\n", "\n", "self", ".", "conv_enc1", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc2", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.ORSNet.forward": [[270, 284], ["DGUNet_plus_deblock.ORSNet.orb1", "DGUNet_plus_deblock.ORSNet.orb2", "DGUNet_plus_deblock.ORSNet.orb3", "DGUNet_plus_deblock.ORSNet.conv_dec1", "DGUNet_plus_deblock.ORSNet.conv_dec2", "DGUNet_plus_deblock.ORSNet.conv_dec3", "DGUNet_plus_deblock.ORSNet.conv_enc1", "DGUNet_plus_deblock.ORSNet.conv_enc2", "DGUNet_plus_deblock.ORSNet.up_dec1", "DGUNet_plus_deblock.ORSNet.conv_enc3", "DGUNet_plus_deblock.ORSNet.up_dec2", "DGUNet_plus_deblock.ORSNet.up_enc1", "DGUNet_plus_deblock.ORSNet.up_enc2"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n", "        ", "x", "=", "self", ".", "orb1", "(", "x", ")", "\n", "#         print(encoder_outs[0].shape,decoder_outs[-1].shape)", "\n", "x", "=", "x", "+", "self", ".", "conv_enc1", "(", "encoder_outs", "[", "0", "]", ")", "+", "self", ".", "conv_dec1", "(", "decoder_outs", "[", "-", "1", "]", ")", "\n", "\n", "x", "=", "self", ".", "orb2", "(", "x", ")", "\n", "#         print(encoder_outs[1].shape,decoder_outs[-2].shape)", "\n", "x", "=", "x", "+", "self", ".", "conv_enc2", "(", "self", ".", "up_enc1", "(", "encoder_outs", "[", "1", "]", ")", ")", "+", "self", ".", "conv_dec2", "(", "self", ".", "up_dec1", "(", "decoder_outs", "[", "-", "2", "]", ")", ")", "\n", "\n", "x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "#         print(encoder_outs[2].shape,decoder_outs[-3].shape)", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.ResBlock.__init__": [[291, 309], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n", "bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "act", ")", "\n", "\n", "", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "m", ")", "\n", "self", ".", "res_scale", "=", "res_scale", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.ResBlock.forward": [[310, 315], ["DGUNet_plus_deblock.ResBlock.body().mul", "DGUNet_plus_deblock.ResBlock.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.MPRBlock.__init__": [[318, 338], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus_deblock.Encoder", "DGUNet_plus_deblock.Decoder", "DGUNet_plus_deblock.SAM", "DGUNet_plus_deblock.ResBlock", "DGUNet_plus_deblock.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "block_size", "=", "32", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "block_size", "=", "block_size", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.MPRBlock.forward": [[338, 361], ["torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "x_k_1.view.view.view", "torch.fold().contiguous.view().permute().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "DGUNet_plus_deblock.MPRBlock.shallow_feat", "DGUNet_plus_deblock.MPRBlock.concat", "DGUNet_plus_deblock.MPRBlock.stage_encoder", "DGUNet_plus_deblock.MPRBlock.stage_decoder", "DGUNet_plus_deblock.MPRBlock.sam", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.unfold().permute", "torch.unfold().permute", "torch.unfold().permute", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute", "torch.fold", "torch.fold", "torch.fold", "torch.unfold", "torch.unfold", "torch.unfold", "torch.fold().contiguous.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "F", ".", "unfold", "(", "stage_img", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "# (b,l,cwh)", "\n", "l", "=", "x_k_1", ".", "shape", "[", "1", "]", "\n", "x_k_1", "=", "x_k_1", ".", "view", "(", "b", "*", "l", ",", "-", "1", ")", "\n", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "l", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "#view(b,l,w,h)", "\n", "r_k", "=", "F", ".", "fold", "(", "r_k", ",", "output_size", "=", "(", "w", ",", "h", ")", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "contiguous", "(", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.DGUNet.__init__": [[364, 398], ["torch.Module.__init__", "print", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus_deblock.Encoder", "DGUNet_plus_deblock.Decoder", "DGUNet_plus_deblock.SAM", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.conv", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "torch.nn.init.xavier_normal_", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.CAB", "DGUNet_plus_deblock.DGUNet.body.append", "DGUNet_plus_deblock.conv", "DGUNet_plus_deblock.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "DGUNet_plus_deblock.MPRBlock", "numpy.ceil().astype", "numpy.ceil"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ",", "block_size", "=", "32", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "block_size", "=", "block_size", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "nums_stages", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "MPRBlock", "(", "\n", "in_c", "=", "in_c", ",", "out_c", "=", "in_c", ",", "n_feat", "=", "n_feat", ",", "scale_unetfeats", "=", "scale_unetfeats", ",", "kernel_size", "=", "kernel_size", ",", "\n", "reduction", "=", "reduction", ",", "bias", "=", "bias", "\n", ")", ")", "\n", "", "self", ".", "shallow_feat_final", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage1_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "False", ")", "\n", "self", ".", "stage1_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "#         self.stage_orsnet = ORSNet(n_feat, scale_orsnetfeats, kernel_size, reduction, act, bias, scale_unetfeats,", "\n", "#                                     num_cab)", "\n", "\n", "self", ".", "sam12", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "r0", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "self", ".", "r_final", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat_final", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "tail", "=", "conv", "(", "n_feat", "+", "scale_orsnetfeats", ",", "out_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.DGUNet.forward": [[399, 457], ["torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "blocks.view.view.view", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "DGUNet_plus_deblock.DGUNet.shallow_feat1", "DGUNet_plus_deblock.DGUNet.stage1_encoder", "DGUNet_plus_deblock.DGUNet.stage1_decoder", "DGUNet_plus_deblock.DGUNet.sam12", "output_.append", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "torch.unfold().permute().contiguous", "x_k_1.view.view.view", "torch.fold().contiguous.view().permute().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "torch.fold().contiguous", "DGUNet_plus_deblock.DGUNet.shallow_feat_final", "DGUNet_plus_deblock.DGUNet.concat_final", "output_.append", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "torch.transpose", "stage_model", "output_.append", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus_deblock.DGUNet.tail", "torch.unfold().permute", "torch.unfold().permute", "torch.unfold().permute", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute", "torch.fold", "torch.fold", "torch.fold", "torch.unfold().permute", "torch.unfold().permute", "torch.unfold().permute", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.mm", "torch.fold().contiguous.view().permute", "torch.fold", "torch.fold", "torch.fold", "torch.unfold", "torch.unfold", "torch.unfold", "torch.fold().contiguous.view", "torch.unfold", "torch.unfold", "torch.unfold", "torch.fold().contiguous.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "img", ")", ":", "\n", "        ", "output_", "=", "[", "]", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 1---------------------", "\n", "##-------------------------------------------", "\n", "b", ",", "c", ",", "w", ",", "h", "=", "img", ".", "shape", "\n", "blocks", "=", "F", ".", "unfold", "(", "img", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "# (b,l,cwh)", "\n", "l", "=", "blocks", ".", "shape", "[", "1", "]", "\n", "blocks", "=", "blocks", ".", "view", "(", "b", "*", "l", ",", "-", "1", ")", "\n", "PhiTPhi", "=", "torch", ".", "mm", "(", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ",", "self", ".", "Phi", ")", "# torch.mm(Phix, Phi)", "\n", "Phix", "=", "torch", ".", "mm", "(", "blocks", ",", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ")", "# compression result", "\n", "PhiTb", "=", "torch", ".", "mm", "(", "Phix", ",", "self", ".", "Phi", ")", "#.view(b,l,-1).permute(0, 2, 1).contiguous()", "\n", "\n", "# compute r_0", "\n", "x_0", "=", "PhiTb", "#.view(b,-1)", "\n", "#         print(x_0.shape, PhiTPhi.shape)", "\n", "#         exit(0)", "\n", "x", "=", "x_0", "-", "self", ".", "r0", "*", "torch", ".", "mm", "(", "x_0", ",", "PhiTPhi", ")", "\n", "r_0", "=", "x", "+", "self", ".", "r0", "*", "PhiTb", "\n", "r_0", "=", "r_0", ".", "view", "(", "b", ",", "l", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "#view(b,l,w,h)", "\n", "r_0", "=", "F", ".", "fold", "(", "r_0", ",", "output_size", "=", "(", "w", ",", "h", ")", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "contiguous", "(", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat1", "(", "r_0", ")", "\n", "## Process features of all 4 patches with Encoder of Stage 1", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage1_encoder", "(", "x", ")", "\n", "## Pass features through Decoder of Stage 1", "\n", "f_decoder", "=", "self", ".", "stage1_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply Supervised Attention Module (SAM)", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam12", "(", "f_decoder", "[", "-", "1", "]", ",", "r_0", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 2_k-1---------------------", "\n", "##-------------------------------------------", "\n", "for", "stage_model", "in", "self", ".", "body", ":", "\n", "            ", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "=", "stage_model", "(", "stage_img", ",", "img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "##-------------------------------------------", "\n", "##-------------- Stage k---------------------", "\n", "##-------------------------------------------", "\n", "# compute r_k", "\n", "", "x_k_1", "=", "F", ".", "unfold", "(", "stage_img", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "# (b,l,cwh)", "\n", "x_k_1", "=", "x_k_1", ".", "view", "(", "b", "*", "l", ",", "-", "1", ")", "\n", "x", "=", "x_k_1", "-", "self", ".", "r_final", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r_final", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "l", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "#view(b,l,w,h)", "\n", "r_k", "=", "F", ".", "fold", "(", "r_k", ",", "output_size", "=", "(", "w", ",", "h", ")", ",", "kernel_size", "=", "self", ".", "block_size", ",", "stride", "=", "self", ".", "block_size", ")", ".", "contiguous", "(", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat_final", "(", "r_k", ")", "\n", "## Concatenate SAM features", "\n", "x_cat", "=", "self", ".", "concat_final", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "#         x_cat = self.stage_orsnet(x_cat, f_encoder, f_decoder)", "\n", "stage_img", "=", "self", ".", "tail", "(", "x_cat", ")", "+", "r_k", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "return", "output_", "[", ":", ":", "-", "1", "]", "#[stage5_img + x3_img, stage4_img, stage3_img, stage2_img, stage1_img]", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.conv": [[10, 14], ["torch.Conv2d"], "function", ["None"], ["def", "conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "bias", "=", "False", ",", "stride", "=", "1", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.conv_down": [[15, 18], ["torch.Conv2d"], "function", ["None"], ["", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n", "    ", "layer", "=", "nn", ".", "Conv2d", "(", "in_chn", ",", "out_chn", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "bias", ")", "\n", "return", "layer", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.DGUNet_plus_deblock.default_conv": [[285, 289], ["torch.Conv2d"], "function", ["None"], ["", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.losses.CharbonnierLoss.__init__": [[8, 11], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["def", "__init__", "(", "self", ",", "eps", "=", "1e-3", ")", ":", "\n", "        ", "super", "(", "CharbonnierLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "eps", "=", "eps", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.losses.CharbonnierLoss.forward": [[12, 17], ["torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "diff", "=", "x", "-", "y", "\n", "# loss = torch.sum(torch.sqrt(diff * diff + self.eps))", "\n", "loss", "=", "torch", ".", "mean", "(", "torch", ".", "sqrt", "(", "(", "diff", "*", "diff", ")", "+", "(", "self", ".", "eps", "*", "self", ".", "eps", ")", ")", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.losses.EdgeLoss.__init__": [[19, 26], ["torch.Module.__init__", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "losses.CharbonnierLoss", "losses.EdgeLoss.kernel.cuda", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.Tensor.t", "torch.Tensor.t", "torch.Tensor.t"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "EdgeLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "k", "=", "torch", ".", "Tensor", "(", "[", "[", ".05", ",", ".25", ",", ".4", ",", ".25", ",", ".05", "]", "]", ")", "\n", "self", ".", "kernel", "=", "torch", ".", "matmul", "(", "k", ".", "t", "(", ")", ",", "k", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "3", ",", "1", ",", "1", ",", "1", ")", "\n", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", ":", "\n", "            ", "self", ".", "kernel", "=", "self", ".", "kernel", ".", "cuda", "(", ")", "\n", "", "self", ".", "loss", "=", "CharbonnierLoss", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.losses.EdgeLoss.conv_gauss": [[27, 31], ["torch.pad", "torch.pad", "torch.pad", "torch.conv2d", "torch.conv2d", "torch.conv2d"], "methods", ["None"], ["", "def", "conv_gauss", "(", "self", ",", "img", ")", ":", "\n", "        ", "n_channels", ",", "_", ",", "kw", ",", "kh", "=", "self", ".", "kernel", ".", "shape", "\n", "img", "=", "F", ".", "pad", "(", "img", ",", "(", "kw", "//", "2", ",", "kh", "//", "2", ",", "kw", "//", "2", ",", "kh", "//", "2", ")", ",", "mode", "=", "'replicate'", ")", "\n", "return", "F", ".", "conv2d", "(", "img", ",", "self", ".", "kernel", ",", "groups", "=", "n_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.losses.EdgeLoss.laplacian_kernel": [[32, 40], ["losses.EdgeLoss.conv_gauss", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "losses.EdgeLoss.conv_gauss"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss"], ["", "def", "laplacian_kernel", "(", "self", ",", "current", ")", ":", "\n", "        ", "filtered", "=", "self", ".", "conv_gauss", "(", "current", ")", "# filter", "\n", "down", "=", "filtered", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "# downsample", "\n", "new_filter", "=", "torch", ".", "zeros_like", "(", "filtered", ")", "\n", "new_filter", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "=", "down", "*", "4", "# upsample", "\n", "filtered", "=", "self", ".", "conv_gauss", "(", "new_filter", ")", "# filter", "\n", "diff", "=", "current", "-", "filtered", "\n", "return", "diff", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.losses.EdgeLoss.forward": [[41, 44], ["losses.EdgeLoss.loss", "losses.EdgeLoss.laplacian_kernel", "losses.EdgeLoss.laplacian_kernel"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "loss", "=", "self", ".", "loss", "(", "self", ".", "laplacian_kernel", "(", "x", ")", ",", "self", ".", "laplacian_kernel", "(", "y", ")", ")", "\n", "return", "loss", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_deblock.RandomDataset.__init__": [[162, 165], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data", ",", "length", ")", ":", "\n", "        ", "self", ".", "data", "=", "data", "\n", "self", ".", "len", "=", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_deblock.RandomDataset.__getitem__": [[166, 168], ["torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor().float", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "return", "torch", ".", "Tensor", "(", "self", ".", "data", "[", "index", ",", ":", "]", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_deblock.RandomDataset.__len__": [[169, 171], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "len", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_deblock.col2im_CS_py": [[100, 110], ["numpy.zeros", "range", "range", "X_col[].reshape"], "function", ["None"], ["def", "col2im_CS_py", "(", "X_col", ",", "row", ",", "col", ",", "row_new", ",", "col_new", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "X0_rec", "=", "np", ".", "zeros", "(", "[", "row_new", ",", "col_new", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col_new", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "X0_rec", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", "=", "X_col", "[", ":", ",", "count", "]", ".", "reshape", "(", "[", "block_size", ",", "block_size", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "X_rec", "=", "X0_rec", "[", ":", "row", ",", ":", "col", "]", "\n", "return", "X_rec", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_deblock.psnr": [[112, 120], ["img1.astype", "img2.astype", "numpy.mean", "math.log10", "math.sqrt"], "function", ["None"], ["", "def", "psnr", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "img1", ".", "astype", "(", "np", ".", "float32", ")", "\n", "img2", ".", "astype", "(", "np", ".", "float32", ")", "\n", "mse", "=", "np", ".", "mean", "(", "(", "img1", "-", "img2", ")", "**", "2", ")", "\n", "if", "mse", "==", "0", ":", "\n", "        ", "return", "100", "\n", "", "PIXEL_MAX", "=", "255.0", "\n", "return", "20", "*", "math", ".", "log10", "(", "PIXEL_MAX", "/", "math", ".", "sqrt", "(", "mse", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_deblock.imread_CS_py": [[122, 132], ["numpy.concatenate", "numpy.concatenate", "numpy.mod", "numpy.mod", "numpy.zeros", "numpy.zeros"], "function", ["None"], ["", "def", "imread_CS_py", "(", "Iorg", ")", ":", "\n", "    ", "block_size", "=", "args", ".", "im_size", "\n", "[", "row", ",", "col", "]", "=", "Iorg", ".", "shape", "\n", "row_pad", "=", "block_size", "-", "np", ".", "mod", "(", "row", ",", "block_size", ")", "\n", "col_pad", "=", "block_size", "-", "np", ".", "mod", "(", "col", ",", "block_size", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Iorg", ",", "np", ".", "zeros", "(", "[", "row", ",", "col_pad", "]", ")", ")", ",", "axis", "=", "1", ")", "\n", "Ipad", "=", "np", ".", "concatenate", "(", "(", "Ipad", ",", "np", ".", "zeros", "(", "[", "row_pad", ",", "col", "+", "col_pad", "]", ")", ")", ",", "axis", "=", "0", ")", "\n", "[", "row_new", ",", "col_new", "]", "=", "Ipad", ".", "shape", "\n", "\n", "return", "[", "Iorg", ",", "row", ",", "col", ",", "Ipad", ",", "row_new", ",", "col_new", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Compressive-Sensing.train_deblock.img2col_py": [[134, 146], ["int", "numpy.zeros", "range", "range", "Ipad[].reshape"], "function", ["None"], ["", "def", "img2col_py", "(", "Ipad", ",", "block_size", ")", ":", "\n", "    ", "[", "row", ",", "col", "]", "=", "Ipad", ".", "shape", "\n", "row_block", "=", "row", "/", "block_size", "\n", "col_block", "=", "col", "/", "block_size", "\n", "block_num", "=", "int", "(", "row_block", "*", "col_block", ")", "\n", "img_col", "=", "np", ".", "zeros", "(", "[", "block_size", "**", "2", ",", "block_num", "]", ")", "\n", "count", "=", "0", "\n", "for", "x", "in", "range", "(", "0", ",", "row", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "        ", "for", "y", "in", "range", "(", "0", ",", "col", "-", "block_size", "+", "1", ",", "block_size", ")", ":", "\n", "            ", "img_col", "[", ":", ",", "count", "]", "=", "Ipad", "[", "x", ":", "x", "+", "block_size", ",", "y", ":", "y", "+", "block_size", "]", ".", "reshape", "(", "[", "-", "1", "]", ")", "\n", "count", "=", "count", "+", "1", "\n", "", "", "return", "img_col", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.dataset_utils.MixUp_AUG.__init__": [[4, 6], ["torch.distributions.beta.Beta", "torch.tensor", "torch.tensor"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "dist", "=", "torch", ".", "distributions", ".", "beta", ".", "Beta", "(", "torch", ".", "tensor", "(", "[", "0.6", "]", ")", ",", "torch", ".", "tensor", "(", "[", "0.6", "]", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.dataset_utils.MixUp_AUG.aug": [[7, 19], ["rgb_gt.size", "torch.randperm", "dataset_utils.MixUp_AUG.dist.rsample().view().cuda", "dataset_utils.MixUp_AUG.dist.rsample().view", "dataset_utils.MixUp_AUG.dist.rsample"], "methods", ["None"], ["", "def", "aug", "(", "self", ",", "rgb_gt", ",", "rgb_noisy", ")", ":", "\n", "        ", "bs", "=", "rgb_gt", ".", "size", "(", "0", ")", "\n", "indices", "=", "torch", ".", "randperm", "(", "bs", ")", "\n", "rgb_gt2", "=", "rgb_gt", "[", "indices", "]", "\n", "rgb_noisy2", "=", "rgb_noisy", "[", "indices", "]", "\n", "\n", "lam", "=", "self", ".", "dist", ".", "rsample", "(", "(", "bs", ",", "1", ")", ")", ".", "view", "(", "-", "1", ",", "1", ",", "1", ",", "1", ")", ".", "cuda", "(", ")", "\n", "\n", "rgb_gt", "=", "lam", "*", "rgb_gt", "+", "(", "1", "-", "lam", ")", "*", "rgb_gt2", "\n", "rgb_noisy", "=", "lam", "*", "rgb_noisy", "+", "(", "1", "-", "lam", ")", "*", "rgb_noisy2", "\n", "\n", "return", "rgb_gt", ",", "rgb_noisy", "", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.freeze": [[5, 8], ["model.parameters"], "function", ["None"], ["def", "freeze", "(", "model", ")", ":", "\n", "    ", "for", "p", "in", "model", ".", "parameters", "(", ")", ":", "\n", "        ", "p", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.unfreeze": [[9, 12], ["model.parameters"], "function", ["None"], ["", "", "def", "unfreeze", "(", "model", ")", ":", "\n", "    ", "for", "p", "in", "model", ".", "parameters", "(", ")", ":", "\n", "        ", "p", ".", "requires_grad", "=", "True", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.is_frozen": [[13, 16], ["all", "model.parameters"], "function", ["None"], ["", "", "def", "is_frozen", "(", "model", ")", ":", "\n", "    ", "x", "=", "[", "p", ".", "requires_grad", "for", "p", "in", "model", ".", "parameters", "(", ")", "]", "\n", "return", "not", "all", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.save_checkpoint": [[17, 21], ["os.path.join", "torch.save"], "function", ["None"], ["", "def", "save_checkpoint", "(", "model_dir", ",", "state", ",", "session", ")", ":", "\n", "    ", "epoch", "=", "state", "[", "'epoch'", "]", "\n", "model_out_path", "=", "os", ".", "path", ".", "join", "(", "model_dir", ",", "\"model_epoch_{}_{}.pth\"", ".", "format", "(", "epoch", ",", "session", ")", ")", "\n", "torch", ".", "save", "(", "state", ",", "model_out_path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.load_checkpoint": [[22, 33], ["torch.load", "model.load_state_dict", "collections.OrderedDict", "state_dict.items", "model.load_state_dict"], "function", ["None"], ["", "def", "load_checkpoint", "(", "model", ",", "weights", ")", ":", "\n", "    ", "checkpoint", "=", "torch", ".", "load", "(", "weights", ")", "\n", "try", ":", "\n", "        ", "model", ".", "load_state_dict", "(", "checkpoint", "[", "\"state_dict\"", "]", ")", "\n", "", "except", ":", "\n", "        ", "state_dict", "=", "checkpoint", "[", "\"state_dict\"", "]", "\n", "new_state_dict", "=", "OrderedDict", "(", ")", "\n", "for", "k", ",", "v", "in", "state_dict", ".", "items", "(", ")", ":", "\n", "            ", "name", "=", "k", "[", "7", ":", "]", "# remove `module.`", "\n", "new_state_dict", "[", "name", "]", "=", "v", "\n", "", "model", ".", "load_state_dict", "(", "new_state_dict", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.load_checkpoint_multigpu": [[35, 43], ["torch.load", "collections.OrderedDict", "state_dict.items", "model.load_state_dict"], "function", ["None"], ["", "", "def", "load_checkpoint_multigpu", "(", "model", ",", "weights", ")", ":", "\n", "    ", "checkpoint", "=", "torch", ".", "load", "(", "weights", ")", "\n", "state_dict", "=", "checkpoint", "[", "\"state_dict\"", "]", "\n", "new_state_dict", "=", "OrderedDict", "(", ")", "\n", "for", "k", ",", "v", "in", "state_dict", ".", "items", "(", ")", ":", "\n", "        ", "name", "=", "k", "[", "7", ":", "]", "# remove `module.`", "\n", "new_state_dict", "[", "name", "]", "=", "v", "\n", "", "model", ".", "load_state_dict", "(", "new_state_dict", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.load_start_epoch": [[44, 48], ["torch.load"], "function", ["None"], ["", "def", "load_start_epoch", "(", "weights", ")", ":", "\n", "    ", "checkpoint", "=", "torch", ".", "load", "(", "weights", ")", "\n", "epoch", "=", "checkpoint", "[", "\"epoch\"", "]", "\n", "return", "epoch", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.load_optim": [[49, 52], ["torch.load", "optimizer.load_state_dict"], "function", ["None"], ["", "def", "load_optim", "(", "optimizer", ",", "weights", ")", ":", "\n", "    ", "checkpoint", "=", "torch", ".", "load", "(", "weights", ")", "\n", "optimizer", ".", "load_state_dict", "(", "checkpoint", "[", "'optimizer'", "]", ")", "\n", "# for p in optimizer.param_groups: lr = p['lr']", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.image_utils.torchPSNR": [[5, 10], ["torch.clamp", "torch.clamp", "torch.log10"], "function", ["None"], ["def", "torchPSNR", "(", "tar_img", ",", "prd_img", ")", ":", "\n", "    ", "imdff", "=", "torch", ".", "clamp", "(", "prd_img", ",", "0", ",", "1", ")", "-", "torch", ".", "clamp", "(", "tar_img", ",", "0", ",", "1", ")", "\n", "rmse", "=", "(", "imdff", "**", "2", ")", ".", "mean", "(", ")", ".", "sqrt", "(", ")", "\n", "ps", "=", "20", "*", "torch", ".", "log10", "(", "1", "/", "rmse", ")", "\n", "return", "ps", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.image_utils.save_img": [[11, 13], ["cv2.imwrite", "cv2.cvtColor"], "function", ["None"], ["", "def", "save_img", "(", "filepath", ",", "img", ")", ":", "\n", "    ", "cv2", ".", "imwrite", "(", "filepath", ",", "cv2", ".", "cvtColor", "(", "img", ",", "cv2", ".", "COLOR_RGB2BGR", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.image_utils.numpyPSNR": [[14, 19], ["numpy.sqrt", "numpy.float32", "numpy.float32", "numpy.mean", "numpy.log10"], "function", ["None"], ["", "def", "numpyPSNR", "(", "tar_img", ",", "prd_img", ")", ":", "\n", "    ", "imdff", "=", "np", ".", "float32", "(", "prd_img", ")", "-", "np", ".", "float32", "(", "tar_img", ")", "\n", "rmse", "=", "np", ".", "sqrt", "(", "np", ".", "mean", "(", "imdff", "**", "2", ")", ")", "\n", "ps", "=", "20", "*", "np", ".", "log10", "(", "255", "/", "rmse", ")", "\n", "return", "ps", "\n", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.dir_utils.mkdirs": [[5, 11], ["isinstance", "dir_utils.mkdir", "isinstance", "dir_utils.mkdir"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.dir_utils.mkdir", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.dir_utils.mkdir"], ["def", "mkdirs", "(", "paths", ")", ":", "\n", "    ", "if", "isinstance", "(", "paths", ",", "list", ")", "and", "not", "isinstance", "(", "paths", ",", "str", ")", ":", "\n", "        ", "for", "path", "in", "paths", ":", "\n", "            ", "mkdir", "(", "path", ")", "\n", "", "", "else", ":", "\n", "        ", "mkdir", "(", "paths", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.dir_utils.mkdir": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "", "def", "mkdir", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.dir_utils.get_last_path": [[16, 19], ["natsort.natsorted", "glob.glob", "os.path.join"], "function", ["None"], ["", "", "def", "get_last_path", "(", "path", ",", "session", ")", ":", "\n", "\t", "x", "=", "natsorted", "(", "glob", "(", "os", ".", "path", ".", "join", "(", "path", ",", "'*%s'", "%", "session", ")", ")", ")", "[", "-", "1", "]", "\n", "return", "x", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.config.Config.__init__": [[56, 101], ["yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "config.Config._C.merge_from_file", "config.Config._C.merge_from_list", "config.Config._C.freeze"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.freeze"], ["def", "__init__", "(", "self", ",", "config_yaml", ":", "str", ",", "config_override", ":", "List", "[", "Any", "]", "=", "[", "]", ")", ":", "\n", "\n", "        ", "self", ".", "_C", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "GPU", "=", "[", "0", "]", "\n", "self", ".", "_C", ".", "VERBOSE", "=", "False", "\n", "\n", "self", ".", "_C", ".", "MODEL", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "MODEL", ".", "MODE", "=", "'global'", "\n", "self", ".", "_C", ".", "MODEL", ".", "SESSION", "=", "'ps128_bs1'", "\n", "\n", "self", ".", "_C", ".", "OPTIM", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BATCH_SIZE", "=", "1", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NUM_EPOCHS", "=", "100", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NEPOCH_DECAY", "=", "[", "100", "]", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_INITIAL", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_MIN", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BETA1", "=", "0.5", "\n", "\n", "self", ".", "_C", ".", "TRAINING", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_AFTER_EVERY", "=", "3", "\n", "self", ".", "_C", ".", "TRAINING", ".", "RESUME", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_IMAGES", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_DIR", "=", "'images_dir/train'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_DIR", "=", "'images_dir/val'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_DIR", "=", "'checkpoints'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_PS", "=", "64", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_PS", "=", "64", "\n", "\n", "# Override parameter values from YAML file first, then from override list.", "\n", "self", ".", "_C", ".", "merge_from_file", "(", "config_yaml", ")", "\n", "self", ".", "_C", ".", "merge_from_list", "(", "config_override", ")", "\n", "\n", "# Make an instantiated object of this class immutable.", "\n", "self", ".", "_C", ".", "freeze", "(", ")", "\n", "\n", "", "def", "dump", "(", "self", ",", "file_path", ":", "str", ")", ":", "\n", "        ", "r\"\"\"Save config at the specified file path.\n\n        Parameters\n        ----------\n        file_path: str\n            (YAML) path to save config at.\n        \"\"\"", "\n", "self", ".", "_C", ".", "dump", "(", "stream", "=", "open", "(", "file_path", ",", "\"w\"", ")", ")", "\n", "\n", "", "def", "__getattr__", "(", "self", ",", "attr", ":", "str", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.config.Config.dump": [[102, 111], ["config.Config._C.dump", "open"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.dump"], ["        ", "return", "self", ".", "_C", ".", "__getattr__", "(", "attr", ")", "\n", "\n", "", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "_C", ".", "__repr__", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.config.Config.__getattr__": [[112, 114], ["config.Config._C.__getattr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__getattr__"], []], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.config.Config.__repr__": [[115, 117], ["config.Config._C.__repr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__repr__"], []], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.data_RGB.get_training_data": [[4, 7], ["os.path.exists", "dataset_RGB.DataLoaderTrain"], "function", ["None"], ["def", "get_training_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderTrain", "(", "rgb_dir", ",", "img_options", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.data_RGB.get_training_data_all": [[8, 12], ["dataset_RGB.DataLoaderTrain_all", "os.path.exists"], "function", ["None"], ["", "def", "get_training_data_all", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "for", "dir", "in", "rgb_dir", ":", "\n", "        ", "assert", "os", ".", "path", ".", "exists", "(", "dir", ")", "\n", "", "return", "DataLoaderTrain_all", "(", "rgb_dir", ",", "img_options", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.data_RGB.get_validation_data": [[13, 16], ["os.path.exists", "dataset_RGB.DataLoaderVal"], "function", ["None"], ["", "def", "get_validation_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderVal", "(", "rgb_dir", ",", "img_options", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.data_RGB.get_test_data": [[17, 20], ["os.path.exists", "dataset_RGB.DataLoaderTest"], "function", ["None"], ["", "def", "get_test_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderTest", "(", "rgb_dir", ",", "img_options", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.ResBlock.__init__": [[29, 47], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet_plus.conv", "DGUNet_plus.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Block (CAB)", "\n", "", "", "class", "CAB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.ResBlock.forward": [[48, 53], ["DGUNet_plus.ResBlock.body().mul", "DGUNet_plus.ResBlock.body"], "methods", ["None"], ["modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.CAB.__init__": [[58, 67], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet_plus.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["\n", "\n", "##########################################################################", "\n", "## Supervised Attention Module", "\n", "", "", "class", "SAM", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.CAB.forward": [[68, 73], ["DGUNet_plus.CAB.body", "DGUNet_plus.CAB.CA"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n", "x2", "=", "torch", ".", "sigmoid", "(", "self", ".", "conv3", "(", "img", ")", ")", "\n", "x1", "=", "x1", "*", "x2", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.CALayer.__init__": [[76, 86], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["\n", "", "", "class", "UNetConvBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_1", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.CALayer.forward": [[88, 92], ["DGUNet_plus.CALayer.avg_pool", "DGUNet_plus.CALayer.conv_du"], "methods", ["None"], ["\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "csff_dec", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.SAM.__init__": [[97, 101], ["torch.Module.__init__", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.SAM.forward": [[102, 107], ["DGUNet_plus.SAM.conv1", "DGUNet_plus.SAM.conv2"], "methods", ["None"], ["\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n", "", "out", "=", "self", ".", "relu_1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_2", "(", "self", ".", "conv_2", "(", "out", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.mergeblock.__init__": [[110, 115], ["torch.Module.__init__", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n", "", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.mergeblock.forward": [[116, 132], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.mergeblock.subnet", "DGUNet_plus.mergeblock.view", "DGUNet_plus.mergeblock.view.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.mergeblock.conv_block", "torch.matmul().permute().view.view.permute", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul"], "methods", ["None"], ["return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n", "\n", "", "", "", "class", "UNetUpBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.Encoder.__init__": [[137, 144], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.UNetConvBlock", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.Encoder.forward": [[145, 162], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "return", "res", ",", "x", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.UNetConvBlock.__init__": [[165, 188], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet_plus.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["", "", "class", "Decoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "##---------- Resizing Modules ----------", "\n", "", "", "class", "DownSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.UNetConvBlock.forward": [[189, 208], ["DGUNet_plus.UNetConvBlock.conv_1", "DGUNet_plus.UNetConvBlock.relu_1", "DGUNet_plus.UNetConvBlock.relu_2", "DGUNet_plus.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetConvBlock.conv_2", "torch.leaky_relu", "torch.leaky_relu", "torch.leaky_relu", "DGUNet_plus.UNetConvBlock.downsample", "DGUNet_plus.UNetConvBlock.norm", "DGUNet_plus.UNetConvBlock.csff_enc", "DGUNet_plus.UNetConvBlock.csff_dec", "DGUNet_plus.UNetConvBlock.gamma", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet_plus.UNetConvBlock.phi"], "methods", ["None"], ["self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "UpSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "SkipUpSample", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.UNetUpBlock.__init__": [[211, 215], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.UNetUpBlock.forward": [[216, 221], ["DGUNet_plus.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetUpBlock.conv_block"], "methods", ["None"], ["x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n", "\n", "##########################################################################", "\n", "## Original Resolution Block (ORB)", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.Decoder.__init__": [[224, 232], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Decoder.body.append", "DGUNet_plus.Decoder.skip_conv.append", "DGUNet_plus.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.Decoder.forward": [[233, 240], ["enumerate", "up", "res.append"], "methods", ["None"], ["return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "", "", "class", "ORSNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORSNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.DownSample.__init__": [[245, 249], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n", "self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.DownSample.forward": [[250, 253], ["DGUNet_plus.DownSample.down"], "methods", ["None"], ["self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.UpSample.__init__": [[256, 260], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.UpSample.forward": [[261, 264], ["DGUNet_plus.UpSample.up"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n", "        ", "x", "=", "self", ".", "orb1", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc1", "(", "encoder_outs", "[", "0", "]", ")", "+", "self", ".", "conv_dec1", "(", "decoder_outs", "[", "-", "1", "]", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.DGUNet.__init__": [[269, 344], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.conv", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n", "", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n", "", "class", "ResBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n", "bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "act", ")", "\n", "\n", "", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "m", ")", "\n", "self", ".", "res_scale", "=", "res_scale", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n", "##########################################################################", "\n", "", "", "class", "MPRBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.DGUNet.forward": [[345, 435], ["DGUNet_plus.DGUNet.shallow_feat1", "DGUNet_plus.DGUNet.stage1_encoder", "DGUNet_plus.DGUNet.stage1_decoder", "DGUNet_plus.DGUNet.sam12", "DGUNet_plus.DGUNet.shallow_feat2", "DGUNet_plus.DGUNet.merge12", "DGUNet_plus.DGUNet.stage2_encoder", "DGUNet_plus.DGUNet.stage2_decoder", "DGUNet_plus.DGUNet.sam23", "DGUNet_plus.DGUNet.shallow_feat3", "DGUNet_plus.DGUNet.merge23", "DGUNet_plus.DGUNet.stage3_encoder", "DGUNet_plus.DGUNet.stage3_decoder", "DGUNet_plus.DGUNet.sam34", "DGUNet_plus.DGUNet.shallow_feat4", "DGUNet_plus.DGUNet.merge34", "DGUNet_plus.DGUNet.stage4_encoder", "DGUNet_plus.DGUNet.stage4_decoder", "DGUNet_plus.DGUNet.sam45", "DGUNet_plus.DGUNet.shallow_feat5", "DGUNet_plus.DGUNet.merge45", "DGUNet_plus.DGUNet.stage5_encoder", "DGUNet_plus.DGUNet.stage5_decoder", "DGUNet_plus.DGUNet.sam56", "DGUNet_plus.DGUNet.shallow_feat6", "DGUNet_plus.DGUNet.merge56", "DGUNet_plus.DGUNet.stage6_encoder", "DGUNet_plus.DGUNet.stage6_decoder", "DGUNet_plus.DGUNet.sam67", "DGUNet_plus.DGUNet.shallow_feat7", "DGUNet_plus.DGUNet.merge67", "DGUNet_plus.DGUNet.phi_0", "DGUNet_plus.DGUNet.phi_1", "DGUNet_plus.DGUNet.phi_2", "DGUNet_plus.DGUNet.phi_3", "DGUNet_plus.DGUNet.phi_4", "DGUNet_plus.DGUNet.phi_5", "DGUNet_plus.DGUNet.phi_6", "DGUNet_plus.DGUNet.tail", "DGUNet_plus.DGUNet.phit_0", "DGUNet_plus.DGUNet.phit_1", "DGUNet_plus.DGUNet.phit_2", "DGUNet_plus.DGUNet.phit_3", "DGUNet_plus.DGUNet.phit_4", "DGUNet_plus.DGUNet.phit_5", "DGUNet_plus.DGUNet.phit_6"], "methods", ["None"], ["\n", "##########################################################################", "\n", "", "", "class", "DGUNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "nums_stages", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "MPRBlock", "(", "\n", "in_c", "=", "in_c", ",", "out_c", "=", "in_c", ",", "n_feat", "=", "n_feat", ",", "scale_unetfeats", "=", "scale_unetfeats", ",", "kernel_size", "=", "kernel_size", ",", "\n", "reduction", "=", "reduction", ",", "bias", "=", "bias", "\n", ")", ")", "\n", "", "self", ".", "shallow_feat_final", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage1_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "False", ")", "\n", "self", ".", "stage1_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam12", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "r0", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "self", ".", "r_final", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat_final", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "tail", "=", "conv", "(", "n_feat", "+", "scale_orsnetfeats", ",", "out_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "img", ")", ":", "\n", "        ", "output_", "=", "[", "]", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 1---------------------", "\n", "##-------------------------------------------", "\n", "b", ",", "c", ",", "w", ",", "h", "=", "img", ".", "shape", "\n", "PhiTPhi", "=", "torch", ".", "mm", "(", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ",", "self", ".", "Phi", ")", "# torch.mm(Phix, Phi)", "\n", "Phix", "=", "torch", ".", "mm", "(", "img", ".", "view", "(", "b", ",", "-", "1", ")", ",", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ")", "# compression result", "\n", "PhiTb", "=", "torch", ".", "mm", "(", "Phix", ",", "self", ".", "Phi", ")", "\n", "# compute r_0", "\n", "x_0", "=", "PhiTb", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_0", "-", "self", ".", "r0", "*", "torch", ".", "mm", "(", "x_0", ",", "PhiTPhi", ")", "\n", "r_0", "=", "x", "+", "self", ".", "r0", "*", "PhiTb", "\n", "r_0", "=", "r_0", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat1", "(", "r_0", ")", "\n", "## Process features of all 4 patches with Encoder of Stage 1", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage1_encoder", "(", "x", ")", "\n", "## Pass features through Decoder of Stage 1", "\n", "f_decoder", "=", "self", ".", "stage1_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply Supervised Attention Module (SAM)", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam12", "(", "f_decoder", "[", "-", "1", "]", ",", "r_0", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 2_k-1---------------------", "\n", "##-------------------------------------------", "\n", "for", "stage_model", "in", "self", ".", "body", ":", "\n", "            ", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "=", "stage_model", "(", "stage_img", ",", "img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "##-------------------------------------------", "\n", "##-------------- Stage k---------------------", "\n", "##-------------------------------------------", "\n", "# compute r_k", "\n", "", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_k_1", "-", "self", ".", "r_final", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r_final", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat_final", "(", "r_k", ")", "\n", "## Concatenate SAM features", "\n", "x_cat", "=", "self", ".", "concat_final", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "stage_img", "=", "self", ".", "tail", "(", "x_cat", ")", "+", "r_k", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "return", "output_", "[", ":", ":", "-", "1", "]", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.conv": [[11, 15], ["torch.Conv2d"], "function", ["None"], ["    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n", "\n", "", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.conv_down": [[17, 20], ["torch.Conv2d"], "function", ["None"], ["return", "layer", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Layer", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet_plus.default_conv": [[22, 26], ["torch.Conv2d"], "function", ["None"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.ResBlock.__init__": [[27, 45], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet.conv", "DGUNet.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Block (CAB)", "\n", "", "", "class", "CAB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.ResBlock.forward": [[46, 51], ["DGUNet.ResBlock.body().mul", "DGUNet.ResBlock.body"], "methods", ["None"], ["modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.CAB.__init__": [[56, 65], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["res", "+=", "x", "\n", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "## Supervised Attention Module", "\n", "", "", "class", "SAM", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.CAB.forward": [[66, 71], ["DGUNet.CAB.body", "DGUNet.CAB.CA"], "methods", ["None"], ["self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.CALayer.__init__": [[74, 84], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["x1", "=", "x1", "+", "x", "\n", "return", "x1", ",", "img", "\n", "\n", "", "", "class", "UNetConvBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.CALayer.forward": [[86, 90], ["DGUNet.CALayer.avg_pool", "DGUNet.CALayer.conv_du"], "methods", ["None"], ["self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_2", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.SAM.__init__": [[95, 99], ["torch.Module.__init__", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["", "self", ".", "use_HIN", "=", "use_HIN", "\n", "\n", "if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.SAM.forward": [[100, 105], ["DGUNet.SAM.conv1", "DGUNet.SAM.conv2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n", "\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.mergeblock.__init__": [[108, 113], ["torch.Module.__init__", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["\n", "out", "+=", "self", ".", "identity", "(", "x", ")", "\n", "if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.mergeblock.forward": [[114, 130], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.mergeblock.subnet", "DGUNet.mergeblock.view", "DGUNet.mergeblock.view.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.mergeblock.conv_block", "torch.matmul().permute().view.view.permute", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul"], "methods", ["None"], ["", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n", "return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n", "\n", "", "", "", "class", "UNetUpBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.Encoder.__init__": [[135, 142], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Encoder.body.append", "DGUNet.Encoder.body.append", "DGUNet.UNetConvBlock", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["\n", "", "", "class", "Encoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.Encoder.forward": [[143, 160], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.UNetConvBlock.__init__": [[163, 186], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["\n", "\n", "", "", "class", "Decoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "##---------- Resizing Modules ----------", "\n", "", "", "class", "DownSample", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.UNetConvBlock.forward": [[187, 206], ["DGUNet.UNetConvBlock.conv_1", "DGUNet.UNetConvBlock.relu_1", "DGUNet.UNetConvBlock.relu_2", "DGUNet.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetConvBlock.conv_2", "torch.leaky_relu", "torch.leaky_relu", "torch.leaky_relu", "DGUNet.UNetConvBlock.downsample", "DGUNet.UNetConvBlock.norm", "DGUNet.UNetConvBlock.csff_enc", "DGUNet.UNetConvBlock.csff_dec", "DGUNet.UNetConvBlock.gamma", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet.UNetConvBlock.phi"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "UpSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.UNetUpBlock.__init__": [[209, 213], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "SkipUpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.UNetUpBlock.forward": [[214, 219], ["DGUNet.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetUpBlock.conv_block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.Decoder.__init__": [[222, 230], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Decoder.body.append", "DGUNet.Decoder.skip_conv.append", "DGUNet.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["", "", "class", "ORB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.Decoder.forward": [[231, 238], ["enumerate", "up", "res.append"], "methods", ["None"], ["        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "", "", "class", "ORSNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.DownSample.__init__": [[243, 247], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "orb3", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "\n", "self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.DownSample.forward": [[248, 251], ["DGUNet.DownSample.down"], "methods", ["None"], ["self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n", "self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.UpSample.__init__": [[254, 258], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "conv_enc1", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc2", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.UpSample.forward": [[259, 262], ["DGUNet.UpSample.up"], "methods", ["None"], ["self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.Basic_block.__init__": [[267, 281], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "DGUNet.ResBlock", "DGUNet.ResBlock", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.mergeblock", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["x", "=", "x", "+", "self", ".", "conv_enc2", "(", "self", ".", "up_enc1", "(", "encoder_outs", "[", "1", "]", ")", ")", "+", "self", ".", "conv_dec2", "(", "self", ".", "up_dec1", "(", "decoder_outs", "[", "-", "2", "]", ")", ")", "\n", "\n", "x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n", "", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n", "", "class", "ResBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.Basic_block.forward": [[282, 293], ["DGUNet.Basic_block.shallow_feat2", "DGUNet.Basic_block.merge12", "DGUNet.Basic_block.stage2_encoder", "DGUNet.Basic_block.stage2_decoder", "DGUNet.Basic_block.sam23", "DGUNet.Basic_block.phi_1", "DGUNet.Basic_block.phit_1"], "methods", ["None"], ["bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.DGUNet.__init__": [[297, 323], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "DGUNet.Basic_block", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "DGUNet.ResBlock", "DGUNet.ResBlock", "DGUNet.ResBlock", "DGUNet.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.conv", "DGUNet.conv", "DGUNet.CAB", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["self", ".", "res_scale", "=", "res_scale", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n", "##########################################################################", "\n", "", "", "class", "MPRBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.DGUNet.forward": [[324, 359], ["DGUNet.DGUNet.shallow_feat1", "DGUNet.DGUNet.stage1_encoder", "DGUNet.DGUNet.stage1_decoder", "DGUNet.DGUNet.sam12", "res.append", "range", "DGUNet.DGUNet.shallow_feat7", "DGUNet.DGUNet.concat67", "res.append", "DGUNet.DGUNet.phi_0", "DGUNet.DGUNet.basic", "res.append", "DGUNet.DGUNet.phi_6", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.DGUNet.tail", "DGUNet.DGUNet.phit_0", "DGUNet.DGUNet.phit_6"], "methods", ["None"], ["\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n", "##########################################################################", "\n", "", "", "class", "DGUNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "nums_stages", "=", "nums_stages", "\n", "self", ".", "stage_model", "=", "MPRBlock", "(", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.conv": [[9, 13], ["torch.Conv2d"], "function", ["None"], ["##########################################################################", "\n", "def", "conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "bias", "=", "False", ",", "stride", "=", "1", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.conv_down": [[15, 18], ["torch.Conv2d"], "function", ["None"], ["", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n", "    ", "layer", "=", "nn", ".", "Conv2d", "(", "in_chn", ",", "out_chn", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "bias", ")", "\n", "return", "layer", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.DGUNet.default_conv": [[20, 24], ["torch.Conv2d"], "function", ["None"], ["## Channel Attention Layer", "\n", "", "class", "CALayer", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.evaluate_RealBlur.image_align": [[15, 59], ["numpy.ones_like", "numpy.eye", "cv2.findTransformECC", "cv2.warpPerspective", "cv2.warpPerspective", "cv2.cvtColor", "cv2.cvtColor", "numpy.ones_like", "numpy.sum", "numpy.sum"], "function", ["None"], ["def", "image_align", "(", "deblurred", ",", "gt", ")", ":", "\n", "# this function is based on kohler evaluation code", "\n", "  ", "z", "=", "deblurred", "\n", "c", "=", "np", ".", "ones_like", "(", "z", ")", "\n", "x", "=", "gt", "\n", "\n", "zs", "=", "(", "np", ".", "sum", "(", "x", "*", "z", ")", "/", "np", ".", "sum", "(", "z", "*", "z", ")", ")", "*", "z", "# simple intensity matching", "\n", "\n", "warp_mode", "=", "cv2", ".", "MOTION_HOMOGRAPHY", "\n", "warp_matrix", "=", "np", ".", "eye", "(", "3", ",", "3", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "\n", "# Specify the number of iterations.", "\n", "number_of_iterations", "=", "100", "\n", "\n", "termination_eps", "=", "0", "\n", "\n", "criteria", "=", "(", "cv2", ".", "TERM_CRITERIA_EPS", "|", "cv2", ".", "TERM_CRITERIA_COUNT", ",", "\n", "number_of_iterations", ",", "termination_eps", ")", "\n", "\n", "# Run the ECC algorithm. The results are stored in warp_matrix.", "\n", "(", "cc", ",", "warp_matrix", ")", "=", "cv2", ".", "findTransformECC", "(", "cv2", ".", "cvtColor", "(", "x", ",", "cv2", ".", "COLOR_RGB2GRAY", ")", ",", "cv2", ".", "cvtColor", "(", "zs", ",", "cv2", ".", "COLOR_RGB2GRAY", ")", ",", "warp_matrix", ",", "warp_mode", ",", "criteria", ",", "inputMask", "=", "None", ",", "gaussFiltSize", "=", "5", ")", "\n", "\n", "target_shape", "=", "x", ".", "shape", "\n", "shift", "=", "warp_matrix", "\n", "\n", "zr", "=", "cv2", ".", "warpPerspective", "(", "\n", "zs", ",", "\n", "warp_matrix", ",", "\n", "(", "target_shape", "[", "1", "]", ",", "target_shape", "[", "0", "]", ")", ",", "\n", "flags", "=", "cv2", ".", "INTER_CUBIC", "+", "cv2", ".", "WARP_INVERSE_MAP", ",", "\n", "borderMode", "=", "cv2", ".", "BORDER_REFLECT", ")", "\n", "\n", "cr", "=", "cv2", ".", "warpPerspective", "(", "\n", "np", ".", "ones_like", "(", "zs", ",", "dtype", "=", "'float32'", ")", ",", "\n", "warp_matrix", ",", "\n", "(", "target_shape", "[", "1", "]", ",", "target_shape", "[", "0", "]", ")", ",", "\n", "flags", "=", "cv2", ".", "INTER_NEAREST", "+", "cv2", ".", "WARP_INVERSE_MAP", ",", "\n", "borderMode", "=", "cv2", ".", "BORDER_CONSTANT", ",", "\n", "borderValue", "=", "0", ")", "\n", "\n", "zr", "=", "zr", "*", "cr", "\n", "xr", "=", "x", "*", "cr", "\n", "\n", "return", "zr", ",", "xr", ",", "cr", ",", "shift", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.evaluate_RealBlur.compute_psnr": [[60, 64], ["numpy.sum", "numpy.sum", "numpy.log10"], "function", ["None"], ["", "def", "compute_psnr", "(", "image_true", ",", "image_test", ",", "image_mask", ",", "data_range", "=", "None", ")", ":", "\n", "# this function is based on skimage.metrics.peak_signal_noise_ratio", "\n", "  ", "err", "=", "np", ".", "sum", "(", "(", "image_true", "-", "image_test", ")", "**", "2", ",", "dtype", "=", "np", ".", "float64", ")", "/", "np", ".", "sum", "(", "image_mask", ")", "\n", "return", "10", "*", "np", ".", "log10", "(", "(", "data_range", "**", "2", ")", "/", "err", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.evaluate_RealBlur.compute_ssim": [[66, 77], ["skimage.metrics.structural_similarity", "int", "numpy.mean", "np.mean.sum().sum", "crop_cr1.sum().sum", "np.mean.sum", "crop_cr1.sum"], "function", ["None"], ["", "def", "compute_ssim", "(", "tar_img", ",", "prd_img", ",", "cr1", ")", ":", "\n", "    ", "ssim_pre", ",", "ssim_map", "=", "structural_similarity", "(", "tar_img", ",", "prd_img", ",", "multichannel", "=", "True", ",", "gaussian_weights", "=", "True", ",", "use_sample_covariance", "=", "False", ",", "data_range", "=", "1.0", ",", "full", "=", "True", ")", "\n", "ssim_map", "=", "ssim_map", "*", "cr1", "\n", "r", "=", "int", "(", "3.5", "*", "1.5", "+", "0.5", ")", "# radius as in ndimage", "\n", "win_size", "=", "2", "*", "r", "+", "1", "\n", "pad", "=", "(", "win_size", "-", "1", ")", "//", "2", "\n", "ssim", "=", "ssim_map", "[", "pad", ":", "-", "pad", ",", "pad", ":", "-", "pad", ",", ":", "]", "\n", "crop_cr1", "=", "cr1", "[", "pad", ":", "-", "pad", ",", "pad", ":", "-", "pad", ",", ":", "]", "\n", "ssim", "=", "ssim", ".", "sum", "(", "axis", "=", "0", ")", ".", "sum", "(", "axis", "=", "0", ")", "/", "crop_cr1", ".", "sum", "(", "axis", "=", "0", ")", ".", "sum", "(", "axis", "=", "0", ")", "\n", "ssim", "=", "np", ".", "mean", "(", "ssim", ")", "\n", "return", "ssim", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.evaluate_RealBlur.proc": [[78, 91], ["skimage.io.imread", "skimage.io.imread", "evaluate_RealBlur.image_align", "evaluate_RealBlur.compute_psnr", "evaluate_RealBlur.compute_ssim", "io.imread.astype", "io.imread.astype"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.evaluate_RealBlur.image_align", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.evaluate_RealBlur.compute_psnr", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.evaluate_RealBlur.compute_ssim"], ["", "def", "proc", "(", "filename", ")", ":", "\n", "    ", "tar", ",", "prd", "=", "filename", "\n", "tar_img", "=", "io", ".", "imread", "(", "tar", ")", "\n", "prd_img", "=", "io", ".", "imread", "(", "prd", ")", "\n", "\n", "tar_img", "=", "tar_img", ".", "astype", "(", "np", ".", "float32", ")", "/", "255.0", "\n", "prd_img", "=", "prd_img", ".", "astype", "(", "np", ".", "float32", ")", "/", "255.0", "\n", "\n", "prd_img", ",", "tar_img", ",", "cr1", ",", "shift", "=", "image_align", "(", "prd_img", ",", "tar_img", ")", "\n", "\n", "PSNR", "=", "compute_psnr", "(", "tar_img", ",", "prd_img", ",", "cr1", ",", "data_range", "=", "1", ")", "\n", "SSIM", "=", "compute_ssim", "(", "tar_img", ",", "prd_img", ",", "cr1", ")", "\n", "return", "(", "PSNR", ",", "SSIM", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTrain.__init__": [[14, 27], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "len", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["    ", "def", "__init__", "(", "self", ",", "rgb_dir", ",", "img_options", "=", "None", ")", ":", "\n", "        ", "super", "(", "DataLoaderTrain", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "inp_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ")", ")", ")", "\n", "tar_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ")", ")", ")", "\n", "\n", "self", ".", "inp_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "img_options", "=", "img_options", "\n", "self", ".", "sizex", "=", "len", "(", "self", ".", "tar_filenames", ")", "# get the size of target", "\n", "\n", "self", ".", "ps", "=", "self", ".", "img_options", "[", "'patch_size'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTrain.__len__": [[28, 30], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "sizex", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTrain.__getitem__": [[31, 100], ["PIL.Image.open", "PIL.Image.open", "random.randint", "random.randint", "torchvision.to_tensor", "torchvision.to_tensor", "random.randint", "random.randint", "random.randint", "torchvision.pad", "torchvision.pad", "torchvision.adjust_gamma", "torchvision.adjust_gamma", "torchvision.adjust_saturation", "torchvision.adjust_saturation", "torch.rot90.flip", "torch.rot90.flip", "os.path.splitext", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "os.path.split", "numpy.random.rand", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "index_", "=", "index", "%", "self", ".", "sizex", "\n", "ps", "=", "self", ".", "ps", "\n", "\n", "inp_path", "=", "self", ".", "inp_filenames", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames", "[", "index_", "]", "\n", "\n", "inp_img", "=", "Image", ".", "open", "(", "inp_path", ")", "\n", "tar_img", "=", "Image", ".", "open", "(", "tar_path", ")", "\n", "\n", "w", ",", "h", "=", "tar_img", ".", "size", "\n", "padw", "=", "ps", "-", "w", "if", "w", "<", "ps", "else", "0", "\n", "padh", "=", "ps", "-", "h", "if", "h", "<", "ps", "else", "0", "\n", "\n", "# Reflect Pad in case image is smaller than patch_size", "\n", "if", "padw", "!=", "0", "or", "padh", "!=", "0", ":", "\n", "            ", "inp_img", "=", "TF", ".", "pad", "(", "inp_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "tar_img", "=", "TF", ".", "pad", "(", "tar_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "TF", ".", "adjust_gamma", "(", "inp_img", ",", "1", ")", "\n", "tar_img", "=", "TF", ".", "adjust_gamma", "(", "tar_img", ",", "1", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "sat_factor", "=", "1", "+", "(", "0.2", "-", "0.4", "*", "np", ".", "random", ".", "rand", "(", ")", ")", "\n", "inp_img", "=", "TF", ".", "adjust_saturation", "(", "inp_img", ",", "sat_factor", ")", "\n", "tar_img", "=", "TF", ".", "adjust_saturation", "(", "tar_img", ",", "sat_factor", ")", "\n", "\n", "", "inp_img", "=", "TF", ".", "to_tensor", "(", "inp_img", ")", "\n", "tar_img", "=", "TF", ".", "to_tensor", "(", "tar_img", ")", "\n", "\n", "hh", ",", "ww", "=", "tar_img", ".", "shape", "[", "1", "]", ",", "tar_img", ".", "shape", "[", "2", "]", "\n", "\n", "rr", "=", "random", ".", "randint", "(", "0", ",", "hh", "-", "ps", ")", "\n", "cc", "=", "random", ".", "randint", "(", "0", ",", "ww", "-", "ps", ")", "\n", "aug", "=", "random", ".", "randint", "(", "0", ",", "8", ")", "\n", "\n", "# Crop patch", "\n", "inp_img", "=", "inp_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "tar_img", "=", "tar_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "\n", "# Data Augmentations", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "1", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "1", ")", "\n", "", "elif", "aug", "==", "2", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "2", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "2", ")", "\n", "", "elif", "aug", "==", "3", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "4", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "", "elif", "aug", "==", "5", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "3", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "3", ")", "\n", "", "elif", "aug", "==", "6", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "7", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "\n", "", "filename", "=", "os", ".", "path", ".", "splitext", "(", "os", ".", "path", ".", "split", "(", "tar_path", ")", "[", "-", "1", "]", ")", "[", "0", "]", "\n", "\n", "return", "tar_img", ",", "inp_img", ",", "filename", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTrain_all.__init__": [[102, 127], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "sorted", "sorted", "sorted", "sorted", "len", "len", "len", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["    ", "def", "__init__", "(", "self", ",", "rgb_dir", ",", "img_options", "=", "None", ")", ":", "\n", "        ", "super", "(", "DataLoaderTrain_all", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "inp_files_noise", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_noise", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'target'", ")", ")", ")", "\n", "inp_files_blur", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_blur", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'target'", ")", ")", ")", "\n", "inp_files_rain", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_rain", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'target'", ")", ")", ")", "\n", "\n", "self", ".", "inp_filenames_noise", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_noise", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_noise", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_noise", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "inp_filenames_blur", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_blur", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_blur", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_blur", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "inp_filenames_rain", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_rain", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_rain", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_rain", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "img_options", "=", "img_options", "\n", "self", ".", "sizex_noise", "=", "len", "(", "self", ".", "tar_filenames_noise", ")", "# get the size of target", "\n", "self", ".", "sizex_blur", "=", "len", "(", "self", ".", "tar_filenames_blur", ")", "\n", "self", ".", "sizex_rain", "=", "len", "(", "self", ".", "tar_filenames_rain", ")", "\n", "\n", "self", ".", "ps_noise", "=", "self", ".", "img_options", "[", "'patch_size_noise'", "]", "\n", "self", ".", "ps_blur", "=", "self", ".", "img_options", "[", "'patch_size_blur'", "]", "\n", "self", ".", "ps_rain", "=", "self", ".", "img_options", "[", "'patch_size_rain'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTrain_all.__len__": [[128, 130], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "sizex_blur", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTrain_all.__getitem__": [[131, 211], ["numpy.random.randint", "PIL.Image.open", "PIL.Image.open", "random.randint", "random.randint", "torchvision.to_tensor", "torchvision.to_tensor", "random.randint", "random.randint", "random.randint", "torchvision.pad", "torchvision.pad", "torchvision.adjust_gamma", "torchvision.adjust_gamma", "torchvision.adjust_saturation", "torchvision.adjust_saturation", "torch.rot90.flip", "torch.rot90.flip", "os.path.splitext", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "os.path.split", "numpy.random.rand", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "id_", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "3", ")", "\n", "if", "id_", "==", "0", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_noise", "\n", "ps", "=", "self", ".", "ps_noise", "\n", "inp_path", "=", "self", ".", "inp_filenames_noise", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_noise", "[", "index_", "]", "\n", "", "elif", "id_", "==", "1", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_blur", "\n", "ps", "=", "self", ".", "ps_blur", "\n", "inp_path", "=", "self", ".", "inp_filenames_blur", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_blur", "[", "index_", "]", "\n", "", "else", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_rain", "\n", "ps", "=", "self", ".", "ps_rain", "\n", "inp_path", "=", "self", ".", "inp_filenames_rain", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_rain", "[", "index_", "]", "\n", "\n", "", "inp_img", "=", "Image", ".", "open", "(", "inp_path", ")", "\n", "tar_img", "=", "Image", ".", "open", "(", "tar_path", ")", "\n", "\n", "w", ",", "h", "=", "tar_img", ".", "size", "\n", "padw", "=", "ps", "-", "w", "if", "w", "<", "ps", "else", "0", "\n", "padh", "=", "ps", "-", "h", "if", "h", "<", "ps", "else", "0", "\n", "\n", "# Reflect Pad in case image is smaller than patch_size", "\n", "if", "padw", "!=", "0", "or", "padh", "!=", "0", ":", "\n", "            ", "inp_img", "=", "TF", ".", "pad", "(", "inp_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "tar_img", "=", "TF", ".", "pad", "(", "tar_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "TF", ".", "adjust_gamma", "(", "inp_img", ",", "1", ")", "\n", "tar_img", "=", "TF", ".", "adjust_gamma", "(", "tar_img", ",", "1", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "sat_factor", "=", "1", "+", "(", "0.2", "-", "0.4", "*", "np", ".", "random", ".", "rand", "(", ")", ")", "\n", "inp_img", "=", "TF", ".", "adjust_saturation", "(", "inp_img", ",", "sat_factor", ")", "\n", "tar_img", "=", "TF", ".", "adjust_saturation", "(", "tar_img", ",", "sat_factor", ")", "\n", "\n", "", "inp_img", "=", "TF", ".", "to_tensor", "(", "inp_img", ")", "\n", "tar_img", "=", "TF", ".", "to_tensor", "(", "tar_img", ")", "\n", "\n", "hh", ",", "ww", "=", "tar_img", ".", "shape", "[", "1", "]", ",", "tar_img", ".", "shape", "[", "2", "]", "\n", "\n", "rr", "=", "random", ".", "randint", "(", "0", ",", "hh", "-", "ps", ")", "\n", "cc", "=", "random", ".", "randint", "(", "0", ",", "ww", "-", "ps", ")", "\n", "aug", "=", "random", ".", "randint", "(", "0", ",", "8", ")", "\n", "\n", "# Crop patch", "\n", "inp_img", "=", "inp_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "tar_img", "=", "tar_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "\n", "# Data Augmentations", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "1", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "1", ")", "\n", "", "elif", "aug", "==", "2", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "2", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "2", ")", "\n", "", "elif", "aug", "==", "3", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "4", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "", "elif", "aug", "==", "5", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "3", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "3", ")", "\n", "", "elif", "aug", "==", "6", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "7", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "\n", "", "filename", "=", "os", ".", "path", ".", "splitext", "(", "os", ".", "path", ".", "split", "(", "tar_path", ")", "[", "-", "1", "]", ")", "[", "0", "]", "\n", "\n", "return", "tar_img", ",", "inp_img", ",", "filename", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderVal.__init__": [[213, 226], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "len", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["    ", "def", "__init__", "(", "self", ",", "rgb_dir", ",", "img_options", "=", "None", ",", "rgb_dir2", "=", "None", ")", ":", "\n", "        ", "super", "(", "DataLoaderVal", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "inp_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ")", ")", ")", "\n", "tar_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ")", ")", ")", "\n", "\n", "self", ".", "inp_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "img_options", "=", "img_options", "\n", "self", ".", "sizex", "=", "len", "(", "self", ".", "tar_filenames", ")", "# get the size of target", "\n", "\n", "self", ".", "ps", "=", "self", ".", "img_options", "[", "'patch_size'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderVal.__len__": [[227, 229], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "sizex", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderVal.__getitem__": [[230, 251], ["PIL.Image.open", "PIL.Image.open", "torchvision.to_tensor", "torchvision.to_tensor", "torchvision.center_crop", "torchvision.center_crop", "os.path.splitext", "os.path.split"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "index_", "=", "index", "%", "self", ".", "sizex", "\n", "ps", "=", "self", ".", "ps", "\n", "\n", "inp_path", "=", "self", ".", "inp_filenames", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames", "[", "index_", "]", "\n", "\n", "inp_img", "=", "Image", ".", "open", "(", "inp_path", ")", "\n", "tar_img", "=", "Image", ".", "open", "(", "tar_path", ")", "\n", "\n", "# Validate on center crop", "\n", "if", "self", ".", "ps", "is", "not", "None", ":", "\n", "            ", "inp_img", "=", "TF", ".", "center_crop", "(", "inp_img", ",", "(", "ps", ",", "ps", ")", ")", "\n", "tar_img", "=", "TF", ".", "center_crop", "(", "tar_img", ",", "(", "ps", ",", "ps", ")", ")", "\n", "\n", "", "inp_img", "=", "TF", ".", "to_tensor", "(", "inp_img", ")", "\n", "tar_img", "=", "TF", ".", "to_tensor", "(", "tar_img", ")", "\n", "\n", "filename", "=", "os", ".", "path", ".", "splitext", "(", "os", ".", "path", ".", "split", "(", "tar_path", ")", "[", "-", "1", "]", ")", "[", "0", "]", "\n", "\n", "return", "tar_img", ",", "inp_img", ",", "filename", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTest.__init__": [[293, 301], ["torch.utils.data.Dataset.__init__", "sorted", "len", "os.listdir", "os.path.join", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["    ", "def", "__init__", "(", "self", ",", "inp_dir", ",", "img_options", ")", ":", "\n", "        ", "super", "(", "DataLoaderTest", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "inp_files", "=", "sorted", "(", "os", ".", "listdir", "(", "inp_dir", ")", ")", "\n", "self", ".", "inp_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "inp_dir", ",", "x", ")", "for", "x", "in", "inp_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "inp_size", "=", "len", "(", "self", ".", "inp_filenames", ")", "\n", "self", ".", "img_options", "=", "img_options", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTest.__len__": [[302, 304], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "inp_size", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.DataLoaderTest.__getitem__": [[305, 313], ["PIL.Image.open", "torchvision.to_tensor", "os.path.splitext", "os.path.split"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "\n", "        ", "path_inp", "=", "self", ".", "inp_filenames", "[", "index", "]", "\n", "filename", "=", "os", ".", "path", ".", "splitext", "(", "os", ".", "path", ".", "split", "(", "path_inp", ")", "[", "-", "1", "]", ")", "[", "0", "]", "\n", "inp", "=", "Image", ".", "open", "(", "path_inp", ")", "\n", "\n", "inp", "=", "TF", ".", "to_tensor", "(", "inp", ")", "\n", "return", "inp", ",", "filename", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.dataset_RGB.is_image_file": [[10, 12], ["any", "filename.endswith"], "function", ["None"], ["def", "is_image_file", "(", "filename", ")", ":", "\n", "    ", "return", "any", "(", "filename", ".", "endswith", "(", "extension", ")", "for", "extension", "in", "[", "'jpeg'", ",", "'JPEG'", ",", "'jpg'", ",", "'png'", ",", "'JPG'", ",", "'PNG'", ",", "'gif'", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.losses.CharbonnierLoss.__init__": [[8, 11], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["def", "__init__", "(", "self", ",", "eps", "=", "1e-3", ")", ":", "\n", "        ", "super", "(", "CharbonnierLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "eps", "=", "eps", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.losses.CharbonnierLoss.forward": [[12, 17], ["torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "diff", "=", "x", "-", "y", "\n", "# loss = torch.sum(torch.sqrt(diff * diff + self.eps))", "\n", "loss", "=", "torch", ".", "mean", "(", "torch", ".", "sqrt", "(", "(", "diff", "*", "diff", ")", "+", "(", "self", ".", "eps", "*", "self", ".", "eps", ")", ")", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.losses.EdgeLoss.__init__": [[19, 26], ["torch.Module.__init__", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "losses.CharbonnierLoss", "losses.EdgeLoss.kernel.cuda", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.Tensor.t", "torch.Tensor.t", "torch.Tensor.t"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "EdgeLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "k", "=", "torch", ".", "Tensor", "(", "[", "[", ".05", ",", ".25", ",", ".4", ",", ".25", ",", ".05", "]", "]", ")", "\n", "self", ".", "kernel", "=", "torch", ".", "matmul", "(", "k", ".", "t", "(", ")", ",", "k", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "3", ",", "1", ",", "1", ",", "1", ")", "\n", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", ":", "\n", "            ", "self", ".", "kernel", "=", "self", ".", "kernel", ".", "cuda", "(", ")", "\n", "", "self", ".", "loss", "=", "CharbonnierLoss", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.losses.EdgeLoss.conv_gauss": [[27, 31], ["torch.pad", "torch.pad", "torch.pad", "torch.conv2d", "torch.conv2d", "torch.conv2d"], "methods", ["None"], ["", "def", "conv_gauss", "(", "self", ",", "img", ")", ":", "\n", "        ", "n_channels", ",", "_", ",", "kw", ",", "kh", "=", "self", ".", "kernel", ".", "shape", "\n", "img", "=", "F", ".", "pad", "(", "img", ",", "(", "kw", "//", "2", ",", "kh", "//", "2", ",", "kw", "//", "2", ",", "kh", "//", "2", ")", ",", "mode", "=", "'replicate'", ")", "\n", "return", "F", ".", "conv2d", "(", "img", ",", "self", ".", "kernel", ",", "groups", "=", "n_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.losses.EdgeLoss.laplacian_kernel": [[32, 40], ["losses.EdgeLoss.conv_gauss", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "losses.EdgeLoss.conv_gauss"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss"], ["", "def", "laplacian_kernel", "(", "self", ",", "current", ")", ":", "\n", "        ", "filtered", "=", "self", ".", "conv_gauss", "(", "current", ")", "# filter", "\n", "down", "=", "filtered", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "# downsample", "\n", "new_filter", "=", "torch", ".", "zeros_like", "(", "filtered", ")", "\n", "new_filter", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "=", "down", "*", "4", "# upsample", "\n", "filtered", "=", "self", ".", "conv_gauss", "(", "new_filter", ")", "# filter", "\n", "diff", "=", "current", "-", "filtered", "\n", "return", "diff", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deblurring.losses.EdgeLoss.forward": [[41, 44], ["losses.EdgeLoss.loss", "losses.EdgeLoss.laplacian_kernel", "losses.EdgeLoss.laplacian_kernel"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "loss", "=", "self", ".", "loss", "(", "self", ".", "laplacian_kernel", "(", "x", ")", ",", "self", ".", "laplacian_kernel", "(", "y", ")", ")", "\n", "return", "loss", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.config.Config.__init__": [[56, 90], ["yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "config.Config._C.merge_from_file", "config.Config._C.merge_from_list", "config.Config._C.freeze"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.freeze"], ["def", "__init__", "(", "self", ",", "config_yaml", ":", "str", ",", "config_override", ":", "List", "[", "Any", "]", "=", "[", "]", ")", ":", "\n", "\n", "        ", "self", ".", "_C", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "GPU", "=", "[", "0", "]", "\n", "self", ".", "_C", ".", "VERBOSE", "=", "False", "\n", "\n", "self", ".", "_C", ".", "MODEL", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "MODEL", ".", "MODE", "=", "'global'", "\n", "self", ".", "_C", ".", "MODEL", ".", "SESSION", "=", "'ps128_bs1'", "\n", "\n", "self", ".", "_C", ".", "OPTIM", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BATCH_SIZE", "=", "1", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NUM_EPOCHS", "=", "100", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NEPOCH_DECAY", "=", "[", "100", "]", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_INITIAL", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_MIN", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BETA1", "=", "0.5", "\n", "\n", "self", ".", "_C", ".", "TRAINING", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_AFTER_EVERY", "=", "3", "\n", "self", ".", "_C", ".", "TRAINING", ".", "RESUME", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_IMAGES", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_DIR", "=", "'images_dir/train'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_DIR", "=", "'images_dir/val'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_DIR", "=", "'checkpoints'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_PS", "=", "64", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_PS", "=", "64", "\n", "\n", "# Override parameter values from YAML file first, then from override list.", "\n", "self", ".", "_C", ".", "merge_from_file", "(", "config_yaml", ")", "\n", "self", ".", "_C", ".", "merge_from_list", "(", "config_override", ")", "\n", "\n", "# Make an instantiated object of this class immutable.", "\n", "self", ".", "_C", ".", "freeze", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.config.Config.dump": [[91, 100], ["config.Config._C.dump", "open"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.dump"], ["", "def", "dump", "(", "self", ",", "file_path", ":", "str", ")", ":", "\n", "        ", "r\"\"\"Save config at the specified file path.\n\n        Parameters\n        ----------\n        file_path: str\n            (YAML) path to save config at.\n        \"\"\"", "\n", "self", ".", "_C", ".", "dump", "(", "stream", "=", "open", "(", "file_path", ",", "\"w\"", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.config.Config.__getattr__": [[101, 103], ["config.Config._C.__getattr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__getattr__"], ["", "def", "__getattr__", "(", "self", ",", "attr", ":", "str", ")", ":", "\n", "        ", "return", "self", ".", "_C", ".", "__getattr__", "(", "attr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.config.Config.__repr__": [[104, 106], ["config.Config._C.__repr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__repr__"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "_C", ".", "__repr__", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.data_RGB.get_training_data": [[4, 7], ["os.path.exists", "dataset_RGB.DataLoaderTrain"], "function", ["None"], ["def", "get_training_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderTrain", "(", "rgb_dir", ",", "img_options", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.data_RGB.get_validation_data": [[8, 11], ["os.path.exists", "dataset_RGB.DataLoaderVal"], "function", ["None"], ["", "def", "get_training_data_all", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "for", "dir", "in", "rgb_dir", ":", "\n", "        ", "assert", "os", ".", "path", ".", "exists", "(", "dir", ")", "\n", "", "return", "DataLoaderTrain_all", "(", "rgb_dir", ",", "img_options", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.data_RGB.get_test_data": [[12, 15], ["os.path.exists", "dataset_RGB.DataLoaderTest"], "function", ["None"], ["\n", "", "def", "get_validation_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderVal", "(", "rgb_dir", ",", "img_options", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.ResBlock.__init__": [[29, 47], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet_plus.conv", "DGUNet_plus.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Block (CAB)", "\n", "", "", "class", "CAB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.ResBlock.forward": [[48, 53], ["DGUNet_plus.ResBlock.body().mul", "DGUNet_plus.ResBlock.body"], "methods", ["None"], ["modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.CAB.__init__": [[58, 67], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet_plus.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["\n", "\n", "##########################################################################", "\n", "## Supervised Attention Module", "\n", "", "", "class", "SAM", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.CAB.forward": [[68, 73], ["DGUNet_plus.CAB.body", "DGUNet_plus.CAB.CA"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n", "x2", "=", "torch", ".", "sigmoid", "(", "self", ".", "conv3", "(", "img", ")", ")", "\n", "x1", "=", "x1", "*", "x2", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.CALayer.__init__": [[76, 86], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["\n", "", "", "class", "UNetConvBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_1", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.CALayer.forward": [[88, 92], ["DGUNet_plus.CALayer.avg_pool", "DGUNet_plus.CALayer.conv_du"], "methods", ["None"], ["\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "csff_dec", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.SAM.__init__": [[97, 101], ["torch.Module.__init__", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.SAM.forward": [[102, 107], ["DGUNet_plus.SAM.conv1", "DGUNet_plus.SAM.conv2"], "methods", ["None"], ["\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n", "", "out", "=", "self", ".", "relu_1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_2", "(", "self", ".", "conv_2", "(", "out", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.mergeblock.__init__": [[110, 115], ["torch.Module.__init__", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n", "", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.mergeblock.forward": [[116, 132], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.mergeblock.subnet", "DGUNet_plus.mergeblock.view", "DGUNet_plus.mergeblock.view.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.mergeblock.conv_block", "torch.matmul().permute().view.view.permute", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul"], "methods", ["None"], ["return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n", "\n", "", "", "", "class", "UNetUpBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.Encoder.__init__": [[137, 144], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.UNetConvBlock", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.Encoder.forward": [[145, 162], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "return", "res", ",", "x", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.UNetConvBlock.__init__": [[165, 188], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet_plus.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["", "", "class", "Decoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "##---------- Resizing Modules ----------", "\n", "", "", "class", "DownSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.UNetConvBlock.forward": [[189, 208], ["DGUNet_plus.UNetConvBlock.conv_1", "DGUNet_plus.UNetConvBlock.relu_1", "DGUNet_plus.UNetConvBlock.relu_2", "DGUNet_plus.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetConvBlock.conv_2", "torch.leaky_relu", "torch.leaky_relu", "torch.leaky_relu", "DGUNet_plus.UNetConvBlock.downsample", "DGUNet_plus.UNetConvBlock.norm", "DGUNet_plus.UNetConvBlock.csff_enc", "DGUNet_plus.UNetConvBlock.csff_dec", "DGUNet_plus.UNetConvBlock.gamma", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet_plus.UNetConvBlock.phi"], "methods", ["None"], ["self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "UpSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "SkipUpSample", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.UNetUpBlock.__init__": [[211, 215], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.UNetUpBlock.forward": [[216, 221], ["DGUNet_plus.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetUpBlock.conv_block"], "methods", ["None"], ["x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n", "\n", "##########################################################################", "\n", "## Original Resolution Block (ORB)", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.Decoder.__init__": [[224, 232], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Decoder.body.append", "DGUNet_plus.Decoder.skip_conv.append", "DGUNet_plus.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.Decoder.forward": [[233, 240], ["enumerate", "up", "res.append"], "methods", ["None"], ["return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "", "", "class", "ORSNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORSNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.DownSample.__init__": [[245, 249], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n", "self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.DownSample.forward": [[250, 253], ["DGUNet_plus.DownSample.down"], "methods", ["None"], ["self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.UpSample.__init__": [[256, 260], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.UpSample.forward": [[261, 264], ["DGUNet_plus.UpSample.up"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n", "        ", "x", "=", "self", ".", "orb1", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc1", "(", "encoder_outs", "[", "0", "]", ")", "+", "self", ".", "conv_dec1", "(", "decoder_outs", "[", "-", "1", "]", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.DGUNet.__init__": [[269, 345], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.conv", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n", "", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n", "", "class", "ResBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n", "bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "act", ")", "\n", "\n", "", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "m", ")", "\n", "self", ".", "res_scale", "=", "res_scale", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n", "##########################################################################", "\n", "", "", "class", "MPRBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.DGUNet.forward": [[346, 436], ["DGUNet_plus.DGUNet.shallow_feat1", "DGUNet_plus.DGUNet.stage1_encoder", "DGUNet_plus.DGUNet.stage1_decoder", "DGUNet_plus.DGUNet.sam12", "DGUNet_plus.DGUNet.shallow_feat2", "DGUNet_plus.DGUNet.merge12", "DGUNet_plus.DGUNet.stage2_encoder", "DGUNet_plus.DGUNet.stage2_decoder", "DGUNet_plus.DGUNet.sam23", "DGUNet_plus.DGUNet.shallow_feat3", "DGUNet_plus.DGUNet.merge23", "DGUNet_plus.DGUNet.stage3_encoder", "DGUNet_plus.DGUNet.stage3_decoder", "DGUNet_plus.DGUNet.sam34", "DGUNet_plus.DGUNet.shallow_feat4", "DGUNet_plus.DGUNet.merge34", "DGUNet_plus.DGUNet.stage4_encoder", "DGUNet_plus.DGUNet.stage4_decoder", "DGUNet_plus.DGUNet.sam45", "DGUNet_plus.DGUNet.shallow_feat5", "DGUNet_plus.DGUNet.merge45", "DGUNet_plus.DGUNet.stage5_encoder", "DGUNet_plus.DGUNet.stage5_decoder", "DGUNet_plus.DGUNet.sam56", "DGUNet_plus.DGUNet.shallow_feat6", "DGUNet_plus.DGUNet.merge56", "DGUNet_plus.DGUNet.stage6_encoder", "DGUNet_plus.DGUNet.stage6_decoder", "DGUNet_plus.DGUNet.sam67", "DGUNet_plus.DGUNet.shallow_feat7", "DGUNet_plus.DGUNet.merge67", "DGUNet_plus.DGUNet.phi_0", "DGUNet_plus.DGUNet.phi_1", "DGUNet_plus.DGUNet.phi_2", "DGUNet_plus.DGUNet.phi_3", "DGUNet_plus.DGUNet.phi_4", "DGUNet_plus.DGUNet.phi_5", "DGUNet_plus.DGUNet.phi_6", "DGUNet_plus.DGUNet.tail", "DGUNet_plus.DGUNet.phit_0", "DGUNet_plus.DGUNet.phit_1", "DGUNet_plus.DGUNet.phit_2", "DGUNet_plus.DGUNet.phit_3", "DGUNet_plus.DGUNet.phit_4", "DGUNet_plus.DGUNet.phit_5", "DGUNet_plus.DGUNet.phit_6"], "methods", ["None"], ["##########################################################################", "\n", "", "", "class", "DGUNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "nums_stages", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "MPRBlock", "(", "\n", "in_c", "=", "in_c", ",", "out_c", "=", "in_c", ",", "n_feat", "=", "n_feat", ",", "scale_unetfeats", "=", "scale_unetfeats", ",", "kernel_size", "=", "kernel_size", ",", "\n", "reduction", "=", "reduction", ",", "bias", "=", "bias", "\n", ")", ")", "\n", "", "self", ".", "shallow_feat_final", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage1_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "False", ")", "\n", "self", ".", "stage1_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam12", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "r0", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "self", ".", "r_final", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat_final", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "tail", "=", "conv", "(", "n_feat", "+", "scale_orsnetfeats", ",", "out_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "img", ")", ":", "\n", "        ", "output_", "=", "[", "]", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 1---------------------", "\n", "##-------------------------------------------", "\n", "b", ",", "c", ",", "w", ",", "h", "=", "img", ".", "shape", "\n", "PhiTPhi", "=", "torch", ".", "mm", "(", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ",", "self", ".", "Phi", ")", "# torch.mm(Phix, Phi)", "\n", "Phix", "=", "torch", ".", "mm", "(", "img", ".", "view", "(", "b", ",", "-", "1", ")", ",", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ")", "# compression result", "\n", "PhiTb", "=", "torch", ".", "mm", "(", "Phix", ",", "self", ".", "Phi", ")", "\n", "# compute r_0", "\n", "x_0", "=", "PhiTb", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_0", "-", "self", ".", "r0", "*", "torch", ".", "mm", "(", "x_0", ",", "PhiTPhi", ")", "\n", "r_0", "=", "x", "+", "self", ".", "r0", "*", "PhiTb", "\n", "r_0", "=", "r_0", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat1", "(", "r_0", ")", "\n", "## Process features of all 4 patches with Encoder of Stage 1", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage1_encoder", "(", "x", ")", "\n", "## Pass features through Decoder of Stage 1", "\n", "f_decoder", "=", "self", ".", "stage1_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply Supervised Attention Module (SAM)", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam12", "(", "f_decoder", "[", "-", "1", "]", ",", "r_0", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 2_k-1---------------------", "\n", "##-------------------------------------------", "\n", "for", "stage_model", "in", "self", ".", "body", ":", "\n", "            ", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "=", "stage_model", "(", "stage_img", ",", "img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "##-------------------------------------------", "\n", "##-------------- Stage k---------------------", "\n", "##-------------------------------------------", "\n", "# compute r_k", "\n", "", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_k_1", "-", "self", ".", "r_final", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r_final", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat_final", "(", "r_k", ")", "\n", "## Concatenate SAM features", "\n", "x_cat", "=", "self", ".", "concat_final", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "stage_img", "=", "self", ".", "tail", "(", "x_cat", ")", "+", "r_k", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "return", "output_", "[", ":", ":", "-", "1", "]", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.conv": [[11, 15], ["torch.Conv2d"], "function", ["None"], ["    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n", "\n", "", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.conv_down": [[17, 20], ["torch.Conv2d"], "function", ["None"], ["return", "layer", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Layer", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet_plus.default_conv": [[22, 26], ["torch.Conv2d"], "function", ["None"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.ResBlock.__init__": [[27, 45], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet.conv", "DGUNet.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Block (CAB)", "\n", "", "", "class", "CAB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.ResBlock.forward": [[46, 51], ["DGUNet.ResBlock.body().mul", "DGUNet.ResBlock.body"], "methods", ["None"], ["modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.CAB.__init__": [[56, 65], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["res", "+=", "x", "\n", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "## Supervised Attention Module", "\n", "", "", "class", "SAM", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.CAB.forward": [[66, 71], ["DGUNet.CAB.body", "DGUNet.CAB.CA"], "methods", ["None"], ["self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.CALayer.__init__": [[74, 84], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["x1", "=", "x1", "+", "x", "\n", "return", "x1", ",", "img", "\n", "\n", "", "", "class", "UNetConvBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.CALayer.forward": [[86, 90], ["DGUNet.CALayer.avg_pool", "DGUNet.CALayer.conv_du"], "methods", ["None"], ["self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_2", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.SAM.__init__": [[95, 99], ["torch.Module.__init__", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["", "self", ".", "use_HIN", "=", "use_HIN", "\n", "\n", "if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.SAM.forward": [[100, 105], ["DGUNet.SAM.conv1", "DGUNet.SAM.conv2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n", "\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.mergeblock.__init__": [[108, 113], ["torch.Module.__init__", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["\n", "out", "+=", "self", ".", "identity", "(", "x", ")", "\n", "if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.mergeblock.forward": [[114, 130], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.mergeblock.subnet", "DGUNet.mergeblock.view", "DGUNet.mergeblock.view.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.mergeblock.conv_block", "torch.matmul().permute().view.view.permute", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul"], "methods", ["None"], ["", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n", "return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n", "\n", "", "", "", "class", "UNetUpBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.Encoder.__init__": [[135, 142], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Encoder.body.append", "DGUNet.Encoder.body.append", "DGUNet.UNetConvBlock", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["\n", "", "", "class", "Encoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.Encoder.forward": [[143, 160], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.UNetConvBlock.__init__": [[163, 186], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["\n", "\n", "", "", "class", "Decoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "##---------- Resizing Modules ----------", "\n", "", "", "class", "DownSample", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.UNetConvBlock.forward": [[187, 206], ["DGUNet.UNetConvBlock.conv_1", "DGUNet.UNetConvBlock.relu_1", "DGUNet.UNetConvBlock.relu_2", "DGUNet.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetConvBlock.conv_2", "torch.leaky_relu", "torch.leaky_relu", "torch.leaky_relu", "DGUNet.UNetConvBlock.downsample", "DGUNet.UNetConvBlock.norm", "DGUNet.UNetConvBlock.csff_enc", "DGUNet.UNetConvBlock.csff_dec", "DGUNet.UNetConvBlock.gamma", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet.UNetConvBlock.phi"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "UpSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.UNetUpBlock.__init__": [[209, 213], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "SkipUpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.UNetUpBlock.forward": [[214, 219], ["DGUNet.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetUpBlock.conv_block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.Decoder.__init__": [[222, 230], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Decoder.body.append", "DGUNet.Decoder.skip_conv.append", "DGUNet.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["", "", "class", "ORB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.Decoder.forward": [[231, 238], ["enumerate", "up", "res.append"], "methods", ["None"], ["        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "", "", "class", "ORSNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.DownSample.__init__": [[243, 247], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "orb3", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "\n", "self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.DownSample.forward": [[248, 251], ["DGUNet.DownSample.down"], "methods", ["None"], ["self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n", "self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.UpSample.__init__": [[254, 258], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "conv_enc1", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc2", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.UpSample.forward": [[259, 262], ["DGUNet.UpSample.up"], "methods", ["None"], ["self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.Basic_block.__init__": [[267, 281], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "DGUNet.ResBlock", "DGUNet.ResBlock", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.mergeblock", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["x", "=", "x", "+", "self", ".", "conv_enc2", "(", "self", ".", "up_enc1", "(", "encoder_outs", "[", "1", "]", ")", ")", "+", "self", ".", "conv_dec2", "(", "self", ".", "up_dec1", "(", "decoder_outs", "[", "-", "2", "]", ")", ")", "\n", "\n", "x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n", "", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n", "", "class", "ResBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.Basic_block.forward": [[282, 293], ["DGUNet.Basic_block.shallow_feat2", "DGUNet.Basic_block.merge12", "DGUNet.Basic_block.stage2_encoder", "DGUNet.Basic_block.stage2_decoder", "DGUNet.Basic_block.sam23", "DGUNet.Basic_block.phi_1", "DGUNet.Basic_block.phit_1"], "methods", ["None"], ["bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.DGUNet.__init__": [[297, 323], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "DGUNet.Basic_block", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "DGUNet.ResBlock", "DGUNet.ResBlock", "DGUNet.ResBlock", "DGUNet.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.conv", "DGUNet.conv", "DGUNet.CAB", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["self", ".", "res_scale", "=", "res_scale", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n", "##########################################################################", "\n", "", "", "class", "MPRBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.DGUNet.forward": [[324, 359], ["DGUNet.DGUNet.shallow_feat1", "DGUNet.DGUNet.stage1_encoder", "DGUNet.DGUNet.stage1_decoder", "DGUNet.DGUNet.sam12", "res.append", "range", "DGUNet.DGUNet.shallow_feat7", "DGUNet.DGUNet.concat67", "res.append", "DGUNet.DGUNet.phi_0", "DGUNet.DGUNet.basic", "res.append", "DGUNet.DGUNet.phi_6", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.DGUNet.tail", "DGUNet.DGUNet.phit_0", "DGUNet.DGUNet.phit_6"], "methods", ["None"], ["\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n", "##########################################################################", "\n", "", "", "class", "DGUNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "nums_stages", "=", "nums_stages", "\n", "self", ".", "stage_model", "=", "MPRBlock", "(", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.conv": [[9, 13], ["torch.Conv2d"], "function", ["None"], ["##########################################################################", "\n", "def", "conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "bias", "=", "False", ",", "stride", "=", "1", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.conv_down": [[15, 18], ["torch.Conv2d"], "function", ["None"], ["", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n", "    ", "layer", "=", "nn", ".", "Conv2d", "(", "in_chn", ",", "out_chn", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "bias", ")", "\n", "return", "layer", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.DGUNet.default_conv": [[20, 24], ["torch.Conv2d"], "function", ["None"], ["## Channel Attention Layer", "\n", "", "class", "CALayer", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.demo_DND.augment_img_tensor": [[45, 60], ["img.size", "img.data.cpu().numpy", "demo_DND.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["def", "augment_img_tensor", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "img_size", "=", "img", ".", "size", "(", ")", "\n", "img_np", "=", "img", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "1", ",", "2", ",", "0", ")", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "2", ",", "3", ",", "1", ",", "0", ")", ")", "\n", "", "img_np", "=", "augment_img", "(", "img_np", ",", "mode", "=", "mode", ")", "\n", "img_tensor", "=", "torch", ".", "from_numpy", "(", "np", ".", "ascontiguousarray", "(", "img_np", ")", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "3", ",", "2", ",", "0", ",", "1", ")", "\n", "\n", "", "return", "img_tensor", ".", "type_as", "(", "img", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.demo_DND.augment_img": [[62, 79], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["", "def", "augment_img", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "if", "mode", "==", "0", ":", "\n", "        ", "return", "img", "\n", "", "elif", "mode", "==", "1", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ")", ")", "\n", "", "elif", "mode", "==", "2", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "img", ")", "\n", "", "elif", "mode", "==", "3", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", "\n", "", "elif", "mode", "==", "4", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", ")", "\n", "", "elif", "mode", "==", "5", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ")", "\n", "", "elif", "mode", "==", "6", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", "\n", "", "elif", "mode", "==", "7", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.demo_DND.test_x8": [[80, 90], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "demo_DND.augment_img_tensor", "demo_DND.augment_img_tensor", "demo_DND.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["", "", "def", "test_x8", "(", "model", ",", "L", ")", ":", "\n", "    ", "E_list", "=", "[", "model", "(", "augment_img_tensor", "(", "L", ",", "mode", "=", "i", ")", ")", "[", "0", "]", "for", "i", "in", "range", "(", "8", ")", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "E_list", ")", ")", ":", "\n", "        ", "if", "i", "==", "3", "or", "i", "==", "5", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "8", "-", "i", ")", "\n", "", "else", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "i", ")", "\n", "", "", "output_cat", "=", "torch", ".", "stack", "(", "E_list", ",", "dim", "=", "0", ")", "\n", "E", "=", "output_cat", ".", "mean", "(", "dim", "=", "0", ",", "keepdim", "=", "False", ")", "\n", "return", "E", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_plus.augment_img_tensor": [[38, 53], ["img.size", "img.data.cpu().numpy", "test_plus.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["parser", ".", "add_argument", "(", "'--rb_num'", ",", "type", "=", "int", ",", "default", "=", "2", ",", "help", "=", "'from {3-10}'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--matrix_dir'", ",", "type", "=", "str", ",", "default", "=", "'sampling_matrix_new'", ",", "help", "=", "'sampling matrix directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--model_dir'", ",", "type", "=", "str", ",", "default", "=", "'model'", ",", "help", "=", "'trained or pre-trained model directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--data_dir'", ",", "type", "=", "str", ",", "default", "=", "'Datasets/train/BSD400'", ",", "help", "=", "'training data directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--ext'", ",", "type", "=", "str", ",", "default", "=", "'.png'", ",", "help", "=", "'training data directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--log_dir'", ",", "type", "=", "str", ",", "default", "=", "'log'", ",", "help", "=", "'log directory'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--algo_name'", ",", "type", "=", "str", ",", "default", "=", "'DGUNet_P32_s7_v7_hi3_u4_lm2_learn_BSD_DIV2K_fine'", ",", "help", "=", "'log directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--test_name'", ",", "type", "=", "str", ",", "default", "=", "'BSD68'", ",", "help", "=", "'name of test set'", ")", "\n", "# parser.add_argument('--test_name', type=str, default='Set11', help='name of test set')", "\n", "parser", ".", "add_argument", "(", "'--num_gpu'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'Number of GPU'", ")", "\n", "parser", ".", "add_argument", "(", "'--loss_mod'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'loss mode'", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_plus.augment_img": [[55, 72], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["end_epoch", "=", "args", ".", "end_epoch", "\n", "learning_rate", "=", "args", ".", "learning_rate", "\n", "layer_num_ICNN", "=", "args", ".", "layer_num_ICNN", "\n", "layer_num_IFC", "=", "args", ".", "layer_num_IFC", "\n", "group_num", "=", "args", ".", "group_num", "\n", "cs_ratio", "=", "args", ".", "cs_ratio", "\n", "gpu_list", "=", "args", ".", "gpu_list", "\n", "rb_type", "=", "args", ".", "rb_type", "\n", "rb_num", "=", "args", ".", "rb_num", "\n", "batch_size", "=", "args", ".", "batch_size", "\n", "\n", "# os.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"", "\n", "# os.environ[\"CUDA_VISIBLE_DEVICES\"] = gpu_list", "\n", "device", "=", "torch", ".", "device", "(", "\"cuda:0\"", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", "else", "\"cpu\"", ")", "\n", "\n", "ratio_dict", "=", "{", "10", ":", "0", ",", "25", ":", "1", ",", "30", ":", "2", ",", "40", ":", "3", ",", "50", ":", "4", "}", "\n", "\n", "# n_input = ratio_dict[cs_ratio]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_plus.test_x8": [[73, 83], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test_plus.augment_img_tensor", "test_plus.augment_img_tensor", "test_plus.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["n_output", "=", "1089", "\n", "nrtrain", "=", "88912", "# number of training blocks", "\n", "psnr_best", "=", "0", "\n", "best_epoch", "=", "0", "\n", "# test data", "\n", "test_name", "=", "args", ".", "test_name", "\n", "test_dir", "=", "os", ".", "path", ".", "join", "(", "'Datasets'", ",", "test_name", ")", "\n", "# filepaths = glob.glob(test_dir + '/*.tif')", "\n", "filepaths", "=", "glob", ".", "glob", "(", "test_dir", "+", "'/*.png'", ")", "\n", "ImgNum", "=", "len", "(", "filepaths", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test.augment_img_tensor": [[38, 53], ["img.size", "img.data.cpu().numpy", "test.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["parser", ".", "add_argument", "(", "'--n_channels'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'1 for gray, 3 for color'", ")", "\n", "parser", ".", "add_argument", "(", "'--rb_type'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'from {1, 2}'", ")", "\n", "parser", ".", "add_argument", "(", "'--rb_num'", ",", "type", "=", "int", ",", "default", "=", "2", ",", "help", "=", "'from {3-10}'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--matrix_dir'", ",", "type", "=", "str", ",", "default", "=", "'sampling_matrix_new'", ",", "help", "=", "'sampling matrix directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--model_dir'", ",", "type", "=", "str", ",", "default", "=", "'model'", ",", "help", "=", "'trained or pre-trained model directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--data_dir'", ",", "type", "=", "str", ",", "default", "=", "'Datasets/train/BSD400'", ",", "help", "=", "'training data directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--ext'", ",", "type", "=", "str", ",", "default", "=", "'.png'", ",", "help", "=", "'training data directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--log_dir'", ",", "type", "=", "str", ",", "default", "=", "'log'", ",", "help", "=", "'log directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--algo_name'", ",", "type", "=", "str", ",", "default", "=", "'DGUNet_P32_s7_v7_hi3_u4_rp_lm2_learn_BSD_DIV2K_fine'", ",", "help", "=", "'log directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--test_name'", ",", "type", "=", "str", ",", "default", "=", "'BSD68'", ",", "help", "=", "'name of test set'", ")", "\n", "parser", ".", "add_argument", "(", "'--num_gpu'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'Number of GPU'", ")", "\n", "parser", ".", "add_argument", "(", "'--loss_mod'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'loss mode'", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test.augment_img": [[55, 72], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["end_epoch", "=", "args", ".", "end_epoch", "\n", "learning_rate", "=", "args", ".", "learning_rate", "\n", "layer_num_ICNN", "=", "args", ".", "layer_num_ICNN", "\n", "layer_num_IFC", "=", "args", ".", "layer_num_IFC", "\n", "group_num", "=", "args", ".", "group_num", "\n", "cs_ratio", "=", "args", ".", "cs_ratio", "\n", "gpu_list", "=", "args", ".", "gpu_list", "\n", "rb_type", "=", "args", ".", "rb_type", "\n", "rb_num", "=", "args", ".", "rb_num", "\n", "batch_size", "=", "args", ".", "batch_size", "\n", "\n", "# os.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"", "\n", "# os.environ[\"CUDA_VISIBLE_DEVICES\"] = gpu_list", "\n", "device", "=", "torch", ".", "device", "(", "\"cuda:0\"", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", "else", "\"cpu\"", ")", "\n", "\n", "ratio_dict", "=", "{", "10", ":", "0", ",", "25", ":", "1", ",", "30", ":", "2", ",", "40", ":", "3", ",", "50", ":", "4", "}", "\n", "\n", "# n_input = ratio_dict[cs_ratio]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test.test_x8": [[73, 83], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test.augment_img_tensor", "test.augment_img_tensor", "test.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["n_output", "=", "1089", "\n", "nrtrain", "=", "88912", "# number of training blocks", "\n", "psnr_best", "=", "0", "\n", "best_epoch", "=", "0", "\n", "# test data", "\n", "test_name", "=", "args", ".", "test_name", "\n", "test_dir", "=", "os", ".", "path", ".", "join", "(", "'Datasets'", ",", "test_name", ")", "\n", "# filepaths = glob.glob(test_dir + '/*.tif')", "\n", "filepaths", "=", "glob", ".", "glob", "(", "test_dir", "+", "'/*.png'", ")", "\n", "ImgNum", "=", "len", "(", "filepaths", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderTrain.__init__": [[14, 27], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "len", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["    ", "def", "__init__", "(", "self", ",", "rgb_dir", ",", "img_options", "=", "None", ")", ":", "\n", "        ", "super", "(", "DataLoaderTrain", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "inp_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ")", ")", ")", "\n", "tar_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ")", ")", ")", "\n", "\n", "self", ".", "inp_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "img_options", "=", "img_options", "\n", "self", ".", "sizex", "=", "len", "(", "self", ".", "tar_filenames", ")", "# get the size of target", "\n", "\n", "self", ".", "ps", "=", "self", ".", "img_options", "[", "'patch_size'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderTrain.__len__": [[28, 30], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "sizex", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderTrain.__getitem__": [[31, 89], ["PIL.Image.open", "PIL.Image.open", "torchvision.to_tensor", "torchvision.to_tensor", "random.randint", "random.randint", "random.randint", "torchvision.pad", "torchvision.pad", "torch.rot90.flip", "torch.rot90.flip", "os.path.splitext", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "os.path.split", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "index_", "=", "index", "%", "self", ".", "sizex", "\n", "ps", "=", "self", ".", "ps", "\n", "\n", "inp_path", "=", "self", ".", "inp_filenames", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames", "[", "index_", "]", "\n", "\n", "inp_img", "=", "Image", ".", "open", "(", "inp_path", ")", "\n", "tar_img", "=", "Image", ".", "open", "(", "tar_path", ")", "\n", "\n", "w", ",", "h", "=", "tar_img", ".", "size", "\n", "padw", "=", "ps", "-", "w", "if", "w", "<", "ps", "else", "0", "\n", "padh", "=", "ps", "-", "h", "if", "h", "<", "ps", "else", "0", "\n", "\n", "# Reflect Pad in case image is smaller than patch_size", "\n", "if", "padw", "!=", "0", "or", "padh", "!=", "0", ":", "\n", "            ", "inp_img", "=", "TF", ".", "pad", "(", "inp_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "tar_img", "=", "TF", ".", "pad", "(", "tar_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "TF", ".", "adjust_gamma", "(", "inp_img", ",", "1", ")", "\n", "tar_img", "=", "TF", ".", "adjust_gamma", "(", "tar_img", ",", "1", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "sat_factor", "=", "1", "+", "(", "0.2", "-", "0.4", "*", "np", ".", "random", ".", "rand", "(", ")", ")", "\n", "inp_img", "=", "TF", ".", "adjust_saturation", "(", "inp_img", ",", "sat_factor", ")", "\n", "tar_img", "=", "TF", ".", "adjust_saturation", "(", "tar_img", ",", "sat_factor", ")", "\n", "\n", "", "inp_img", "=", "TF", ".", "to_tensor", "(", "inp_img", ")", "\n", "tar_img", "=", "TF", ".", "to_tensor", "(", "tar_img", ")", "\n", "\n", "hh", ",", "ww", "=", "tar_img", ".", "shape", "[", "1", "]", ",", "tar_img", ".", "shape", "[", "2", "]", "\n", "\n", "rr", "=", "random", ".", "randint", "(", "0", ",", "hh", "-", "ps", ")", "\n", "cc", "=", "random", ".", "randint", "(", "0", ",", "ww", "-", "ps", ")", "\n", "aug", "=", "random", ".", "randint", "(", "0", ",", "8", ")", "\n", "\n", "# Crop patch", "\n", "inp_img", "=", "inp_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "tar_img", "=", "tar_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "\n", "# Data Augmentations", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "1", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "1", ")", "\n", "", "elif", "aug", "==", "2", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "2", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "2", ")", "\n", "", "elif", "aug", "==", "3", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "4", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "", "elif", "aug", "==", "5", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "3", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "3", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderVal.__init__": [[91, 104], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "len", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "7", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "\n", "", "filename", "=", "os", ".", "path", ".", "splitext", "(", "os", ".", "path", ".", "split", "(", "tar_path", ")", "[", "-", "1", "]", ")", "[", "0", "]", "\n", "\n", "return", "tar_img", ",", "inp_img", ",", "filename", "\n", "\n", "", "", "class", "DataLoaderTrain_all", "(", "Dataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "rgb_dir", ",", "img_options", "=", "None", ")", ":", "\n", "        ", "super", "(", "DataLoaderTrain_all", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderVal.__len__": [[105, 107], ["None"], "methods", ["None"], ["inp_files_noise", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_noise", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'target'", ")", ")", ")", "\n", "inp_files_blur", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'input'", ")", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderVal.__getitem__": [[108, 129], ["PIL.Image.open", "PIL.Image.open", "torchvision.to_tensor", "torchvision.to_tensor", "torchvision.center_crop", "torchvision.center_crop", "os.path.splitext", "os.path.split"], "methods", ["None"], ["tar_files_blur", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'target'", ")", ")", ")", "\n", "inp_files_rain", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_rain", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'target'", ")", ")", ")", "\n", "\n", "self", ".", "inp_filenames_noise", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_noise", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_noise", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_noise", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "inp_filenames_blur", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_blur", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_blur", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_blur", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "inp_filenames_rain", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_rain", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_rain", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_rain", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "img_options", "=", "img_options", "\n", "self", ".", "sizex_noise", "=", "len", "(", "self", ".", "tar_filenames_noise", ")", "# get the size of target", "\n", "self", ".", "sizex_blur", "=", "len", "(", "self", ".", "tar_filenames_blur", ")", "\n", "self", ".", "sizex_rain", "=", "len", "(", "self", ".", "tar_filenames_rain", ")", "\n", "\n", "self", ".", "ps_noise", "=", "self", ".", "img_options", "[", "'patch_size_noise'", "]", "\n", "self", ".", "ps_blur", "=", "self", ".", "img_options", "[", "'patch_size_blur'", "]", "\n", "self", ".", "ps_rain", "=", "self", ".", "img_options", "[", "'patch_size_rain'", "]", "\n", "\n", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "sizex_blur", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderTest.__init__": [[131, 139], ["torch.utils.data.Dataset.__init__", "sorted", "len", "os.listdir", "os.path.join", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "id_", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "3", ")", "\n", "if", "id_", "==", "0", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_noise", "\n", "ps", "=", "self", ".", "ps_noise", "\n", "inp_path", "=", "self", ".", "inp_filenames_noise", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_noise", "[", "index_", "]", "\n", "", "elif", "id_", "==", "1", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_blur", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderTest.__len__": [[140, 142], ["None"], "methods", ["None"], ["ps", "=", "self", ".", "ps_blur", "\n", "inp_path", "=", "self", ".", "inp_filenames_blur", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_blur", "[", "index_", "]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.DataLoaderTest.__getitem__": [[143, 151], ["PIL.Image.open", "torchvision.to_tensor", "os.path.splitext", "os.path.split"], "methods", ["None"], ["", "else", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_rain", "\n", "ps", "=", "self", ".", "ps_rain", "\n", "inp_path", "=", "self", ".", "inp_filenames_rain", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_rain", "[", "index_", "]", "\n", "\n", "", "inp_img", "=", "Image", ".", "open", "(", "inp_path", ")", "\n", "tar_img", "=", "Image", ".", "open", "(", "tar_path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.dataset_RGB.is_image_file": [[10, 12], ["any", "filename.endswith"], "function", ["None"], ["def", "is_image_file", "(", "filename", ")", ":", "\n", "    ", "return", "any", "(", "filename", ".", "endswith", "(", "extension", ")", "for", "extension", "in", "[", "'jpeg'", ",", "'JPEG'", ",", "'jpg'", ",", "'png'", ",", "'JPG'", ",", "'PNG'", ",", "'gif'", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.generate_patches_SIDD.save_files": [[46, 61], ["cv2.imread", "cv2.imread", "range", "numpy.random.randint", "numpy.random.randint", "cv2.imwrite", "cv2.imwrite", "os.path.join", "os.path.join"], "function", ["None"], ["", "", "def", "save_files", "(", "i", ")", ":", "\n", "    ", "noisy_file", ",", "clean_file", "=", "noisy_files", "[", "i", "]", ",", "clean_files", "[", "i", "]", "\n", "noisy_img", "=", "cv2", ".", "imread", "(", "noisy_file", ")", "\n", "clean_img", "=", "cv2", ".", "imread", "(", "clean_file", ")", "\n", "\n", "H", "=", "noisy_img", ".", "shape", "[", "0", "]", "\n", "W", "=", "noisy_img", ".", "shape", "[", "1", "]", "\n", "for", "j", "in", "range", "(", "NUM_PATCHES", ")", ":", "\n", "        ", "rr", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "H", "-", "PS", ")", "\n", "cc", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "W", "-", "PS", ")", "\n", "noisy_patch", "=", "noisy_img", "[", "rr", ":", "rr", "+", "PS", ",", "cc", ":", "cc", "+", "PS", ",", ":", "]", "\n", "clean_patch", "=", "clean_img", "[", "rr", ":", "rr", "+", "PS", ",", "cc", ":", "cc", "+", "PS", ",", ":", "]", "\n", "\n", "cv2", ".", "imwrite", "(", "os", ".", "path", ".", "join", "(", "noisy_patchDir", ",", "'{}_{}.png'", ".", "format", "(", "i", "+", "1", ",", "j", "+", "1", ")", ")", ",", "noisy_patch", ")", "\n", "cv2", ".", "imwrite", "(", "os", ".", "path", ".", "join", "(", "clean_patchDir", ",", "'{}_{}.png'", ".", "format", "(", "i", "+", "1", ",", "j", "+", "1", ")", ")", ",", "clean_patch", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_DND.augment_img_tensor": [[53, 68], ["img.size", "img.data.cpu().numpy", "test_DND.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["def", "augment_img_tensor", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "img_size", "=", "img", ".", "size", "(", ")", "\n", "img_np", "=", "img", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "1", ",", "2", ",", "0", ")", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "2", ",", "3", ",", "1", ",", "0", ")", ")", "\n", "", "img_np", "=", "augment_img", "(", "img_np", ",", "mode", "=", "mode", ")", "\n", "img_tensor", "=", "torch", ".", "from_numpy", "(", "np", ".", "ascontiguousarray", "(", "img_np", ")", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "3", ",", "2", ",", "0", ",", "1", ")", "\n", "\n", "", "return", "img_tensor", ".", "type_as", "(", "img", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_DND.augment_img": [[70, 87], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["", "def", "augment_img", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "if", "mode", "==", "0", ":", "\n", "        ", "return", "img", "\n", "", "elif", "mode", "==", "1", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ")", ")", "\n", "", "elif", "mode", "==", "2", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "img", ")", "\n", "", "elif", "mode", "==", "3", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", "\n", "", "elif", "mode", "==", "4", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", ")", "\n", "", "elif", "mode", "==", "5", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ")", "\n", "", "elif", "mode", "==", "6", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", "\n", "", "elif", "mode", "==", "7", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_DND.test_x8": [[88, 98], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test_DND.augment_img_tensor", "test_DND.augment_img_tensor", "test_DND.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["", "", "def", "test_x8", "(", "model", ",", "L", ")", ":", "\n", "    ", "E_list", "=", "[", "model", "(", "augment_img_tensor", "(", "L", ",", "mode", "=", "i", ")", ")", "[", "0", "]", "for", "i", "in", "range", "(", "8", ")", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "E_list", ")", ")", ":", "\n", "        ", "if", "i", "==", "3", "or", "i", "==", "5", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "8", "-", "i", ")", "\n", "", "else", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "i", ")", "\n", "", "", "output_cat", "=", "torch", ".", "stack", "(", "E_list", ",", "dim", "=", "0", ")", "\n", "E", "=", "output_cat", ".", "mean", "(", "dim", "=", "0", ",", "keepdim", "=", "False", ")", "\n", "return", "E", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_DND_plus.augment_img_tensor": [[53, 68], ["img.size", "img.data.cpu().numpy", "test_DND_plus.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["def", "augment_img_tensor", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "img_size", "=", "img", ".", "size", "(", ")", "\n", "img_np", "=", "img", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "1", ",", "2", ",", "0", ")", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_np", "=", "np", ".", "transpose", "(", "img_np", ",", "(", "2", ",", "3", ",", "1", ",", "0", ")", ")", "\n", "", "img_np", "=", "augment_img", "(", "img_np", ",", "mode", "=", "mode", ")", "\n", "img_tensor", "=", "torch", ".", "from_numpy", "(", "np", ".", "ascontiguousarray", "(", "img_np", ")", ")", "\n", "if", "len", "(", "img_size", ")", "==", "3", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "", "elif", "len", "(", "img_size", ")", "==", "4", ":", "\n", "        ", "img_tensor", "=", "img_tensor", ".", "permute", "(", "3", ",", "2", ",", "0", ",", "1", ")", "\n", "\n", "", "return", "img_tensor", ".", "type_as", "(", "img", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_DND_plus.augment_img": [[70, 87], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["", "def", "augment_img", "(", "img", ",", "mode", "=", "0", ")", ":", "\n", "    ", "if", "mode", "==", "0", ":", "\n", "        ", "return", "img", "\n", "", "elif", "mode", "==", "1", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ")", ")", "\n", "", "elif", "mode", "==", "2", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "img", ")", "\n", "", "elif", "mode", "==", "3", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", "\n", "", "elif", "mode", "==", "4", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", ")", "\n", "", "elif", "mode", "==", "5", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ")", "\n", "", "elif", "mode", "==", "6", ":", "\n", "        ", "return", "np", ".", "rot90", "(", "img", ",", "k", "=", "2", ")", "\n", "", "elif", "mode", "==", "7", ":", "\n", "        ", "return", "np", ".", "flipud", "(", "np", ".", "rot90", "(", "img", ",", "k", "=", "3", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.test_DND_plus.test_x8": [[88, 98], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test_DND_plus.augment_img_tensor", "test_DND_plus.augment_img_tensor", "test_DND_plus.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["", "", "def", "test_x8", "(", "model", ",", "L", ")", ":", "\n", "    ", "E_list", "=", "[", "model", "(", "augment_img_tensor", "(", "L", ",", "mode", "=", "i", ")", ")", "[", "0", "]", "for", "i", "in", "range", "(", "8", ")", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "E_list", ")", ")", ":", "\n", "        ", "if", "i", "==", "3", "or", "i", "==", "5", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "8", "-", "i", ")", "\n", "", "else", ":", "\n", "            ", "E_list", "[", "i", "]", "=", "augment_img_tensor", "(", "E_list", "[", "i", "]", ",", "mode", "=", "i", ")", "\n", "", "", "output_cat", "=", "torch", ".", "stack", "(", "E_list", ",", "dim", "=", "0", ")", "\n", "E", "=", "output_cat", ".", "mean", "(", "dim", "=", "0", ",", "keepdim", "=", "False", ")", "\n", "return", "E", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.losses.CharbonnierLoss.__init__": [[8, 11], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["def", "__init__", "(", "self", ",", "eps", "=", "1e-3", ")", ":", "\n", "        ", "super", "(", "CharbonnierLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "eps", "=", "eps", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.losses.CharbonnierLoss.forward": [[12, 17], ["torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "diff", "=", "x", "-", "y", "\n", "# loss = torch.sum(torch.sqrt(diff * diff + self.eps))", "\n", "loss", "=", "torch", ".", "mean", "(", "torch", ".", "sqrt", "(", "(", "diff", "*", "diff", ")", "+", "(", "self", ".", "eps", "*", "self", ".", "eps", ")", ")", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.losses.EdgeLoss.__init__": [[19, 26], ["torch.Module.__init__", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "losses.CharbonnierLoss", "losses.EdgeLoss.kernel.cuda", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.Tensor.t", "torch.Tensor.t", "torch.Tensor.t"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "EdgeLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "k", "=", "torch", ".", "Tensor", "(", "[", "[", ".05", ",", ".25", ",", ".4", ",", ".25", ",", ".05", "]", "]", ")", "\n", "self", ".", "kernel", "=", "torch", ".", "matmul", "(", "k", ".", "t", "(", ")", ",", "k", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "3", ",", "1", ",", "1", ",", "1", ")", "\n", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", ":", "\n", "            ", "self", ".", "kernel", "=", "self", ".", "kernel", ".", "cuda", "(", ")", "\n", "", "self", ".", "loss", "=", "CharbonnierLoss", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.losses.EdgeLoss.conv_gauss": [[27, 31], ["torch.pad", "torch.pad", "torch.pad", "torch.conv2d", "torch.conv2d", "torch.conv2d"], "methods", ["None"], ["", "def", "conv_gauss", "(", "self", ",", "img", ")", ":", "\n", "        ", "n_channels", ",", "_", ",", "kw", ",", "kh", "=", "self", ".", "kernel", ".", "shape", "\n", "img", "=", "F", ".", "pad", "(", "img", ",", "(", "kw", "//", "2", ",", "kh", "//", "2", ",", "kw", "//", "2", ",", "kh", "//", "2", ")", ",", "mode", "=", "'replicate'", ")", "\n", "return", "F", ".", "conv2d", "(", "img", ",", "self", ".", "kernel", ",", "groups", "=", "n_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.losses.EdgeLoss.laplacian_kernel": [[32, 40], ["losses.EdgeLoss.conv_gauss", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "losses.EdgeLoss.conv_gauss"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss"], ["", "def", "laplacian_kernel", "(", "self", ",", "current", ")", ":", "\n", "        ", "filtered", "=", "self", ".", "conv_gauss", "(", "current", ")", "# filter", "\n", "down", "=", "filtered", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "# downsample", "\n", "new_filter", "=", "torch", ".", "zeros_like", "(", "filtered", ")", "\n", "new_filter", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "=", "down", "*", "4", "# upsample", "\n", "filtered", "=", "self", ".", "conv_gauss", "(", "new_filter", ")", "# filter", "\n", "diff", "=", "current", "-", "filtered", "\n", "return", "diff", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Denoising.losses.EdgeLoss.forward": [[41, 44], ["losses.EdgeLoss.loss", "losses.EdgeLoss.laplacian_kernel", "losses.EdgeLoss.laplacian_kernel"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "loss", "=", "self", ".", "loss", "(", "self", ".", "laplacian_kernel", "(", "x", ")", ",", "self", ".", "laplacian_kernel", "(", "y", ")", ")", "\n", "return", "loss", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.__init__": [[16, 24], ["torch.optim.lr_scheduler._LRScheduler.__init__", "ValueError"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["def", "__init__", "(", "self", ",", "optimizer", ",", "multiplier", ",", "total_epoch", ",", "after_scheduler", "=", "None", ")", ":", "\n", "        ", "self", ".", "multiplier", "=", "multiplier", "\n", "if", "self", ".", "multiplier", "<", "1.", ":", "\n", "            ", "raise", "ValueError", "(", "'multiplier should be greater thant or equal to 1.'", ")", "\n", "", "self", ".", "total_epoch", "=", "total_epoch", "\n", "self", ".", "after_scheduler", "=", "after_scheduler", "\n", "self", ".", "finished", "=", "False", "\n", "super", "(", "GradualWarmupScheduler", ",", "self", ")", ".", "__init__", "(", "optimizer", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.get_lr": [[25, 38], ["scheduler.GradualWarmupScheduler.after_scheduler.get_lr", "float"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.get_lr"], ["", "def", "get_lr", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "last_epoch", ">", "self", ".", "total_epoch", ":", "\n", "            ", "if", "self", ".", "after_scheduler", ":", "\n", "                ", "if", "not", "self", ".", "finished", ":", "\n", "                    ", "self", ".", "after_scheduler", ".", "base_lrs", "=", "[", "base_lr", "*", "self", ".", "multiplier", "for", "base_lr", "in", "self", ".", "base_lrs", "]", "\n", "self", ".", "finished", "=", "True", "\n", "", "return", "self", ".", "after_scheduler", ".", "get_lr", "(", ")", "\n", "", "return", "[", "base_lr", "*", "self", ".", "multiplier", "for", "base_lr", "in", "self", ".", "base_lrs", "]", "\n", "\n", "", "if", "self", ".", "multiplier", "==", "1.0", ":", "\n", "            ", "return", "[", "base_lr", "*", "(", "float", "(", "self", ".", "last_epoch", ")", "/", "self", ".", "total_epoch", ")", "for", "base_lr", "in", "self", ".", "base_lrs", "]", "\n", "", "else", ":", "\n", "            ", "return", "[", "base_lr", "*", "(", "(", "self", ".", "multiplier", "-", "1.", ")", "*", "self", ".", "last_epoch", "/", "self", ".", "total_epoch", "+", "1.", ")", "for", "base_lr", "in", "self", ".", "base_lrs", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step_ReduceLROnPlateau": [[39, 52], ["zip", "scheduler.GradualWarmupScheduler.after_scheduler.step", "scheduler.GradualWarmupScheduler.after_scheduler.step"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step"], ["", "", "def", "step_ReduceLROnPlateau", "(", "self", ",", "metrics", ",", "epoch", "=", "None", ")", ":", "\n", "        ", "if", "epoch", "is", "None", ":", "\n", "            ", "epoch", "=", "self", ".", "last_epoch", "+", "1", "\n", "", "self", ".", "last_epoch", "=", "epoch", "if", "epoch", "!=", "0", "else", "1", "# ReduceLROnPlateau is called at the end of epoch, whereas others are called at beginning", "\n", "if", "self", ".", "last_epoch", "<=", "self", ".", "total_epoch", ":", "\n", "            ", "warmup_lr", "=", "[", "base_lr", "*", "(", "(", "self", ".", "multiplier", "-", "1.", ")", "*", "self", ".", "last_epoch", "/", "self", ".", "total_epoch", "+", "1.", ")", "for", "base_lr", "in", "self", ".", "base_lrs", "]", "\n", "for", "param_group", ",", "lr", "in", "zip", "(", "self", ".", "optimizer", ".", "param_groups", ",", "warmup_lr", ")", ":", "\n", "                ", "param_group", "[", "'lr'", "]", "=", "lr", "\n", "", "", "else", ":", "\n", "            ", "if", "epoch", "is", "None", ":", "\n", "                ", "self", ".", "after_scheduler", ".", "step", "(", "metrics", ",", "None", ")", "\n", "", "else", ":", "\n", "                ", "self", ".", "after_scheduler", ".", "step", "(", "metrics", ",", "epoch", "-", "self", ".", "total_epoch", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step": [[53, 64], ["type", "scheduler.GradualWarmupScheduler.step_ReduceLROnPlateau", "super().step", "scheduler.GradualWarmupScheduler.after_scheduler.step", "scheduler.GradualWarmupScheduler.after_scheduler.step"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step_ReduceLROnPlateau", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.warmup_scheduler.scheduler.GradualWarmupScheduler.step"], ["", "", "", "def", "step", "(", "self", ",", "epoch", "=", "None", ",", "metrics", "=", "None", ")", ":", "\n", "        ", "if", "type", "(", "self", ".", "after_scheduler", ")", "!=", "ReduceLROnPlateau", ":", "\n", "            ", "if", "self", ".", "finished", "and", "self", ".", "after_scheduler", ":", "\n", "                ", "if", "epoch", "is", "None", ":", "\n", "                    ", "self", ".", "after_scheduler", ".", "step", "(", "None", ")", "\n", "", "else", ":", "\n", "                    ", "self", ".", "after_scheduler", ".", "step", "(", "epoch", "-", "self", ".", "total_epoch", ")", "\n", "", "", "else", ":", "\n", "                ", "return", "super", "(", "GradualWarmupScheduler", ",", "self", ")", ".", "step", "(", "epoch", ")", "\n", "", "", "else", ":", "\n", "            ", "self", ".", "step_ReduceLROnPlateau", "(", "metrics", ",", "epoch", ")", "\n", "", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__init__": [[56, 90], ["yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "yacs.config.CfgNode", "config.Config._C.merge_from_file", "config.Config._C.merge_from_list", "config.Config._C.freeze"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.utils.model_utils.freeze"], ["def", "__init__", "(", "self", ",", "config_yaml", ":", "str", ",", "config_override", ":", "List", "[", "Any", "]", "=", "[", "]", ")", ":", "\n", "\n", "        ", "self", ".", "_C", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "GPU", "=", "[", "0", "]", "\n", "self", ".", "_C", ".", "VERBOSE", "=", "False", "\n", "\n", "self", ".", "_C", ".", "MODEL", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "MODEL", ".", "MODE", "=", "'global'", "\n", "self", ".", "_C", ".", "MODEL", ".", "SESSION", "=", "'ps128_bs1'", "\n", "\n", "self", ".", "_C", ".", "OPTIM", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BATCH_SIZE", "=", "1", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NUM_EPOCHS", "=", "100", "\n", "self", ".", "_C", ".", "OPTIM", ".", "NEPOCH_DECAY", "=", "[", "100", "]", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_INITIAL", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "LR_MIN", "=", "0.0002", "\n", "self", ".", "_C", ".", "OPTIM", ".", "BETA1", "=", "0.5", "\n", "\n", "self", ".", "_C", ".", "TRAINING", "=", "CN", "(", ")", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_AFTER_EVERY", "=", "3", "\n", "self", ".", "_C", ".", "TRAINING", ".", "RESUME", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_IMAGES", "=", "False", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_DIR", "=", "'images_dir/train'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_DIR", "=", "'images_dir/val'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "SAVE_DIR", "=", "'checkpoints'", "\n", "self", ".", "_C", ".", "TRAINING", ".", "TRAIN_PS", "=", "64", "\n", "self", ".", "_C", ".", "TRAINING", ".", "VAL_PS", "=", "64", "\n", "\n", "# Override parameter values from YAML file first, then from override list.", "\n", "self", ".", "_C", ".", "merge_from_file", "(", "config_yaml", ")", "\n", "self", ".", "_C", ".", "merge_from_list", "(", "config_override", ")", "\n", "\n", "# Make an instantiated object of this class immutable.", "\n", "self", ".", "_C", ".", "freeze", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.dump": [[91, 100], ["config.Config._C.dump", "open"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.dump"], ["", "def", "dump", "(", "self", ",", "file_path", ":", "str", ")", ":", "\n", "        ", "r\"\"\"Save config at the specified file path.\n\n        Parameters\n        ----------\n        file_path: str\n            (YAML) path to save config at.\n        \"\"\"", "\n", "self", ".", "_C", ".", "dump", "(", "stream", "=", "open", "(", "file_path", ",", "\"w\"", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__getattr__": [[101, 103], ["config.Config._C.__getattr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__getattr__"], ["", "def", "__getattr__", "(", "self", ",", "attr", ":", "str", ")", ":", "\n", "        ", "return", "self", ".", "_C", ".", "__getattr__", "(", "attr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__repr__": [[104, 106], ["config.Config._C.__repr__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.config.Config.__repr__"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "_C", ".", "__repr__", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.data_RGB.get_training_data": [[4, 7], ["os.path.exists", "dataset_RGB.DataLoaderTrain"], "function", ["None"], ["def", "get_training_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderTrain", "(", "rgb_dir", ",", "img_options", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.data_RGB.get_validation_data": [[8, 11], ["os.path.exists", "dataset_RGB.DataLoaderVal"], "function", ["None"], ["", "def", "get_training_data_all", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "for", "dir", "in", "rgb_dir", ":", "\n", "        ", "assert", "os", ".", "path", ".", "exists", "(", "dir", ")", "\n", "", "return", "DataLoaderTrain_all", "(", "rgb_dir", ",", "img_options", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.data_RGB.get_test_data": [[12, 15], ["os.path.exists", "dataset_RGB.DataLoaderTest"], "function", ["None"], ["\n", "", "def", "get_validation_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderVal", "(", "rgb_dir", ",", "img_options", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.data_RGB.get_test_data_fine": [[16, 19], ["os.path.exists", "dataset_RGB.DataLoaderTest_fine"], "function", ["None"], ["\n", "", "def", "get_test_data", "(", "rgb_dir", ",", "img_options", ")", ":", "\n", "    ", "assert", "os", ".", "path", ".", "exists", "(", "rgb_dir", ")", "\n", "return", "DataLoaderTest", "(", "rgb_dir", ",", "img_options", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.ResBlock.__init__": [[29, 47], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet_plus.conv", "DGUNet_plus.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Block (CAB)", "\n", "", "", "class", "CAB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.ResBlock.forward": [[48, 53], ["DGUNet_plus.ResBlock.body().mul", "DGUNet_plus.ResBlock.body"], "methods", ["None"], ["modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.CAB.__init__": [[58, 67], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet_plus.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["\n", "\n", "##########################################################################", "\n", "## Supervised Attention Module", "\n", "", "", "class", "SAM", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.CAB.forward": [[68, 73], ["DGUNet_plus.CAB.body", "DGUNet_plus.CAB.CA"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n", "x2", "=", "torch", ".", "sigmoid", "(", "self", ".", "conv3", "(", "img", ")", ")", "\n", "x1", "=", "x1", "*", "x2", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.CALayer.__init__": [[76, 86], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["\n", "", "", "class", "UNetConvBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_1", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.CALayer.forward": [[88, 92], ["DGUNet_plus.CALayer.avg_pool", "DGUNet_plus.CALayer.conv_du"], "methods", ["None"], ["\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "csff_dec", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.SAM.__init__": [[97, 101], ["torch.Module.__init__", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.SAM.forward": [[102, 107], ["DGUNet_plus.SAM.conv1", "DGUNet_plus.SAM.conv2"], "methods", ["None"], ["\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n", "", "out", "=", "self", ".", "relu_1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_2", "(", "self", ".", "conv_2", "(", "out", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.mergeblock.__init__": [[110, 115], ["torch.Module.__init__", "DGUNet_plus.conv", "DGUNet_plus.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n", "", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.mergeblock.forward": [[116, 132], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.mergeblock.subnet", "DGUNet_plus.mergeblock.view", "DGUNet_plus.mergeblock.view.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.mergeblock.conv_block", "torch.matmul().permute().view.view.permute", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul"], "methods", ["None"], ["return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n", "\n", "", "", "", "class", "UNetUpBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.Encoder.__init__": [[137, 144], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.Encoder.body.append", "DGUNet_plus.UNetConvBlock", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.Encoder.forward": [[145, 162], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "return", "res", ",", "x", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.UNetConvBlock.__init__": [[165, 188], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet_plus.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["", "", "class", "Decoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "##---------- Resizing Modules ----------", "\n", "", "", "class", "DownSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.UNetConvBlock.forward": [[189, 208], ["DGUNet_plus.UNetConvBlock.conv_1", "DGUNet_plus.UNetConvBlock.relu_1", "DGUNet_plus.UNetConvBlock.relu_2", "DGUNet_plus.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetConvBlock.conv_2", "torch.leaky_relu", "torch.leaky_relu", "torch.leaky_relu", "DGUNet_plus.UNetConvBlock.downsample", "DGUNet_plus.UNetConvBlock.norm", "DGUNet_plus.UNetConvBlock.csff_enc", "DGUNet_plus.UNetConvBlock.csff_dec", "DGUNet_plus.UNetConvBlock.gamma", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet_plus.UNetConvBlock.phi"], "methods", ["None"], ["self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "UpSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "SkipUpSample", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.UNetUpBlock.__init__": [[211, 215], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet_plus.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.UNetUpBlock.forward": [[216, 221], ["DGUNet_plus.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet_plus.UNetUpBlock.conv_block"], "methods", ["None"], ["x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n", "\n", "##########################################################################", "\n", "## Original Resolution Block (ORB)", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.Decoder.__init__": [[224, 232], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet_plus.Decoder.body.append", "DGUNet_plus.Decoder.skip_conv.append", "DGUNet_plus.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.Decoder.forward": [[233, 240], ["enumerate", "up", "res.append"], "methods", ["None"], ["return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "", "", "class", "ORSNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORSNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.DownSample.__init__": [[245, 249], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n", "self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.DownSample.forward": [[250, 253], ["DGUNet_plus.DownSample.down"], "methods", ["None"], ["self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.UpSample.__init__": [[256, 260], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.UpSample.forward": [[261, 264], ["DGUNet_plus.UpSample.up"], "methods", ["None"], ["\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n", "        ", "x", "=", "self", ".", "orb1", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc1", "(", "encoder_outs", "[", "0", "]", ")", "+", "self", ".", "conv_dec1", "(", "decoder_outs", "[", "-", "1", "]", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.DGUNet.__init__": [[269, 344], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "DGUNet_plus.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.Encoder", "DGUNet_plus.Decoder", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.SAM", "DGUNet_plus.mergeblock", "DGUNet_plus.conv", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "DGUNet_plus.conv", "DGUNet_plus.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n", "", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n", "", "class", "ResBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n", "bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "act", ")", "\n", "\n", "", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "m", ")", "\n", "self", ".", "res_scale", "=", "res_scale", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n", "##########################################################################", "\n", "", "", "class", "MPRBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n", "self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.DGUNet.forward": [[345, 435], ["DGUNet_plus.DGUNet.shallow_feat1", "DGUNet_plus.DGUNet.stage1_encoder", "DGUNet_plus.DGUNet.stage1_decoder", "DGUNet_plus.DGUNet.sam12", "DGUNet_plus.DGUNet.shallow_feat2", "DGUNet_plus.DGUNet.merge12", "DGUNet_plus.DGUNet.stage2_encoder", "DGUNet_plus.DGUNet.stage2_decoder", "DGUNet_plus.DGUNet.sam23", "DGUNet_plus.DGUNet.shallow_feat3", "DGUNet_plus.DGUNet.merge23", "DGUNet_plus.DGUNet.stage3_encoder", "DGUNet_plus.DGUNet.stage3_decoder", "DGUNet_plus.DGUNet.sam34", "DGUNet_plus.DGUNet.shallow_feat4", "DGUNet_plus.DGUNet.merge34", "DGUNet_plus.DGUNet.stage4_encoder", "DGUNet_plus.DGUNet.stage4_decoder", "DGUNet_plus.DGUNet.sam45", "DGUNet_plus.DGUNet.shallow_feat5", "DGUNet_plus.DGUNet.merge45", "DGUNet_plus.DGUNet.stage5_encoder", "DGUNet_plus.DGUNet.stage5_decoder", "DGUNet_plus.DGUNet.sam56", "DGUNet_plus.DGUNet.shallow_feat6", "DGUNet_plus.DGUNet.merge56", "DGUNet_plus.DGUNet.stage6_encoder", "DGUNet_plus.DGUNet.stage6_decoder", "DGUNet_plus.DGUNet.sam67", "DGUNet_plus.DGUNet.shallow_feat7", "DGUNet_plus.DGUNet.merge67", "DGUNet_plus.DGUNet.phi_0", "DGUNet_plus.DGUNet.phi_1", "DGUNet_plus.DGUNet.phi_2", "DGUNet_plus.DGUNet.phi_3", "DGUNet_plus.DGUNet.phi_4", "DGUNet_plus.DGUNet.phi_5", "DGUNet_plus.DGUNet.phi_6", "DGUNet_plus.DGUNet.tail", "DGUNet_plus.DGUNet.phit_0", "DGUNet_plus.DGUNet.phit_1", "DGUNet_plus.DGUNet.phit_2", "DGUNet_plus.DGUNet.phit_3", "DGUNet_plus.DGUNet.phit_4", "DGUNet_plus.DGUNet.phit_5", "DGUNet_plus.DGUNet.phit_6"], "methods", ["None"], ["\n", "##########################################################################", "\n", "", "", "class", "DGUNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "nums_stages", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "MPRBlock", "(", "\n", "in_c", "=", "in_c", ",", "out_c", "=", "in_c", ",", "n_feat", "=", "n_feat", ",", "scale_unetfeats", "=", "scale_unetfeats", ",", "kernel_size", "=", "kernel_size", ",", "\n", "reduction", "=", "reduction", ",", "bias", "=", "bias", "\n", ")", ")", "\n", "", "self", ".", "shallow_feat_final", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage1_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "False", ")", "\n", "self", ".", "stage1_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam12", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "r0", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "self", ".", "r_final", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat_final", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "tail", "=", "conv", "(", "n_feat", "+", "scale_orsnetfeats", ",", "out_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "img", ")", ":", "\n", "        ", "output_", "=", "[", "]", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 1---------------------", "\n", "##-------------------------------------------", "\n", "b", ",", "c", ",", "w", ",", "h", "=", "img", ".", "shape", "\n", "PhiTPhi", "=", "torch", ".", "mm", "(", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ",", "self", ".", "Phi", ")", "# torch.mm(Phix, Phi)", "\n", "Phix", "=", "torch", ".", "mm", "(", "img", ".", "view", "(", "b", ",", "-", "1", ")", ",", "torch", ".", "transpose", "(", "self", ".", "Phi", ",", "0", ",", "1", ")", ")", "# compression result", "\n", "PhiTb", "=", "torch", ".", "mm", "(", "Phix", ",", "self", ".", "Phi", ")", "\n", "# compute r_0", "\n", "x_0", "=", "PhiTb", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_0", "-", "self", ".", "r0", "*", "torch", ".", "mm", "(", "x_0", ",", "PhiTPhi", ")", "\n", "r_0", "=", "x", "+", "self", ".", "r0", "*", "PhiTb", "\n", "r_0", "=", "r_0", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat1", "(", "r_0", ")", "\n", "## Process features of all 4 patches with Encoder of Stage 1", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage1_encoder", "(", "x", ")", "\n", "## Pass features through Decoder of Stage 1", "\n", "f_decoder", "=", "self", ".", "stage1_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply Supervised Attention Module (SAM)", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam12", "(", "f_decoder", "[", "-", "1", "]", ",", "r_0", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "##-------------------------------------------", "\n", "##-------------- Stage 2_k-1---------------------", "\n", "##-------------------------------------------", "\n", "for", "stage_model", "in", "self", ".", "body", ":", "\n", "            ", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "=", "stage_model", "(", "stage_img", ",", "img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "##-------------------------------------------", "\n", "##-------------- Stage k---------------------", "\n", "##-------------------------------------------", "\n", "# compute r_k", "\n", "", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "x", "=", "x_k_1", "-", "self", ".", "r_final", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r_final", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat_final", "(", "r_k", ")", "\n", "## Concatenate SAM features", "\n", "x_cat", "=", "self", ".", "concat_final", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "stage_img", "=", "self", ".", "tail", "(", "x_cat", ")", "+", "r_k", "\n", "output_", ".", "append", "(", "stage_img", ")", "\n", "\n", "return", "output_", "[", ":", ":", "-", "1", "]", "\n", "", "", ""]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.conv": [[11, 15], ["torch.Conv2d"], "function", ["None"], ["    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n", "\n", "", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.conv_down": [[17, 20], ["torch.Conv2d"], "function", ["None"], ["return", "layer", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Layer", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet_plus.default_conv": [[22, 26], ["torch.Conv2d"], "function", ["None"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.ResBlock.__init__": [[27, 45], ["torch.PReLU", "torch.PReLU", "torch.PReLU", "torch.Module.__init__", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "m.append", "m.append", "m.append", "m.append", "DGUNet.conv", "DGUNet.conv", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "bias", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "# \u8ba1\u7b97\u6ce8\u610f\u529b\u6743\u91cd", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "# \u52a0\u6743", "\n", "\n", "\n", "##########################################################################", "\n", "## Channel Attention Block (CAB)", "\n", "", "", "class", "CAB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", ",", "act", ")", ":", "\n", "        ", "super", "(", "CAB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.ResBlock.forward": [[46, 51], ["DGUNet.ResBlock.body().mul", "DGUNet.ResBlock.body"], "methods", ["None"], ["modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "modules_body", ".", "append", "(", "act", ")", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "\n", "self", ".", "CA", "=", "CALayer", "(", "n_feat", ",", "reduction", ",", "bias", "=", "bias", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.CAB.__init__": [[56, 65], ["torch.Module.__init__", "modules_body.append", "modules_body.append", "modules_body.append", "DGUNet.CALayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["res", "+=", "x", "\n", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "## Supervised Attention Module", "\n", "", "", "class", "SAM", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "bias", ",", "in_c", ")", ":", "\n", "        ", "super", "(", "SAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.CAB.forward": [[66, 71], ["DGUNet.CAB.body", "DGUNet.CAB.CA"], "methods", ["None"], ["self", ".", "conv2", "=", "conv", "(", "n_feat", ",", "in_c", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv3", "=", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "x_img", ")", ":", "\n", "        ", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "img", "=", "self", ".", "conv2", "(", "x", ")", "+", "x_img", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.CALayer.__init__": [[74, 84], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["x1", "=", "x1", "+", "x", "\n", "return", "x1", ",", "img", "\n", "\n", "", "", "class", "UNetConvBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "downsample", ",", "relu_slope", ",", "use_csff", "=", "False", ",", "use_HIN", "=", "False", ")", ":", "\n", "        ", "super", "(", "UNetConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "identity", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "use_csff", "=", "use_csff", "\n", "\n", "self", ".", "conv_1", "=", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.CALayer.forward": [[86, 90], ["DGUNet.CALayer.avg_pool", "DGUNet.CALayer.conv_du"], "methods", ["None"], ["self", ".", "conv_2", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "True", ")", "\n", "self", ".", "relu_2", "=", "nn", ".", "LeakyReLU", "(", "relu_slope", ",", "inplace", "=", "False", ")", "\n", "\n", "if", "downsample", "and", "use_csff", ":", "\n", "            ", "self", ".", "csff_enc", "=", "nn", ".", "Conv2d", "(", "out_size", ",", "out_size", ",", "3", ",", "1", ",", "1", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.SAM.__init__": [[95, 99], ["torch.Module.__init__", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["", "self", ".", "use_HIN", "=", "use_HIN", "\n", "\n", "if", "downsample", ":", "\n", "            ", "self", ".", "downsample", "=", "conv_down", "(", "out_size", ",", "out_size", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.SAM.forward": [[100, 105], ["DGUNet.SAM.conv1", "DGUNet.SAM.conv2"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "enc", "=", "None", ",", "dec", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1", "(", "x", ")", "\n", "\n", "if", "self", ".", "use_HIN", ":", "\n", "            ", "out_1", ",", "out_2", "=", "torch", ".", "chunk", "(", "out", ",", "2", ",", "dim", "=", "1", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "self", ".", "norm", "(", "out_1", ")", ",", "out_2", "]", ",", "dim", "=", "1", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.mergeblock.__init__": [[108, 113], ["torch.Module.__init__", "DGUNet.conv", "DGUNet.conv"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["\n", "out", "+=", "self", ".", "identity", "(", "x", ")", "\n", "if", "enc", "is", "not", "None", "and", "dec", "is", "not", "None", ":", "\n", "            ", "assert", "self", ".", "use_csff", "\n", "#             print('enc+dec:',out.shape,enc.shape,dec.shape)", "\n", "out", "=", "out", "+", "self", ".", "csff_enc", "(", "enc", ")", "+", "self", ".", "csff_dec", "(", "dec", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.mergeblock.forward": [[114, 130], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.mergeblock.subnet", "DGUNet.mergeblock.view", "DGUNet.mergeblock.view.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.inverse", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul().permute().view.view", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.matmul().permute().view", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.mergeblock.conv_block", "torch.matmul().permute().view.view.permute", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.abs().sum", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul"], "methods", ["None"], ["", "if", "self", ".", "downsample", ":", "\n", "            ", "out_down", "=", "self", ".", "downsample", "(", "out", ")", "\n", "return", "out_down", ",", "out", "\n", "", "else", ":", "\n", "            ", "return", "out", "\n", "\n", "\n", "", "", "", "class", "UNetUpBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "relu_slope", ")", ":", "\n", "        ", "super", "(", "UNetUpBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ",", "bias", "=", "True", ")", "\n", "self", ".", "conv_block", "=", "UNetConvBlock", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ",", "relu_slope", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "bridge", ")", ":", "\n", "        ", "up", "=", "self", ".", "up", "(", "x", ")", "\n", "out", "=", "torch", ".", "cat", "(", "[", "up", ",", "bridge", "]", ",", "1", ")", "\n", "out", "=", "self", ".", "conv_block", "(", "out", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.Encoder.__init__": [[135, 142], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Encoder.body.append", "DGUNet.Encoder.body.append", "DGUNet.UNetConvBlock", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["\n", "", "", "class", "Encoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Encoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "self", ".", "depth", "=", "depth", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "i", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "i", "+", "1", ")", ",", "downsample", "=", "True", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.Encoder.forward": [[143, 160], ["enumerate", "enumerate", "down", "res.append", "down", "down", "res.append", "down"], "methods", ["None"], ["\n", "", "self", ".", "body", ".", "append", "(", "UNetConvBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "1", ")", ",", "downsample", "=", "False", ",", "relu_slope", "=", "0.2", ",", "use_csff", "=", "True", ",", "use_HIN", "=", "True", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", "=", "None", ",", "decoder_outs", "=", "None", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "if", "encoder_outs", "is", "not", "None", "and", "decoder_outs", "is", "not", "None", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ",", "encoder_outs", "[", "i", "]", ",", "decoder_outs", "[", "-", "i", "-", "1", "]", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n", "                    ", "x", "=", "down", "(", "x", ")", "\n", "", "", "", "else", ":", "\n", "            ", "for", "i", ",", "down", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "                ", "if", "(", "i", "+", "1", ")", "<", "self", ".", "depth", ":", "\n", "                    ", "x", ",", "x_up", "=", "down", "(", "x", ")", "\n", "res", ".", "append", "(", "x_up", ")", "\n", "", "else", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.UNetConvBlock.__init__": [[163, 186], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "torch.InstanceNorm2d", "DGUNet.conv_down"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down"], ["\n", "\n", "", "", "class", "Decoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "depth", "=", "4", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "skip_conv", "=", "nn", ".", "ModuleList", "(", ")", "#[]", "\n", "for", "i", "in", "range", "(", "depth", "-", "1", ")", ":", "\n", "            ", "self", ".", "body", ".", "append", "(", "UNetUpBlock", "(", "in_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "out_size", "=", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "relu_slope", "=", "0.2", ")", ")", "\n", "self", ".", "skip_conv", ".", "append", "(", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "1", ")", ",", "n_feat", "+", "scale_unetfeats", "*", "(", "depth", "-", "i", "-", "2", ")", ",", "3", ",", "1", ",", "1", ")", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ",", "bridges", ")", ":", "\n", "        ", "res", "=", "[", "]", "\n", "for", "i", ",", "up", "in", "enumerate", "(", "self", ".", "body", ")", ":", "\n", "            ", "x", "=", "up", "(", "x", ",", "self", ".", "skip_conv", "[", "i", "]", "(", "bridges", "[", "-", "i", "-", "1", "]", ")", ")", "\n", "res", ".", "append", "(", "x", ")", "\n", "\n", "", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "##---------- Resizing Modules ----------", "\n", "", "", "class", "DownSample", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.UNetConvBlock.forward": [[187, 206], ["DGUNet.UNetConvBlock.conv_1", "DGUNet.UNetConvBlock.relu_1", "DGUNet.UNetConvBlock.relu_2", "DGUNet.UNetConvBlock.identity", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetConvBlock.conv_2", "torch.leaky_relu", "torch.leaky_relu", "torch.leaky_relu", "DGUNet.UNetConvBlock.downsample", "DGUNet.UNetConvBlock.norm", "DGUNet.UNetConvBlock.csff_enc", "DGUNet.UNetConvBlock.csff_dec", "DGUNet.UNetConvBlock.gamma", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "DGUNet.UNetConvBlock.phi"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "DownSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "down", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", "+", "s_factor", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "down", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "UpSample", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "UpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.UNetUpBlock.__init__": [[209, 213], ["torch.Module.__init__", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "DGUNet.UNetConvBlock"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "s_factor", ")", ":", "\n", "        ", "super", "(", "SkipUpSample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "up", "=", "nn", ".", "Sequential", "(", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "+", "s_factor", ",", "in_channels", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.UNetUpBlock.forward": [[214, 219], ["DGUNet.UNetUpBlock.up", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.UNetUpBlock.conv_block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "x", "=", "self", ".", "up", "(", "x", ")", "\n", "x", "=", "x", "+", "y", "\n", "return", "x", "\n", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.Decoder.__init__": [[222, 230], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "DGUNet.Decoder.body.append", "DGUNet.Decoder.skip_conv.append", "DGUNet.UNetUpBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["", "", "class", "ORB", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", ":", "\n", "        ", "super", "(", "ORB", ",", "self", ")", ".", "__init__", "(", ")", "\n", "modules_body", "=", "[", "]", "\n", "modules_body", "=", "[", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", "for", "_", "in", "range", "(", "num_cab", ")", "]", "\n", "modules_body", ".", "append", "(", "conv", "(", "n_feat", ",", "n_feat", ",", "kernel_size", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules_body", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.Decoder.forward": [[231, 238], ["enumerate", "up", "res.append"], "methods", ["None"], ["        ", "res", "=", "self", ".", "body", "(", "x", ")", "\n", "res", "+=", "x", "\n", "return", "res", "\n", "\n", "\n", "##########################################################################", "\n", "", "", "class", "ORSNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "n_feat", ",", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "num_cab", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.DownSample.__init__": [[243, 247], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "orb3", "=", "ORB", "(", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "num_cab", ")", "\n", "\n", "self", ".", "up_enc1", "=", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", "\n", "self", ".", "up_dec1", "=", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.DownSample.forward": [[248, 251], ["DGUNet.DownSample.down"], "methods", ["None"], ["self", ".", "up_enc2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "3", "*", "scale_unetfeats", ",", "n_feat", "+", "2", "*", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ")", "\n", "self", ".", "up_dec2", "=", "nn", ".", "Sequential", "(", "UpSample", "(", "n_feat", "+", "2", "*", "scale_unetfeats", ",", "n_feat", "+", "scale_unetfeats", ")", ",", "\n", "UpSample", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.UpSample.__init__": [[254, 258], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["self", ".", "conv_enc1", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc2", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_enc3", "=", "nn", ".", "Conv2d", "(", "n_feat", "+", "scale_unetfeats", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "self", ".", "conv_dec1", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.UpSample.forward": [[259, 262], ["DGUNet.UpSample.up"], "methods", ["None"], ["self", ".", "conv_dec2", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "self", ".", "conv_dec3", "=", "nn", ".", "Conv2d", "(", "n_feat", ",", "n_feat", "+", "scale_orsnetfeats", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "encoder_outs", ",", "decoder_outs", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.Basic_block.__init__": [[267, 281], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "DGUNet.ResBlock", "DGUNet.ResBlock", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.mergeblock", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["x", "=", "x", "+", "self", ".", "conv_enc2", "(", "self", ".", "up_enc1", "(", "encoder_outs", "[", "1", "]", ")", ")", "+", "self", ".", "conv_dec2", "(", "self", ".", "up_dec1", "(", "decoder_outs", "[", "-", "2", "]", ")", ")", "\n", "\n", "x", "=", "self", ".", "orb3", "(", "x", ")", "\n", "x", "=", "x", "+", "self", ".", "conv_enc3", "(", "self", ".", "up_enc2", "(", "encoder_outs", "[", "2", "]", ")", ")", "+", "self", ".", "conv_dec3", "(", "self", ".", "up_dec2", "(", "decoder_outs", "[", "-", "3", "]", ")", ")", "\n", "\n", "return", "x", "\n", "\n", "", "", "def", "default_conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "bias", "=", "True", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "stride", "=", "stride", ",", "bias", "=", "bias", ")", "\n", "\n", "", "class", "ResBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "conv", ",", "n_feats", ",", "kernel_size", ",", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.Basic_block.forward": [[282, 293], ["DGUNet.Basic_block.shallow_feat2", "DGUNet.Basic_block.merge12", "DGUNet.Basic_block.stage2_encoder", "DGUNet.Basic_block.stage2_decoder", "DGUNet.Basic_block.sam23", "DGUNet.Basic_block.phi_1", "DGUNet.Basic_block.phit_1"], "methods", ["None"], ["bias", "=", "True", ",", "bn", "=", "False", ",", "act", "=", "nn", ".", "PReLU", "(", ")", ",", "res_scale", "=", "1", ")", ":", "\n", "\n", "        ", "super", "(", "ResBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "m", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "            ", "if", "i", "==", "0", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "n_feats", ",", "64", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "append", "(", "conv", "(", "64", ",", "n_feats", ",", "kernel_size", ",", "bias", "=", "bias", ")", ")", "\n", "", "if", "bn", ":", "\n", "                ", "m", ".", "append", "(", "nn", ".", "BatchNorm2d", "(", "n_feats", ")", ")", "\n", "", "if", "i", "==", "0", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.DGUNet.__init__": [[297, 322], ["torch.Module.__init__", "torch.PReLU", "torch.PReLU", "torch.PReLU", "DGUNet.Basic_block", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "DGUNet.Encoder", "DGUNet.Decoder", "DGUNet.SAM", "DGUNet.ResBlock", "DGUNet.ResBlock", "DGUNet.ResBlock", "DGUNet.ResBlock", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "DGUNet.conv", "DGUNet.conv", "DGUNet.conv", "DGUNet.CAB", "DGUNet.conv", "DGUNet.CAB", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv"], ["self", ".", "res_scale", "=", "res_scale", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "res", "=", "self", ".", "body", "(", "x", ")", ".", "mul", "(", "self", ".", "res_scale", ")", "\n", "res", "+=", "x", "\n", "\n", "return", "res", "\n", "\n", "##########################################################################", "\n", "", "", "class", "MPRBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "80", ",", "scale_unetfeats", "=", "48", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "MPRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "\n", "# Cross Stage Feature Fusion (CSFF)", "\n", "self", ".", "stage_encoder", "=", "Encoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ",", "csff", "=", "True", ")", "\n", "self", ".", "stage_decoder", "=", "Decoder", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "act", ",", "bias", ",", "scale_unetfeats", ")", "\n", "\n", "self", ".", "sam", "=", "SAM", "(", "n_feat", ",", "kernel_size", "=", "1", ",", "bias", "=", "bias", ",", "in_c", "=", "in_c", ")", "\n", "\n", "self", ".", "phi", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "self", ".", "phit", "=", "ResBlock", "(", "default_conv", ",", "3", ",", "3", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.DGUNet.forward": [[323, 358], ["DGUNet.DGUNet.shallow_feat1", "DGUNet.DGUNet.stage1_encoder", "DGUNet.DGUNet.stage1_decoder", "DGUNet.DGUNet.sam12", "res.append", "range", "DGUNet.DGUNet.shallow_feat7", "DGUNet.DGUNet.concat67", "res.append", "DGUNet.DGUNet.phi_0", "DGUNet.DGUNet.basic", "res.append", "DGUNet.DGUNet.phi_6", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "DGUNet.DGUNet.tail", "DGUNet.DGUNet.phit_0", "DGUNet.DGUNet.phit_6"], "methods", ["None"], ["self", ".", "r", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "[", "0.5", "]", ")", ")", "\n", "\n", "self", ".", "concat", "=", "conv", "(", "n_feat", "*", "2", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", "\n", "", "def", "forward", "(", "self", ",", "stage_img", ",", "img", ",", "x_samfeats", ",", "f_encoder", ",", "f_decoder", ",", "PhiTPhi", ",", "PhiTb", ")", ":", "\n", "        ", "b", ",", "c", ",", "w", ",", "h", "=", "stage_img", ".", "shape", "\n", "x_k_1", "=", "stage_img", ".", "view", "(", "b", ",", "-", "1", ")", "\n", "# compute r_k", "\n", "x", "=", "x_k_1", "-", "self", ".", "r", "*", "torch", ".", "mm", "(", "x_k_1", ",", "PhiTPhi", ")", "\n", "r_k", "=", "x", "+", "self", ".", "r", "*", "PhiTb", "\n", "r_k", "=", "r_k", ".", "view", "(", "b", ",", "c", ",", "w", ",", "h", ")", "\n", "\n", "# compute x_k", "\n", "x", "=", "self", ".", "shallow_feat", "(", "r_k", ")", "\n", "## Concatenate SAM features of Stage 1 with shallow features of Stage 2", "\n", "x_cat", "=", "self", ".", "concat", "(", "torch", ".", "cat", "(", "[", "x", ",", "x_samfeats", "]", ",", "1", ")", ")", "\n", "## Process features of both patches with Encoder of Stage 2", "\n", "feat1", ",", "f_encoder", "=", "self", ".", "stage_encoder", "(", "x_cat", ",", "f_encoder", ",", "f_decoder", ")", "\n", "## Pass features through Decoder of Stage 2", "\n", "f_decoder", "=", "self", ".", "stage_decoder", "(", "f_encoder", ",", "feat1", ")", "\n", "## Apply SAM", "\n", "x_samfeats", ",", "stage_img", "=", "self", ".", "sam", "(", "f_decoder", "[", "-", "1", "]", ",", "r_k", ")", "\n", "return", "stage_img", ",", "x_samfeats", ",", "feat1", ",", "f_decoder", "\n", "\n", "##########################################################################", "\n", "", "", "class", "DGUNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_c", "=", "3", ",", "out_c", "=", "3", ",", "n_feat", "=", "32", ",", "scale_unetfeats", "=", "16", ",", "scale_orsnetfeats", "=", "16", ",", "num_cab", "=", "8", ",", "kernel_size", "=", "3", ",", "\n", "reduction", "=", "4", ",", "bias", "=", "False", ",", "nums_stages", "=", "5", ",", "cs_ratio", "=", "25", ")", ":", "\n", "        ", "super", "(", "DGUNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'CS Ratio: '", ",", "cs_ratio", ")", "\n", "\n", "self", ".", "Phi", "=", "nn", ".", "Parameter", "(", "init", ".", "xavier_normal_", "(", "torch", ".", "Tensor", "(", "np", ".", "ceil", "(", "cs_ratio", "*", "0.01", "*", "1024.", ")", ".", "astype", "(", "np", ".", "int", ")", ",", "1024", ")", ")", ")", "\n", "act", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "shallow_feat1", "=", "nn", ".", "Sequential", "(", "conv", "(", "in_c", ",", "n_feat", ",", "kernel_size", ",", "bias", "=", "bias", ")", ",", "\n", "CAB", "(", "n_feat", ",", "kernel_size", ",", "reduction", ",", "bias", "=", "bias", ",", "act", "=", "act", ")", ")", "\n", "self", ".", "body", "=", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "nums_stages", "=", "nums_stages", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv": [[9, 13], ["torch.Conv2d"], "function", ["None"], ["##########################################################################", "\n", "def", "conv", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "bias", "=", "False", ",", "stride", "=", "1", ")", ":", "\n", "    ", "return", "nn", ".", "Conv2d", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "\n", "padding", "=", "(", "kernel_size", "//", "2", ")", ",", "bias", "=", "bias", ",", "stride", "=", "stride", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.conv_down": [[15, 18], ["torch.Conv2d"], "function", ["None"], ["", "def", "conv_down", "(", "in_chn", ",", "out_chn", ",", "bias", "=", "False", ")", ":", "\n", "    ", "layer", "=", "nn", ".", "Conv2d", "(", "in_chn", ",", "out_chn", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "bias", ")", "\n", "return", "layer", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.DGUNet.default_conv": [[20, 24], ["torch.Conv2d"], "function", ["None"], ["## Channel Attention Layer", "\n", "", "class", "CALayer", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ",", "bias", "=", "False", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test_plus.augment_img_tensor": [[46, 61], ["img.size", "img.data.cpu().numpy", "test_plus.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["parser", ".", "add_argument", "(", "'--algo_name'", ",", "type", "=", "str", ",", "default", "=", "'DGUNet_P32_s7_v7_hi3_u4_lm2_learn_BSD_DIV2K_fine'", ",", "help", "=", "'log directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--test_name'", ",", "type", "=", "str", ",", "default", "=", "'BSD68'", ",", "help", "=", "'name of test set'", ")", "\n", "# parser.add_argument('--test_name', type=str, default='Set11', help='name of test set')", "\n", "parser", ".", "add_argument", "(", "'--num_gpu'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'Number of GPU'", ")", "\n", "parser", ".", "add_argument", "(", "'--loss_mod'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'loss mode'", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n", "start_epoch", "=", "args", ".", "start_epoch", "\n", "end_epoch", "=", "args", ".", "end_epoch", "\n", "learning_rate", "=", "args", ".", "learning_rate", "\n", "layer_num_ICNN", "=", "args", ".", "layer_num_ICNN", "\n", "layer_num_IFC", "=", "args", ".", "layer_num_IFC", "\n", "group_num", "=", "args", ".", "group_num", "\n", "cs_ratio", "=", "args", ".", "cs_ratio", "\n", "gpu_list", "=", "args", ".", "gpu_list", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test_plus.augment_img": [[62, 79], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["rb_type", "=", "args", ".", "rb_type", "\n", "rb_num", "=", "args", ".", "rb_num", "\n", "batch_size", "=", "args", ".", "batch_size", "\n", "\n", "# os.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"", "\n", "# os.environ[\"CUDA_VISIBLE_DEVICES\"] = gpu_list", "\n", "device", "=", "torch", ".", "device", "(", "\"cuda:0\"", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", "else", "\"cpu\"", ")", "\n", "\n", "ratio_dict", "=", "{", "10", ":", "0", ",", "25", ":", "1", ",", "30", ":", "2", ",", "40", ":", "3", ",", "50", ":", "4", "}", "\n", "\n", "# n_input = ratio_dict[cs_ratio]", "\n", "n_output", "=", "1089", "\n", "nrtrain", "=", "88912", "# number of training blocks", "\n", "psnr_best", "=", "0", "\n", "best_epoch", "=", "0", "\n", "# test data", "\n", "test_name", "=", "args", ".", "test_name", "\n", "test_dir", "=", "os", ".", "path", ".", "join", "(", "'Datasets'", ",", "test_name", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test_plus.test_x8": [[80, 90], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test_plus.augment_img_tensor", "test_plus.augment_img_tensor", "test_plus.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["# filepaths = glob.glob(test_dir + '/*.tif')", "\n", "filepaths", "=", "glob", ".", "glob", "(", "test_dir", "+", "'/*.png'", ")", "\n", "ImgNum", "=", "len", "(", "filepaths", ")", "\n", "\n", "# Load CS Sampling Matrix: phi", "\n", "Phi_data_Name", "=", "os", ".", "path", ".", "join", "(", "args", ".", "matrix_dir", ",", "\n", "'phi_sampling_%d_%dx%d.npy'", "%", "(", "args", ".", "cs_ratio", ",", "args", ".", "patch_size", ",", "args", ".", "patch_size", ")", ")", "\n", "Phi_input", "=", "np", ".", "load", "(", "Phi_data_Name", ")", "\n", "Phi", "=", "torch", ".", "from_numpy", "(", "Phi_input", ")", ".", "type", "(", "torch", ".", "FloatTensor", ")", "\n", "Phi", "=", "Phi", ".", "to", "(", "device", ")", "# .unsqueeze(0).unsqueeze(0)", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor": [[46, 61], ["img.size", "img.data.cpu().numpy", "test.augment_img", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "img_tensor.permute.type_as", "len", "numpy.transpose", "numpy.ascontiguousarray", "len", "img_tensor.permute.permute", "img.data.cpu", "len", "numpy.transpose", "len", "img_tensor.permute.permute"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img"], ["parser", ".", "add_argument", "(", "'--log_dir'", ",", "type", "=", "str", ",", "default", "=", "'log'", ",", "help", "=", "'log directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--algo_name'", ",", "type", "=", "str", ",", "default", "=", "'DGUNet_P32_s7_v7_hi3_u4_rp_lm2_learn_BSD_DIV2K_fine'", ",", "help", "=", "'log directory'", ")", "\n", "parser", ".", "add_argument", "(", "'--test_name'", ",", "type", "=", "str", ",", "default", "=", "'BSD68'", ",", "help", "=", "'name of test set'", ")", "\n", "parser", ".", "add_argument", "(", "'--num_gpu'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'Number of GPU'", ")", "\n", "parser", ".", "add_argument", "(", "'--loss_mod'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "help", "=", "'loss mode'", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n", "start_epoch", "=", "args", ".", "start_epoch", "\n", "end_epoch", "=", "args", ".", "end_epoch", "\n", "learning_rate", "=", "args", ".", "learning_rate", "\n", "layer_num_ICNN", "=", "args", ".", "layer_num_ICNN", "\n", "layer_num_IFC", "=", "args", ".", "layer_num_IFC", "\n", "group_num", "=", "args", ".", "group_num", "\n", "cs_ratio", "=", "args", ".", "cs_ratio", "\n", "gpu_list", "=", "args", ".", "gpu_list", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img": [[62, 79], ["numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.flipud", "numpy.rot90", "numpy.rot90", "numpy.rot90", "numpy.flipud", "numpy.rot90"], "function", ["None"], ["rb_type", "=", "args", ".", "rb_type", "\n", "rb_num", "=", "args", ".", "rb_num", "\n", "batch_size", "=", "args", ".", "batch_size", "\n", "\n", "# os.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"", "\n", "# os.environ[\"CUDA_VISIBLE_DEVICES\"] = gpu_list", "\n", "device", "=", "torch", ".", "device", "(", "\"cuda:0\"", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", "else", "\"cpu\"", ")", "\n", "\n", "ratio_dict", "=", "{", "10", ":", "0", ",", "25", ":", "1", ",", "30", ":", "2", ",", "40", ":", "3", ",", "50", ":", "4", "}", "\n", "\n", "# n_input = ratio_dict[cs_ratio]", "\n", "n_output", "=", "1089", "\n", "nrtrain", "=", "88912", "# number of training blocks", "\n", "psnr_best", "=", "0", "\n", "best_epoch", "=", "0", "\n", "# test data", "\n", "test_name", "=", "args", ".", "test_name", "\n", "test_dir", "=", "os", ".", "path", ".", "join", "(", "'Datasets'", ",", "test_name", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.test_x8": [[80, 90], ["range", "torch.stack", "torch.stack", "torch.stack", "torch.stack.mean", "len", "model", "range", "test.augment_img_tensor", "test.augment_img_tensor", "test.augment_img_tensor"], "function", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.test.augment_img_tensor"], ["# filepaths = glob.glob(test_dir + '/*.tif')", "\n", "filepaths", "=", "glob", ".", "glob", "(", "test_dir", "+", "'/*.png'", ")", "\n", "ImgNum", "=", "len", "(", "filepaths", ")", "\n", "\n", "# Load CS Sampling Matrix: phi", "\n", "Phi_data_Name", "=", "os", ".", "path", ".", "join", "(", "args", ".", "matrix_dir", ",", "\n", "'phi_sampling_%d_%dx%d.npy'", "%", "(", "args", ".", "cs_ratio", ",", "args", ".", "patch_size", ",", "args", ".", "patch_size", ")", ")", "\n", "Phi_input", "=", "np", ".", "load", "(", "Phi_data_Name", ")", "\n", "Phi", "=", "torch", ".", "from_numpy", "(", "Phi_input", ")", ".", "type", "(", "torch", ".", "FloatTensor", ")", "\n", "Phi", "=", "Phi", ".", "to", "(", "device", ")", "# .unsqueeze(0).unsqueeze(0)", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.SKmodel.SKConv.__init__": [[6, 28], ["torch.nn.Module.__init__", "max", "torch.nn.Linear", "torch.nn.ModuleList", "range", "torch.nn.Softmax", "int", "SKmodel.SKConv.fcs.append", "torch.nn.Linear"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "features", ",", "M", ",", "r", ",", "L", "=", "32", ")", ":", "\n", "        ", "\"\"\" Constructor\n        Args:\n            features: input channel dimensionality.\n            WH: input spatial dimensionality, used for GAP kernel size.\n            M: the number of branchs.\n            G: num of convolution groups.\n            r: the radio for compute d, the length of z.\n            stride: stride, default 1.\n            L: the minimum dim of the vector z in paper, default 32.\n        \"\"\"", "\n", "super", "(", "SKConv", ",", "self", ")", ".", "__init__", "(", ")", "\n", "d", "=", "max", "(", "int", "(", "features", "/", "r", ")", ",", "L", ")", "\n", "self", ".", "M", "=", "M", "\n", "self", ".", "features", "=", "features", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "features", ",", "d", ")", "\n", "self", ".", "fcs", "=", "nn", ".", "ModuleList", "(", "[", "]", ")", "\n", "for", "i", "in", "range", "(", "M", ")", ":", "\n", "            ", "self", ".", "fcs", ".", "append", "(", "\n", "nn", ".", "Linear", "(", "d", ",", "features", ")", "\n", ")", "\n", "", "self", ".", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.SKmodel.SKConv.forward": [[29, 44], ["torch.cat", "torch.sum", "torch.sum.mean().mean", "SKmodel.SKConv.fc", "enumerate", "SKmodel.SKConv.softmax", "torch.cat.unsqueeze().unsqueeze", "fc().unsqueeze_", "x1.unsqueeze", "x2.unsqueeze", "torch.sum.mean", "torch.cat", "torch.cat.unsqueeze", "fc"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x1", ",", "x2", ")", ":", "\n", "        ", "feas", "=", "torch", ".", "cat", "(", "[", "x1", ".", "unsqueeze", "(", "dim", "=", "1", ")", ",", "x2", ".", "unsqueeze", "(", "dim", "=", "1", ")", "]", ",", "dim", "=", "1", ")", "\n", "fea_U", "=", "torch", ".", "sum", "(", "feas", ",", "dim", "=", "1", ")", "\n", "fea_s", "=", "fea_U", ".", "mean", "(", "-", "1", ")", ".", "mean", "(", "-", "1", ")", "\n", "fea_z", "=", "self", ".", "fc", "(", "fea_s", ")", "\n", "for", "i", ",", "fc", "in", "enumerate", "(", "self", ".", "fcs", ")", ":", "\n", "            ", "vector", "=", "fc", "(", "fea_z", ")", ".", "unsqueeze_", "(", "dim", "=", "1", ")", "\n", "if", "i", "==", "0", ":", "\n", "                ", "attention_vectors", "=", "vector", "\n", "", "else", ":", "\n", "                ", "attention_vectors", "=", "torch", ".", "cat", "(", "[", "attention_vectors", ",", "vector", "]", ",", "dim", "=", "1", ")", "\n", "", "", "attention_vectors", "=", "self", ".", "softmax", "(", "attention_vectors", ")", "\n", "attention_vectors", "=", "attention_vectors", ".", "unsqueeze", "(", "-", "1", ")", ".", "unsqueeze", "(", "-", "1", ")", "\n", "fea_v", "=", "(", "feas", "*", "attention_vectors", ")", ".", "sum", "(", "dim", "=", "1", ")", "\n", "return", "fea_v", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.SKmodel.SKUnit.__init__": [[47, 77], ["torch.nn.Module.__init__", "torch.nn.Sequential", "int", "torch.nn.Conv2d", "torch.nn.BatchNorm2d", "SKmodel.SKConv", "torch.nn.BatchNorm2d", "torch.nn.Conv2d", "torch.nn.BatchNorm2d", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Conv2d", "torch.nn.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_features", ",", "out_features", ",", "WH", ",", "M", ",", "G", ",", "r", ",", "mid_features", "=", "None", ",", "stride", "=", "1", ",", "L", "=", "32", ")", ":", "\n", "        ", "\"\"\" Constructor\n        Args:\n            in_features: input channel dimensionality.\n            out_features: output channel dimensionality.\n            WH: input spatial dimensionality, used for GAP kernel size.\n            M: the number of branchs.\n            G: num of convolution groups.\n            r: the radio for compute d, the length of z.\n            mid_features: the channle dim of the middle conv with stride not 1, default out_features/2.\n            stride: stride.\n            L: the minimum dim of the vector z in paper.\n        \"\"\"", "\n", "super", "(", "SKUnit", ",", "self", ")", ".", "__init__", "(", ")", "\n", "if", "mid_features", "is", "None", ":", "\n", "            ", "mid_features", "=", "int", "(", "out_features", "/", "2", ")", "\n", "", "self", ".", "feas", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_features", ",", "mid_features", ",", "1", ",", "stride", "=", "1", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "mid_features", ")", ",", "\n", "SKConv", "(", "mid_features", ",", "WH", ",", "M", ",", "G", ",", "r", ",", "stride", "=", "stride", ",", "L", "=", "L", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "mid_features", ")", ",", "\n", "nn", ".", "Conv2d", "(", "mid_features", ",", "out_features", ",", "1", ",", "stride", "=", "1", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "out_features", ")", "\n", ")", "\n", "if", "in_features", "==", "out_features", ":", "# when dim not change, in could be added diectly to out", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", ")", "\n", "", "else", ":", "# when dim not change, in should also change dim to be added to out", "\n", "            ", "self", ".", "shortcut", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_features", ",", "out_features", ",", "1", ",", "stride", "=", "stride", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "out_features", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.SKmodel.SKUnit.forward": [[79, 82], ["SKmodel.SKUnit.feas", "SKmodel.SKUnit.shortcut"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "fea", "=", "self", ".", "feas", "(", "x", ")", "\n", "return", "fea", "+", "self", ".", "shortcut", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.SKmodel.SKNet.__init__": [[85, 118], ["torch.nn.Module.__init__", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.AvgPool2d", "torch.nn.Sequential", "torch.nn.Conv2d", "torch.nn.BatchNorm2d", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "SKmodel.SKUnit", "torch.nn.ReLU", "torch.nn.Linear"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ",", "class_num", ")", ":", "\n", "        ", "super", "(", "SKNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "basic_conv", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "3", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "64", ")", "\n", ")", "# 32x32", "\n", "self", ".", "stage_1", "=", "nn", ".", "Sequential", "(", "\n", "SKUnit", "(", "64", ",", "256", ",", "32", ",", "2", ",", "8", ",", "2", ",", "stride", "=", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "SKUnit", "(", "256", ",", "256", ",", "32", ",", "2", ",", "8", ",", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "SKUnit", "(", "256", ",", "256", ",", "32", ",", "2", ",", "8", ",", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "# 32x32", "\n", "self", ".", "stage_2", "=", "nn", ".", "Sequential", "(", "\n", "SKUnit", "(", "256", ",", "512", ",", "32", ",", "2", ",", "8", ",", "2", ",", "stride", "=", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "SKUnit", "(", "512", ",", "512", ",", "32", ",", "2", ",", "8", ",", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "SKUnit", "(", "512", ",", "512", ",", "32", ",", "2", ",", "8", ",", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "# 16x16", "\n", "self", ".", "stage_3", "=", "nn", ".", "Sequential", "(", "\n", "SKUnit", "(", "512", ",", "1024", ",", "32", ",", "2", ",", "8", ",", "2", ",", "stride", "=", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "SKUnit", "(", "1024", ",", "1024", ",", "32", ",", "2", ",", "8", ",", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "SKUnit", "(", "1024", ",", "1024", ",", "32", ",", "2", ",", "8", ",", "2", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "# 8x8", "\n", "self", ".", "pool", "=", "nn", ".", "AvgPool2d", "(", "8", ")", "\n", "self", ".", "classifier", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Linear", "(", "1024", ",", "class_num", ")", ",", "\n", "# nn.Softmax(dim=1)", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.SKmodel.SKNet.forward": [[121, 130], ["SKmodel.SKNet.basic_conv", "SKmodel.SKNet.stage_1", "SKmodel.SKNet.stage_2", "SKmodel.SKNet.stage_3", "SKmodel.SKNet.pool", "torch.squeeze", "SKmodel.SKNet.classifier"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "fea", "=", "self", ".", "basic_conv", "(", "x", ")", "\n", "fea", "=", "self", ".", "stage_1", "(", "fea", ")", "\n", "fea", "=", "self", ".", "stage_2", "(", "fea", ")", "\n", "fea", "=", "self", ".", "stage_3", "(", "fea", ")", "\n", "fea", "=", "self", ".", "pool", "(", "fea", ")", "\n", "fea", "=", "torch", ".", "squeeze", "(", "fea", ")", "\n", "fea", "=", "self", ".", "classifier", "(", "fea", ")", "\n", "return", "fea", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTrain.__init__": [[13, 26], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "len", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["", "class", "DataLoaderTrain", "(", "Dataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "rgb_dir", ",", "img_options", "=", "None", ")", ":", "\n", "        ", "super", "(", "DataLoaderTrain", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "inp_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ")", ")", ")", "\n", "tar_files", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ")", ")", ")", "\n", "\n", "self", ".", "inp_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "img_options", "=", "img_options", "\n", "self", ".", "sizex", "=", "len", "(", "self", ".", "tar_filenames", ")", "# get the size of target", "\n", "\n", "self", ".", "ps", "=", "self", ".", "img_options", "[", "'patch_size'", "]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTrain.__len__": [[27, 29], ["None"], "methods", ["None"], ["\n", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "sizex", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTrain.__getitem__": [[30, 88], ["PIL.Image.open", "PIL.Image.open", "torchvision.to_tensor", "torchvision.to_tensor", "random.randint", "random.randint", "random.randint", "torchvision.pad", "torchvision.pad", "torch.rot90.flip", "torch.rot90.flip", "os.path.splitext", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "os.path.split", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip", "torch.rot90", "torch.rot90", "torch.rot90.flip", "torch.rot90.flip"], "methods", ["None"], ["\n", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "index_", "=", "index", "%", "self", ".", "sizex", "\n", "ps", "=", "self", ".", "ps", "\n", "\n", "inp_path", "=", "self", ".", "inp_filenames", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames", "[", "index_", "]", "\n", "\n", "inp_img", "=", "Image", ".", "open", "(", "inp_path", ")", "\n", "tar_img", "=", "Image", ".", "open", "(", "tar_path", ")", "\n", "\n", "w", ",", "h", "=", "tar_img", ".", "size", "\n", "padw", "=", "ps", "-", "w", "if", "w", "<", "ps", "else", "0", "\n", "padh", "=", "ps", "-", "h", "if", "h", "<", "ps", "else", "0", "\n", "\n", "# Reflect Pad in case image is smaller than patch_size", "\n", "if", "padw", "!=", "0", "or", "padh", "!=", "0", ":", "\n", "            ", "inp_img", "=", "TF", ".", "pad", "(", "inp_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "tar_img", "=", "TF", ".", "pad", "(", "tar_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "TF", ".", "adjust_gamma", "(", "inp_img", ",", "1", ")", "\n", "tar_img", "=", "TF", ".", "adjust_gamma", "(", "tar_img", ",", "1", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "sat_factor", "=", "1", "+", "(", "0.2", "-", "0.4", "*", "np", ".", "random", ".", "rand", "(", ")", ")", "\n", "inp_img", "=", "TF", ".", "adjust_saturation", "(", "inp_img", ",", "sat_factor", ")", "\n", "tar_img", "=", "TF", ".", "adjust_saturation", "(", "tar_img", ",", "sat_factor", ")", "\n", "\n", "", "inp_img", "=", "TF", ".", "to_tensor", "(", "inp_img", ")", "\n", "tar_img", "=", "TF", ".", "to_tensor", "(", "tar_img", ")", "\n", "\n", "hh", ",", "ww", "=", "tar_img", ".", "shape", "[", "1", "]", ",", "tar_img", ".", "shape", "[", "2", "]", "\n", "\n", "rr", "=", "random", ".", "randint", "(", "0", ",", "hh", "-", "ps", ")", "\n", "cc", "=", "random", ".", "randint", "(", "0", ",", "ww", "-", "ps", ")", "\n", "aug", "=", "random", ".", "randint", "(", "0", ",", "8", ")", "\n", "\n", "# Crop patch", "\n", "inp_img", "=", "inp_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "tar_img", "=", "tar_img", "[", ":", ",", "rr", ":", "rr", "+", "ps", ",", "cc", ":", "cc", "+", "ps", "]", "\n", "\n", "# Data Augmentations", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "1", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "1", ")", "\n", "", "elif", "aug", "==", "2", ":", "\n", "            ", "inp_img", "=", "inp_img", ".", "flip", "(", "2", ")", "\n", "tar_img", "=", "tar_img", ".", "flip", "(", "2", ")", "\n", "", "elif", "aug", "==", "3", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "4", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "2", ")", "\n", "", "elif", "aug", "==", "5", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ",", "dims", "=", "(", "1", ",", "2", ")", ",", "k", "=", "3", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderVal.__init__": [[90, 103], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "len", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["", "elif", "aug", "==", "6", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "1", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "", "elif", "aug", "==", "7", ":", "\n", "            ", "inp_img", "=", "torch", ".", "rot90", "(", "inp_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "tar_img", "=", "torch", ".", "rot90", "(", "tar_img", ".", "flip", "(", "2", ")", ",", "dims", "=", "(", "1", ",", "2", ")", ")", "\n", "\n", "", "filename", "=", "os", ".", "path", ".", "splitext", "(", "os", ".", "path", ".", "split", "(", "tar_path", ")", "[", "-", "1", "]", ")", "[", "0", "]", "\n", "\n", "return", "tar_img", ",", "inp_img", ",", "filename", "\n", "\n", "", "", "class", "DataLoaderTrain_all", "(", "Dataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "rgb_dir", ",", "img_options", "=", "None", ")", ":", "\n", "        ", "super", "(", "DataLoaderTrain_all", ",", "self", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderVal.__len__": [[104, 106], ["None"], "methods", ["None"], ["\n", "inp_files_noise", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_noise", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'target'", ")", ")", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderVal.__getitem__": [[107, 128], ["PIL.Image.open", "PIL.Image.open", "torchvision.to_tensor", "torchvision.to_tensor", "torchvision.center_crop", "torchvision.center_crop", "os.path.splitext", "os.path.split"], "methods", ["None"], ["inp_files_blur", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_blur", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'target'", ")", ")", ")", "\n", "inp_files_rain", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'input'", ")", ")", ")", "\n", "tar_files_rain", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'target'", ")", ")", ")", "\n", "\n", "self", ".", "inp_filenames_noise", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_noise", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_noise", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "0", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_noise", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "inp_filenames_blur", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_blur", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_blur", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "1", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_blur", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "inp_filenames_rain", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'input'", ",", "x", ")", "for", "x", "in", "inp_files_rain", "if", "is_image_file", "(", "x", ")", "]", "\n", "self", ".", "tar_filenames_rain", "=", "[", "os", ".", "path", ".", "join", "(", "rgb_dir", "[", "2", "]", ",", "'target'", ",", "x", ")", "for", "x", "in", "tar_files_rain", "if", "is_image_file", "(", "x", ")", "]", "\n", "\n", "self", ".", "img_options", "=", "img_options", "\n", "self", ".", "sizex_noise", "=", "len", "(", "self", ".", "tar_filenames_noise", ")", "# get the size of target", "\n", "self", ".", "sizex_blur", "=", "len", "(", "self", ".", "tar_filenames_blur", ")", "\n", "self", ".", "sizex_rain", "=", "len", "(", "self", ".", "tar_filenames_rain", ")", "\n", "\n", "self", ".", "ps_noise", "=", "self", ".", "img_options", "[", "'patch_size_noise'", "]", "\n", "self", ".", "ps_blur", "=", "self", ".", "img_options", "[", "'patch_size_blur'", "]", "\n", "self", ".", "ps_rain", "=", "self", ".", "img_options", "[", "'patch_size_rain'", "]", "\n", "\n", "", "def", "__len__", "(", "self", ")", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTest.__init__": [[130, 138], ["torch.utils.data.Dataset.__init__", "sorted", "len", "os.listdir", "os.path.join", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["\n", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "id_", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "3", ")", "\n", "if", "id_", "==", "0", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_noise", "\n", "ps", "=", "self", ".", "ps_noise", "\n", "inp_path", "=", "self", ".", "inp_filenames_noise", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_noise", "[", "index_", "]", "\n", "", "elif", "id_", "==", "1", ":", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTest.__len__": [[139, 141], ["None"], "methods", ["None"], ["            ", "index_", "=", "index", "%", "self", ".", "sizex_blur", "\n", "ps", "=", "self", ".", "ps_blur", "\n", "inp_path", "=", "self", ".", "inp_filenames_blur", "[", "index_", "]", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTest.__getitem__": [[142, 150], ["PIL.Image.open", "torchvision.to_tensor", "os.path.splitext", "os.path.split"], "methods", ["None"], ["tar_path", "=", "self", ".", "tar_filenames_blur", "[", "index_", "]", "\n", "", "else", ":", "\n", "            ", "index_", "=", "index", "%", "self", ".", "sizex_rain", "\n", "ps", "=", "self", ".", "ps_rain", "\n", "inp_path", "=", "self", ".", "inp_filenames_rain", "[", "index_", "]", "\n", "tar_path", "=", "self", ".", "tar_filenames_rain", "[", "index_", "]", "\n", "\n", "", "inp_img", "=", "Image", ".", "open", "(", "inp_path", ")", "\n", "tar_img", "=", "Image", ".", "open", "(", "tar_path", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTest_fine.__init__": [[152, 163], ["torch.utils.data.Dataset.__init__", "sorted", "sorted", "len", "os.listdir", "os.listdir", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "dataset_RGB.is_image_file", "dataset_RGB.is_image_file"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file"], ["w", ",", "h", "=", "tar_img", ".", "size", "\n", "padw", "=", "ps", "-", "w", "if", "w", "<", "ps", "else", "0", "\n", "padh", "=", "ps", "-", "h", "if", "h", "<", "ps", "else", "0", "\n", "\n", "# Reflect Pad in case image is smaller than patch_size", "\n", "if", "padw", "!=", "0", "or", "padh", "!=", "0", ":", "\n", "            ", "inp_img", "=", "TF", ".", "pad", "(", "inp_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "tar_img", "=", "TF", ".", "pad", "(", "tar_img", ",", "(", "0", ",", "0", ",", "padw", ",", "padh", ")", ",", "padding_mode", "=", "'reflect'", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n", "if", "aug", "==", "1", ":", "\n", "            ", "inp_img", "=", "TF", ".", "adjust_gamma", "(", "inp_img", ",", "1", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTest_fine.__len__": [[164, 166], ["None"], "methods", ["None"], ["tar_img", "=", "TF", ".", "adjust_gamma", "(", "tar_img", ",", "1", ")", "\n", "\n", "", "aug", "=", "random", ".", "randint", "(", "0", ",", "2", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.DataLoaderTest_fine.__getitem__": [[167, 178], ["PIL.Image.open", "PIL.Image.open", "torchvision.to_tensor", "torchvision.to_tensor", "os.path.splitext", "os.path.split"], "methods", ["None"], ["if", "aug", "==", "1", ":", "\n", "            ", "sat_factor", "=", "1", "+", "(", "0.2", "-", "0.4", "*", "np", ".", "random", ".", "rand", "(", ")", ")", "\n", "inp_img", "=", "TF", ".", "adjust_saturation", "(", "inp_img", ",", "sat_factor", ")", "\n", "tar_img", "=", "TF", ".", "adjust_saturation", "(", "tar_img", ",", "sat_factor", ")", "\n", "\n", "", "inp_img", "=", "TF", ".", "to_tensor", "(", "inp_img", ")", "\n", "tar_img", "=", "TF", ".", "to_tensor", "(", "tar_img", ")", "\n", "\n", "hh", ",", "ww", "=", "tar_img", ".", "shape", "[", "1", "]", ",", "tar_img", ".", "shape", "[", "2", "]", "\n", "\n", "rr", "=", "random", ".", "randint", "(", "0", ",", "hh", "-", "ps", ")", "\n", "cc", "=", "random", ".", "randint", "(", "0", ",", "ww", "-", "ps", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.dataset_RGB.is_image_file": [[9, 11], ["any", "filename.endswith"], "function", ["None"], ["\n", "def", "is_image_file", "(", "filename", ")", ":", "\n", "    ", "return", "any", "(", "filename", ".", "endswith", "(", "extension", ")", "for", "extension", "in", "[", "'jpeg'", ",", "'JPEG'", ",", "'jpg'", ",", "'png'", ",", "'JPG'", ",", "'PNG'", ",", "'gif'", "]", ")", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.CharbonnierLoss.__init__": [[8, 11], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["def", "__init__", "(", "self", ",", "eps", "=", "1e-3", ")", ":", "\n", "        ", "super", "(", "CharbonnierLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "eps", "=", "eps", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.CharbonnierLoss.forward": [[12, 17], ["torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "diff", "=", "x", "-", "y", "\n", "# loss = torch.sum(torch.sqrt(diff * diff + self.eps))", "\n", "loss", "=", "torch", ".", "mean", "(", "torch", ".", "sqrt", "(", "(", "diff", "*", "diff", ")", "+", "(", "self", ".", "eps", "*", "self", ".", "eps", ")", ")", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__": [[19, 26], ["torch.Module.__init__", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.matmul().unsqueeze().repeat", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "losses.CharbonnierLoss", "losses.EdgeLoss.kernel.cuda", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul().unsqueeze", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.Tensor.t", "torch.Tensor.t", "torch.Tensor.t"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "EdgeLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "k", "=", "torch", ".", "Tensor", "(", "[", "[", ".05", ",", ".25", ",", ".4", ",", ".25", ",", ".05", "]", "]", ")", "\n", "self", ".", "kernel", "=", "torch", ".", "matmul", "(", "k", ".", "t", "(", ")", ",", "k", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "3", ",", "1", ",", "1", ",", "1", ")", "\n", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", ":", "\n", "            ", "self", ".", "kernel", "=", "self", ".", "kernel", ".", "cuda", "(", ")", "\n", "", "self", ".", "loss", "=", "CharbonnierLoss", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss": [[27, 31], ["torch.pad", "torch.pad", "torch.pad", "torch.conv2d", "torch.conv2d", "torch.conv2d"], "methods", ["None"], ["", "def", "conv_gauss", "(", "self", ",", "img", ")", ":", "\n", "        ", "n_channels", ",", "_", ",", "kw", ",", "kh", "=", "self", ".", "kernel", ".", "shape", "\n", "img", "=", "F", ".", "pad", "(", "img", ",", "(", "kw", "//", "2", ",", "kh", "//", "2", ",", "kw", "//", "2", ",", "kh", "//", "2", ")", ",", "mode", "=", "'replicate'", ")", "\n", "return", "F", ".", "conv2d", "(", "img", ",", "self", ".", "kernel", ",", "groups", "=", "n_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel": [[32, 40], ["losses.EdgeLoss.conv_gauss", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "losses.EdgeLoss.conv_gauss"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.conv_gauss"], ["", "def", "laplacian_kernel", "(", "self", ",", "current", ")", ":", "\n", "        ", "filtered", "=", "self", ".", "conv_gauss", "(", "current", ")", "# filter", "\n", "down", "=", "filtered", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "# downsample", "\n", "new_filter", "=", "torch", ".", "zeros_like", "(", "filtered", ")", "\n", "new_filter", "[", ":", ",", ":", ",", ":", ":", "2", ",", ":", ":", "2", "]", "=", "down", "*", "4", "# upsample", "\n", "filtered", "=", "self", ".", "conv_gauss", "(", "new_filter", ")", "# filter", "\n", "diff", "=", "current", "-", "filtered", "\n", "return", "diff", "\n", "\n"]], "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.forward": [[41, 44], ["losses.EdgeLoss.loss", "losses.EdgeLoss.laplacian_kernel", "losses.EdgeLoss.laplacian_kernel"], "methods", ["home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel", "home.repos.pwc.inspect_result.mc-e_deep-generalized-unfolding-networks-for-image-restoration.Deraining.losses.EdgeLoss.laplacian_kernel"], ["", "def", "forward", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "loss", "=", "self", ".", "loss", "(", "self", ".", "laplacian_kernel", "(", "x", ")", ",", "self", ".", "laplacian_kernel", "(", "y", ")", ")", "\n", "return", "loss", "\n", "", "", ""]]}