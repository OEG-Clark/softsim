{"home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.test_data.test_pair_dataset": [[6, 38], ["torch.randn", "torch.randint", "torch_geometric.data.Data", "dgmc.utils.PairDataset", "torch.allclose", "torch.allclose", "dgmc.utils.PairDataset", "torch.allclose", "torch.allclose", "torch.randn.size", "dgmc.utils.PairDataset.__repr__", "len", "len", "pair.edge_index_s.tolist", "torch.randint.tolist", "pair.edge_index_t.tolist", "torch.randint.tolist", "dgmc.utils.PairDataset.__repr__", "len", "len", "pair.edge_index_s.tolist", "torch.randint.tolist", "pair.edge_index_t.tolist", "torch.randint.tolist"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__"], ["def", "test_pair_dataset", "(", ")", ":", "\n", "    ", "x", "=", "torch", ".", "randn", "(", "10", ",", "16", ")", "\n", "edge_index", "=", "torch", ".", "randint", "(", "x", ".", "size", "(", "0", ")", ",", "(", "2", ",", "30", ")", ",", "dtype", "=", "torch", ".", "long", ")", "\n", "data", "=", "Data", "(", "x", "=", "x", ",", "edge_index", "=", "edge_index", ")", "\n", "\n", "dataset", "=", "PairDataset", "(", "[", "data", ",", "data", "]", ",", "[", "data", ",", "data", "]", ",", "sample", "=", "True", ")", "\n", "assert", "dataset", ".", "__repr__", "(", ")", "==", "(", "\n", "'PairDataset([Data(edge_index=[2, 30], x=[10, 16]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16])], ['", "\n", "'Data(edge_index=[2, 30], x=[10, 16]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16])], sample=True)'", ")", "\n", "assert", "len", "(", "dataset", ")", "==", "2", "\n", "pair", "=", "dataset", "[", "0", "]", "\n", "assert", "len", "(", "pair", ")", "==", "4", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_s", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_s", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_t", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_t", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "\n", "dataset", "=", "PairDataset", "(", "[", "data", ",", "data", "]", ",", "[", "data", ",", "data", "]", ",", "sample", "=", "False", ")", "\n", "assert", "dataset", ".", "__repr__", "(", ")", "==", "(", "\n", "'PairDataset([Data(edge_index=[2, 30], x=[10, 16]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16])], ['", "\n", "'Data(edge_index=[2, 30], x=[10, 16]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16])], sample=False)'", ")", "\n", "assert", "len", "(", "dataset", ")", "==", "4", "\n", "pair", "=", "dataset", "[", "0", "]", "\n", "assert", "len", "(", "pair", ")", "==", "4", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_s", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_s", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_t", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_t", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.test_data.test_valid_pair_dataset": [[40, 75], ["torch.randn", "torch.randint", "torch.randperm", "torch_geometric.data.Data", "dgmc.utils.ValidPairDataset", "torch.allclose", "torch.allclose", "dgmc.utils.ValidPairDataset", "torch.allclose", "torch.allclose", "torch.randn.size", "torch.randn.size", "dgmc.utils.ValidPairDataset.__repr__", "len", "len", "pair.edge_index_s.tolist", "torch.randint.tolist", "pair.edge_index_t.tolist", "torch.randint.tolist", "pair.y.tolist", "torch.arange().tolist", "dgmc.utils.ValidPairDataset.__repr__", "len", "len", "pair.edge_index_s.tolist", "torch.randint.tolist", "pair.edge_index_t.tolist", "torch.randint.tolist", "pair.y.tolist", "torch.arange().tolist", "torch.arange", "torch.arange", "torch.randn.size", "torch.randn.size"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__"], ["", "def", "test_valid_pair_dataset", "(", ")", ":", "\n", "    ", "x", "=", "torch", ".", "randn", "(", "10", ",", "16", ")", "\n", "edge_index", "=", "torch", ".", "randint", "(", "x", ".", "size", "(", "0", ")", ",", "(", "2", ",", "30", ")", ",", "dtype", "=", "torch", ".", "long", ")", "\n", "y", "=", "torch", ".", "randperm", "(", "x", ".", "size", "(", "0", ")", ")", "\n", "data", "=", "Data", "(", "x", "=", "x", ",", "edge_index", "=", "edge_index", ",", "y", "=", "y", ")", "\n", "\n", "dataset", "=", "ValidPairDataset", "(", "[", "data", ",", "data", "]", ",", "[", "data", ",", "data", "]", ",", "sample", "=", "True", ")", "\n", "assert", "dataset", ".", "__repr__", "(", ")", "==", "(", "\n", "'ValidPairDataset([Data(edge_index=[2, 30], x=[10, 16], y=[10]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16], y=[10])], ['", "\n", "'Data(edge_index=[2, 30], x=[10, 16], y=[10]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16], y=[10])], sample=True)'", ")", "\n", "assert", "len", "(", "dataset", ")", "==", "2", "\n", "pair", "=", "dataset", "[", "0", "]", "\n", "assert", "len", "(", "pair", ")", "==", "5", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_s", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_s", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_t", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_t", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "assert", "pair", ".", "y", ".", "tolist", "(", ")", "==", "torch", ".", "arange", "(", "x", ".", "size", "(", "0", ")", ")", ".", "tolist", "(", ")", "\n", "\n", "dataset", "=", "ValidPairDataset", "(", "[", "data", ",", "data", "]", ",", "[", "data", ",", "data", "]", ",", "sample", "=", "False", ")", "\n", "assert", "dataset", ".", "__repr__", "(", ")", "==", "(", "\n", "'ValidPairDataset([Data(edge_index=[2, 30], x=[10, 16], y=[10]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16], y=[10])], ['", "\n", "'Data(edge_index=[2, 30], x=[10, 16], y=[10]), '", "\n", "'Data(edge_index=[2, 30], x=[10, 16], y=[10])], sample=False)'", ")", "\n", "assert", "len", "(", "dataset", ")", "==", "4", "\n", "pair", "=", "dataset", "[", "0", "]", "\n", "assert", "len", "(", "pair", ")", "==", "5", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_s", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_s", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "assert", "torch", ".", "allclose", "(", "pair", ".", "x_t", ",", "x", ")", "\n", "assert", "pair", ".", "edge_index_t", ".", "tolist", "(", ")", "==", "edge_index", ".", "tolist", "(", ")", "\n", "assert", "pair", ".", "y", ".", "tolist", "(", ")", "==", "torch", ".", "arange", "(", "x", ".", "size", "(", "0", ")", ")", ".", "tolist", "(", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.PairData.__inc__": [[10, 17], ["bool", "bool", "re.search", "data.PairData.x_s.size", "re.search", "data.PairData.x_t.size"], "methods", ["None"], ["    ", "def", "__inc__", "(", "self", ",", "key", ",", "value", ",", "*", "args", ")", ":", "\n", "        ", "if", "bool", "(", "re", ".", "search", "(", "'index_s'", ",", "key", ")", ")", ":", "\n", "            ", "return", "self", ".", "x_s", ".", "size", "(", "0", ")", "\n", "", "if", "bool", "(", "re", ".", "search", "(", "'index_t'", ",", "key", ")", ")", ":", "\n", "            ", "return", "self", ".", "x_t", ".", "size", "(", "0", ")", "\n", "", "else", ":", "\n", "            ", "return", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.PairDataset.__init__": [[30, 34], ["None"], "methods", ["None"], ["def", "__init__", "(", "self", ",", "dataset_s", ",", "dataset_t", ",", "sample", "=", "False", ")", ":", "\n", "        ", "self", ".", "dataset_s", "=", "dataset_s", "\n", "self", ".", "dataset_t", "=", "dataset_t", "\n", "self", ".", "sample", "=", "sample", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.PairDataset.__len__": [[35, 38], ["len", "len", "len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "dataset_s", ")", "if", "self", ".", "sample", "else", "len", "(", "\n", "self", ".", "dataset_s", ")", "*", "len", "(", "self", ".", "dataset_t", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.PairDataset.__getitem__": [[39, 55], ["data.PairData", "random.randint", "len", "len", "len"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "if", "self", ".", "sample", ":", "\n", "            ", "data_s", "=", "self", ".", "dataset_s", "[", "idx", "]", "\n", "data_t", "=", "self", ".", "dataset_t", "[", "random", ".", "randint", "(", "0", ",", "len", "(", "self", ".", "dataset_t", ")", "-", "1", ")", "]", "\n", "", "else", ":", "\n", "            ", "data_s", "=", "self", ".", "dataset_s", "[", "idx", "//", "len", "(", "self", ".", "dataset_t", ")", "]", "\n", "data_t", "=", "self", ".", "dataset_t", "[", "idx", "%", "len", "(", "self", ".", "dataset_t", ")", "]", "\n", "\n", "", "return", "PairData", "(", "\n", "x_s", "=", "data_s", ".", "x", ",", "\n", "edge_index_s", "=", "data_s", ".", "edge_index", ",", "\n", "edge_attr_s", "=", "data_s", ".", "edge_attr", ",", "\n", "x_t", "=", "data_t", ".", "x", ",", "\n", "edge_index_t", "=", "data_t", ".", "edge_index", ",", "\n", "edge_attr_t", "=", "data_t", ".", "edge_attr", ",", "\n", "num_nodes", "=", "None", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.PairDataset.__repr__": [[57, 61], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "'{}({}, {}, sample={})'", ".", "format", "(", "self", ".", "__class__", ".", "__name__", ",", "\n", "self", ".", "dataset_s", ",", "self", ".", "dataset_t", ",", "\n", "self", ".", "sample", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.ValidPairDataset.__init__": [[76, 81], ["data.ValidPairDataset.__compute_pairs__"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.ValidPairDataset.__compute_pairs__"], ["def", "__init__", "(", "self", ",", "dataset_s", ",", "dataset_t", ",", "sample", "=", "False", ")", ":", "\n", "        ", "self", ".", "dataset_s", "=", "dataset_s", "\n", "self", ".", "dataset_t", "=", "dataset_t", "\n", "self", ".", "sample", "=", "sample", "\n", "self", ".", "pairs", ",", "self", ".", "cumdeg", "=", "self", ".", "__compute_pairs__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.ValidPairDataset.__compute_pairs__": [[82, 102], ["itertools.chain", "torch.zeros", "torch.zeros", "enumerate", "enumerate", "y_s.view.view.view", "y_t.view.view.view", "pairs[].bincount().cumsum", "max", "len", "len", "pairs.tolist", "len", "len", "pairs[].bincount", "pairs[].bincount().cumsum.tolist", "data.y.max().item", "y_s.view.view.sum", "data.y.max"], "methods", ["None"], ["", "def", "__compute_pairs__", "(", "self", ")", ":", "\n", "        ", "num_classes", "=", "0", "\n", "for", "data", "in", "chain", "(", "self", ".", "dataset_s", ",", "self", ".", "dataset_t", ")", ":", "\n", "            ", "num_classes", "=", "max", "(", "num_classes", ",", "data", ".", "y", ".", "max", "(", ")", ".", "item", "(", ")", "+", "1", ")", "\n", "\n", "", "y_s", "=", "torch", ".", "zeros", "(", "(", "len", "(", "self", ".", "dataset_s", ")", ",", "num_classes", ")", ",", "dtype", "=", "torch", ".", "bool", ")", "\n", "y_t", "=", "torch", ".", "zeros", "(", "(", "len", "(", "self", ".", "dataset_t", ")", ",", "num_classes", ")", ",", "dtype", "=", "torch", ".", "bool", ")", "\n", "\n", "for", "i", ",", "data", "in", "enumerate", "(", "self", ".", "dataset_s", ")", ":", "\n", "            ", "y_s", "[", "i", ",", "data", ".", "y", "]", "=", "1", "\n", "", "for", "i", ",", "data", "in", "enumerate", "(", "self", ".", "dataset_t", ")", ":", "\n", "            ", "y_t", "[", "i", ",", "data", ".", "y", "]", "=", "1", "\n", "\n", "", "y_s", "=", "y_s", ".", "view", "(", "len", "(", "self", ".", "dataset_s", ")", ",", "1", ",", "num_classes", ")", "\n", "y_t", "=", "y_t", ".", "view", "(", "1", ",", "len", "(", "self", ".", "dataset_t", ")", ",", "num_classes", ")", "\n", "\n", "pairs", "=", "(", "(", "y_s", "*", "y_t", ")", ".", "sum", "(", "dim", "=", "-", "1", ")", "==", "y_s", ".", "sum", "(", "dim", "=", "-", "1", ")", ")", ".", "nonzero", "(", ")", "\n", "cumdeg", "=", "pairs", "[", ":", ",", "0", "]", ".", "bincount", "(", ")", ".", "cumsum", "(", "dim", "=", "0", ")", "\n", "\n", "return", "pairs", ".", "tolist", "(", ")", ",", "[", "0", "]", "+", "cumdeg", ".", "tolist", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.ValidPairDataset.__len__": [[103, 105], ["len", "len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "dataset_s", ")", "if", "self", ".", "sample", "else", "len", "(", "self", ".", "pairs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.ValidPairDataset.__getitem__": [[106, 128], ["data_s.y.new_full", "torch.arange", "data.PairData", "random.randint", "data_t.y.max().item", "data_t.y.max"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "if", "self", ".", "sample", ":", "\n", "            ", "data_s", "=", "self", ".", "dataset_s", "[", "idx", "]", "\n", "i", "=", "random", ".", "randint", "(", "self", ".", "cumdeg", "[", "idx", "]", ",", "self", ".", "cumdeg", "[", "idx", "+", "1", "]", "-", "1", ")", "\n", "data_t", "=", "self", ".", "dataset_t", "[", "self", ".", "pairs", "[", "i", "]", "[", "1", "]", "]", "\n", "", "else", ":", "\n", "            ", "data_s", "=", "self", ".", "dataset_s", "[", "self", ".", "pairs", "[", "idx", "]", "[", "0", "]", "]", "\n", "data_t", "=", "self", ".", "dataset_t", "[", "self", ".", "pairs", "[", "idx", "]", "[", "1", "]", "]", "\n", "\n", "", "y", "=", "data_s", ".", "y", ".", "new_full", "(", "(", "data_t", ".", "y", ".", "max", "(", ")", ".", "item", "(", ")", "+", "1", ",", ")", ",", "-", "1", ")", "\n", "y", "[", "data_t", ".", "y", "]", "=", "torch", ".", "arange", "(", "data_t", ".", "num_nodes", ")", "\n", "y", "=", "y", "[", "data_s", ".", "y", "]", "\n", "\n", "return", "PairData", "(", "\n", "x_s", "=", "data_s", ".", "x", ",", "\n", "edge_index_s", "=", "data_s", ".", "edge_index", ",", "\n", "edge_attr_s", "=", "data_s", ".", "edge_attr", ",", "\n", "x_t", "=", "data_t", ".", "x", ",", "\n", "edge_index_t", "=", "data_t", ".", "edge_index", ",", "\n", "edge_attr_t", "=", "data_t", ".", "edge_attr", ",", "\n", "y", "=", "y", ",", "\n", "num_nodes", "=", "None", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.utils.data.ValidPairDataset.__repr__": [[130, 134], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "'{}({}, {}, sample={})'", ".", "format", "(", "self", ".", "__class__", ".", "__name__", ",", "\n", "self", ".", "dataset_s", ",", "self", ".", "dataset_t", ",", "\n", "self", ".", "sample", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_rel.test_rel": [[7, 21], ["dgmc.models.RelCNN", "torch.randn", "torch.randint", "itertools.product", "dgmc.models.RelCNN.__repr__", "dgmc.models.RelCNN.convs[].__repr__", "dgmc.models.RelCNN", "dgmc.models.RelCNN.", "model.size", "model.size"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__"], ["def", "test_rel", "(", ")", ":", "\n", "    ", "model", "=", "RelCNN", "(", "16", ",", "32", ",", "num_layers", "=", "2", ",", "batch_norm", "=", "True", ",", "cat", "=", "True", ",", "lin", "=", "True", ",", "\n", "dropout", "=", "0.5", ")", "\n", "assert", "model", ".", "__repr__", "(", ")", "==", "(", "'RelCNN(16, 32, num_layers=2, batch_norm=True'", "\n", "', cat=True, lin=True, dropout=0.5)'", ")", "\n", "assert", "model", ".", "convs", "[", "0", "]", ".", "__repr__", "(", ")", "==", "'RelConv(16, 32)'", "\n", "\n", "x", "=", "torch", ".", "randn", "(", "100", ",", "16", ")", "\n", "edge_index", "=", "torch", ".", "randint", "(", "100", ",", "(", "2", ",", "400", ")", ",", "dtype", "=", "torch", ".", "long", ")", "\n", "for", "cat", ",", "lin", "in", "product", "(", "[", "False", ",", "True", "]", ",", "[", "False", ",", "True", "]", ")", ":", "\n", "        ", "model", "=", "RelCNN", "(", "16", ",", "32", ",", "2", ",", "True", ",", "cat", ",", "lin", ",", "0.5", ")", "\n", "out", "=", "model", "(", "x", ",", "edge_index", ")", "\n", "assert", "out", ".", "size", "(", ")", "==", "(", "100", ",", "16", "+", "2", "*", "32", "if", "not", "lin", "and", "cat", "else", "32", ")", "\n", "assert", "out", ".", "size", "(", ")", "==", "(", "100", ",", "model", ".", "out_channels", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.set_seed": [[13, 15], ["torch.manual_seed"], "function", ["None"], ["def", "set_seed", "(", ")", ":", "\n", "    ", "torch", ".", "manual_seed", "(", "12345", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.test_dgmc_repr": [[17, 27], ["dgmc.models.DGMC", "dgmc.models.DGMC.reset_parameters", "dgmc.models.DGMC.__repr__"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__"], ["", "def", "test_dgmc_repr", "(", ")", ":", "\n", "    ", "model", "=", "DGMC", "(", "psi_1", ",", "psi_2", ",", "num_steps", "=", "1", ")", "\n", "assert", "model", ".", "__repr__", "(", ")", "==", "(", "\n", "'DGMC(\\n'", "\n", "'    psi_1=GIN(32, 16, num_layers=2, batch_norm=False, cat=True, '", "\n", "'lin=True),\\n'", "\n", "'    psi_2=GIN(8, 8, num_layers=2, batch_norm=False, cat=True, '", "\n", "'lin=True),\\n'", "\n", "'    num_steps=1, k=-1\\n)'", ")", "\n", "model", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.test_dgmc_on_single_graphs": [[29, 65], ["test_dgmc.set_seed", "dgmc.models.DGMC", "torch.arange", "torch.stack", "test_dgmc.set_seed", "dgmc.models.DGMC.", "dgmc.models.DGMC.loss", "model.loss.backward", "dgmc.models.DGMC.acc", "dgmc.models.DGMC.hits_at_k", "dgmc.models.DGMC.hits_at_k", "dgmc.models.DGMC.hits_at_k", "test_dgmc.set_seed", "torch.arange", "torch.stack", "dgmc.models.DGMC.", "dgmc.models.DGMC.loss", "model.loss.backward", "dgmc.models.DGMC.acc", "dgmc.models.DGMC.hits_at_k", "dgmc.models.DGMC.hits_at_k", "dgmc.models.DGMC.hits_at_k", "torch.allclose", "torch.allclose", "torch.allclose", "S1_0.size", "S1_L.size", "S2_0.to_dense", "S2_L.to_dense"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.set_seed", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.set_seed", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.set_seed", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense"], ["", "def", "test_dgmc_on_single_graphs", "(", ")", ":", "\n", "    ", "set_seed", "(", ")", "\n", "model", "=", "DGMC", "(", "psi_1", ",", "psi_2", ",", "num_steps", "=", "1", ")", "\n", "x", ",", "e", "=", "data", ".", "x", ",", "data", ".", "edge_index", "\n", "y", "=", "torch", ".", "arange", "(", "data", ".", "num_nodes", ")", "\n", "y", "=", "torch", ".", "stack", "(", "[", "y", ",", "y", "]", ",", "dim", "=", "0", ")", "\n", "\n", "set_seed", "(", ")", "\n", "S1_0", ",", "S1_L", "=", "model", "(", "x", ",", "e", ",", "None", ",", "None", ",", "x", ",", "e", ",", "None", ",", "None", ")", "\n", "loss1", "=", "model", ".", "loss", "(", "S1_0", ",", "y", ")", "\n", "loss1", ".", "backward", "(", ")", "\n", "acc1", "=", "model", ".", "acc", "(", "S1_0", ",", "y", ")", "\n", "hits1_1", "=", "model", ".", "hits_at_k", "(", "1", ",", "S1_0", ",", "y", ")", "\n", "hits1_10", "=", "model", ".", "hits_at_k", "(", "10", ",", "S1_0", ",", "y", ")", "\n", "hits1_all", "=", "model", ".", "hits_at_k", "(", "data", ".", "num_nodes", ",", "S1_0", ",", "y", ")", "\n", "\n", "set_seed", "(", ")", "\n", "model", ".", "k", "=", "data", ".", "num_nodes", "# Test a sparse \"dense\" variant.", "\n", "y", "=", "torch", ".", "arange", "(", "data", ".", "num_nodes", ")", "\n", "y", "=", "torch", ".", "stack", "(", "[", "y", ",", "y", "]", ",", "dim", "=", "0", ")", "\n", "S2_0", ",", "S2_L", "=", "model", "(", "x", ",", "e", ",", "None", ",", "None", ",", "x", ",", "e", ",", "None", ",", "None", ",", "y", ")", "\n", "loss2", "=", "model", ".", "loss", "(", "S2_0", ",", "y", ")", "\n", "loss2", ".", "backward", "(", ")", "\n", "acc2", "=", "model", ".", "acc", "(", "S2_0", ",", "y", ")", "\n", "hits2_1", "=", "model", ".", "hits_at_k", "(", "1", ",", "S2_0", ",", "y", ")", "\n", "hits2_10", "=", "model", ".", "hits_at_k", "(", "10", ",", "S2_0", ",", "y", ")", "\n", "hits2_all", "=", "model", ".", "hits_at_k", "(", "data", ".", "num_nodes", ",", "S2_0", ",", "y", ")", "\n", "\n", "assert", "S1_0", ".", "size", "(", ")", "==", "(", "data", ".", "num_nodes", ",", "data", ".", "num_nodes", ")", "\n", "assert", "S1_L", ".", "size", "(", ")", "==", "(", "data", ".", "num_nodes", ",", "data", ".", "num_nodes", ")", "\n", "assert", "torch", ".", "allclose", "(", "S1_0", ",", "S2_0", ".", "to_dense", "(", ")", ")", "\n", "assert", "torch", ".", "allclose", "(", "S1_L", ",", "S2_L", ".", "to_dense", "(", ")", ")", "\n", "assert", "torch", ".", "allclose", "(", "loss1", ",", "loss2", ")", "\n", "assert", "acc1", "==", "acc2", "==", "hits1_1", "==", "hits2_1", "\n", "assert", "hits1_1", "<=", "hits1_10", "==", "hits2_10", "<=", "hits1_all", "\n", "assert", "hits1_all", "==", "hits2_all", "==", "1.0", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.test_dgmc_on_multiple_graphs": [[67, 85], ["test_dgmc.set_seed", "dgmc.models.DGMC", "torch_geometric.data.Batch.from_data_list", "test_dgmc.set_seed", "dgmc.models.DGMC.", "test_dgmc.set_seed", "dgmc.models.DGMC.", "torch.allclose", "torch.allclose", "S1_0.size", "S1_L.size", "S2_0.to_dense", "S2_L.to_dense"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.set_seed", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.set_seed", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.set_seed", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense"], ["", "def", "test_dgmc_on_multiple_graphs", "(", ")", ":", "\n", "    ", "set_seed", "(", ")", "\n", "model", "=", "DGMC", "(", "psi_1", ",", "psi_2", ",", "num_steps", "=", "1", ")", "\n", "\n", "batch", "=", "Batch", ".", "from_data_list", "(", "[", "data", ",", "data", "]", ")", "\n", "x", ",", "e", ",", "b", "=", "batch", ".", "x", ",", "batch", ".", "edge_index", ",", "batch", ".", "batch", "\n", "\n", "set_seed", "(", ")", "\n", "S1_0", ",", "S1_L", "=", "model", "(", "x", ",", "e", ",", "None", ",", "b", ",", "x", ",", "e", ",", "None", ",", "b", ")", "\n", "assert", "S1_0", ".", "size", "(", ")", "==", "(", "batch", ".", "num_nodes", ",", "data", ".", "num_nodes", ")", "\n", "assert", "S1_L", ".", "size", "(", ")", "==", "(", "batch", ".", "num_nodes", ",", "data", ".", "num_nodes", ")", "\n", "\n", "set_seed", "(", ")", "\n", "model", ".", "k", "=", "data", ".", "num_nodes", "# Test a sparse \"dense\" variant.", "\n", "S2_0", ",", "S2_L", "=", "model", "(", "x", ",", "e", ",", "None", ",", "b", ",", "x", ",", "e", ",", "None", ",", "b", ")", "\n", "\n", "assert", "torch", ".", "allclose", "(", "S1_0", ",", "S2_0", ".", "to_dense", "(", ")", ")", "\n", "assert", "torch", ".", "allclose", "(", "S1_L", ",", "S2_L", ".", "to_dense", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_dgmc.test_dgmc_include_gt": [[87, 96], ["dgmc.models.DGMC", "torch.tensor", "torch.tensor", "torch.tensor", "dgmc.models.DGMC.__include_gt__", "model.__include_gt__.tolist"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.__include_gt__"], ["", "def", "test_dgmc_include_gt", "(", ")", ":", "\n", "    ", "model", "=", "DGMC", "(", "psi_1", ",", "psi_2", ",", "num_steps", "=", "1", ")", "\n", "\n", "S_idx", "=", "torch", ".", "tensor", "(", "[", "[", "[", "0", ",", "1", "]", ",", "[", "1", ",", "2", "]", "]", ",", "[", "[", "1", ",", "2", "]", ",", "[", "0", ",", "1", "]", "]", "]", ")", "\n", "s_mask", "=", "torch", ".", "tensor", "(", "[", "[", "True", ",", "False", "]", ",", "[", "True", ",", "True", "]", "]", ")", "\n", "y", "=", "torch", ".", "tensor", "(", "[", "[", "0", ",", "1", "]", ",", "[", "0", ",", "0", "]", "]", ")", "\n", "\n", "S_idx", "=", "model", ".", "__include_gt__", "(", "S_idx", ",", "s_mask", ",", "y", ")", "\n", "assert", "S_idx", ".", "tolist", "(", ")", "==", "[", "[", "[", "0", ",", "1", "]", ",", "[", "1", ",", "2", "]", "]", ",", "[", "[", "1", ",", "0", "]", ",", "[", "0", ",", "1", "]", "]", "]", "\n", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_mlp.test_mlp": [[5, 13], ["dgmc.models.MLP", "torch.randn", "dgmc.models.MLP.", "dgmc.models.MLP.__repr__", "model.size"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__"], ["def", "test_mlp", "(", ")", ":", "\n", "    ", "model", "=", "MLP", "(", "16", ",", "32", ",", "num_layers", "=", "2", ",", "batch_norm", "=", "True", ",", "dropout", "=", "0.5", ")", "\n", "assert", "model", ".", "__repr__", "(", ")", "==", "(", "'MLP(16, 32, num_layers=2, batch_norm=True'", "\n", "', dropout=0.5)'", ")", "\n", "\n", "x", "=", "torch", ".", "randn", "(", "100", ",", "16", ")", "\n", "out", "=", "model", "(", "x", ")", "\n", "assert", "out", ".", "size", "(", ")", "==", "(", "100", ",", "32", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_gin.test_gin": [[7, 19], ["dgmc.models.GIN", "torch.randn", "torch.randint", "itertools.product", "dgmc.models.GIN.__repr__", "dgmc.models.GIN", "dgmc.models.GIN.", "model.size", "model.size"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__"], ["def", "test_gin", "(", ")", ":", "\n", "    ", "model", "=", "GIN", "(", "16", ",", "32", ",", "num_layers", "=", "2", ",", "batch_norm", "=", "True", ",", "cat", "=", "True", ",", "lin", "=", "True", ")", "\n", "assert", "model", ".", "__repr__", "(", ")", "==", "(", "'GIN(16, 32, num_layers=2, batch_norm=True, '", "\n", "'cat=True, lin=True)'", ")", "\n", "\n", "x", "=", "torch", ".", "randn", "(", "100", ",", "16", ")", "\n", "edge_index", "=", "torch", ".", "randint", "(", "100", ",", "(", "2", ",", "400", ")", ",", "dtype", "=", "torch", ".", "long", ")", "\n", "for", "cat", ",", "lin", "in", "product", "(", "[", "False", ",", "True", "]", ",", "[", "False", ",", "True", "]", ")", ":", "\n", "        ", "model", "=", "GIN", "(", "16", ",", "32", ",", "2", ",", "True", ",", "cat", ",", "lin", ")", "\n", "out", "=", "model", "(", "x", ",", "edge_index", ")", "\n", "assert", "out", ".", "size", "(", ")", "==", "(", "100", ",", "16", "+", "2", "*", "32", "if", "not", "lin", "and", "cat", "else", "32", ")", "\n", "assert", "out", ".", "size", "(", ")", "==", "(", "100", ",", "model", ".", "out_channels", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.test_spline.test_spline": [[7, 21], ["dgmc.models.SplineCNN", "torch.randn", "torch.randint", "torch.rand", "itertools.product", "dgmc.models.SplineCNN.__repr__", "dgmc.models.SplineCNN", "dgmc.models.SplineCNN.", "model.size", "model.size"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__"], ["def", "test_spline", "(", ")", ":", "\n", "    ", "model", "=", "SplineCNN", "(", "16", ",", "32", ",", "dim", "=", "3", ",", "num_layers", "=", "2", ",", "cat", "=", "True", ",", "lin", "=", "True", ",", "\n", "dropout", "=", "0.5", ")", "\n", "assert", "model", ".", "__repr__", "(", ")", "==", "(", "'SplineCNN(16, 32, dim=3, num_layers=2, '", "\n", "'cat=True, lin=True, dropout=0.5)'", ")", "\n", "\n", "x", "=", "torch", ".", "randn", "(", "100", ",", "16", ")", "\n", "edge_index", "=", "torch", ".", "randint", "(", "100", ",", "(", "2", ",", "400", ")", ",", "dtype", "=", "torch", ".", "long", ")", "\n", "edge_attr", "=", "torch", ".", "rand", "(", "(", "400", ",", "3", ")", ")", "\n", "for", "cat", ",", "lin", "in", "product", "(", "[", "False", ",", "True", "]", ",", "[", "False", ",", "True", "]", ")", ":", "\n", "        ", "model", "=", "SplineCNN", "(", "16", ",", "32", ",", "3", ",", "2", ",", "cat", ",", "lin", ",", "0.5", ")", "\n", "out", "=", "model", "(", "x", ",", "edge_index", ",", "edge_attr", ")", "\n", "assert", "out", ".", "size", "(", ")", "==", "(", "100", ",", "16", "+", "2", "*", "32", "if", "not", "lin", "and", "cat", "else", "32", ")", "\n", "assert", "out", ".", "size", "(", ")", "==", "(", "100", ",", "model", ".", "out_channels", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.spline.SplineCNN.__init__": [[8, 37], ["super().__init__", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "range", "spline.SplineCNN.reset_parameters", "torch_geometric.nn.SplineConv", "spline.SplineCNN.convs.append", "torch.nn.Linear", "torch.nn.Linear"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__init__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "dim", ",", "num_layers", ",", "cat", "=", "True", ",", "\n", "lin", "=", "True", ",", "dropout", "=", "0.0", ")", ":", "\n", "        ", "super", "(", "SplineCNN", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "dim", "=", "dim", "\n", "self", ".", "num_layers", "=", "num_layers", "\n", "self", ".", "cat", "=", "cat", "\n", "self", ".", "lin", "=", "lin", "\n", "self", ".", "dropout", "=", "dropout", "\n", "\n", "self", ".", "convs", "=", "torch", ".", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "num_layers", ")", ":", "\n", "            ", "conv", "=", "SplineConv", "(", "in_channels", ",", "out_channels", ",", "dim", ",", "kernel_size", "=", "5", ")", "\n", "self", ".", "convs", ".", "append", "(", "conv", ")", "\n", "in_channels", "=", "out_channels", "\n", "\n", "", "if", "self", ".", "cat", ":", "\n", "            ", "in_channels", "=", "self", ".", "in_channels", "+", "num_layers", "*", "out_channels", "\n", "", "else", ":", "\n", "            ", "in_channels", "=", "out_channels", "\n", "\n", "", "if", "self", ".", "lin", ":", "\n", "            ", "self", ".", "out_channels", "=", "out_channels", "\n", "self", ".", "final", "=", "Lin", "(", "in_channels", ",", "out_channels", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "out_channels", "=", "in_channels", "\n", "\n", "", "self", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.spline.SplineCNN.reset_parameters": [[38, 43], ["conv.reset_parameters", "spline.SplineCNN.final.reset_parameters"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "for", "conv", "in", "self", ".", "convs", ":", "\n", "            ", "conv", ".", "reset_parameters", "(", ")", "\n", "", "if", "self", ".", "lin", ":", "\n", "            ", "self", ".", "final", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.spline.SplineCNN.forward": [[44, 55], ["torch.dropout", "torch.dropout", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "spline.SplineCNN.final", "torch.relu", "torch.relu", "conv"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "edge_index", ",", "edge_attr", ",", "*", "args", ")", ":", "\n", "        ", "\"\"\"\"\"\"", "\n", "xs", "=", "[", "x", "]", "\n", "\n", "for", "conv", "in", "self", ".", "convs", ":", "\n", "            ", "xs", "+=", "[", "F", ".", "relu", "(", "conv", "(", "xs", "[", "-", "1", "]", ",", "edge_index", ",", "edge_attr", ")", ")", "]", "\n", "\n", "", "x", "=", "torch", ".", "cat", "(", "xs", ",", "dim", "=", "-", "1", ")", "if", "self", ".", "cat", "else", "xs", "[", "-", "1", "]", "\n", "x", "=", "F", ".", "dropout", "(", "x", ",", "p", "=", "self", ".", "dropout", ",", "training", "=", "self", ".", "training", ")", "\n", "x", "=", "self", ".", "final", "(", "x", ")", "if", "self", ".", "lin", "else", "x", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.spline.SplineCNN.__repr__": [[56, 62], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "(", "'{}({}, {}, dim={}, num_layers={}, cat={}, lin={}, '", "\n", "'dropout={})'", ")", ".", "format", "(", "self", ".", "__class__", ".", "__name__", ",", "\n", "self", ".", "in_channels", ",", "self", ".", "out_channels", ",", "\n", "self", ".", "dim", ",", "self", ".", "num_layers", ",", "self", ".", "cat", ",", "\n", "self", ".", "lin", ",", "self", ".", "dropout", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelConv.__init__": [[8, 19], ["torch_geometric.nn.MessagePassing.__init__", "torch.nn.Linear", "torch.nn.Linear", "torch.nn.Linear", "torch.nn.Linear", "torch.nn.Linear", "torch.nn.Linear", "rel.RelConv.reset_parameters"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__init__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "RelConv", ",", "self", ")", ".", "__init__", "(", "aggr", "=", "'mean'", ")", "\n", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "out_channels", "=", "out_channels", "\n", "\n", "self", ".", "lin1", "=", "Lin", "(", "in_channels", ",", "out_channels", ",", "bias", "=", "False", ")", "\n", "self", ".", "lin2", "=", "Lin", "(", "in_channels", ",", "out_channels", ",", "bias", "=", "False", ")", "\n", "self", ".", "root", "=", "Lin", "(", "in_channels", ",", "out_channels", ")", "\n", "\n", "self", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelConv.reset_parameters": [[20, 24], ["rel.RelConv.lin1.reset_parameters", "rel.RelConv.lin2.reset_parameters", "rel.RelConv.root.reset_parameters"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "self", ".", "lin1", ".", "reset_parameters", "(", ")", "\n", "self", ".", "lin2", ".", "reset_parameters", "(", ")", "\n", "self", ".", "root", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelConv.forward": [[25, 32], ["rel.RelConv.propagate", "rel.RelConv.propagate", "rel.RelConv.lin1", "rel.RelConv.lin2", "rel.RelConv.root"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "edge_index", ")", ":", "\n", "        ", "\"\"\"\"\"\"", "\n", "self", ".", "flow", "=", "'source_to_target'", "\n", "out1", "=", "self", ".", "propagate", "(", "edge_index", ",", "x", "=", "self", ".", "lin1", "(", "x", ")", ")", "\n", "self", ".", "flow", "=", "'target_to_source'", "\n", "out2", "=", "self", ".", "propagate", "(", "edge_index", ",", "x", "=", "self", ".", "lin2", "(", "x", ")", ")", "\n", "return", "self", ".", "root", "(", "x", ")", "+", "out1", "+", "out2", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelConv.message": [[33, 35], ["None"], "methods", ["None"], ["", "def", "message", "(", "self", ",", "x_j", ")", ":", "\n", "        ", "return", "x_j", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelConv.__repr__": [[36, 39], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "'{}({}, {})'", ".", "format", "(", "self", ".", "__class__", ".", "__name__", ",", "self", ".", "in_channels", ",", "\n", "self", ".", "out_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelCNN.__init__": [[42, 72], ["super().__init__", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "range", "rel.RelCNN.reset_parameters", "rel.RelCNN.convs.append", "rel.RelCNN.batch_norms.append", "torch.nn.Linear", "torch.nn.Linear", "rel.RelConv", "torch.nn.BatchNorm1d", "torch.nn.BatchNorm1d"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__init__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "num_layers", ",", "batch_norm", "=", "False", ",", "\n", "cat", "=", "True", ",", "lin", "=", "True", ",", "dropout", "=", "0.0", ")", ":", "\n", "        ", "super", "(", "RelCNN", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "num_layers", "=", "num_layers", "\n", "self", ".", "batch_norm", "=", "batch_norm", "\n", "self", ".", "cat", "=", "cat", "\n", "self", ".", "lin", "=", "lin", "\n", "self", ".", "dropout", "=", "dropout", "\n", "\n", "self", ".", "convs", "=", "torch", ".", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "batch_norms", "=", "torch", ".", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "num_layers", ")", ":", "\n", "            ", "self", ".", "convs", ".", "append", "(", "RelConv", "(", "in_channels", ",", "out_channels", ")", ")", "\n", "self", ".", "batch_norms", ".", "append", "(", "BN", "(", "out_channels", ")", ")", "\n", "in_channels", "=", "out_channels", "\n", "\n", "", "if", "self", ".", "cat", ":", "\n", "            ", "in_channels", "=", "self", ".", "in_channels", "+", "num_layers", "*", "out_channels", "\n", "", "else", ":", "\n", "            ", "in_channels", "=", "out_channels", "\n", "\n", "", "if", "self", ".", "lin", ":", "\n", "            ", "self", ".", "out_channels", "=", "out_channels", "\n", "self", ".", "final", "=", "Lin", "(", "in_channels", ",", "out_channels", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "out_channels", "=", "in_channels", "\n", "\n", "", "self", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelCNN.reset_parameters": [[73, 79], ["zip", "conv.reset_parameters", "batch_norm.reset_parameters", "rel.RelCNN.final.reset_parameters"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "for", "conv", ",", "batch_norm", "in", "zip", "(", "self", ".", "convs", ",", "self", ".", "batch_norms", ")", ":", "\n", "            ", "conv", ".", "reset_parameters", "(", ")", "\n", "batch_norm", ".", "reset_parameters", "(", ")", "\n", "", "if", "self", ".", "lin", ":", "\n", "            ", "self", ".", "final", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelCNN.forward": [[80, 93], ["zip", "conv", "torch.dropout", "torch.dropout", "xs.append", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "rel.RelCNN.final", "batch_norm", "torch.relu", "torch.relu", "torch.relu", "torch.relu"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "edge_index", ",", "*", "args", ")", ":", "\n", "        ", "\"\"\"\"\"\"", "\n", "xs", "=", "[", "x", "]", "\n", "\n", "for", "conv", ",", "batch_norm", "in", "zip", "(", "self", ".", "convs", ",", "self", ".", "batch_norms", ")", ":", "\n", "            ", "x", "=", "conv", "(", "xs", "[", "-", "1", "]", ",", "edge_index", ")", "\n", "x", "=", "batch_norm", "(", "F", ".", "relu", "(", "x", ")", ")", "if", "self", ".", "batch_norm", "else", "F", ".", "relu", "(", "x", ")", "\n", "x", "=", "F", ".", "dropout", "(", "x", ",", "p", "=", "self", ".", "dropout", ",", "training", "=", "self", ".", "training", ")", "\n", "xs", ".", "append", "(", "x", ")", "\n", "\n", "", "x", "=", "torch", ".", "cat", "(", "xs", ",", "dim", "=", "-", "1", ")", "if", "self", ".", "cat", "else", "xs", "[", "-", "1", "]", "\n", "x", "=", "self", ".", "final", "(", "x", ")", "if", "self", ".", "lin", "else", "x", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.rel.RelCNN.__repr__": [[94, 100], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "(", "'{}({}, {}, num_layers={}, batch_norm={}, cat={}, lin={}, '", "\n", "'dropout={})'", ")", ".", "format", "(", "self", ".", "__class__", ".", "__name__", ",", "\n", "self", ".", "in_channels", ",", "self", ".", "out_channels", ",", "\n", "self", ".", "num_layers", ",", "self", ".", "batch_norm", ",", "\n", "self", ".", "cat", ",", "self", ".", "lin", ",", "self", ".", "dropout", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.gin.GIN.__init__": [[9, 37], ["super().__init__", "torch.nn.ModuleList", "range", "gin.GIN.reset_parameters", "mlp.MLP.MLP", "gin.GIN.convs.append", "torch.nn.Linear", "torch_geometric.nn.GINConv"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__init__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "num_layers", ",", "batch_norm", "=", "False", ",", "\n", "cat", "=", "True", ",", "lin", "=", "True", ")", ":", "\n", "        ", "super", "(", "GIN", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "num_layers", "=", "num_layers", "\n", "self", ".", "batch_norm", "=", "batch_norm", "\n", "self", ".", "cat", "=", "cat", "\n", "self", ".", "lin", "=", "lin", "\n", "\n", "self", ".", "convs", "=", "torch", ".", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "num_layers", ")", ":", "\n", "            ", "mlp", "=", "MLP", "(", "in_channels", ",", "out_channels", ",", "2", ",", "batch_norm", ",", "dropout", "=", "0.0", ")", "\n", "self", ".", "convs", ".", "append", "(", "GINConv", "(", "mlp", ",", "train_eps", "=", "True", ")", ")", "\n", "in_channels", "=", "out_channels", "\n", "\n", "", "if", "self", ".", "cat", ":", "\n", "            ", "in_channels", "=", "self", ".", "in_channels", "+", "num_layers", "*", "out_channels", "\n", "", "else", ":", "\n", "            ", "in_channels", "=", "out_channels", "\n", "\n", "", "if", "self", ".", "lin", ":", "\n", "            ", "self", ".", "out_channels", "=", "out_channels", "\n", "self", ".", "final", "=", "Lin", "(", "in_channels", ",", "out_channels", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "out_channels", "=", "in_channels", "\n", "\n", "", "self", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.gin.GIN.reset_parameters": [[38, 43], ["conv.reset_parameters", "gin.GIN.final.reset_parameters"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "for", "conv", "in", "self", ".", "convs", ":", "\n", "            ", "conv", ".", "reset_parameters", "(", ")", "\n", "", "if", "self", ".", "lin", ":", "\n", "            ", "self", ".", "final", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.gin.GIN.forward": [[44, 54], ["torch.cat", "gin.GIN.final", "conv"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "edge_index", ",", "*", "args", ")", ":", "\n", "        ", "\"\"\"\"\"\"", "\n", "xs", "=", "[", "x", "]", "\n", "\n", "for", "conv", "in", "self", ".", "convs", ":", "\n", "            ", "xs", "+=", "[", "conv", "(", "xs", "[", "-", "1", "]", ",", "edge_index", ")", "]", "\n", "\n", "", "x", "=", "torch", ".", "cat", "(", "xs", ",", "dim", "=", "-", "1", ")", "if", "self", ".", "cat", "else", "xs", "[", "-", "1", "]", "\n", "x", "=", "self", ".", "final", "(", "x", ")", "if", "self", ".", "lin", "else", "x", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.gin.GIN.__repr__": [[55, 60], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "(", "'{}({}, {}, num_layers={}, batch_norm={}, cat={}, '", "\n", "'lin={})'", ")", ".", "format", "(", "self", ".", "__class__", ".", "__name__", ",", "self", ".", "in_channels", ",", "\n", "self", ".", "out_channels", ",", "self", ".", "num_layers", ",", "\n", "self", ".", "batch_norm", ",", "self", ".", "cat", ",", "self", ".", "lin", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.__init__": [[64, 78], ["super().__init__", "torch.nn.Sequential", "torch.nn.Linear", "torch.nn.ReLU", "torch.nn.Linear"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__init__"], ["def", "__init__", "(", "self", ",", "psi_1", ",", "psi_2", ",", "num_steps", ",", "k", "=", "-", "1", ",", "detach", "=", "False", ")", ":", "\n", "        ", "super", "(", "DGMC", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "psi_1", "=", "psi_1", "\n", "self", ".", "psi_2", "=", "psi_2", "\n", "self", ".", "num_steps", "=", "num_steps", "\n", "self", ".", "k", "=", "k", "\n", "self", ".", "detach", "=", "detach", "\n", "self", ".", "backend", "=", "'auto'", "\n", "\n", "self", ".", "mlp", "=", "Seq", "(", "\n", "Lin", "(", "psi_2", ".", "out_channels", ",", "psi_2", ".", "out_channels", ")", ",", "\n", "ReLU", "(", ")", ",", "\n", "Lin", "(", "psi_2", ".", "out_channels", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.reset_parameters": [[80, 84], ["dgmc.DGMC.psi_1.reset_parameters", "dgmc.DGMC.psi_2.reset_parameters", "torch_geometric.nn.inits.reset"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "self", ".", "psi_1", ".", "reset_parameters", "(", ")", "\n", "self", ".", "psi_2", ".", "reset_parameters", "(", ")", "\n", "reset", "(", "self", ".", "mlp", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.__top_k__": [[85, 98], ["x_s.unsqueeze.unsqueeze.unsqueeze", "x_t.transpose.transpose.unsqueeze", "S_ij.argKmin", "x_t.transpose.transpose.transpose", "LazyTensor", "LazyTensor", "S_ij.topk"], "methods", ["None"], ["", "def", "__top_k__", "(", "self", ",", "x_s", ",", "x_t", ")", ":", "# pragma: no cover", "\n", "        ", "r\"\"\"Memory-efficient top-k correspondence computation.\"\"\"", "\n", "if", "LazyTensor", "is", "not", "None", ":", "\n", "            ", "x_s", "=", "x_s", ".", "unsqueeze", "(", "-", "2", ")", "# [..., n_s, 1, d]", "\n", "x_t", "=", "x_t", ".", "unsqueeze", "(", "-", "3", ")", "# [..., 1, n_t, d]", "\n", "x_s", ",", "x_t", "=", "LazyTensor", "(", "x_s", ")", ",", "LazyTensor", "(", "x_t", ")", "\n", "S_ij", "=", "(", "-", "x_s", "*", "x_t", ")", ".", "sum", "(", "dim", "=", "-", "1", ")", "\n", "return", "S_ij", ".", "argKmin", "(", "self", ".", "k", ",", "dim", "=", "2", ",", "backend", "=", "self", ".", "backend", ")", "\n", "", "else", ":", "\n", "            ", "x_s", "=", "x_s", "# [..., n_s, d]", "\n", "x_t", "=", "x_t", ".", "transpose", "(", "-", "1", ",", "-", "2", ")", "# [..., d, n_t]", "\n", "S_ij", "=", "x_s", "@", "x_t", "\n", "return", "S_ij", ".", "topk", "(", "self", ".", "k", ",", "dim", "=", "2", ")", "[", "1", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.__include_gt__": [[99, 116], ["gt_mask.new_zeros", "gt_mask.new_zeros.new_zeros", "torch.zeros", "S_idx.masked_scatter", "s_mask.size", "S_idx.size", "gt_mask.new_zeros.new_zeros.view", "torch.zeros.view", "s_mask.sum", "col.view"], "methods", ["None"], ["", "", "def", "__include_gt__", "(", "self", ",", "S_idx", ",", "s_mask", ",", "y", ")", ":", "\n", "        ", "r\"\"\"Includes the ground-truth values in :obj:`y` to the index tensor\n        :obj:`S_idx`.\"\"\"", "\n", "(", "B", ",", "N_s", ")", ",", "(", "row", ",", "col", ")", ",", "k", "=", "s_mask", ".", "size", "(", ")", ",", "y", ",", "S_idx", ".", "size", "(", "-", "1", ")", "\n", "\n", "gt_mask", "=", "(", "S_idx", "[", "s_mask", "]", "[", "row", "]", "!=", "col", ".", "view", "(", "-", "1", ",", "1", ")", ")", ".", "all", "(", "dim", "=", "-", "1", ")", "\n", "\n", "sparse_mask", "=", "gt_mask", ".", "new_zeros", "(", "(", "s_mask", ".", "sum", "(", ")", ",", ")", ")", "\n", "sparse_mask", "[", "row", "]", "=", "gt_mask", "\n", "\n", "dense_mask", "=", "sparse_mask", ".", "new_zeros", "(", "(", "B", ",", "N_s", ")", ")", "\n", "dense_mask", "[", "s_mask", "]", "=", "sparse_mask", "\n", "last_entry", "=", "torch", ".", "zeros", "(", "k", ",", "dtype", "=", "torch", ".", "bool", ",", "device", "=", "gt_mask", ".", "device", ")", "\n", "last_entry", "[", "-", "1", "]", "=", "1", "\n", "dense_mask", "=", "dense_mask", ".", "view", "(", "B", ",", "N_s", ",", "1", ")", "*", "last_entry", ".", "view", "(", "1", ",", "1", ",", "k", ")", "\n", "\n", "return", "S_idx", ".", "masked_scatter", "(", "dense_mask", ",", "col", "[", "gt_mask", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.forward": [[117, 248], ["dgmc.DGMC.psi_1", "dgmc.DGMC.psi_1", "torch_geometric.utils.to_dense_batch", "torch_geometric.utils.to_dense_batch", "dgmc.DGMC.size", "dgmc.DGMC.size", "dgmc.DGMC.size", "dgmc.DGMC.size", "range", "dgmc.DGMC.__top_k__", "dgmc.DGMC.size", "dgmc.DGMC.view", "dgmc.DGMC.view().expand", "torch.gather", "range", "torch.arange", "row.view().repeat.view().repeat.view().repeat", "torch.stack", "torch.Size", "torch.sparse_coo_tensor", "torch.sparse_coo_tensor", "dgmc.DGMC.detach", "dgmc.DGMC.detach", "dgmc.DGMC.transpose", "s_mask.view", "t_mask.view", "dgmc.masked_softmax", "dgmc.masked_softmax", "torch.randn", "dgmc.DGMC.psi_2", "dgmc.DGMC.psi_2", "dgmc.masked_softmax", "torch.randint", "torch.cat", "dgmc.DGMC.__include_gt__", "dgmc.DGMC.view", "S_hat.softmax", "S_hat.softmax", "torch.randn", "torch.gather.view", "dgmc.DGMC.view", "torch_scatter.scatter_add", "dgmc.DGMC.psi_2", "dgmc.DGMC.psi_2", "o_s.view().expand.view().expand.view().expand", "dgmc.DGMC.view().expand", "torch.gather", "S_hat.softmax", "x_s.size", "S_0.view", "S_L.view", "S_hat.softmax.transpose", "dgmc.to_sparse", "dgmc.to_sparse", "dgmc.to_dense", "dgmc.to_dense", "o_s.view().expand.view().expand.view", "dgmc.DGMC.view", "dgmc.DGMC.mlp().squeeze().masked_fill", "min", "dgmc.DGMC.view", "torch.randn.view", "S_hat.softmax.view", "dgmc.to_sparse", "dgmc.to_sparse", "dgmc.to_dense", "dgmc.to_dense", "dgmc.DGMC.view", "torch.gather.view", "dgmc.DGMC.mlp().squeeze", "row.view().repeat.view().repeat.view", "row.view().repeat.view().repeat.view", "dgmc.DGMC.view", "x_s.size", "torch.gather.view", "o_s.view().expand.view().expand.view", "dgmc.DGMC.view", "dgmc.DGMC.mlp().squeeze", "dgmc.DGMC.mlp", "dgmc.DGMC.mlp"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.__top_k__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.masked_softmax", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.masked_softmax", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.masked_softmax", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.__include_gt__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_sparse", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_sparse", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_sparse", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_sparse", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense"], ["", "def", "forward", "(", "self", ",", "x_s", ",", "edge_index_s", ",", "edge_attr_s", ",", "batch_s", ",", "x_t", ",", "\n", "edge_index_t", ",", "edge_attr_t", ",", "batch_t", ",", "y", "=", "None", ")", ":", "\n", "        ", "r\"\"\"\n        Args:\n            x_s (Tensor): Source graph node features of shape\n                :obj:`[batch_size * num_nodes, C_in]`.\n            edge_index_s (LongTensor): Source graph edge connectivity of shape\n                :obj:`[2, num_edges]`.\n            edge_attr_s (Tensor): Source graph edge features of shape\n                :obj:`[num_edges, D]`. Set to :obj:`None` if the GNNs are not\n                taking edge features into account.\n            batch_s (LongTensor): Source graph batch vector of shape\n                :obj:`[batch_size * num_nodes]` indicating node to graph\n                assignment. Set to :obj:`None` if operating on single graphs.\n            x_t (Tensor): Target graph node features of shape\n                :obj:`[batch_size * num_nodes, C_in]`.\n            edge_index_t (LongTensor): Target graph edge connectivity of shape\n                :obj:`[2, num_edges]`.\n            edge_attr_t (Tensor): Target graph edge features of shape\n                :obj:`[num_edges, D]`. Set to :obj:`None` if the GNNs are not\n                taking edge features into account.\n            batch_s (LongTensor): Target graph batch vector of shape\n                :obj:`[batch_size * num_nodes]` indicating node to graph\n                assignment. Set to :obj:`None` if operating on single graphs.\n            y (LongTensor, optional): Ground-truth matchings of shape\n                :obj:`[2, num_ground_truths]` to include ground-truth values\n                when training against sparse correspondences. Ground-truths\n                are only used in case the model is in training mode.\n                (default: :obj:`None`)\n\n        Returns:\n            Initial and refined correspondence matrices :obj:`(S_0, S_L)`\n            of shapes :obj:`[batch_size * num_nodes, num_nodes]`. The\n            correspondence matrix are either given as dense or sparse matrices.\n        \"\"\"", "\n", "h_s", "=", "self", ".", "psi_1", "(", "x_s", ",", "edge_index_s", ",", "edge_attr_s", ")", "\n", "h_t", "=", "self", ".", "psi_1", "(", "x_t", ",", "edge_index_t", ",", "edge_attr_t", ")", "\n", "\n", "h_s", ",", "h_t", "=", "(", "h_s", ".", "detach", "(", ")", ",", "h_t", ".", "detach", "(", ")", ")", "if", "self", ".", "detach", "else", "(", "h_s", ",", "h_t", ")", "\n", "\n", "h_s", ",", "s_mask", "=", "to_dense_batch", "(", "h_s", ",", "batch_s", ",", "fill_value", "=", "0", ")", "\n", "h_t", ",", "t_mask", "=", "to_dense_batch", "(", "h_t", ",", "batch_t", ",", "fill_value", "=", "0", ")", "\n", "\n", "assert", "h_s", ".", "size", "(", "0", ")", "==", "h_t", ".", "size", "(", "0", ")", ",", "'Encountered unequal batch-sizes'", "\n", "(", "B", ",", "N_s", ",", "C_out", ")", ",", "N_t", "=", "h_s", ".", "size", "(", ")", ",", "h_t", ".", "size", "(", "1", ")", "\n", "R_in", ",", "R_out", "=", "self", ".", "psi_2", ".", "in_channels", ",", "self", ".", "psi_2", ".", "out_channels", "\n", "\n", "if", "self", ".", "k", "<", "1", ":", "\n", "# ------ Dense variant ------ #", "\n", "            ", "S_hat", "=", "h_s", "@", "h_t", ".", "transpose", "(", "-", "1", ",", "-", "2", ")", "# [B, N_s, N_t, C_out]", "\n", "S_mask", "=", "s_mask", ".", "view", "(", "B", ",", "N_s", ",", "1", ")", "&", "t_mask", ".", "view", "(", "B", ",", "1", ",", "N_t", ")", "\n", "S_0", "=", "masked_softmax", "(", "S_hat", ",", "S_mask", ",", "dim", "=", "-", "1", ")", "[", "s_mask", "]", "\n", "\n", "for", "_", "in", "range", "(", "self", ".", "num_steps", ")", ":", "\n", "                ", "S", "=", "masked_softmax", "(", "S_hat", ",", "S_mask", ",", "dim", "=", "-", "1", ")", "\n", "r_s", "=", "torch", ".", "randn", "(", "(", "B", ",", "N_s", ",", "R_in", ")", ",", "dtype", "=", "h_s", ".", "dtype", ",", "\n", "device", "=", "h_s", ".", "device", ")", "\n", "r_t", "=", "S", ".", "transpose", "(", "-", "1", ",", "-", "2", ")", "@", "r_s", "\n", "\n", "r_s", ",", "r_t", "=", "to_sparse", "(", "r_s", ",", "s_mask", ")", ",", "to_sparse", "(", "r_t", ",", "t_mask", ")", "\n", "o_s", "=", "self", ".", "psi_2", "(", "r_s", ",", "edge_index_s", ",", "edge_attr_s", ")", "\n", "o_t", "=", "self", ".", "psi_2", "(", "r_t", ",", "edge_index_t", ",", "edge_attr_t", ")", "\n", "o_s", ",", "o_t", "=", "to_dense", "(", "o_s", ",", "s_mask", ")", ",", "to_dense", "(", "o_t", ",", "t_mask", ")", "\n", "\n", "D", "=", "o_s", ".", "view", "(", "B", ",", "N_s", ",", "1", ",", "R_out", ")", "-", "o_t", ".", "view", "(", "B", ",", "1", ",", "N_t", ",", "R_out", ")", "\n", "S_hat", "=", "S_hat", "+", "self", ".", "mlp", "(", "D", ")", ".", "squeeze", "(", "-", "1", ")", ".", "masked_fill", "(", "~", "S_mask", ",", "0", ")", "\n", "\n", "", "S_L", "=", "masked_softmax", "(", "S_hat", ",", "S_mask", ",", "dim", "=", "-", "1", ")", "[", "s_mask", "]", "\n", "\n", "return", "S_0", ",", "S_L", "\n", "", "else", ":", "\n", "# ------ Sparse variant ------ #", "\n", "            ", "S_idx", "=", "self", ".", "__top_k__", "(", "h_s", ",", "h_t", ")", "# [B, N_s, k]", "\n", "\n", "# In addition to the top-k, randomly sample negative examples and", "\n", "# ensure that the ground-truth is included as a sparse entry.", "\n", "if", "self", ".", "training", "and", "y", "is", "not", "None", ":", "\n", "                ", "rnd_size", "=", "(", "B", ",", "N_s", ",", "min", "(", "self", ".", "k", ",", "N_t", "-", "self", ".", "k", ")", ")", "\n", "S_rnd_idx", "=", "torch", ".", "randint", "(", "N_t", ",", "rnd_size", ",", "dtype", "=", "torch", ".", "long", ",", "\n", "device", "=", "S_idx", ".", "device", ")", "\n", "S_idx", "=", "torch", ".", "cat", "(", "[", "S_idx", ",", "S_rnd_idx", "]", ",", "dim", "=", "-", "1", ")", "\n", "S_idx", "=", "self", ".", "__include_gt__", "(", "S_idx", ",", "s_mask", ",", "y", ")", "\n", "\n", "", "k", "=", "S_idx", ".", "size", "(", "-", "1", ")", "\n", "tmp_s", "=", "h_s", ".", "view", "(", "B", ",", "N_s", ",", "1", ",", "C_out", ")", "\n", "idx", "=", "S_idx", ".", "view", "(", "B", ",", "N_s", "*", "k", ",", "1", ")", ".", "expand", "(", "-", "1", ",", "-", "1", ",", "C_out", ")", "\n", "tmp_t", "=", "torch", ".", "gather", "(", "h_t", ".", "view", "(", "B", ",", "N_t", ",", "C_out", ")", ",", "-", "2", ",", "idx", ")", "\n", "S_hat", "=", "(", "tmp_s", "*", "tmp_t", ".", "view", "(", "B", ",", "N_s", ",", "k", ",", "C_out", ")", ")", ".", "sum", "(", "dim", "=", "-", "1", ")", "\n", "S_0", "=", "S_hat", ".", "softmax", "(", "dim", "=", "-", "1", ")", "[", "s_mask", "]", "\n", "\n", "for", "_", "in", "range", "(", "self", ".", "num_steps", ")", ":", "\n", "                ", "S", "=", "S_hat", ".", "softmax", "(", "dim", "=", "-", "1", ")", "\n", "r_s", "=", "torch", ".", "randn", "(", "(", "B", ",", "N_s", ",", "R_in", ")", ",", "dtype", "=", "h_s", ".", "dtype", ",", "\n", "device", "=", "h_s", ".", "device", ")", "\n", "\n", "tmp_t", "=", "r_s", ".", "view", "(", "B", ",", "N_s", ",", "1", ",", "R_in", ")", "*", "S", ".", "view", "(", "B", ",", "N_s", ",", "k", ",", "1", ")", "\n", "tmp_t", "=", "tmp_t", ".", "view", "(", "B", ",", "N_s", "*", "k", ",", "R_in", ")", "\n", "idx", "=", "S_idx", ".", "view", "(", "B", ",", "N_s", "*", "k", ",", "1", ")", "\n", "r_t", "=", "scatter_add", "(", "tmp_t", ",", "idx", ",", "dim", "=", "1", ",", "dim_size", "=", "N_t", ")", "\n", "\n", "r_s", ",", "r_t", "=", "to_sparse", "(", "r_s", ",", "s_mask", ")", ",", "to_sparse", "(", "r_t", ",", "t_mask", ")", "\n", "o_s", "=", "self", ".", "psi_2", "(", "r_s", ",", "edge_index_s", ",", "edge_attr_s", ")", "\n", "o_t", "=", "self", ".", "psi_2", "(", "r_t", ",", "edge_index_t", ",", "edge_attr_t", ")", "\n", "o_s", ",", "o_t", "=", "to_dense", "(", "o_s", ",", "s_mask", ")", ",", "to_dense", "(", "o_t", ",", "t_mask", ")", "\n", "\n", "o_s", "=", "o_s", ".", "view", "(", "B", ",", "N_s", ",", "1", ",", "R_out", ")", ".", "expand", "(", "-", "1", ",", "-", "1", ",", "k", ",", "-", "1", ")", "\n", "idx", "=", "S_idx", ".", "view", "(", "B", ",", "N_s", "*", "k", ",", "1", ")", ".", "expand", "(", "-", "1", ",", "-", "1", ",", "R_out", ")", "\n", "tmp_t", "=", "torch", ".", "gather", "(", "o_t", ".", "view", "(", "B", ",", "N_t", ",", "R_out", ")", ",", "-", "2", ",", "idx", ")", "\n", "D", "=", "o_s", "-", "tmp_t", ".", "view", "(", "B", ",", "N_s", ",", "k", ",", "R_out", ")", "\n", "S_hat", "=", "S_hat", "+", "self", ".", "mlp", "(", "D", ")", ".", "squeeze", "(", "-", "1", ")", "\n", "\n", "", "S_L", "=", "S_hat", ".", "softmax", "(", "dim", "=", "-", "1", ")", "[", "s_mask", "]", "\n", "S_idx", "=", "S_idx", "[", "s_mask", "]", "\n", "\n", "# Convert sparse layout to `torch.sparse_coo_tensor`.", "\n", "row", "=", "torch", ".", "arange", "(", "x_s", ".", "size", "(", "0", ")", ",", "device", "=", "S_idx", ".", "device", ")", "\n", "row", "=", "row", ".", "view", "(", "-", "1", ",", "1", ")", ".", "repeat", "(", "1", ",", "k", ")", "\n", "idx", "=", "torch", ".", "stack", "(", "[", "row", ".", "view", "(", "-", "1", ")", ",", "S_idx", ".", "view", "(", "-", "1", ")", "]", ",", "dim", "=", "0", ")", "\n", "size", "=", "torch", ".", "Size", "(", "[", "x_s", ".", "size", "(", "0", ")", ",", "N_t", "]", ")", "\n", "\n", "S_sparse_0", "=", "torch", ".", "sparse_coo_tensor", "(", "\n", "idx", ",", "S_0", ".", "view", "(", "-", "1", ")", ",", "size", ",", "requires_grad", "=", "S_0", ".", "requires_grad", ")", "\n", "S_sparse_0", ".", "__idx__", "=", "S_idx", "\n", "S_sparse_0", ".", "__val__", "=", "S_0", "\n", "\n", "S_sparse_L", "=", "torch", ".", "sparse_coo_tensor", "(", "\n", "idx", ",", "S_L", ".", "view", "(", "-", "1", ")", ",", "size", ",", "requires_grad", "=", "S_L", ".", "requires_grad", ")", "\n", "S_sparse_L", ".", "__idx__", "=", "S_idx", "\n", "S_sparse_L", ".", "__val__", "=", "S_L", "\n", "\n", "return", "S_sparse_0", ",", "S_sparse_L", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss": [[249, 271], ["torch.log", "y[].view", "getattr"], "methods", ["None"], ["", "", "def", "loss", "(", "self", ",", "S", ",", "y", ",", "reduction", "=", "'mean'", ")", ":", "\n", "        ", "r\"\"\"Computes the negative log-likelihood loss on the correspondence\n        matrix.\n\n        Args:\n            S (Tensor): Sparse or dense correspondence matrix of shape\n                :obj:`[batch_size * num_nodes, num_nodes]`.\n            y (LongTensor): Ground-truth matchings of shape\n                :obj:`[2, num_ground_truths]`.\n            reduction (string, optional): Specifies the reduction to apply to\n                the output: :obj:`'none'|'mean'|'sum'`.\n                (default: :obj:`'mean'`)\n        \"\"\"", "\n", "assert", "reduction", "in", "[", "'none'", ",", "'mean'", ",", "'sum'", "]", "\n", "if", "not", "S", ".", "is_sparse", ":", "\n", "            ", "val", "=", "S", "[", "y", "[", "0", "]", ",", "y", "[", "1", "]", "]", "\n", "", "else", ":", "\n", "            ", "assert", "S", ".", "__idx__", "is", "not", "None", "and", "S", ".", "__val__", "is", "not", "None", "\n", "mask", "=", "S", ".", "__idx__", "[", "y", "[", "0", "]", "]", "==", "y", "[", "1", "]", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "val", "=", "S", ".", "__val__", "[", "[", "y", "[", "0", "]", "]", "]", "[", "mask", "]", "\n", "", "nll", "=", "-", "torch", ".", "log", "(", "val", "+", "EPS", ")", "\n", "return", "nll", "if", "reduction", "==", "'none'", "else", "getattr", "(", "torch", ",", "reduction", ")", "(", "nll", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc": [[272, 292], ["S[].argmax", "y.size", "S.__val__[].argmax"], "methods", ["None"], ["", "def", "acc", "(", "self", ",", "S", ",", "y", ",", "reduction", "=", "'mean'", ")", ":", "\n", "        ", "r\"\"\"Computes the accuracy of correspondence predictions.\n\n        Args:\n            S (Tensor): Sparse or dense correspondence matrix of shape\n                :obj:`[batch_size * num_nodes, num_nodes]`.\n            y (LongTensor): Ground-truth matchings of shape\n                :obj:`[2, num_ground_truths]`.\n            reduction (string, optional): Specifies the reduction to apply to\n                the output: :obj:`'mean'|'sum'`. (default: :obj:`'mean'`)\n        \"\"\"", "\n", "assert", "reduction", "in", "[", "'mean'", ",", "'sum'", "]", "\n", "if", "not", "S", ".", "is_sparse", ":", "\n", "            ", "pred", "=", "S", "[", "y", "[", "0", "]", "]", ".", "argmax", "(", "dim", "=", "-", "1", ")", "\n", "", "else", ":", "\n", "            ", "assert", "S", ".", "__idx__", "is", "not", "None", "and", "S", ".", "__val__", "is", "not", "None", "\n", "pred", "=", "S", ".", "__idx__", "[", "y", "[", "0", "]", ",", "S", ".", "__val__", "[", "y", "[", "0", "]", "]", ".", "argmax", "(", "dim", "=", "-", "1", ")", "]", "\n", "\n", "", "correct", "=", "(", "pred", "==", "y", "[", "1", "]", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "return", "correct", "/", "y", ".", "size", "(", "1", ")", "if", "reduction", "==", "'mean'", "else", "correct", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k": [[293, 315], ["torch.gather", "S[].argsort", "S.__val__[].argsort", "y.size", "y[].view"], "methods", ["None"], ["", "def", "hits_at_k", "(", "self", ",", "k", ",", "S", ",", "y", ",", "reduction", "=", "'mean'", ")", ":", "\n", "        ", "r\"\"\"Computes the hits@k of correspondence predictions.\n\n        Args:\n            k (int): The :math:`\\mathrm{top}_k` predictions to consider.\n            S (Tensor): Sparse or dense correspondence matrix of shape\n                :obj:`[batch_size * num_nodes, num_nodes]`.\n            y (LongTensor): Ground-truth matchings of shape\n                :obj:`[2, num_ground_truths]`.\n            reduction (string, optional): Specifies the reduction to apply to\n                the output: :obj:`'mean'|'sum'`. (default: :obj:`'mean'`)\n        \"\"\"", "\n", "assert", "reduction", "in", "[", "'mean'", ",", "'sum'", "]", "\n", "if", "not", "S", ".", "is_sparse", ":", "\n", "            ", "pred", "=", "S", "[", "y", "[", "0", "]", "]", ".", "argsort", "(", "dim", "=", "-", "1", ",", "descending", "=", "True", ")", "[", ":", ",", ":", "k", "]", "\n", "", "else", ":", "\n", "            ", "assert", "S", ".", "__idx__", "is", "not", "None", "and", "S", ".", "__val__", "is", "not", "None", "\n", "perm", "=", "S", ".", "__val__", "[", "y", "[", "0", "]", "]", ".", "argsort", "(", "dim", "=", "-", "1", ",", "descending", "=", "True", ")", "[", ":", ",", ":", "k", "]", "\n", "pred", "=", "torch", ".", "gather", "(", "S", ".", "__idx__", "[", "y", "[", "0", "]", "]", ",", "-", "1", ",", "perm", ")", "\n", "\n", "", "correct", "=", "(", "pred", "==", "y", "[", "1", "]", ".", "view", "(", "-", "1", ",", "1", ")", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "return", "correct", "/", "y", ".", "size", "(", "1", ")", "if", "reduction", "==", "'mean'", "else", "correct", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.__repr__": [[316, 323], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "(", "'{}(\\n'", "\n", "'    psi_1={},\\n'", "\n", "'    psi_2={},\\n'", "\n", "'    num_steps={}, k={}\\n)'", ")", ".", "format", "(", "self", ".", "__class__", ".", "__name__", ",", "\n", "self", ".", "psi_1", ",", "self", ".", "psi_2", ",", "\n", "self", ".", "num_steps", ",", "self", ".", "k", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.masked_softmax": [[15, 20], ["src.masked_fill", "torch.softmax", "out.masked_fill.masked_fill", "float"], "function", ["None"], ["def", "masked_softmax", "(", "src", ",", "mask", ",", "dim", "=", "-", "1", ")", ":", "\n", "    ", "out", "=", "src", ".", "masked_fill", "(", "~", "mask", ",", "float", "(", "'-inf'", ")", ")", "\n", "out", "=", "torch", ".", "softmax", "(", "out", ",", "dim", "=", "dim", ")", "\n", "out", "=", "out", ".", "masked_fill", "(", "~", "mask", ",", "0", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_sparse": [[22, 24], ["None"], "function", ["None"], ["", "def", "to_sparse", "(", "x", ",", "mask", ")", ":", "\n", "    ", "return", "x", "[", "mask", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.to_dense": [[26, 30], ["x.new_zeros", "tuple", "mask.size", "x.size"], "function", ["None"], ["", "def", "to_dense", "(", "x", ",", "mask", ")", ":", "\n", "    ", "out", "=", "x", ".", "new_zeros", "(", "tuple", "(", "mask", ".", "size", "(", ")", ")", "+", "(", "x", ".", "size", "(", "-", "1", ")", ",", ")", ")", "\n", "out", "[", "mask", "]", "=", "x", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__init__": [[7, 25], ["super().__init__", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "range", "mlp.MLP.reset_parameters", "mlp.MLP.lins.append", "mlp.MLP.batch_norms.append", "torch.nn.Linear", "torch.nn.Linear", "torch.nn.BatchNorm1d", "torch.nn.BatchNorm1d"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__init__", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "num_layers", ",", "batch_norm", "=", "False", ",", "\n", "dropout", "=", "0.0", ")", ":", "\n", "        ", "super", "(", "MLP", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "out_channels", "=", "out_channels", "\n", "self", ".", "num_layers", "=", "num_layers", "\n", "self", ".", "batch_norm", "=", "batch_norm", "\n", "self", ".", "dropout", "=", "dropout", "\n", "\n", "self", ".", "lins", "=", "torch", ".", "nn", ".", "ModuleList", "(", ")", "\n", "self", ".", "batch_norms", "=", "torch", ".", "nn", ".", "ModuleList", "(", ")", "\n", "for", "_", "in", "range", "(", "num_layers", ")", ":", "\n", "            ", "self", ".", "lins", ".", "append", "(", "Lin", "(", "in_channels", ",", "out_channels", ")", ")", "\n", "self", ".", "batch_norms", ".", "append", "(", "BN", "(", "out_channels", ")", ")", "\n", "in_channels", "=", "out_channels", "\n", "\n", "", "self", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters": [[26, 30], ["zip", "lin.reset_parameters", "batch_norm.reset_parameters"], "methods", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.reset_parameters"], ["", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "for", "lin", ",", "batch_norm", "in", "zip", "(", "self", ".", "lins", ",", "self", ".", "batch_norms", ")", ":", "\n", "            ", "lin", ".", "reset_parameters", "(", ")", "\n", "batch_norm", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.forward": [[31, 40], ["enumerate", "zip", "lin", "torch.dropout", "torch.dropout", "torch.relu", "torch.relu", "bn"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "*", "args", ")", ":", "\n", "        ", "for", "i", ",", "(", "lin", ",", "bn", ")", "in", "enumerate", "(", "zip", "(", "self", ".", "lins", ",", "self", ".", "batch_norms", ")", ")", ":", "\n", "            ", "if", "i", "==", "self", ".", "num_layers", "-", "1", ":", "\n", "                ", "x", "=", "F", ".", "dropout", "(", "x", ",", "p", "=", "self", ".", "dropout", ",", "training", "=", "self", ".", "training", ")", "\n", "", "x", "=", "lin", "(", "x", ")", "\n", "if", "i", "<", "self", ".", "num_layers", "-", "1", ":", "\n", "                ", "x", "=", "F", ".", "relu", "(", "x", ")", "\n", "x", "=", "bn", "(", "x", ")", "if", "self", ".", "batch_norm", "else", "x", "\n", "", "", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.mlp.MLP.__repr__": [[41, 45], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "'{}({}, {}, num_layers={}, batch_norm={}, dropout={})'", ".", "format", "(", "\n", "self", ".", "__class__", ".", "__name__", ",", "self", ".", "in_channels", ",", "self", ".", "out_channels", ",", "\n", "self", ".", "num_layers", ",", "self", ".", "batch_norm", ",", "self", ".", "dropout", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.dbp15k.SumEmbedding.__call__": [[20, 23], ["data.x1.sum", "data.x2.sum"], "methods", ["None"], ["    ", "def", "__call__", "(", "self", ",", "data", ")", ":", "\n", "        ", "data", ".", "x1", ",", "data", ".", "x2", "=", "data", ".", "x1", ".", "sum", "(", "dim", "=", "1", ")", ",", "data", ".", "x2", ".", "sum", "(", "dim", "=", "1", ")", "\n", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.dbp15k.train": [[37, 48], ["model.train", "optimizer.zero_grad", "model", "model.loss", "model.loss.backward", "optimizer.step"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.train", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss"], ["def", "train", "(", ")", ":", "\n", "    ", "model", ".", "train", "(", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "_", ",", "S_L", "=", "model", "(", "data", ".", "x1", ",", "data", ".", "edge_index1", ",", "None", ",", "None", ",", "data", ".", "x2", ",", "\n", "data", ".", "edge_index2", ",", "None", ",", "None", ",", "data", ".", "train_y", ")", "\n", "\n", "loss", "=", "model", ".", "loss", "(", "S_L", ",", "data", ".", "train_y", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.dbp15k.test": [[50, 61], ["torch.no_grad", "model.eval", "model", "model.acc", "model.hits_at_k"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.hits_at_k"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "test", "(", ")", ":", "\n", "    ", "model", ".", "eval", "(", ")", "\n", "\n", "_", ",", "S_L", "=", "model", "(", "data", ".", "x1", ",", "data", ".", "edge_index1", ",", "None", ",", "None", ",", "data", ".", "x2", ",", "\n", "data", ".", "edge_index2", ",", "None", ",", "None", ")", "\n", "\n", "hits1", "=", "model", ".", "acc", "(", "S_L", ",", "data", ".", "test_y", ")", "\n", "hits10", "=", "model", ".", "hits_at_k", "(", "10", ",", "S_L", ",", "data", ".", "test_y", ")", "\n", "\n", "return", "hits1", ",", "hits10", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__init__": [[24, 35], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "min_inliers", ",", "max_inliers", ",", "min_outliers", ",", "max_outliers", ",", "\n", "min_scale", "=", "0.9", ",", "max_scale", "=", "1.2", ",", "noise", "=", "0.05", ",", "transform", "=", "None", ")", ":", "\n", "\n", "        ", "self", ".", "min_inliers", "=", "min_inliers", "\n", "self", ".", "max_inliers", "=", "max_inliers", "\n", "self", ".", "min_outliers", "=", "min_outliers", "\n", "self", ".", "max_outliers", "=", "max_outliers", "\n", "self", ".", "min_scale", "=", "min_scale", "\n", "self", ".", "max_scale", "=", "max_scale", "\n", "self", ".", "noise", "=", "noise", "\n", "self", ".", "transform", "=", "transform", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__len__": [[36, 38], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "1024", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.RandomGraphDataset.__getitem__": [[39, 66], ["random.randint", "random.randint", "torch.arange", "torch.arange", "torch.cat", "torch.cat", "torch_geometric.data.Data", "torch_geometric.data.Data", "torch_geometric.data.Data", "torch.cat.size", "torch.cat.size", "pascal_pf.RandomGraphDataset.transform", "pascal_pf.RandomGraphDataset.transform", "torch.rand", "torch.randn_like", "torch.cat.size", "torch.rand", "torch.rand"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "num_inliers", "=", "random", ".", "randint", "(", "self", ".", "min_inliers", ",", "self", ".", "max_inliers", ")", "\n", "num_outliers", "=", "random", ".", "randint", "(", "self", ".", "min_outliers", ",", "self", ".", "max_outliers", ")", "\n", "\n", "pos_s", "=", "2", "*", "torch", ".", "rand", "(", "(", "num_inliers", ",", "2", ")", ")", "-", "1", "\n", "pos_t", "=", "pos_s", "+", "self", ".", "noise", "*", "torch", ".", "randn_like", "(", "pos_s", ")", "\n", "\n", "y_s", "=", "torch", ".", "arange", "(", "pos_s", ".", "size", "(", "0", ")", ")", "\n", "y_t", "=", "torch", ".", "arange", "(", "pos_t", ".", "size", "(", "0", ")", ")", "\n", "\n", "pos_s", "=", "torch", ".", "cat", "(", "[", "pos_s", ",", "3", "-", "torch", ".", "rand", "(", "(", "num_outliers", ",", "2", ")", ")", "]", ",", "dim", "=", "0", ")", "\n", "pos_t", "=", "torch", ".", "cat", "(", "[", "pos_t", ",", "3", "-", "torch", ".", "rand", "(", "(", "num_outliers", ",", "2", ")", ")", "]", ",", "dim", "=", "0", ")", "\n", "\n", "data_s", "=", "Data", "(", "pos", "=", "pos_s", ",", "y_index", "=", "y_s", ")", "\n", "data_t", "=", "Data", "(", "pos", "=", "pos_t", ",", "y", "=", "y_t", ")", "\n", "\n", "if", "self", ".", "transform", "is", "not", "None", ":", "\n", "            ", "data_s", "=", "self", ".", "transform", "(", "data_s", ")", "\n", "data_t", "=", "self", ".", "transform", "(", "data_t", ")", "\n", "\n", "", "data", "=", "Data", "(", "num_nodes", "=", "pos_s", ".", "size", "(", "0", ")", ")", "\n", "for", "key", "in", "data_s", ".", "keys", ":", "\n", "            ", "data", "[", "'{}_s'", ".", "format", "(", "key", ")", "]", "=", "data_s", "[", "key", "]", "\n", "", "for", "key", "in", "data_t", ".", "keys", ":", "\n", "            ", "data", "[", "'{}_t'", ".", "format", "(", "key", ")", "]", "=", "data_t", "[", "key", "]", "\n", "\n", "", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.train": [[88, 108], ["model.train", "enumerate", "optimizer.zero_grad", "data.to.to", "model", "torch.stack", "model.loss", "model.loss.backward", "optimizer.step", "model.loss.item", "model.acc", "torch.stack.size", "len", "model.loss"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.train", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss"], ["def", "train", "(", ")", ":", "\n", "    ", "model", ".", "train", "(", ")", "\n", "\n", "total_loss", "=", "total_examples", "=", "total_correct", "=", "0", "\n", "for", "i", ",", "data", "in", "enumerate", "(", "train_loader", ")", ":", "\n", "        ", "optimizer", ".", "zero_grad", "(", ")", "\n", "data", "=", "data", ".", "to", "(", "device", ")", "\n", "S_0", ",", "S_L", "=", "model", "(", "data", ".", "x_s", ",", "data", ".", "edge_index_s", ",", "data", ".", "edge_attr_s", ",", "\n", "data", ".", "x_s_batch", ",", "data", ".", "x_t", ",", "data", ".", "edge_index_t", ",", "\n", "data", ".", "edge_attr_t", ",", "data", ".", "x_t_batch", ")", "\n", "y", "=", "torch", ".", "stack", "(", "[", "data", ".", "y_index_s", ",", "data", ".", "y_t", "]", ",", "dim", "=", "0", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_0", ",", "y", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_L", ",", "y", ")", "+", "loss", "if", "model", ".", "num_steps", ">", "0", "else", "loss", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "total_loss", "+=", "loss", ".", "item", "(", ")", "\n", "total_correct", "+=", "model", ".", "acc", "(", "S_L", ",", "y", ",", "reduction", "=", "'sum'", ")", "\n", "total_examples", "+=", "y", ".", "size", "(", "1", ")", "\n", "\n", "", "return", "total_loss", "/", "len", "(", "train_loader", ")", ",", "total_correct", "/", "total_examples", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal_pf.test": [[110, 126], ["torch.no_grad", "model.eval", "model", "torch.arange", "torch.stack", "model.acc", "torch.stack.size", "data_s.to", "data_t.to"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "test", "(", "dataset", ")", ":", "\n", "    ", "model", ".", "eval", "(", ")", "\n", "\n", "correct", "=", "num_examples", "=", "0", "\n", "for", "pair", "in", "dataset", ".", "pairs", ":", "\n", "        ", "data_s", ",", "data_t", "=", "dataset", "[", "pair", "[", "0", "]", "]", ",", "dataset", "[", "pair", "[", "1", "]", "]", "\n", "data_s", ",", "data_t", "=", "data_s", ".", "to", "(", "device", ")", ",", "data_t", ".", "to", "(", "device", ")", "\n", "S_0", ",", "S_L", "=", "model", "(", "data_s", ".", "x", ",", "data_s", ".", "edge_index", ",", "data_s", ".", "edge_attr", ",", "None", ",", "\n", "data_t", ".", "x", ",", "data_t", ".", "edge_index", ",", "data_t", ".", "edge_attr", ",", "None", ")", "\n", "y", "=", "torch", ".", "arange", "(", "data_s", ".", "num_nodes", ",", "device", "=", "device", ")", "\n", "y", "=", "torch", ".", "stack", "(", "[", "y", ",", "y", "]", ",", "dim", "=", "0", ")", "\n", "correct", "+=", "model", ".", "acc", "(", "S_L", ",", "y", ",", "reduction", "=", "'sum'", ")", "\n", "num_examples", "+=", "y", ".", "size", "(", "1", ")", "\n", "\n", "", "return", "correct", "/", "num_examples", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal.generate_y": [[55, 58], ["torch.arange", "torch.stack", "y_col.size"], "function", ["None"], ["def", "generate_y", "(", "y_col", ")", ":", "\n", "    ", "y_row", "=", "torch", ".", "arange", "(", "y_col", ".", "size", "(", "0", ")", ",", "device", "=", "device", ")", "\n", "return", "torch", ".", "stack", "(", "[", "y_row", ",", "y_col", "]", ",", "dim", "=", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal.train": [[60, 78], ["model.train", "optimizer.zero_grad", "data.to.to", "model", "pascal.generate_y", "model.loss", "model.loss.backward", "optimizer.step", "len", "model.loss.item", "model.loss", "data.to.x_s_batch.max().item", "data.to.x_s_batch.max"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.train", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.generate_y", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss"], ["", "def", "train", "(", ")", ":", "\n", "    ", "model", ".", "train", "(", ")", "\n", "\n", "total_loss", "=", "0", "\n", "for", "data", "in", "train_loader", ":", "\n", "        ", "optimizer", ".", "zero_grad", "(", ")", "\n", "data", "=", "data", ".", "to", "(", "device", ")", "\n", "S_0", ",", "S_L", "=", "model", "(", "data", ".", "x_s", ",", "data", ".", "edge_index_s", ",", "data", ".", "edge_attr_s", ",", "\n", "data", ".", "x_s_batch", ",", "data", ".", "x_t", ",", "data", ".", "edge_index_t", ",", "\n", "data", ".", "edge_attr_t", ",", "data", ".", "x_t_batch", ")", "\n", "y", "=", "generate_y", "(", "data", ".", "y", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_0", ",", "y", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_L", ",", "y", ")", "+", "loss", "if", "model", ".", "num_steps", ">", "0", "else", "loss", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "total_loss", "+=", "loss", ".", "item", "(", ")", "*", "(", "data", ".", "x_s_batch", ".", "max", "(", ")", ".", "item", "(", ")", "+", "1", ")", "\n", "\n", "", "return", "total_loss", "/", "len", "(", "train_loader", ".", "dataset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.pascal.test": [[80, 100], ["torch.no_grad", "model.eval", "torch_geometric.data.DataLoader", "data.to.to", "model", "pascal.generate_y", "model.acc", "generate_y.size"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.generate_y", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "test", "(", "dataset", ")", ":", "\n", "    ", "model", ".", "eval", "(", ")", "\n", "\n", "loader", "=", "DataLoader", "(", "dataset", ",", "args", ".", "batch_size", ",", "shuffle", "=", "False", ",", "\n", "follow_batch", "=", "[", "'x_s'", ",", "'x_t'", "]", ")", "\n", "\n", "correct", "=", "num_examples", "=", "0", "\n", "while", "(", "num_examples", "<", "args", ".", "test_samples", ")", ":", "\n", "        ", "for", "data", "in", "loader", ":", "\n", "            ", "data", "=", "data", ".", "to", "(", "device", ")", "\n", "S_0", ",", "S_L", "=", "model", "(", "data", ".", "x_s", ",", "data", ".", "edge_index_s", ",", "data", ".", "edge_attr_s", ",", "\n", "data", ".", "x_s_batch", ",", "data", ".", "x_t", ",", "data", ".", "edge_index_t", ",", "\n", "data", ".", "edge_attr_t", ",", "data", ".", "x_t_batch", ")", "\n", "y", "=", "generate_y", "(", "data", ".", "y", ")", "\n", "correct", "+=", "model", ".", "acc", "(", "S_L", ",", "y", ",", "reduction", "=", "'sum'", ")", "\n", "num_examples", "+=", "y", ".", "size", "(", "1", ")", "\n", "\n", "if", "num_examples", ">=", "args", ".", "test_samples", ":", "\n", "                ", "return", "correct", "/", "num_examples", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.generate_voc_y": [[61, 64], ["torch.arange", "torch.stack", "y_col.size"], "function", ["None"], ["def", "generate_voc_y", "(", "y_col", ")", ":", "\n", "    ", "y_row", "=", "torch", ".", "arange", "(", "y_col", ".", "size", "(", "0", ")", ",", "device", "=", "device", ")", "\n", "return", "torch", ".", "stack", "(", "[", "y_row", ",", "y_col", "]", ",", "dim", "=", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.pretrain": [[66, 84], ["model.train", "optimizer.zero_grad", "data.to.to", "model", "willow.generate_voc_y", "model.loss", "model.loss.backward", "optimizer.step", "len", "model.loss.item", "model.loss", "data.to.x_s_batch.max().item", "data.to.x_s_batch.max"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.train", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.generate_voc_y", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss"], ["", "def", "pretrain", "(", ")", ":", "\n", "    ", "model", ".", "train", "(", ")", "\n", "\n", "total_loss", "=", "0", "\n", "for", "data", "in", "pretrain_loader", ":", "\n", "        ", "optimizer", ".", "zero_grad", "(", ")", "\n", "data", "=", "data", ".", "to", "(", "device", ")", "\n", "S_0", ",", "S_L", "=", "model", "(", "data", ".", "x_s", ",", "data", ".", "edge_index_s", ",", "data", ".", "edge_attr_s", ",", "\n", "data", ".", "x_s_batch", ",", "data", ".", "x_t", ",", "data", ".", "edge_index_t", ",", "\n", "data", ".", "edge_attr_t", ",", "data", ".", "x_t_batch", ")", "\n", "y", "=", "generate_voc_y", "(", "data", ".", "y", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_0", ",", "y", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_L", ",", "y", ")", "+", "loss", "if", "model", ".", "num_steps", ">", "0", "else", "loss", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "total_loss", "+=", "loss", ".", "item", "(", ")", "*", "(", "data", ".", "x_s_batch", ".", "max", "(", ")", ".", "item", "(", ")", "+", "1", ")", "\n", "\n", "", "return", "total_loss", "/", "len", "(", "pretrain_loader", ".", "dataset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.generate_y": [[94, 98], ["torch.arange", "row[].view().repeat().view", "torch.stack", "row[].view().repeat", "row[].view"], "function", ["None"], ["def", "generate_y", "(", "num_nodes", ",", "batch_size", ")", ":", "\n", "    ", "row", "=", "torch", ".", "arange", "(", "num_nodes", "*", "batch_size", ",", "device", "=", "device", ")", "\n", "col", "=", "row", "[", ":", "num_nodes", "]", ".", "view", "(", "1", ",", "-", "1", ")", ".", "repeat", "(", "batch_size", ",", "1", ")", ".", "view", "(", "-", "1", ")", "\n", "return", "torch", ".", "stack", "(", "[", "row", ",", "col", "]", ",", "dim", "=", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.train": [[100, 119], ["model.train", "optimizer.zero_grad", "data.to.to", "model", "willow.generate_y", "model.loss", "model.loss.backward", "optimizer.step", "len", "data.to.x_s_batch.max().item", "model.loss.item", "model.loss", "data.to.x_s_batch.max"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.train", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.generate_y", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.loss"], ["", "def", "train", "(", "train_loader", ",", "optimizer", ")", ":", "\n", "    ", "model", ".", "train", "(", ")", "\n", "\n", "total_loss", "=", "0", "\n", "for", "data", "in", "train_loader", ":", "\n", "        ", "optimizer", ".", "zero_grad", "(", ")", "\n", "data", "=", "data", ".", "to", "(", "device", ")", "\n", "S_0", ",", "S_L", "=", "model", "(", "data", ".", "x_s", ",", "data", ".", "edge_index_s", ",", "data", ".", "edge_attr_s", ",", "\n", "data", ".", "x_s_batch", ",", "data", ".", "x_t", ",", "data", ".", "edge_index_t", ",", "\n", "data", ".", "edge_attr_t", ",", "data", ".", "x_t_batch", ")", "\n", "num_graphs", "=", "data", ".", "x_s_batch", ".", "max", "(", ")", ".", "item", "(", ")", "+", "1", "\n", "y", "=", "generate_y", "(", "num_nodes", "=", "10", ",", "batch_size", "=", "num_graphs", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_0", ",", "y", ")", "\n", "loss", "=", "model", ".", "loss", "(", "S_L", ",", "y", ")", "+", "loss", "if", "model", ".", "num_steps", ">", "0", "else", "loss", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "total_loss", "+=", "loss", ".", "item", "(", ")", "*", "num_graphs", "\n", "\n", "", "return", "total_loss", "/", "len", "(", "train_loader", ".", "dataset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.test": [[121, 141], ["torch.no_grad", "model.eval", "torch_geometric.data.DataLoader", "torch_geometric.data.DataLoader", "zip", "model", "willow.generate_y", "model.acc", "generate_y.size", "data_s.to", "data_t.to"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.generate_y", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.models.dgmc.DGMC.acc"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "test", "(", "test_dataset", ")", ":", "\n", "    ", "model", ".", "eval", "(", ")", "\n", "\n", "test_loader1", "=", "DataLoader", "(", "test_dataset", ",", "args", ".", "batch_size", ",", "shuffle", "=", "True", ")", "\n", "test_loader2", "=", "DataLoader", "(", "test_dataset", ",", "args", ".", "batch_size", ",", "shuffle", "=", "True", ")", "\n", "\n", "correct", "=", "num_examples", "=", "0", "\n", "while", "(", "num_examples", "<", "args", ".", "test_samples", ")", ":", "\n", "        ", "for", "data_s", ",", "data_t", "in", "zip", "(", "test_loader1", ",", "test_loader2", ")", ":", "\n", "            ", "data_s", ",", "data_t", "=", "data_s", ".", "to", "(", "device", ")", ",", "data_t", ".", "to", "(", "device", ")", "\n", "_", ",", "S_L", "=", "model", "(", "data_s", ".", "x", ",", "data_s", ".", "edge_index", ",", "data_s", ".", "edge_attr", ",", "\n", "data_s", ".", "batch", ",", "data_t", ".", "x", ",", "data_t", ".", "edge_index", ",", "\n", "data_t", ".", "edge_attr", ",", "data_t", ".", "batch", ")", "\n", "y", "=", "generate_y", "(", "num_nodes", "=", "10", ",", "batch_size", "=", "data_t", ".", "num_graphs", ")", "\n", "correct", "+=", "model", ".", "acc", "(", "S_L", ",", "y", ",", "reduction", "=", "'sum'", ")", "\n", "num_examples", "+=", "y", ".", "size", "(", "1", ")", "\n", "\n", "if", "num_examples", ">=", "args", ".", "test_samples", ":", "\n", "                ", "return", "correct", "/", "num_examples", "\n", "\n"]], "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.run": [[143, 168], ["torch.utils.data.ConcatDataset", "torch_geometric.data.DataLoader", "model.load_state_dict", "torch.optim.Adam", "range", "print", "print", "print", "dataset.shuffle", "dgmc.utils.PairDataset", "model.parameters", "willow.train", "willow.test", "category.ljust"], "function", ["home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.train", "home.repos.pwc.inspect_result.rusty1s_deep-graph-matching-consensus.examples.willow.test"], ["", "", "", "", "def", "run", "(", "i", ",", "datasets", ")", ":", "\n", "    ", "datasets", "=", "[", "dataset", ".", "shuffle", "(", ")", "for", "dataset", "in", "datasets", "]", "\n", "train_datasets", "=", "[", "dataset", "[", ":", "20", "]", "for", "dataset", "in", "datasets", "]", "\n", "test_datasets", "=", "[", "dataset", "[", "20", ":", "]", "for", "dataset", "in", "datasets", "]", "\n", "train_datasets", "=", "[", "\n", "PairDataset", "(", "train_dataset", ",", "train_dataset", ",", "sample", "=", "False", ")", "\n", "for", "train_dataset", "in", "train_datasets", "\n", "]", "\n", "train_dataset", "=", "torch", ".", "utils", ".", "data", ".", "ConcatDataset", "(", "train_datasets", ")", "\n", "train_loader", "=", "DataLoader", "(", "train_dataset", ",", "args", ".", "batch_size", ",", "shuffle", "=", "True", ",", "\n", "follow_batch", "=", "[", "'x_s'", ",", "'x_t'", "]", ")", "\n", "\n", "model", ".", "load_state_dict", "(", "state_dict", ")", "\n", "optimizer", "=", "torch", ".", "optim", ".", "Adam", "(", "model", ".", "parameters", "(", ")", ",", "lr", "=", "args", ".", "lr", ")", "\n", "\n", "for", "epoch", "in", "range", "(", "1", ",", "1", "+", "args", ".", "epochs", ")", ":", "\n", "        ", "train", "(", "train_loader", ",", "optimizer", ")", "\n", "\n", "", "accs", "=", "[", "100", "*", "test", "(", "test_dataset", ")", "for", "test_dataset", "in", "test_datasets", "]", "\n", "\n", "print", "(", "f'Run {i:02d}:'", ")", "\n", "print", "(", "' '", ".", "join", "(", "[", "category", ".", "ljust", "(", "13", ")", "for", "category", "in", "WILLOW", ".", "categories", "]", ")", ")", "\n", "print", "(", "' '", ".", "join", "(", "[", "f'{acc:.2f}'", ".", "ljust", "(", "13", ")", "for", "acc", "in", "accs", "]", ")", ")", "\n", "\n", "return", "accs", "\n", "\n"]]}