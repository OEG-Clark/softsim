{"home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.main.run_train": [[38, 53], ["utils.BatchCreate", "range", "tensorflow.get_collection", "tensorflow.get_collection", "utils.BatchCreate.next_batch", "sess.run", "sess.run", "print", "tensorflow.get_collection", "tensorflow.get_collection"], "function", ["home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.utils.BatchCreate.next_batch"], ["def", "run_train", "(", "sess", ",", "train_X", ",", "train_Y", ",", "val_X", ",", "val_Y", ")", ":", "\n", "    ", "X", "=", "tf", ".", "get_collection", "(", "'input'", ")", "[", "0", "]", "\n", "Y", "=", "tf", ".", "get_collection", "(", "'output'", ")", "[", "0", "]", "\n", "\n", "Iterator", "=", "BatchCreate", "(", "train_X", ",", "train_Y", ")", "\n", "for", "step", "in", "range", "(", "1", ",", "FLAGS", ".", "train_step", "+", "1", ")", ":", "\n", "        ", "if", "step", "%", "100", "==", "0", ":", "\n", "            ", "val_loss", ",", "val_accuracy", "=", "sess", ".", "run", "(", "tf", ".", "get_collection", "(", "'validate_ops'", ")", ",", "\n", "feed_dict", "=", "{", "X", ":", "val_X", ",", "Y", ":", "val_Y", "}", ")", "\n", "\n", "print", "(", "'[%4d] AFS-loss:%.12f AFS-accuracy:%.6f'", "%", "\n", "(", "step", ",", "val_loss", ",", "val_accuracy", ")", ")", "\n", "", "xs", ",", "ys", "=", "Iterator", ".", "next_batch", "(", "FLAGS", ".", "batch_size", ")", "\n", "_", ",", "A", "=", "sess", ".", "run", "(", "tf", ".", "get_collection", "(", "'train_ops'", ")", ",", "feed_dict", "=", "{", "X", ":", "xs", ",", "Y", ":", "ys", "}", ")", "\n", "", "return", "A", "\n", "", "def", "run_test", "(", "A", ",", "train_X", ",", "train_Y", ",", "test_X", ",", "test_Y", ",", "total_batch", ")", ":", "\n"]], "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.main.run_test": [[53, 68], ["A.mean", "range", "list", "model.test", "print", "ac_score_list.append", "numpy.argsort"], "function", ["home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.model.test"], ["", "def", "run_test", "(", "A", ",", "train_X", ",", "train_Y", ",", "test_X", ",", "test_Y", ",", "total_batch", ")", ":", "\n", "\n", "    ", "attention_weight", "=", "A", ".", "mean", "(", "0", ")", "\n", "AFS_wight_rank", "=", "list", "(", "np", ".", "argsort", "(", "attention_weight", ")", ")", "[", ":", ":", "-", "1", "]", "\n", "ac_score_list", "=", "[", "]", "\n", "index", "=", "1", "\n", "for", "K", "in", "range", "(", "5", ",", "300", ",", "10", ")", ":", "\n", "        ", "use_train_x", "=", "train_X", "[", ":", ",", "AFS_wight_rank", "[", ":", "K", "]", "]", "\n", "use_test_x", "=", "test_X", "[", ":", ",", "AFS_wight_rank", "[", ":", "K", "]", "]", "\n", "accuracy", "=", "model", ".", "test", "(", "K", ",", "use_train_x", ",", "train_Y", ",", "use_test_x", ",", "test_Y", ",", "total_batch", ",", "index", ")", "\n", "index", "+=", "1", "\n", "print", "(", "'Using Top {} features| accuracy:{:.4f}'", ".", "format", "(", "K", ",", "accuracy", ")", ")", "\n", "\n", "ac_score_list", ".", "append", "(", "accuracy", ")", "\n", "", "return", "ac_score_list", "\n", "", "def", "main", "(", "argv", "=", "None", ")", ":", "\n"]], "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.main.main": [[68, 91], ["numpy.load", "len", "model.build", "print", "main.run_test", "utils.show_result", "tensorflow.examples.tutorials.mnist.input_data.read_data_sets", "tensorflow.Session", "tensorflow.global_variables_initializer().run", "print", "main.run_train", "tensorflow.global_variables_initializer"], "function", ["home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.model.build", "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.main.run_test", "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.utils.show_result", "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.main.run_train"], ["", "def", "main", "(", "argv", "=", "None", ")", ":", "\n", "    ", "data_file", "=", "FLAGS", ".", "data_dir", "+", "FLAGS", ".", "dataset_name", "+", "'.npz'", "\n", "\n", "data", "=", "np", ".", "load", "(", "data_file", ")", "\n", "read_index", "=", "FLAGS", ".", "read_index", "\n", "train_data", ",", "train_labels", ",", "test_data", ",", "test_labels", "=", "data", "[", "'train_X'", "]", ",", "data", "[", "'train_Y'", "]", ",", "data", "[", "'test_X'", "]", ",", "data", "[", "'test_Y'", "]", "\n", "train_X", ",", "train_Y", ",", "test_X", ",", "test_Y", "=", "train_data", "[", "read_index", "]", ",", "train_labels", "[", "read_index", "]", ",", "test_data", "[", "read_index", "]", ",", "test_labels", "[", "read_index", "]", "\n", "if", "FLAGS", ".", "dataset_name", "!=", "'mnist'", ":", "\n", "        ", "train_X", ",", "test_X", "=", "train_X", "/", "255", ",", "test_X", "/", "255", "\n", "val_X", ",", "val_Y", "=", "data", "[", "'val_X'", "]", "/", "255", ",", "data", "[", "'val_Y'", "]", "\n", "", "else", ":", "\n", "        ", "mnist", "=", "input_data", ".", "read_data_sets", "(", "FLAGS", ".", "data_dir", ",", "one_hot", "=", "True", ")", "\n", "val_X", ",", "val_Y", "=", "mnist", ".", "validation", ".", "images", ",", "mnist", ".", "validation", ".", "labels", "\n", "", "Train_size", "=", "len", "(", "train_X", ")", "\n", "total_batch", "=", "Train_size", "/", "FLAGS", ".", "batch_size", "\n", "model", ".", "build", "(", "total_batch", ")", "\n", "with", "tf", ".", "Session", "(", ")", "as", "sess", ":", "\n", "        ", "tf", ".", "global_variables_initializer", "(", ")", ".", "run", "(", ")", "\n", "print", "(", "'== Get feature weight by using AFS =='", ")", "\n", "A", "=", "run_train", "(", "sess", ",", "train_X", ",", "train_Y", ",", "val_X", ",", "val_Y", ")", "\n", "", "print", "(", "'==  The Evaluation of AFS =='", ")", "\n", "ac_score_list", "=", "run_test", "(", "A", ",", "train_X", ",", "train_Y", ",", "test_X", ",", "test_Y", ",", "total_batch", ")", "\n", "show_result", "(", "ac_score_list", ",", "FLAGS", ".", "dataset_name", ")", "\n", "", "if", "__name__", "==", "'__main__'", ":", "\n"]], "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.model.build": [[4, 90], ["tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.Variable", "tensorflow.add_to_collection", "tensorflow.add_to_collection", "tensorflow.variable_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.nn.tanh", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.unstack", "tensorflow.unstack", "range", "tensorflow.squeeze", "tensorflow.variable_scope", "tensorflow.multiply", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.train.ExponentialMovingAverage", "tf.train.ExponentialMovingAverage.apply", "tensorflow.nn.relu", "tensorflow.nn.relu", "tensorflow.name_scope", "tensorflow.contrib.layers.l2_regularizer", "tensorflow.train.exponential_decay", "tensorflow.nn.sparse_softmax_cross_entropy_with_logits", "tensorflow.reduce_mean", "tensorflow.equal", "tensorflow.reduce_mean", "tensorflow.name_scope", "tensorflow.get_collection", "tensorflow.get_collection", "tensorflow.get_collection", "tensorflow.train.GradientDescentOptimizer().minimize", "tensorflow.control_dependencies", "tensorflow.no_op", "tensorflow.add_to_collection", "tensorflow.add_to_collection", "tensorflow.truncated_normal", "tensorflow.constant", "tensorflow.truncated_normal", "tensorflow.constant", "tensorflow.nn.softmax", "tensorflow.expand_dims", "attention_out_list.append", "tensorflow.stack", "tensorflow.truncated_normal", "tensorflow.constant", "tensorflow.truncated_normal", "tensorflow.constant", "tensorflow.trainable_variables", "tensorflow.matmul", "tensorflow.matmul", "tf.train.ExponentialMovingAverage.average", "tf.contrib.layers.l2_regularizer.", "tf.contrib.layers.l2_regularizer.", "tensorflow.argmax", "tensorflow.argmax", "tensorflow.cast", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tensorflow.matmul", "tf.train.ExponentialMovingAverage.average", "tf.train.ExponentialMovingAverage.average", "tensorflow.argmax", "tensorflow.train.GradientDescentOptimizer", "tf.train.ExponentialMovingAverage.average"], "function", ["None"], ["def", "build", "(", "total_batch", ")", ":", "\n", "    ", "X", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "None", ",", "FLAGS", ".", "input_size", "]", ")", "\n", "Y", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "None", ",", "FLAGS", ".", "output_size", "]", ")", "\n", "global_step", "=", "tf", ".", "Variable", "(", "0", ",", "trainable", "=", "False", ")", "\n", "\n", "tf", ".", "add_to_collection", "(", "'input'", ",", "X", ")", "\n", "tf", ".", "add_to_collection", "(", "'output'", ",", "Y", ")", "\n", "\n", "with", "tf", ".", "variable_scope", "(", "'attention_module'", ")", "as", "scope", ":", "\n", "        ", "E_W", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "truncated_normal", "(", "[", "FLAGS", ".", "input_size", ",", "FLAGS", ".", "E_node", "]", ",", "stddev", "=", "0.1", ",", "seed", "=", "FLAGS", ".", "set_seed", ")", ")", "\n", "E_b", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "constant", "(", "0.1", ",", "shape", "=", "[", "FLAGS", ".", "E_node", "]", ")", ")", "\n", "\n", "E", "=", "tf", ".", "nn", ".", "tanh", "(", "tf", ".", "matmul", "(", "X", ",", "E_W", ")", "+", "E_b", ")", "\n", "\n", "A_W", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "truncated_normal", "(", "[", "FLAGS", ".", "input_size", ",", "FLAGS", ".", "E_node", ",", "FLAGS", ".", "A_node", "]", ",", "stddev", "=", "0.1", ",", "seed", "=", "FLAGS", ".", "set_seed", ")", ")", "\n", "A_b", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "constant", "(", "0.1", ",", "shape", "=", "[", "FLAGS", ".", "input_size", ",", "FLAGS", ".", "A_node", "]", ")", ")", "\n", "\n", "A_W_unstack", "=", "tf", ".", "unstack", "(", "A_W", ",", "axis", "=", "0", ")", "\n", "A_b_unstack", "=", "tf", ".", "unstack", "(", "A_b", ",", "axis", "=", "0", ")", "\n", "\n", "attention_out_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "FLAGS", ".", "input_size", ")", ":", "\n", "            ", "attention_FC", "=", "tf", ".", "matmul", "(", "E", ",", "A_W_unstack", "[", "i", "]", ")", "+", "A_b_unstack", "[", "i", "]", "\n", "attention_out", "=", "tf", ".", "nn", ".", "softmax", "(", "attention_FC", ")", "\n", "\n", "attention_out", "=", "tf", ".", "expand_dims", "(", "attention_out", "[", ":", ",", "1", "]", ",", "axis", "=", "1", ")", "\n", "\n", "attention_out_list", ".", "append", "(", "attention_out", ")", "\n", "", "A", "=", "tf", ".", "squeeze", "(", "tf", ".", "stack", "(", "attention_out_list", ",", "axis", "=", "1", ")", ",", "axis", "=", "2", ")", "\n", "\n", "", "with", "tf", ".", "variable_scope", "(", "\"learning_module\"", ")", "as", "scope", ":", "\n", "        ", "G", "=", "tf", ".", "multiply", "(", "X", ",", "A", ")", "\n", "L_W1", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "truncated_normal", "(", "[", "FLAGS", ".", "input_size", ",", "FLAGS", ".", "L_node", "]", ",", "stddev", "=", "0.1", ",", "seed", "=", "FLAGS", ".", "set_seed", ")", ")", "\n", "L_b1", "=", "tf", ".", "Variable", "(", "tf", ".", "constant", "(", "0.1", ",", "shape", "=", "[", "FLAGS", ".", "L_node", "]", ")", ")", "\n", "L_W2", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "truncated_normal", "(", "[", "FLAGS", ".", "L_node", ",", "FLAGS", ".", "output_size", "]", ",", "stddev", "=", "0.1", ",", "seed", "=", "FLAGS", ".", "set_seed", ")", ")", "\n", "L_b2", "=", "tf", ".", "Variable", "(", "tf", ".", "constant", "(", "0.1", ",", "shape", "=", "[", "FLAGS", ".", "output_size", "]", ")", ")", "\n", "\n", "\n", "variable_averages", "=", "tf", ".", "train", ".", "ExponentialMovingAverage", "(", "\n", "FLAGS", ".", "moving_average_decay", ",", "global_step", ")", "\n", "variable_averages_op", "=", "variable_averages", ".", "apply", "(", "\n", "tf", ".", "trainable_variables", "(", ")", ")", "\n", "L_FC", "=", "tf", ".", "nn", ".", "relu", "(", "tf", ".", "matmul", "(", "G", ",", "L_W1", ")", "+", "L_b1", ")", "\n", "O", "=", "tf", ".", "matmul", "(", "L_FC", ",", "L_W2", ")", "+", "L_b2", "\n", "\n", "average_L_FC", "=", "tf", ".", "nn", ".", "relu", "(", "tf", ".", "matmul", "(", "G", ",", "variable_averages", ".", "average", "(", "L_W1", ")", ")", "+", "variable_averages", ".", "average", "(", "L_b1", ")", ")", "\n", "average_O", "=", "tf", ".", "matmul", "(", "average_L_FC", ",", "variable_averages", ".", "average", "(", "L_W2", ")", ")", "+", "variable_averages", ".", "average", "(", "L_b2", ")", "\n", "\n", "", "with", "tf", ".", "name_scope", "(", "\"Loss\"", ")", "as", "scope", ":", "\n", "        ", "regularizer", "=", "tf", ".", "contrib", ".", "layers", ".", "l2_regularizer", "(", "\n", "FLAGS", ".", "regularization_rate", ")", "\n", "regularization", "=", "regularizer", "(", "L_W1", ")", "+", "regularizer", "(", "L_W2", ")", "\n", "\n", "learning_rate", "=", "tf", ".", "train", ".", "exponential_decay", "(", "\n", "FLAGS", ".", "learning_rate_base", ",", "global_step", ",", "total_batch", ",", "\n", "FLAGS", ".", "learning_rate_decay", ")", "\n", "\n", "\n", "cross_entropy", "=", "tf", ".", "nn", ".", "sparse_softmax_cross_entropy_with_logits", "(", "\n", "logits", "=", "O", ",", "labels", "=", "tf", ".", "argmax", "(", "Y", ",", "1", ")", ")", "\n", "cross_entropy_mean", "=", "tf", ".", "reduce_mean", "(", "cross_entropy", ")", "\n", "loss", "=", "cross_entropy_mean", "+", "regularization", "\n", "\n", "correct_prediction", "=", "tf", ".", "equal", "(", "tf", ".", "argmax", "(", "average_O", ",", "1", ")", ",", "\n", "tf", ".", "argmax", "(", "Y", ",", "1", ")", ")", "\n", "accuracy", "=", "tf", ".", "reduce_mean", "(", "tf", ".", "cast", "(", "correct_prediction", ",", "tf", ".", "float32", ")", ")", "\n", "", "with", "tf", ".", "name_scope", "(", "\"Train\"", ")", "as", "scope", ":", "\n", "        ", "vars_A", "=", "tf", ".", "get_collection", "(", "tf", ".", "GraphKeys", ".", "TRAINABLE_VARIABLES", ",", "scope", "=", "'attention_module'", ")", "\n", "vars_L", "=", "tf", ".", "get_collection", "(", "tf", ".", "GraphKeys", ".", "TRAINABLE_VARIABLES", ",", "scope", "=", "'learning_module'", ")", "\n", "vars_R", "=", "tf", ".", "get_collection", "(", "tf", ".", "GraphKeys", ".", "TRAINABLE_VARIABLES", ",", "scope", "=", "'Loss'", ")", "\n", "# Minimizing Loss Function", "\n", "optimizer", "=", "tf", ".", "train", ".", "GradientDescentOptimizer", "(", "learning_rate", ")", ".", "minimize", "(", "\n", "loss", ",", "global_step", "=", "global_step", ",", "var_list", "=", "[", "vars_A", ",", "vars_L", ",", "vars_R", "]", ")", "\n", "\n", "", "with", "tf", ".", "control_dependencies", "(", "[", "optimizer", ",", "variable_averages_op", "]", ")", ":", "\n", "        ", "train_op", "=", "tf", ".", "no_op", "(", "name", "=", "'train'", ")", "\n", "", "for", "op", "in", "[", "train_op", ",", "A", "]", ":", "\n", "        ", "tf", ".", "add_to_collection", "(", "'train_ops'", ",", "op", ")", "\n", "", "for", "op", "in", "[", "loss", ",", "accuracy", "]", ":", "\n", "        ", "tf", ".", "add_to_collection", "(", "'validate_ops'", ",", "op", ")", "\n", "", "", "def", "test", "(", "input_size", ",", "train_X", ",", "train_Y", ",", "test_X", ",", "test_Y", ",", "total_batch", ",", "index", ")", ":", "\n"]], "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.model.test": [[90, 153], ["tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.Variable", "utils.BatchCreate", "tensorflow.variable_scope", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.Variable", "tensorflow.train.ExponentialMovingAverage", "tf.train.ExponentialMovingAverage.apply", "tensorflow.nn.relu", "tensorflow.nn.relu", "tensorflow.name_scope", "tensorflow.contrib.layers.l2_regularizer", "tensorflow.train.exponential_decay", "tensorflow.nn.sparse_softmax_cross_entropy_with_logits", "tensorflow.reduce_mean", "tensorflow.equal", "tensorflow.reduce_mean", "tensorflow.name_scope", "tensorflow.get_collection", "tensorflow.get_collection", "tensorflow.train.GradientDescentOptimizer().minimize", "tensorflow.control_dependencies", "tensorflow.no_op", "tensorflow.Session", "tensorflow.global_variables_initializer().run", "range", "sess.run", "tensorflow.truncated_normal", "tensorflow.constant", "tensorflow.truncated_normal", "tensorflow.constant", "tensorflow.trainable_variables", "tensorflow.matmul", "tensorflow.matmul", "tf.train.ExponentialMovingAverage.average", "tf.contrib.layers.l2_regularizer.", "tf.contrib.layers.l2_regularizer.", "tensorflow.argmax", "tensorflow.argmax", "tensorflow.cast", "utils.BatchCreate.next_batch", "sess.run", "tensorflow.matmul", "tensorflow.matmul", "tf.train.ExponentialMovingAverage.average", "tf.train.ExponentialMovingAverage.average", "tensorflow.argmax", "tensorflow.train.GradientDescentOptimizer", "tensorflow.global_variables_initializer", "tf.train.ExponentialMovingAverage.average"], "function", ["home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.utils.BatchCreate.next_batch"], ["", "", "def", "test", "(", "input_size", ",", "train_X", ",", "train_Y", ",", "test_X", ",", "test_Y", ",", "total_batch", ",", "index", ")", ":", "\n", "    ", "X", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "None", ",", "input_size", "]", ")", "\n", "Y", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "None", ",", "FLAGS", ".", "output_size", "]", ")", "\n", "global_step", "=", "tf", ".", "Variable", "(", "0", ",", "trainable", "=", "False", ")", "\n", "\n", "\n", "with", "tf", ".", "variable_scope", "(", "\"test_model_{}\"", ".", "format", "(", "index", ")", ")", "as", "scope", ":", "\n", "        ", "L_W1", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "truncated_normal", "(", "[", "input_size", ",", "FLAGS", ".", "L_node", "]", ",", "stddev", "=", "0.1", ",", "seed", "=", "FLAGS", ".", "set_seed", ")", ")", "\n", "L_b1", "=", "tf", ".", "Variable", "(", "tf", ".", "constant", "(", "0.1", ",", "shape", "=", "[", "FLAGS", ".", "L_node", "]", ")", ")", "\n", "L_W2", "=", "tf", ".", "Variable", "(", "\n", "tf", ".", "truncated_normal", "(", "[", "FLAGS", ".", "L_node", ",", "FLAGS", ".", "output_size", "]", ",", "stddev", "=", "0.1", ",", "seed", "=", "FLAGS", ".", "set_seed", ")", ")", "\n", "L_b2", "=", "tf", ".", "Variable", "(", "tf", ".", "constant", "(", "0.1", ",", "shape", "=", "[", "FLAGS", ".", "output_size", "]", ")", ")", "\n", "\n", "variable_averages", "=", "tf", ".", "train", ".", "ExponentialMovingAverage", "(", "\n", "FLAGS", ".", "moving_average_decay", ",", "global_step", ")", "\n", "variable_averages_op", "=", "variable_averages", ".", "apply", "(", "\n", "tf", ".", "trainable_variables", "(", "scope", "=", "'test_model_{}'", ".", "format", "(", "index", ")", ")", ")", "\n", "L_FC", "=", "tf", ".", "nn", ".", "relu", "(", "tf", ".", "matmul", "(", "X", ",", "L_W1", ")", "+", "L_b1", ")", "\n", "O", "=", "tf", ".", "matmul", "(", "L_FC", ",", "L_W2", ")", "+", "L_b2", "\n", "\n", "average_L_FC", "=", "tf", ".", "nn", ".", "relu", "(", "tf", ".", "matmul", "(", "X", ",", "variable_averages", ".", "average", "(", "L_W1", ")", ")", "+", "variable_averages", ".", "average", "(", "L_b1", ")", ")", "\n", "average_O", "=", "tf", ".", "matmul", "(", "average_L_FC", ",", "variable_averages", ".", "average", "(", "L_W2", ")", ")", "+", "variable_averages", ".", "average", "(", "L_b2", ")", "\n", "\n", "", "with", "tf", ".", "name_scope", "(", "\"test_Loss_{}\"", ".", "format", "(", "index", ")", ")", "as", "scope", ":", "\n", "        ", "regularizer", "=", "tf", ".", "contrib", ".", "layers", ".", "l2_regularizer", "(", "\n", "FLAGS", ".", "regularization_rate", ")", "\n", "regularization", "=", "regularizer", "(", "L_W1", ")", "+", "regularizer", "(", "L_W2", ")", "\n", "\n", "learning_rate", "=", "tf", ".", "train", ".", "exponential_decay", "(", "\n", "FLAGS", ".", "learning_rate_base", ",", "global_step", ",", "total_batch", ",", "\n", "FLAGS", ".", "learning_rate_decay", ")", "\n", "\n", "cross_entropy", "=", "tf", ".", "nn", ".", "sparse_softmax_cross_entropy_with_logits", "(", "\n", "logits", "=", "O", ",", "labels", "=", "tf", ".", "argmax", "(", "Y", ",", "1", ")", ")", "\n", "cross_entropy_mean", "=", "tf", ".", "reduce_mean", "(", "cross_entropy", ")", "\n", "loss", "=", "cross_entropy_mean", "+", "regularization", "\n", "\n", "correct_prediction", "=", "tf", ".", "equal", "(", "tf", ".", "argmax", "(", "average_O", ",", "1", ")", ",", "\n", "tf", ".", "argmax", "(", "Y", ",", "1", ")", ")", "\n", "accuracy", "=", "tf", ".", "reduce_mean", "(", "tf", ".", "cast", "(", "correct_prediction", ",", "tf", ".", "float32", ")", ")", "\n", "", "with", "tf", ".", "name_scope", "(", "\"Train\"", ")", "as", "scope", ":", "\n", "        ", "vars_m", "=", "tf", ".", "get_collection", "(", "tf", ".", "GraphKeys", ".", "TRAINABLE_VARIABLES", ",", "scope", "=", "'test_model_{}'", ".", "format", "(", "index", ")", ")", "\n", "vars_l", "=", "tf", ".", "get_collection", "(", "tf", ".", "GraphKeys", ".", "TRAINABLE_VARIABLES", ",", "scope", "=", "'test_Loss_{}'", ".", "format", "(", "index", ")", ")", "\n", "# Minimizing Loss Function", "\n", "optimizer", "=", "tf", ".", "train", ".", "GradientDescentOptimizer", "(", "learning_rate", ")", ".", "minimize", "(", "\n", "loss", ",", "global_step", "=", "global_step", ",", "var_list", "=", "[", "vars_m", ",", "vars_l", "]", ")", "\n", "\n", "\n", "", "with", "tf", ".", "control_dependencies", "(", "[", "optimizer", ",", "variable_averages_op", "]", ")", ":", "\n", "        ", "train_op", "=", "tf", ".", "no_op", "(", "name", "=", "'train_{}'", ".", "format", "(", "index", ")", ")", "\n", "\n", "", "Iterator", "=", "BatchCreate", "(", "train_X", ",", "train_Y", ")", "\n", "\n", "with", "tf", ".", "Session", "(", ")", "as", "sess", ":", "\n", "        ", "tf", ".", "global_variables_initializer", "(", ")", ".", "run", "(", ")", "\n", "\n", "for", "step", "in", "range", "(", "1", ",", "FLAGS", ".", "train_step", "+", "1", ")", ":", "\n", "            ", "xs", ",", "ys", "=", "Iterator", ".", "next_batch", "(", "FLAGS", ".", "batch_size", ")", "\n", "sess", ".", "run", "(", "train_op", ",", "feed_dict", "=", "{", "X", ":", "xs", ",", "Y", ":", "ys", "}", ")", "\n", "", "accuracy", "=", "sess", ".", "run", "(", "accuracy", ",", "\n", "feed_dict", "=", "{", "X", ":", "test_X", ",", "Y", ":", "test_Y", "}", ")", "\n", "", "return", "accuracy", "\n", "", ""]], "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.utils.BatchCreate.__init__": [[5, 11], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "images", ",", "labels", ")", ":", "\n", "        ", "self", ".", "_images", "=", "images", "\n", "self", ".", "_labels", "=", "labels", "\n", "self", ".", "_epochs_completed", "=", "0", "\n", "self", ".", "_index_in_epoch", "=", "0", "\n", "self", ".", "_num_examples", "=", "images", ".", "shape", "[", "0", "]", "\n", "", "def", "next_batch", "(", "self", ",", "batch_size", ",", "fake_data", "=", "False", ",", "shuffle", "=", "True", ")", ":", "\n"]], "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.utils.BatchCreate.next_batch": [[11, 48], ["numpy.arange", "numpy.random.shuffle", "numpy.arange", "numpy.random.shuffle", "numpy.concatenate", "numpy.concatenate"], "methods", ["None"], ["", "def", "next_batch", "(", "self", ",", "batch_size", ",", "fake_data", "=", "False", ",", "shuffle", "=", "True", ")", ":", "\n", "        ", "start", "=", "self", ".", "_index_in_epoch", "\n", "'''\n        Disruption in the first epoch\n        '''", "\n", "if", "self", ".", "_epochs_completed", "==", "0", "and", "start", "==", "0", "and", "shuffle", ":", "\n", "            ", "perm0", "=", "np", ".", "arange", "(", "self", ".", "_num_examples", ")", "\n", "np", ".", "random", ".", "shuffle", "(", "perm0", ")", "\n", "self", ".", "_images", "=", "self", ".", "_images", "[", "perm0", "]", "\n", "self", ".", "_labels", "=", "self", ".", "_labels", "[", "perm0", "]", "\n", "", "if", "start", "+", "batch_size", ">", "self", ".", "_num_examples", ":", "\n", "#finished epoch", "\n", "            ", "self", ".", "_epochs_completed", "+=", "1", "\n", "'''\n            When the remaining sample number of an epoch is less than batch size,\n            the difference between them is calculated.\n            '''", "\n", "rest_num_examples", "=", "self", ".", "_num_examples", "-", "start", "\n", "images_rest_part", "=", "self", ".", "_images", "[", "start", ":", "self", ".", "_num_examples", "]", "\n", "labels_rest_part", "=", "self", ".", "_labels", "[", "start", ":", "self", ".", "_num_examples", "]", "\n", "'''Disrupt the data'''", "\n", "if", "shuffle", ":", "\n", "                ", "perm", "=", "np", ".", "arange", "(", "self", ".", "_num_examples", ")", "\n", "np", ".", "random", ".", "shuffle", "(", "perm", ")", "\n", "self", ".", "_images", "=", "self", ".", "_images", "[", "perm", "]", "\n", "self", ".", "_labels", "=", "self", ".", "_labels", "[", "perm", "]", "\n", "", "'''next epoch'''", "\n", "start", "=", "0", "\n", "self", ".", "_index_in_epoch", "=", "batch_size", "-", "rest_num_examples", "\n", "end", "=", "self", ".", "_index_in_epoch", "\n", "images_new_part", "=", "self", ".", "_images", "[", "start", ":", "end", "]", "\n", "labels_new_part", "=", "self", ".", "_labels", "[", "start", ":", "end", "]", "\n", "return", "np", ".", "concatenate", "(", "(", "images_rest_part", ",", "images_new_part", ")", ",", "axis", "=", "0", ")", ",", "np", ".", "concatenate", "(", "(", "labels_rest_part", ",", "labels_new_part", ")", ",", "axis", "=", "0", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "_index_in_epoch", "+=", "batch_size", "\n", "end", "=", "self", ".", "_index_in_epoch", "\n", "return", "self", ".", "_images", "[", "start", ":", "end", "]", ",", "self", ".", "_labels", "[", "start", ":", "end", "]", "\n", "", "", "", "def", "show_result", "(", "ac_score_list", ",", "dataset_name", ")", ":", "\n"]], "home.repos.pwc.inspect_result.upup123_AAAI-2019-AFS.None.utils.show_result": [[48, 75], ["matplotlib.subplot", "plt.subplot.plot", "matplotlib.title", "matplotlib.ylabel", "matplotlib.xlabel", "matplotlib.ylim", "matplotlib.ticker.FixedLocator", "matplotlib.ticker.MultipleLocator", "plt.subplot.xaxis.set_major_locator", "plt.subplot.xaxis.set_minor_locator", "plt.subplot.xaxis.grid", "matplotlib.ticker.MultipleLocator", "plt.subplot.yaxis.set_major_locator", "plt.subplot.yaxis.grid", "plt.subplot.get_position", "plt.subplot.set_position", "matplotlib.show", "numpy.arange", "int"], "function", ["None"], ["", "", "", "def", "show_result", "(", "ac_score_list", ",", "dataset_name", ")", ":", "\n", "    ", "plot_spc", "=", "[", "5", ",", "10", "]", "\n", "left_spc", "=", "1", "\n", "len_params", "=", "295", "\n", "\n", "use_arr", "=", "ac_score_list", "[", "left_spc", ":", "int", "(", "(", "len_params", "-", "plot_spc", "[", "0", "]", ")", "/", "plot_spc", "[", "1", "]", ")", "]", "\n", "ax", "=", "plt", ".", "subplot", "(", ")", "\n", "ax", ".", "plot", "(", "np", ".", "arange", "(", "plot_spc", "[", "0", "]", "+", "plot_spc", "[", "1", "]", "*", "left_spc", ",", "len_params", ",", "plot_spc", "[", "1", "]", ")", ",", "use_arr", ",", "'-o'", ",", "\n", "label", "=", "'AFS'", ")", "\n", "plt", ".", "title", "(", "dataset_name", ")", "\n", "plt", ".", "ylabel", "(", "'Accuracy'", ")", "\n", "plt", ".", "xlabel", "(", "'K'", ")", "\n", "plt", ".", "ylim", "(", "0.0", ",", "1.0", ")", "\n", "xmajorLocator", "=", "FixedLocator", "(", "[", "15", ",", "85", ",", "155", ",", "225", ",", "295", "]", ")", "\n", "xminorLocator", "=", "MultipleLocator", "(", "5", ")", "\n", "ax", ".", "xaxis", ".", "set_major_locator", "(", "xmajorLocator", ")", "\n", "ax", ".", "xaxis", ".", "set_minor_locator", "(", "xminorLocator", ")", "\n", "ax", ".", "xaxis", ".", "grid", "(", "True", ",", "which", "=", "'minor'", ")", "\n", "\n", "ymajorLocator", "=", "MultipleLocator", "(", "0.1", ")", "\n", "ax", ".", "yaxis", ".", "set_major_locator", "(", "ymajorLocator", ")", "\n", "ax", ".", "yaxis", ".", "grid", "(", "True", ",", "which", "=", "'major'", ")", "\n", "\n", "box", "=", "ax", ".", "get_position", "(", ")", "\n", "ax", ".", "set_position", "(", "[", "box", ".", "x0", ",", "box", ".", "y0", ",", "box", ".", "width", ",", "box", ".", "height", "*", "0.8", "]", ")", "\n", "\n", "plt", ".", "show", "(", ")", "", "", ""]]}