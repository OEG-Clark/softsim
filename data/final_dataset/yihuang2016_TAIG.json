{"home.repos.pwc.inspect_result.yihuang2016_TAIG.None.TAIG.SelectedImagenet.__init__": [[30, 36], ["torch.utils.data.Dataset.__init__", "TAIG.SelectedImagenet._load_csv"], "methods", ["home.repos.pwc.inspect_result.yihuang2016_TAIG.None.TAIG.SelectedImagenet.__init__", "home.repos.pwc.inspect_result.yihuang2016_TAIG.None.TAIG.SelectedImagenet._load_csv"], ["    ", "def", "__init__", "(", "self", ",", "imagenet_val_dir", ",", "selected_images_csv", ",", "transform", "=", "None", ")", ":", "\n", "        ", "super", "(", "SelectedImagenet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "imagenet_val_dir", "=", "imagenet_val_dir", "\n", "self", ".", "selected_images_csv", "=", "selected_images_csv", "\n", "self", ".", "transform", "=", "transform", "\n", "self", ".", "_load_csv", "(", ")", "\n", "", "def", "_load_csv", "(", "self", ")", ":", "\n"]], "home.repos.pwc.inspect_result.yihuang2016_TAIG.None.TAIG.SelectedImagenet._load_csv": [[36, 40], ["csv.reader", "next", "list", "open"], "methods", ["None"], ["", "def", "_load_csv", "(", "self", ")", ":", "\n", "        ", "reader", "=", "csv", ".", "reader", "(", "open", "(", "self", ".", "selected_images_csv", ",", "'r'", ")", ")", "\n", "next", "(", "reader", ")", "\n", "self", ".", "selected_list", "=", "list", "(", "reader", ")", "\n", "", "def", "__getitem__", "(", "self", ",", "item", ")", ":", "\n"]], "home.repos.pwc.inspect_result.yihuang2016_TAIG.None.TAIG.SelectedImagenet.__getitem__": [[40, 48], ["PIL.open", "os.path.join", "TAIG.SelectedImagenet.convert", "TAIG.SelectedImagenet.transform", "int"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "item", ")", ":", "\n", "        ", "target", ",", "target_name", ",", "image_name", "=", "self", ".", "selected_list", "[", "item", "]", "\n", "image", "=", "Image", ".", "open", "(", "os", ".", "path", ".", "join", "(", "self", ".", "imagenet_val_dir", ",", "image_name", ")", ")", "\n", "if", "image", ".", "mode", "!=", "'RGB'", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'RGB'", ")", "\n", "", "if", "self", ".", "transform", "is", "not", "None", ":", "\n", "            ", "image", "=", "self", ".", "transform", "(", "image", ")", "\n", "", "return", "image", ",", "int", "(", "target", ")", "\n", "", "def", "__len__", "(", "self", ")", ":", "\n"]], "home.repos.pwc.inspect_result.yihuang2016_TAIG.None.TAIG.SelectedImagenet.__len__": [[48, 50], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "selected_list", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.yihuang2016_TAIG.None.TAIG.compute_ig": [[53, 75], ["numpy.zeros", "numpy.asarray", "torch.from_numpy", "torch.from_numpy", "scaled_inputs.to.to", "scaled_inputs.to.requires_grad_", "model", "model.zero_grad", "loss.backward", "torch.mean", "torch.mean", "integrated_grad.cpu().detach().numpy", "torch.mean", "torch.mean", "range", "numpy.random.uniform", "integrated_grad.cpu().detach", "float", "integrated_grad.cpu"], "function", ["None"], ["", "", "def", "compute_ig", "(", "inputs", ",", "label_inputs", ",", "model", ")", ":", "\n", "    ", "baseline", "=", "np", ".", "zeros", "(", "inputs", ".", "shape", ")", "\n", "scaled_inputs", "=", "[", "baseline", "+", "(", "float", "(", "i", ")", "/", "steps", ")", "*", "(", "inputs", "-", "baseline", ")", "for", "i", "in", "\n", "range", "(", "0", ",", "steps", "+", "1", ")", "]", "\n", "scaled_inputs", "=", "np", ".", "asarray", "(", "scaled_inputs", ")", "\n", "if", "r_flag", "==", "True", ":", "\n", "        ", "scaled_inputs", "=", "scaled_inputs", "+", "np", ".", "random", ".", "uniform", "(", "-", "epsilon", ",", "epsilon", ",", "scaled_inputs", ".", "shape", ")", "\n", "", "scaled_inputs", "=", "torch", ".", "from_numpy", "(", "scaled_inputs", ")", "\n", "scaled_inputs", "=", "scaled_inputs", ".", "to", "(", "device", ",", "dtype", "=", "torch", ".", "float", ")", "\n", "scaled_inputs", ".", "requires_grad_", "(", "True", ")", "\n", "att_out", "=", "model", "(", "scaled_inputs", ")", "\n", "score", "=", "att_out", "[", ":", ",", "label_inputs", "]", "\n", "loss", "=", "-", "torch", ".", "mean", "(", "score", ")", "\n", "model", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "grads", "=", "scaled_inputs", ".", "grad", ".", "data", "\n", "avg_grads", "=", "torch", ".", "mean", "(", "grads", ",", "dim", "=", "0", ")", "\n", "delta_X", "=", "scaled_inputs", "[", "-", "1", "]", "-", "scaled_inputs", "[", "0", "]", "\n", "integrated_grad", "=", "delta_X", "*", "avg_grads", "\n", "IG", "=", "integrated_grad", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", "\n", "del", "integrated_grad", ",", "delta_X", ",", "avg_grads", ",", "grads", ",", "loss", ",", "score", ",", "att_out", "\n", "return", "IG", "\n", "\n"]]}