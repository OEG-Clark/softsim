{"home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLoss.__init__": [[14, 33], ["torch.Module.__init__", "numpy.array", "numpy.array", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.from_numpy().float().expand", "torch.from_numpy().float().expand", "torch.from_numpy().float().expand", "torch.from_numpy().float().expand", "torch.from_numpy().float().expand", "torch.from_numpy().float().expand", "torch.from_numpy().float().expand", "torch.from_numpy().float().expand", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__"], ["def", "__init__", "(", "self", ",", "miu", "=", "1.0", ",", "classes", "=", "3", ")", ":", "\n", "        ", "super", "(", "ACLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "miu", "=", "miu", "\n", "self", ".", "classes", "=", "classes", "\n", "sobel_x", "=", "np", ".", "array", "(", "[", "[", "-", "1", ",", "0", ",", "1", "]", ",", "[", "-", "2", ",", "0", ",", "2", "]", ",", "[", "-", "1", ",", "0", ",", "1", "]", "]", ")", "\n", "sobel_y", "=", "np", ".", "array", "(", "[", "[", "-", "1", ",", "-", "2", ",", "-", "1", "]", ",", "[", "0", ",", "0", ",", "0", "]", ",", "[", "1", ",", "2", ",", "1", "]", "]", ")", "\n", "\n", "self", ".", "sobel_x", "=", "nn", ".", "Parameter", "(", "torch", ".", "from_numpy", "(", "sobel_x", ")", ".", "float", "(", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ")", ",", "\n", "requires_grad", "=", "False", ")", "\n", "self", ".", "sobel_y", "=", "nn", ".", "Parameter", "(", "torch", ".", "from_numpy", "(", "sobel_y", ")", ".", "float", "(", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ")", ",", "\n", "requires_grad", "=", "False", ")", "\n", "\n", "self", ".", "diff_x", "=", "nn", ".", "Conv2d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_x", ".", "weight", "=", "self", ".", "sobel_x", "\n", "self", ".", "diff_y", "=", "nn", ".", "Conv2d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_y", ".", "weight", "=", "self", ".", "sobel_y", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLoss.forward": [[34, 54], ["aceloss.ACLoss.diff_x", "aceloss.ACLoss.diff_y", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "label.float.float.float", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sum.min", "torch.sum.min", "torch.sum.max", "torch.sum.max", "torch.sum.min", "torch.sum.min"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "predication", ",", "label", ")", ":", "\n", "        ", "grd_x", "=", "self", ".", "diff_x", "(", "predication", ")", "\n", "grd_y", "=", "self", ".", "diff_y", "(", "predication", ")", "\n", "\n", "# length", "\n", "length", "=", "torch", ".", "sum", "(", "\n", "torch", ".", "abs", "(", "torch", ".", "sqrt", "(", "grd_x", "**", "2", "+", "grd_y", "**", "2", "+", "1e-8", ")", ")", ")", "\n", "length", "=", "(", "length", "-", "length", ".", "min", "(", ")", ")", "/", "(", "length", ".", "max", "(", ")", "-", "length", ".", "min", "(", ")", "+", "1e-8", ")", "\n", "length", "=", "torch", ".", "sum", "(", "length", ")", "\n", "\n", "# region", "\n", "label", "=", "label", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "predication", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "predication", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "predication", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "predication", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "self", ".", "miu", "*", "region_in", "+", "region_out", "\n", "\n", "return", "region", "+", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLossV2.__init__": [[62, 67], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__"], ["def", "__init__", "(", "self", ",", "miu", "=", "1.0", ",", "classes", "=", "3", ")", ":", "\n", "        ", "super", "(", "ACLossV2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "miu", "=", "miu", "\n", "self", ".", "classes", "=", "classes", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLossV2.forward": [[68, 87], ["torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "label.float.float.float", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.functional.max_pool2d", "torch.functional.max_pool2d", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.functional.max_pool2d", "torch.functional.max_pool2d"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "predication", ",", "label", ")", ":", "\n", "        ", "min_pool_x", "=", "nn", ".", "functional", ".", "max_pool2d", "(", "\n", "predication", "*", "-", "1", ",", "(", "3", ",", "3", ")", ",", "1", ",", "1", ")", "*", "-", "1", "\n", "contour", "=", "torch", ".", "relu", "(", "nn", ".", "functional", ".", "max_pool2d", "(", "\n", "min_pool_x", ",", "(", "3", ",", "3", ")", ",", "1", ",", "1", ")", "-", "min_pool_x", ")", "\n", "\n", "# length", "\n", "length", "=", "torch", ".", "sum", "(", "torch", ".", "abs", "(", "contour", ")", ")", "\n", "\n", "# region", "\n", "label", "=", "label", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "predication", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "predication", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "predication", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "predication", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "self", ".", "miu", "*", "region_in", "+", "region_out", "\n", "\n", "return", "region", "+", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLoss3D.__init__": [[173, 208], ["torch.Module.__init__", "numpy.array", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "numpy.array.transpose", "numpy.array.transpose", "numpy.array.transpose"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__"], ["def", "__init__", "(", "self", ",", "classes", "=", "4", ",", "alpha", "=", "1", ")", ":", "\n", "        ", "super", "(", "ACLoss3D", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "alpha", "=", "alpha", "\n", "self", ".", "classes", "=", "classes", "\n", "sobel", "=", "np", ".", "array", "(", "[", "[", "[", "1.", ",", "2.", ",", "1.", "]", ",", "\n", "[", "2.", ",", "4.", ",", "2.", "]", ",", "\n", "[", "1.", ",", "2.", ",", "1.", "]", "]", ",", "\n", "\n", "[", "[", "0.", ",", "0.", ",", "0.", "]", ",", "\n", "[", "0.", ",", "0.", ",", "0.", "]", ",", "\n", "[", "0.", ",", "0.", ",", "0.", "]", "]", ",", "\n", "\n", "[", "[", "-", "1.", ",", "-", "2.", ",", "-", "1.", "]", ",", "\n", "[", "-", "2.", ",", "-", "4.", ",", "-", "2.", "]", ",", "\n", "[", "-", "1.", ",", "-", "2.", ",", "-", "1.", "]", "]", "]", ")", "\n", "\n", "self", ".", "sobel_x", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "sobel", ".", "transpose", "(", "0", ",", "1", ",", "2", ")", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "\n", "3", ")", ",", "requires_grad", "=", "False", ")", "\n", "self", ".", "sobel_y", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "sobel", ".", "transpose", "(", "1", ",", "0", ",", "2", ")", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "\n", "3", ")", ",", "requires_grad", "=", "False", ")", "\n", "self", ".", "sobel_z", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "sobel", ".", "transpose", "(", "1", ",", "2", ",", "0", ")", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "\n", "3", ")", ",", "requires_grad", "=", "False", ")", "\n", "\n", "self", ".", "diff_x", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_x", ".", "weight", "=", "self", ".", "sobel_x", "\n", "self", ".", "diff_y", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_y", ".", "weight", "=", "self", ".", "sobel_y", "\n", "self", ".", "diff_z", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_z", ".", "weight", "=", "self", ".", "sobel_z", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLoss3D.forward": [[209, 229], ["aceloss.ACLoss3D.diff_x", "aceloss.ACLoss3D.diff_y", "aceloss.ACLoss3D.diff_z", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "label.float.float.float", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum.min", "torch.sum.min", "torch.sum.max", "torch.sum.max", "torch.sum.min", "torch.sum.min"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "predication", ",", "label", ")", ":", "\n", "        ", "grd_x", "=", "self", ".", "diff_x", "(", "predication", ")", "\n", "grd_y", "=", "self", ".", "diff_y", "(", "predication", ")", "\n", "grd_z", "=", "self", ".", "diff_z", "(", "predication", ")", "\n", "\n", "# length", "\n", "length", "=", "torch", ".", "sqrt", "(", "grd_x", "**", "2", "+", "grd_y", "**", "2", "+", "grd_z", "**", "2", "+", "1e-8", ")", "\n", "length", "=", "(", "length", "-", "length", ".", "min", "(", ")", ")", "/", "(", "length", ".", "max", "(", ")", "-", "length", ".", "min", "(", ")", "+", "1e-8", ")", "\n", "length", "=", "torch", ".", "sum", "(", "length", ")", "\n", "\n", "# region", "\n", "label", "=", "label", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "predication", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "predication", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "predication", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "predication", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "region_in", "+", "region_out", "\n", "\n", "return", "self", ".", "alpha", "*", "region", "+", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLoss3DV2.__init__": [[237, 242], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__"], ["def", "__init__", "(", "self", ",", "miu", "=", "1.0", ",", "classes", "=", "3", ")", ":", "\n", "        ", "super", "(", "ACLoss3DV2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "miu", "=", "miu", "\n", "self", ".", "classes", "=", "classes", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACLoss3DV2.forward": [[243, 262], ["torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "label.float.float.float", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.functional.max_pool3d", "torch.functional.max_pool3d", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.functional.max_pool3d", "torch.functional.max_pool3d"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "predication", ",", "label", ")", ":", "\n", "        ", "min_pool_x", "=", "nn", ".", "functional", ".", "max_pool3d", "(", "\n", "predication", "*", "-", "1", ",", "(", "3", ",", "3", ",", "3", ")", ",", "1", ",", "1", ")", "*", "-", "1", "\n", "contour", "=", "torch", ".", "relu", "(", "nn", ".", "functional", ".", "max_pool3d", "(", "\n", "min_pool_x", ",", "(", "3", ",", "3", ",", "3", ")", ",", "1", ",", "1", ")", "-", "min_pool_x", ")", "\n", "\n", "# length", "\n", "length", "=", "torch", ".", "sum", "(", "torch", ".", "abs", "(", "contour", ")", ")", "\n", "\n", "# region", "\n", "label", "=", "label", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "predication", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "predication", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "predication", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "predication", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "self", ".", "miu", "*", "region_in", "+", "region_out", "\n", "\n", "return", "region", "+", "length", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.__init__": [[270, 275], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__"], ["def", "__init__", "(", "self", ",", "alpha", "=", "1e-3", ",", "beta", "=", "1.0", ",", "miu", "=", "1", ",", "classes", "=", "3", ")", ":", "\n", "        ", "super", "(", "ACELoss3D", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "alpha", "=", "alpha", "\n", "self", ".", "beta", "=", "beta", "\n", "self", ".", "miu", "=", "miu", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.first_derivative": [[276, 298], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "first_derivative", "(", "self", ",", "input", ")", ":", "\n", "        ", "u", "=", "input", "\n", "m", "=", "u", ".", "shape", "[", "2", "]", "\n", "n", "=", "u", ".", "shape", "[", "3", "]", "\n", "k", "=", "u", ".", "shape", "[", "4", "]", "\n", "\n", "ci_0", "=", "(", "u", "[", ":", ",", ":", ",", "1", ",", ":", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", "0", ",", ":", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "ci_1", "=", "u", "[", ":", ",", ":", ",", "2", ":", ",", ":", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", "0", ":", "m", "-", "2", ",", ":", ",", ":", "]", "\n", "ci_2", "=", "(", "u", "[", ":", ",", ":", ",", "-", "1", ",", ":", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", "m", "-", "2", ",", ":", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "ci", "=", "torch", ".", "cat", "(", "[", "ci_0", ",", "ci_1", ",", "ci_2", "]", ",", "2", ")", "/", "2", "\n", "\n", "cj_0", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "1", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", "0", ",", ":", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "cj_1", "=", "u", "[", ":", ",", ":", ",", ":", ",", "2", ":", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", "0", ":", "n", "-", "2", ",", ":", "]", "\n", "cj_2", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "-", "1", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", "n", "-", "2", ",", ":", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "cj", "=", "torch", ".", "cat", "(", "[", "cj_0", ",", "cj_1", ",", "cj_2", "]", ",", "3", ")", "/", "2", "\n", "\n", "ck_0", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "1", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", "]", ")", ".", "unsqueeze", "(", "4", ")", "\n", "ck_1", "=", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "2", ":", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", ":", "k", "-", "2", "]", "\n", "ck_2", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "-", "1", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "k", "-", "2", "]", ")", ".", "unsqueeze", "(", "4", ")", "\n", "ck", "=", "torch", ".", "cat", "(", "[", "ck_0", ",", "ck_1", ",", "ck_2", "]", ",", "4", ")", "/", "2", "\n", "\n", "return", "ci", ",", "cj", ",", "ck", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.second_derivative": [[299, 359], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "ci[].unsqueeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "ci[].unsqueeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "ci[].unsqueeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "ci[].unsqueeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "cj[].unsqueeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "cj[].unsqueeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "second_derivative", "(", "self", ",", "input", ",", "ci", ",", "cj", ",", "ck", ")", ":", "\n", "        ", "u", "=", "input", "\n", "m", "=", "u", ".", "shape", "[", "2", "]", "\n", "n", "=", "u", ".", "shape", "[", "3", "]", "\n", "k", "=", "u", ".", "shape", "[", "4", "]", "\n", "\n", "cii_0", "=", "(", "u", "[", ":", ",", ":", ",", "1", ",", ":", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", "0", ",", ":", ",", ":", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", "0", ",", ":", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "cii_1", "=", "u", "[", ":", ",", ":", ",", "2", ":", ",", ":", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", ":", "-", "2", ",", ":", ",", ":", "]", "-", "2", "*", "u", "[", ":", ",", ":", ",", "1", ":", "-", "1", ",", ":", ",", ":", "]", "\n", "cii_2", "=", "(", "u", "[", ":", ",", ":", ",", "-", "1", ",", ":", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", "-", "2", ",", ":", ",", ":", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", "-", "1", ",", ":", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "cii", "=", "torch", ".", "cat", "(", "[", "cii_0", ",", "cii_1", ",", "cii_2", "]", ",", "2", ")", "\n", "\n", "cjj_0", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "1", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", "0", ",", ":", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", "0", ",", ":", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "cjj_1", "=", "u", "[", ":", ",", ":", ",", ":", ",", "2", ":", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", ":", "-", "2", ",", ":", "]", "-", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", "1", ":", "-", "1", ",", ":", "]", "\n", "cjj_2", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "-", "1", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", "-", "2", ",", ":", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", "-", "1", ",", ":", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "\n", "cjj", "=", "torch", ".", "cat", "(", "[", "cjj_0", ",", "cjj_1", ",", "cjj_2", "]", ",", "3", ")", "\n", "\n", "ckk_0", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "1", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", "]", ")", ".", "unsqueeze", "(", "4", ")", "\n", "ckk_1", "=", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "2", ":", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", ":", "-", "2", "]", "-", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "1", ":", "-", "1", "]", "\n", "ckk_2", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "-", "1", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "-", "2", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", ":", ",", "-", "1", "]", ")", ".", "unsqueeze", "(", "4", ")", "\n", "\n", "ckk", "=", "torch", ".", "cat", "(", "[", "ckk_0", ",", "ckk_1", ",", "ckk_2", "]", ",", "4", ")", "\n", "\n", "cij_0", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "1", ":", "n", ",", ":", "]", "\n", "cij_1", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "-", "1", ",", ":", "]", ".", "unsqueeze", "(", "3", ")", "\n", "\n", "cij_a", "=", "torch", ".", "cat", "(", "[", "cij_0", ",", "cij_1", "]", ",", "3", ")", "\n", "cij_2", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "0", ",", ":", "]", ".", "unsqueeze", "(", "3", ")", "\n", "cij_3", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "0", ":", "n", "-", "1", ",", ":", "]", "\n", "cij_b", "=", "torch", ".", "cat", "(", "[", "cij_2", ",", "cij_3", "]", ",", "3", ")", "\n", "cij", "=", "cij_a", "-", "cij_b", "\n", "\n", "cik_0", "=", "ci", "[", ":", ",", ":", ",", ":", ",", ":", ",", "1", ":", "n", "]", "\n", "cik_1", "=", "ci", "[", ":", ",", ":", ",", ":", ",", ":", ",", "-", "1", "]", ".", "unsqueeze", "(", "4", ")", "\n", "\n", "cik_a", "=", "torch", ".", "cat", "(", "[", "cik_0", ",", "cik_1", "]", ",", "4", ")", "\n", "cik_2", "=", "ci", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", "]", ".", "unsqueeze", "(", "4", ")", "\n", "cik_3", "=", "ci", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", ":", "k", "-", "1", "]", "\n", "cik_b", "=", "torch", ".", "cat", "(", "[", "cik_2", ",", "cik_3", "]", ",", "4", ")", "\n", "cik", "=", "cik_a", "-", "cik_b", "\n", "\n", "cjk_0", "=", "cj", "[", ":", ",", ":", ",", ":", ",", ":", ",", "1", ":", "n", "]", "\n", "cjk_1", "=", "cj", "[", ":", ",", ":", ",", ":", ",", ":", ",", "-", "1", "]", ".", "unsqueeze", "(", "4", ")", "\n", "\n", "cjk_a", "=", "torch", ".", "cat", "(", "[", "cjk_0", ",", "cjk_1", "]", ",", "4", ")", "\n", "cjk_2", "=", "cj", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", "]", ".", "unsqueeze", "(", "4", ")", "\n", "cjk_3", "=", "cj", "[", ":", ",", ":", ",", ":", ",", ":", ",", "0", ":", "k", "-", "1", "]", "\n", "cjk_b", "=", "torch", ".", "cat", "(", "[", "cjk_2", ",", "cjk_3", "]", ",", "4", ")", "\n", "cjk", "=", "cjk_a", "-", "cjk_b", "\n", "\n", "return", "cii", ",", "cjj", ",", "ckk", ",", "cij", ",", "cik", ",", "cjk", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.region": [[360, 369], ["y_true.float", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["None"], ["", "def", "region", "(", "self", ",", "y_pred", ",", "y_true", ",", "u", "=", "1", ")", ":", "\n", "        ", "label", "=", "y_true", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "y_pred", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "y_pred", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "y_pred", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "y_pred", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "u", "*", "region_in", "+", "region_out", "\n", "return", "region", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.elastica": [[370, 382], ["aceloss.ACELoss3D.first_derivative", "aceloss.ACELoss3D.second_derivative", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.first_derivative", "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.second_derivative"], ["", "def", "elastica", "(", "self", ",", "input", ",", "a", "=", "1", ",", "b", "=", "1", ")", ":", "\n", "        ", "ci", ",", "cj", ",", "ck", "=", "self", ".", "first_derivative", "(", "input", ")", "\n", "cii", ",", "cjj", ",", "ckk", ",", "cij", ",", "cik", ",", "cjk", "=", "self", ".", "second_derivative", "(", "\n", "input", ",", "ci", ",", "cj", ",", "ck", ")", "\n", "beta", "=", "1e-8", "\n", "length", "=", "torch", ".", "sqrt", "(", "beta", "+", "ci", "**", "2", "+", "cj", "**", "2", "+", "ck", "**", "2", ")", "\n", "curvature", "=", "(", "1", "+", "ci", "**", "2", "+", "cj", "**", "2", ")", "*", "ckk", "+", "(", "1", "+", "cj", "**", "2", "+", "ck", "**", "2", ")", "*", "cii", "+", "(", "\n", "1", "+", "ci", "**", "2", "+", "ck", "**", "2", ")", "*", "cjj", "-", "2", "*", "cik", "*", "cjk", "*", "cij", "\n", "curvature", "=", "torch", ".", "abs", "(", "curvature", ")", "/", "(", "(", "1", "+", "ci", "**", "2", "+", "cj", "**", "2", "+", "ck", "**", "2", ")", "**", "0.5", "+", "beta", ")", "\n", "elastica", "=", "torch", ".", "sum", "(", "a", "+", "b", "*", "(", "curvature", "**", "2", ")", "*", "torch", ".", "abs", "(", "length", ")", ")", "\n", "return", "elastica", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.forward": [[383, 387], ["aceloss.ACELoss3D.region", "aceloss.ACELoss3D.elastica"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.region", "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.elastica"], ["", "def", "forward", "(", "self", ",", "y_pred", ",", "y_true", ")", ":", "\n", "        ", "loss", "=", "self", ".", "region", "(", "y_pred", ",", "y_true", ",", "u", "=", "self", ".", "miu", ")", "+", "self", ".", "elastica", "(", "y_pred", ",", "a", "=", "self", ".", "alpha", ",", "b", "=", "self", ".", "beta", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3D.__init__": [[395, 444], ["torch.Module.__init__", "numpy.array", "numpy.ones", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "numpy.array.transpose", "numpy.array.transpose", "numpy.array.transpose"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__"], ["def", "__init__", "(", "self", ",", "miu", "=", "1", ",", "alpha", "=", "1e-3", ",", "beta", "=", "2.0", ",", "classes", "=", "4", ",", "types", "=", "\"laplace\"", ")", ":", "\n", "        ", "super", "(", "FastACELoss3D", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "miu", "=", "miu", "\n", "self", ".", "alpha", "=", "alpha", "\n", "self", ".", "beta", "=", "beta", "\n", "self", ".", "classes", "=", "classes", "\n", "self", ".", "types", "=", "types", "\n", "sobel", "=", "np", ".", "array", "(", "[", "[", "[", "1.", ",", "2.", ",", "1.", "]", ",", "\n", "[", "2.", ",", "4.", ",", "2.", "]", ",", "\n", "[", "1.", ",", "2.", ",", "1.", "]", "]", ",", "\n", "\n", "[", "[", "0.", ",", "0.", ",", "0.", "]", ",", "\n", "[", "0.", ",", "0.", ",", "0.", "]", ",", "\n", "[", "0.", ",", "0.", ",", "0.", "]", "]", ",", "\n", "\n", "[", "[", "-", "1.", ",", "-", "2.", ",", "-", "1.", "]", ",", "\n", "[", "-", "2.", ",", "-", "4.", ",", "-", "2.", "]", ",", "\n", "[", "-", "1.", ",", "-", "2.", ",", "-", "1.", "]", "]", "]", ")", "\n", "laplace_kernel", "=", "np", ".", "ones", "(", "(", "3", ",", "3", ",", "3", ")", ")", "\n", "laplace_kernel", "[", "1", ",", "1", ",", "1", "]", "=", "-", "26", "\n", "\n", "self", ".", "sobel_x", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "sobel", ".", "transpose", "(", "0", ",", "1", ",", "2", ")", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "\n", "3", ")", ",", "requires_grad", "=", "False", ")", "\n", "self", ".", "sobel_y", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "sobel", ".", "transpose", "(", "1", ",", "0", ",", "2", ")", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "\n", "3", ")", ",", "requires_grad", "=", "False", ")", "\n", "self", ".", "sobel_z", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "sobel", ".", "transpose", "(", "1", ",", "2", ",", "0", ")", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "\n", "3", ")", ",", "requires_grad", "=", "False", ")", "\n", "self", ".", "laplace", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "laplace_kernel", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "\n", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "3", ")", ",", "\n", "requires_grad", "=", "False", ")", "\n", "\n", "self", ".", "diff_x", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_x", ".", "weight", "=", "self", ".", "sobel_x", "\n", "self", ".", "diff_y", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_y", ".", "weight", "=", "self", ".", "sobel_y", "\n", "self", ".", "diff_z", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "diff_z", ".", "weight", "=", "self", ".", "sobel_z", "\n", "\n", "self", ".", "laplace_operator", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "laplace_operator", ".", "weight", "=", "self", ".", "laplace", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3D.forward": [[445, 480], ["aceloss.FastACELoss3D.diff_x", "aceloss.FastACELoss3D.diff_y", "aceloss.FastACELoss3D.diff_z", "aceloss.FastACELoss3D.laplace_operator", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "label.float.float.float", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sqrt.min", "torch.sqrt.min", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sqrt.max", "torch.sqrt.max", "torch.sqrt.min", "torch.sqrt.min", "torch.abs.min", "torch.abs.min", "torch.abs.min", "torch.abs.min", "torch.abs.max", "torch.abs.max", "torch.abs.min", "torch.abs.min", "torch.abs.max", "torch.abs.max", "torch.abs.min", "torch.abs.min"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "predication", ",", "label", ")", ":", "\n", "        ", "grd_x", "=", "self", ".", "diff_x", "(", "predication", ")", "\n", "grd_y", "=", "self", ".", "diff_y", "(", "predication", ")", "\n", "grd_z", "=", "self", ".", "diff_z", "(", "predication", ")", "\n", "diff", "=", "self", ".", "laplace_operator", "(", "predication", ")", "\n", "\n", "# length", "\n", "length", "=", "torch", ".", "sqrt", "(", "grd_x", "**", "2", "+", "grd_y", "**", "2", "+", "grd_z", "**", "2", "+", "1e-8", ")", "\n", "length", "=", "(", "length", "-", "length", ".", "min", "(", ")", ")", "/", "(", "length", ".", "max", "(", ")", "-", "length", ".", "min", "(", ")", "+", "1e-8", ")", "\n", "\n", "# curvature", "\n", "if", "self", ".", "types", ":", "\n", "            ", "curvature", "=", "torch", ".", "abs", "(", "diff", ")", "\n", "curvature", "=", "(", "curvature", "-", "curvature", ".", "min", "(", ")", ")", "/", "(", "curvature", ".", "max", "(", ")", "-", "curvature", ".", "min", "(", ")", "+", "1e-8", ")", "\n", "", "else", ":", "\n", "            ", "\"\"\"\n            maybe more powerful\n            \"\"\"", "\n", "curvature", "=", "torch", ".", "abs", "(", "\n", "diff", ")", "/", "(", "(", "grd_x", "**", "2", "+", "grd_y", "**", "2", "+", "grd_z", "**", "2", "+", "1", ")", "**", "0.5", "+", "1e-8", ")", "\n", "curvature", "=", "(", "curvature", "-", "curvature", ".", "min", "(", ")", ")", "/", "(", "curvature", ".", "max", "(", ")", "-", "curvature", ".", "min", "(", ")", "+", "1e-8", ")", "\n", "# region", "\n", "", "label", "=", "label", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "predication", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "predication", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "predication", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "predication", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "self", ".", "miu", "*", "region_in", "+", "region_out", "\n", "\n", "# elastic", "\n", "elastic", "=", "torch", ".", "sum", "(", "(", "self", ".", "alpha", "+", "self", ".", "beta", "*", "curvature", "**", "2", ")", "*", "length", ")", "\n", "return", "region", "+", "elastic", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__": [[488, 507], ["torch.Module.__init__", "numpy.ones", "torch.Parameter", "torch.Parameter", "torch.Conv3d", "torch.Conv3d", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze().expand", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float().unsqueeze", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.__init__"], ["def", "__init__", "(", "self", ",", "miu", "=", "1", ",", "alpha", "=", "1e-3", ",", "beta", "=", "2.0", ",", "classes", "=", "4", ",", "types", "=", "\"other\"", ")", ":", "\n", "        ", "super", "(", "FastACELoss3DV2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "miu", "=", "miu", "\n", "self", ".", "alpha", "=", "alpha", "\n", "self", ".", "beta", "=", "beta", "\n", "self", ".", "classes", "=", "classes", "\n", "self", ".", "types", "=", "types", "\n", "laplace_kernel", "=", "np", ".", "ones", "(", "(", "3", ",", "3", ",", "3", ")", ")", "\n", "laplace_kernel", "[", "1", ",", "1", ",", "1", "]", "=", "-", "26", "\n", "\n", "self", ".", "laplace", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "from_numpy", "(", "laplace_kernel", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "\n", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "self", ".", "classes", ",", "1", ",", "3", ",", "3", ",", "3", ")", ",", "\n", "requires_grad", "=", "False", ")", "\n", "\n", "self", ".", "laplace_operator", "=", "nn", ".", "Conv3d", "(", "self", ".", "classes", ",", "self", ".", "classes", ",", "groups", "=", "self", ".", "classes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", "\n", "self", ".", "laplace_operator", ".", "weight", "=", "self", ".", "laplace", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.FastACELoss3DV2.forward": [[508, 542], ["torch.relu", "torch.relu", "torch.relu", "torch.relu", "aceloss.FastACELoss3DV2.laplace_operator", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "label.float.float.float", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.functional.max_pool3d", "torch.functional.max_pool3d", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.functional.max_pool3d", "torch.functional.max_pool3d", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs.min", "torch.abs.min", "torch.abs.min", "torch.abs.min", "torch.abs.max", "torch.abs.max", "torch.abs.min", "torch.abs.min", "torch.abs.max", "torch.abs.max", "torch.abs.min", "torch.abs.min"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "predication", ",", "label", ")", ":", "\n", "        ", "min_pool_x", "=", "nn", ".", "functional", ".", "max_pool3d", "(", "predication", "*", "-", "1", ",", "3", ",", "1", ",", "1", ")", "*", "-", "1", "\n", "contour", "=", "torch", ".", "relu", "(", "nn", ".", "functional", ".", "max_pool3d", "(", "\n", "min_pool_x", ",", "3", ",", "1", ",", "1", ")", "-", "min_pool_x", ")", "\n", "\n", "diff", "=", "self", ".", "laplace_operator", "(", "predication", ")", "\n", "\n", "# length", "\n", "length", "=", "torch", ".", "abs", "(", "contour", ")", "\n", "\n", "# curvature", "\n", "if", "self", ".", "types", ":", "\n", "            ", "curvature", "=", "torch", ".", "abs", "(", "diff", ")", "\n", "curvature", "=", "(", "curvature", "-", "curvature", ".", "min", "(", ")", ")", "/", "(", "curvature", ".", "max", "(", ")", "-", "curvature", ".", "min", "(", ")", "+", "1e-8", ")", "\n", "", "else", ":", "\n", "            ", "\"\"\"\n            maybe more powerful\n            \"\"\"", "\n", "curvature", "=", "torch", ".", "abs", "(", "diff", ")", "/", "(", "(", "length", "**", "2", "+", "1", ")", "**", "0.5", "+", "1e-8", ")", "\n", "curvature", "=", "(", "curvature", "-", "curvature", ".", "min", "(", ")", ")", "/", "(", "curvature", ".", "max", "(", ")", "-", "curvature", ".", "min", "(", ")", "+", "1e-8", ")", "\n", "# region", "\n", "", "label", "=", "label", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "predication", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "predication", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "predication", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "predication", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "self", ".", "miu", "*", "region_in", "+", "region_out", "\n", "\n", "# elastic", "\n", "elastic", "=", "torch", ".", "sum", "(", "(", "self", ".", "alpha", "+", "self", ".", "beta", "*", "curvature", "**", "2", ")", "*", "length", ")", "\n", "return", "region", "+", "elastic", "\n", "\n"]], "home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss": [[89, 165], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "ci[].unsqueeze", "torch.cat", "torch.cat", "ci[].unsqueeze", "torch.cat", "torch.cat", "y_true.float", "torch.ones_like", "torch.ones_like", "torch.zeros_like", "torch.zeros_like", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "aceloss.ACELoss.first_derivative"], "function", ["home.repos.pwc.inspect_result.HiLab-git_ACELoss.None.aceloss.ACELoss3D.first_derivative"], ["", "", "def", "ACELoss", "(", "y_pred", ",", "y_true", ",", "u", "=", "1", ",", "a", "=", "1", ",", "b", "=", "1", ")", ":", "\n", "    ", "\"\"\"\n    Active Contour Loss\n    based on total variations and mean curvature\n    \"\"\"", "\n", "def", "first_derivative", "(", "input", ")", ":", "\n", "        ", "u", "=", "input", "\n", "m", "=", "u", ".", "shape", "[", "2", "]", "\n", "n", "=", "u", ".", "shape", "[", "3", "]", "\n", "\n", "ci_0", "=", "(", "u", "[", ":", ",", ":", ",", "1", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", "0", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "ci_1", "=", "u", "[", ":", ",", ":", ",", "2", ":", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", "0", ":", "m", "-", "2", ",", ":", "]", "\n", "ci_2", "=", "(", "u", "[", ":", ",", ":", ",", "-", "1", ",", ":", "]", "-", "u", "[", ":", ",", ":", ",", "m", "-", "2", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "ci", "=", "torch", ".", "cat", "(", "[", "ci_0", ",", "ci_1", ",", "ci_2", "]", ",", "2", ")", "/", "2", "\n", "\n", "cj_0", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "1", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", "0", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "cj_1", "=", "u", "[", ":", ",", ":", ",", ":", ",", "2", ":", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", "0", ":", "n", "-", "2", "]", "\n", "cj_2", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "-", "1", "]", "-", "u", "[", ":", ",", ":", ",", ":", ",", "n", "-", "2", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "cj", "=", "torch", ".", "cat", "(", "[", "cj_0", ",", "cj_1", ",", "cj_2", "]", ",", "3", ")", "/", "2", "\n", "\n", "return", "ci", ",", "cj", "\n", "\n", "", "def", "second_derivative", "(", "input", ",", "ci", ",", "cj", ")", ":", "\n", "        ", "u", "=", "input", "\n", "m", "=", "u", ".", "shape", "[", "2", "]", "\n", "n", "=", "u", ".", "shape", "[", "3", "]", "\n", "\n", "cii_0", "=", "(", "u", "[", ":", ",", ":", ",", "1", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", "0", ",", ":", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", "0", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "cii_1", "=", "u", "[", ":", ",", ":", ",", "2", ":", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", ":", "-", "2", ",", ":", "]", "-", "2", "*", "u", "[", ":", ",", ":", ",", "1", ":", "-", "1", ",", ":", "]", "\n", "cii_2", "=", "(", "u", "[", ":", ",", ":", ",", "-", "1", ",", ":", "]", "+", "u", "[", ":", ",", ":", ",", "-", "2", ",", ":", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", "-", "1", ",", ":", "]", ")", ".", "unsqueeze", "(", "2", ")", "\n", "cii", "=", "torch", ".", "cat", "(", "[", "cii_0", ",", "cii_1", ",", "cii_2", "]", ",", "2", ")", "\n", "\n", "cjj_0", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "1", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", "0", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", "0", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "cjj_1", "=", "u", "[", ":", ",", ":", ",", ":", ",", "2", ":", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", ":", "-", "2", "]", "-", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", "1", ":", "-", "1", "]", "\n", "cjj_2", "=", "(", "u", "[", ":", ",", ":", ",", ":", ",", "-", "1", "]", "+", "u", "[", ":", ",", ":", ",", ":", ",", "-", "2", "]", "-", "\n", "2", "*", "u", "[", ":", ",", ":", ",", ":", ",", "-", "1", "]", ")", ".", "unsqueeze", "(", "3", ")", "\n", "\n", "cjj", "=", "torch", ".", "cat", "(", "[", "cjj_0", ",", "cjj_1", ",", "cjj_2", "]", ",", "3", ")", "\n", "\n", "cij_0", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "1", ":", "n", "]", "\n", "cij_1", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "-", "1", "]", ".", "unsqueeze", "(", "3", ")", "\n", "\n", "cij_a", "=", "torch", ".", "cat", "(", "[", "cij_0", ",", "cij_1", "]", ",", "3", ")", "\n", "cij_2", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "0", "]", ".", "unsqueeze", "(", "3", ")", "\n", "cij_3", "=", "ci", "[", ":", ",", ":", ",", ":", ",", "0", ":", "n", "-", "1", "]", "\n", "cij_b", "=", "torch", ".", "cat", "(", "[", "cij_2", ",", "cij_3", "]", ",", "3", ")", "\n", "cij", "=", "cij_a", "-", "cij_b", "\n", "\n", "return", "cii", ",", "cjj", ",", "cij", "\n", "\n", "", "def", "region", "(", "y_pred", ",", "y_true", ",", "u", "=", "1", ")", ":", "\n", "        ", "label", "=", "y_true", ".", "float", "(", ")", "\n", "c_in", "=", "torch", ".", "ones_like", "(", "y_pred", ")", "\n", "c_out", "=", "torch", ".", "zeros_like", "(", "y_pred", ")", "\n", "region_in", "=", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "y_pred", "*", "(", "(", "label", "-", "c_in", ")", "**", "2", ")", ")", ")", "\n", "region_out", "=", "torch", ".", "abs", "(", "\n", "torch", ".", "sum", "(", "(", "1", "-", "y_pred", ")", "*", "(", "(", "label", "-", "c_out", ")", "**", "2", ")", ")", ")", "\n", "region", "=", "u", "*", "region_in", "+", "region_out", "\n", "return", "region", "\n", "\n", "", "def", "elastica", "(", "input", ",", "a", "=", "1", ",", "b", "=", "1", ")", ":", "\n", "        ", "ci", ",", "cj", "=", "first_derivative", "(", "input", ")", "\n", "cii", ",", "cjj", ",", "cij", "=", "second_derivative", "(", "input", ",", "ci", ",", "cj", ")", "\n", "beta", "=", "1e-8", "\n", "length", "=", "torch", ".", "sqrt", "(", "beta", "+", "ci", "**", "2", "+", "cj", "**", "2", ")", "\n", "curvature", "=", "(", "beta", "+", "ci", "**", "2", ")", "*", "cjj", "+", "(", "beta", "+", "cj", "**", "2", ")", "*", "cii", "-", "2", "*", "ci", "*", "cj", "*", "cij", "\n", "curvature", "=", "torch", ".", "abs", "(", "curvature", ")", "/", "(", "(", "ci", "**", "2", "+", "cj", "**", "2", ")", "**", "1.5", "+", "beta", ")", "\n", "elastica", "=", "torch", ".", "sum", "(", "(", "a", "+", "b", "*", "(", "curvature", "**", "2", ")", ")", "*", "torch", ".", "abs", "(", "length", ")", ")", "\n", "return", "elastica", "\n", "\n", "", "loss", "=", "region", "(", "y_pred", ",", "y_true", ",", "u", "=", "u", ")", "+", "elastica", "(", "y_pred", ",", "a", "=", "a", ",", "b", "=", "b", ")", "\n", "return", "loss", "\n", "\n"]]}