{"home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.main": [[47, 74], ["main.get_dataset_and_loaders", "main.get_model", "main.freeze_model", "print", "robustness.train.train_model", "main.get_per_class_accuracy", "robustness.train.eval_model"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.get_dataset_and_loaders", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.get_model", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.freeze_model", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.get_per_class_accuracy"], ["def", "main", "(", "args", ",", "store", ")", ":", "\n", "    ", "'''Given arguments and a cox store, trains as a model. Check out the \n    argparse object in this file for argument options.\n    '''", "\n", "ds", ",", "train_loader", ",", "validation_loader", "=", "get_dataset_and_loaders", "(", "args", ")", "\n", "\n", "if", "args", ".", "per_class_accuracy", ":", "\n", "        ", "assert", "args", ".", "dataset", "in", "[", "'pets'", ",", "'caltech101'", ",", "'caltech256'", ",", "'flowers'", ",", "'aircraft'", "]", ",", "f'Per-class accuracy not supported for the {args.dataset} dataset.'", "\n", "\n", "# VERY IMPORTANT", "\n", "# We report the per-class accuracy using the validation", "\n", "# set distribution. So ignore the training accuracy (as you will see it go", "\n", "# beyond 100. Don't freak out, it doesn't really capture anything),", "\n", "# just look at the validation accuarcy", "\n", "args", ".", "custom_accuracy", "=", "get_per_class_accuracy", "(", "args", ",", "validation_loader", ")", "\n", "\n", "", "model", ",", "checkpoint", "=", "get_model", "(", "args", ",", "ds", ")", "\n", "\n", "if", "args", ".", "eval_only", ":", "\n", "        ", "return", "train", ".", "eval_model", "(", "args", ",", "model", ",", "validation_loader", ",", "store", "=", "store", ")", "\n", "\n", "", "update_params", "=", "freeze_model", "(", "model", ",", "freeze_level", "=", "args", ".", "freeze_level", ")", "\n", "\n", "print", "(", "f\"Dataset: {args.dataset} | Model: {args.arch}\"", ")", "\n", "train", ".", "train_model", "(", "args", ",", "model", ",", "(", "train_loader", ",", "validation_loader", ")", ",", "store", "=", "store", ",", "\n", "checkpoint", "=", "checkpoint", ",", "update_params", "=", "update_params", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.get_per_class_accuracy": [[76, 116], ["main.get_per_class_accuracy._get_class_weights"], "function", ["None"], ["", "def", "get_per_class_accuracy", "(", "args", ",", "loader", ")", ":", "\n", "    ", "'''Returns the custom per_class_accuracy function. When using this custom function         \n    look at only the validation accuracy. Ignore trainig set accuracy.\n    '''", "\n", "def", "_get_class_weights", "(", "args", ",", "loader", ")", ":", "\n", "        ", "'''Returns the distribution of classes in a given dataset.\n        '''", "\n", "if", "args", ".", "dataset", "in", "[", "'pets'", ",", "'flowers'", "]", ":", "\n", "            ", "targets", "=", "loader", ".", "dataset", ".", "targets", "\n", "\n", "", "elif", "args", ".", "dataset", "in", "[", "'caltech101'", ",", "'caltech256'", "]", ":", "\n", "            ", "targets", "=", "np", ".", "array", "(", "[", "loader", ".", "dataset", ".", "ds", ".", "dataset", ".", "y", "[", "idx", "]", "\n", "for", "idx", "in", "loader", ".", "dataset", ".", "ds", ".", "indices", "]", ")", "\n", "\n", "", "elif", "args", ".", "dataset", "==", "'aircraft'", ":", "\n", "            ", "targets", "=", "[", "s", "[", "1", "]", "for", "s", "in", "loader", ".", "dataset", ".", "samples", "]", "\n", "\n", "", "counts", "=", "np", ".", "unique", "(", "targets", ",", "return_counts", "=", "True", ")", "[", "1", "]", "\n", "class_weights", "=", "counts", ".", "sum", "(", ")", "/", "(", "counts", "*", "len", "(", "counts", ")", ")", "\n", "return", "ch", ".", "Tensor", "(", "class_weights", ")", "\n", "\n", "", "class_weights", "=", "_get_class_weights", "(", "args", ",", "loader", ")", "\n", "\n", "def", "custom_acc", "(", "logits", ",", "labels", ")", ":", "\n", "        ", "'''Returns the top1 accuracy, weighted by the class distribution.\n        This is important when evaluating an unbalanced dataset. \n        '''", "\n", "batch_size", "=", "labels", ".", "size", "(", "0", ")", "\n", "maxk", "=", "min", "(", "5", ",", "logits", ".", "shape", "[", "-", "1", "]", ")", "\n", "prec1", ",", "_", "=", "helpers", ".", "accuracy", "(", "\n", "logits", ",", "labels", ",", "topk", "=", "(", "1", ",", "maxk", ")", ",", "exact", "=", "True", ")", "\n", "\n", "normal_prec1", "=", "prec1", ".", "sum", "(", "0", ",", "keepdim", "=", "True", ")", ".", "mul_", "(", "100", "/", "batch_size", ")", "\n", "weighted_prec1", "=", "prec1", "*", "class_weights", "[", "labels", ".", "cpu", "(", ")", "]", ".", "cuda", "(", ")", "\n", "weighted_prec1", "=", "weighted_prec1", ".", "sum", "(", "\n", "0", ",", "keepdim", "=", "True", ")", ".", "mul_", "(", "100", "/", "batch_size", ")", "\n", "\n", "return", "weighted_prec1", ".", "item", "(", ")", ",", "normal_prec1", ".", "item", "(", ")", "\n", "\n", "", "return", "custom_acc", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.get_dataset_and_loaders": [[118, 139], ["robustness.datasets.ImageNet", "datasets.CIFAR.make_loaders", "robustness.datasets.CIFAR", "datasets.CIFAR.make_loaders", "utils.transfer_datasets.make_loaders", "type", "robustness.datasets.CIFAR", "torch.tensor", "torch.tensor"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "get_dataset_and_loaders", "(", "args", ")", ":", "\n", "    ", "'''Given arguments, returns a datasets object and the train and validation loaders.\n    '''", "\n", "if", "args", ".", "dataset", "in", "[", "'imagenet'", ",", "'stylized_imagenet'", "]", ":", "\n", "        ", "ds", "=", "datasets", ".", "ImageNet", "(", "args", ".", "data", ")", "\n", "train_loader", ",", "validation_loader", "=", "ds", ".", "make_loaders", "(", "\n", "only_val", "=", "args", ".", "eval_only", ",", "batch_size", "=", "args", ".", "batch_size", ",", "workers", "=", "8", ")", "\n", "", "elif", "args", ".", "cifar10_cifar10", ":", "\n", "        ", "ds", "=", "datasets", ".", "CIFAR", "(", "'/tmp'", ")", "\n", "train_loader", ",", "validation_loader", "=", "ds", ".", "make_loaders", "(", "\n", "only_val", "=", "args", ".", "eval_only", ",", "batch_size", "=", "args", ".", "batch_size", ",", "workers", "=", "8", ")", "\n", "", "else", ":", "\n", "        ", "ds", ",", "(", "train_loader", ",", "validation_loader", ")", "=", "transfer_datasets", ".", "make_loaders", "(", "\n", "args", ".", "dataset", ",", "args", ".", "batch_size", ",", "8", ",", "args", ".", "subset", ")", "\n", "if", "type", "(", "ds", ")", "==", "int", ":", "\n", "            ", "new_ds", "=", "datasets", ".", "CIFAR", "(", "\"/tmp\"", ")", "\n", "new_ds", ".", "num_classes", "=", "ds", "\n", "new_ds", ".", "mean", "=", "ch", ".", "tensor", "(", "[", "0.", ",", "0.", ",", "0.", "]", ")", "\n", "new_ds", ".", "std", "=", "ch", ".", "tensor", "(", "[", "1.", ",", "1.", ",", "1.", "]", ")", "\n", "ds", "=", "new_ds", "\n", "", "", "return", "ds", ",", "train_loader", ",", "validation_loader", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.resume_finetuning_from_checkpoint": [[141, 161], ["print", "robustness.model_utils.make_and_restore_model", "hasattr", "utils.fine_tunify.ft", "robustness.model_utils.make_and_restore_model", "robustness.model_utils.make_and_restore_model", "list", "utils.transfer_datasets.DS_TO_FUNC.keys", "robustness.datasets.ImageNet", "pytorch_models.keys", "pytorch_models.keys", "pytorch_models.keys"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.fine_tunify.ft"], ["", "def", "resume_finetuning_from_checkpoint", "(", "args", ",", "ds", ",", "finetuned_model_path", ")", ":", "\n", "    ", "'''Given arguments, dataset object and a finetuned model_path, returns a model\n    with loaded weights and returns the checkpoint necessary for resuming training.\n    '''", "\n", "print", "(", "'[Resuming finetuning from a checkpoint...]'", ")", "\n", "if", "args", ".", "dataset", "in", "list", "(", "transfer_datasets", ".", "DS_TO_FUNC", ".", "keys", "(", ")", ")", "and", "not", "args", ".", "cifar10_cifar10", ":", "\n", "        ", "model", ",", "_", "=", "model_utils", ".", "make_and_restore_model", "(", "\n", "arch", "=", "pytorch_models", "[", "args", ".", "arch", "]", "(", "\n", "args", ".", "pytorch_pretrained", ")", "if", "args", ".", "arch", "in", "pytorch_models", ".", "keys", "(", ")", "else", "args", ".", "arch", ",", "\n", "dataset", "=", "datasets", ".", "ImageNet", "(", "''", ")", ",", "add_custom_forward", "=", "args", ".", "arch", "in", "pytorch_models", ".", "keys", "(", ")", ")", "\n", "while", "hasattr", "(", "model", ",", "'model'", ")", ":", "\n", "            ", "model", "=", "model", ".", "model", "\n", "", "model", "=", "fine_tunify", ".", "ft", "(", "\n", "args", ".", "arch", ",", "model", ",", "ds", ".", "num_classes", ",", "args", ".", "additional_hidden", ")", "\n", "model", ",", "checkpoint", "=", "model_utils", ".", "make_and_restore_model", "(", "arch", "=", "model", ",", "dataset", "=", "ds", ",", "resume_path", "=", "finetuned_model_path", ",", "\n", "add_custom_forward", "=", "args", ".", "additional_hidden", ">", "0", "or", "args", ".", "arch", "in", "pytorch_models", ".", "keys", "(", ")", ")", "\n", "", "else", ":", "\n", "        ", "model", ",", "checkpoint", "=", "model_utils", ".", "make_and_restore_model", "(", "\n", "arch", "=", "args", ".", "arch", ",", "dataset", "=", "ds", ",", "resume_path", "=", "finetuned_model_path", ")", "\n", "", "return", "model", ",", "checkpoint", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.get_model": [[163, 197], ["os.path.join", "os.path.isfile", "main.resume_finetuning_from_checkpoint", "robustness.model_utils.make_and_restore_model", "robustness.model_utils.make_and_restore_model", "print", "hasattr", "utils.fine_tunify.ft", "robustness.model_utils.make_and_restore_model", "print", "list", "utils.transfer_datasets.DS_TO_FUNC.keys", "robustness.datasets.ImageNet", "pytorch_models.keys", "pytorch_models.keys", "pytorch_models.keys"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.resume_finetuning_from_checkpoint", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.fine_tunify.ft"], ["", "def", "get_model", "(", "args", ",", "ds", ")", ":", "\n", "    ", "'''Given arguments and a dataset object, returns an ImageNet model (with appropriate last layer changes to \n    fit the target dataset) and a checkpoint.The checkpoint is set to None if noe resuming training.\n    '''", "\n", "finetuned_model_path", "=", "os", ".", "path", ".", "join", "(", "\n", "args", ".", "out_dir", ",", "args", ".", "exp_name", ",", "'checkpoint.pt.latest'", ")", "\n", "if", "args", ".", "resume", "and", "os", ".", "path", ".", "isfile", "(", "finetuned_model_path", ")", ":", "\n", "        ", "model", ",", "checkpoint", "=", "resume_finetuning_from_checkpoint", "(", "\n", "args", ",", "ds", ",", "finetuned_model_path", ")", "\n", "", "else", ":", "\n", "        ", "if", "args", ".", "dataset", "in", "list", "(", "transfer_datasets", ".", "DS_TO_FUNC", ".", "keys", "(", ")", ")", "and", "not", "args", ".", "cifar10_cifar10", ":", "\n", "            ", "model", ",", "_", "=", "model_utils", ".", "make_and_restore_model", "(", "\n", "arch", "=", "pytorch_models", "[", "args", ".", "arch", "]", "(", "\n", "args", ".", "pytorch_pretrained", ")", "if", "args", ".", "arch", "in", "pytorch_models", ".", "keys", "(", ")", "else", "args", ".", "arch", ",", "\n", "dataset", "=", "datasets", ".", "ImageNet", "(", "''", ")", ",", "resume_path", "=", "args", ".", "model_path", ",", "pytorch_pretrained", "=", "args", ".", "pytorch_pretrained", ",", "\n", "add_custom_forward", "=", "args", ".", "arch", "in", "pytorch_models", ".", "keys", "(", ")", ")", "\n", "checkpoint", "=", "None", "\n", "", "else", ":", "\n", "            ", "model", ",", "_", "=", "model_utils", ".", "make_and_restore_model", "(", "arch", "=", "args", ".", "arch", ",", "dataset", "=", "ds", ",", "\n", "resume_path", "=", "args", ".", "model_path", ",", "pytorch_pretrained", "=", "args", ".", "pytorch_pretrained", ")", "\n", "checkpoint", "=", "None", "\n", "\n", "", "if", "not", "args", ".", "no_replace_last_layer", "and", "not", "args", ".", "eval_only", ":", "\n", "            ", "print", "(", "f'[Replacing the last layer with {args.additional_hidden} '", "\n", "f'hidden layers and 1 classification layer that fits the {args.dataset} dataset.]'", ")", "\n", "while", "hasattr", "(", "model", ",", "'model'", ")", ":", "\n", "                ", "model", "=", "model", ".", "model", "\n", "", "model", "=", "fine_tunify", ".", "ft", "(", "\n", "args", ".", "arch", ",", "model", ",", "ds", ".", "num_classes", ",", "args", ".", "additional_hidden", ")", "\n", "model", ",", "checkpoint", "=", "model_utils", ".", "make_and_restore_model", "(", "arch", "=", "model", ",", "dataset", "=", "ds", ",", "\n", "add_custom_forward", "=", "args", ".", "additional_hidden", ">", "0", "or", "args", ".", "arch", "in", "pytorch_models", ".", "keys", "(", ")", ")", "\n", "", "else", ":", "\n", "            ", "print", "(", "'[NOT replacing the last layer]'", ")", "\n", "", "", "return", "model", ",", "checkpoint", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.freeze_model": [[199, 224], ["len", "model.named_parameters", "print", "param.size", "print", "update_params.append", "list", "model.named_parameters"], "function", ["None"], ["", "def", "freeze_model", "(", "model", ",", "freeze_level", ")", ":", "\n", "    ", "'''\n    Freezes up to args.freeze_level layers of the model (assumes a resnet model)\n    '''", "\n", "# Freeze layers according to args.freeze-level", "\n", "update_params", "=", "None", "\n", "if", "freeze_level", "!=", "-", "1", ":", "\n", "# assumes a resnet architecture", "\n", "        ", "assert", "len", "(", "[", "name", "for", "name", ",", "_", "in", "list", "(", "model", ".", "named_parameters", "(", ")", ")", "\n", "if", "f\"layer{freeze_level}\"", "in", "name", "]", ")", ",", "\"unknown freeze level (only {1,2,3,4} for ResNets)\"", "\n", "update_params", "=", "[", "]", "\n", "freeze", "=", "True", "\n", "for", "name", ",", "param", "in", "model", ".", "named_parameters", "(", ")", ":", "\n", "            ", "print", "(", "name", ",", "param", ".", "size", "(", ")", ")", "\n", "\n", "if", "not", "freeze", "and", "f'layer{freeze_level}'", "not", "in", "name", ":", "\n", "                ", "print", "(", "f\"[Appending the params of {name} to the update list]\"", ")", "\n", "update_params", ".", "append", "(", "param", ")", "\n", "", "else", ":", "\n", "                ", "param", ".", "requires_grad", "=", "False", "\n", "\n", "", "if", "freeze", "and", "f'layer{freeze_level}'", "in", "name", ":", "\n", "# if the freeze level is detected stop freezing onwards", "\n", "                ", "freeze", "=", "False", "\n", "", "", "", "return", "update_params", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.src.main.args_preprocess": [[226, 262], ["robustness.defaults.check_and_fill_args", "robustness.defaults.check_and_fill_args", "print", "list", "robustness.defaults.check_and_fill_args", "robustness.defaults.check_and_fill_args", "eval", "utils.transfer_datasets.DS_TO_FUNC.keys"], "function", ["None"], ["", "def", "args_preprocess", "(", "args", ")", ":", "\n", "    ", "'''\n    Fill the args object with reasonable defaults, and also perform a sanity check to make sure no\n    args are missing.\n    '''", "\n", "if", "args", ".", "adv_train", "and", "eval", "(", "args", ".", "eps", ")", "==", "0", ":", "\n", "        ", "print", "(", "'[Switching to standard training since eps = 0]'", ")", "\n", "args", ".", "adv_train", "=", "0", "\n", "\n", "", "if", "args", ".", "pytorch_pretrained", ":", "\n", "        ", "assert", "not", "args", ".", "model_path", ",", "'You can either specify pytorch_pretrained or model_path, not together.'", "\n", "\n", "# CIFAR10 to CIFAR10 assertions", "\n", "", "if", "args", ".", "cifar10_cifar10", ":", "\n", "        ", "assert", "args", ".", "dataset", "==", "'cifar10'", "\n", "\n", "", "if", "args", ".", "data", "!=", "''", ":", "\n", "        ", "cs", ".", "CALTECH101_PATH", "=", "cs", ".", "CALTECH256_PATH", "=", "cs", ".", "PETS_PATH", "=", "cs", ".", "CARS_PATH", "=", "args", ".", "data", "\n", "cs", ".", "FGVC_PATH", "=", "cs", ".", "FLOWERS_PATH", "=", "cs", ".", "DTD_PATH", "=", "cs", ".", "SUN_PATH", "=", "cs", ".", "FOOD_PATH", "=", "cs", ".", "BIRDS_PATH", "=", "args", ".", "data", "\n", "\n", "", "ALL_DS", "=", "list", "(", "transfer_datasets", ".", "DS_TO_FUNC", ".", "keys", "(", ")", ")", "+", "[", "'imagenet'", ",", "'breeds_living_9'", ",", "'stylized_imagenet'", "]", "\n", "assert", "args", ".", "dataset", "in", "ALL_DS", "\n", "\n", "# Important for automatic job retries on the cluster in case of premptions. Avoid uuids.", "\n", "assert", "args", ".", "exp_name", "!=", "None", "\n", "\n", "# Preprocess args", "\n", "args", "=", "defaults", ".", "check_and_fill_args", "(", "args", ",", "defaults", ".", "CONFIG_ARGS", ",", "None", ")", "\n", "if", "not", "args", ".", "eval_only", ":", "\n", "        ", "args", "=", "defaults", ".", "check_and_fill_args", "(", "args", ",", "defaults", ".", "TRAINING_ARGS", ",", "None", ")", "\n", "", "if", "args", ".", "adv_train", "or", "args", ".", "adv_eval", ":", "\n", "        ", "args", "=", "defaults", ".", "check_and_fill_args", "(", "args", ",", "defaults", ".", "PGD_ARGS", ",", "None", ")", "\n", "", "args", "=", "defaults", ".", "check_and_fill_args", "(", "args", ",", "defaults", ".", "MODEL_LOADER_ARGS", ",", "None", ")", "\n", "\n", "return", "args", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech101.__init__": [[29, 65], ["torchvision.datasets.vision.VisionDataset.__init__", "os.makedirs", "os.makedirs", "os.makedirs", "os.makedirs", "sorted", "caltech.Caltech101.categories.remove", "list", "enumerate", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "isinstance", "torchvision.datasets.utils.verify_str_arg", "caltech.Caltech101.download", "caltech.Caltech101._check_integrity", "RuntimeError", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "map", "len", "caltech.Caltech101.index.extend", "caltech.Caltech101.y.extend", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "range", "os.path.join", "os.path.join", "os.path.join", "os.path.join"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.__init__", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.download", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256._check_integrity"], ["def", "__init__", "(", "self", ",", "root", ",", "target_type", "=", "\"category\"", ",", "transform", "=", "None", ",", "\n", "target_transform", "=", "None", ",", "download", "=", "False", ")", ":", "\n", "        ", "super", "(", "Caltech101", ",", "self", ")", ".", "__init__", "(", "os", ".", "path", ".", "join", "(", "root", ",", "'caltech101'", ")", ",", "\n", "transform", "=", "transform", ",", "\n", "target_transform", "=", "target_transform", ")", "\n", "os", ".", "makedirs", "(", "self", ".", "root", ",", "exist_ok", "=", "True", ")", "\n", "if", "not", "isinstance", "(", "target_type", ",", "list", ")", ":", "\n", "            ", "target_type", "=", "[", "target_type", "]", "\n", "", "self", ".", "target_type", "=", "[", "verify_str_arg", "(", "t", ",", "\"target_type\"", ",", "(", "\"category\"", ",", "\"annotation\"", ")", ")", "\n", "for", "t", "in", "target_type", "]", "\n", "\n", "if", "download", ":", "\n", "            ", "self", ".", "download", "(", ")", "\n", "\n", "", "if", "not", "self", ".", "_check_integrity", "(", ")", ":", "\n", "            ", "raise", "RuntimeError", "(", "'Dataset not found or corrupted.'", "+", "\n", "' You can use download=True to download it'", ")", "\n", "\n", "", "self", ".", "categories", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\"101_ObjectCategories\"", ")", ")", ")", "\n", "self", ".", "categories", ".", "remove", "(", "\"BACKGROUND_Google\"", ")", "# this is not a real class", "\n", "\n", "# For some reason, the category names in \"101_ObjectCategories\" and", "\n", "# \"Annotations\" do not always match. This is a manual map between the", "\n", "# two. Defaults to using same name, since most names are fine.", "\n", "name_map", "=", "{", "\"Faces\"", ":", "\"Faces_2\"", ",", "\n", "\"Faces_easy\"", ":", "\"Faces_3\"", ",", "\n", "\"Motorbikes\"", ":", "\"Motorbikes_16\"", ",", "\n", "\"airplanes\"", ":", "\"Airplanes_Side_2\"", "}", "\n", "self", ".", "annotation_categories", "=", "list", "(", "map", "(", "lambda", "x", ":", "name_map", "[", "x", "]", "if", "x", "in", "name_map", "else", "x", ",", "self", ".", "categories", ")", ")", "\n", "\n", "self", ".", "index", "=", "[", "]", "\n", "self", ".", "y", "=", "[", "]", "\n", "for", "(", "i", ",", "c", ")", "in", "enumerate", "(", "self", ".", "categories", ")", ":", "\n", "            ", "n", "=", "len", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\"101_ObjectCategories\"", ",", "c", ")", ")", ")", "\n", "self", ".", "index", ".", "extend", "(", "range", "(", "1", ",", "n", "+", "1", ")", ")", "\n", "self", ".", "y", ".", "extend", "(", "n", "*", "[", "i", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech101.__getitem__": [[66, 99], ["PIL.Image.open", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "tuple", "caltech.Caltech101.transform", "caltech.Caltech101.target_transform", "caltech.Caltech101.append", "len", "scipy.io.loadmat", "caltech.Caltech101.append", "os.path.join", "os.path.join", "os.path.join", "os.path.join"], "methods", ["None"], ["", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "\"\"\"\n        Args:\n            index (int): Index\n        Returns:\n            tuple: (image, target) where the type of target specified by target_type.\n        \"\"\"", "\n", "import", "scipy", ".", "io", "\n", "\n", "img", "=", "Image", ".", "open", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\n", "\"101_ObjectCategories\"", ",", "\n", "self", ".", "categories", "[", "self", ".", "y", "[", "index", "]", "]", ",", "\n", "\"image_{:04d}.jpg\"", ".", "format", "(", "self", ".", "index", "[", "index", "]", ")", ")", ")", "\n", "\n", "target", "=", "[", "]", "\n", "for", "t", "in", "self", ".", "target_type", ":", "\n", "            ", "if", "t", "==", "\"category\"", ":", "\n", "                ", "target", ".", "append", "(", "self", ".", "y", "[", "index", "]", ")", "\n", "", "elif", "t", "==", "\"annotation\"", ":", "\n", "                ", "data", "=", "scipy", ".", "io", ".", "loadmat", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\n", "\"Annotations\"", ",", "\n", "self", ".", "annotation_categories", "[", "self", ".", "y", "[", "index", "]", "]", ",", "\n", "\"annotation_{:04d}.mat\"", ".", "format", "(", "self", ".", "index", "[", "index", "]", ")", ")", ")", "\n", "target", ".", "append", "(", "data", "[", "\"obj_contour\"", "]", ")", "\n", "", "", "target", "=", "tuple", "(", "target", ")", "if", "len", "(", "target", ")", ">", "1", "else", "target", "[", "0", "]", "\n", "\n", "if", "self", ".", "transform", "is", "not", "None", ":", "\n", "            ", "img", "=", "self", ".", "transform", "(", "img", ")", "\n", "\n", "", "if", "self", ".", "target_transform", "is", "not", "None", ":", "\n", "            ", "target", "=", "self", ".", "target_transform", "(", "target", ")", "\n", "\n", "", "return", "img", ",", "target", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech101._check_integrity": [[100, 103], ["os.path.exists", "os.path.exists", "os.path.exists", "os.path.exists", "os.path.join", "os.path.join", "os.path.join", "os.path.join"], "methods", ["None"], ["", "def", "_check_integrity", "(", "self", ")", ":", "\n", "# can be more robust and check hash of files", "\n", "        ", "return", "os", ".", "path", ".", "exists", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\"101_ObjectCategories\"", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech101.__len__": [[104, 106], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "index", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech101.download": [[107, 122], ["caltech.Caltech101._check_integrity", "torchvision.datasets.utils.download_and_extract_archive", "torchvision.datasets.utils.download_and_extract_archive", "print"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256._check_integrity"], ["", "def", "download", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "_check_integrity", "(", ")", ":", "\n", "            ", "print", "(", "'Files already downloaded and verified'", ")", "\n", "return", "\n", "\n", "", "download_and_extract_archive", "(", "\n", "\"http://www.vision.caltech.edu/Image_Datasets/Caltech101/101_ObjectCategories.tar.gz\"", ",", "\n", "self", ".", "root", ",", "\n", "filename", "=", "\"101_ObjectCategories.tar.gz\"", ",", "\n", "md5", "=", "\"b224c7392d521a49829488ab0f1120d9\"", ")", "\n", "download_and_extract_archive", "(", "\n", "\"http://www.vision.caltech.edu/Image_Datasets/Caltech101/Annotations.tar\"", ",", "\n", "self", ".", "root", ",", "\n", "filename", "=", "\"101_Annotations.tar\"", ",", "\n", "md5", "=", "\"6f83eeb1f24d99cab4eb377263132c91\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech101.extra_repr": [[123, 125], ["None"], "methods", ["None"], ["", "def", "extra_repr", "(", "self", ")", ":", "\n", "        ", "return", "\"Target type: {target_type}\"", ".", "format", "(", "**", "self", ".", "__dict__", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256.__init__": [[141, 163], ["torchvision.datasets.vision.VisionDataset.__init__", "os.makedirs", "os.makedirs", "os.makedirs", "os.makedirs", "sorted", "enumerate", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "caltech.Caltech256.download", "caltech.Caltech256._check_integrity", "RuntimeError", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "len", "caltech.Caltech256.index.extend", "caltech.Caltech256.y.extend", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "range"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.__init__", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.download", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256._check_integrity"], ["def", "__init__", "(", "self", ",", "root", ",", "transform", "=", "None", ",", "target_transform", "=", "None", ",", "download", "=", "False", ")", ":", "\n", "        ", "super", "(", "Caltech256", ",", "self", ")", ".", "__init__", "(", "os", ".", "path", ".", "join", "(", "root", ",", "'caltech256'", ")", ",", "\n", "transform", "=", "transform", ",", "\n", "target_transform", "=", "target_transform", ")", "\n", "os", ".", "makedirs", "(", "self", ".", "root", ",", "exist_ok", "=", "True", ")", "\n", "\n", "if", "download", ":", "\n", "            ", "self", ".", "download", "(", ")", "\n", "\n", "", "if", "not", "self", ".", "_check_integrity", "(", ")", ":", "\n", "            ", "raise", "RuntimeError", "(", "'Dataset not found or corrupted.'", "+", "\n", "' You can use download=True to download it'", ")", "\n", "\n", "", "self", ".", "categories", "=", "sorted", "(", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\"256_ObjectCategories\"", ")", ")", ")", "\n", "self", ".", "index", "=", "[", "]", "\n", "self", ".", "y", "=", "[", "]", "\n", "for", "(", "i", ",", "c", ")", "in", "enumerate", "(", "self", ".", "categories", ")", ":", "\n", "            ", "image_paths", "=", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\"256_ObjectCategories\"", ",", "c", ")", ")", "\n", "image_paths", "=", "[", "path", "for", "path", "in", "image_paths", "if", "'.jpg'", "in", "path", "]", "\n", "n", "=", "len", "(", "image_paths", ")", "\n", "self", ".", "index", ".", "extend", "(", "range", "(", "1", ",", "n", "+", "1", ")", ")", "\n", "self", ".", "y", ".", "extend", "(", "n", "*", "[", "i", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256.__getitem__": [[164, 185], ["PIL.Image.open", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "caltech.Caltech256.transform", "caltech.Caltech256.target_transform"], "methods", ["None"], ["", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "\"\"\"\n        Args:\n            index (int): Index\n        Returns:\n            tuple: (image, target) where target is index of the target class.\n        \"\"\"", "\n", "img", "=", "Image", ".", "open", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\n", "\"256_ObjectCategories\"", ",", "\n", "self", ".", "categories", "[", "self", ".", "y", "[", "index", "]", "]", ",", "\n", "\"{:03d}_{:04d}.jpg\"", ".", "format", "(", "self", ".", "y", "[", "index", "]", "+", "1", ",", "self", ".", "index", "[", "index", "]", ")", ")", ")", "\n", "\n", "target", "=", "self", ".", "y", "[", "index", "]", "\n", "\n", "if", "self", ".", "transform", "is", "not", "None", ":", "\n", "            ", "img", "=", "self", ".", "transform", "(", "img", ")", "\n", "\n", "", "if", "self", ".", "target_transform", "is", "not", "None", ":", "\n", "            ", "target", "=", "self", ".", "target_transform", "(", "target", ")", "\n", "\n", "", "return", "img", ",", "target", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256._check_integrity": [[186, 189], ["os.path.exists", "os.path.exists", "os.path.exists", "os.path.exists", "os.path.join", "os.path.join", "os.path.join", "os.path.join"], "methods", ["None"], ["", "def", "_check_integrity", "(", "self", ")", ":", "\n", "# can be more robust and check hash of files", "\n", "        ", "return", "os", ".", "path", ".", "exists", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "\"256_ObjectCategories\"", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256.__len__": [[190, 192], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "index", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256.download": [[193, 203], ["caltech.Caltech256._check_integrity", "torchvision.datasets.utils.download_and_extract_archive", "print"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.caltech.Caltech256._check_integrity"], ["", "def", "download", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "_check_integrity", "(", ")", ":", "\n", "            ", "print", "(", "'Files already downloaded and verified'", ")", "\n", "return", "\n", "\n", "", "download_and_extract_archive", "(", "\n", "\"http://www.vision.caltech.edu/Image_Datasets/Caltech256/256_ObjectCategories.tar\"", ",", "\n", "self", ".", "root", ",", "\n", "filename", "=", "\"256_ObjectCategories.tar\"", ",", "\n", "md5", "=", "\"67b4f42ca05d46448c6bb8ecd2220f6d\"", ")", "", "", "", ""]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.fine_tunify.ft": [[4, 42], ["torch.nn.Linear", "robustness.tools.custom_modules.SequentialWithArgs", "torch.nn.Linear", "torch.nn.Linear", "torch.nn.Linear", "list", "torch.nn.Conv2d", "sum", "torch.nn.Linear", "torch.nn.Linear", "ValueError", "torch.nn.Linear", "torch.nn.ReLU", "range"], "function", ["None"], ["def", "ft", "(", "model_name", ",", "model_ft", ",", "num_classes", ",", "additional_hidden", "=", "0", ")", ":", "\n", "    ", "if", "model_name", "in", "[", "\"resnet\"", ",", "\"resnet18\"", ",", "\"resnet50\"", ",", "\"wide_resnet50_2\"", ",", "\"wide_resnet50_4\"", ",", "\"resnext50_32x4d\"", ",", "'shufflenet'", "]", ":", "\n", "        ", "num_ftrs", "=", "model_ft", ".", "fc", ".", "in_features", "\n", "# The two cases are split just to allow loading", "\n", "# models trained prior to adding the additional_hidden argument", "\n", "# without errors", "\n", "if", "additional_hidden", "==", "0", ":", "\n", "            ", "model_ft", ".", "fc", "=", "nn", ".", "Linear", "(", "num_ftrs", ",", "num_classes", ")", "\n", "", "else", ":", "\n", "            ", "model_ft", ".", "fc", "=", "SequentialWithArgs", "(", "\n", "*", "list", "(", "sum", "(", "[", "[", "nn", ".", "Linear", "(", "num_ftrs", ",", "num_ftrs", ")", ",", "nn", ".", "ReLU", "(", ")", "]", "for", "i", "in", "range", "(", "additional_hidden", ")", "]", ",", "[", "]", ")", ")", ",", "\n", "nn", ".", "Linear", "(", "num_ftrs", ",", "num_classes", ")", "\n", ")", "\n", "", "input_size", "=", "224", "\n", "", "elif", "model_name", "==", "\"alexnet\"", ":", "\n", "        ", "num_ftrs", "=", "model_ft", ".", "classifier", "[", "6", "]", ".", "in_features", "\n", "model_ft", ".", "classifier", "[", "6", "]", "=", "nn", ".", "Linear", "(", "num_ftrs", ",", "num_classes", ")", "\n", "input_size", "=", "224", "\n", "", "elif", "\"vgg\"", "in", "model_name", ":", "\n", "        ", "num_ftrs", "=", "model_ft", ".", "classifier", "[", "6", "]", ".", "in_features", "\n", "model_ft", ".", "classifier", "[", "6", "]", "=", "nn", ".", "Linear", "(", "num_ftrs", ",", "num_classes", ")", "\n", "input_size", "=", "224", "\n", "", "elif", "model_name", "==", "\"squeezenet\"", ":", "\n", "        ", "model_ft", ".", "classifier", "[", "1", "]", "=", "nn", ".", "Conv2d", "(", "512", ",", "num_classes", ",", "kernel_size", "=", "(", "1", ",", "1", ")", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "model_ft", ".", "num_classes", "=", "num_classes", "\n", "input_size", "=", "224", "\n", "", "elif", "model_name", "==", "\"densenet\"", ":", "\n", "        ", "num_ftrs", "=", "model_ft", ".", "classifier", ".", "in_features", "\n", "model_ft", ".", "classifier", "=", "nn", ".", "Linear", "(", "num_ftrs", ",", "num_classes", ")", "\n", "input_size", "=", "224", "\n", "", "elif", "model_name", "in", "[", "\"mnasnet\"", ",", "\"mobilenet\"", "]", ":", "\n", "        ", "num_ftrs", "=", "model_ft", ".", "classifier", "[", "1", "]", ".", "in_features", "\n", "model_ft", ".", "classifier", "[", "1", "]", "=", "nn", ".", "Linear", "(", "num_ftrs", ",", "num_classes", ")", "\n", "input_size", "=", "224", "\n", "", "else", ":", "\n", "        ", "raise", "ValueError", "(", "\"Invalid model type, exiting...\"", ")", "\n", "\n", "", "return", "model_ft", "\n", "", ""]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.dtd.DTD.__init__": [[9, 28], ["torch.utils.data.dataset.Dataset.__init__", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "open().readlines", "os.path.join", "x.strip", "open().readlines", "open().readlines", "enumerate", "open", "open().readlines", "open", "open", "x.split", "open"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.__init__"], ["    ", "def", "__init__", "(", "self", ",", "split", "=", "\"1\"", ",", "train", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "train_path", "=", "osj", "(", "cs", ".", "DTD_PATH", ",", "f\"labels/train{split}.txt\"", ")", "\n", "val_path", "=", "osj", "(", "cs", ".", "DTD_PATH", ",", "f\"labels/val{split}.txt\"", ")", "\n", "test_path", "=", "osj", "(", "cs", ".", "DTD_PATH", ",", "f\"labels/test{split}.txt\"", ")", "\n", "if", "train", ":", "\n", "            ", "self", ".", "ims", "=", "open", "(", "train_path", ")", ".", "readlines", "(", ")", "+", "open", "(", "val_path", ")", ".", "readlines", "(", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "ims", "=", "open", "(", "test_path", ")", ".", "readlines", "(", ")", "\n", "\n", "", "self", ".", "full_ims", "=", "[", "osj", "(", "cs", ".", "DTD_PATH", ",", "\"images\"", ",", "x", ")", "for", "x", "in", "self", ".", "ims", "]", "\n", "\n", "pth", "=", "osj", "(", "cs", ".", "DTD_PATH", ",", "f\"labels/classes.txt\"", ")", "\n", "self", ".", "c_to_t", "=", "{", "x", ".", "strip", "(", ")", ":", "i", "for", "i", ",", "x", "in", "enumerate", "(", "open", "(", "pth", ")", ".", "readlines", "(", ")", ")", "}", "\n", "\n", "self", ".", "transform", "=", "cs", ".", "TRAIN_TRANSFORMS", "if", "train", "else", "cs", ".", "TEST_TRANSFORMS", "\n", "self", ".", "labels", "=", "[", "self", ".", "c_to_t", "[", "x", ".", "split", "(", "\"/\"", ")", "[", "0", "]", "]", "for", "x", "in", "self", ".", "ims", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.dtd.DTD.__getitem__": [[29, 33], ["PIL.Image.open", "dtd.DTD.transform", "dtd.DTD.full_ims[].strip"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "im", "=", "Image", ".", "open", "(", "self", ".", "full_ims", "[", "index", "]", ".", "strip", "(", ")", ")", "\n", "im", "=", "self", ".", "transform", "(", "im", ")", "\n", "return", "im", ",", "self", ".", "labels", "[", "index", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.dtd.DTD.__len__": [[34, 36], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "ims", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.ImageNetTransfer.__init__": [[17, 28], ["robustness.datasets.DataSet.__init__", "torch.tensor", "torch.tensor"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.__init__"], ["    ", "def", "__init__", "(", "self", ",", "data_path", ",", "**", "kwargs", ")", ":", "\n", "        ", "ds_kwargs", "=", "{", "\n", "'num_classes'", ":", "kwargs", "[", "'num_classes'", "]", ",", "\n", "'mean'", ":", "ch", ".", "tensor", "(", "kwargs", "[", "'mean'", "]", ")", ",", "\n", "'custom_class'", ":", "None", ",", "\n", "'std'", ":", "ch", ".", "tensor", "(", "kwargs", "[", "'std'", "]", ")", ",", "\n", "'transform_train'", ":", "cs", ".", "TRAIN_TRANSFORMS", ",", "\n", "'label_mapping'", ":", "None", ",", "\n", "'transform_test'", ":", "cs", ".", "TEST_TRANSFORMS", "\n", "}", "\n", "super", "(", "ImageNetTransfer", ",", "self", ")", ".", "__init__", "(", "kwargs", "[", "'name'", "]", ",", "data_path", ",", "**", "ds_kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.TransformedDataset.__init__": [[30, 33], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "ds", ",", "transform", "=", "None", ")", ":", "\n", "        ", "self", ".", "transform", "=", "transform", "\n", "self", ".", "ds", "=", "ds", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.TransformedDataset.__len__": [[34, 36], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "ds", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.TransformedDataset.__getitem__": [[37, 44], ["transfer_datasets.TransformedDataset.transform", "sample.repeat.repeat.repeat"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "sample", ",", "label", "=", "self", ".", "ds", "[", "idx", "]", "\n", "if", "self", ".", "transform", ":", "\n", "            ", "sample", "=", "self", ".", "transform", "(", "sample", ")", "\n", "if", "sample", ".", "shape", "[", "0", "]", "==", "1", ":", "\n", "                ", "sample", "=", "sample", ".", "repeat", "(", "3", ",", "1", ",", "1", ")", "\n", "", "", "return", "sample", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_pets": [[45, 49], ["transfer_datasets.ImageNetTransfer", "ImageNetTransfer.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "", "def", "make_loaders_pets", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "ImageNetTransfer", "(", "cs", ".", "PETS_PATH", ",", "num_classes", "=", "37", ",", "name", "=", "'pets'", ",", "\n", "mean", "=", "[", "0.", ",", "0.", ",", "0.", "]", ",", "std", "=", "[", "1.", ",", "1.", ",", "1.", "]", ")", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_birds": [[50, 54], ["transfer_datasets.ImageNetTransfer", "ImageNetTransfer.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "make_loaders_birds", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "ImageNetTransfer", "(", "cs", ".", "BIRDS_PATH", ",", "num_classes", "=", "500", ",", "name", "=", "'birds'", ",", "\n", "mean", "=", "[", "0.", ",", "0.", ",", "0.", "]", ",", "std", "=", "[", "1.", ",", "1.", ",", "1.", "]", ")", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_SUN": [[55, 59], ["transfer_datasets.ImageNetTransfer", "ImageNetTransfer.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "make_loaders_SUN", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "ImageNetTransfer", "(", "cs", ".", "SUN_PATH", ",", "num_classes", "=", "397", ",", "name", "=", "'SUN397'", ",", "\n", "mean", "=", "[", "0.", ",", "0.", ",", "0.", "]", ",", "std", "=", "[", "1.", ",", "1.", ",", "1.", "]", ")", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_CIFAR10": [[60, 65], ["robustness.datasets.CIFAR", "robustness.datasets.CIFAR.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "make_loaders_CIFAR10", "(", "batch_size", ",", "workers", ",", "subset", ")", ":", "\n", "    ", "ds", "=", "CIFAR", "(", "'/tmp'", ")", "\n", "ds", ".", "transform_train", "=", "cs", ".", "TRAIN_TRANSFORMS", "\n", "ds", ".", "transform_test", "=", "cs", ".", "TEST_TRANSFORMS", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ",", "subset", "=", "subset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_CIFAR100": [[66, 72], ["transfer_datasets.ImageNetTransfer", "ImageNetTransfer.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "make_loaders_CIFAR100", "(", "batch_size", ",", "workers", ",", "subset", ")", ":", "\n", "    ", "ds", "=", "ImageNetTransfer", "(", "'/tmp'", ",", "num_classes", "=", "100", ",", "name", "=", "'cifar100'", ",", "\n", "mean", "=", "[", "0.5071", ",", "0.4867", ",", "0.4408", "]", ",", "\n", "std", "=", "[", "0.2675", ",", "0.2565", ",", "0.2761", "]", ")", "\n", "ds", ".", "custom_class", "=", "CIFAR100", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ",", "subset", "=", "subset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_oxford": [[73, 78], ["transfer_datasets.ImageNetTransfer", "ImageNetTransfer.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "make_loaders_oxford", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "ImageNetTransfer", "(", "cs", ".", "FLOWERS_PATH", ",", "num_classes", "=", "102", ",", "\n", "name", "=", "'oxford_flowers'", ",", "mean", "=", "[", "0.", ",", "0.", ",", "0.", "]", ",", "\n", "std", "=", "[", "1.", ",", "1.", ",", "1.", "]", ")", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_aircraft": [[79, 84], ["transfer_datasets.ImageNetTransfer", "ImageNetTransfer.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "make_loaders_aircraft", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "ImageNetTransfer", "(", "cs", ".", "FGVC_PATH", ",", "num_classes", "=", "100", ",", "name", "=", "'aircraft'", ",", "\n", "mean", "=", "[", "0.", ",", "0.", ",", "0.", "]", ",", "std", "=", "[", "1.", ",", "1.", ",", "1.", "]", ")", "\n", "ds", ".", "custom_class", "=", "aircraft", ".", "FGVCAircraft", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_food": [[85, 91], ["food_101.FOOD101", "food_101.FOOD101.get_dataset", "food_101.FOOD101.get_dls"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.get_dataset", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.get_dls"], ["", "def", "make_loaders_food", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "food", "=", "food_101", ".", "FOOD101", "(", ")", "\n", "train_ds", ",", "valid_ds", ",", "classes", "=", "food", ".", "get_dataset", "(", ")", "\n", "train_dl", ",", "valid_dl", "=", "food", ".", "get_dls", "(", "train_ds", ",", "valid_ds", ",", "bs", "=", "batch_size", ",", "\n", "num_workers", "=", "workers", ")", "\n", "return", "101", ",", "(", "train_dl", ",", "valid_dl", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_caltech101": [[92, 113], ["caltech.Caltech101", "numpy.random.seed", "torch.manual_seed", "torch.cuda.manual_seed", "torch.cuda.manual_seed_all", "sum", "list", "torch.utils.data.Subset", "torch.utils.data.Subset", "transfer_datasets.TransformedDataset", "transfer_datasets.TransformedDataset", "numpy.arange().tolist", "set", "set", "torch.utils.data.DataLoader", "numpy.arange", "numpy.arange", "len", "numpy.arange", "len"], "function", ["None"], ["", "def", "make_loaders_caltech101", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "Caltech101", "(", "cs", ".", "CALTECH101_PATH", ",", "download", "=", "True", ")", "\n", "np", ".", "random", ".", "seed", "(", "0", ")", "\n", "ch", ".", "manual_seed", "(", "0", ")", "\n", "ch", ".", "cuda", ".", "manual_seed", "(", "0", ")", "\n", "ch", ".", "cuda", ".", "manual_seed_all", "(", "0", ")", "\n", "NUM_TRAINING_SAMPLES_PER_CLASS", "=", "30", "\n", "\n", "class_start_idx", "=", "[", "0", "]", "+", "[", "i", "for", "i", "in", "np", ".", "arange", "(", "1", ",", "len", "(", "ds", ")", ")", "if", "ds", ".", "y", "[", "i", "]", "==", "ds", ".", "y", "[", "i", "-", "1", "]", "+", "1", "]", "\n", "\n", "train_indices", "=", "sum", "(", "[", "np", ".", "arange", "(", "start_idx", ",", "start_idx", "+", "NUM_TRAINING_SAMPLES_PER_CLASS", ")", ".", "tolist", "(", ")", "for", "start_idx", "in", "class_start_idx", "]", ",", "[", "]", ")", "\n", "test_indices", "=", "list", "(", "(", "set", "(", "np", ".", "arange", "(", "1", ",", "len", "(", "ds", ")", ")", ")", "-", "set", "(", "train_indices", ")", ")", ")", "\n", "\n", "train_set", "=", "Subset", "(", "ds", ",", "train_indices", ")", "\n", "test_set", "=", "Subset", "(", "ds", ",", "test_indices", ")", "\n", "\n", "train_set", "=", "TransformedDataset", "(", "train_set", ",", "transform", "=", "cs", ".", "TRAIN_TRANSFORMS", ")", "\n", "test_set", "=", "TransformedDataset", "(", "test_set", ",", "transform", "=", "cs", ".", "TEST_TRANSFORMS", ")", "\n", "\n", "return", "101", ",", "[", "DataLoader", "(", "d", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "\n", "num_workers", "=", "workers", ")", "for", "d", "in", "(", "train_set", ",", "test_set", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_caltech256": [[115, 136], ["caltech.Caltech256", "numpy.random.seed", "torch.manual_seed", "torch.cuda.manual_seed", "torch.cuda.manual_seed_all", "sum", "list", "torch.utils.data.Subset", "torch.utils.data.Subset", "transfer_datasets.TransformedDataset", "transfer_datasets.TransformedDataset", "numpy.arange().tolist", "set", "set", "torch.utils.data.DataLoader", "numpy.arange", "numpy.arange", "len", "numpy.arange", "len"], "function", ["None"], ["", "def", "make_loaders_caltech256", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "Caltech256", "(", "cs", ".", "CALTECH256_PATH", ",", "download", "=", "True", ")", "\n", "np", ".", "random", ".", "seed", "(", "0", ")", "\n", "ch", ".", "manual_seed", "(", "0", ")", "\n", "ch", ".", "cuda", ".", "manual_seed", "(", "0", ")", "\n", "ch", ".", "cuda", ".", "manual_seed_all", "(", "0", ")", "\n", "NUM_TRAINING_SAMPLES_PER_CLASS", "=", "60", "\n", "\n", "class_start_idx", "=", "[", "0", "]", "+", "[", "i", "for", "i", "in", "np", ".", "arange", "(", "1", ",", "len", "(", "ds", ")", ")", "if", "ds", ".", "y", "[", "i", "]", "==", "ds", ".", "y", "[", "i", "-", "1", "]", "+", "1", "]", "\n", "\n", "train_indices", "=", "sum", "(", "[", "np", ".", "arange", "(", "start_idx", ",", "start_idx", "+", "NUM_TRAINING_SAMPLES_PER_CLASS", ")", ".", "tolist", "(", ")", "for", "start_idx", "in", "class_start_idx", "]", ",", "[", "]", ")", "\n", "test_indices", "=", "list", "(", "(", "set", "(", "np", ".", "arange", "(", "1", ",", "len", "(", "ds", ")", ")", ")", "-", "set", "(", "train_indices", ")", ")", ")", "\n", "\n", "train_set", "=", "Subset", "(", "ds", ",", "train_indices", ")", "\n", "test_set", "=", "Subset", "(", "ds", ",", "test_indices", ")", "\n", "\n", "train_set", "=", "TransformedDataset", "(", "train_set", ",", "transform", "=", "cs", ".", "TRAIN_TRANSFORMS", ")", "\n", "test_set", "=", "TransformedDataset", "(", "test_set", ",", "transform", "=", "cs", ".", "TEST_TRANSFORMS", ")", "\n", "\n", "return", "257", ",", "[", "DataLoader", "(", "d", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "\n", "num_workers", "=", "workers", ")", "for", "d", "in", "(", "train_set", ",", "test_set", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_dtd": [[138, 143], ["dtd.DTD", "dtd.DTD", "torch.utils.data.DataLoader"], "function", ["None"], ["", "def", "make_loaders_dtd", "(", "batch_size", ",", "workers", ")", ":", "\n", "        ", "train_set", "=", "dtd", ".", "DTD", "(", "train", "=", "True", ")", "\n", "val_set", "=", "dtd", ".", "DTD", "(", "train", "=", "False", ")", "\n", "return", "57", ",", "[", "DataLoader", "(", "ds", ",", "batch_size", "=", "batch_size", ",", "shuffle", "=", "True", ",", "\n", "num_workers", "=", "workers", ")", "for", "ds", "in", "(", "train_set", ",", "val_set", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders_cars": [[144, 148], ["transfer_datasets.ImageNetTransfer", "ImageNetTransfer.make_loaders"], "function", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders"], ["", "def", "make_loaders_cars", "(", "batch_size", ",", "workers", ")", ":", "\n", "    ", "ds", "=", "ImageNetTransfer", "(", "cs", ".", "CARS_PATH", ",", "num_classes", "=", "196", ",", "name", "=", "'stanford_cars'", ",", "\n", "mean", "=", "[", "0.", ",", "0.", ",", "0.", "]", ",", "std", "=", "[", "1.", ",", "1.", ",", "1.", "]", ")", "\n", "return", "ds", ",", "ds", ".", "make_loaders", "(", "batch_size", "=", "batch_size", ",", "workers", "=", "workers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.transfer_datasets.make_loaders": [[164, 170], ["Exception"], "function", ["None"], ["def", "make_loaders", "(", "ds", ",", "batch_size", ",", "workers", ",", "subset", ")", ":", "\n", "    ", "if", "ds", "in", "[", "'cifar10'", ",", "'cifar100'", "]", ":", "\n", "        ", "return", "DS_TO_FUNC", "[", "ds", "]", "(", "batch_size", ",", "workers", ",", "subset", ")", "\n", "\n", "", "if", "subset", ":", "raise", "Exception", "(", "f'Subset not supported for the {ds} dataset'", ")", "\n", "return", "DS_TO_FUNC", "[", "ds", "]", "(", "batch_size", ",", "workers", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.__init__": [[59, 89], ["os.path.expanduser", "os.path.join", "aircraft.find_classes", "aircraft.make_dataset", "ValueError", "ValueError", "aircraft.FGVCAircraft.download"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.find_classes", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.make_dataset", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.download"], ["def", "__init__", "(", "self", ",", "root", ",", "class_type", "=", "'variant'", ",", "train", "=", "True", ",", "transform", "=", "None", ",", "\n", "target_transform", "=", "None", ",", "loader", "=", "default_loader", ",", "download", "=", "False", ")", ":", "\n", "        ", "split", "=", "'trainval'", "if", "train", "else", "'test'", "\n", "if", "split", "not", "in", "self", ".", "splits", ":", "\n", "            ", "raise", "ValueError", "(", "'Split \"{}\" not found. Valid splits are: {}'", ".", "format", "(", "\n", "split", ",", "', '", ".", "join", "(", "self", ".", "splits", ")", ",", "\n", ")", ")", "\n", "", "if", "class_type", "not", "in", "self", ".", "class_types", ":", "\n", "            ", "raise", "ValueError", "(", "'Class type \"{}\" not found. Valid class types are: {}'", ".", "format", "(", "\n", "class_type", ",", "', '", ".", "join", "(", "self", ".", "class_types", ")", ",", "\n", ")", ")", "\n", "", "self", ".", "root", "=", "os", ".", "path", ".", "expanduser", "(", "root", ")", "\n", "self", ".", "class_type", "=", "class_type", "\n", "self", ".", "split", "=", "split", "\n", "self", ".", "classes_file", "=", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "'data'", ",", "\n", "'images_%s_%s.txt'", "%", "(", "self", ".", "class_type", ",", "self", ".", "split", ")", ")", "\n", "\n", "if", "download", ":", "\n", "            ", "self", ".", "download", "(", ")", "\n", "\n", "", "(", "image_ids", ",", "targets", ",", "classes", ",", "class_to_idx", ")", "=", "find_classes", "(", "self", ".", "classes_file", ")", "\n", "samples", "=", "make_dataset", "(", "self", ".", "root", ",", "image_ids", ",", "targets", ")", "\n", "\n", "self", ".", "transform", "=", "transform", "\n", "self", ".", "target_transform", "=", "target_transform", "\n", "self", ".", "loader", "=", "loader", "\n", "\n", "self", ".", "samples", "=", "samples", "\n", "self", ".", "classes", "=", "classes", "\n", "self", ".", "class_to_idx", "=", "class_to_idx", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.__getitem__": [[90, 107], ["aircraft.FGVCAircraft.loader", "aircraft.FGVCAircraft.transform", "aircraft.FGVCAircraft.target_transform"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "\"\"\"\n        Args:\n            index (int): Index\n\n        Returns:\n            tuple: (sample, target) where target is class_index of the target class.\n        \"\"\"", "\n", "\n", "path", ",", "target", "=", "self", ".", "samples", "[", "index", "]", "\n", "sample", "=", "self", ".", "loader", "(", "path", ")", "\n", "if", "self", ".", "transform", "is", "not", "None", ":", "\n", "            ", "sample", "=", "self", ".", "transform", "(", "sample", ")", "\n", "", "if", "self", ".", "target_transform", "is", "not", "None", ":", "\n", "            ", "target", "=", "self", ".", "target_transform", "(", "target", ")", "\n", "\n", "", "return", "sample", ",", "target", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.__len__": [[108, 110], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "samples", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.__repr__": [[111, 120], ["aircraft.FGVCAircraft.__len__", "aircraft.FGVCAircraft.transform.__repr__().replace", "aircraft.FGVCAircraft.target_transform.__repr__().replace", "aircraft.FGVCAircraft.transform.__repr__", "aircraft.FGVCAircraft.target_transform.__repr__", "len", "len"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.__len__", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.__repr__", "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.__repr__"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "fmt_str", "=", "'Dataset '", "+", "self", ".", "__class__", ".", "__name__", "+", "'\\n'", "\n", "fmt_str", "+=", "'    Number of datapoints: {}\\n'", ".", "format", "(", "self", ".", "__len__", "(", ")", ")", "\n", "fmt_str", "+=", "'    Root Location: {}\\n'", ".", "format", "(", "self", ".", "root", ")", "\n", "tmp", "=", "'    Transforms (if any): '", "\n", "fmt_str", "+=", "'{0}{1}\\n'", ".", "format", "(", "tmp", ",", "self", ".", "transform", ".", "__repr__", "(", ")", ".", "replace", "(", "'\\n'", ",", "'\\n'", "+", "' '", "*", "len", "(", "tmp", ")", ")", ")", "\n", "tmp", "=", "'    Target Transforms (if any): '", "\n", "fmt_str", "+=", "'{0}{1}'", ".", "format", "(", "tmp", ",", "self", ".", "target_transform", ".", "__repr__", "(", ")", ".", "replace", "(", "'\\n'", ",", "'\\n'", "+", "' '", "*", "len", "(", "tmp", ")", ")", ")", "\n", "return", "fmt_str", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft._check_exists": [[121, 124], ["os.path.exists", "os.path.exists", "os.path.join"], "methods", ["None"], ["", "def", "_check_exists", "(", "self", ")", ":", "\n", "        ", "return", "os", ".", "path", ".", "exists", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "'data'", ",", "'images'", ")", ")", "and", "os", ".", "path", ".", "exists", "(", "self", ".", "classes_file", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft.download": [[125, 160], ["aircraft.FGVCAircraft._check_exists", "print", "os.path.abspath", "os.path.join", "urllib.request.urlopen", "os.path.join.strip", "print", "tarfile.open", "tarfile.open.extractall", "print", "os.remove", "print", "os.path.join", "aircraft.FGVCAircraft.url.rpartition", "open", "f.write", "os.path.samefile", "print", "os.rename", "urllib.request.urlopen.read"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.FGVCAircraft._check_exists"], ["", "def", "download", "(", "self", ")", ":", "\n", "        ", "\"\"\"Download the FGVC-Aircraft data if it doesn't exist already.\"\"\"", "\n", "from", "six", ".", "moves", "import", "urllib", "\n", "import", "tarfile", "\n", "\n", "if", "self", ".", "_check_exists", "(", ")", ":", "\n", "            ", "return", "\n", "\n", "# prepare to download data to PARENT_DIR/fgvc-aircraft-2013.tar.gz", "\n", "", "print", "(", "'Downloading %s ... (may take a few minutes)'", "%", "self", ".", "url", ")", "\n", "parent_dir", "=", "os", ".", "path", ".", "abspath", "(", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "os", ".", "pardir", ")", ")", "\n", "tar_name", "=", "self", ".", "url", ".", "rpartition", "(", "'/'", ")", "[", "-", "1", "]", "\n", "tar_path", "=", "os", ".", "path", ".", "join", "(", "parent_dir", ",", "tar_name", ")", "\n", "data", "=", "urllib", ".", "request", ".", "urlopen", "(", "self", ".", "url", ")", "\n", "\n", "# download .tar.gz file", "\n", "with", "open", "(", "tar_path", ",", "'wb'", ")", "as", "f", ":", "\n", "            ", "f", ".", "write", "(", "data", ".", "read", "(", ")", ")", "\n", "\n", "# extract .tar.gz to PARENT_DIR/fgvc-aircraft-2013b", "\n", "", "data_folder", "=", "tar_path", ".", "strip", "(", "'.tar.gz'", ")", "\n", "print", "(", "'Extracting %s to %s ... (may take a few minutes)'", "%", "(", "tar_path", ",", "data_folder", ")", ")", "\n", "tar", "=", "tarfile", ".", "open", "(", "tar_path", ")", "\n", "tar", ".", "extractall", "(", "parent_dir", ")", "\n", "\n", "# if necessary, rename data folder to self.root", "\n", "if", "not", "os", ".", "path", ".", "samefile", "(", "data_folder", ",", "self", ".", "root", ")", ":", "\n", "            ", "print", "(", "'Renaming %s to %s ...'", "%", "(", "data_folder", ",", "self", ".", "root", ")", ")", "\n", "os", ".", "rename", "(", "data_folder", ",", "self", ".", "root", ")", "\n", "\n", "# delete .tar.gz file", "\n", "", "print", "(", "'Deleting %s ...'", "%", "tar_path", ")", "\n", "os", ".", "remove", "(", "tar_path", ")", "\n", "\n", "print", "(", "'Done!'", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.make_dataset": [[9, 18], ["os.path.expanduser", "range", "len", "len", "len", "images.append", "os.path.join"], "function", ["None"], ["def", "make_dataset", "(", "dir", ",", "image_ids", ",", "targets", ")", ":", "\n", "    ", "assert", "(", "len", "(", "image_ids", ")", "==", "len", "(", "targets", ")", ")", "\n", "images", "=", "[", "]", "\n", "dir", "=", "os", ".", "path", ".", "expanduser", "(", "dir", ")", "\n", "for", "i", "in", "range", "(", "len", "(", "image_ids", ")", ")", ":", "\n", "        ", "item", "=", "(", "os", ".", "path", ".", "join", "(", "dir", ",", "'data'", ",", "'images'", ",", "\n", "'%s.jpg'", "%", "image_ids", "[", "i", "]", ")", ",", "targets", "[", "i", "]", ")", "\n", "images", ".", "append", "(", "item", ")", "\n", "", "return", "images", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.aircraft.find_classes": [[20, 37], ["open", "open.close", "numpy.unique", "line.split", "image_ids.append", "targets.append", "range", "len"], "function", ["None"], ["", "def", "find_classes", "(", "classes_file", ")", ":", "\n", "# read classes file, separating out image IDs and class names", "\n", "    ", "image_ids", "=", "[", "]", "\n", "targets", "=", "[", "]", "\n", "f", "=", "open", "(", "classes_file", ",", "'r'", ")", "\n", "for", "line", "in", "f", ":", "\n", "        ", "split_line", "=", "line", ".", "split", "(", "' '", ")", "\n", "image_ids", ".", "append", "(", "split_line", "[", "0", "]", ")", "\n", "targets", ".", "append", "(", "' '", ".", "join", "(", "split_line", "[", "1", ":", "]", ")", ")", "\n", "", "f", ".", "close", "(", ")", "\n", "\n", "# index class names", "\n", "classes", "=", "np", ".", "unique", "(", "targets", ")", "\n", "class_to_idx", "=", "{", "classes", "[", "i", "]", ":", "i", "for", "i", "in", "range", "(", "len", "(", "classes", ")", ")", "}", "\n", "targets", "=", "[", "class_to_idx", "[", "c", "]", "for", "c", "in", "targets", "]", "\n", "\n", "return", "(", "image_ids", ",", "targets", ",", "classes", ",", "class_to_idx", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.__init__": [[9, 14], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "TRAIN_PATH", "=", "cs", ".", "FOOD_PATH", "+", "\"/train\"", "\n", "self", ".", "VALID_PATH", "=", "cs", ".", "FOOD_PATH", "+", "\"/valid\"", "\n", "\n", "self", ".", "train_ds", ",", "self", ".", "valid_ds", ",", "self", ".", "train_cls", ",", "self", ".", "valid_cls", "=", "[", "None", "]", "*", "4", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101._get_tfms": [[15, 19], ["None"], "methods", ["None"], ["", "def", "_get_tfms", "(", "self", ")", ":", "\n", "        ", "train_tfms", "=", "cs", ".", "TRAIN_TRANSFORMS", "\n", "valid_tfms", "=", "cs", ".", "TEST_TRANSFORMS", "\n", "return", "train_tfms", ",", "valid_tfms", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.get_dataset": [[20, 31], ["food_101.FOOD101._get_tfms", "torchvision.datasets.ImageFolder", "torchvision.datasets.ImageFolder"], "methods", ["home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101._get_tfms"], ["", "def", "get_dataset", "(", "self", ")", ":", "\n", "        ", "train_tfms", ",", "valid_tfms", "=", "self", ".", "_get_tfms", "(", ")", "# transformations", "\n", "self", ".", "train_ds", "=", "datasets", ".", "ImageFolder", "(", "root", "=", "self", ".", "TRAIN_PATH", ",", "\n", "transform", "=", "train_tfms", ")", "\n", "self", ".", "valid_ds", "=", "datasets", ".", "ImageFolder", "(", "root", "=", "self", ".", "VALID_PATH", ",", "\n", "transform", "=", "valid_tfms", ")", "\n", "self", ".", "train_classes", "=", "self", ".", "train_ds", ".", "classes", "\n", "self", ".", "valid_classes", "=", "self", ".", "valid_ds", ".", "classes", "\n", "\n", "assert", "self", ".", "train_classes", "==", "self", ".", "valid_classes", "\n", "return", "self", ".", "train_ds", ",", "self", ".", "valid_ds", ",", "self", ".", "train_classes", "\n", "\n"]], "home.repos.pwc.inspect_result.Microsoft_robust-models-transfer.utils.food_101.FOOD101.get_dls": [[32, 35], ["torch.utils.data.DataLoader", "torch.utils.data.DataLoader"], "methods", ["None"], ["", "def", "get_dls", "(", "self", ",", "train_ds", ",", "valid_ds", ",", "bs", ",", "**", "kwargs", ")", ":", "\n", "        ", "return", "(", "DataLoader", "(", "train_ds", ",", "batch_size", "=", "bs", ",", "shuffle", "=", "True", ",", "**", "kwargs", ")", ",", "\n", "DataLoader", "(", "valid_ds", ",", "batch_size", "=", "bs", ",", "shuffle", "=", "True", ",", "**", "kwargs", ")", ")", "\n", "\n"]]}