{"home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_method_trainer": [[40, 45], ["methods_lookup_dict.items", "ValueError"], "function", ["None"], ["def", "get_method_trainer", "(", "method_str", ")", ":", "\n", "    ", "for", "method", ",", "method_items", "in", "methods_lookup_dict", ".", "items", "(", ")", ":", "\n", "        ", "if", "method_str", "==", "method", ":", "\n", "            ", "return", "method_items", "[", "'trainer'", "]", "\n", "", "", "raise", "ValueError", "(", "f'Unsupported method: {method_str}. Please use one of: {methods_list_str}'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_method_config": [[47, 52], ["methods_lookup_dict.items", "ValueError"], "function", ["None"], ["", "def", "get_method_config", "(", "method_str", ")", ":", "\n", "    ", "for", "method", ",", "method_items", "in", "methods_lookup_dict", ".", "items", "(", ")", ":", "\n", "        ", "if", "method_str", "==", "method", ":", "\n", "            ", "return", "method_items", "[", "'config'", "]", "(", ")", ".", "get_config", "(", ")", "\n", "", "", "raise", "ValueError", "(", "f'Unsupported method: {method_str}. Please use one of: {methods_list_str}'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_data_config": [[54, 59], ["usr_config_lookup_dict.items", "ValueError", "DataConfig().get_config", "DataConfig"], "function", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.config.Config.get_config"], ["", "def", "get_data_config", "(", "usr_str", ")", ":", "\n", "    ", "for", "usr", ",", "DataConfig", "in", "usr_config_lookup_dict", ".", "items", "(", ")", ":", "\n", "        ", "if", "usr_str", "==", "usr", ":", "\n", "            ", "return", "DataConfig", "(", ")", ".", "get_config", "(", ")", "\n", "", "", "raise", "ValueError", "(", "f'Unsupported user: {usr_str}. Please use one of: {usr_list_str}'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_base_config": [[61, 63], ["configs.BaseConfig().get_config", "configs.BaseConfig"], "function", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.config.Config.get_config"], ["", "def", "get_base_config", "(", ")", ":", "\n", "    ", "return", "BaseConfig", "(", ")", ".", "get_config", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.merge_configs": [[65, 72], ["config.items"], "function", ["None"], ["", "def", "merge_configs", "(", "configs", ")", ":", "\n", "    ", "merged_config", "=", "{", "}", "\n", "for", "config", "in", "configs", ":", "\n", "        ", "for", "key", ",", "value", "in", "config", ".", "items", "(", ")", ":", "\n", "            ", "merged_config", "[", "key", "]", "=", "value", "\n", "\n", "", "", "return", "merged_config", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_config": [[74, 85], ["main.get_base_config", "main.get_method_config", "main.get_data_config", "main.merge_configs"], "function", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_base_config", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_method_config", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_data_config", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.merge_configs"], ["", "def", "get_config", "(", "method", ",", "usr_config", ")", ":", "\n", "    ", "base_config", "=", "get_base_config", "(", ")", "\n", "method_config", "=", "get_method_config", "(", "method", ")", "\n", "data_config", "=", "get_data_config", "(", "usr_config", ")", "\n", "\n", "# IMPORTANT: this is not intended usage, but items in later configs have priority over ", "\n", "#            items in earlier configs, basically if there are key conflicts the rightmost", "\n", "#            config in the list with the key will determine the value in the merged config", "\n", "config", "=", "merge_configs", "(", "[", "base_config", ",", "method_config", ",", "data_config", "]", ")", "\n", "\n", "return", "config", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_trainset": [[87, 140], ["ValueError", "data.BalancedfaceSingle", "data.BalancedfaceSingle", "data.Balancedface", "data.BalancedfacePair", "data.BalancedfaceMulti", "data.BalancedfaceMulti", "int", "int", "int", "int", "os.path.isfile", "ValueError", "torch.load", "opt[].lower", "opt[].lower", "open", "json.load", "enumerate", "print", "data.BalancedfaceMulti", "str", "str", "int", "sum", "ValueError", "opt[].values", "str", "race.lower"], "function", ["None"], ["", "def", "get_trainset", "(", "opt", ")", ":", "\n", "    ", "if", "opt", "[", "'experiment_name'", "]", "==", "'single_race'", ":", "\n", "        ", "if", "opt", "[", "'noise_mix'", "]", ":", "\n", "            ", "return", "BalancedfaceSingle", "(", "opt", "[", "'train_root'", "]", ",", "opt", "[", "'train_race'", "]", ",", "input_shape", "=", "opt", "[", "'input_shape'", "]", ",", "\n", "noise_mixing", "=", "opt", "[", "'noise_mix'", "]", ",", "noise", "=", "opt", "[", "'data_noise'", "]", ")", "\n", "", "return", "BalancedfaceSingle", "(", "opt", "[", "'train_root'", "]", ",", "opt", "[", "'train_race'", "]", ",", "input_shape", "=", "opt", "[", "'input_shape'", "]", ")", "\n", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'balanced_face'", ":", "\n", "        ", "return", "Balancedface", "(", "opt", "[", "'train_root'", "]", ",", "input_shape", "=", "opt", "[", "'input_shape'", "]", ")", "\n", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'race_pairs'", ":", "\n", "        ", "return", "BalancedfacePair", "(", "opt", "[", "'train_root'", "]", ",", "opt", "[", "'train_race'", "]", ",", "opt", "[", "'train_race_b'", "]", ",", "opt", "[", "'percent_primary'", "]", ")", "\n", "", "elif", "'all_races'", "in", "opt", "[", "'experiment_name'", "]", ":", "\n", "        ", "file_name", "=", "opt", "[", "'identities_per_race_path'", "]", "+", "'_'", ".", "join", "(", "[", "str", "(", "opt", "[", "'num_classes'", "]", ")", ",", "str", "(", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth.tar'", "\n", "if", "'baseline'", "in", "opt", "[", "'experiment_name'", "]", "or", "opt", "[", "'num_classes'", "]", "==", "10000", "or", "opt", "[", "'num_classes'", "]", "==", "4000", ":", "\n", "            ", "opt", "[", "'identities_per_race'", "]", "=", "{", "\n", "'african'", ":", "int", "(", "opt", "[", "'num_classes'", "]", "/", "4", ")", ",", "\n", "'asian'", ":", "int", "(", "opt", "[", "'num_classes'", "]", "/", "4", ")", ",", "\n", "'caucasian'", ":", "int", "(", "opt", "[", "'num_classes'", "]", "/", "4", ")", ",", "\n", "'indian'", ":", "int", "(", "opt", "[", "'num_classes'", "]", "/", "4", ")", "\n", "}", "\n", "", "elif", "not", "os", ".", "path", ".", "isfile", "(", "file_name", ")", ":", "\n", "            ", "raise", "ValueError", "(", "f'Unsupported experiment, no identities_per_race found: {opt[\"identities_per_race_path\"]}'", ")", "\n", "", "else", ":", "\n", "            ", "opt", "[", "'identities_per_race'", "]", "=", "torch", ".", "load", "(", "file_name", ")", "\n", "", "return", "BalancedfaceMulti", "(", "opt", "[", "'train_root'", "]", ",", "opt", "[", "'identities_per_race'", "]", ")", "\n", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'images_vs_identities'", ":", "\n", "        ", "opt", "[", "'identities_per_race'", "]", "=", "{", "\n", "'african'", ":", "2500", ",", "\n", "'asian'", ":", "2500", ",", "\n", "'caucasian'", ":", "2500", ",", "\n", "'indian'", ":", "2500", "\n", "}", "\n", "opt", "[", "'identities_per_race'", "]", "[", "opt", "[", "'experiment_race'", "]", ".", "lower", "(", ")", "]", "+=", "(", "opt", "[", "'num_classes'", "]", "-", "10000", ")", "\n", "opt", "[", "'images_per_identity'", "]", "=", "{", "\n", "'african'", ":", "10", ",", "\n", "'asian'", ":", "10", ",", "\n", "'caucasian'", ":", "10", ",", "\n", "'indian'", ":", "10", "\n", "}", "\n", "opt", "[", "'images_per_identity'", "]", "[", "opt", "[", "'experiment_race'", "]", ".", "lower", "(", ")", "]", "+=", "(", "opt", "[", "'num_extra_images'", "]", ")", "\n", "return", "BalancedfaceMulti", "(", "opt", "[", "'train_root'", "]", ",", "opt", "[", "'identities_per_race'", "]", ",", "images_per_identity", "=", "opt", "[", "'images_per_identity'", "]", ")", "\n", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'race_simplex'", ":", "\n", "        ", "with", "open", "(", "opt", "[", "'simplex_file_path'", "]", ",", "'r'", ")", "as", "json_file", ":", "\n", "            ", "json_obj", "=", "json", ".", "load", "(", "json_file", ")", "\n", "races", "=", "json_obj", "[", "'order'", "]", "\n", "cur_simplex_point", "=", "json_obj", "[", "'distributions'", "]", "[", "str", "(", "opt", "[", "'simplex_max'", "]", ")", "]", "[", "opt", "[", "'simplex_point_id'", "]", "]", "\n", "opt", "[", "'identities_per_race'", "]", "=", "{", "}", "\n", "for", "i", ",", "race", "in", "enumerate", "(", "races", ")", ":", "\n", "                ", "opt", "[", "'identities_per_race'", "]", "[", "race", ".", "lower", "(", ")", "]", "=", "int", "(", "cur_simplex_point", "[", "i", "]", ")", "\n", "", "print", "(", "'identities_per_race'", ",", "opt", "[", "'identities_per_race'", "]", ")", "\n", "if", "sum", "(", "opt", "[", "'identities_per_race'", "]", ".", "values", "(", ")", ")", "!=", "opt", "[", "'num_classes'", "]", ":", "\n", "                ", "raise", "ValueError", "(", "f'Something really bad, check code'", ")", "\n", "", "return", "BalancedfaceMulti", "(", "opt", "[", "'train_root'", "]", ",", "opt", "[", "'identities_per_race'", "]", ")", "\n", "", "", "raise", "ValueError", "(", "f'Unsupported experiment: {opt[\"experiment_name\"]}'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.get_testset": [[142, 144], ["data.RFW"], "function", ["None"], ["", "def", "get_testset", "(", "opt", ")", ":", "\n", "    ", "return", "RFW", "(", "opt", "[", "'test_root'", "]", ",", "opt", "[", "'test_race'", "]", ",", "input_shape", "=", "opt", "[", "'input_shape'", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.compute_weighted_neighbors": [[146, 209], ["enumerate", "numpy.array", "numpy.array", "time.time", "print", "range", "print", "print", "print", "numpy.array", "numpy.argmax", "numpy.array", "print", "print", "print", "numpy.zeros", "enumerate", "numpy.arange", "numpy.random.choice", "last_idxs.append", "features_samples.extend", "np.array.extend", "numpy.concatenate", "numpy.array", "range", "race_weights_list.append", "numpy.array", "print", "features_map.values", "str", "numpy.argpartition", "len", "features_map.keys", "time.time"], "function", ["None"], ["", "def", "compute_weighted_neighbors", "(", "test_features", ")", ":", "\n", "    ", "SAMPLES_PER_RACE", "=", "1000", "\n", "NUM_NEIGHBORS", "=", "20", "\n", "\n", "num_images", "=", "0", "\n", "features_samples", "=", "[", "]", "\n", "features_races", "=", "[", "]", "\n", "last_idxs", "=", "[", "]", "\n", "for", "index", ",", "features_map", "in", "enumerate", "(", "test_features", ")", ":", "\n", "        ", "features_array", "=", "np", ".", "zeros", "(", "(", "len", "(", "features_map", ".", "keys", "(", ")", ")", ",", "512", ")", ")", "\n", "for", "i", ",", "features", "in", "enumerate", "(", "features_map", ".", "values", "(", ")", ")", ":", "\n", "            ", "features_array", "[", "i", "]", "=", "features", "\n", "\n", "", "potential_indices", "=", "np", ".", "arange", "(", "features_array", ".", "shape", "[", "0", "]", ")", "\n", "indices", "=", "np", ".", "random", ".", "choice", "(", "potential_indices", ",", "SAMPLES_PER_RACE", ",", "replace", "=", "False", ")", "\n", "features_sample", "=", "features_array", "[", "indices", "]", "\n", "\n", "num_images", "+=", "features_sample", ".", "shape", "[", "0", "]", "\n", "last_idxs", ".", "append", "(", "num_images", ")", "\n", "features_samples", ".", "extend", "(", "features_sample", ")", "\n", "\n", "features_races", ".", "extend", "(", "[", "index", "]", "*", "SAMPLES_PER_RACE", ")", "\n", "\n", "", "features_matrix", "=", "np", ".", "array", "(", "features_samples", ")", "\n", "features_races", "=", "np", ".", "array", "(", "features_races", ")", "\n", "\n", "start_time", "=", "time", ".", "time", "(", ")", "\n", "d", "=", "features_matrix", "@", "features_matrix", ".", "T", "\n", "norm", "=", "(", "features_matrix", "*", "features_matrix", ")", ".", "sum", "(", "1", ",", "keepdims", "=", "True", ")", "**", ".5", "\n", "distances_matrix", "=", "1", "-", "d", "/", "norm", "/", "norm", ".", "T", "\n", "print", "(", "'Distances matrix computed in {} seconds'", ".", "format", "(", "str", "(", "time", ".", "time", "(", ")", "-", "start_time", ")", ")", ")", "\n", "\n", "race_weights_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "distances_matrix", ".", "shape", "[", "0", "]", ")", ":", "\n", "        ", "row_without_self", "=", "np", ".", "concatenate", "(", "(", "distances_matrix", "[", "i", ",", ":", "i", "]", ",", "distances_matrix", "[", "i", ",", "i", "+", "1", ":", "]", ")", ")", "\n", "nearest_neighbors", "=", "np", ".", "argpartition", "(", "row_without_self", ",", "NUM_NEIGHBORS", ")", "[", ":", "NUM_NEIGHBORS", "]", "\n", "race_votes", "=", "features_races", "[", "nearest_neighbors", "]", "\n", "vote_weights", "=", "1", "-", "row_without_self", "[", "nearest_neighbors", "]", "\n", "race_weights", "=", "np", ".", "array", "(", "[", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", "]", ")", "\n", "for", "j", "in", "range", "(", "NUM_NEIGHBORS", ")", ":", "\n", "            ", "race_weights", "[", "race_votes", "[", "j", "]", "]", "+=", "vote_weights", "[", "j", "]", "\n", "", "race_weights_list", ".", "append", "(", "race_weights", ")", "\n", "\n", "", "print", "(", "'----------'", ")", "\n", "print", "(", "'Cluster membership by race'", ")", "\n", "print", "(", "'African Asian Caucasian Indian'", ")", "\n", "race_weights_matrix", "=", "np", ".", "array", "(", "race_weights_list", ")", "\n", "race_clusters", "=", "np", ".", "argmax", "(", "race_weights_matrix", ",", "axis", "=", "1", ")", "\n", "first_idx", "=", "0", "\n", "all_cluster_counts", "=", "np", ".", "array", "(", "[", "0", ",", "0", ",", "0", ",", "0", "]", ")", "\n", "for", "last_idx", "in", "last_idxs", ":", "\n", "        ", "clusters", "=", "race_clusters", "[", "first_idx", ":", "last_idx", "]", "\n", "race_cluster_counts", "=", "np", ".", "array", "(", "[", "0", ",", "0", ",", "0", ",", "0", "]", ")", "\n", "for", "cluster", "in", "clusters", ":", "\n", "            ", "race_cluster_counts", "[", "cluster", "]", "+=", "1", "\n", "", "print", "(", "race_cluster_counts", ")", "\n", "all_cluster_counts", "+=", "race_cluster_counts", "\n", "first_idx", "=", "last_idx", "\n", "", "print", "(", "all_cluster_counts", ")", "\n", "print", "(", "'----------'", ")", "\n", "print", "(", "'\\n'", ")", "\n", "\n", "return", "all_cluster_counts", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.None.main.save_new_distribution": [[211, 234], ["print", "opt[].items", "print", "torch.save", "int", "os.path.isdir", "os.makedirs", "os.path.join", "weighted_race_neighbors.sum", "races.index", "str", "str"], "function", ["None"], ["", "def", "save_new_distribution", "(", "opt", ",", "weighted_race_neighbors", ")", ":", "\n", "    ", "print", "(", "opt", "[", "'identities_per_race'", "]", ")", "\n", "races", "=", "[", "'african'", ",", "'asian'", ",", "'caucasian'", ",", "'indian'", "]", "\n", "budget", "=", "opt", "[", "'step_size'", "]", "\n", "\n", "persons_to_add_list", "=", "weighted_race_neighbors", "/", "weighted_race_neighbors", ".", "sum", "(", ")", "*", "budget", "\n", "persons_added", "=", "0", "\n", "counter", "=", "0", "\n", "new_images_per_race", "=", "{", "}", "\n", "for", "race", ",", "cur_num_persons", "in", "opt", "[", "'identities_per_race'", "]", ".", "items", "(", ")", ":", "\n", "        ", "persons_to_add", "=", "int", "(", "persons_to_add_list", "[", "races", ".", "index", "(", "race", ")", "]", ")", "\n", "if", "persons_added", "+", "persons_to_add", ">", "budget", ":", "\n", "            ", "persons_to_add", "-=", "1", "\n", "", "elif", "counter", "==", "3", "and", "persons_added", "+", "persons_to_add", "<", "budget", ":", "\n", "            ", "persons_to_add", "+=", "(", "budget", "-", "(", "persons_added", "+", "persons_to_add", ")", ")", "\n", "", "new_images_per_race", "[", "race", "]", "=", "cur_num_persons", "+", "persons_to_add", "\n", "persons_added", "+=", "persons_to_add", "\n", "counter", "+=", "1", "\n", "\n", "", "print", "(", "new_images_per_race", ")", "\n", "if", "not", "os", ".", "path", ".", "isdir", "(", "opt", "[", "'identities_per_race_path'", "]", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "opt", "[", "'identities_per_race_path'", "]", ")", "\n", "", "torch", ".", "save", "(", "new_images_per_race", ",", "os", ".", "path", ".", "join", "(", "opt", "[", "'identities_per_race_path'", "]", ",", "'_'", ".", "join", "(", "[", "str", "(", "opt", "[", "'num_classes'", "]", "+", "persons_added", ")", ",", "str", "(", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth.tar'", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.arcface_trainer.ArcfaceTrainer.__init__": [[12, 36], ["trainer.Trainer.__init__", "arcface_trainer.ArcfaceTrainer.metric_fc.cuda", "torch.nn.DataParallel", "torch.optim.lr_scheduler.StepLR", "arcface_trainer.ArcfaceTrainer.load_model", "models.AddMarginProduct", "torch.optim.SGD", "torch.optim.Adam", "models.ArcMarginProduct", "models.SphereProduct", "torch.nn.Linear", "arcface_trainer.ArcfaceTrainer.model.parameters", "arcface_trainer.ArcfaceTrainer.metric_fc.parameters", "arcface_trainer.ArcfaceTrainer.model.parameters", "arcface_trainer.ArcfaceTrainer.metric_fc.parameters"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.load_model"], ["    ", "def", "__init__", "(", "self", ",", "opt", ",", "*", "args", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "ArcfaceTrainer", ",", "self", ")", ".", "__init__", "(", "opt", ",", "*", "args", ",", "**", "kwargs", ")", "\n", "\n", "if", "opt", "[", "'metric'", "]", "==", "'add_margin'", ":", "\n", "            ", "self", ".", "metric_fc", "=", "AddMarginProduct", "(", "512", ",", "opt", "[", "'num_classes'", "]", ",", "s", "=", "30", ",", "m", "=", "0.35", ")", "\n", "", "elif", "opt", "[", "'metric'", "]", "==", "'arc_margin'", ":", "\n", "            ", "self", ".", "metric_fc", "=", "ArcMarginProduct", "(", "512", ",", "opt", "[", "'num_classes'", "]", ",", "s", "=", "30", ",", "m", "=", "0.5", ",", "easy_margin", "=", "opt", "[", "'easy_margin'", "]", ")", "\n", "", "elif", "opt", "[", "'metric'", "]", "==", "'sphere'", ":", "\n", "            ", "self", ".", "metric_fc", "=", "SphereProduct", "(", "512", ",", "opt", "[", "'num_classes'", "]", ",", "m", "=", "4", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "metric_fc", "=", "Linear", "(", "512", ",", "opt", "[", "'num_classes'", "]", ")", "\n", "\n", "", "self", ".", "metric_fc", ".", "cuda", "(", ")", "\n", "self", ".", "metric_fc", "=", "DataParallel", "(", "self", ".", "metric_fc", ")", "\n", "\n", "if", "opt", "[", "'optimizer'", "]", "==", "'sgd'", ":", "\n", "            ", "self", ".", "optimizer", "=", "torch", ".", "optim", ".", "SGD", "(", "[", "{", "'params'", ":", "self", ".", "model", ".", "parameters", "(", ")", "}", ",", "{", "'params'", ":", "self", ".", "metric_fc", ".", "parameters", "(", ")", "}", "]", ",", "\n", "lr", "=", "opt", "[", "'lr'", "]", ",", "weight_decay", "=", "opt", "[", "'weight_decay'", "]", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "optimizer", "=", "torch", ".", "optim", ".", "Adam", "(", "[", "{", "'params'", ":", "self", ".", "model", ".", "parameters", "(", ")", "}", ",", "{", "'params'", ":", "self", ".", "metric_fc", ".", "parameters", "(", ")", "}", "]", ",", "\n", "lr", "=", "opt", "[", "'lr'", "]", ",", "weight_decay", "=", "opt", "[", "'weight_decay'", "]", ")", "\n", "", "self", ".", "scheduler", "=", "StepLR", "(", "self", ".", "optimizer", ",", "step_size", "=", "opt", "[", "'lr_step'", "]", ",", "gamma", "=", "0.1", ")", "\n", "\n", "self", ".", "load_model", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.arcface_trainer.ArcfaceTrainer.train_iteration": [[38, 70], ["arcface_trainer.ArcfaceTrainer.model.train", "time.time", "enumerate", "arcface_trainer.ArcfaceTrainer.scheduler.step", "torch.cuda.empty_cache", "images.cuda.cuda.cuda", "label.data.cpu().numpy.data.cpu().numpy.cuda().long", "arcface_trainer.ArcfaceTrainer.model", "arcface_trainer.ArcfaceTrainer.metric_fc", "arcface_trainer.ArcfaceTrainer.criterion", "arcface_trainer.ArcfaceTrainer.optimizer.zero_grad", "arcface_trainer.ArcfaceTrainer.backward", "arcface_trainer.ArcfaceTrainer.optimizer.step", "numpy.argmax.data.cpu().numpy", "numpy.argmax", "label.data.cpu().numpy.data.cpu().numpy.data.cpu().numpy", "numpy.mean", "print", "time.time", "label.data.cpu().numpy.data.cpu().numpy.cuda", "len", "numpy.argmax.data.cpu", "label.data.cpu().numpy.data.cpu().numpy.data.cpu", "time.time", "arcface_trainer.ArcfaceTrainer.item", "len"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.train"], ["", "def", "train_iteration", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "self", ".", "model", ".", "train", "(", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "for", "ii", ",", "batch", "in", "enumerate", "(", "self", ".", "train_loader", ")", ":", "\n", "            ", "images", ",", "label", "=", "batch", "\n", "images", "=", "images", ".", "cuda", "(", ")", "\n", "label", "=", "label", ".", "cuda", "(", ")", ".", "long", "(", ")", "\n", "feature", "=", "self", ".", "model", "(", "images", ")", "\n", "output", "=", "self", ".", "metric_fc", "(", "feature", ",", "label", ")", "\n", "\n", "loss", "=", "self", ".", "criterion", "(", "output", ",", "label", ")", "\n", "self", ".", "optimizer", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optimizer", ".", "step", "(", ")", "\n", "\n", "iters", "=", "epoch", "*", "len", "(", "self", ".", "train_loader", ")", "+", "ii", "\n", "\n", "if", "iters", "%", "self", ".", "opt", "[", "'print_freq'", "]", "==", "0", ":", "\n", "                ", "output", "=", "output", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "output", "=", "np", ".", "argmax", "(", "output", ",", "axis", "=", "1", ")", "\n", "label", "=", "label", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "acc", "=", "np", ".", "mean", "(", "(", "output", "==", "label", ")", ".", "astype", "(", "int", ")", ")", "\n", "speed", "=", "self", ".", "opt", "[", "'print_freq'", "]", "/", "(", "time", ".", "time", "(", ")", "-", "start", ")", "\n", "minutes_remaining", "=", "(", "len", "(", "self", ".", "train_loader", ")", "*", "self", ".", "max_epoch", "-", "iters", ")", "/", "speed", "/", "60", "\n", "print", "(", "f'train epoch {epoch} iter {ii} {speed} iters/s loss {loss.item()} acc {acc}; estimated {minutes_remaining} minutes remaining'", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "\n", "", "", "self", ".", "scheduler", ".", "step", "(", ")", "\n", "\n", "torch", ".", "cuda", ".", "empty_cache", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.__init__": [[13, 39], ["trainer.Trainer.model.cuda", "torch.nn.DataParallel", "random.seed", "models.FocalLoss", "torch.nn.CrossEntropyLoss", "models.resnet_face18", "models.resnet_face50", "models.senet50_scratch_dag"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.resnet_face18", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.resnet_face50", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.vggface2.senet50_scratch_dag"], ["    ", "def", "__init__", "(", "self", ",", "opt", ",", "train_loader", ",", "test_loader", ",", "pair_list", ")", ":", "\n", "\n", "        ", "self", ".", "opt", "=", "opt", "\n", "self", ".", "train_loader", "=", "train_loader", "\n", "self", ".", "test_loader", "=", "test_loader", "\n", "self", ".", "pair_list", "=", "pair_list", "\n", "\n", "if", "opt", "[", "'loss'", "]", "==", "'focal_loss'", ":", "\n", "            ", "self", ".", "criterion", "=", "FocalLoss", "(", "gamma", "=", "2", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "criterion", "=", "torch", ".", "nn", ".", "CrossEntropyLoss", "(", ")", "\n", "\n", "", "if", "opt", "[", "'backbone'", "]", "==", "'resnet18'", ":", "\n", "            ", "self", ".", "model", "=", "resnet_face18", "(", "opt", "[", "'num_classes'", "]", ",", "opt", "[", "'save_center'", "]", ",", "use_se", "=", "opt", "[", "'use_se'", "]", ")", "\n", "", "elif", "opt", "[", "'backbone'", "]", "==", "'resnet50'", ":", "\n", "            ", "self", ".", "model", "=", "resnet_face50", "(", "opt", "[", "'num_classes'", "]", ",", "opt", "[", "'save_center'", "]", ",", "use_se", "=", "opt", "[", "'use_se'", "]", ")", "\n", "", "elif", "opt", "[", "'backbone'", "]", "==", "'senet50'", ":", "\n", "            ", "self", ".", "model", "=", "senet50_scratch_dag", "(", ")", "\n", "\n", "", "self", ".", "model", ".", "cuda", "(", ")", "\n", "self", ".", "model", "=", "DataParallel", "(", "self", ".", "model", ")", "\n", "\n", "self", ".", "epoch", "=", "0", "\n", "self", ".", "max_epoch", "=", "opt", "[", "'max_epoch'", "]", "\n", "\n", "random", ".", "seed", "(", "42", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.load_model": [[41, 69], ["os.path.join", "os.path.isfile", "print", "torch.load", "trainer.Trainer.model.load_state_dict", "trainer.Trainer.optimizer.load_state_dict", "trainer.Trainer.metric_fc.load_state_dict", "trainer.Trainer.scheduler.load_state_dict", "str", "str", "str", "str", "str", "str", "str", "str", "str", "str", "str", "str", "str", "str"], "methods", ["None"], ["", "def", "load_model", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "opt", "[", "'experiment_name'", "]", "==", "'single_race'", ":", "\n", "            ", "if", "self", ".", "opt", "[", "'noise_mix'", "]", ":", "\n", "                ", "checkpoint_file", "=", "'_'", ".", "join", "(", "[", "self", ".", "opt", "[", "'train_race'", "]", ",", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'data_noise'", "]", ")", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "+", "'.pth'", "]", ")", "\n", "", "else", ":", "\n", "                ", "checkpoint_file", "=", "'_'", ".", "join", "(", "[", "self", ".", "opt", "[", "'train_race'", "]", ",", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "+", "'.pth'", "]", ")", "\n", "", "", "elif", "self", ".", "opt", "[", "'experiment_name'", "]", "==", "'balanced_face'", ":", "\n", "            ", "checkpoint_file", "=", "'_'", ".", "join", "(", "[", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "+", "'.pth'", "]", ")", "\n", "", "elif", "self", ".", "opt", "[", "'experiment_name'", "]", "==", "'race_pairs'", ":", "\n", "            ", "checkpoint_file", "=", "'_'", ".", "join", "(", "[", "self", ".", "opt", "[", "'train_race'", "]", ",", "self", ".", "opt", "[", "'train_race_b'", "]", ",", "str", "(", "self", ".", "opt", "[", "'percent_primary'", "]", ")", ",", "\n", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "+", "'.pth'", "]", ")", "\n", "", "elif", "'all_races'", "in", "self", ".", "opt", "[", "'experiment_name'", "]", ":", "\n", "            ", "checkpoint_file", "=", "'_'", ".", "join", "(", "[", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'num_classes'", "]", ")", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "+", "'.pth'", "]", ")", "\n", "", "elif", "self", ".", "opt", "[", "'experiment_name'", "]", "==", "'images_vs_identities'", ":", "\n", "            ", "checkpoint_file", "=", "'_'", ".", "join", "(", "[", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'num_classes'", "]", ")", ",", "self", ".", "opt", "[", "'experiment_race'", "]", ",", "\n", "str", "(", "self", ".", "opt", "[", "'num_extra_images'", "]", ")", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "+", "'.pth'", "]", ")", "\n", "", "elif", "self", ".", "opt", "[", "'experiment_name'", "]", "==", "'race_simplex'", ":", "\n", "            ", "checkpoint_file", "=", "'_'", ".", "join", "(", "[", "str", "(", "self", ".", "opt", "[", "'simplex_max'", "]", ")", ",", "str", "(", "self", ".", "opt", "[", "'simplex_point_id'", "]", ")", ",", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "+", "'.pth'", "]", ")", "\n", "\n", "", "checkpointPath", "=", "os", ".", "path", ".", "join", "(", "self", ".", "opt", "[", "'checkpoints_path'", "]", ",", "self", ".", "opt", "[", "'experiment_name'", "]", ",", "self", ".", "opt", "[", "'method'", "]", ",", "checkpoint_file", ")", "\n", "if", "os", ".", "path", ".", "isfile", "(", "checkpointPath", ")", ":", "\n", "            ", "print", "(", "f'Loading from checkpoint: {checkpointPath}'", ")", "\n", "checkpoint", "=", "torch", ".", "load", "(", "checkpointPath", ")", "\n", "self", ".", "model", ".", "load_state_dict", "(", "checkpoint", "[", "'model_state_dict'", "]", ")", "\n", "self", ".", "optimizer", ".", "load_state_dict", "(", "checkpoint", "[", "'optimizer_state_dict'", "]", ")", "\n", "self", ".", "epoch", "=", "checkpoint", "[", "'epoch'", "]", "\n", "self", ".", "metric_fc", ".", "load_state_dict", "(", "checkpoint", "[", "'metric_fc_state_dict'", "]", ")", "\n", "self", ".", "scheduler", ".", "load_state_dict", "(", "checkpoint", "[", "'scheduler_state_dict'", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.train_iteration": [[71, 73], ["None"], "methods", ["None"], ["", "", "def", "train_iteration", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.train": [[75, 88], ["range", "trainer.Trainer.save_model", "trainer.Trainer.train_iteration", "trainer.Trainer.save_model", "trainer.Trainer.model.eval", "trainer.Trainer.evaluate", "print"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.save_model", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.vggface2_trainer.VggFace2Trainer.train_iteration", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.save_model", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.evaluate"], ["", "def", "train", "(", "self", ")", ":", "\n", "        ", "for", "epoch", "in", "range", "(", "self", ".", "epoch", ",", "self", ".", "max_epoch", ")", ":", "\n", "            ", "self", ".", "train_iteration", "(", "epoch", ")", "\n", "\n", "if", "epoch", "%", "self", ".", "opt", "[", "'save_interval'", "]", "==", "0", ":", "\n", "                ", "self", ".", "save_model", "(", "epoch", ")", "\n", "\n", "", "if", "self", ".", "opt", "[", "'eval_each_epoch'", "]", ":", "\n", "                ", "self", ".", "model", ".", "eval", "(", ")", "\n", "_", ",", "acc", "=", "self", ".", "evaluate", "(", ")", "\n", "print", "(", "'test acc: {}'", ".", "format", "(", "acc", ")", ")", "\n", "\n", "", "", "self", ".", "save_model", "(", "self", ".", "max_epoch", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.validate": [[90, 116], ["trainer.Trainer.model.eval", "time.time", "torch.no_grad", "enumerate", "images.cuda.cuda.cuda", "label.data.cpu().numpy.data.cpu().numpy.cuda().long", "trainer.Trainer.model", "trainer.Trainer.metric_fc", "numpy.argmax.data.cpu().numpy", "numpy.argmax", "label.data.cpu().numpy.data.cpu().numpy.data.cpu().numpy", "numpy.mean", "accs.append", "torch.cuda.empty_cache", "numpy.array().mean", "print", "time.time", "label.data.cpu().numpy.data.cpu().numpy.cuda", "numpy.argmax.data.cpu", "label.data.cpu().numpy.data.cpu().numpy.data.cpu", "time.time", "numpy.array"], "methods", ["None"], ["", "def", "validate", "(", "self", ",", "data_loader", ")", ":", "\n", "        ", "self", ".", "model", ".", "eval", "(", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "accs", "=", "[", "]", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "for", "ii", ",", "batch", "in", "enumerate", "(", "data_loader", ")", ":", "\n", "                ", "images", ",", "label", "=", "batch", "\n", "images", "=", "images", ".", "cuda", "(", ")", "\n", "label", "=", "label", ".", "cuda", "(", ")", ".", "long", "(", ")", "\n", "feature", "=", "self", ".", "model", "(", "images", ")", "\n", "output", "=", "self", ".", "metric_fc", "(", "feature", ",", "label", ")", "\n", "\n", "output", "=", "output", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "output", "=", "np", ".", "argmax", "(", "output", ",", "axis", "=", "1", ")", "\n", "label", "=", "label", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "acc", "=", "np", ".", "mean", "(", "(", "output", "==", "label", ")", ".", "astype", "(", "int", ")", ")", "\n", "accs", ".", "append", "(", "acc", ")", "\n", "if", "ii", "%", "self", ".", "opt", "[", "'print_freq'", "]", "==", "0", ":", "\n", "                    ", "speed", "=", "self", ".", "opt", "[", "'print_freq'", "]", "/", "(", "time", ".", "time", "(", ")", "-", "start", ")", "\n", "mean_accuracy", "=", "np", ".", "array", "(", "accs", ")", ".", "mean", "(", ")", "\n", "print", "(", "f'validate iter {ii} {speed} iters/s acc {mean_accuracy}'", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "\n", "", "torch", ".", "cuda", ".", "empty_cache", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.cosine_metric": [[118, 120], ["numpy.dot", "numpy.linalg.norm", "numpy.linalg.norm"], "methods", ["None"], ["", "", "", "def", "cosine_metric", "(", "self", ",", "x1", ",", "x2", ")", ":", "\n", "        ", "return", "np", ".", "dot", "(", "x1", ",", "x2", ")", "/", "(", "np", ".", "linalg", ".", "norm", "(", "x1", ")", "*", "np", ".", "linalg", ".", "norm", "(", "x2", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.calc_threshold": [[122, 137], ["numpy.asarray", "numpy.asarray", "range", "print", "len", "numpy.mean", "str", "str"], "methods", ["None"], ["", "def", "calc_threshold", "(", "self", ",", "y_score", ",", "y_true", ")", ":", "\n", "        ", "y_score", "=", "np", ".", "asarray", "(", "y_score", ")", "\n", "y_true", "=", "np", ".", "asarray", "(", "y_true", ")", "\n", "best_acc", "=", "0", "\n", "best_th", "=", "0", "\n", "for", "i", "in", "range", "(", "len", "(", "y_score", ")", ")", ":", "\n", "            ", "th", "=", "y_score", "[", "i", "]", "\n", "y_test", "=", "(", "y_score", ">=", "th", ")", "\n", "acc", "=", "np", ".", "mean", "(", "(", "y_test", "==", "y_true", ")", ".", "astype", "(", "int", ")", ")", "\n", "if", "acc", ">", "best_acc", ":", "\n", "                ", "best_acc", "=", "acc", "\n", "best_th", "=", "th", "\n", "\n", "", "", "print", "(", "'best acc, best threshold'", ",", "str", "(", "best_acc", ")", ",", "str", "(", "best_th", ")", ")", "\n", "return", "best_th", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.get_pairwise_similarities": [[139, 151], ["trainer.Trainer.cosine_metric", "sims.append", "labels.append"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.cosine_metric"], ["", "def", "get_pairwise_similarities", "(", "self", ",", "features_dict", ")", ":", "\n", "        ", "sims", "=", "[", "]", "\n", "labels", "=", "[", "]", "\n", "for", "pair", "in", "self", ".", "pair_list", ":", "\n", "            ", "features1", "=", "features_dict", "[", "pair", "[", "0", "]", "]", "\n", "features2", "=", "features_dict", "[", "pair", "[", "1", "]", "]", "\n", "label", "=", "pair", "[", "2", "]", "\n", "sim", "=", "self", ".", "cosine_metric", "(", "features1", ",", "features2", ")", "\n", "\n", "sims", ".", "append", "(", "sim", ")", "\n", "labels", ".", "append", "(", "label", ")", "\n", "", "return", "sims", ",", "labels", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.calc_accuracy": [[153, 157], ["numpy.mean", "numpy.asarray", "numpy.asarray"], "methods", ["None"], ["", "def", "calc_accuracy", "(", "self", ",", "pairwise_similarities", ",", "pair_labels", ",", "threshold", ")", ":", "\n", "        ", "predictions", "=", "(", "np", ".", "asarray", "(", "pairwise_similarities", ")", ">=", "threshold", ")", "\n", "accuracy", "=", "np", ".", "mean", "(", "(", "predictions", "==", "np", ".", "asarray", "(", "pair_labels", ")", ")", ".", "astype", "(", "int", ")", ")", "\n", "return", "accuracy", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.compute_accuracy_from_folds": [[159, 185], ["list", "random.shuffle", "numpy.asarray", "numpy.asarray", "range", "numpy.mean", "range", "pairwise_similarities[].tolist", "pair_labels[].tolist", "trainer.Trainer.calc_threshold", "trainer.Trainer.calc_accuracy", "accuracies.append", "len", "range", "train_pairwise_similarities.extend", "train_pair_labels.extend", "pairwise_similarities[].tolist", "pair_labels[].tolist"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.calc_threshold", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.calc_accuracy"], ["", "def", "compute_accuracy_from_folds", "(", "self", ",", "pairwise_similarities", ",", "pair_labels", ")", ":", "\n", "        ", "idxs", "=", "list", "(", "range", "(", "len", "(", "pair_labels", ")", ")", ")", "\n", "random", ".", "shuffle", "(", "idxs", ")", "\n", "partitions", "=", "[", "idxs", "[", "i", ":", ":", "10", "]", "for", "i", "in", "range", "(", "10", ")", "]", "\n", "\n", "pairwise_similarities", "=", "np", ".", "asarray", "(", "pairwise_similarities", ")", "\n", "pair_labels", "=", "np", ".", "asarray", "(", "pair_labels", ")", "\n", "\n", "accuracies", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "10", ")", ":", "\n", "            ", "train_pairwise_similarities", "=", "[", "]", "\n", "train_pair_labels", "=", "[", "]", "\n", "train_partitions", "=", "partitions", "[", ":", "i", "]", "+", "partitions", "[", "i", "+", "1", ":", "]", "\n", "for", "partition", "in", "train_partitions", ":", "\n", "                ", "train_pairwise_similarities", ".", "extend", "(", "pairwise_similarities", "[", "partition", "]", ".", "tolist", "(", ")", ")", "\n", "train_pair_labels", ".", "extend", "(", "pair_labels", "[", "partition", "]", ".", "tolist", "(", ")", ")", "\n", "\n", "", "val_partition", "=", "partitions", "[", "i", "]", "\n", "val_pairwise_similarities", "=", "pairwise_similarities", "[", "val_partition", "]", ".", "tolist", "(", ")", "\n", "val_pair_labels", "=", "pair_labels", "[", "val_partition", "]", ".", "tolist", "(", ")", "\n", "\n", "threshold", "=", "self", ".", "calc_threshold", "(", "train_pairwise_similarities", ",", "train_pair_labels", ")", "\n", "accuracy", "=", "self", ".", "calc_accuracy", "(", "val_pairwise_similarities", ",", "val_pair_labels", ",", "threshold", ")", "\n", "accuracies", ".", "append", "(", "accuracy", ")", "\n", "\n", "", "return", "np", ".", "mean", "(", "accuracies", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.make_features_dict": [[187, 192], ["enumerate"], "methods", ["None"], ["", "def", "make_features_dict", "(", "self", ",", "identities", ",", "features", ")", ":", "\n", "        ", "features_dict", "=", "{", "}", "\n", "for", "i", ",", "img_iden", "in", "enumerate", "(", "identities", ")", ":", "\n", "            ", "features_dict", "[", "img_iden", "]", "=", "features", "[", "i", "]", "\n", "", "return", "features_dict", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.get_features": [[194, 217], ["trainer.Trainer.model.eval", "torch.no_grad", "img_idens.extend", "img.cuda.cuda.cuda", "trainer.Trainer.model", "feature.data.cpu().numpy.data.cpu().numpy.data.cpu().numpy", "len", "torch.cuda.empty_cache", "list", "numpy.vstack", "feature.data.cpu().numpy.data.cpu().numpy.data.cpu"], "methods", ["None"], ["", "def", "get_features", "(", "self", ",", "data_loader", ")", ":", "\n", "        ", "self", ".", "model", ".", "eval", "(", ")", "\n", "features", "=", "None", "\n", "img_idens", "=", "[", "]", "\n", "cnt", "=", "0", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "for", "batch", "in", "data_loader", ":", "\n", "                ", "img", ",", "img_iden", "=", "batch", "\n", "img_idens", ".", "extend", "(", "list", "(", "img_iden", ")", ")", "\n", "img", "=", "img", ".", "cuda", "(", ")", "\n", "feature", "=", "self", ".", "model", "(", "img", ")", "\n", "feature", "=", "feature", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "features", "is", "None", ":", "\n", "                    ", "features", "=", "feature", "\n", "", "else", ":", "\n", "                    ", "features", "=", "np", ".", "vstack", "(", "(", "features", ",", "feature", ")", ")", "\n", "\n", "", "cnt", "+=", "len", "(", "batch", ")", "\n", "\n", "torch", ".", "cuda", ".", "empty_cache", "(", ")", "\n", "\n", "", "", "return", "features", ",", "img_idens", ",", "cnt", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.get_features_dict": [[219, 227], ["time.time", "trainer.Trainer.get_features", "print", "print", "trainer.Trainer.make_features_dict", "time.time"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.get_features", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.make_features_dict"], ["", "def", "get_features_dict", "(", "self", ")", ":", "\n", "        ", "start_time", "=", "time", ".", "time", "(", ")", "\n", "features", ",", "identities", ",", "count", "=", "self", ".", "get_features", "(", "self", ".", "test_loader", ")", "\n", "print", "(", "features", ".", "shape", ")", "\n", "elapsed_time", "=", "time", ".", "time", "(", ")", "-", "start_time", "\n", "print", "(", "'total time to get all test features is {}, average time is {}'", ".", "format", "(", "elapsed_time", ",", "elapsed_time", "/", "count", ")", ")", "\n", "features_dict", "=", "self", ".", "make_features_dict", "(", "identities", ",", "features", ")", "\n", "return", "features_dict", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.evaluate": [[229, 235], ["trainer.Trainer.get_features_dict", "trainer.Trainer.get_pairwise_similarities", "trainer.Trainer.compute_accuracy_from_folds", "print"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.get_features_dict", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.get_pairwise_similarities", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.compute_accuracy_from_folds"], ["", "def", "evaluate", "(", "self", ")", ":", "\n", "        ", "features_dict", "=", "self", ".", "get_features_dict", "(", ")", "\n", "pairwise_similarities", ",", "pair_labels", "=", "self", ".", "get_pairwise_similarities", "(", "features_dict", ")", "\n", "accuracy", "=", "self", ".", "compute_accuracy_from_folds", "(", "pairwise_similarities", ",", "pair_labels", ")", "\n", "print", "(", "'test verification accuracy: '", ",", "accuracy", ")", "\n", "return", "features_dict", ",", "accuracy", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.save_model": [[237, 267], ["torch.save", "os.path.isdir", "os.makedirs", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "trainer.Trainer.model.state_dict", "trainer.Trainer.optimizer.state_dict", "trainer.Trainer.scheduler.state_dict", "trainer.Trainer.metric_fc.state_dict", "os.path.join", "os.path.join", "os.path.join", "str", "str", "str", "str", "os.path.join", "str", "str", "str", "str", "str", "str", "str", "str", "str", "str"], "methods", ["None"], ["", "def", "save_model", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "opt", "=", "self", ".", "opt", "\n", "\n", "if", "not", "os", ".", "path", ".", "isdir", "(", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ")", ")", ":", "\n", "            ", "os", ".", "makedirs", "(", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ")", ")", "\n", "\n", "", "if", "opt", "[", "'experiment_name'", "]", "==", "'single_race'", ":", "\n", "            ", "if", "opt", "[", "'noise_mix'", "]", ":", "\n", "                ", "save_name", "=", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ",", "'_'", ".", "join", "(", "[", "opt", "[", "'train_race'", "]", ",", "opt", "[", "'backbone'", "]", ",", "str", "(", "opt", "[", "'data_noise'", "]", ")", ",", "str", "(", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth'", ")", "\n", "", "else", ":", "\n", "                ", "save_name", "=", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ",", "'_'", ".", "join", "(", "[", "opt", "[", "'train_race'", "]", ",", "opt", "[", "'backbone'", "]", ",", "str", "(", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth'", ")", "\n", "", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'balanced_face'", ":", "\n", "            ", "save_name", "=", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ",", "'_'", ".", "join", "(", "[", "opt", "[", "'backbone'", "]", ",", "str", "(", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth'", ")", "\n", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'race_pairs'", ":", "\n", "            ", "save_name", "=", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ",", "'_'", ".", "join", "(", "[", "opt", "[", "'train_race'", "]", ",", "opt", "[", "'train_race_b'", "]", ",", "str", "(", "opt", "[", "'percent_primary'", "]", ")", ",", "opt", "[", "'backbone'", "]", ",", "str", "(", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth'", ")", "\n", "", "elif", "'all_races'", "in", "self", ".", "opt", "[", "'experiment_name'", "]", ":", "\n", "            ", "save_name", "=", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ",", "'_'", ".", "join", "(", "[", "opt", "[", "'backbone'", "]", ",", "str", "(", "opt", "[", "'num_classes'", "]", ")", ",", "str", "(", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth'", ")", "\n", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'images_vs_identities'", ":", "\n", "            ", "save_name", "=", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ",", "'_'", ".", "join", "(", "[", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'num_classes'", "]", ")", ",", "self", ".", "opt", "[", "'experiment_race'", "]", ",", "\n", "str", "(", "self", ".", "opt", "[", "'num_extra_images'", "]", ")", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth'", ")", "\n", "", "elif", "opt", "[", "'experiment_name'", "]", "==", "'race_simplex'", ":", "\n", "            ", "save_name", "=", "os", ".", "path", ".", "join", "(", "opt", "[", "'checkpoints_path'", "]", ",", "opt", "[", "'experiment_name'", "]", ",", "opt", "[", "'method'", "]", ",", "'_'", ".", "join", "(", "[", "str", "(", "self", ".", "opt", "[", "'simplex_max'", "]", ")", ",", "str", "(", "self", ".", "opt", "[", "'simplex_point_id'", "]", ")", ",", "self", ".", "opt", "[", "'backbone'", "]", ",", "str", "(", "self", ".", "opt", "[", "'trial_num'", "]", ")", "]", ")", "+", "'.pth'", ")", "\n", "", "torch", ".", "save", "(", "{", "\n", "'epoch'", ":", "epoch", "+", "1", ",", "\n", "'trial_num'", ":", "opt", "[", "'trial_num'", "]", ",", "\n", "'model_state_dict'", ":", "self", ".", "model", ".", "state_dict", "(", ")", ",", "\n", "'optimizer_state_dict'", ":", "self", ".", "optimizer", ".", "state_dict", "(", ")", ",", "\n", "'scheduler_state_dict'", ":", "self", ".", "scheduler", ".", "state_dict", "(", ")", ",", "\n", "'metric_fc_state_dict'", ":", "self", ".", "metric_fc", ".", "state_dict", "(", ")", "\n", "}", ",", "save_name", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.centerloss_trainer.CenterlossTrainer.__init__": [[12, 27], ["trainer.Trainer.__init__", "torch.optim.lr_scheduler.StepLR", "torch.nn.Linear", "centerloss_trainer.CenterlossTrainer.metric_fc.cuda", "torch.nn.DataParallel", "centerloss_trainer.CenterlossTrainer.load_model", "torch.optim.SGD", "torch.optim.Adam", "centerloss_trainer.CenterlossTrainer.model.parameters", "centerloss_trainer.CenterlossTrainer.model.parameters"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.load_model"], ["    ", "def", "__init__", "(", "self", ",", "opt", ",", "*", "args", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "CenterlossTrainer", ",", "self", ")", ".", "__init__", "(", "opt", ",", "*", "args", ",", "**", "kwargs", ")", "\n", "\n", "if", "opt", "[", "'optimizer'", "]", "==", "'sgd'", ":", "\n", "            ", "self", ".", "optimizer", "=", "torch", ".", "optim", ".", "SGD", "(", "self", ".", "model", ".", "parameters", "(", ")", ",", "\n", "lr", "=", "opt", "[", "'lr'", "]", ",", "weight_decay", "=", "opt", "[", "'weight_decay'", "]", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "optimizer", "=", "torch", ".", "optim", ".", "Adam", "(", "self", ".", "model", ".", "parameters", "(", ")", ",", "\n", "lr", "=", "opt", "[", "'lr'", "]", ",", "weight_decay", "=", "opt", "[", "'weight_decay'", "]", ")", "\n", "\n", "", "self", ".", "scheduler", "=", "StepLR", "(", "self", ".", "optimizer", ",", "step_size", "=", "opt", "[", "'lr_step'", "]", ",", "gamma", "=", "0.1", ")", "\n", "self", ".", "metric_fc", "=", "Linear", "(", "512", ",", "opt", "[", "'num_classes'", "]", ")", "\n", "self", ".", "metric_fc", ".", "cuda", "(", ")", "\n", "self", ".", "metric_fc", "=", "DataParallel", "(", "self", ".", "metric_fc", ")", "\n", "self", ".", "load_model", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.centerloss_trainer.CenterlossTrainer.train_iteration": [[29, 68], ["centerloss_trainer.CenterlossTrainer.model.train", "time.time", "enumerate", "centerloss_trainer.CenterlossTrainer.scheduler.step", "images.cuda.cuda.cuda", "targets.cuda().long.cuda().long.cuda().long", "centerloss_trainer.CenterlossTrainer.model", "centerloss_trainer.CenterlossTrainer.metric_fc", "centerloss_trainer.CenterlossTrainer.criterion", "models.compute_center_loss", "models.get_center_delta", "centerloss_trainer.CenterlossTrainer.optimizer.zero_grad", "loss.backward", "centerloss_trainer.CenterlossTrainer.optimizer.step", "numpy.argmax.data.cpu().numpy", "numpy.argmax", "targets.cuda().long.cuda().long.data.cpu().numpy", "numpy.mean", "print", "time.time", "targets.cuda().long.cuda().long.cuda", "len", "numpy.argmax.data.cpu", "targets.cuda().long.cuda().long.data.cpu", "time.time", "loss.item", "len"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.train", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.center_loss.compute_center_loss", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.center_loss.get_center_delta"], ["", "def", "train_iteration", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "self", ".", "model", ".", "train", "(", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "for", "ii", ",", "batch", "in", "enumerate", "(", "self", ".", "train_loader", ")", ":", "\n", "            ", "images", ",", "targets", "=", "batch", "\n", "images", "=", "images", ".", "cuda", "(", ")", "\n", "targets", "=", "targets", ".", "cuda", "(", ")", ".", "long", "(", ")", "\n", "centers", "=", "self", ".", "model", ".", "module", ".", "centers", "\n", "\n", "features", "=", "self", ".", "model", "(", "images", ")", "\n", "output", "=", "self", ".", "metric_fc", "(", "features", ")", "\n", "\n", "cross_entropy_loss", "=", "self", ".", "criterion", "(", "output", ",", "targets", ")", "\n", "center_loss", "=", "compute_center_loss", "(", "features", ",", "centers", ",", "targets", ")", "\n", "loss", "=", "self", ".", "opt", "[", "'lda'", "]", "*", "center_loss", "+", "cross_entropy_loss", "\n", "\n", "center_deltas", "=", "get_center_delta", "(", "\n", "features", ".", "data", ",", "centers", ",", "targets", ",", "self", ".", "opt", "[", "'alpha'", "]", ")", "\n", "self", ".", "model", ".", "module", ".", "centers", "=", "centers", "-", "center_deltas", "\n", "\n", "self", ".", "optimizer", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optimizer", ".", "step", "(", ")", "\n", "\n", "iters", "=", "epoch", "*", "len", "(", "self", ".", "train_loader", ")", "+", "ii", "\n", "\n", "if", "iters", "%", "self", ".", "opt", "[", "'print_freq'", "]", "==", "0", ":", "\n", "                ", "output", "=", "output", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "output", "=", "np", ".", "argmax", "(", "output", ",", "axis", "=", "1", ")", "\n", "label", "=", "targets", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "acc", "=", "np", ".", "mean", "(", "(", "output", "==", "label", ")", ".", "astype", "(", "int", ")", ")", "\n", "speed", "=", "self", ".", "opt", "[", "'print_freq'", "]", "/", "(", "time", ".", "time", "(", ")", "-", "start", ")", "\n", "minutes_remaining", "=", "(", "len", "(", "self", ".", "train_loader", ")", "*", "self", ".", "max_epoch", "-", "iters", ")", "/", "speed", "/", "60", "\n", "print", "(", "f'train epoch {epoch} iter {ii} {speed} iters/s loss {loss.item()} acc {acc}; estimated {minutes_remaining} minutes remaining'", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "\n", "", "", "self", ".", "scheduler", ".", "step", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.vggface2_trainer.VggFace2Trainer.__init__": [[11, 29], ["trainer.Trainer.__init__", "torch.nn.Linear", "vggface2_trainer.VggFace2Trainer.metric_fc.cuda", "torch.nn.DataParallel", "torch.optim.lr_scheduler.StepLR", "vggface2_trainer.VggFace2Trainer.load_model", "torch.optim.SGD", "torch.optim.Adam", "vggface2_trainer.VggFace2Trainer.model.parameters", "vggface2_trainer.VggFace2Trainer.metric_fc.parameters", "vggface2_trainer.VggFace2Trainer.model.parameters", "vggface2_trainer.VggFace2Trainer.metric_fc.parameters"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.load_model"], ["    ", "def", "__init__", "(", "self", ",", "opt", ",", "*", "args", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "VggFace2Trainer", ",", "self", ")", ".", "__init__", "(", "opt", ",", "*", "args", ",", "**", "kwargs", ")", "\n", "\n", "\n", "self", ".", "metric_fc", "=", "Linear", "(", "2048", ",", "opt", "[", "'num_classes'", "]", ")", "\n", "\n", "self", ".", "metric_fc", ".", "cuda", "(", ")", "\n", "self", ".", "metric_fc", "=", "DataParallel", "(", "self", ".", "metric_fc", ")", "\n", "\n", "if", "opt", "[", "'optimizer'", "]", "==", "'sgd'", ":", "\n", "            ", "self", ".", "optimizer", "=", "torch", ".", "optim", ".", "SGD", "(", "[", "{", "'params'", ":", "self", ".", "model", ".", "parameters", "(", ")", "}", ",", "{", "'params'", ":", "self", ".", "metric_fc", ".", "parameters", "(", ")", "}", "]", ",", "\n", "lr", "=", "opt", "[", "'lr'", "]", ",", "weight_decay", "=", "opt", "[", "'weight_decay'", "]", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "optimizer", "=", "torch", ".", "optim", ".", "Adam", "(", "[", "{", "'params'", ":", "self", ".", "model", ".", "parameters", "(", ")", "}", ",", "{", "'params'", ":", "self", ".", "metric_fc", ".", "parameters", "(", ")", "}", "]", ",", "\n", "lr", "=", "opt", "[", "'lr'", "]", ",", "weight_decay", "=", "opt", "[", "'weight_decay'", "]", ")", "\n", "", "self", ".", "scheduler", "=", "StepLR", "(", "self", ".", "optimizer", ",", "step_size", "=", "opt", "[", "'lr_step'", "]", ",", "gamma", "=", "0.1", ")", "\n", "\n", "self", ".", "load_model", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.vggface2_trainer.VggFace2Trainer.train_iteration": [[31, 61], ["vggface2_trainer.VggFace2Trainer.model.train", "time.time", "enumerate", "vggface2_trainer.VggFace2Trainer.scheduler.step", "images.cuda.cuda.cuda", "label.data.cpu().numpy.data.cpu().numpy.cuda().long", "vggface2_trainer.VggFace2Trainer.model", "vggface2_trainer.VggFace2Trainer.metric_fc", "vggface2_trainer.VggFace2Trainer.criterion", "vggface2_trainer.VggFace2Trainer.optimizer.zero_grad", "vggface2_trainer.VggFace2Trainer.backward", "vggface2_trainer.VggFace2Trainer.optimizer.step", "numpy.argmax.data.cpu().numpy", "numpy.argmax", "label.data.cpu().numpy.data.cpu().numpy.data.cpu().numpy", "numpy.mean", "print", "time.time", "label.data.cpu().numpy.data.cpu().numpy.cuda", "len", "numpy.argmax.data.cpu", "label.data.cpu().numpy.data.cpu().numpy.data.cpu", "time.time", "vggface2_trainer.VggFace2Trainer.item", "len"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.trainers.trainer.Trainer.train"], ["", "def", "train_iteration", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "self", ".", "model", ".", "train", "(", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "for", "ii", ",", "batch", "in", "enumerate", "(", "self", ".", "train_loader", ")", ":", "\n", "            ", "images", ",", "label", "=", "batch", "\n", "images", "=", "images", ".", "cuda", "(", ")", "\n", "label", "=", "label", ".", "cuda", "(", ")", ".", "long", "(", ")", "\n", "feature", "=", "self", ".", "model", "(", "images", ")", "\n", "output", "=", "self", ".", "metric_fc", "(", "feature", ")", "\n", "\n", "loss", "=", "self", ".", "criterion", "(", "output", ",", "label", ")", "\n", "self", ".", "optimizer", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optimizer", ".", "step", "(", ")", "\n", "\n", "iters", "=", "epoch", "*", "len", "(", "self", ".", "train_loader", ")", "+", "ii", "\n", "\n", "if", "iters", "%", "self", ".", "opt", "[", "'print_freq'", "]", "==", "0", ":", "\n", "                ", "output", "=", "output", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "output", "=", "np", ".", "argmax", "(", "output", ",", "axis", "=", "1", ")", "\n", "label", "=", "label", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "acc", "=", "np", ".", "mean", "(", "(", "output", "==", "label", ")", ".", "astype", "(", "int", ")", ")", "\n", "speed", "=", "self", ".", "opt", "[", "'print_freq'", "]", "/", "(", "time", ".", "time", "(", ")", "-", "start", ")", "\n", "minutes_remaining", "=", "(", "len", "(", "self", ".", "train_loader", ")", "*", "self", ".", "max_epoch", "-", "iters", ")", "/", "speed", "/", "60", "\n", "print", "(", "f'train epoch {epoch} iter {ii} {speed} iters/s loss {loss.item()} acc {acc}; estimated {minutes_remaining} minutes remaining'", ")", "\n", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "\n", "", "", "self", ".", "scheduler", ".", "step", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round": [[4, 19], ["print", "enumerate", "numpy.array", "print", "np.array.append", "sum", "numpy.argmax", "numpy.array"], "function", ["None"], ["def", "scale_5k_and_round", "(", "point", ")", ":", "\n", "    ", "temp_point", "=", "(", "5000", "*", "np", ".", "array", "(", "point", ")", "/", "100", ")", ".", "tolist", "(", ")", "\n", "print", "(", "temp_point", ")", "\n", "remainder_point", "=", "[", "]", "\n", "for", "i", ",", "entry", "in", "enumerate", "(", "temp_point", ")", ":", "\n", "        ", "temp_point", "[", "i", "]", "=", "entry", "//", "1", "\n", "remainder", "=", "entry", "-", "temp_point", "[", "i", "]", "\n", "remainder_point", ".", "append", "(", "remainder", ")", "\n", "", "remainder_point", "=", "np", ".", "array", "(", "remainder_point", ")", "\n", "while", "sum", "(", "temp_point", ")", "<", "5000", ":", "\n", "        ", "add_idx", "=", "np", ".", "argmax", "(", "remainder_point", ")", "\n", "remainder_point", "[", "add_idx", "]", "=", "0.0", "\n", "temp_point", "[", "add_idx", "]", "+=", "1", "\n", "", "print", "(", "temp_point", ")", "\n", "return", "temp_point", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.list_of_points": [[21, 79], ["make_points_config.scale_5k_and_round", "points.append", "range", "make_points_config.scale_5k_and_round", "points.append", "make_points_config.scale_5k_and_round", "points.append", "make_points_config.scale_5k_and_round", "points.append", "make_points_config.scale_5k_and_round", "points.append", "make_points_config.scale_5k_and_round", "points.append", "make_points_config.scale_5k_and_round", "points.append", "make_points_config.scale_5k_and_round", "points.append"], "function", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.scripts.make_points_config.scale_5k_and_round"], ["", "def", "list_of_points", "(", "high", ")", ":", "\n", "\n", "    ", "low", "=", "(", "100", "-", "high", ")", "/", "3.0", "\n", "\n", "p25", "=", "(", "high", "-", "low", ")", "/", "4.0", "+", "low", "\n", "p50", "=", "(", "high", "-", "low", ")", "/", "2.0", "+", "low", "\n", "p75", "=", "high", "-", "(", "high", "-", "low", ")", "/", "4.0", "\n", "\n", "points", "=", "[", "]", "\n", "\n", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "-", "1", "]", "=", "high", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "for", "i", "in", "range", "(", "3", ")", ":", "\n", "        ", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "i", "]", "=", "p25", "\n", "p", "[", "-", "1", "]", "=", "p75", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "i", "]", "=", "p50", "\n", "p", "[", "-", "1", "]", "=", "p50", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "i", "]", "=", "p75", "\n", "p", "[", "-", "1", "]", "=", "p25", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "i", "]", "=", "high", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "i", "]", "=", "p75", "\n", "p", "[", "(", "i", "+", "1", ")", "%", "3", "]", "=", "p25", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "i", "]", "=", "p50", "\n", "p", "[", "(", "i", "+", "1", ")", "%", "3", "]", "=", "p50", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "p", "=", "[", "low", "]", "*", "4", "\n", "p", "[", "i", "]", "=", "p25", "\n", "p", "[", "(", "i", "+", "1", ")", "%", "3", "]", "=", "p75", "\n", "p", "=", "scale_5k_and_round", "(", "p", ")", "\n", "points", ".", "append", "(", "p", ")", "\n", "\n", "", "return", "points", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.center_loss.compute_center_loss": [[3, 9], ["features.view.view", "torch.nn.MSELoss", "torch.nn.MSELoss.", "features.view.size"], "function", ["None"], ["def", "compute_center_loss", "(", "features", ",", "centers", ",", "targets", ")", ":", "\n", "    ", "features", "=", "features", ".", "view", "(", "features", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "target_centers", "=", "centers", "[", "targets", "]", "\n", "criterion", "=", "torch", ".", "nn", ".", "MSELoss", "(", ")", "\n", "center_loss", "=", "criterion", "(", "features", ",", "target_centers", ")", "\n", "return", "center_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.center_loss.get_center_delta": [[11, 42], ["features.view.view", "torch.sort", "torch.unique", "uni_targets.cuda.cuda", "indices.cuda.cuda", "torch.zeros().cuda().index_add_", "targets.repeat().view", "uni_targets.cuda.unsqueeze().repeat", "torch.sum().float().unsqueeze", "torch.zeros_like", "features.view.size", "targets.cpu", "uni_targets.cuda.size", "targets.size", "torch.zeros().cuda", "targets.repeat", "uni_targets.cuda.unsqueeze", "torch.sum().float", "torch.zeros", "torch.sum", "uni_targets.cuda.size", "torch.zeros().cuda().index_add_.size"], "function", ["None"], ["", "def", "get_center_delta", "(", "features", ",", "centers", ",", "targets", ",", "alpha", ")", ":", "\n", "# implementation equation (4) in the center-loss paper", "\n", "    ", "features", "=", "features", ".", "view", "(", "features", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "targets", ",", "indices", "=", "torch", ".", "sort", "(", "targets", ")", "\n", "target_centers", "=", "centers", "[", "targets", "]", "\n", "features", "=", "features", "[", "indices", "]", "\n", "\n", "delta_centers", "=", "target_centers", "-", "features", "\n", "uni_targets", ",", "indices", "=", "torch", ".", "unique", "(", "\n", "targets", ".", "cpu", "(", ")", ",", "sorted", "=", "True", ",", "return_inverse", "=", "True", ")", "\n", "\n", "uni_targets", "=", "uni_targets", ".", "cuda", "(", ")", "\n", "indices", "=", "indices", ".", "cuda", "(", ")", "\n", "\n", "delta_centers", "=", "torch", ".", "zeros", "(", "\n", "uni_targets", ".", "size", "(", "0", ")", ",", "delta_centers", ".", "size", "(", "1", ")", "\n", ")", ".", "cuda", "(", ")", ".", "index_add_", "(", "0", ",", "indices", ",", "delta_centers", ")", "\n", "\n", "targets_repeat_num", "=", "uni_targets", ".", "size", "(", ")", "[", "0", "]", "\n", "uni_targets_repeat_num", "=", "targets", ".", "size", "(", ")", "[", "0", "]", "\n", "targets_repeat", "=", "targets", ".", "repeat", "(", "\n", "targets_repeat_num", ")", ".", "view", "(", "targets_repeat_num", ",", "-", "1", ")", "\n", "uni_targets_repeat", "=", "uni_targets", ".", "unsqueeze", "(", "1", ")", ".", "repeat", "(", "\n", "1", ",", "uni_targets_repeat_num", ")", "\n", "same_class_feature_count", "=", "torch", ".", "sum", "(", "\n", "targets_repeat", "==", "uni_targets_repeat", ",", "dim", "=", "1", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "1", ")", "\n", "\n", "delta_centers", "=", "delta_centers", "/", "(", "same_class_feature_count", "+", "1.0", ")", "*", "alpha", "\n", "result", "=", "torch", ".", "zeros_like", "(", "centers", ")", "\n", "result", "[", "uni_targets", ",", ":", "]", "=", "delta_centers", "\n", "return", "result", "\n", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.vggface2.ResNet50ScratchDAG.__init__": [[9, 171], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "ResNet50ScratchDAG", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "meta", "=", "{", "'mean'", ":", "[", "131.0912", ",", "103.8827", ",", "91.4953", "]", ",", "\n", "'std'", ":", "[", "1", ",", "1", ",", "1", "]", ",", "\n", "'imageSize'", ":", "[", "224", ",", "224", ",", "3", "]", "}", "\n", "self", ".", "conv1_7x7_s2", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "[", "7", ",", "7", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "padding", "=", "(", "3", ",", "3", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv1_7x7_s2_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv1_relu_7x7_s2", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "pool1_3x3_s2", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "[", "2", ",", "2", "]", ",", "padding", "=", "(", "0", ",", "0", ")", ",", "dilation", "=", "1", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "conv2_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_1_3x3", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "256", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_2_3x3", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "256", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_3_3x3", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "256", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_1_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "256", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_2_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_3_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_4_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_4_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_4_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_4_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_4_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_4_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_4_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_4_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_4_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_1_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "512", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_2_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_3_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_4_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_4_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_4_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_4_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_4_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_4_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_4_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_4_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_4_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_5_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_5_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_5_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_5_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_5_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_5_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_5_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_5_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_5_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_6_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_6_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_6_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_6_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_6_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_6_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_6_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_6_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_6_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_1_3x3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "512", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "1024", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "2048", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_2_3x3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "512", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "2048", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3_3x3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "512", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3x_gloal_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.vggface2.ResNet50ScratchDAG.forward": [[172, 348], ["vggface2.ResNet50ScratchDAG.conv1_7x7_s2", "vggface2.ResNet50ScratchDAG.conv1_7x7_s2_bn", "vggface2.ResNet50ScratchDAG.conv1_relu_7x7_s2", "vggface2.ResNet50ScratchDAG.pool1_3x3_s2", "vggface2.ResNet50ScratchDAG.conv2_1_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv2_1_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv2_1_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv2_1_3x3", "vggface2.ResNet50ScratchDAG.conv2_1_3x3_bn", "vggface2.ResNet50ScratchDAG.conv2_1_3x3_relu", "vggface2.ResNet50ScratchDAG.conv2_1_1x1_increase", "vggface2.ResNet50ScratchDAG.conv2_1_1x1_increase_bn", "vggface2.ResNet50ScratchDAG.conv2_1_1x1_proj", "vggface2.ResNet50ScratchDAG.conv2_1_1x1_proj_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv2_1_relu", "vggface2.ResNet50ScratchDAG.conv2_2_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv2_2_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv2_2_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv2_2_3x3", "vggface2.ResNet50ScratchDAG.conv2_2_3x3_bn", "vggface2.ResNet50ScratchDAG.conv2_2_3x3_relu", "vggface2.ResNet50ScratchDAG.conv2_2_1x1_increase", "vggface2.ResNet50ScratchDAG.conv2_2_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv2_2_relu", "vggface2.ResNet50ScratchDAG.conv2_3_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv2_3_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv2_3_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv2_3_3x3", "vggface2.ResNet50ScratchDAG.conv2_3_3x3_bn", "vggface2.ResNet50ScratchDAG.conv2_3_3x3_relu", "vggface2.ResNet50ScratchDAG.conv2_3_1x1_increase", "vggface2.ResNet50ScratchDAG.conv2_3_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv2_3_relu", "vggface2.ResNet50ScratchDAG.conv3_1_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv3_1_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv3_1_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv3_1_3x3", "vggface2.ResNet50ScratchDAG.conv3_1_3x3_bn", "vggface2.ResNet50ScratchDAG.conv3_1_3x3_relu", "vggface2.ResNet50ScratchDAG.conv3_1_1x1_increase", "vggface2.ResNet50ScratchDAG.conv3_1_1x1_increase_bn", "vggface2.ResNet50ScratchDAG.conv3_1_1x1_proj", "vggface2.ResNet50ScratchDAG.conv3_1_1x1_proj_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv3_1_relu", "vggface2.ResNet50ScratchDAG.conv3_2_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv3_2_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv3_2_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv3_2_3x3", "vggface2.ResNet50ScratchDAG.conv3_2_3x3_bn", "vggface2.ResNet50ScratchDAG.conv3_2_3x3_relu", "vggface2.ResNet50ScratchDAG.conv3_2_1x1_increase", "vggface2.ResNet50ScratchDAG.conv3_2_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv3_2_relu", "vggface2.ResNet50ScratchDAG.conv3_3_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv3_3_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv3_3_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv3_3_3x3", "vggface2.ResNet50ScratchDAG.conv3_3_3x3_bn", "vggface2.ResNet50ScratchDAG.conv3_3_3x3_relu", "vggface2.ResNet50ScratchDAG.conv3_3_1x1_increase", "vggface2.ResNet50ScratchDAG.conv3_3_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv3_3_relu", "vggface2.ResNet50ScratchDAG.conv3_4_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv3_4_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv3_4_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv3_4_3x3", "vggface2.ResNet50ScratchDAG.conv3_4_3x3_bn", "vggface2.ResNet50ScratchDAG.conv3_4_3x3_relu", "vggface2.ResNet50ScratchDAG.conv3_4_1x1_increase", "vggface2.ResNet50ScratchDAG.conv3_4_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv3_4_relu", "vggface2.ResNet50ScratchDAG.conv4_1_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv4_1_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv4_1_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv4_1_3x3", "vggface2.ResNet50ScratchDAG.conv4_1_3x3_bn", "vggface2.ResNet50ScratchDAG.conv4_1_3x3_relu", "vggface2.ResNet50ScratchDAG.conv4_1_1x1_increase", "vggface2.ResNet50ScratchDAG.conv4_1_1x1_increase_bn", "vggface2.ResNet50ScratchDAG.conv4_1_1x1_proj", "vggface2.ResNet50ScratchDAG.conv4_1_1x1_proj_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv4_1_relu", "vggface2.ResNet50ScratchDAG.conv4_2_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv4_2_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv4_2_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv4_2_3x3", "vggface2.ResNet50ScratchDAG.conv4_2_3x3_bn", "vggface2.ResNet50ScratchDAG.conv4_2_3x3_relu", "vggface2.ResNet50ScratchDAG.conv4_2_1x1_increase", "vggface2.ResNet50ScratchDAG.conv4_2_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv4_2_relu", "vggface2.ResNet50ScratchDAG.conv4_3_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv4_3_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv4_3_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv4_3_3x3", "vggface2.ResNet50ScratchDAG.conv4_3_3x3_bn", "vggface2.ResNet50ScratchDAG.conv4_3_3x3_relu", "vggface2.ResNet50ScratchDAG.conv4_3_1x1_increase", "vggface2.ResNet50ScratchDAG.conv4_3_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv4_3_relu", "vggface2.ResNet50ScratchDAG.conv4_4_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv4_4_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv4_4_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv4_4_3x3", "vggface2.ResNet50ScratchDAG.conv4_4_3x3_bn", "vggface2.ResNet50ScratchDAG.conv4_4_3x3_relu", "vggface2.ResNet50ScratchDAG.conv4_4_1x1_increase", "vggface2.ResNet50ScratchDAG.conv4_4_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv4_4_relu", "vggface2.ResNet50ScratchDAG.conv4_5_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv4_5_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv4_5_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv4_5_3x3", "vggface2.ResNet50ScratchDAG.conv4_5_3x3_bn", "vggface2.ResNet50ScratchDAG.conv4_5_3x3_relu", "vggface2.ResNet50ScratchDAG.conv4_5_1x1_increase", "vggface2.ResNet50ScratchDAG.conv4_5_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv4_5_relu", "vggface2.ResNet50ScratchDAG.conv4_6_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv4_6_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv4_6_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv4_6_3x3", "vggface2.ResNet50ScratchDAG.conv4_6_3x3_bn", "vggface2.ResNet50ScratchDAG.conv4_6_3x3_relu", "vggface2.ResNet50ScratchDAG.conv4_6_1x1_increase", "vggface2.ResNet50ScratchDAG.conv4_6_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv4_6_relu", "vggface2.ResNet50ScratchDAG.conv5_1_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv5_1_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv5_1_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv5_1_3x3", "vggface2.ResNet50ScratchDAG.conv5_1_3x3_bn", "vggface2.ResNet50ScratchDAG.conv5_1_3x3_relu", "vggface2.ResNet50ScratchDAG.conv5_1_1x1_increase", "vggface2.ResNet50ScratchDAG.conv5_1_1x1_increase_bn", "vggface2.ResNet50ScratchDAG.conv5_1_1x1_proj", "vggface2.ResNet50ScratchDAG.conv5_1_1x1_proj_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv5_1_relu", "vggface2.ResNet50ScratchDAG.conv5_2_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv5_2_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv5_2_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv5_2_3x3", "vggface2.ResNet50ScratchDAG.conv5_2_3x3_bn", "vggface2.ResNet50ScratchDAG.conv5_2_3x3_relu", "vggface2.ResNet50ScratchDAG.conv5_2_1x1_increase", "vggface2.ResNet50ScratchDAG.conv5_2_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv5_2_relu", "vggface2.ResNet50ScratchDAG.conv5_3_1x1_reduce", "vggface2.ResNet50ScratchDAG.conv5_3_1x1_reduce_bn", "vggface2.ResNet50ScratchDAG.conv5_3_1x1_reduce_relu", "vggface2.ResNet50ScratchDAG.conv5_3_3x3", "vggface2.ResNet50ScratchDAG.conv5_3_3x3_bn", "vggface2.ResNet50ScratchDAG.conv5_3_3x3_relu", "vggface2.ResNet50ScratchDAG.conv5_3_1x1_increase", "vggface2.ResNet50ScratchDAG.conv5_3_1x1_increase_bn", "torch.add", "torch.add", "torch.add", "torch.add", "vggface2.ResNet50ScratchDAG.conv5_3_relu", "vggface2.ResNet50ScratchDAG.conv5_3x_global_pool", "vggface2.ResNet50ScratchDAG.view", "vggface2.ResNet50ScratchDAG.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "data", ")", ":", "\n", "        ", "conv1_7x7_s2", "=", "self", ".", "conv1_7x7_s2", "(", "data", ")", "\n", "conv1_7x7_s2_bn", "=", "self", ".", "conv1_7x7_s2_bn", "(", "conv1_7x7_s2", ")", "\n", "conv1_7x7_s2_bnxx", "=", "self", ".", "conv1_relu_7x7_s2", "(", "conv1_7x7_s2_bn", ")", "\n", "pool1_3x3_s2", "=", "self", ".", "pool1_3x3_s2", "(", "conv1_7x7_s2_bnxx", ")", "\n", "conv2_1_1x1_reduce", "=", "self", ".", "conv2_1_1x1_reduce", "(", "pool1_3x3_s2", ")", "\n", "conv2_1_1x1_reduce_bn", "=", "self", ".", "conv2_1_1x1_reduce_bn", "(", "conv2_1_1x1_reduce", ")", "\n", "conv2_1_1x1_reduce_bnxx", "=", "self", ".", "conv2_1_1x1_reduce_relu", "(", "conv2_1_1x1_reduce_bn", ")", "\n", "conv2_1_3x3", "=", "self", ".", "conv2_1_3x3", "(", "conv2_1_1x1_reduce_bnxx", ")", "\n", "conv2_1_3x3_bn", "=", "self", ".", "conv2_1_3x3_bn", "(", "conv2_1_3x3", ")", "\n", "conv2_1_3x3_bnxx", "=", "self", ".", "conv2_1_3x3_relu", "(", "conv2_1_3x3_bn", ")", "\n", "conv2_1_1x1_increase", "=", "self", ".", "conv2_1_1x1_increase", "(", "conv2_1_3x3_bnxx", ")", "\n", "conv2_1_1x1_increase_bn", "=", "self", ".", "conv2_1_1x1_increase_bn", "(", "conv2_1_1x1_increase", ")", "\n", "conv2_1_1x1_proj", "=", "self", ".", "conv2_1_1x1_proj", "(", "pool1_3x3_s2", ")", "\n", "conv2_1_1x1_proj_bn", "=", "self", ".", "conv2_1_1x1_proj_bn", "(", "conv2_1_1x1_proj", ")", "\n", "conv2_1", "=", "torch", ".", "add", "(", "conv2_1_1x1_proj_bn", ",", "1", ",", "conv2_1_1x1_increase_bn", ")", "\n", "conv2_1x", "=", "self", ".", "conv2_1_relu", "(", "conv2_1", ")", "\n", "conv2_2_1x1_reduce", "=", "self", ".", "conv2_2_1x1_reduce", "(", "conv2_1x", ")", "\n", "conv2_2_1x1_reduce_bn", "=", "self", ".", "conv2_2_1x1_reduce_bn", "(", "conv2_2_1x1_reduce", ")", "\n", "conv2_2_1x1_reduce_bnxx", "=", "self", ".", "conv2_2_1x1_reduce_relu", "(", "conv2_2_1x1_reduce_bn", ")", "\n", "conv2_2_3x3", "=", "self", ".", "conv2_2_3x3", "(", "conv2_2_1x1_reduce_bnxx", ")", "\n", "conv2_2_3x3_bn", "=", "self", ".", "conv2_2_3x3_bn", "(", "conv2_2_3x3", ")", "\n", "conv2_2_3x3_bnxx", "=", "self", ".", "conv2_2_3x3_relu", "(", "conv2_2_3x3_bn", ")", "\n", "conv2_2_1x1_increase", "=", "self", ".", "conv2_2_1x1_increase", "(", "conv2_2_3x3_bnxx", ")", "\n", "conv2_2_1x1_increase_bn", "=", "self", ".", "conv2_2_1x1_increase_bn", "(", "conv2_2_1x1_increase", ")", "\n", "conv2_2", "=", "torch", ".", "add", "(", "conv2_1x", ",", "1", ",", "conv2_2_1x1_increase_bn", ")", "\n", "conv2_2x", "=", "self", ".", "conv2_2_relu", "(", "conv2_2", ")", "\n", "conv2_3_1x1_reduce", "=", "self", ".", "conv2_3_1x1_reduce", "(", "conv2_2x", ")", "\n", "conv2_3_1x1_reduce_bn", "=", "self", ".", "conv2_3_1x1_reduce_bn", "(", "conv2_3_1x1_reduce", ")", "\n", "conv2_3_1x1_reduce_bnxx", "=", "self", ".", "conv2_3_1x1_reduce_relu", "(", "conv2_3_1x1_reduce_bn", ")", "\n", "conv2_3_3x3", "=", "self", ".", "conv2_3_3x3", "(", "conv2_3_1x1_reduce_bnxx", ")", "\n", "conv2_3_3x3_bn", "=", "self", ".", "conv2_3_3x3_bn", "(", "conv2_3_3x3", ")", "\n", "conv2_3_3x3_bnxx", "=", "self", ".", "conv2_3_3x3_relu", "(", "conv2_3_3x3_bn", ")", "\n", "conv2_3_1x1_increase", "=", "self", ".", "conv2_3_1x1_increase", "(", "conv2_3_3x3_bnxx", ")", "\n", "conv2_3_1x1_increase_bn", "=", "self", ".", "conv2_3_1x1_increase_bn", "(", "conv2_3_1x1_increase", ")", "\n", "conv2_3", "=", "torch", ".", "add", "(", "conv2_2x", ",", "1", ",", "conv2_3_1x1_increase_bn", ")", "\n", "conv2_3x", "=", "self", ".", "conv2_3_relu", "(", "conv2_3", ")", "\n", "conv3_1_1x1_reduce", "=", "self", ".", "conv3_1_1x1_reduce", "(", "conv2_3x", ")", "\n", "conv3_1_1x1_reduce_bn", "=", "self", ".", "conv3_1_1x1_reduce_bn", "(", "conv3_1_1x1_reduce", ")", "\n", "conv3_1_1x1_reduce_bnxx", "=", "self", ".", "conv3_1_1x1_reduce_relu", "(", "conv3_1_1x1_reduce_bn", ")", "\n", "conv3_1_3x3", "=", "self", ".", "conv3_1_3x3", "(", "conv3_1_1x1_reduce_bnxx", ")", "\n", "conv3_1_3x3_bn", "=", "self", ".", "conv3_1_3x3_bn", "(", "conv3_1_3x3", ")", "\n", "conv3_1_3x3_bnxx", "=", "self", ".", "conv3_1_3x3_relu", "(", "conv3_1_3x3_bn", ")", "\n", "conv3_1_1x1_increase", "=", "self", ".", "conv3_1_1x1_increase", "(", "conv3_1_3x3_bnxx", ")", "\n", "conv3_1_1x1_increase_bn", "=", "self", ".", "conv3_1_1x1_increase_bn", "(", "conv3_1_1x1_increase", ")", "\n", "conv3_1_1x1_proj", "=", "self", ".", "conv3_1_1x1_proj", "(", "conv2_3x", ")", "\n", "conv3_1_1x1_proj_bn", "=", "self", ".", "conv3_1_1x1_proj_bn", "(", "conv3_1_1x1_proj", ")", "\n", "conv3_1", "=", "torch", ".", "add", "(", "conv3_1_1x1_proj_bn", ",", "1", ",", "conv3_1_1x1_increase_bn", ")", "\n", "conv3_1x", "=", "self", ".", "conv3_1_relu", "(", "conv3_1", ")", "\n", "conv3_2_1x1_reduce", "=", "self", ".", "conv3_2_1x1_reduce", "(", "conv3_1x", ")", "\n", "conv3_2_1x1_reduce_bn", "=", "self", ".", "conv3_2_1x1_reduce_bn", "(", "conv3_2_1x1_reduce", ")", "\n", "conv3_2_1x1_reduce_bnxx", "=", "self", ".", "conv3_2_1x1_reduce_relu", "(", "conv3_2_1x1_reduce_bn", ")", "\n", "conv3_2_3x3", "=", "self", ".", "conv3_2_3x3", "(", "conv3_2_1x1_reduce_bnxx", ")", "\n", "conv3_2_3x3_bn", "=", "self", ".", "conv3_2_3x3_bn", "(", "conv3_2_3x3", ")", "\n", "conv3_2_3x3_bnxx", "=", "self", ".", "conv3_2_3x3_relu", "(", "conv3_2_3x3_bn", ")", "\n", "conv3_2_1x1_increase", "=", "self", ".", "conv3_2_1x1_increase", "(", "conv3_2_3x3_bnxx", ")", "\n", "conv3_2_1x1_increase_bn", "=", "self", ".", "conv3_2_1x1_increase_bn", "(", "conv3_2_1x1_increase", ")", "\n", "conv3_2", "=", "torch", ".", "add", "(", "conv3_1x", ",", "1", ",", "conv3_2_1x1_increase_bn", ")", "\n", "conv3_2x", "=", "self", ".", "conv3_2_relu", "(", "conv3_2", ")", "\n", "conv3_3_1x1_reduce", "=", "self", ".", "conv3_3_1x1_reduce", "(", "conv3_2x", ")", "\n", "conv3_3_1x1_reduce_bn", "=", "self", ".", "conv3_3_1x1_reduce_bn", "(", "conv3_3_1x1_reduce", ")", "\n", "conv3_3_1x1_reduce_bnxx", "=", "self", ".", "conv3_3_1x1_reduce_relu", "(", "conv3_3_1x1_reduce_bn", ")", "\n", "conv3_3_3x3", "=", "self", ".", "conv3_3_3x3", "(", "conv3_3_1x1_reduce_bnxx", ")", "\n", "conv3_3_3x3_bn", "=", "self", ".", "conv3_3_3x3_bn", "(", "conv3_3_3x3", ")", "\n", "conv3_3_3x3_bnxx", "=", "self", ".", "conv3_3_3x3_relu", "(", "conv3_3_3x3_bn", ")", "\n", "conv3_3_1x1_increase", "=", "self", ".", "conv3_3_1x1_increase", "(", "conv3_3_3x3_bnxx", ")", "\n", "conv3_3_1x1_increase_bn", "=", "self", ".", "conv3_3_1x1_increase_bn", "(", "conv3_3_1x1_increase", ")", "\n", "conv3_3", "=", "torch", ".", "add", "(", "conv3_2x", ",", "1", ",", "conv3_3_1x1_increase_bn", ")", "\n", "conv3_3x", "=", "self", ".", "conv3_3_relu", "(", "conv3_3", ")", "\n", "conv3_4_1x1_reduce", "=", "self", ".", "conv3_4_1x1_reduce", "(", "conv3_3x", ")", "\n", "conv3_4_1x1_reduce_bn", "=", "self", ".", "conv3_4_1x1_reduce_bn", "(", "conv3_4_1x1_reduce", ")", "\n", "conv3_4_1x1_reduce_bnxx", "=", "self", ".", "conv3_4_1x1_reduce_relu", "(", "conv3_4_1x1_reduce_bn", ")", "\n", "conv3_4_3x3", "=", "self", ".", "conv3_4_3x3", "(", "conv3_4_1x1_reduce_bnxx", ")", "\n", "conv3_4_3x3_bn", "=", "self", ".", "conv3_4_3x3_bn", "(", "conv3_4_3x3", ")", "\n", "conv3_4_3x3_bnxx", "=", "self", ".", "conv3_4_3x3_relu", "(", "conv3_4_3x3_bn", ")", "\n", "conv3_4_1x1_increase", "=", "self", ".", "conv3_4_1x1_increase", "(", "conv3_4_3x3_bnxx", ")", "\n", "conv3_4_1x1_increase_bn", "=", "self", ".", "conv3_4_1x1_increase_bn", "(", "conv3_4_1x1_increase", ")", "\n", "conv3_4", "=", "torch", ".", "add", "(", "conv3_3x", ",", "1", ",", "conv3_4_1x1_increase_bn", ")", "\n", "conv3_4x", "=", "self", ".", "conv3_4_relu", "(", "conv3_4", ")", "\n", "conv4_1_1x1_reduce", "=", "self", ".", "conv4_1_1x1_reduce", "(", "conv3_4x", ")", "\n", "conv4_1_1x1_reduce_bn", "=", "self", ".", "conv4_1_1x1_reduce_bn", "(", "conv4_1_1x1_reduce", ")", "\n", "conv4_1_1x1_reduce_bnxx", "=", "self", ".", "conv4_1_1x1_reduce_relu", "(", "conv4_1_1x1_reduce_bn", ")", "\n", "conv4_1_3x3", "=", "self", ".", "conv4_1_3x3", "(", "conv4_1_1x1_reduce_bnxx", ")", "\n", "conv4_1_3x3_bn", "=", "self", ".", "conv4_1_3x3_bn", "(", "conv4_1_3x3", ")", "\n", "conv4_1_3x3_bnxx", "=", "self", ".", "conv4_1_3x3_relu", "(", "conv4_1_3x3_bn", ")", "\n", "conv4_1_1x1_increase", "=", "self", ".", "conv4_1_1x1_increase", "(", "conv4_1_3x3_bnxx", ")", "\n", "conv4_1_1x1_increase_bn", "=", "self", ".", "conv4_1_1x1_increase_bn", "(", "conv4_1_1x1_increase", ")", "\n", "conv4_1_1x1_proj", "=", "self", ".", "conv4_1_1x1_proj", "(", "conv3_4x", ")", "\n", "conv4_1_1x1_proj_bn", "=", "self", ".", "conv4_1_1x1_proj_bn", "(", "conv4_1_1x1_proj", ")", "\n", "conv4_1", "=", "torch", ".", "add", "(", "conv4_1_1x1_proj_bn", ",", "1", ",", "conv4_1_1x1_increase_bn", ")", "\n", "conv4_1x", "=", "self", ".", "conv4_1_relu", "(", "conv4_1", ")", "\n", "conv4_2_1x1_reduce", "=", "self", ".", "conv4_2_1x1_reduce", "(", "conv4_1x", ")", "\n", "conv4_2_1x1_reduce_bn", "=", "self", ".", "conv4_2_1x1_reduce_bn", "(", "conv4_2_1x1_reduce", ")", "\n", "conv4_2_1x1_reduce_bnxx", "=", "self", ".", "conv4_2_1x1_reduce_relu", "(", "conv4_2_1x1_reduce_bn", ")", "\n", "conv4_2_3x3", "=", "self", ".", "conv4_2_3x3", "(", "conv4_2_1x1_reduce_bnxx", ")", "\n", "conv4_2_3x3_bn", "=", "self", ".", "conv4_2_3x3_bn", "(", "conv4_2_3x3", ")", "\n", "conv4_2_3x3_bnxx", "=", "self", ".", "conv4_2_3x3_relu", "(", "conv4_2_3x3_bn", ")", "\n", "conv4_2_1x1_increase", "=", "self", ".", "conv4_2_1x1_increase", "(", "conv4_2_3x3_bnxx", ")", "\n", "conv4_2_1x1_increase_bn", "=", "self", ".", "conv4_2_1x1_increase_bn", "(", "conv4_2_1x1_increase", ")", "\n", "conv4_2", "=", "torch", ".", "add", "(", "conv4_1x", ",", "1", ",", "conv4_2_1x1_increase_bn", ")", "\n", "conv4_2x", "=", "self", ".", "conv4_2_relu", "(", "conv4_2", ")", "\n", "conv4_3_1x1_reduce", "=", "self", ".", "conv4_3_1x1_reduce", "(", "conv4_2x", ")", "\n", "conv4_3_1x1_reduce_bn", "=", "self", ".", "conv4_3_1x1_reduce_bn", "(", "conv4_3_1x1_reduce", ")", "\n", "conv4_3_1x1_reduce_bnxx", "=", "self", ".", "conv4_3_1x1_reduce_relu", "(", "conv4_3_1x1_reduce_bn", ")", "\n", "conv4_3_3x3", "=", "self", ".", "conv4_3_3x3", "(", "conv4_3_1x1_reduce_bnxx", ")", "\n", "conv4_3_3x3_bn", "=", "self", ".", "conv4_3_3x3_bn", "(", "conv4_3_3x3", ")", "\n", "conv4_3_3x3_bnxx", "=", "self", ".", "conv4_3_3x3_relu", "(", "conv4_3_3x3_bn", ")", "\n", "conv4_3_1x1_increase", "=", "self", ".", "conv4_3_1x1_increase", "(", "conv4_3_3x3_bnxx", ")", "\n", "conv4_3_1x1_increase_bn", "=", "self", ".", "conv4_3_1x1_increase_bn", "(", "conv4_3_1x1_increase", ")", "\n", "conv4_3", "=", "torch", ".", "add", "(", "conv4_2x", ",", "1", ",", "conv4_3_1x1_increase_bn", ")", "\n", "conv4_3x", "=", "self", ".", "conv4_3_relu", "(", "conv4_3", ")", "\n", "conv4_4_1x1_reduce", "=", "self", ".", "conv4_4_1x1_reduce", "(", "conv4_3x", ")", "\n", "conv4_4_1x1_reduce_bn", "=", "self", ".", "conv4_4_1x1_reduce_bn", "(", "conv4_4_1x1_reduce", ")", "\n", "conv4_4_1x1_reduce_bnxx", "=", "self", ".", "conv4_4_1x1_reduce_relu", "(", "conv4_4_1x1_reduce_bn", ")", "\n", "conv4_4_3x3", "=", "self", ".", "conv4_4_3x3", "(", "conv4_4_1x1_reduce_bnxx", ")", "\n", "conv4_4_3x3_bn", "=", "self", ".", "conv4_4_3x3_bn", "(", "conv4_4_3x3", ")", "\n", "conv4_4_3x3_bnxx", "=", "self", ".", "conv4_4_3x3_relu", "(", "conv4_4_3x3_bn", ")", "\n", "conv4_4_1x1_increase", "=", "self", ".", "conv4_4_1x1_increase", "(", "conv4_4_3x3_bnxx", ")", "\n", "conv4_4_1x1_increase_bn", "=", "self", ".", "conv4_4_1x1_increase_bn", "(", "conv4_4_1x1_increase", ")", "\n", "conv4_4", "=", "torch", ".", "add", "(", "conv4_3x", ",", "1", ",", "conv4_4_1x1_increase_bn", ")", "\n", "conv4_4x", "=", "self", ".", "conv4_4_relu", "(", "conv4_4", ")", "\n", "conv4_5_1x1_reduce", "=", "self", ".", "conv4_5_1x1_reduce", "(", "conv4_4x", ")", "\n", "conv4_5_1x1_reduce_bn", "=", "self", ".", "conv4_5_1x1_reduce_bn", "(", "conv4_5_1x1_reduce", ")", "\n", "conv4_5_1x1_reduce_bnxx", "=", "self", ".", "conv4_5_1x1_reduce_relu", "(", "conv4_5_1x1_reduce_bn", ")", "\n", "conv4_5_3x3", "=", "self", ".", "conv4_5_3x3", "(", "conv4_5_1x1_reduce_bnxx", ")", "\n", "conv4_5_3x3_bn", "=", "self", ".", "conv4_5_3x3_bn", "(", "conv4_5_3x3", ")", "\n", "conv4_5_3x3_bnxx", "=", "self", ".", "conv4_5_3x3_relu", "(", "conv4_5_3x3_bn", ")", "\n", "conv4_5_1x1_increase", "=", "self", ".", "conv4_5_1x1_increase", "(", "conv4_5_3x3_bnxx", ")", "\n", "conv4_5_1x1_increase_bn", "=", "self", ".", "conv4_5_1x1_increase_bn", "(", "conv4_5_1x1_increase", ")", "\n", "conv4_5", "=", "torch", ".", "add", "(", "conv4_4x", ",", "1", ",", "conv4_5_1x1_increase_bn", ")", "\n", "conv4_5x", "=", "self", ".", "conv4_5_relu", "(", "conv4_5", ")", "\n", "conv4_6_1x1_reduce", "=", "self", ".", "conv4_6_1x1_reduce", "(", "conv4_5x", ")", "\n", "conv4_6_1x1_reduce_bn", "=", "self", ".", "conv4_6_1x1_reduce_bn", "(", "conv4_6_1x1_reduce", ")", "\n", "conv4_6_1x1_reduce_bnxx", "=", "self", ".", "conv4_6_1x1_reduce_relu", "(", "conv4_6_1x1_reduce_bn", ")", "\n", "conv4_6_3x3", "=", "self", ".", "conv4_6_3x3", "(", "conv4_6_1x1_reduce_bnxx", ")", "\n", "conv4_6_3x3_bn", "=", "self", ".", "conv4_6_3x3_bn", "(", "conv4_6_3x3", ")", "\n", "conv4_6_3x3_bnxx", "=", "self", ".", "conv4_6_3x3_relu", "(", "conv4_6_3x3_bn", ")", "\n", "conv4_6_1x1_increase", "=", "self", ".", "conv4_6_1x1_increase", "(", "conv4_6_3x3_bnxx", ")", "\n", "conv4_6_1x1_increase_bn", "=", "self", ".", "conv4_6_1x1_increase_bn", "(", "conv4_6_1x1_increase", ")", "\n", "conv4_6", "=", "torch", ".", "add", "(", "conv4_5x", ",", "1", ",", "conv4_6_1x1_increase_bn", ")", "\n", "conv4_6x", "=", "self", ".", "conv4_6_relu", "(", "conv4_6", ")", "\n", "conv5_1_1x1_reduce", "=", "self", ".", "conv5_1_1x1_reduce", "(", "conv4_6x", ")", "\n", "conv5_1_1x1_reduce_bn", "=", "self", ".", "conv5_1_1x1_reduce_bn", "(", "conv5_1_1x1_reduce", ")", "\n", "conv5_1_1x1_reduce_bnxx", "=", "self", ".", "conv5_1_1x1_reduce_relu", "(", "conv5_1_1x1_reduce_bn", ")", "\n", "conv5_1_3x3", "=", "self", ".", "conv5_1_3x3", "(", "conv5_1_1x1_reduce_bnxx", ")", "\n", "conv5_1_3x3_bn", "=", "self", ".", "conv5_1_3x3_bn", "(", "conv5_1_3x3", ")", "\n", "conv5_1_3x3_bnxx", "=", "self", ".", "conv5_1_3x3_relu", "(", "conv5_1_3x3_bn", ")", "\n", "conv5_1_1x1_increase", "=", "self", ".", "conv5_1_1x1_increase", "(", "conv5_1_3x3_bnxx", ")", "\n", "conv5_1_1x1_increase_bn", "=", "self", ".", "conv5_1_1x1_increase_bn", "(", "conv5_1_1x1_increase", ")", "\n", "conv5_1_1x1_proj", "=", "self", ".", "conv5_1_1x1_proj", "(", "conv4_6x", ")", "\n", "conv5_1_1x1_proj_bn", "=", "self", ".", "conv5_1_1x1_proj_bn", "(", "conv5_1_1x1_proj", ")", "\n", "conv5_1", "=", "torch", ".", "add", "(", "conv5_1_1x1_proj_bn", ",", "1", ",", "conv5_1_1x1_increase_bn", ")", "\n", "conv5_1x", "=", "self", ".", "conv5_1_relu", "(", "conv5_1", ")", "\n", "conv5_2_1x1_reduce", "=", "self", ".", "conv5_2_1x1_reduce", "(", "conv5_1x", ")", "\n", "conv5_2_1x1_reduce_bn", "=", "self", ".", "conv5_2_1x1_reduce_bn", "(", "conv5_2_1x1_reduce", ")", "\n", "conv5_2_1x1_reduce_bnxx", "=", "self", ".", "conv5_2_1x1_reduce_relu", "(", "conv5_2_1x1_reduce_bn", ")", "\n", "conv5_2_3x3", "=", "self", ".", "conv5_2_3x3", "(", "conv5_2_1x1_reduce_bnxx", ")", "\n", "conv5_2_3x3_bn", "=", "self", ".", "conv5_2_3x3_bn", "(", "conv5_2_3x3", ")", "\n", "conv5_2_3x3_bnxx", "=", "self", ".", "conv5_2_3x3_relu", "(", "conv5_2_3x3_bn", ")", "\n", "conv5_2_1x1_increase", "=", "self", ".", "conv5_2_1x1_increase", "(", "conv5_2_3x3_bnxx", ")", "\n", "conv5_2_1x1_increase_bn", "=", "self", ".", "conv5_2_1x1_increase_bn", "(", "conv5_2_1x1_increase", ")", "\n", "conv5_2", "=", "torch", ".", "add", "(", "conv5_1x", ",", "1", ",", "conv5_2_1x1_increase_bn", ")", "\n", "conv5_2x", "=", "self", ".", "conv5_2_relu", "(", "conv5_2", ")", "\n", "conv5_3_1x1_reduce", "=", "self", ".", "conv5_3_1x1_reduce", "(", "conv5_2x", ")", "\n", "conv5_3_1x1_reduce_bn", "=", "self", ".", "conv5_3_1x1_reduce_bn", "(", "conv5_3_1x1_reduce", ")", "\n", "conv5_3_1x1_reduce_bnxx", "=", "self", ".", "conv5_3_1x1_reduce_relu", "(", "conv5_3_1x1_reduce_bn", ")", "\n", "conv5_3_3x3", "=", "self", ".", "conv5_3_3x3", "(", "conv5_3_1x1_reduce_bnxx", ")", "\n", "conv5_3_3x3_bn", "=", "self", ".", "conv5_3_3x3_bn", "(", "conv5_3_3x3", ")", "\n", "conv5_3_3x3_bnxx", "=", "self", ".", "conv5_3_3x3_relu", "(", "conv5_3_3x3_bn", ")", "\n", "conv5_3_1x1_increase", "=", "self", ".", "conv5_3_1x1_increase", "(", "conv5_3_3x3_bnxx", ")", "\n", "conv5_3_1x1_increase_bn", "=", "self", ".", "conv5_3_1x1_increase_bn", "(", "conv5_3_1x1_increase", ")", "\n", "conv5_3", "=", "torch", ".", "add", "(", "conv5_2x", ",", "1", ",", "conv5_3_1x1_increase_bn", ")", "\n", "conv5_3x", "=", "self", ".", "conv5_3_relu", "(", "conv5_3", ")", "\n", "conv5_3x_global_pool", "=", "self", ".", "conv5_3x_global_pool", "(", "conv5_3x", ")", "\n", "feature_flatten", "=", "conv5_3x_global_pool", ".", "view", "(", "conv5_3x_global_pool", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "return", "feature_flatten", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.vggface2.SeNet50ScratchDAG.__init__": [[351, 593], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.ReLU", "torch.ReLU", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "SeNet50ScratchDAG", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "meta", "=", "{", "'mean'", ":", "[", "123", ",", "117", ",", "104", "]", ",", "\n", "'std'", ":", "[", "1", ",", "1", ",", "1", "]", ",", "\n", "'imageSize'", ":", "[", "224", ",", "224", ",", "3", "]", "}", "\n", "self", ".", "conv1_7x7_s2", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "[", "7", ",", "7", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "padding", "=", "(", "3", ",", "3", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv1_7x7_s2_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv1_relu_7x7_s2", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "pool1_3x3_s2", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "[", "2", ",", "2", "]", ",", "padding", "=", "(", "0", ",", "0", ")", ",", "dilation", "=", "1", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "conv2_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_1_3x3", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv2_1_1x1_down", "=", "nn", ".", "Conv2d", "(", "256", ",", "16", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv2_1_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_1_1x1_up", "=", "nn", ".", "Conv2d", "(", "16", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv2_1_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv2_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "256", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_2_3x3", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_2_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv2_2_1x1_down", "=", "nn", ".", "Conv2d", "(", "256", ",", "16", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv2_2_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_2_1x1_up", "=", "nn", ".", "Conv2d", "(", "16", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv2_2_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv2_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "256", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_3_3x3", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "64", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv2_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv2_3_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv2_3_1x1_down", "=", "nn", ".", "Conv2d", "(", "256", ",", "16", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv2_3_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv2_3_1x1_up", "=", "nn", ".", "Conv2d", "(", "16", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv2_3_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv2_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "256", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_1_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv3_1_1x1_down", "=", "nn", ".", "Conv2d", "(", "512", ",", "32", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_1_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_1_1x1_up", "=", "nn", ".", "Conv2d", "(", "32", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_1_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv3_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "256", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_2_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_2_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv3_2_1x1_down", "=", "nn", ".", "Conv2d", "(", "512", ",", "32", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_2_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_2_1x1_up", "=", "nn", ".", "Conv2d", "(", "32", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_2_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv3_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_3_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_3_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv3_3_1x1_down", "=", "nn", ".", "Conv2d", "(", "512", ",", "32", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_3_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_3_1x1_up", "=", "nn", ".", "Conv2d", "(", "32", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_3_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv3_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_4_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_4_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_4_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_4_3x3", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_4_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_4_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_4_1x1_increase", "=", "nn", ".", "Conv2d", "(", "128", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv3_4_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv3_4_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv3_4_1x1_down", "=", "nn", ".", "Conv2d", "(", "512", ",", "32", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_4_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv3_4_1x1_up", "=", "nn", ".", "Conv2d", "(", "32", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv3_4_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv3_4_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "512", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_1_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv4_1_1x1_down", "=", "nn", ".", "Conv2d", "(", "1024", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_1_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_1_1x1_up", "=", "nn", ".", "Conv2d", "(", "64", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_1_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv4_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "512", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_2_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_2_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv4_2_1x1_down", "=", "nn", ".", "Conv2d", "(", "1024", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_2_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_2_1x1_up", "=", "nn", ".", "Conv2d", "(", "64", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_2_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv4_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_3_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_3_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv4_3_1x1_down", "=", "nn", ".", "Conv2d", "(", "1024", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_3_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_3_1x1_up", "=", "nn", ".", "Conv2d", "(", "64", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_3_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv4_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_4_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_4_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_4_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_4_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_4_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_4_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_4_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_4_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_4_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv4_4_1x1_down", "=", "nn", ".", "Conv2d", "(", "1024", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_4_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_4_1x1_up", "=", "nn", ".", "Conv2d", "(", "64", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_4_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv4_4_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_5_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_5_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_5_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_5_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_5_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_5_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_5_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_5_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_5_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv4_5_1x1_down", "=", "nn", ".", "Conv2d", "(", "1024", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_5_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_5_1x1_up", "=", "nn", ".", "Conv2d", "(", "64", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_5_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv4_5_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_6_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "256", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_6_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_6_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_6_3x3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_6_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_6_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_6_1x1_increase", "=", "nn", ".", "Conv2d", "(", "256", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv4_6_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "1024", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv4_6_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv4_6_1x1_down", "=", "nn", ".", "Conv2d", "(", "1024", ",", "64", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_6_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv4_6_1x1_up", "=", "nn", ".", "Conv2d", "(", "64", ",", "1024", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv4_6_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv4_6_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_1_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "1024", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_1_3x3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_1_1x1_increase", "=", "nn", ".", "Conv2d", "(", "512", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv5_1_1x1_down", "=", "nn", ".", "Conv2d", "(", "2048", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv5_1_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_1_1x1_up", "=", "nn", ".", "Conv2d", "(", "128", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv5_1_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv5_1_1x1_proj", "=", "nn", ".", "Conv2d", "(", "1024", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_1_1x1_proj_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_1_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_2_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "2048", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_2_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_2_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_2_3x3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_2_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_2_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_2_1x1_increase", "=", "nn", ".", "Conv2d", "(", "512", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_2_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_2_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv5_2_1x1_down", "=", "nn", ".", "Conv2d", "(", "2048", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv5_2_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_2_1x1_up", "=", "nn", ".", "Conv2d", "(", "128", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv5_2_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv5_2_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3_1x1_reduce", "=", "nn", ".", "Conv2d", "(", "2048", ",", "512", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_3_1x1_reduce_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_3_1x1_reduce_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3_3x3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_3_3x3_bn", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_3_3x3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3_1x1_increase", "=", "nn", ".", "Conv2d", "(", "512", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv5_3_1x1_increase_bn", "=", "nn", ".", "BatchNorm2d", "(", "2048", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n", "self", ".", "conv5_3_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "self", ".", "conv5_3_1x1_down", "=", "nn", ".", "Conv2d", "(", "2048", ",", "128", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv5_3_1x1_down_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3_1x1_up", "=", "nn", ".", "Conv2d", "(", "128", ",", "2048", ",", "kernel_size", "=", "[", "1", ",", "1", "]", ",", "stride", "=", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "conv5_3_prob", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "conv5_3_relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "conv5_3x_global_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.vggface2.SeNet50ScratchDAG.forward": [[594, 866], ["vggface2.SeNet50ScratchDAG.conv1_7x7_s2", "vggface2.SeNet50ScratchDAG.conv1_7x7_s2_bn", "vggface2.SeNet50ScratchDAG.conv1_relu_7x7_s2", "vggface2.SeNet50ScratchDAG.pool1_3x3_s2", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv2_1_3x3", "vggface2.SeNet50ScratchDAG.conv2_1_3x3_bn", "vggface2.SeNet50ScratchDAG.conv2_1_3x3_relu", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_increase", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv2_1_global_pool", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_down", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_up", "vggface2.SeNet50ScratchDAG.conv2_1_prob", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_proj", "vggface2.SeNet50ScratchDAG.conv2_1_1x1_proj_bn", "vggface2.SeNet50ScratchDAG.conv2_1_relu", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv2_2_3x3", "vggface2.SeNet50ScratchDAG.conv2_2_3x3_bn", "vggface2.SeNet50ScratchDAG.conv2_2_3x3_relu", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_increase", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv2_2_global_pool", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_down", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv2_2_1x1_up", "vggface2.SeNet50ScratchDAG.conv2_2_prob", "vggface2.SeNet50ScratchDAG.conv2_2_relu", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv2_3_3x3", "vggface2.SeNet50ScratchDAG.conv2_3_3x3_bn", "vggface2.SeNet50ScratchDAG.conv2_3_3x3_relu", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_increase", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv2_3_global_pool", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_down", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv2_3_1x1_up", "vggface2.SeNet50ScratchDAG.conv2_3_prob", "vggface2.SeNet50ScratchDAG.conv2_3_relu", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv3_1_3x3", "vggface2.SeNet50ScratchDAG.conv3_1_3x3_bn", "vggface2.SeNet50ScratchDAG.conv3_1_3x3_relu", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_increase", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv3_1_global_pool", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_down", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_up", "vggface2.SeNet50ScratchDAG.conv3_1_prob", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_proj", "vggface2.SeNet50ScratchDAG.conv3_1_1x1_proj_bn", "vggface2.SeNet50ScratchDAG.conv3_1_relu", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv3_2_3x3", "vggface2.SeNet50ScratchDAG.conv3_2_3x3_bn", "vggface2.SeNet50ScratchDAG.conv3_2_3x3_relu", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_increase", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv3_2_global_pool", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_down", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv3_2_1x1_up", "vggface2.SeNet50ScratchDAG.conv3_2_prob", "vggface2.SeNet50ScratchDAG.conv3_2_relu", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv3_3_3x3", "vggface2.SeNet50ScratchDAG.conv3_3_3x3_bn", "vggface2.SeNet50ScratchDAG.conv3_3_3x3_relu", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_increase", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv3_3_global_pool", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_down", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv3_3_1x1_up", "vggface2.SeNet50ScratchDAG.conv3_3_prob", "vggface2.SeNet50ScratchDAG.conv3_3_relu", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv3_4_3x3", "vggface2.SeNet50ScratchDAG.conv3_4_3x3_bn", "vggface2.SeNet50ScratchDAG.conv3_4_3x3_relu", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_increase", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv3_4_global_pool", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_down", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv3_4_1x1_up", "vggface2.SeNet50ScratchDAG.conv3_4_prob", "vggface2.SeNet50ScratchDAG.conv3_4_relu", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv4_1_3x3", "vggface2.SeNet50ScratchDAG.conv4_1_3x3_bn", "vggface2.SeNet50ScratchDAG.conv4_1_3x3_relu", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_increase", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv4_1_global_pool", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_down", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_up", "vggface2.SeNet50ScratchDAG.conv4_1_prob", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_proj", "vggface2.SeNet50ScratchDAG.conv4_1_1x1_proj_bn", "vggface2.SeNet50ScratchDAG.conv4_1_relu", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv4_2_3x3", "vggface2.SeNet50ScratchDAG.conv4_2_3x3_bn", "vggface2.SeNet50ScratchDAG.conv4_2_3x3_relu", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_increase", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv4_2_global_pool", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_down", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv4_2_1x1_up", "vggface2.SeNet50ScratchDAG.conv4_2_prob", "vggface2.SeNet50ScratchDAG.conv4_2_relu", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv4_3_3x3", "vggface2.SeNet50ScratchDAG.conv4_3_3x3_bn", "vggface2.SeNet50ScratchDAG.conv4_3_3x3_relu", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_increase", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv4_3_global_pool", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_down", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv4_3_1x1_up", "vggface2.SeNet50ScratchDAG.conv4_3_prob", "vggface2.SeNet50ScratchDAG.conv4_3_relu", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv4_4_3x3", "vggface2.SeNet50ScratchDAG.conv4_4_3x3_bn", "vggface2.SeNet50ScratchDAG.conv4_4_3x3_relu", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_increase", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv4_4_global_pool", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_down", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv4_4_1x1_up", "vggface2.SeNet50ScratchDAG.conv4_4_prob", "vggface2.SeNet50ScratchDAG.conv4_4_relu", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv4_5_3x3", "vggface2.SeNet50ScratchDAG.conv4_5_3x3_bn", "vggface2.SeNet50ScratchDAG.conv4_5_3x3_relu", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_increase", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv4_5_global_pool", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_down", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv4_5_1x1_up", "vggface2.SeNet50ScratchDAG.conv4_5_prob", "vggface2.SeNet50ScratchDAG.conv4_5_relu", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv4_6_3x3", "vggface2.SeNet50ScratchDAG.conv4_6_3x3_bn", "vggface2.SeNet50ScratchDAG.conv4_6_3x3_relu", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_increase", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv4_6_global_pool", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_down", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv4_6_1x1_up", "vggface2.SeNet50ScratchDAG.conv4_6_prob", "vggface2.SeNet50ScratchDAG.conv4_6_relu", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv5_1_3x3", "vggface2.SeNet50ScratchDAG.conv5_1_3x3_bn", "vggface2.SeNet50ScratchDAG.conv5_1_3x3_relu", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_increase", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv5_1_global_pool", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_down", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_up", "vggface2.SeNet50ScratchDAG.conv5_1_prob", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_proj", "vggface2.SeNet50ScratchDAG.conv5_1_1x1_proj_bn", "vggface2.SeNet50ScratchDAG.conv5_1_relu", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv5_2_3x3", "vggface2.SeNet50ScratchDAG.conv5_2_3x3_bn", "vggface2.SeNet50ScratchDAG.conv5_2_3x3_relu", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_increase", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv5_2_global_pool", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_down", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv5_2_1x1_up", "vggface2.SeNet50ScratchDAG.conv5_2_prob", "vggface2.SeNet50ScratchDAG.conv5_2_relu", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_reduce", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_reduce_bn", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_reduce_relu", "vggface2.SeNet50ScratchDAG.conv5_3_3x3", "vggface2.SeNet50ScratchDAG.conv5_3_3x3_bn", "vggface2.SeNet50ScratchDAG.conv5_3_3x3_relu", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_increase", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_increase_bn", "vggface2.SeNet50ScratchDAG.conv5_3_global_pool", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_down", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_down_relu", "vggface2.SeNet50ScratchDAG.conv5_3_1x1_up", "vggface2.SeNet50ScratchDAG.conv5_3_prob", "vggface2.SeNet50ScratchDAG.conv5_3_relu", "vggface2.SeNet50ScratchDAG.conv5_3x_global_pool", "vggface2.SeNet50ScratchDAG.view", "vggface2.SeNet50ScratchDAG.size", "conv2_1_prob_reshape.expand_as", "conv2_2_prob_reshape.expand_as", "conv2_3_prob_reshape.expand_as", "conv3_1_prob_reshape.expand_as", "conv3_2_prob_reshape.expand_as", "conv3_3_prob_reshape.expand_as", "conv3_4_prob_reshape.expand_as", "conv4_1_prob_reshape.expand_as", "conv4_2_prob_reshape.expand_as", "conv4_3_prob_reshape.expand_as", "conv4_4_prob_reshape.expand_as", "conv4_5_prob_reshape.expand_as", "conv4_6_prob_reshape.expand_as", "conv5_1_prob_reshape.expand_as", "conv5_2_prob_reshape.expand_as", "conv5_3_prob_reshape.expand_as"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "data", ")", ":", "\n", "        ", "conv1_7x7_s2", "=", "self", ".", "conv1_7x7_s2", "(", "data", ")", "\n", "conv1_7x7_s2_bn", "=", "self", ".", "conv1_7x7_s2_bn", "(", "conv1_7x7_s2", ")", "\n", "conv1_7x7_s2_bnxx", "=", "self", ".", "conv1_relu_7x7_s2", "(", "conv1_7x7_s2_bn", ")", "\n", "pool1_3x3_s2", "=", "self", ".", "pool1_3x3_s2", "(", "conv1_7x7_s2_bnxx", ")", "\n", "conv2_1_1x1_reduce", "=", "self", ".", "conv2_1_1x1_reduce", "(", "pool1_3x3_s2", ")", "\n", "conv2_1_1x1_reduce_bn", "=", "self", ".", "conv2_1_1x1_reduce_bn", "(", "conv2_1_1x1_reduce", ")", "\n", "conv2_1_1x1_reduce_bnxx", "=", "self", ".", "conv2_1_1x1_reduce_relu", "(", "conv2_1_1x1_reduce_bn", ")", "\n", "conv2_1_3x3", "=", "self", ".", "conv2_1_3x3", "(", "conv2_1_1x1_reduce_bnxx", ")", "\n", "conv2_1_3x3_bn", "=", "self", ".", "conv2_1_3x3_bn", "(", "conv2_1_3x3", ")", "\n", "conv2_1_3x3_bnxx", "=", "self", ".", "conv2_1_3x3_relu", "(", "conv2_1_3x3_bn", ")", "\n", "conv2_1_1x1_increase", "=", "self", ".", "conv2_1_1x1_increase", "(", "conv2_1_3x3_bnxx", ")", "\n", "conv2_1_1x1_increase_bn", "=", "self", ".", "conv2_1_1x1_increase_bn", "(", "conv2_1_1x1_increase", ")", "\n", "conv2_1_global_pool", "=", "self", ".", "conv2_1_global_pool", "(", "conv2_1_1x1_increase_bn", ")", "\n", "conv2_1_1x1_down", "=", "self", ".", "conv2_1_1x1_down", "(", "conv2_1_global_pool", ")", "\n", "conv2_1_1x1_downx", "=", "self", ".", "conv2_1_1x1_down_relu", "(", "conv2_1_1x1_down", ")", "\n", "conv2_1_1x1_up", "=", "self", ".", "conv2_1_1x1_up", "(", "conv2_1_1x1_downx", ")", "\n", "conv2_1_1x1_upx", "=", "self", ".", "conv2_1_prob", "(", "conv2_1_1x1_up", ")", "\n", "conv2_1_prob_reshape", "=", "conv2_1_1x1_upx", "\n", "conv2_1_1x1_proj", "=", "self", ".", "conv2_1_1x1_proj", "(", "pool1_3x3_s2", ")", "\n", "conv2_1_1x1_proj_bn", "=", "self", ".", "conv2_1_1x1_proj_bn", "(", "conv2_1_1x1_proj", ")", "\n", "conv2_1", "=", "conv2_1_prob_reshape", ".", "expand_as", "(", "conv2_1_1x1_increase_bn", ")", "*", "conv2_1_1x1_increase_bn", "+", "conv2_1_1x1_proj_bn", "\n", "conv2_1x", "=", "self", ".", "conv2_1_relu", "(", "conv2_1", ")", "\n", "conv2_2_1x1_reduce", "=", "self", ".", "conv2_2_1x1_reduce", "(", "conv2_1x", ")", "\n", "conv2_2_1x1_reduce_bn", "=", "self", ".", "conv2_2_1x1_reduce_bn", "(", "conv2_2_1x1_reduce", ")", "\n", "conv2_2_1x1_reduce_bnxx", "=", "self", ".", "conv2_2_1x1_reduce_relu", "(", "conv2_2_1x1_reduce_bn", ")", "\n", "conv2_2_3x3", "=", "self", ".", "conv2_2_3x3", "(", "conv2_2_1x1_reduce_bnxx", ")", "\n", "conv2_2_3x3_bn", "=", "self", ".", "conv2_2_3x3_bn", "(", "conv2_2_3x3", ")", "\n", "conv2_2_3x3_bnxx", "=", "self", ".", "conv2_2_3x3_relu", "(", "conv2_2_3x3_bn", ")", "\n", "conv2_2_1x1_increase", "=", "self", ".", "conv2_2_1x1_increase", "(", "conv2_2_3x3_bnxx", ")", "\n", "conv2_2_1x1_increase_bn", "=", "self", ".", "conv2_2_1x1_increase_bn", "(", "conv2_2_1x1_increase", ")", "\n", "conv2_2_global_pool", "=", "self", ".", "conv2_2_global_pool", "(", "conv2_2_1x1_increase_bn", ")", "\n", "conv2_2_1x1_down", "=", "self", ".", "conv2_2_1x1_down", "(", "conv2_2_global_pool", ")", "\n", "conv2_2_1x1_downx", "=", "self", ".", "conv2_2_1x1_down_relu", "(", "conv2_2_1x1_down", ")", "\n", "conv2_2_1x1_up", "=", "self", ".", "conv2_2_1x1_up", "(", "conv2_2_1x1_downx", ")", "\n", "conv2_2_1x1_upx", "=", "self", ".", "conv2_2_prob", "(", "conv2_2_1x1_up", ")", "\n", "conv2_2_prob_reshape", "=", "conv2_2_1x1_upx", "\n", "conv2_2", "=", "conv2_2_prob_reshape", ".", "expand_as", "(", "conv2_2_1x1_increase_bn", ")", "*", "conv2_2_1x1_increase_bn", "+", "conv2_1x", "\n", "conv2_2x", "=", "self", ".", "conv2_2_relu", "(", "conv2_2", ")", "\n", "conv2_3_1x1_reduce", "=", "self", ".", "conv2_3_1x1_reduce", "(", "conv2_2x", ")", "\n", "conv2_3_1x1_reduce_bn", "=", "self", ".", "conv2_3_1x1_reduce_bn", "(", "conv2_3_1x1_reduce", ")", "\n", "conv2_3_1x1_reduce_bnxx", "=", "self", ".", "conv2_3_1x1_reduce_relu", "(", "conv2_3_1x1_reduce_bn", ")", "\n", "conv2_3_3x3", "=", "self", ".", "conv2_3_3x3", "(", "conv2_3_1x1_reduce_bnxx", ")", "\n", "conv2_3_3x3_bn", "=", "self", ".", "conv2_3_3x3_bn", "(", "conv2_3_3x3", ")", "\n", "conv2_3_3x3_bnxx", "=", "self", ".", "conv2_3_3x3_relu", "(", "conv2_3_3x3_bn", ")", "\n", "conv2_3_1x1_increase", "=", "self", ".", "conv2_3_1x1_increase", "(", "conv2_3_3x3_bnxx", ")", "\n", "conv2_3_1x1_increase_bn", "=", "self", ".", "conv2_3_1x1_increase_bn", "(", "conv2_3_1x1_increase", ")", "\n", "conv2_3_global_pool", "=", "self", ".", "conv2_3_global_pool", "(", "conv2_3_1x1_increase_bn", ")", "\n", "conv2_3_1x1_down", "=", "self", ".", "conv2_3_1x1_down", "(", "conv2_3_global_pool", ")", "\n", "conv2_3_1x1_downx", "=", "self", ".", "conv2_3_1x1_down_relu", "(", "conv2_3_1x1_down", ")", "\n", "conv2_3_1x1_up", "=", "self", ".", "conv2_3_1x1_up", "(", "conv2_3_1x1_downx", ")", "\n", "conv2_3_1x1_upx", "=", "self", ".", "conv2_3_prob", "(", "conv2_3_1x1_up", ")", "\n", "conv2_3_prob_reshape", "=", "conv2_3_1x1_upx", "\n", "conv2_3", "=", "conv2_3_prob_reshape", ".", "expand_as", "(", "conv2_3_1x1_increase_bn", ")", "*", "conv2_3_1x1_increase_bn", "+", "conv2_2x", "\n", "conv2_3x", "=", "self", ".", "conv2_3_relu", "(", "conv2_3", ")", "\n", "conv3_1_1x1_reduce", "=", "self", ".", "conv3_1_1x1_reduce", "(", "conv2_3x", ")", "\n", "conv3_1_1x1_reduce_bn", "=", "self", ".", "conv3_1_1x1_reduce_bn", "(", "conv3_1_1x1_reduce", ")", "\n", "conv3_1_1x1_reduce_bnxx", "=", "self", ".", "conv3_1_1x1_reduce_relu", "(", "conv3_1_1x1_reduce_bn", ")", "\n", "conv3_1_3x3", "=", "self", ".", "conv3_1_3x3", "(", "conv3_1_1x1_reduce_bnxx", ")", "\n", "conv3_1_3x3_bn", "=", "self", ".", "conv3_1_3x3_bn", "(", "conv3_1_3x3", ")", "\n", "conv3_1_3x3_bnxx", "=", "self", ".", "conv3_1_3x3_relu", "(", "conv3_1_3x3_bn", ")", "\n", "conv3_1_1x1_increase", "=", "self", ".", "conv3_1_1x1_increase", "(", "conv3_1_3x3_bnxx", ")", "\n", "conv3_1_1x1_increase_bn", "=", "self", ".", "conv3_1_1x1_increase_bn", "(", "conv3_1_1x1_increase", ")", "\n", "conv3_1_global_pool", "=", "self", ".", "conv3_1_global_pool", "(", "conv3_1_1x1_increase_bn", ")", "\n", "conv3_1_1x1_down", "=", "self", ".", "conv3_1_1x1_down", "(", "conv3_1_global_pool", ")", "\n", "conv3_1_1x1_downx", "=", "self", ".", "conv3_1_1x1_down_relu", "(", "conv3_1_1x1_down", ")", "\n", "conv3_1_1x1_up", "=", "self", ".", "conv3_1_1x1_up", "(", "conv3_1_1x1_downx", ")", "\n", "conv3_1_1x1_upx", "=", "self", ".", "conv3_1_prob", "(", "conv3_1_1x1_up", ")", "\n", "conv3_1_prob_reshape", "=", "conv3_1_1x1_upx", "\n", "conv3_1_1x1_proj", "=", "self", ".", "conv3_1_1x1_proj", "(", "conv2_3x", ")", "\n", "conv3_1_1x1_proj_bn", "=", "self", ".", "conv3_1_1x1_proj_bn", "(", "conv3_1_1x1_proj", ")", "\n", "conv3_1", "=", "conv3_1_prob_reshape", ".", "expand_as", "(", "conv3_1_1x1_increase_bn", ")", "*", "conv3_1_1x1_increase_bn", "+", "conv3_1_1x1_proj_bn", "\n", "conv3_1x", "=", "self", ".", "conv3_1_relu", "(", "conv3_1", ")", "\n", "conv3_2_1x1_reduce", "=", "self", ".", "conv3_2_1x1_reduce", "(", "conv3_1x", ")", "\n", "conv3_2_1x1_reduce_bn", "=", "self", ".", "conv3_2_1x1_reduce_bn", "(", "conv3_2_1x1_reduce", ")", "\n", "conv3_2_1x1_reduce_bnxx", "=", "self", ".", "conv3_2_1x1_reduce_relu", "(", "conv3_2_1x1_reduce_bn", ")", "\n", "conv3_2_3x3", "=", "self", ".", "conv3_2_3x3", "(", "conv3_2_1x1_reduce_bnxx", ")", "\n", "conv3_2_3x3_bn", "=", "self", ".", "conv3_2_3x3_bn", "(", "conv3_2_3x3", ")", "\n", "conv3_2_3x3_bnxx", "=", "self", ".", "conv3_2_3x3_relu", "(", "conv3_2_3x3_bn", ")", "\n", "conv3_2_1x1_increase", "=", "self", ".", "conv3_2_1x1_increase", "(", "conv3_2_3x3_bnxx", ")", "\n", "conv3_2_1x1_increase_bn", "=", "self", ".", "conv3_2_1x1_increase_bn", "(", "conv3_2_1x1_increase", ")", "\n", "conv3_2_global_pool", "=", "self", ".", "conv3_2_global_pool", "(", "conv3_2_1x1_increase_bn", ")", "\n", "conv3_2_1x1_down", "=", "self", ".", "conv3_2_1x1_down", "(", "conv3_2_global_pool", ")", "\n", "conv3_2_1x1_downx", "=", "self", ".", "conv3_2_1x1_down_relu", "(", "conv3_2_1x1_down", ")", "\n", "conv3_2_1x1_up", "=", "self", ".", "conv3_2_1x1_up", "(", "conv3_2_1x1_downx", ")", "\n", "conv3_2_1x1_upx", "=", "self", ".", "conv3_2_prob", "(", "conv3_2_1x1_up", ")", "\n", "conv3_2_prob_reshape", "=", "conv3_2_1x1_upx", "\n", "conv3_2", "=", "conv3_2_prob_reshape", ".", "expand_as", "(", "conv3_2_1x1_increase_bn", ")", "*", "conv3_2_1x1_increase_bn", "+", "conv3_1x", "\n", "conv3_2x", "=", "self", ".", "conv3_2_relu", "(", "conv3_2", ")", "\n", "conv3_3_1x1_reduce", "=", "self", ".", "conv3_3_1x1_reduce", "(", "conv3_2x", ")", "\n", "conv3_3_1x1_reduce_bn", "=", "self", ".", "conv3_3_1x1_reduce_bn", "(", "conv3_3_1x1_reduce", ")", "\n", "conv3_3_1x1_reduce_bnxx", "=", "self", ".", "conv3_3_1x1_reduce_relu", "(", "conv3_3_1x1_reduce_bn", ")", "\n", "conv3_3_3x3", "=", "self", ".", "conv3_3_3x3", "(", "conv3_3_1x1_reduce_bnxx", ")", "\n", "conv3_3_3x3_bn", "=", "self", ".", "conv3_3_3x3_bn", "(", "conv3_3_3x3", ")", "\n", "conv3_3_3x3_bnxx", "=", "self", ".", "conv3_3_3x3_relu", "(", "conv3_3_3x3_bn", ")", "\n", "conv3_3_1x1_increase", "=", "self", ".", "conv3_3_1x1_increase", "(", "conv3_3_3x3_bnxx", ")", "\n", "conv3_3_1x1_increase_bn", "=", "self", ".", "conv3_3_1x1_increase_bn", "(", "conv3_3_1x1_increase", ")", "\n", "conv3_3_global_pool", "=", "self", ".", "conv3_3_global_pool", "(", "conv3_3_1x1_increase_bn", ")", "\n", "conv3_3_1x1_down", "=", "self", ".", "conv3_3_1x1_down", "(", "conv3_3_global_pool", ")", "\n", "conv3_3_1x1_downx", "=", "self", ".", "conv3_3_1x1_down_relu", "(", "conv3_3_1x1_down", ")", "\n", "conv3_3_1x1_up", "=", "self", ".", "conv3_3_1x1_up", "(", "conv3_3_1x1_downx", ")", "\n", "conv3_3_1x1_upx", "=", "self", ".", "conv3_3_prob", "(", "conv3_3_1x1_up", ")", "\n", "conv3_3_prob_reshape", "=", "conv3_3_1x1_upx", "\n", "conv3_3", "=", "conv3_3_prob_reshape", ".", "expand_as", "(", "conv3_3_1x1_increase_bn", ")", "*", "conv3_3_1x1_increase_bn", "+", "conv3_2x", "\n", "conv3_3x", "=", "self", ".", "conv3_3_relu", "(", "conv3_3", ")", "\n", "conv3_4_1x1_reduce", "=", "self", ".", "conv3_4_1x1_reduce", "(", "conv3_3x", ")", "\n", "conv3_4_1x1_reduce_bn", "=", "self", ".", "conv3_4_1x1_reduce_bn", "(", "conv3_4_1x1_reduce", ")", "\n", "conv3_4_1x1_reduce_bnxx", "=", "self", ".", "conv3_4_1x1_reduce_relu", "(", "conv3_4_1x1_reduce_bn", ")", "\n", "conv3_4_3x3", "=", "self", ".", "conv3_4_3x3", "(", "conv3_4_1x1_reduce_bnxx", ")", "\n", "conv3_4_3x3_bn", "=", "self", ".", "conv3_4_3x3_bn", "(", "conv3_4_3x3", ")", "\n", "conv3_4_3x3_bnxx", "=", "self", ".", "conv3_4_3x3_relu", "(", "conv3_4_3x3_bn", ")", "\n", "conv3_4_1x1_increase", "=", "self", ".", "conv3_4_1x1_increase", "(", "conv3_4_3x3_bnxx", ")", "\n", "conv3_4_1x1_increase_bn", "=", "self", ".", "conv3_4_1x1_increase_bn", "(", "conv3_4_1x1_increase", ")", "\n", "conv3_4_global_pool", "=", "self", ".", "conv3_4_global_pool", "(", "conv3_4_1x1_increase_bn", ")", "\n", "conv3_4_1x1_down", "=", "self", ".", "conv3_4_1x1_down", "(", "conv3_4_global_pool", ")", "\n", "conv3_4_1x1_downx", "=", "self", ".", "conv3_4_1x1_down_relu", "(", "conv3_4_1x1_down", ")", "\n", "conv3_4_1x1_up", "=", "self", ".", "conv3_4_1x1_up", "(", "conv3_4_1x1_downx", ")", "\n", "conv3_4_1x1_upx", "=", "self", ".", "conv3_4_prob", "(", "conv3_4_1x1_up", ")", "\n", "conv3_4_prob_reshape", "=", "conv3_4_1x1_upx", "\n", "conv3_4", "=", "conv3_4_prob_reshape", ".", "expand_as", "(", "conv3_4_1x1_increase_bn", ")", "*", "conv3_4_1x1_increase_bn", "+", "conv3_3x", "\n", "conv3_4x", "=", "self", ".", "conv3_4_relu", "(", "conv3_4", ")", "\n", "conv4_1_1x1_reduce", "=", "self", ".", "conv4_1_1x1_reduce", "(", "conv3_4x", ")", "\n", "conv4_1_1x1_reduce_bn", "=", "self", ".", "conv4_1_1x1_reduce_bn", "(", "conv4_1_1x1_reduce", ")", "\n", "conv4_1_1x1_reduce_bnxx", "=", "self", ".", "conv4_1_1x1_reduce_relu", "(", "conv4_1_1x1_reduce_bn", ")", "\n", "conv4_1_3x3", "=", "self", ".", "conv4_1_3x3", "(", "conv4_1_1x1_reduce_bnxx", ")", "\n", "conv4_1_3x3_bn", "=", "self", ".", "conv4_1_3x3_bn", "(", "conv4_1_3x3", ")", "\n", "conv4_1_3x3_bnxx", "=", "self", ".", "conv4_1_3x3_relu", "(", "conv4_1_3x3_bn", ")", "\n", "conv4_1_1x1_increase", "=", "self", ".", "conv4_1_1x1_increase", "(", "conv4_1_3x3_bnxx", ")", "\n", "conv4_1_1x1_increase_bn", "=", "self", ".", "conv4_1_1x1_increase_bn", "(", "conv4_1_1x1_increase", ")", "\n", "conv4_1_global_pool", "=", "self", ".", "conv4_1_global_pool", "(", "conv4_1_1x1_increase_bn", ")", "\n", "conv4_1_1x1_down", "=", "self", ".", "conv4_1_1x1_down", "(", "conv4_1_global_pool", ")", "\n", "conv4_1_1x1_downx", "=", "self", ".", "conv4_1_1x1_down_relu", "(", "conv4_1_1x1_down", ")", "\n", "conv4_1_1x1_up", "=", "self", ".", "conv4_1_1x1_up", "(", "conv4_1_1x1_downx", ")", "\n", "conv4_1_1x1_upx", "=", "self", ".", "conv4_1_prob", "(", "conv4_1_1x1_up", ")", "\n", "conv4_1_prob_reshape", "=", "conv4_1_1x1_upx", "\n", "conv4_1_1x1_proj", "=", "self", ".", "conv4_1_1x1_proj", "(", "conv3_4x", ")", "\n", "conv4_1_1x1_proj_bn", "=", "self", ".", "conv4_1_1x1_proj_bn", "(", "conv4_1_1x1_proj", ")", "\n", "conv4_1", "=", "conv4_1_prob_reshape", ".", "expand_as", "(", "conv4_1_1x1_increase_bn", ")", "*", "conv4_1_1x1_increase_bn", "+", "conv4_1_1x1_proj_bn", "\n", "conv4_1x", "=", "self", ".", "conv4_1_relu", "(", "conv4_1", ")", "\n", "conv4_2_1x1_reduce", "=", "self", ".", "conv4_2_1x1_reduce", "(", "conv4_1x", ")", "\n", "conv4_2_1x1_reduce_bn", "=", "self", ".", "conv4_2_1x1_reduce_bn", "(", "conv4_2_1x1_reduce", ")", "\n", "conv4_2_1x1_reduce_bnxx", "=", "self", ".", "conv4_2_1x1_reduce_relu", "(", "conv4_2_1x1_reduce_bn", ")", "\n", "conv4_2_3x3", "=", "self", ".", "conv4_2_3x3", "(", "conv4_2_1x1_reduce_bnxx", ")", "\n", "conv4_2_3x3_bn", "=", "self", ".", "conv4_2_3x3_bn", "(", "conv4_2_3x3", ")", "\n", "conv4_2_3x3_bnxx", "=", "self", ".", "conv4_2_3x3_relu", "(", "conv4_2_3x3_bn", ")", "\n", "conv4_2_1x1_increase", "=", "self", ".", "conv4_2_1x1_increase", "(", "conv4_2_3x3_bnxx", ")", "\n", "conv4_2_1x1_increase_bn", "=", "self", ".", "conv4_2_1x1_increase_bn", "(", "conv4_2_1x1_increase", ")", "\n", "conv4_2_global_pool", "=", "self", ".", "conv4_2_global_pool", "(", "conv4_2_1x1_increase_bn", ")", "\n", "conv4_2_1x1_down", "=", "self", ".", "conv4_2_1x1_down", "(", "conv4_2_global_pool", ")", "\n", "conv4_2_1x1_downx", "=", "self", ".", "conv4_2_1x1_down_relu", "(", "conv4_2_1x1_down", ")", "\n", "conv4_2_1x1_up", "=", "self", ".", "conv4_2_1x1_up", "(", "conv4_2_1x1_downx", ")", "\n", "conv4_2_1x1_upx", "=", "self", ".", "conv4_2_prob", "(", "conv4_2_1x1_up", ")", "\n", "conv4_2_prob_reshape", "=", "conv4_2_1x1_upx", "\n", "conv4_2", "=", "conv4_2_prob_reshape", ".", "expand_as", "(", "conv4_2_1x1_increase_bn", ")", "*", "conv4_2_1x1_increase_bn", "+", "conv4_1x", "\n", "conv4_2x", "=", "self", ".", "conv4_2_relu", "(", "conv4_2", ")", "\n", "conv4_3_1x1_reduce", "=", "self", ".", "conv4_3_1x1_reduce", "(", "conv4_2x", ")", "\n", "conv4_3_1x1_reduce_bn", "=", "self", ".", "conv4_3_1x1_reduce_bn", "(", "conv4_3_1x1_reduce", ")", "\n", "conv4_3_1x1_reduce_bnxx", "=", "self", ".", "conv4_3_1x1_reduce_relu", "(", "conv4_3_1x1_reduce_bn", ")", "\n", "conv4_3_3x3", "=", "self", ".", "conv4_3_3x3", "(", "conv4_3_1x1_reduce_bnxx", ")", "\n", "conv4_3_3x3_bn", "=", "self", ".", "conv4_3_3x3_bn", "(", "conv4_3_3x3", ")", "\n", "conv4_3_3x3_bnxx", "=", "self", ".", "conv4_3_3x3_relu", "(", "conv4_3_3x3_bn", ")", "\n", "conv4_3_1x1_increase", "=", "self", ".", "conv4_3_1x1_increase", "(", "conv4_3_3x3_bnxx", ")", "\n", "conv4_3_1x1_increase_bn", "=", "self", ".", "conv4_3_1x1_increase_bn", "(", "conv4_3_1x1_increase", ")", "\n", "conv4_3_global_pool", "=", "self", ".", "conv4_3_global_pool", "(", "conv4_3_1x1_increase_bn", ")", "\n", "conv4_3_1x1_down", "=", "self", ".", "conv4_3_1x1_down", "(", "conv4_3_global_pool", ")", "\n", "conv4_3_1x1_downx", "=", "self", ".", "conv4_3_1x1_down_relu", "(", "conv4_3_1x1_down", ")", "\n", "conv4_3_1x1_up", "=", "self", ".", "conv4_3_1x1_up", "(", "conv4_3_1x1_downx", ")", "\n", "conv4_3_1x1_upx", "=", "self", ".", "conv4_3_prob", "(", "conv4_3_1x1_up", ")", "\n", "conv4_3_prob_reshape", "=", "conv4_3_1x1_upx", "\n", "conv4_3", "=", "conv4_3_prob_reshape", ".", "expand_as", "(", "conv4_3_1x1_increase_bn", ")", "*", "conv4_3_1x1_increase_bn", "+", "conv4_2x", "\n", "conv4_3x", "=", "self", ".", "conv4_3_relu", "(", "conv4_3", ")", "\n", "conv4_4_1x1_reduce", "=", "self", ".", "conv4_4_1x1_reduce", "(", "conv4_3x", ")", "\n", "conv4_4_1x1_reduce_bn", "=", "self", ".", "conv4_4_1x1_reduce_bn", "(", "conv4_4_1x1_reduce", ")", "\n", "conv4_4_1x1_reduce_bnxx", "=", "self", ".", "conv4_4_1x1_reduce_relu", "(", "conv4_4_1x1_reduce_bn", ")", "\n", "conv4_4_3x3", "=", "self", ".", "conv4_4_3x3", "(", "conv4_4_1x1_reduce_bnxx", ")", "\n", "conv4_4_3x3_bn", "=", "self", ".", "conv4_4_3x3_bn", "(", "conv4_4_3x3", ")", "\n", "conv4_4_3x3_bnxx", "=", "self", ".", "conv4_4_3x3_relu", "(", "conv4_4_3x3_bn", ")", "\n", "conv4_4_1x1_increase", "=", "self", ".", "conv4_4_1x1_increase", "(", "conv4_4_3x3_bnxx", ")", "\n", "conv4_4_1x1_increase_bn", "=", "self", ".", "conv4_4_1x1_increase_bn", "(", "conv4_4_1x1_increase", ")", "\n", "conv4_4_global_pool", "=", "self", ".", "conv4_4_global_pool", "(", "conv4_4_1x1_increase_bn", ")", "\n", "conv4_4_1x1_down", "=", "self", ".", "conv4_4_1x1_down", "(", "conv4_4_global_pool", ")", "\n", "conv4_4_1x1_downx", "=", "self", ".", "conv4_4_1x1_down_relu", "(", "conv4_4_1x1_down", ")", "\n", "conv4_4_1x1_up", "=", "self", ".", "conv4_4_1x1_up", "(", "conv4_4_1x1_downx", ")", "\n", "conv4_4_1x1_upx", "=", "self", ".", "conv4_4_prob", "(", "conv4_4_1x1_up", ")", "\n", "conv4_4_prob_reshape", "=", "conv4_4_1x1_upx", "\n", "conv4_4", "=", "conv4_4_prob_reshape", ".", "expand_as", "(", "conv4_4_1x1_increase_bn", ")", "*", "conv4_4_1x1_increase_bn", "+", "conv4_3x", "\n", "conv4_4x", "=", "self", ".", "conv4_4_relu", "(", "conv4_4", ")", "\n", "conv4_5_1x1_reduce", "=", "self", ".", "conv4_5_1x1_reduce", "(", "conv4_4x", ")", "\n", "conv4_5_1x1_reduce_bn", "=", "self", ".", "conv4_5_1x1_reduce_bn", "(", "conv4_5_1x1_reduce", ")", "\n", "conv4_5_1x1_reduce_bnxx", "=", "self", ".", "conv4_5_1x1_reduce_relu", "(", "conv4_5_1x1_reduce_bn", ")", "\n", "conv4_5_3x3", "=", "self", ".", "conv4_5_3x3", "(", "conv4_5_1x1_reduce_bnxx", ")", "\n", "conv4_5_3x3_bn", "=", "self", ".", "conv4_5_3x3_bn", "(", "conv4_5_3x3", ")", "\n", "conv4_5_3x3_bnxx", "=", "self", ".", "conv4_5_3x3_relu", "(", "conv4_5_3x3_bn", ")", "\n", "conv4_5_1x1_increase", "=", "self", ".", "conv4_5_1x1_increase", "(", "conv4_5_3x3_bnxx", ")", "\n", "conv4_5_1x1_increase_bn", "=", "self", ".", "conv4_5_1x1_increase_bn", "(", "conv4_5_1x1_increase", ")", "\n", "conv4_5_global_pool", "=", "self", ".", "conv4_5_global_pool", "(", "conv4_5_1x1_increase_bn", ")", "\n", "conv4_5_1x1_down", "=", "self", ".", "conv4_5_1x1_down", "(", "conv4_5_global_pool", ")", "\n", "conv4_5_1x1_downx", "=", "self", ".", "conv4_5_1x1_down_relu", "(", "conv4_5_1x1_down", ")", "\n", "conv4_5_1x1_up", "=", "self", ".", "conv4_5_1x1_up", "(", "conv4_5_1x1_downx", ")", "\n", "conv4_5_1x1_upx", "=", "self", ".", "conv4_5_prob", "(", "conv4_5_1x1_up", ")", "\n", "conv4_5_prob_reshape", "=", "conv4_5_1x1_upx", "\n", "conv4_5", "=", "conv4_5_prob_reshape", ".", "expand_as", "(", "conv4_5_1x1_increase_bn", ")", "*", "conv4_5_1x1_increase_bn", "+", "conv4_4x", "\n", "conv4_5x", "=", "self", ".", "conv4_5_relu", "(", "conv4_5", ")", "\n", "conv4_6_1x1_reduce", "=", "self", ".", "conv4_6_1x1_reduce", "(", "conv4_5x", ")", "\n", "conv4_6_1x1_reduce_bn", "=", "self", ".", "conv4_6_1x1_reduce_bn", "(", "conv4_6_1x1_reduce", ")", "\n", "conv4_6_1x1_reduce_bnxx", "=", "self", ".", "conv4_6_1x1_reduce_relu", "(", "conv4_6_1x1_reduce_bn", ")", "\n", "conv4_6_3x3", "=", "self", ".", "conv4_6_3x3", "(", "conv4_6_1x1_reduce_bnxx", ")", "\n", "conv4_6_3x3_bn", "=", "self", ".", "conv4_6_3x3_bn", "(", "conv4_6_3x3", ")", "\n", "conv4_6_3x3_bnxx", "=", "self", ".", "conv4_6_3x3_relu", "(", "conv4_6_3x3_bn", ")", "\n", "conv4_6_1x1_increase", "=", "self", ".", "conv4_6_1x1_increase", "(", "conv4_6_3x3_bnxx", ")", "\n", "conv4_6_1x1_increase_bn", "=", "self", ".", "conv4_6_1x1_increase_bn", "(", "conv4_6_1x1_increase", ")", "\n", "conv4_6_global_pool", "=", "self", ".", "conv4_6_global_pool", "(", "conv4_6_1x1_increase_bn", ")", "\n", "conv4_6_1x1_down", "=", "self", ".", "conv4_6_1x1_down", "(", "conv4_6_global_pool", ")", "\n", "conv4_6_1x1_downx", "=", "self", ".", "conv4_6_1x1_down_relu", "(", "conv4_6_1x1_down", ")", "\n", "conv4_6_1x1_up", "=", "self", ".", "conv4_6_1x1_up", "(", "conv4_6_1x1_downx", ")", "\n", "conv4_6_1x1_upx", "=", "self", ".", "conv4_6_prob", "(", "conv4_6_1x1_up", ")", "\n", "conv4_6_prob_reshape", "=", "conv4_6_1x1_upx", "\n", "conv4_6", "=", "conv4_6_prob_reshape", ".", "expand_as", "(", "conv4_6_1x1_increase_bn", ")", "*", "conv4_6_1x1_increase_bn", "+", "conv4_5x", "\n", "conv4_6x", "=", "self", ".", "conv4_6_relu", "(", "conv4_6", ")", "\n", "conv5_1_1x1_reduce", "=", "self", ".", "conv5_1_1x1_reduce", "(", "conv4_6x", ")", "\n", "conv5_1_1x1_reduce_bn", "=", "self", ".", "conv5_1_1x1_reduce_bn", "(", "conv5_1_1x1_reduce", ")", "\n", "conv5_1_1x1_reduce_bnxx", "=", "self", ".", "conv5_1_1x1_reduce_relu", "(", "conv5_1_1x1_reduce_bn", ")", "\n", "conv5_1_3x3", "=", "self", ".", "conv5_1_3x3", "(", "conv5_1_1x1_reduce_bnxx", ")", "\n", "conv5_1_3x3_bn", "=", "self", ".", "conv5_1_3x3_bn", "(", "conv5_1_3x3", ")", "\n", "conv5_1_3x3_bnxx", "=", "self", ".", "conv5_1_3x3_relu", "(", "conv5_1_3x3_bn", ")", "\n", "conv5_1_1x1_increase", "=", "self", ".", "conv5_1_1x1_increase", "(", "conv5_1_3x3_bnxx", ")", "\n", "conv5_1_1x1_increase_bn", "=", "self", ".", "conv5_1_1x1_increase_bn", "(", "conv5_1_1x1_increase", ")", "\n", "conv5_1_global_pool", "=", "self", ".", "conv5_1_global_pool", "(", "conv5_1_1x1_increase_bn", ")", "\n", "conv5_1_1x1_down", "=", "self", ".", "conv5_1_1x1_down", "(", "conv5_1_global_pool", ")", "\n", "conv5_1_1x1_downx", "=", "self", ".", "conv5_1_1x1_down_relu", "(", "conv5_1_1x1_down", ")", "\n", "conv5_1_1x1_up", "=", "self", ".", "conv5_1_1x1_up", "(", "conv5_1_1x1_downx", ")", "\n", "conv5_1_1x1_upx", "=", "self", ".", "conv5_1_prob", "(", "conv5_1_1x1_up", ")", "\n", "conv5_1_prob_reshape", "=", "conv5_1_1x1_upx", "\n", "conv5_1_1x1_proj", "=", "self", ".", "conv5_1_1x1_proj", "(", "conv4_6x", ")", "\n", "conv5_1_1x1_proj_bn", "=", "self", ".", "conv5_1_1x1_proj_bn", "(", "conv5_1_1x1_proj", ")", "\n", "conv5_1", "=", "conv5_1_prob_reshape", ".", "expand_as", "(", "conv5_1_1x1_increase_bn", ")", "*", "conv5_1_1x1_increase_bn", "+", "conv5_1_1x1_proj_bn", "\n", "conv5_1x", "=", "self", ".", "conv5_1_relu", "(", "conv5_1", ")", "\n", "conv5_2_1x1_reduce", "=", "self", ".", "conv5_2_1x1_reduce", "(", "conv5_1x", ")", "\n", "conv5_2_1x1_reduce_bn", "=", "self", ".", "conv5_2_1x1_reduce_bn", "(", "conv5_2_1x1_reduce", ")", "\n", "conv5_2_1x1_reduce_bnxx", "=", "self", ".", "conv5_2_1x1_reduce_relu", "(", "conv5_2_1x1_reduce_bn", ")", "\n", "conv5_2_3x3", "=", "self", ".", "conv5_2_3x3", "(", "conv5_2_1x1_reduce_bnxx", ")", "\n", "conv5_2_3x3_bn", "=", "self", ".", "conv5_2_3x3_bn", "(", "conv5_2_3x3", ")", "\n", "conv5_2_3x3_bnxx", "=", "self", ".", "conv5_2_3x3_relu", "(", "conv5_2_3x3_bn", ")", "\n", "conv5_2_1x1_increase", "=", "self", ".", "conv5_2_1x1_increase", "(", "conv5_2_3x3_bnxx", ")", "\n", "conv5_2_1x1_increase_bn", "=", "self", ".", "conv5_2_1x1_increase_bn", "(", "conv5_2_1x1_increase", ")", "\n", "conv5_2_global_pool", "=", "self", ".", "conv5_2_global_pool", "(", "conv5_2_1x1_increase_bn", ")", "\n", "conv5_2_1x1_down", "=", "self", ".", "conv5_2_1x1_down", "(", "conv5_2_global_pool", ")", "\n", "conv5_2_1x1_downx", "=", "self", ".", "conv5_2_1x1_down_relu", "(", "conv5_2_1x1_down", ")", "\n", "conv5_2_1x1_up", "=", "self", ".", "conv5_2_1x1_up", "(", "conv5_2_1x1_downx", ")", "\n", "conv5_2_1x1_upx", "=", "self", ".", "conv5_2_prob", "(", "conv5_2_1x1_up", ")", "\n", "conv5_2_prob_reshape", "=", "conv5_2_1x1_upx", "\n", "conv5_2", "=", "conv5_2_prob_reshape", ".", "expand_as", "(", "conv5_2_1x1_increase_bn", ")", "*", "conv5_2_1x1_increase_bn", "+", "conv5_1x", "\n", "conv5_2x", "=", "self", ".", "conv5_2_relu", "(", "conv5_2", ")", "\n", "conv5_3_1x1_reduce", "=", "self", ".", "conv5_3_1x1_reduce", "(", "conv5_2x", ")", "\n", "conv5_3_1x1_reduce_bn", "=", "self", ".", "conv5_3_1x1_reduce_bn", "(", "conv5_3_1x1_reduce", ")", "\n", "conv5_3_1x1_reduce_bnxx", "=", "self", ".", "conv5_3_1x1_reduce_relu", "(", "conv5_3_1x1_reduce_bn", ")", "\n", "conv5_3_3x3", "=", "self", ".", "conv5_3_3x3", "(", "conv5_3_1x1_reduce_bnxx", ")", "\n", "conv5_3_3x3_bn", "=", "self", ".", "conv5_3_3x3_bn", "(", "conv5_3_3x3", ")", "\n", "conv5_3_3x3_bnxx", "=", "self", ".", "conv5_3_3x3_relu", "(", "conv5_3_3x3_bn", ")", "\n", "conv5_3_1x1_increase", "=", "self", ".", "conv5_3_1x1_increase", "(", "conv5_3_3x3_bnxx", ")", "\n", "conv5_3_1x1_increase_bn", "=", "self", ".", "conv5_3_1x1_increase_bn", "(", "conv5_3_1x1_increase", ")", "\n", "conv5_3_global_pool", "=", "self", ".", "conv5_3_global_pool", "(", "conv5_3_1x1_increase_bn", ")", "\n", "conv5_3_1x1_down", "=", "self", ".", "conv5_3_1x1_down", "(", "conv5_3_global_pool", ")", "\n", "conv5_3_1x1_downx", "=", "self", ".", "conv5_3_1x1_down_relu", "(", "conv5_3_1x1_down", ")", "\n", "conv5_3_1x1_up", "=", "self", ".", "conv5_3_1x1_up", "(", "conv5_3_1x1_downx", ")", "\n", "conv5_3_1x1_upx", "=", "self", ".", "conv5_3_prob", "(", "conv5_3_1x1_up", ")", "\n", "conv5_3_prob_reshape", "=", "conv5_3_1x1_upx", "\n", "conv5_3", "=", "conv5_3_prob_reshape", ".", "expand_as", "(", "conv5_3_1x1_increase_bn", ")", "*", "conv5_3_1x1_increase_bn", "+", "conv5_2x", "\n", "conv5_3x", "=", "self", ".", "conv5_3_relu", "(", "conv5_3", ")", "\n", "conv5_3x_global_pool", "=", "self", ".", "conv5_3x_global_pool", "(", "conv5_3x", ")", "\n", "feature_flatten", "=", "conv5_3x_global_pool", ".", "view", "(", "conv5_3x_global_pool", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "return", "feature_flatten", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.vggface2.resnet50_scratch_dag": [[868, 880], ["vggface2.ResNet50ScratchDAG", "torch.load", "torch.load", "ResNet50ScratchDAG.load_state_dict"], "function", ["None"], ["", "", "def", "resnet50_scratch_dag", "(", "weights_path", "=", "None", ")", ":", "\n", "    ", "\"\"\"\n    load imported model instance\n\n    Args:\n        weights_path (str): If set, loads model weights from the given path\n    \"\"\"", "\n", "model", "=", "ResNet50ScratchDAG", "(", ")", "\n", "if", "weights_path", ":", "\n", "        ", "state_dict", "=", "torch", ".", "load", "(", "weights_path", ")", "\n", "model", ".", "load_state_dict", "(", "state_dict", ")", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.vggface2.senet50_scratch_dag": [[882, 894], ["vggface2.SeNet50ScratchDAG", "torch.load", "torch.load", "SeNet50ScratchDAG.load_state_dict"], "function", ["None"], ["", "def", "senet50_scratch_dag", "(", "weights_path", "=", "None", ")", ":", "\n", "    ", "\"\"\"\n    load imported model instance\n\n    Args:\n        weights_path (str): If set, loads model weights from the given path\n    \"\"\"", "\n", "model", "=", "SeNet50ScratchDAG", "(", ")", "\n", "if", "weights_path", ":", "\n", "        ", "state_dict", "=", "torch", ".", "load", "(", "weights_path", ")", "\n", "model", ".", "load_state_dict", "(", "state_dict", ")", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.ArcMarginProduct.__init__": [[24, 38], ["torch.Module.__init__", "torch.nn.Parameter", "torch.nn.Parameter", "torch.nn.Parameter", "torch.init.xavier_uniform_", "torch.init.xavier_uniform_", "torch.init.xavier_uniform_", "math.cos", "math.sin", "math.cos", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "math.sin"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["def", "__init__", "(", "self", ",", "in_features", ",", "out_features", ",", "s", "=", "30.0", ",", "m", "=", "0.50", ",", "easy_margin", "=", "False", ")", ":", "\n", "        ", "super", "(", "ArcMarginProduct", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_features", "=", "in_features", "\n", "self", ".", "out_features", "=", "out_features", "\n", "self", ".", "s", "=", "s", "\n", "self", ".", "m", "=", "m", "\n", "self", ".", "weight", "=", "Parameter", "(", "torch", ".", "FloatTensor", "(", "out_features", ",", "in_features", ")", ")", "\n", "nn", ".", "init", ".", "xavier_uniform_", "(", "self", ".", "weight", ")", "\n", "\n", "self", ".", "easy_margin", "=", "easy_margin", "\n", "self", ".", "cos_m", "=", "math", ".", "cos", "(", "m", ")", "\n", "self", ".", "sin_m", "=", "math", ".", "sin", "(", "m", ")", "\n", "self", ".", "th", "=", "math", ".", "cos", "(", "math", ".", "pi", "-", "m", ")", "\n", "self", ".", "mm", "=", "math", ".", "sin", "(", "math", ".", "pi", "-", "m", ")", "*", "m", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.ArcMarginProduct.forward": [[40, 59], ["torch.linear", "torch.linear", "torch.linear", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.linear.size", "label.view().long", "label.view", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "label", ")", ":", "\n", "# --------------------------- cos(theta) & phi(theta) ---------------------------", "\n", "        ", "cosine", "=", "F", ".", "linear", "(", "F", ".", "normalize", "(", "input", ")", ",", "F", ".", "normalize", "(", "self", ".", "weight", ")", ")", "\n", "sine", "=", "torch", ".", "sqrt", "(", "(", "1.0", "-", "torch", ".", "pow", "(", "cosine", ",", "2", ")", ")", ".", "clamp", "(", "0", ",", "1", ")", ")", "\n", "phi", "=", "cosine", "*", "self", ".", "cos_m", "-", "sine", "*", "self", ".", "sin_m", "\n", "if", "self", ".", "easy_margin", ":", "\n", "            ", "phi", "=", "torch", ".", "where", "(", "cosine", ">", "0", ",", "phi", ",", "cosine", ")", "\n", "", "else", ":", "\n", "            ", "phi", "=", "torch", ".", "where", "(", "cosine", ">", "self", ".", "th", ",", "phi", ",", "cosine", "-", "self", ".", "mm", ")", "\n", "# --------------------------- convert label to one-hot ---------------------------", "\n", "# one_hot = torch.zeros(cosine.size(), requires_grad=True, device='cuda')", "\n", "", "one_hot", "=", "torch", ".", "zeros", "(", "cosine", ".", "size", "(", ")", ",", "device", "=", "'cuda'", ")", "\n", "one_hot", ".", "scatter_", "(", "1", ",", "label", ".", "view", "(", "-", "1", ",", "1", ")", ".", "long", "(", ")", ",", "1", ")", "\n", "# -------------torch.where(out_i = {x_i if condition_i else y_i) -------------", "\n", "output", "=", "(", "one_hot", "*", "phi", ")", "+", "(", "(", "1.0", "-", "one_hot", ")", "*", "cosine", ")", "# you can use torch.where if your torch.__version__ is 0.4", "\n", "output", "*=", "self", ".", "s", "\n", "# print(output)", "\n", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.AddMarginProduct.__init__": [[71, 79], ["torch.Module.__init__", "torch.nn.Parameter", "torch.nn.Parameter", "torch.nn.Parameter", "torch.init.xavier_uniform_", "torch.init.xavier_uniform_", "torch.init.xavier_uniform_", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["def", "__init__", "(", "self", ",", "in_features", ",", "out_features", ",", "s", "=", "30.0", ",", "m", "=", "0.40", ")", ":", "\n", "        ", "super", "(", "AddMarginProduct", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_features", "=", "in_features", "\n", "self", ".", "out_features", "=", "out_features", "\n", "self", ".", "s", "=", "s", "\n", "self", ".", "m", "=", "m", "\n", "self", ".", "weight", "=", "Parameter", "(", "torch", ".", "FloatTensor", "(", "out_features", ",", "in_features", ")", ")", "\n", "nn", ".", "init", ".", "xavier_uniform_", "(", "self", ".", "weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.AddMarginProduct.forward": [[81, 95], ["torch.linear", "torch.linear", "torch.linear", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.linear.size", "label.view().long", "label.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "label", ")", ":", "\n", "# --------------------------- cos(theta) & phi(theta) ---------------------------", "\n", "        ", "cosine", "=", "F", ".", "linear", "(", "F", ".", "normalize", "(", "input", ")", ",", "F", ".", "normalize", "(", "self", ".", "weight", ")", ")", "\n", "phi", "=", "cosine", "-", "self", ".", "m", "\n", "# --------------------------- convert label to one-hot ---------------------------", "\n", "one_hot", "=", "torch", ".", "zeros", "(", "cosine", ".", "size", "(", ")", ",", "device", "=", "'cuda'", ")", "\n", "# one_hot = one_hot.cuda() if cosine.is_cuda else one_hot", "\n", "one_hot", ".", "scatter_", "(", "1", ",", "label", ".", "view", "(", "-", "1", ",", "1", ")", ".", "long", "(", ")", ",", "1", ")", "\n", "# -------------torch.where(out_i = {x_i if condition_i else y_i) -------------", "\n", "output", "=", "(", "one_hot", "*", "phi", ")", "+", "(", "(", "1.0", "-", "one_hot", ")", "*", "cosine", ")", "# you can use torch.where if your torch.__version__ is 0.4", "\n", "output", "*=", "self", ".", "s", "\n", "# print(output)", "\n", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.AddMarginProduct.__repr__": [[97, 103], ["str", "str", "str", "str"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "__class__", ".", "__name__", "+", "'('", "+", "'in_features='", "+", "str", "(", "self", ".", "in_features", ")", "+", "', out_features='", "+", "str", "(", "self", ".", "out_features", ")", "+", "', s='", "+", "str", "(", "self", ".", "s", ")", "+", "', m='", "+", "str", "(", "self", ".", "m", ")", "+", "')'", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.SphereProduct.__init__": [[114, 135], ["torch.Module.__init__", "torch.nn.Parameter", "torch.nn.Parameter", "torch.nn.Parameter", "torch.init.xavier_uniform", "torch.init.xavier_uniform", "torch.init.xavier_uniform", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["def", "__init__", "(", "self", ",", "in_features", ",", "out_features", ",", "m", "=", "4", ")", ":", "\n", "        ", "super", "(", "SphereProduct", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_features", "=", "in_features", "\n", "self", ".", "out_features", "=", "out_features", "\n", "self", ".", "m", "=", "m", "\n", "self", ".", "base", "=", "1000.0", "\n", "self", ".", "gamma", "=", "0.12", "\n", "self", ".", "power", "=", "1", "\n", "self", ".", "LambdaMin", "=", "5.0", "\n", "self", ".", "iter", "=", "0", "\n", "self", ".", "weight", "=", "Parameter", "(", "torch", ".", "FloatTensor", "(", "out_features", ",", "in_features", ")", ")", "\n", "nn", ".", "init", ".", "xavier_uniform", "(", "self", ".", "weight", ")", "\n", "\n", "# duplication formula", "\n", "self", ".", "mlambda", "=", "[", "\n", "lambda", "x", ":", "x", "**", "0", ",", "\n", "lambda", "x", ":", "x", "**", "1", ",", "\n", "lambda", "x", ":", "2", "*", "x", "**", "2", "-", "1", ",", "\n", "lambda", "x", ":", "4", "*", "x", "**", "3", "-", "3", "*", "x", ",", "\n", "lambda", "x", ":", "8", "*", "x", "**", "4", "-", "8", "*", "x", "**", "2", "+", "1", ",", "\n", "lambda", "x", ":", "16", "*", "x", "**", "5", "-", "20", "*", "x", "**", "3", "+", "5", "*", "x", "\n", "]", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.SphereProduct.forward": [[138, 162], ["max", "torch.linear", "torch.linear", "torch.linear", "cos_theta.clamp.clamp.clamp", "cos_theta.clamp.clamp.data.acos", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.norm.view", "torch.norm.view", "torch.norm.view", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "cos_theta.clamp.clamp.size", "torch.zeros.cuda", "torch.zeros.cuda", "torch.zeros.cuda", "label.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "label", ")", ":", "\n", "# lambda = max(lambda_min,base*(1+gamma*iteration)^(-power))", "\n", "        ", "self", ".", "iter", "+=", "1", "\n", "self", ".", "lamb", "=", "max", "(", "self", ".", "LambdaMin", ",", "self", ".", "base", "*", "(", "1", "+", "self", ".", "gamma", "*", "self", ".", "iter", ")", "**", "(", "-", "1", "*", "self", ".", "power", ")", ")", "\n", "\n", "# --------------------------- cos(theta) & phi(theta) ---------------------------", "\n", "cos_theta", "=", "F", ".", "linear", "(", "F", ".", "normalize", "(", "input", ")", ",", "F", ".", "normalize", "(", "self", ".", "weight", ")", ")", "\n", "cos_theta", "=", "cos_theta", ".", "clamp", "(", "-", "1", ",", "1", ")", "\n", "cos_m_theta", "=", "self", ".", "mlambda", "[", "self", ".", "m", "]", "(", "cos_theta", ")", "\n", "theta", "=", "cos_theta", ".", "data", ".", "acos", "(", ")", "\n", "k", "=", "(", "self", ".", "m", "*", "theta", "/", "3.14159265", ")", ".", "floor", "(", ")", "\n", "phi_theta", "=", "(", "(", "-", "1.0", ")", "**", "k", ")", "*", "cos_m_theta", "-", "2", "*", "k", "\n", "NormOfFeature", "=", "torch", ".", "norm", "(", "input", ",", "2", ",", "1", ")", "\n", "\n", "# --------------------------- convert label to one-hot ---------------------------", "\n", "one_hot", "=", "torch", ".", "zeros", "(", "cos_theta", ".", "size", "(", ")", ")", "\n", "one_hot", "=", "one_hot", ".", "cuda", "(", ")", "if", "cos_theta", ".", "is_cuda", "else", "one_hot", "\n", "one_hot", ".", "scatter_", "(", "1", ",", "label", ".", "view", "(", "-", "1", ",", "1", ")", ",", "1", ")", "\n", "\n", "# --------------------------- Calculate output ---------------------------", "\n", "output", "=", "(", "one_hot", "*", "(", "phi_theta", "-", "cos_theta", ")", "/", "(", "1", "+", "self", ".", "lamb", ")", ")", "+", "cos_theta", "\n", "output", "*=", "NormOfFeature", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.metrics.SphereProduct.__repr__": [[164, 169], ["str", "str", "str"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "__class__", ".", "__name__", "+", "'('", "+", "'in_features='", "+", "str", "(", "self", ".", "in_features", ")", "+", "', out_features='", "+", "str", "(", "self", ".", "out_features", ")", "+", "', m='", "+", "str", "(", "self", ".", "m", ")", "+", "')'", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.BasicBlock.__init__": [[22, 31], ["torch.Module.__init__", "resnet.conv3x3", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "resnet.conv3x3", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.conv3x3", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.conv3x3"], ["def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "stride", "=", "1", ",", "downsample", "=", "None", ")", ":", "\n", "        ", "super", "(", "BasicBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "conv3x3", "(", "inplanes", ",", "planes", ",", "stride", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv2", "=", "conv3x3", "(", "planes", ",", "planes", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "stride", "=", "stride", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.BasicBlock.forward": [[33, 50], ["resnet.BasicBlock.conv1", "resnet.BasicBlock.bn1", "resnet.BasicBlock.relu", "resnet.BasicBlock.conv2", "resnet.BasicBlock.bn2", "resnet.BasicBlock.relu", "resnet.BasicBlock.downsample"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "residual", "=", "x", "\n", "\n", "out", "=", "self", ".", "conv1", "(", "x", ")", "\n", "out", "=", "self", ".", "bn1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "out", "=", "self", ".", "bn2", "(", "out", ")", "\n", "\n", "if", "self", ".", "downsample", "is", "not", "None", ":", "\n", "            ", "residual", "=", "self", ".", "downsample", "(", "x", ")", "\n", "\n", "", "out", "+=", "residual", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.IRBlock.__init__": [[56, 69], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "resnet.conv3x3", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.PReLU", "torch.PReLU", "resnet.conv3x3", "torch.BatchNorm2d", "torch.BatchNorm2d", "resnet.SEBlock"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.conv3x3", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.conv3x3"], ["def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "stride", "=", "1", ",", "downsample", "=", "None", ",", "use_se", "=", "True", ")", ":", "\n", "        ", "super", "(", "IRBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn0", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "self", ".", "conv1", "=", "conv3x3", "(", "inplanes", ",", "inplanes", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "self", ".", "prelu", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "conv2", "=", "conv3x3", "(", "inplanes", ",", "planes", ",", "stride", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "stride", "=", "stride", "\n", "self", ".", "use_se", "=", "use_se", "\n", "if", "self", ".", "use_se", ":", "\n", "            ", "self", ".", "se", "=", "SEBlock", "(", "planes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.IRBlock.forward": [[71, 90], ["resnet.IRBlock.bn0", "resnet.IRBlock.conv1", "resnet.IRBlock.bn1", "resnet.IRBlock.prelu", "resnet.IRBlock.conv2", "resnet.IRBlock.bn2", "resnet.IRBlock.prelu", "resnet.IRBlock.se", "resnet.IRBlock.downsample"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "residual", "=", "x", "\n", "out", "=", "self", ".", "bn0", "(", "x", ")", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "bn1", "(", "out", ")", "\n", "out", "=", "self", ".", "prelu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "out", "=", "self", ".", "bn2", "(", "out", ")", "\n", "if", "self", ".", "use_se", ":", "\n", "            ", "out", "=", "self", ".", "se", "(", "out", ")", "\n", "\n", "", "if", "self", ".", "downsample", "is", "not", "None", ":", "\n", "            ", "residual", "=", "self", ".", "downsample", "(", "x", ")", "\n", "\n", "", "out", "+=", "residual", "\n", "out", "=", "self", ".", "prelu", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.IRBottleneck.__init__": [[96, 112], ["torch.Module.__init__", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.PReLU", "torch.PReLU", "resnet.SEBlock"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "stride", "=", "1", ",", "downsample", "=", "None", ",", "use_se", "=", "True", ")", ":", "\n", "        ", "super", "(", "IRBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "bn0", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", "*", "self", ".", "expansion", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", "*", "self", ".", "expansion", ")", "\n", "self", ".", "prelu", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "stride", "=", "stride", "\n", "self", ".", "use_se", "=", "use_se", "\n", "if", "self", ".", "use_se", ":", "\n", "            ", "self", ".", "se", "=", "SEBlock", "(", "planes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.IRBottleneck.forward": [[114, 138], ["resnet.IRBottleneck.bn0", "resnet.IRBottleneck.conv1", "resnet.IRBottleneck.bn1", "resnet.IRBottleneck.prelu", "resnet.IRBottleneck.conv2", "resnet.IRBottleneck.bn2", "resnet.IRBottleneck.prelu", "resnet.IRBottleneck.conv3", "resnet.IRBottleneck.bn3", "resnet.IRBottleneck.prelu", "resnet.IRBottleneck.se", "resnet.IRBottleneck.downsample"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "residual", "=", "x", "\n", "out", "=", "self", ".", "bn0", "(", "x", ")", "\n", "out", "=", "self", ".", "conv1", "(", "out", ")", "\n", "out", "=", "self", ".", "bn1", "(", "out", ")", "\n", "out", "=", "self", ".", "prelu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "out", "=", "self", ".", "bn2", "(", "out", ")", "\n", "out", "=", "self", ".", "prelu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv3", "(", "out", ")", "\n", "out", "=", "self", ".", "bn3", "(", "out", ")", "\n", "\n", "if", "self", ".", "use_se", ":", "\n", "            ", "out", "=", "self", ".", "se", "(", "out", ")", "\n", "\n", "", "if", "self", ".", "downsample", "is", "not", "None", ":", "\n", "            ", "residual", "=", "self", ".", "downsample", "(", "x", ")", "\n", "\n", "", "out", "+=", "residual", "\n", "out", "=", "self", ".", "prelu", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.Bottleneck.__init__": [[144, 156], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "stride", "=", "1", ",", "downsample", "=", "None", ")", ":", "\n", "        ", "super", "(", "Bottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "planes", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", "*", "self", ".", "expansion", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "nn", ".", "BatchNorm2d", "(", "planes", "*", "self", ".", "expansion", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "stride", "=", "stride", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.Bottleneck.forward": [[158, 179], ["resnet.Bottleneck.conv1", "resnet.Bottleneck.bn1", "resnet.Bottleneck.relu", "resnet.Bottleneck.conv2", "resnet.Bottleneck.bn2", "resnet.Bottleneck.relu", "resnet.Bottleneck.conv3", "resnet.Bottleneck.bn3", "resnet.Bottleneck.relu", "resnet.Bottleneck.downsample"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "residual", "=", "x", "\n", "\n", "out", "=", "self", ".", "conv1", "(", "x", ")", "\n", "out", "=", "self", ".", "bn1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "out", "=", "self", ".", "bn2", "(", "out", ")", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv3", "(", "out", ")", "\n", "out", "=", "self", ".", "bn3", "(", "out", ")", "\n", "\n", "if", "self", ".", "downsample", "is", "not", "None", ":", "\n", "            ", "residual", "=", "self", ".", "downsample", "(", "x", ")", "\n", "\n", "", "out", "+=", "residual", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.SEBlock.__init__": [[183, 191], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Linear", "torch.Linear", "torch.PReLU", "torch.PReLU", "torch.Linear", "torch.Linear", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "16", ")", ":", "\n", "        ", "super", "(", "SEBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Linear", "(", "channel", ",", "channel", "//", "reduction", ")", ",", "\n", "nn", ".", "PReLU", "(", ")", ",", "\n", "nn", ".", "Linear", "(", "channel", "//", "reduction", ",", "channel", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.SEBlock.forward": [[194, 199], ["x.size", "resnet.SEBlock.avg_pool().view", "resnet.SEBlock.fc().view", "resnet.SEBlock.avg_pool", "resnet.SEBlock.fc"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "b", ",", "c", ",", "_", ",", "_", "=", "x", ".", "size", "(", ")", "\n", "y", "=", "self", ".", "avg_pool", "(", "x", ")", ".", "view", "(", "b", ",", "c", ")", "\n", "y", "=", "self", ".", "fc", "(", "y", ")", ".", "view", "(", "b", ",", "c", ",", "1", ",", "1", ")", "\n", "return", "x", "*", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.ResNetFace.__init__": [[203, 234], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.PReLU", "torch.PReLU", "torch.MaxPool2d", "torch.MaxPool2d", "resnet.ResNetFace._make_layer", "resnet.ResNetFace._make_layer", "resnet.ResNetFace._make_layer", "resnet.ResNetFace._make_layer", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Dropout", "torch.Dropout", "torch.Linear", "torch.Linear", "torch.BatchNorm1d", "torch.BatchNorm1d", "resnet.ResNetFace.modules", "resnet.ResNetFace.register_buffer", "isinstance", "torch.init.xavier_normal_", "torch.init.xavier_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "torch.rand", "torch.rand", "torch.rand", "torch.rand", "torch.init.xavier_normal_", "torch.init.xavier_normal_", "torch.init.constant_", "torch.init.constant_"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.ResNetFace._make_layer", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.ResNetFace._make_layer", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.ResNetFace._make_layer", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.ResNetFace._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "block", ",", "layers", ",", "num_classes", ",", "save_center", "=", "False", ",", "use_se", "=", "True", ")", ":", "\n", "        ", "self", ".", "inplanes", "=", "64", "\n", "self", ".", "use_se", "=", "use_se", "\n", "self", ".", "num_classes", "=", "num_classes", "\n", "self", ".", "save_center", "=", "save_center", "\n", "super", "(", "ResNetFace", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "nn", ".", "BatchNorm2d", "(", "64", ")", "\n", "self", ".", "prelu", "=", "nn", ".", "PReLU", "(", ")", "\n", "self", ".", "maxpool", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ",", "stride", "=", "2", ")", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "layers", "[", "0", "]", ")", "\n", "self", ".", "layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "layers", "[", "1", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "layers", "[", "2", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "layers", "[", "3", "]", ",", "stride", "=", "2", ")", "\n", "self", ".", "bn4", "=", "nn", ".", "BatchNorm2d", "(", "512", "*", "block", ".", "expansion", ")", "\n", "self", ".", "dropout", "=", "nn", ".", "Dropout", "(", ")", "\n", "self", ".", "fc5", "=", "nn", ".", "Linear", "(", "512", "*", "block", ".", "expansion", "*", "8", "*", "8", ",", "512", ")", "\n", "self", ".", "bn5", "=", "nn", ".", "BatchNorm1d", "(", "512", ")", "\n", "\n", "if", "self", ".", "save_center", ":", "\n", "            ", "self", ".", "register_buffer", "(", "'centers'", ",", "(", "torch", ".", "rand", "(", "num_classes", ",", "512", ")", "-", "0.5", ")", "*", "2", ")", "\n", "\n", "", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "xavier_normal_", "(", "m", ".", "weight", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", "or", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm1d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "                ", "nn", ".", "init", ".", "xavier_normal_", "(", "m", ".", "weight", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.ResNetFace._make_layer": [[236, 251], ["layers.append", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "block", "layers.append", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "block"], "methods", ["None"], ["", "", "", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "blocks", ",", "stride", "=", "1", ")", ":", "\n", "        ", "downsample", "=", "None", "\n", "if", "stride", "!=", "1", "or", "self", ".", "inplanes", "!=", "planes", "*", "block", ".", "expansion", ":", "\n", "            ", "downsample", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "self", ".", "inplanes", ",", "planes", "*", "block", ".", "expansion", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "planes", "*", "block", ".", "expansion", ")", ",", "\n", ")", "\n", "", "layers", "=", "[", "]", "\n", "layers", ".", "append", "(", "block", "(", "self", ".", "inplanes", ",", "planes", ",", "stride", ",", "downsample", ",", "use_se", "=", "self", ".", "use_se", ")", ")", "\n", "self", ".", "inplanes", "=", "planes", "*", "block", ".", "expansion", "\n", "for", "i", "in", "range", "(", "1", ",", "blocks", ")", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "inplanes", ",", "planes", ",", "use_se", "=", "self", ".", "use_se", ")", ")", "\n", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.ResNetFace.forward": [[253, 270], ["resnet.ResNetFace.conv1", "resnet.ResNetFace.bn1", "resnet.ResNetFace.prelu", "resnet.ResNetFace.maxpool", "resnet.ResNetFace.layer1", "resnet.ResNetFace.layer2", "resnet.ResNetFace.layer3", "resnet.ResNetFace.layer4", "resnet.ResNetFace.bn4", "resnet.ResNetFace.dropout", "resnet.ResNetFace.view", "resnet.ResNetFace.fc5", "resnet.ResNetFace.bn5", "resnet.ResNetFace.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x", "=", "self", ".", "bn1", "(", "x", ")", "\n", "x", "=", "self", ".", "prelu", "(", "x", ")", "\n", "x", "=", "self", ".", "maxpool", "(", "x", ")", "\n", "\n", "x", "=", "self", ".", "layer1", "(", "x", ")", "\n", "x", "=", "self", ".", "layer2", "(", "x", ")", "\n", "x", "=", "self", ".", "layer3", "(", "x", ")", "\n", "x", "=", "self", ".", "layer4", "(", "x", ")", "\n", "x", "=", "self", ".", "bn4", "(", "x", ")", "\n", "x", "=", "self", ".", "dropout", "(", "x", ")", "\n", "x", "=", "x", ".", "view", "(", "x", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "x", "=", "self", ".", "fc5", "(", "x", ")", "\n", "\n", "x", "=", "self", ".", "bn5", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.conv3x3": [[12, 16], ["torch.Conv2d"], "function", ["None"], ["def", "conv3x3", "(", "in_planes", ",", "out_planes", ",", "stride", "=", "1", ")", ":", "\n", "    ", "\"\"\"3x3 convolution with padding\"\"\"", "\n", "return", "nn", ".", "Conv2d", "(", "in_planes", ",", "out_planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.resnet_face18": [[272, 275], ["resnet.ResNetFace"], "function", ["None"], ["", "", "def", "resnet_face18", "(", "num_classes", ",", "save_center", "=", "False", ",", "use_se", "=", "True", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "ResNetFace", "(", "IRBlock", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ",", "num_classes", ",", "save_center", ",", "use_se", "=", "use_se", ",", "**", "kwargs", ")", "\n", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.resnet.resnet_face50": [[276, 279], ["resnet.ResNetFace"], "function", ["None"], ["", "def", "resnet_face50", "(", "num_classes", ",", "save_center", "=", "False", ",", "use_se", "=", "True", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "ResNetFace", "(", "IRBottleneck", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ",", "num_classes", ",", "save_center", ",", "use_se", "=", "use_se", ",", "**", "kwargs", ")", "\n", "return", "model", "\n", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.focal_loss.FocalLoss.__init__": [[13, 18], ["torch.Module.__init__", "torch.nn.CrossEntropyLoss", "torch.nn.CrossEntropyLoss", "torch.nn.CrossEntropyLoss", "torch.nn.CrossEntropyLoss"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__"], ["    ", "def", "__init__", "(", "self", ",", "gamma", "=", "0", ",", "eps", "=", "1e-7", ")", ":", "\n", "        ", "super", "(", "FocalLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gamma", "=", "gamma", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "ce", "=", "torch", ".", "nn", ".", "CrossEntropyLoss", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.models.focal_loss.FocalLoss.forward": [[20, 25], ["focal_loss.FocalLoss.ce", "torch.exp", "torch.exp", "torch.exp", "torch.exp", "loss.mean"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "target", ")", ":", "\n", "        ", "logp", "=", "self", ".", "ce", "(", "input", ",", "target", ")", "\n", "p", "=", "torch", ".", "exp", "(", "-", "logp", ")", "\n", "loss", "=", "(", "1", "-", "p", ")", "**", "self", ".", "gamma", "*", "logp", "\n", "return", "loss", ".", "mean", "(", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfacePair.BalancedfacePair.__init__": [[10, 43], ["torchvision.transforms.Compose", "random.seed", "os.path.join", "os.path.join", "BalancedfacePair.BalancedfacePair.fetch_race_data", "BalancedfacePair.BalancedfacePair.fetch_race_data", "min", "int", "random.sample", "random.sample", "list", "BalancedfacePair.BalancedfacePair.img_paths.extend", "BalancedfacePair.BalancedfacePair.labels.extend", "list", "BalancedfacePair.BalancedfacePair.img_paths.extend", "BalancedfacePair.BalancedfacePair.labels.extend", "torchvision.transforms.Resize", "torchvision.transforms.RandomCrop", "torchvision.transforms.RandomHorizontalFlip", "torchvision.transforms.ToTensor", "torchvision.transforms.Normalize", "random.sample", "random.sample", "int"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfacePair.BalancedfacePair.fetch_race_data", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfacePair.BalancedfacePair.fetch_race_data"], ["    ", "def", "__init__", "(", "self", ",", "root", ",", "race_a", "=", "'Caucasian'", ",", "race_b", "=", "'African'", ",", "percent_a", "=", "50", ",", "input_shape", "=", "(", "3", ",", "128", ",", "128", ")", ")", ":", "\n", "        ", "self", ".", "input_shape", "=", "input_shape", "\n", "self", ".", "transforms", "=", "T", ".", "Compose", "(", "[", "\n", "T", ".", "Resize", "(", "int", "(", "self", ".", "input_shape", "[", "1", "]", "*", "156", "/", "128", ")", ")", ",", "\n", "T", ".", "RandomCrop", "(", "self", ".", "input_shape", "[", "1", ":", "]", ")", ",", "\n", "T", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "T", ".", "ToTensor", "(", ")", ",", "\n", "T", ".", "Normalize", "(", "mean", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ",", "\n", "std", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ")", "\n", "]", ")", "\n", "self", ".", "img_paths", "=", "[", "]", "\n", "self", ".", "labels", "=", "[", "]", "\n", "\n", "random", ".", "seed", "(", "42", ")", "\n", "root_a", "=", "os", ".", "path", ".", "join", "(", "root", ",", "race_a", ")", "\n", "root_b", "=", "os", ".", "path", ".", "join", "(", "root", ",", "race_b", ")", "\n", "\n", "label_to_images_a", ",", "label_buckets_a", ",", "labels_a", "=", "self", ".", "fetch_race_data", "(", "root_a", ")", "\n", "label_to_images_b", ",", "label_buckets_b", ",", "labels_b", "=", "self", ".", "fetch_race_data", "(", "root_b", ")", "\n", "\n", "images_per_label", "=", "min", "(", "label_buckets_a", "[", "2000", "]", ",", "label_buckets_b", "[", "2000", "]", ")", "\n", "num_labels_a", "=", "int", "(", "5000", "*", "percent_a", "/", "100", ")", "\n", "num_labels_b", "=", "5000", "-", "num_labels_a", "\n", "\n", "cur_label", "=", "0", "\n", "for", "label", "in", "random", ".", "sample", "(", "list", "(", "labels_a", "[", "2000", ":", "]", ")", ",", "num_labels_a", ")", ":", "\n", "            ", "self", ".", "img_paths", ".", "extend", "(", "random", ".", "sample", "(", "label_to_images_a", "[", "label", "]", ",", "images_per_label", ")", ")", "\n", "self", ".", "labels", ".", "extend", "(", "[", "cur_label", "]", "*", "images_per_label", ")", "\n", "cur_label", "+=", "1", "\n", "", "for", "label", "in", "random", ".", "sample", "(", "list", "(", "labels_b", "[", "2000", ":", "]", ")", ",", "num_labels_b", ")", ":", "\n", "            ", "self", ".", "img_paths", ".", "extend", "(", "random", ".", "sample", "(", "label_to_images_b", "[", "label", "]", ",", "images_per_label", ")", ")", "\n", "self", ".", "labels", ".", "extend", "(", "[", "cur_label", "]", "*", "images_per_label", ")", "\n", "cur_label", "+=", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfacePair.BalancedfacePair.__getitem__": [[45, 52], ["PIL.Image.open", "BalancedfacePair.BalancedfacePair.convert", "BalancedfacePair.BalancedfacePair.transforms", "BalancedfacePair.BalancedfacePair.float"], "methods", ["None"], ["", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "img_path", "=", "self", ".", "img_paths", "[", "index", "]", "\n", "label", "=", "self", ".", "labels", "[", "index", "]", "\n", "data", "=", "Image", ".", "open", "(", "img_path", ")", "\n", "data", "=", "data", ".", "convert", "(", "'RGB'", ")", "\n", "data", "=", "self", ".", "transforms", "(", "data", ")", "\n", "return", "data", ".", "float", "(", ")", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfacePair.BalancedfacePair.__len__": [[54, 56], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "img_paths", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfacePair.BalancedfacePair.fetch_race_data": [[58, 72], ["os.listdir", "zip", "os.path.join", "os.listdir", "label_buckets.append", "os.path.join", "label_to_images[].append", "sorted", "os.path.join", "zip", "range"], "methods", ["None"], ["", "def", "fetch_race_data", "(", "self", ",", "race_root", ")", ":", "\n", "        ", "label_to_images", "=", "{", "}", "\n", "label_buckets", "=", "[", "]", "\n", "cur_label", "=", "0", "\n", "for", "dir", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "race_root", ")", ")", ":", "\n", "            ", "label_to_images", "[", "cur_label", "]", "=", "[", "]", "\n", "cur_num_images", "=", "0", "\n", "for", "img", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "race_root", ",", "dir", ")", ")", ":", "\n", "                ", "label_to_images", "[", "cur_label", "]", ".", "append", "(", "os", ".", "path", ".", "join", "(", "race_root", ",", "dir", ",", "img", ")", ")", "\n", "cur_num_images", "+=", "1", "\n", "", "label_buckets", ".", "append", "(", "cur_num_images", ")", "\n", "cur_label", "+=", "1", "\n", "", "label_buckets", ",", "labels", "=", "zip", "(", "*", "sorted", "(", "zip", "(", "label_buckets", ",", "range", "(", "7000", ")", ")", ")", ")", "\n", "return", "label_to_images", ",", "label_buckets", ",", "labels", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceSingle.BalancedfaceSingle.__init__": [[12, 38], ["torchvision.transforms.Compose", "os.path.join", "os.listdir", "os.path.join", "os.listdir", "cv2.CascadeClassifier", "torchvision.transforms.Resize", "torchvision.transforms.RandomCrop", "torchvision.transforms.RandomHorizontalFlip", "torchvision.transforms.ToTensor", "torchvision.transforms.Normalize", "os.path.join", "BalancedfaceSingle.BalancedfaceSingle.img_paths.append", "BalancedfaceSingle.BalancedfaceSingle.labels.append", "int", "os.path.join"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "root", ",", "race", "=", "'Caucasian'", ",", "input_shape", "=", "(", "3", ",", "128", ",", "128", ")", ",", "noise_mixing", "=", "False", ",", "noise", "=", "0.25", ")", ":", "\n", "        ", "self", ".", "input_shape", "=", "input_shape", "\n", "self", ".", "transforms", "=", "T", ".", "Compose", "(", "[", "\n", "T", ".", "Resize", "(", "int", "(", "self", ".", "input_shape", "[", "1", "]", "*", "156", "/", "128", ")", ")", ",", "\n", "T", ".", "RandomCrop", "(", "self", ".", "input_shape", "[", "1", ":", "]", ")", ",", "\n", "T", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "T", ".", "ToTensor", "(", ")", ",", "\n", "T", ".", "Normalize", "(", "mean", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ",", "\n", "std", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ")", "\n", "]", ")", "\n", "self", ".", "img_paths", "=", "[", "]", "\n", "self", ".", "labels", "=", "[", "]", "\n", "self", ".", "noise_mixing", "=", "noise_mixing", "\n", "self", ".", "noise", "=", "noise", "\n", "\n", "root", "=", "os", ".", "path", ".", "join", "(", "root", ",", "race", ")", "\n", "\n", "cur_label", "=", "0", "\n", "for", "dir", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "root", ")", ")", ":", "\n", "            ", "for", "img", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "root", ",", "dir", ")", ")", ":", "\n", "                ", "self", ".", "img_paths", ".", "append", "(", "os", ".", "path", ".", "join", "(", "root", ",", "dir", ",", "img", ")", ")", "\n", "self", ".", "labels", ".", "append", "(", "cur_label", ")", "\n", "", "cur_label", "+=", "1", "\n", "\n", "", "if", "self", ".", "noise_mixing", ":", "\n", "            ", "self", ".", "face_cascade", "=", "cv2", ".", "CascadeClassifier", "(", "'./data/face_detector.xml'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceSingle.BalancedfaceSingle.__getitem__": [[40, 63], ["PIL.Image.open", "PIL.Image.fromarray.convert", "BalancedfaceSingle.BalancedfaceSingle.transforms", "numpy.array", "BalancedfaceSingle.BalancedfaceSingle.face_cascade.detectMultiScale", "random.randint", "torchvision.transforms.GaussianBlur", "numpy.array", "PIL.Image.fromarray", "PIL.Image.fromarray.float", "random.random", "torchvision.transforms.GaussianBlur.", "random.randint", "random.randint", "numpy.uint8"], "methods", ["None"], ["", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "img_path", "=", "self", ".", "img_paths", "[", "index", "]", "\n", "label", "=", "self", ".", "labels", "[", "index", "]", "\n", "data", "=", "Image", ".", "open", "(", "img_path", ")", "\n", "data", "=", "data", ".", "convert", "(", "'RGB'", ")", "\n", "\n", "if", "self", ".", "noise_mixing", "and", "random", ".", "random", "(", ")", "<", "self", ".", "noise", ":", "\n", "            ", "img", "=", "np", ".", "array", "(", "data", ")", "\n", "faces", "=", "self", ".", "face_cascade", ".", "detectMultiScale", "(", "img", ",", "1.1", ",", "4", ")", "\n", "rint", "=", "random", ".", "randint", "(", "5", ",", "10", ")", "\n", "ksize", "=", "2", "*", "rint", "+", "1", "\n", "blurrer", "=", "T", ".", "GaussianBlur", "(", "kernel_size", "=", "ksize", ",", "sigma", "=", "1.5", ")", "\n", "blur_img", "=", "np", ".", "array", "(", "blurrer", "(", "data", ")", ")", "\n", "for", "(", "x", ",", "y", ",", "w", ",", "h", ")", "in", "faces", ":", "\n", "                ", "face", "=", "img", "[", "x", ":", "x", "+", "w", ",", "y", ":", "y", "+", "h", ",", ":", "]", "\n", "rx", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "(", "w", "//", "4", ")", ")", "\n", "ry", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "(", "h", "//", "4", ")", ")", "\n", "face", "[", "rx", ":", "rx", "+", "(", "w", "//", "4", ")", ",", "ry", ":", "ry", "+", "(", "h", "//", "4", ")", "]", "=", "blur_img", "[", "x", "+", "rx", ":", "x", "+", "rx", "+", "(", "w", "//", "4", ")", ",", "y", "+", "ry", ":", "y", "+", "ry", "+", "(", "h", "//", "4", ")", "]", "\n", "img", "[", "x", ":", "x", "+", "w", ",", "y", ":", "y", "+", "h", "]", "=", "face", "\n", "", "data", "=", "Image", ".", "fromarray", "(", "np", ".", "uint8", "(", "img", ")", ")", "\n", "\n", "", "data", "=", "self", ".", "transforms", "(", "data", ")", "\n", "return", "data", ".", "float", "(", ")", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceSingle.BalancedfaceSingle.__len__": [[65, 67], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "img_paths", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.dataset.Dataset.__init__": [[10, 35], ["numpy.random.permutation", "torchvision.transforms.Normalize", "open", "fd.readlines", "os.path.join", "torchvision.transforms.Compose", "torchvision.transforms.Compose", "os.path.join", "torchvision.transforms.RandomCrop", "torchvision.transforms.RandomHorizontalFlip", "torchvision.transforms.ToTensor", "torchvision.transforms.CenterCrop", "torchvision.transforms.ToTensor"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "root", ",", "data_list_file", ",", "phase", "=", "'train'", ",", "input_shape", "=", "(", "3", ",", "128", ",", "128", ")", ")", ":", "\n", "        ", "self", ".", "phase", "=", "phase", "\n", "self", ".", "input_shape", "=", "input_shape", "\n", "\n", "with", "open", "(", "os", ".", "path", ".", "join", "(", "data_list_file", ")", ",", "'r'", ")", "as", "fd", ":", "\n", "            ", "imgs", "=", "fd", ".", "readlines", "(", ")", "\n", "\n", "", "imgs", "=", "[", "os", ".", "path", ".", "join", "(", "root", ",", "img", "[", ":", "-", "1", "]", ")", "for", "img", "in", "imgs", "]", "\n", "self", ".", "imgs", "=", "np", ".", "random", ".", "permutation", "(", "imgs", ")", "\n", "\n", "normalize", "=", "T", ".", "Normalize", "(", "mean", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ",", "\n", "std", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ")", "\n", "\n", "if", "self", ".", "phase", "==", "'train'", ":", "\n", "            ", "self", ".", "transforms", "=", "T", ".", "Compose", "(", "[", "\n", "T", ".", "RandomCrop", "(", "self", ".", "input_shape", "[", "1", ":", "]", ")", ",", "\n", "T", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "T", ".", "ToTensor", "(", ")", ",", "\n", "normalize", "\n", "]", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "transforms", "=", "T", ".", "Compose", "(", "[", "\n", "T", ".", "CenterCrop", "(", "self", ".", "input_shape", "[", "1", ":", "]", ")", ",", "\n", "T", ".", "ToTensor", "(", ")", ",", "\n", "normalize", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.dataset.Dataset.__getitem__": [[38, 47], ["sample.split", "PIL.Image.open", "dataset.Dataset.convert", "dataset.Dataset.transforms", "numpy.int32", "dataset.Dataset.float"], "methods", ["None"], ["", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "sample", "=", "self", ".", "imgs", "[", "index", "]", "\n", "splits", "=", "sample", ".", "split", "(", ")", "\n", "img_path", "=", "splits", "[", "0", "]", "\n", "data", "=", "Image", ".", "open", "(", "img_path", ")", "\n", "data", "=", "data", ".", "convert", "(", "'L'", ")", "\n", "data", "=", "self", ".", "transforms", "(", "data", ")", "\n", "label", "=", "np", ".", "int32", "(", "splits", "[", "1", "]", ")", "\n", "return", "data", ".", "float", "(", ")", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.dataset.Dataset.__len__": [[49, 51], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "imgs", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.Balancedface.Balancedface.__init__": [[9, 34], ["torchvision.transforms.Compose", "os.path.join", "os.listdir", "Balancedface.Balancedface.img_paths.extend", "Balancedface.Balancedface.labels.extend", "torchvision.transforms.Resize", "torchvision.transforms.RandomCrop", "torchvision.transforms.RandomHorizontalFlip", "torchvision.transforms.ToTensor", "torchvision.transforms.Normalize", "os.path.join", "os.listdir", "int", "os.path.join", "img_paths.append", "labels.append", "os.path.join"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "root", ",", "input_shape", "=", "(", "3", ",", "128", ",", "128", ")", ")", ":", "\n", "        ", "self", ".", "input_shape", "=", "input_shape", "\n", "self", ".", "transforms", "=", "T", ".", "Compose", "(", "[", "\n", "T", ".", "Resize", "(", "int", "(", "self", ".", "input_shape", "[", "1", "]", "*", "156", "/", "128", ")", ")", ",", "\n", "T", ".", "RandomCrop", "(", "self", ".", "input_shape", "[", "1", ":", "]", ")", ",", "\n", "T", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "T", ".", "ToTensor", "(", ")", ",", "\n", "T", ".", "Normalize", "(", "mean", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ",", "\n", "std", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ")", "\n", "]", ")", "\n", "self", ".", "img_paths", "=", "[", "]", "\n", "self", ".", "labels", "=", "[", "]", "\n", "\n", "cur_label", "=", "0", "\n", "for", "race", "in", "[", "'African'", ",", "'Asian'", ",", "'Caucasian'", ",", "'Indian'", "]", ":", "\n", "            ", "img_paths", "=", "[", "]", "\n", "labels", "=", "[", "]", "\n", "race_root", "=", "os", ".", "path", ".", "join", "(", "root", ",", "race", ")", "\n", "for", "dir", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "race_root", ")", ")", ":", "\n", "                ", "for", "img", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "race_root", ",", "dir", ")", ")", ":", "\n", "                    ", "img_paths", ".", "append", "(", "os", ".", "path", ".", "join", "(", "race_root", ",", "dir", ",", "img", ")", ")", "\n", "labels", ".", "append", "(", "cur_label", ")", "\n", "", "cur_label", "+=", "1", "\n", "", "self", ".", "img_paths", ".", "extend", "(", "img_paths", ")", "\n", "self", ".", "labels", ".", "extend", "(", "labels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.Balancedface.Balancedface.__getitem__": [[36, 43], ["PIL.Image.open", "Balancedface.Balancedface.convert", "Balancedface.Balancedface.transforms", "Balancedface.Balancedface.float"], "methods", ["None"], ["", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "imgPath", "=", "self", ".", "img_paths", "[", "index", "]", "\n", "label", "=", "self", ".", "labels", "[", "index", "]", "\n", "data", "=", "Image", ".", "open", "(", "imgPath", ")", "\n", "data", "=", "data", ".", "convert", "(", "'RGB'", ")", "\n", "data", "=", "self", ".", "transforms", "(", "data", ")", "\n", "return", "data", ".", "float", "(", ")", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.Balancedface.Balancedface.__len__": [[45, 47], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "img_paths", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.RFW.RFW.__init__": [[32, 47], ["torchvision.transforms.Compose", "os.path.join", "os.listdir", "os.path.join", "os.listdir", "torchvision.transforms.Resize", "torchvision.transforms.CenterCrop", "torchvision.transforms.ToTensor", "torchvision.transforms.Normalize", "os.path.join", "RFW.RFW.img_paths.append", "int", "os.path.join"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "root", ",", "race", "=", "'Caucasian'", ",", "input_shape", "=", "(", "3", ",", "128", ",", "128", ")", ")", ":", "\n", "        ", "self", ".", "input_shape", "=", "input_shape", "\n", "self", ".", "transforms", "=", "T", ".", "Compose", "(", "[", "\n", "T", ".", "Resize", "(", "int", "(", "self", ".", "input_shape", "[", "1", "]", "*", "156", "/", "128", ")", ")", ",", "\n", "T", ".", "CenterCrop", "(", "self", ".", "input_shape", "[", "1", ":", "]", ")", ",", "\n", "T", ".", "ToTensor", "(", ")", ",", "\n", "T", ".", "Normalize", "(", "mean", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ",", "\n", "std", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ")", "\n", "]", ")", "\n", "self", ".", "img_paths", "=", "[", "]", "\n", "\n", "root", "=", "os", ".", "path", ".", "join", "(", "root", ",", "'data'", ",", "race", ")", "\n", "for", "dir", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "root", ")", ")", ":", "\n", "            ", "for", "img", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "root", ",", "dir", ")", ")", ":", "\n", "                ", "self", ".", "img_paths", ".", "append", "(", "os", ".", "path", ".", "join", "(", "root", ",", "dir", ",", "img", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.RFW.RFW.__getitem__": [[49, 55], ["PIL.Image.open", "RFW.RFW.convert", "RFW.RFW.transforms", "RFW.RFW.float", "img_path.split"], "methods", ["None"], ["", "", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "img_path", "=", "self", ".", "img_paths", "[", "index", "]", "\n", "data", "=", "Image", ".", "open", "(", "img_path", ")", "\n", "data", "=", "data", ".", "convert", "(", "'RGB'", ")", "\n", "data", "=", "self", ".", "transforms", "(", "data", ")", "\n", "return", "data", ".", "float", "(", ")", ",", "img_path", ".", "split", "(", "'/'", ")", "[", "-", "1", "]", "[", ":", "-", "4", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.RFW.RFW.__len__": [[57, 59], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "img_paths", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.RFW.getRFWList": [[7, 28], ["open", "fd.readlines", "pair_line.split", "len", "pair_items[].strip", "pair_list.append", "pair_items[].strip().zfill", "pair_items[].strip().zfill", "len", "pair_items[].strip", "pair_items[].strip", "pair_list.append", "Exception", "pair_items[].strip().zfill", "pair_items[].strip().zfill", "pair_items[].strip", "pair_items[].strip", "pair_items[].strip", "pair_items[].strip"], "function", ["None"], ["def", "getRFWList", "(", "pair_list_file", ")", ":", "\n", "    ", "with", "open", "(", "pair_list_file", ",", "'r'", ")", "as", "fd", ":", "\n", "        ", "pair_lines", "=", "fd", ".", "readlines", "(", ")", "\n", "", "pair_list", "=", "[", "]", "\n", "for", "pair_line", "in", "pair_lines", ":", "\n", "        ", "pair_items", "=", "pair_line", ".", "split", "(", "'\\t'", ")", "\n", "if", "len", "(", "pair_items", ")", "==", "3", ":", "\n", "            ", "identity", "=", "pair_items", "[", "0", "]", ".", "strip", "(", ")", "\n", "first_image", "=", "identity", "+", "'_'", "+", "pair_items", "[", "1", "]", ".", "strip", "(", ")", ".", "zfill", "(", "4", ")", "\n", "second_image", "=", "identity", "+", "'_'", "+", "pair_items", "[", "2", "]", ".", "strip", "(", ")", ".", "zfill", "(", "4", ")", "\n", "pair_list", ".", "append", "(", "(", "first_image", ",", "second_image", ",", "1", ")", ")", "\n", "", "elif", "len", "(", "pair_items", ")", "==", "4", ":", "\n", "            ", "first_identity", "=", "pair_items", "[", "0", "]", ".", "strip", "(", ")", "\n", "first_image", "=", "first_identity", "+", "'_'", "+", "pair_items", "[", "1", "]", ".", "strip", "(", ")", ".", "zfill", "(", "4", ")", "\n", "second_identity", "=", "pair_items", "[", "2", "]", ".", "strip", "(", ")", "\n", "second_image", "=", "second_identity", "+", "'_'", "+", "pair_items", "[", "3", "]", ".", "strip", "(", ")", ".", "zfill", "(", "4", ")", "\n", "pair_list", ".", "append", "(", "(", "first_image", ",", "second_image", ",", "0", ")", ")", "\n", "", "else", ":", "\n", "            ", "raise", "Exception", "(", "'pair file not following expected format'", ")", "\n", "\n", "", "", "return", "pair_list", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.__init__": [[10, 60], ["torchvision.transforms.Compose", "random.seed", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels", "BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels", "BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels", "BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels", "min", "list", "BalancedfaceMulti.BalancedfaceMulti.img_paths.extend", "BalancedfaceMulti.BalancedfaceMulti.labels.extend", "list", "BalancedfaceMulti.BalancedfaceMulti.img_paths.extend", "BalancedfaceMulti.BalancedfaceMulti.labels.extend", "list", "BalancedfaceMulti.BalancedfaceMulti.img_paths.extend", "BalancedfaceMulti.BalancedfaceMulti.labels.extend", "list", "BalancedfaceMulti.BalancedfaceMulti.img_paths.extend", "BalancedfaceMulti.BalancedfaceMulti.labels.extend", "torchvision.transforms.Resize", "torchvision.transforms.RandomCrop", "torchvision.transforms.RandomHorizontalFlip", "torchvision.transforms.ToTensor", "torchvision.transforms.Normalize", "random.sample", "random.sample", "random.sample", "random.sample", "int"], "methods", ["home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels", "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels"], ["    ", "def", "__init__", "(", "self", ",", "root", ",", "identities_per_race", ",", "images_per_identity", "=", "None", ",", "input_shape", "=", "(", "3", ",", "128", ",", "128", ")", ")", ":", "\n", "        ", "self", ".", "input_shape", "=", "input_shape", "\n", "self", ".", "transforms", "=", "T", ".", "Compose", "(", "[", "\n", "T", ".", "Resize", "(", "int", "(", "self", ".", "input_shape", "[", "1", "]", "*", "156", "/", "128", ")", ")", ",", "\n", "T", ".", "RandomCrop", "(", "self", ".", "input_shape", "[", "1", ":", "]", ")", ",", "\n", "T", ".", "RandomHorizontalFlip", "(", ")", ",", "\n", "T", ".", "ToTensor", "(", ")", ",", "\n", "T", ".", "Normalize", "(", "mean", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ",", "\n", "std", "=", "[", "0.5", ",", "0.5", ",", "0.5", "]", ")", "\n", "]", ")", "\n", "self", ".", "img_paths", "=", "[", "]", "\n", "self", ".", "labels", "=", "[", "]", "\n", "\n", "random", ".", "seed", "(", "42", ")", "\n", "PERSON_START_INDEX", "=", "2000", "\n", "african_dir", "=", "os", ".", "path", ".", "join", "(", "root", ",", "'African'", ")", "\n", "asian_dir", "=", "os", ".", "path", ".", "join", "(", "root", ",", "'Asian'", ")", "\n", "caucasian_dir", "=", "os", ".", "path", ".", "join", "(", "root", ",", "'Caucasian'", ")", "\n", "indian_dir", "=", "os", ".", "path", ".", "join", "(", "root", ",", "'Indian'", ")", "\n", "\n", "african_label_buckets", ",", "african_labels_to_images", ",", "african_labels", "=", "self", ".", "get_sorted_labels", "(", "african_dir", ")", "\n", "asian_label_buckets", ",", "asian_labels_to_images", ",", "asian_labels", "=", "self", ".", "get_sorted_labels", "(", "asian_dir", ")", "\n", "caucasian_label_buckets", ",", "caucasian_labels_to_images", ",", "caucasian_labels", "=", "self", ".", "get_sorted_labels", "(", "caucasian_dir", ")", "\n", "indian_label_buckets", ",", "indian_labels_to_images", ",", "indian_labels", "=", "self", ".", "get_sorted_labels", "(", "indian_dir", ")", "\n", "\n", "if", "images_per_identity", "is", "None", ":", "\n", "            ", "images_per_label", "=", "min", "(", "african_label_buckets", "[", "PERSON_START_INDEX", "]", ",", "asian_label_buckets", "[", "PERSON_START_INDEX", "]", ",", "caucasian_label_buckets", "[", "PERSON_START_INDEX", "]", ",", "indian_label_buckets", "[", "PERSON_START_INDEX", "]", ")", "\n", "images_per_identity", "=", "{", "}", "\n", "images_per_identity", "[", "'african'", "]", "=", "images_per_label", "\n", "images_per_identity", "[", "'asian'", "]", "=", "images_per_label", "\n", "images_per_identity", "[", "'caucasian'", "]", "=", "images_per_label", "\n", "images_per_identity", "[", "'indian'", "]", "=", "images_per_label", "\n", "\n", "", "cur_label", "=", "0", "\n", "for", "label", "in", "list", "(", "african_labels", ")", "[", "PERSON_START_INDEX", ":", "PERSON_START_INDEX", "+", "identities_per_race", "[", "'african'", "]", "]", ":", "\n", "            ", "self", ".", "img_paths", ".", "extend", "(", "random", ".", "sample", "(", "african_labels_to_images", "[", "label", "]", ",", "images_per_identity", "[", "'african'", "]", ")", ")", "\n", "self", ".", "labels", ".", "extend", "(", "[", "cur_label", "]", "*", "images_per_identity", "[", "'african'", "]", ")", "\n", "cur_label", "+=", "1", "\n", "", "for", "label", "in", "list", "(", "asian_labels", ")", "[", "PERSON_START_INDEX", ":", "PERSON_START_INDEX", "+", "identities_per_race", "[", "'asian'", "]", "]", ":", "\n", "            ", "self", ".", "img_paths", ".", "extend", "(", "random", ".", "sample", "(", "asian_labels_to_images", "[", "label", "]", ",", "images_per_identity", "[", "'asian'", "]", ")", ")", "\n", "self", ".", "labels", ".", "extend", "(", "[", "cur_label", "]", "*", "images_per_identity", "[", "'asian'", "]", ")", "\n", "cur_label", "+=", "1", "\n", "", "for", "label", "in", "list", "(", "caucasian_labels", ")", "[", "PERSON_START_INDEX", ":", "PERSON_START_INDEX", "+", "identities_per_race", "[", "'caucasian'", "]", "]", ":", "\n", "            ", "self", ".", "img_paths", ".", "extend", "(", "random", ".", "sample", "(", "caucasian_labels_to_images", "[", "label", "]", ",", "images_per_identity", "[", "'caucasian'", "]", ")", ")", "\n", "self", ".", "labels", ".", "extend", "(", "[", "cur_label", "]", "*", "images_per_identity", "[", "'caucasian'", "]", ")", "\n", "cur_label", "+=", "1", "\n", "", "for", "label", "in", "list", "(", "indian_labels", ")", "[", "PERSON_START_INDEX", ":", "PERSON_START_INDEX", "+", "identities_per_race", "[", "'indian'", "]", "]", ":", "\n", "            ", "self", ".", "img_paths", ".", "extend", "(", "random", ".", "sample", "(", "indian_labels_to_images", "[", "label", "]", ",", "images_per_identity", "[", "'indian'", "]", ")", ")", "\n", "self", ".", "labels", ".", "extend", "(", "[", "cur_label", "]", "*", "images_per_identity", "[", "'indian'", "]", ")", "\n", "cur_label", "+=", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.get_sorted_labels": [[62, 76], ["os.listdir", "zip", "os.path.join", "os.listdir", "label_buckets.append", "os.path.join", "label_to_images[].append", "sorted", "os.path.join", "zip", "range"], "methods", ["None"], ["", "", "def", "get_sorted_labels", "(", "self", ",", "root_dir", ")", ":", "\n", "        ", "label_to_images", "=", "{", "}", "\n", "label_buckets", "=", "[", "]", "\n", "cur_label", "=", "0", "\n", "for", "dir", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "root_dir", ")", ")", ":", "\n", "            ", "label_to_images", "[", "cur_label", "]", "=", "[", "]", "\n", "cur_num_images", "=", "0", "\n", "for", "img", "in", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "root_dir", ",", "dir", ")", ")", ":", "\n", "                ", "label_to_images", "[", "cur_label", "]", ".", "append", "(", "os", ".", "path", ".", "join", "(", "root_dir", ",", "dir", ",", "img", ")", ")", "\n", "cur_num_images", "+=", "1", "\n", "", "label_buckets", ".", "append", "(", "cur_num_images", ")", "\n", "cur_label", "+=", "1", "\n", "", "label_buckets", ",", "labels", "=", "zip", "(", "*", "sorted", "(", "zip", "(", "label_buckets", ",", "range", "(", "7000", ")", ")", ")", ")", "\n", "return", "label_buckets", ",", "label_to_images", ",", "labels", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.__getitem__": [[78, 85], ["PIL.Image.open", "BalancedfaceMulti.BalancedfaceMulti.convert", "BalancedfaceMulti.BalancedfaceMulti.transforms", "BalancedfaceMulti.BalancedfaceMulti.float"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "img_path", "=", "self", ".", "img_paths", "[", "index", "]", "\n", "label", "=", "self", ".", "labels", "[", "index", "]", "\n", "data", "=", "Image", ".", "open", "(", "img_path", ")", "\n", "data", "=", "data", ".", "convert", "(", "'RGB'", ")", "\n", "data", "=", "self", ".", "transforms", "(", "data", ")", "\n", "return", "data", ".", "float", "(", ")", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.data.BalancedfaceMulti.BalancedfaceMulti.__len__": [[87, 89], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "img_paths", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.base.BaseConfig.__init__": [[5, 35], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "config", "=", "{", "\n", "# MODEL SETTINGS #", "\n", "'backbone'", ":", "'resnet50'", ",", "\n", "'num_classes'", ":", "7000", ",", "\n", "'use_se'", ":", "False", ",", "\n", "'save_center'", ":", "False", ",", "\n", "\n", "# OPTIMIZER SETTINGS #", "\n", "'optimizer'", ":", "'sgd'", ",", "\n", "\n", "# TRAIN LOOP SETTINGS #", "\n", "'max_epoch'", ":", "50", ",", "\n", "'save_interval'", ":", "10", ",", "\n", "'print_freq'", ":", "100", ",", "\n", "\n", "# DATA_LOADER SETTINGS #", "\n", "'train_batch_size'", ":", "128", ",", "\n", "'test_batch_size'", ":", "512", ",", "\n", "'input_shape'", ":", "(", "3", ",", "128", ",", "128", ")", ",", "\n", "'num_workers'", ":", "8", ",", "\n", "\n", "# DEFAULT EXPERIMENT #", "\n", "'trial_num'", ":", "0", ",", "\n", "'train'", ":", "True", ",", "\n", "'test'", ":", "True", ",", "\n", "'eval_each_epoch'", ":", "False", ",", "\n", "'experiment_name'", ":", "'single_race'", ",", "\n", "'train_race'", ":", "'Caucasian'", ",", "\n", "'noise_mix'", ":", "False", ",", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.config.Config.__init__": [[2, 4], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.config.Config.get_config": [[5, 7], ["None"], "methods", ["None"], ["", "def", "get_config", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "config", "\n", "", "", ""]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.arcface.ArcfaceConfig.__init__": [[5, 16], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "config", "=", "{", "\n", "'method'", ":", "'arcface'", ",", "\n", "'metric'", ":", "'arc_margin'", ",", "\n", "'easy_margin'", ":", "False", ",", "\n", "'loss'", ":", "'focal_loss'", ",", "\n", "\n", "'lr'", ":", "1e-1", ",", "\n", "'lr_step'", ":", "10", ",", "\n", "'lr_decay'", ":", "0.95", ",", "\n", "'weight_decay'", ":", "5e-4", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.vggface2.VggFace2Config.__init__": [[5, 15], ["None"], "methods", ["None"], ["\n", "\n", "class", "ResNet50ScratchDAG", "(", "nn", ".", "Module", ")", ":", "\n", "\n", "    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "ResNet50ScratchDAG", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "meta", "=", "{", "'mean'", ":", "[", "131.0912", ",", "103.8827", ",", "91.4953", "]", ",", "\n", "'std'", ":", "[", "1", ",", "1", ",", "1", "]", ",", "\n", "'imageSize'", ":", "[", "224", ",", "224", ",", "3", "]", "}", "\n", "self", ".", "conv1_7x7_s2", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "[", "7", ",", "7", "]", ",", "stride", "=", "(", "2", ",", "2", ")", ",", "padding", "=", "(", "3", ",", "3", ")", ",", "bias", "=", "False", ")", "\n", "self", ".", "conv1_7x7_s2_bn", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "track_running_stats", "=", "True", ")", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.data_default.DefaultDataConfig.__init__": [[6, 15], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "config", "=", "{", "\n", "'checkpoints_path'", ":", "'~/checkpoints'", ",", "\n", "'features_dir'", ":", "'~/RFW-features/'", ",", "\n", "'train_root'", ":", "'~/BUPT-Balancedface/race_per_7000/'", ",", "\n", "'test_root'", ":", "'~/RFW/images/test/'", ",", "\n", "'identities_per_race_path'", ":", "'~/RFW-images-per-race/'", ",", "\n", "'rfw_test_list'", ":", "'_pairs.txt'", ",", "\n", "'simplex_file_path'", ":", "'configs/points_config.json'", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.sphereface.SpherefaceConfig.__init__": [[5, 15], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "config", "=", "{", "\n", "'method'", ":", "'sphereface'", ",", "\n", "'metric'", ":", "'sphere'", ",", "\n", "'loss'", ":", "'focal_loss'", ",", "\n", "\n", "'lr'", ":", "1e-1", ",", "\n", "'lr_step'", ":", "10", ",", "\n", "'lr_decay'", ":", "0.95", ",", "\n", "'weight_decay'", ":", "5e-4", ",", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.j-alex-hanson_rethinking-race-face-datasets.configs.centerloss.CenterlossConfig.__init__": [[5, 17], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "config", "=", "{", "\n", "'method'", ":", "'centerloss'", ",", "\n", "'save_center'", ":", "True", ",", "\n", "'loss'", ":", "'cross_entropy_loss'", ",", "\n", "'lda'", ":", "0.1", ",", "\n", "'alpha'", ":", "0.1", ",", "\n", "\n", "'lr'", ":", "3e-1", ",", "\n", "'lr_step'", ":", "10", ",", "\n", "'lr_decay'", ":", "0.95", ",", "\n", "'weight_decay'", ":", "5e-4", "\n", "}", "\n"]]}