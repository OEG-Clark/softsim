{"home.repos.pwc.inspect_result.clovaai_AdamP.adamp.sgdp.SGDP.__init__": [[14, 19], ["dict", "torch.optim.optimizer.Optimizer.__init__"], "methods", ["home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP.__init__"], ["    ", "def", "__init__", "(", "self", ",", "params", ",", "lr", "=", "required", ",", "momentum", "=", "0", ",", "dampening", "=", "0", ",", "\n", "weight_decay", "=", "0", ",", "nesterov", "=", "False", ",", "eps", "=", "1e-8", ",", "delta", "=", "0.1", ",", "wd_ratio", "=", "0.1", ")", ":", "\n", "        ", "defaults", "=", "dict", "(", "lr", "=", "lr", ",", "momentum", "=", "momentum", ",", "dampening", "=", "dampening", ",", "weight_decay", "=", "weight_decay", ",", "\n", "nesterov", "=", "nesterov", ",", "eps", "=", "eps", ",", "delta", "=", "delta", ",", "wd_ratio", "=", "wd_ratio", ")", "\n", "super", "(", "SGDP", ",", "self", ")", ".", "__init__", "(", "params", ",", "defaults", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.sgdp.SGDP._channel_view": [[20, 22], ["x.view", "x.size"], "methods", ["None"], ["", "def", "_channel_view", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", ".", "view", "(", "x", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.sgdp.SGDP._layer_view": [[23, 25], ["x.view"], "methods", ["None"], ["", "def", "_layer_view", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", ".", "view", "(", "1", ",", "-", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.sgdp.SGDP._cosine_similarity": [[26, 31], ["view_func", "view_func", "torch.cosine_similarity().abs_", "torch.cosine_similarity().abs_", "torch.cosine_similarity().abs_", "torch.cosine_similarity", "torch.cosine_similarity", "torch.cosine_similarity"], "methods", ["None"], ["", "def", "_cosine_similarity", "(", "self", ",", "x", ",", "y", ",", "eps", ",", "view_func", ")", ":", "\n", "        ", "x", "=", "view_func", "(", "x", ")", "\n", "y", "=", "view_func", "(", "y", ")", "\n", "\n", "return", "F", ".", "cosine_similarity", "(", "x", ",", "y", ",", "dim", "=", "1", ",", "eps", "=", "eps", ")", ".", "abs_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.sgdp.SGDP._projection": [[32, 47], ["sgdp.SGDP._cosine_similarity", "sgdp.SGDP.max", "len", "math.sqrt", "view_func().norm().view().add_", "view_func().sum().view", "view_func().size", "view_func().norm().view", "view_func().sum", "view_func", "view_func().norm", "view_func", "view_func"], "methods", ["home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._cosine_similarity"], ["", "def", "_projection", "(", "self", ",", "p", ",", "grad", ",", "perturb", ",", "delta", ",", "wd_ratio", ",", "eps", ")", ":", "\n", "        ", "wd", "=", "1", "\n", "expand_size", "=", "[", "-", "1", "]", "+", "[", "1", "]", "*", "(", "len", "(", "p", ".", "shape", ")", "-", "1", ")", "\n", "for", "view_func", "in", "[", "self", ".", "_channel_view", ",", "self", ".", "_layer_view", "]", ":", "\n", "\n", "            ", "cosine_sim", "=", "self", ".", "_cosine_similarity", "(", "grad", ",", "p", ".", "data", ",", "eps", ",", "view_func", ")", "\n", "\n", "if", "cosine_sim", ".", "max", "(", ")", "<", "delta", "/", "math", ".", "sqrt", "(", "view_func", "(", "p", ".", "data", ")", ".", "size", "(", "1", ")", ")", ":", "\n", "                ", "p_n", "=", "p", ".", "data", "/", "view_func", "(", "p", ".", "data", ")", ".", "norm", "(", "dim", "=", "1", ")", ".", "view", "(", "expand_size", ")", ".", "add_", "(", "eps", ")", "\n", "perturb", "-=", "p_n", "*", "view_func", "(", "p_n", "*", "perturb", ")", ".", "sum", "(", "dim", "=", "1", ")", ".", "view", "(", "expand_size", ")", "\n", "wd", "=", "wd_ratio", "\n", "\n", "return", "perturb", ",", "wd", "\n", "\n", "", "", "return", "perturb", ",", "wd", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.sgdp.SGDP.step": [[48, 89], ["closure", "buf.mul_().add_", "p.data.add_", "len", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "len", "sgdp.SGDP._projection", "p.data.mul_", "buf.mul_"], "methods", ["home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._projection"], ["", "def", "step", "(", "self", ",", "closure", "=", "None", ")", ":", "\n", "        ", "loss", "=", "None", "\n", "if", "closure", "is", "not", "None", ":", "\n", "            ", "loss", "=", "closure", "(", ")", "\n", "\n", "", "for", "group", "in", "self", ".", "param_groups", ":", "\n", "            ", "momentum", "=", "group", "[", "'momentum'", "]", "\n", "dampening", "=", "group", "[", "'dampening'", "]", "\n", "nesterov", "=", "group", "[", "'nesterov'", "]", "\n", "\n", "for", "p", "in", "group", "[", "'params'", "]", ":", "\n", "                ", "if", "p", ".", "grad", "is", "None", ":", "\n", "                    ", "continue", "\n", "", "grad", "=", "p", ".", "grad", ".", "data", "\n", "state", "=", "self", ".", "state", "[", "p", "]", "\n", "\n", "# State initialization", "\n", "if", "len", "(", "state", ")", "==", "0", ":", "\n", "                    ", "state", "[", "'momentum'", "]", "=", "torch", ".", "zeros_like", "(", "p", ".", "data", ")", "\n", "\n", "# SGD", "\n", "", "buf", "=", "state", "[", "'momentum'", "]", "\n", "buf", ".", "mul_", "(", "momentum", ")", ".", "add_", "(", "grad", ",", "alpha", "=", "1", "-", "dampening", ")", "\n", "if", "nesterov", ":", "\n", "                    ", "d_p", "=", "grad", "+", "momentum", "*", "buf", "\n", "", "else", ":", "\n", "                    ", "d_p", "=", "buf", "\n", "\n", "# Projection", "\n", "", "wd_ratio", "=", "1", "\n", "if", "len", "(", "p", ".", "shape", ")", ">", "1", ":", "\n", "                    ", "d_p", ",", "wd_ratio", "=", "self", ".", "_projection", "(", "p", ",", "grad", ",", "d_p", ",", "group", "[", "'delta'", "]", ",", "group", "[", "'wd_ratio'", "]", ",", "group", "[", "'eps'", "]", ")", "\n", "\n", "# Weight decay", "\n", "", "if", "group", "[", "'weight_decay'", "]", ">", "0", ":", "\n", "                    ", "p", ".", "data", ".", "mul_", "(", "1", "-", "group", "[", "'lr'", "]", "*", "group", "[", "'weight_decay'", "]", "*", "wd_ratio", "/", "(", "1", "-", "momentum", ")", ")", "\n", "\n", "# Step", "\n", "", "p", ".", "data", ".", "add_", "(", "d_p", ",", "alpha", "=", "-", "group", "[", "'lr'", "]", ")", "\n", "\n", "", "", "return", "loss", "\n", "", "", ""]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP.__init__": [[14, 19], ["dict", "torch.optim.optimizer.Optimizer.__init__"], "methods", ["home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP.__init__"], ["    ", "def", "__init__", "(", "self", ",", "params", ",", "lr", "=", "1e-3", ",", "betas", "=", "(", "0.9", ",", "0.999", ")", ",", "eps", "=", "1e-8", ",", "\n", "weight_decay", "=", "0", ",", "delta", "=", "0.1", ",", "wd_ratio", "=", "0.1", ",", "nesterov", "=", "False", ")", ":", "\n", "        ", "defaults", "=", "dict", "(", "lr", "=", "lr", ",", "betas", "=", "betas", ",", "eps", "=", "eps", ",", "weight_decay", "=", "weight_decay", ",", "\n", "delta", "=", "delta", ",", "wd_ratio", "=", "wd_ratio", ",", "nesterov", "=", "nesterov", ")", "\n", "super", "(", "AdamP", ",", "self", ")", ".", "__init__", "(", "params", ",", "defaults", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._channel_view": [[20, 22], ["x.view", "x.size"], "methods", ["None"], ["", "def", "_channel_view", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", ".", "view", "(", "x", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._layer_view": [[23, 25], ["x.view"], "methods", ["None"], ["", "def", "_layer_view", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", ".", "view", "(", "1", ",", "-", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._cosine_similarity": [[26, 31], ["view_func", "view_func", "torch.cosine_similarity().abs_", "torch.cosine_similarity().abs_", "torch.cosine_similarity().abs_", "torch.cosine_similarity", "torch.cosine_similarity", "torch.cosine_similarity"], "methods", ["None"], ["", "def", "_cosine_similarity", "(", "self", ",", "x", ",", "y", ",", "eps", ",", "view_func", ")", ":", "\n", "        ", "x", "=", "view_func", "(", "x", ")", "\n", "y", "=", "view_func", "(", "y", ")", "\n", "\n", "return", "F", ".", "cosine_similarity", "(", "x", ",", "y", ",", "dim", "=", "1", ",", "eps", "=", "eps", ")", ".", "abs_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._projection": [[32, 47], ["adamp.AdamP._cosine_similarity", "adamp.AdamP.max", "len", "math.sqrt", "view_func().norm().view().add_", "view_func().sum().view", "view_func().size", "view_func().norm().view", "view_func().sum", "view_func", "view_func().norm", "view_func", "view_func"], "methods", ["home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._cosine_similarity"], ["", "def", "_projection", "(", "self", ",", "p", ",", "grad", ",", "perturb", ",", "delta", ",", "wd_ratio", ",", "eps", ")", ":", "\n", "        ", "wd", "=", "1", "\n", "expand_size", "=", "[", "-", "1", "]", "+", "[", "1", "]", "*", "(", "len", "(", "p", ".", "shape", ")", "-", "1", ")", "\n", "for", "view_func", "in", "[", "self", ".", "_channel_view", ",", "self", ".", "_layer_view", "]", ":", "\n", "\n", "            ", "cosine_sim", "=", "self", ".", "_cosine_similarity", "(", "grad", ",", "p", ".", "data", ",", "eps", ",", "view_func", ")", "\n", "\n", "if", "cosine_sim", ".", "max", "(", ")", "<", "delta", "/", "math", ".", "sqrt", "(", "view_func", "(", "p", ".", "data", ")", ".", "size", "(", "1", ")", ")", ":", "\n", "                ", "p_n", "=", "p", ".", "data", "/", "view_func", "(", "p", ".", "data", ")", ".", "norm", "(", "dim", "=", "1", ")", ".", "view", "(", "expand_size", ")", ".", "add_", "(", "eps", ")", "\n", "perturb", "-=", "p_n", "*", "view_func", "(", "p_n", "*", "perturb", ")", ".", "sum", "(", "dim", "=", "1", ")", ".", "view", "(", "expand_size", ")", "\n", "wd", "=", "wd_ratio", "\n", "\n", "return", "perturb", ",", "wd", "\n", "\n", "", "", "return", "perturb", ",", "wd", "\n", "\n"]], "home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP.step": [[48, 101], ["closure", "exp_avg.mul_().add_", "exp_avg_sq.mul_().addcmul_", "p.data.add_", "len", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "len", "adamp.AdamP._projection", "p.data.mul_", "exp_avg.mul_", "exp_avg_sq.mul_", "exp_avg_sq.sqrt", "math.sqrt"], "methods", ["home.repos.pwc.inspect_result.clovaai_AdamP.adamp.adamp.AdamP._projection"], ["", "def", "step", "(", "self", ",", "closure", "=", "None", ")", ":", "\n", "        ", "loss", "=", "None", "\n", "if", "closure", "is", "not", "None", ":", "\n", "            ", "loss", "=", "closure", "(", ")", "\n", "\n", "", "for", "group", "in", "self", ".", "param_groups", ":", "\n", "            ", "for", "p", "in", "group", "[", "'params'", "]", ":", "\n", "                ", "if", "p", ".", "grad", "is", "None", ":", "\n", "                    ", "continue", "\n", "\n", "", "grad", "=", "p", ".", "grad", ".", "data", "\n", "beta1", ",", "beta2", "=", "group", "[", "'betas'", "]", "\n", "nesterov", "=", "group", "[", "'nesterov'", "]", "\n", "\n", "state", "=", "self", ".", "state", "[", "p", "]", "\n", "\n", "# State initialization", "\n", "if", "len", "(", "state", ")", "==", "0", ":", "\n", "                    ", "state", "[", "'step'", "]", "=", "0", "\n", "state", "[", "'exp_avg'", "]", "=", "torch", ".", "zeros_like", "(", "p", ".", "data", ")", "\n", "state", "[", "'exp_avg_sq'", "]", "=", "torch", ".", "zeros_like", "(", "p", ".", "data", ")", "\n", "\n", "# Adam", "\n", "", "exp_avg", ",", "exp_avg_sq", "=", "state", "[", "'exp_avg'", "]", ",", "state", "[", "'exp_avg_sq'", "]", "\n", "\n", "state", "[", "'step'", "]", "+=", "1", "\n", "bias_correction1", "=", "1", "-", "beta1", "**", "state", "[", "'step'", "]", "\n", "bias_correction2", "=", "1", "-", "beta2", "**", "state", "[", "'step'", "]", "\n", "\n", "exp_avg", ".", "mul_", "(", "beta1", ")", ".", "add_", "(", "grad", ",", "alpha", "=", "1", "-", "beta1", ")", "\n", "exp_avg_sq", ".", "mul_", "(", "beta2", ")", ".", "addcmul_", "(", "grad", ",", "grad", ",", "value", "=", "1", "-", "beta2", ")", "\n", "\n", "denom", "=", "(", "exp_avg_sq", ".", "sqrt", "(", ")", "/", "math", ".", "sqrt", "(", "bias_correction2", ")", ")", ".", "add_", "(", "group", "[", "'eps'", "]", ")", "\n", "step_size", "=", "group", "[", "'lr'", "]", "/", "bias_correction1", "\n", "\n", "if", "nesterov", ":", "\n", "                    ", "perturb", "=", "(", "beta1", "*", "exp_avg", "+", "(", "1", "-", "beta1", ")", "*", "grad", ")", "/", "denom", "\n", "", "else", ":", "\n", "                    ", "perturb", "=", "exp_avg", "/", "denom", "\n", "\n", "# Projection", "\n", "", "wd_ratio", "=", "1", "\n", "if", "len", "(", "p", ".", "shape", ")", ">", "1", ":", "\n", "                    ", "perturb", ",", "wd_ratio", "=", "self", ".", "_projection", "(", "p", ",", "grad", ",", "perturb", ",", "group", "[", "'delta'", "]", ",", "group", "[", "'wd_ratio'", "]", ",", "group", "[", "'eps'", "]", ")", "\n", "\n", "# Weight decay", "\n", "", "if", "group", "[", "'weight_decay'", "]", ">", "0", ":", "\n", "                    ", "p", ".", "data", ".", "mul_", "(", "1", "-", "group", "[", "'lr'", "]", "*", "group", "[", "'weight_decay'", "]", "*", "wd_ratio", ")", "\n", "\n", "# Step", "\n", "", "p", ".", "data", ".", "add_", "(", "perturb", ",", "alpha", "=", "-", "step_size", ")", "\n", "\n", "", "", "return", "loss", "\n", "", "", ""]]}