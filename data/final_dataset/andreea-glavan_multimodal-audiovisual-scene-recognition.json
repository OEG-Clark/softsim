{"home.repos.pwc.inspect_result.andreea-glavan_multimodal-audiovisual-scene-recognition.Code.joint_late_fusion.plot_cm": [[70, 89], ["sklearn.metrics.confusion_matrix", "numpy.sum", "numpy.empty_like().astype", "range", "pd.DataFrame", "matplotlib.subplots", "seaborn.heatmap", "matplotlib.show", "range", "np.sum.astype", "numpy.empty_like", "annot[].replace", "print"], "function", ["None"], ["def", "plot_cm", "(", "labels", ",", "res", ",", "class_names", ")", ":", "\n", "    ", "cm", "=", "confusion_matrix", "(", "labels", ",", "res", ")", "\n", "cm_sum", "=", "np", ".", "sum", "(", "cm", ",", "axis", "=", "1", ",", "keepdims", "=", "True", ")", "\n", "cm_perc", "=", "cm", "/", "cm_sum", ".", "astype", "(", "float", ")", "*", "100", "\n", "annot", "=", "np", ".", "empty_like", "(", "cm", ")", ".", "astype", "(", "str", ")", "\n", "nrows", ",", "ncols", "=", "cm", ".", "shape", "\n", "for", "i", "in", "range", "(", "nrows", ")", ":", "\n", "        ", "for", "j", "in", "range", "(", "ncols", ")", ":", "\n", "            ", "c", "=", "cm", "[", "i", ",", "j", "]", "\n", "p", "=", "cm_perc", "[", "i", ",", "j", "]", "\n", "\n", "annot", "[", "i", ",", "j", "]", "=", "'%.1f%%'", "%", "(", "p", ")", "\n", "annot", "[", "i", ",", "j", "]", "=", "annot", "[", "i", ",", "j", "]", ".", "replace", "(", "'%'", ",", "''", ")", "\n", "print", "(", "annot", "[", "i", ",", "j", "]", ")", "\n", "\n", "", "", "cm", "=", "pd", ".", "DataFrame", "(", "cm", ",", "index", "=", "class_names", ",", "columns", "=", "class_names", ")", "\n", "fig", ",", "ax", "=", "plt", ".", "subplots", "(", "figsize", "=", "(", "9", ",", "9", ")", ")", "\n", "sns", ".", "heatmap", "(", "cm", ",", "annot", "=", "annot", ",", "cmap", "=", "\"BuPu\"", ",", "fmt", "=", "''", ",", "ax", "=", "ax", ")", "\n", "plt", ".", "show", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.andreea-glavan_multimodal-audiovisual-scene-recognition.Code.joint_late_fusion.IG_Net": [[95, 135], ["Input", "concatenate", "keras.models.Model", "Embedding", "LSTM", "Input", "Dense", "Dropout", "Dense", "Dropout", "Dense", "ConvLSTM2D", "Flatten", "Input", "Dense", "Dense", "Dense", "Dense"], "function", ["None"], ["", "def", "IG_Net", "(", "visual_mode", ",", "cnn_size", ",", "fusion", ")", ":", "\n", "# textual modality layers", "\n", "    ", "text_in", "=", "Input", "(", "shape", "=", "[", "max_len", "]", ")", "\n", "layer", "=", "Embedding", "(", "max_words", ",", "50", ",", "mask_zero", "=", "True", ",", "input_length", "=", "max_len", ",", "trainable", "=", "False", ")", "(", "text_in", ")", "\n", "#layer = Dropout(0.1)(layer) #s", "\n", "layer_text", "=", "LSTM", "(", "512", ")", "(", "layer", ")", "\n", "\n", "# visual modality layers - process frames with convlstm or cnn", "\n", "if", "visual_mode", "==", "\"frames\"", ":", "\n", "      ", "img_in", "=", "Input", "(", "shape", "=", "(", "img_seq_len", ",", "img_height", ",", "img_width", ",", "3", ")", ")", "\n", "layer", "=", "ConvLSTM2D", "(", "filters", "=", "512", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "return_sequences", "=", "False", ",", "data_format", "=", "\"channels_last\"", ",", "\n", "input_shape", "=", "(", "img_seq_len", ",", "img_height", ",", "img_width", ",", "3", ")", ")", "(", "img_in", ")", "\n", "layer_img", "=", "Flatten", "(", ")", "(", "layer", ")", "\n", "", "elif", "visual_mode", "==", "\"cnn\"", ":", "\n", "      ", "img_in", "=", "Input", "(", "shape", "=", "[", "cnn_size", "]", ")", "\n", "layer_img", "=", "Dense", "(", "512", ")", "(", "img_in", ")", "\n", "\n", "# generate final vectors based on fusion type (global vs softmax)", "\n", "", "if", "fusion", "==", "\"joint\"", ":", "\n", "      ", "text_out", "=", "layer_text", "\n", "img_out", "=", "layer_img", "\n", "", "elif", "fusion", "==", "\"late\"", ":", "\n", "# text", "\n", "      ", "text_out", "=", "Dense", "(", "num_classes", ",", "name", "=", "'FC1'", ")", "(", "layer_text", ")", "\n", "# visual", "\n", "layer", "=", "Dense", "(", "256", ",", "activation", "=", "\"relu\"", ")", "(", "layer_img", ")", "\n", "img_out", "=", "Dense", "(", "num_classes", ",", "activation", "=", "\"softmax\"", ")", "(", "layer", ")", "\n", "\n", "# fusion and final layers", "\n", "", "concat_inp", "=", "concatenate", "(", "[", "text_out", ",", "img_out", "]", ")", "\n", "z", "=", "Dense", "(", "256", ",", "activation", "=", "'relu'", ")", "(", "concat_inp", ")", "\n", "z", "=", "Dropout", "(", "0.3", ")", "(", "z", ")", "\n", "z", "=", "Dense", "(", "128", ",", "activation", "=", "'relu'", ")", "(", "z", ")", "\n", "z", "=", "Dropout", "(", "0.3", ")", "(", "z", ")", "\n", "z", "=", "concat_inp", "\n", "output", "=", "Dense", "(", "num_classes", ",", "activation", "=", "'softmax'", ")", "(", "z", ")", "\n", "\n", "model", "=", "Model", "(", "inputs", "=", "[", "text_in", ",", "img_in", "]", ",", "outputs", "=", "output", ")", "\n", "\n", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.andreea-glavan_multimodal-audiovisual-scene-recognition.Code.early_fusion.plot_cm": [[65, 84], ["sklearn.metrics.confusion_matrix", "numpy.sum", "numpy.empty_like().astype", "range", "pd.DataFrame", "matplotlib.subplots", "seaborn.heatmap", "matplotlib.show", "range", "np.sum.astype", "numpy.empty_like", "annot[].replace", "print"], "function", ["None"], ["def", "plot_cm", "(", "labels", ",", "res", ",", "class_names", ")", ":", "\n", "    ", "cm", "=", "confusion_matrix", "(", "labels", ",", "res", ")", "\n", "cm_sum", "=", "np", ".", "sum", "(", "cm", ",", "axis", "=", "1", ",", "keepdims", "=", "True", ")", "\n", "cm_perc", "=", "cm", "/", "cm_sum", ".", "astype", "(", "float", ")", "*", "100", "\n", "annot", "=", "np", ".", "empty_like", "(", "cm", ")", ".", "astype", "(", "str", ")", "\n", "nrows", ",", "ncols", "=", "cm", ".", "shape", "\n", "for", "i", "in", "range", "(", "nrows", ")", ":", "\n", "        ", "for", "j", "in", "range", "(", "ncols", ")", ":", "\n", "            ", "c", "=", "cm", "[", "i", ",", "j", "]", "\n", "p", "=", "cm_perc", "[", "i", ",", "j", "]", "\n", "\n", "annot", "[", "i", ",", "j", "]", "=", "'%.1f%%'", "%", "(", "p", ")", "\n", "annot", "[", "i", ",", "j", "]", "=", "annot", "[", "i", ",", "j", "]", ".", "replace", "(", "'%'", ",", "''", ")", "\n", "print", "(", "annot", "[", "i", ",", "j", "]", ")", "\n", "\n", "", "", "cm", "=", "pd", ".", "DataFrame", "(", "cm", ",", "index", "=", "class_names", ",", "columns", "=", "class_names", ")", "\n", "fig", ",", "ax", "=", "plt", ".", "subplots", "(", "figsize", "=", "(", "9", ",", "9", ")", ")", "\n", "sns", ".", "heatmap", "(", "cm", ",", "annot", "=", "annot", ",", "cmap", "=", "\"BuPu\"", ",", "fmt", "=", "''", ",", "ax", "=", "ax", ")", "\n", "plt", ".", "show", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.andreea-glavan_multimodal-audiovisual-scene-recognition.Code.early_fusion.IG_Net": [[89, 105], ["Input", "Input", "concatenate", "keras.models.Model", "Dense", "Dense", "Dropout", "Dense", "Dropout", "Dense"], "function", ["None"], ["", "def", "IG_Net", "(", "cnn_size", ",", "embedding_len", ")", ":", "\n", "    ", "text_in", "=", "Input", "(", "shape", "=", "(", "[", "embedding_len", "]", ")", ")", "\n", "img_in", "=", "Input", "(", "shape", "=", "[", "cnn_size", "]", ")", "\n", "\n", "concat_inp", "=", "concatenate", "(", "[", "text_in", ",", "img_in", "]", ")", "\n", "\n", "z", "=", "Dense", "(", "512", ",", "activation", "=", "'relu'", ")", "(", "concat_inp", ")", "\n", "z", "=", "Dense", "(", "256", ",", "activation", "=", "'relu'", ")", "(", "z", ")", "\n", "z", "=", "Dropout", "(", "0.1", ")", "(", "z", ")", "\n", "z", "=", "Dense", "(", "128", ",", "activation", "=", "'relu'", ")", "(", "z", ")", "\n", "z", "=", "Dropout", "(", "0.1", ")", "(", "z", ")", "\n", "output", "=", "Dense", "(", "num_classes", ",", "activation", "=", "'softmax'", ")", "(", "z", ")", "\n", "\n", "model", "=", "Model", "(", "inputs", "=", "[", "text_in", ",", "img_in", "]", ",", "outputs", "=", "output", ")", "\n", "\n", "return", "model", "\n", "\n"]]}