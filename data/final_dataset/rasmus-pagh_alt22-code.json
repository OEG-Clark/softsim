{"home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.gamma_density": [[19, 24], ["math.gamma", "numpy.exp"], "function", ["None"], ["def", "gamma_density", "(", "x", ",", "alpha", ",", "beta", ")", ":", "\n", "    ", "if", "x", "<", "1e-10", ":", "# Ignore probability mass close to zero for numerical stability", "\n", "        ", "return", "0", "\n", "", "else", ":", "\n", "        ", "return", "(", "beta", "**", "alpha", ")", "*", "(", "x", "**", "(", "alpha", "-", "1", ")", ")", "*", "np", ".", "exp", "(", "-", "beta", "*", "x", ")", "/", "math", ".", "gamma", "(", "alpha", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.laplace_density": [[25, 27], ["numpy.exp", "numpy.abs"], "function", ["None"], ["", "", "def", "laplace_density", "(", "x", ",", "gamma", ")", ":", "\n", "    ", "return", "gamma", "*", "np", ".", "exp", "(", "-", "gamma", "*", "np", ".", "abs", "(", "x", ")", ")", "/", "2", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.normal_density": [[28, 30], ["numpy.exp", "numpy.sqrt"], "function", ["None"], ["", "def", "normal_density", "(", "x", ",", "sigma", "=", "1", ")", ":", "\n", "    ", "return", "np", ".", "exp", "(", "-", "(", "x", "/", "sigma", ")", "**", "2", "/", "2", ")", "/", "(", "sigma", "*", "np", ".", "sqrt", "(", "2", "*", "np", ".", "pi", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.compute_arete": [[31, 40], ["numpy.arange", "scipy.signal.convolve", "scipy.signal.convolve", "sum", "numpy.flip", "alt-code.gamma_density", "alt-code.laplace_density", "len", "len", "len", "len", "len"], "function", ["home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.gamma_density", "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.laplace_density"], ["", "def", "compute_arete", "(", "alpha", ",", "theta", ",", "lamb", ")", ":", "\n", "    ", "eval_range", "=", "np", ".", "arange", "(", "-", "width", ",", "width", "+", "stepsize", "/", "2", ",", "stepsize", ")", "\n", "gamma_val", "=", "[", "gamma_density", "(", "x", ",", "alpha", ",", "1", "/", "theta", ")", "*", "stepsize", "for", "x", "in", "eval_range", "]", "\n", "gamma_val", "[", "len", "(", "gamma_val", ")", "//", "2", "]", "=", "1", "-", "sum", "(", "gamma_val", ")", "\n", "laplace_val", "=", "[", "laplace_density", "(", "x", ",", "1", "/", "lamb", ")", "*", "stepsize", "for", "x", "in", "eval_range", "]", "\n", "gamma_minus_gamma", "=", "signal", ".", "convolve", "(", "gamma_val", ",", "np", ".", "flip", "(", "gamma_val", ")", ")", "\n", "arete_val", "=", "signal", ".", "convolve", "(", "gamma_minus_gamma", ",", "laplace_val", ")", "\n", "arete_val", "=", "arete_val", "[", "len", "(", "arete_val", ")", "//", "2", "-", "len", "(", "eval_range", ")", "//", "2", ":", "len", "(", "arete_val", ")", "//", "2", "+", "(", "len", "(", "eval_range", ")", "+", "1", ")", "//", "2", "]", "\n", "return", "arete_val", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.compute_cdfs": [[44, 67], ["numpy.exp", "numpy.exp", "arete.sort", "laplace.sort", "matplotlib.clf", "matplotlib.xlim", "matplotlib.ylim", "matplotlib.plot", "matplotlib.plot", "matplotlib.plot", "matplotlib.legend", "matplotlib.title", "matplotlib.savefig", "numpy.random.exponential", "numpy.random.exponential", "numpy.random.exponential", "numpy.linspace", "numpy.linspace", "numpy.random.exponential", "numpy.exp", "numpy.random.gamma", "numpy.random.gamma", "numpy.exp", "numpy.exp", "round", "round", "round", "round", "numpy.exp", "numpy.exp"], "function", ["None"], ["", "def", "compute_cdfs", "(", "epsilon", ")", ":", "\n", "    ", "alpha", "=", "np", ".", "exp", "(", "-", "epsilon", "/", "4", ")", "\n", "theta", "=", "4", "/", "epsilon", "\n", "lamb", "=", "np", ".", "exp", "(", "-", "epsilon", "/", "4", ")", "\n", "n", "=", "100000", "\n", "arete", "=", "np", ".", "random", ".", "gamma", "(", "alpha", ",", "scale", "=", "theta", ",", "size", "=", "n", ")", "-", "np", ".", "random", ".", "gamma", "(", "alpha", ",", "scale", "=", "theta", ",", "size", "=", "n", ")", "+", "np", ".", "random", ".", "exponential", "(", "scale", "=", "lamb", ",", "size", "=", "n", ")", "-", "np", ".", "random", ".", "exponential", "(", "scale", "=", "lamb", ",", "size", "=", "n", ")", "\n", "laplace_param", "=", "1.", "/", "epsilon", "\n", "laplace", "=", "np", ".", "random", ".", "exponential", "(", "scale", "=", "laplace_param", ",", "size", "=", "n", ")", "-", "np", ".", "random", ".", "exponential", "(", "scale", "=", "laplace_param", ",", "size", "=", "n", ")", "\n", "staircase_epsilon", "=", "epsilon", "/", "2", "\n", "staircase_width_param", "=", "1", "/", "(", "1", "+", "np", ".", "exp", "(", "staircase_epsilon", "/", "2", ")", ")", "\n", "staircase_height_param", "=", "0.5", "*", "(", "1", "-", "np", ".", "exp", "(", "-", "staircase_epsilon", ")", ")", "/", "(", "staircase_width_param", "+", "np", ".", "exp", "(", "-", "staircase_epsilon", ")", "*", "(", "1", "-", "staircase_width_param", ")", ")", "\n", "arete", ".", "sort", "(", ")", "\n", "laplace", ".", "sort", "(", ")", "\n", "x_min", ",", "x_max", "=", "laplace", "[", "n", "//", "100", "]", ",", "laplace", "[", "-", "n", "//", "100", "]", "\n", "plt", ".", "clf", "(", ")", "\n", "plt", ".", "xlim", "(", "x_min", ",", "x_max", ")", "\n", "plt", ".", "ylim", "(", "0", ",", "1", ")", "\n", "plt", ".", "plot", "(", "arete", ",", "np", ".", "linspace", "(", "0", ",", "1", ",", "n", ")", ",", "label", "=", "f'Arete({round(alpha,3)},{round(theta, 3)},{round(lamb, 3)})'", ")", "\n", "plt", ".", "plot", "(", "laplace", ",", "np", ".", "linspace", "(", "0", ",", "1", ",", "n", ")", ",", "label", "=", "f'Laplace({round(laplace_param, 3)})'", ")", "\n", "plt", ".", "plot", "(", "[", "-", "staircase_width_param", "-", "1", ",", "-", "staircase_width_param", ",", "staircase_width_param", ",", "staircase_width_param", "+", "1", "]", ",", "[", "0.5", "-", "staircase_width_param", "*", "staircase_height_param", "-", "staircase_height_param", "/", "np", ".", "exp", "(", "staircase_epsilon", ")", ",", "0.5", "-", "staircase_width_param", "*", "staircase_height_param", ",", "0.5", "+", "staircase_width_param", "*", "staircase_height_param", ",", "0.5", "+", "staircase_width_param", "*", "staircase_height_param", "+", "staircase_height_param", "/", "np", ".", "exp", "(", "staircase_epsilon", ")", "]", ",", "label", "=", "f\"Staircase(epsilon/2)\"", ")", "\n", "plt", ".", "legend", "(", ")", "\n", "plt", ".", "title", "(", "f\"Empirical CDF ($n$={n}), \"", "+", "r\"$\\varepsilon$=\"", "+", "f\"{epsilon}\"", ")", "\n", "plt", ".", "savefig", "(", "f\"arete_cdf_eps_{epsilon}.pdf\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.estimate_epsilon": [[74, 82], ["numpy.arange", "alt-code.compute_arete", "int", "numpy.log", "sum", "max", "abs", "range", "len"], "function", ["home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.compute_arete"], ["", "def", "estimate_epsilon", "(", "alpha", ",", "theta", ",", "lamb", ")", ":", "\n", "    ", "eval_range", "=", "np", ".", "arange", "(", "-", "width", ",", "width", "+", "stepsize", "/", "2", ",", "stepsize", ")", "\n", "arete_val", "=", "compute_arete", "(", "alpha", ",", "theta", ",", "lamb", ")", "\n", "num_steps", "=", "int", "(", "1", "/", "stepsize", ")", "\n", "ratios", "=", "arete_val", "[", "num_steps", ":", "]", "/", "arete_val", "[", ":", "-", "num_steps", "]", "\n", "observed_epsilon", "=", "np", ".", "log", "(", "max", "(", "ratios", ")", ")", "\n", "observed_error", "=", "sum", "(", "[", "abs", "(", "eval_range", "[", "i", "]", ")", "*", "arete_val", "[", "i", "]", "for", "i", "in", "range", "(", "len", "(", "eval_range", ")", ")", "]", ")", "\n", "return", "observed_epsilon", ",", "observed_error", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.plot_privacy_loss": [[83, 100], ["alt-code.estimate_epsilon", "numpy.arange", "alt-code.compute_arete", "matplotlib.clf", "matplotlib.subplots", "ax.spines[].set_visible", "ax.spines[].set_visible", "matplotlib.plot", "matplotlib.xlim", "matplotlib.ylim", "matplotlib.title", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.savefig", "min", "max", "min", "max", "len", "numpy.log", "str", "round"], "function", ["home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.estimate_epsilon", "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.compute_arete"], ["", "def", "plot_privacy_loss", "(", "alpha", ",", "theta", ",", "lamb", ",", "plot_range", "=", "[", "0", ",", "4", "]", ",", "y_range", "=", "[", "0", ",", "4", "]", ",", "filename", "=", "None", ")", ":", "\n", "    ", "observed_epsilon", ",", "observed_error", "=", "estimate_epsilon", "(", "alpha", ",", "theta", ",", "lamb", ")", "\n", "eval_range", "=", "np", ".", "arange", "(", "-", "width", ",", "width", "+", "stepsize", "/", "2", ",", "stepsize", ")", "\n", "arete_val", "=", "compute_arete", "(", "alpha", ",", "theta", ",", "lamb", ")", "\n", "density_at_zero", "=", "arete_val", "[", "len", "(", "arete_val", ")", "//", "2", "]", "\n", "plt", ".", "clf", "(", ")", "\n", "fig", ",", "ax", "=", "plt", ".", "subplots", "(", ")", "\n", "ax", ".", "spines", "[", "'top'", "]", ".", "set_visible", "(", "False", ")", "\n", "ax", ".", "spines", "[", "'right'", "]", ".", "set_visible", "(", "False", ")", "\n", "plt", ".", "plot", "(", "eval_range", ",", "-", "np", ".", "log", "(", "arete_val", "/", "density_at_zero", ")", "/", "observed_epsilon", ")", "\n", "plt", ".", "xlim", "(", "(", "min", "(", "plot_range", ")", ",", "max", "(", "plot_range", ")", ")", ")", "\n", "plt", ".", "ylim", "(", "(", "min", "(", "y_range", ")", ",", "max", "(", "y_range", ")", ")", ")", "\n", "plt", ".", "title", "(", "r'Worst case privacy loss ($\\varepsilon$ ='", "+", "str", "(", "round", "(", "observed_epsilon", ")", ")", "+", "')'", ")", "\n", "plt", ".", "xlabel", "(", "r'$|q(x)-q(y)|/\\Delta$'", ")", "\n", "plt", ".", "ylabel", "(", "r'Privacy loss / $\\varepsilon$'", ")", "\n", "if", "filename", "is", "not", "None", ":", "\n", "        ", "plt", ".", "savefig", "(", "filename", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.plot_staircase_privacy_loss": [[101, 114], ["matplotlib.subplots", "ax.spines[].set_visible", "ax.spines[].set_visible", "matplotlib.clf", "matplotlib.step", "matplotlib.xlim", "matplotlib.ylim", "matplotlib.title", "matplotlib.xlabel", "matplotlib.ylabel", "range", "range", "matplotlib.savefig", "min", "min", "min", "max", "min", "max", "max", "max"], "function", ["None"], ["", "", "def", "plot_staircase_privacy_loss", "(", "plot_range", "=", "[", "0", ",", "4", "]", ",", "y_range", "=", "[", "0", ",", "4", "]", ",", "filename", "=", "None", ")", ":", "\n", "    ", "fig", ",", "ax", "=", "plt", ".", "subplots", "(", ")", "\n", "ax", ".", "spines", "[", "'top'", "]", ".", "set_visible", "(", "False", ")", "\n", "ax", ".", "spines", "[", "'right'", "]", ".", "set_visible", "(", "False", ")", "\n", "plt", ".", "clf", "(", ")", "\n", "plt", ".", "step", "(", "range", "(", "min", "(", "plot_range", ")", ",", "max", "(", "plot_range", ")", "+", "1", ")", ",", "range", "(", "min", "(", "plot_range", ")", ",", "max", "(", "plot_range", ")", "+", "1", ")", ")", "\n", "plt", ".", "xlim", "(", "(", "min", "(", "plot_range", ")", ",", "max", "(", "plot_range", ")", ")", ")", "\n", "plt", ".", "ylim", "(", "(", "min", "(", "y_range", ")", ",", "max", "(", "y_range", ")", ")", ")", "\n", "plt", ".", "title", "(", "r'Worst case privacy loss'", ")", "\n", "plt", ".", "xlabel", "(", "r'$|q(x)-q(y)|/\\Delta$'", ")", "\n", "plt", ".", "ylabel", "(", "r'Privacy loss / $\\varepsilon$'", ")", "\n", "if", "filename", "is", "not", "None", ":", "\n", "        ", "plt", ".", "savefig", "(", "filename", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.plot_arete": [[129, 141], ["numpy.arange", "alt-code.compute_arete", "matplotlib.clf", "matplotlib.plot", "matplotlib.plot", "matplotlib.xlim", "matplotlib.legend", "alt-code.laplace_density", "numpy.sum", "matplotlib.savefig", "min", "max", "round", "round", "round", "round"], "function", ["home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.compute_arete", "home.repos.pwc.inspect_result.rasmus-pagh_alt22-code.None.alt-code.laplace_density"], ["", "def", "plot_arete", "(", "alpha", ",", "theta", ",", "lamb", ",", "epsilon", ",", "plot_range", "=", "[", "-", "1", ",", "1", "]", ",", "filename", "=", "None", ")", ":", "\n", "    ", "eval_range", "=", "np", ".", "arange", "(", "-", "width", ",", "width", "+", "stepsize", "/", "2", ",", "stepsize", ")", "\n", "arete_val", "=", "compute_arete", "(", "alpha", ",", "theta", ",", "lamb", ")", "\n", "epsilon_laplace_val", "=", "[", "laplace_density", "(", "x", ",", "epsilon", ")", "for", "x", "in", "eval_range", "]", "\n", "epsilon_laplace_val", "=", "epsilon_laplace_val", "/", "np", ".", "sum", "(", "epsilon_laplace_val", ")", "\n", "plt", ".", "clf", "(", ")", "\n", "plt", ".", "plot", "(", "eval_range", ",", "arete_val", ",", "label", "=", "f'Arete({round(alpha,3)},{round(theta, 3)},{round(lamb, 3)})'", ")", "\n", "plt", ".", "plot", "(", "eval_range", ",", "epsilon_laplace_val", ",", "label", "=", "f'Laplace({round(1/epsilon, 3)})'", ")", "\n", "plt", ".", "xlim", "(", "(", "min", "(", "plot_range", ")", ",", "max", "(", "plot_range", ")", ")", ")", "\n", "plt", ".", "legend", "(", ")", "\n", "if", "filename", "is", "not", "None", ":", "\n", "        ", "plt", ".", "savefig", "(", "filename", ")", "\n", "\n"]]}