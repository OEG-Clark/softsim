{"home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.datasets.factory.get_imdb": [[41, 46], ["__sets.has_key", "KeyError"], "function", ["None"], ["", "", "def", "get_imdb", "(", "name", ")", ":", "\n", "    ", "\"\"\"Get an imdb (image database) by name.\"\"\"", "\n", "if", "not", "__sets", ".", "has_key", "(", "name", ")", ":", "\n", "        ", "raise", "KeyError", "(", "'Unknown dataset: {}'", ".", "format", "(", "name", ")", ")", "\n", "", "return", "__sets", "[", "name", "]", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.datasets.factory.list_imdbs": [[47, 50], ["__sets.keys"], "function", ["None"], ["", "def", "list_imdbs", "(", ")", ":", "\n", "    ", "\"\"\"List all registered imdbs.\"\"\"", "\n", "return", "__sets", ".", "keys", "(", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.vgg16_512x512.VGG16_COCO_512.AddExtraLayers": [[15, 78], ["ConvBNLayer", "ConvBNLayer", "arm_source_layers.reverse", "normalizations.reverse", "enumerate", "net.keys", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer", "L.Normalize", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "use_batchnorm", "=", "True", ",", "arm_source_layers", "=", "[", "]", ",", "normalizations", "=", "[", "]", ",", "lr_mult", "=", "1", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 512/32: 16 x 16", "\n", "from_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "\n", "# 512/64: 8 x 8", "\n", "out_layer", "=", "\"conv6_1\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "1", ",", "0", ",", "1", ",", "lr_mult", "=", "lr_mult", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"conv6_2\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "2", ",", "lr_mult", "=", "lr_mult", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "normalizations", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "out_layer", "=", "layer", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "index", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "index", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "out_layer", "=", "norm_name", "\n", "arm_source_layers", "[", "index", "]", "=", "norm_name", "\n", "", "", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ",", "lr_mult", "=", "lr_mult", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ",", "lr_mult", "=", "lr_mult", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ",", "lr_mult", "=", "lr_mult", ")", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ",", "\n", "lr_mult", "=", "lr_mult", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ",", "lr_mult", "=", "lr_mult", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ",", "lr_mult", "=", "lr_mult", ")", "\n", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.ResNet18_COCO_320.AddExtraLayers": [[15, 80], ["ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "L.Eltwise", "L.ReLU", "arm_source_layers.reverse", "enumerate", "net.keys", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "'res6_branch1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'6_branch1'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'6_branch1'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "'res6_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'res6_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'6_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'6_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res6_branch2a'", ",", "'res6_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'6_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'6_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res6", "=", "L", ".", "Eltwise", "(", "net", ".", "res6_branch1", ",", "net", ".", "res6_branch2b", ")", "\n", "net", ".", "res6_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res6", ",", "in_place", "=", "True", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "256", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.check_if_exist": [[8, 10], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.make_if_not_exist": [[11, 14], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.UnpackVariable": [[15, 29], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.ConvBNLayer": [[30, 86], ["model_libs_org.UnpackVariable", "model_libs_org.UnpackVariable", "model_libs_org.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.DeconvBNLayer": [[87, 132], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.EltwiseLayer": [[134, 137], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.ResBody": [[139, 197], ["model_libs_org.ConvBNLayer", "model_libs_org.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_org.ConvBNLayer", "model_libs_org.ConvBNLayer", "model_libs_org.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.InceptionTower": [[199, 212], ["caffe.layers.Pooling", "param.update", "model_libs_org.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.CreateAnnotatedDataLayer": [[213, 238], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.ZFNetBody": [[240, 327], ["caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.LRN", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.LRN", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "net.keys", "dict", "dict", "net.keys", "caffe.layers.Softmax", "dict", "dict", "dict", "dict", "caffe.layers.Pooling", "caffe.layers.Pooling", "caffe.layers.ReLU", "caffe.layers.ReLU", "caffe.layers.InnerProduct", "caffe.layers.ReLU", "caffe.layers.InnerProduct", "caffe.layers.ReLU", "net.keys", "caffe.layers.Convolution", "caffe.layers.InnerProduct", "net.update", "caffe.layers.Dropout", "caffe.layers.Convolution", "caffe.layers.Convolution", "caffe.layers.Dropout", "caffe.layers.Dropout", "caffe.layers.Dropout", "caffe.layers.Convolution", "caffe.layers.Convolution", "caffe.layers.Convolution", "caffe.layers.Convolution"], "function", ["None"], ["", "def", "ZFNetBody", "(", "net", ",", "from_layer", ",", "need_fc", "=", "True", ",", "fully_conv", "=", "False", ",", "reduced", "=", "False", ",", "\n", "dilated", "=", "False", ",", "dropout", "=", "True", ",", "need_fc8", "=", "False", ",", "freeze_layers", "=", "[", "]", ")", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", ",", "dict", "(", "lr_mult", "=", "2", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "}", "\n", "\n", "assert", "from_layer", "in", "net", ".", "keys", "(", ")", "\n", "net", ".", "conv1", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "96", ",", "pad", "=", "3", ",", "kernel_size", "=", "7", ",", "stride", "=", "2", ",", "**", "kwargs", ")", "\n", "net", ".", "relu1", "=", "L", ".", "ReLU", "(", "net", ".", "conv1", ",", "in_place", "=", "True", ")", "\n", "\n", "net", ".", "norm1", "=", "L", ".", "LRN", "(", "net", ".", "relu1", ",", "local_size", "=", "3", ",", "alpha", "=", "0.00005", ",", "beta", "=", "0.75", ",", "\n", "norm_region", "=", "P", ".", "LRN", ".", "WITHIN_CHANNEL", ",", "engine", "=", "P", ".", "LRN", ".", "CAFFE", ")", "\n", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "norm1", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "net", ".", "conv2", "=", "L", ".", "Convolution", "(", "net", ".", "pool1", ",", "num_output", "=", "256", ",", "pad", "=", "2", ",", "kernel_size", "=", "5", ",", "stride", "=", "2", ",", "**", "kwargs", ")", "\n", "net", ".", "relu2", "=", "L", ".", "ReLU", "(", "net", ".", "conv2", ",", "in_place", "=", "True", ")", "\n", "\n", "net", ".", "norm2", "=", "L", ".", "LRN", "(", "net", ".", "relu2", ",", "local_size", "=", "3", ",", "alpha", "=", "0.00005", ",", "beta", "=", "0.75", ",", "\n", "norm_region", "=", "P", ".", "LRN", ".", "WITHIN_CHANNEL", ",", "engine", "=", "P", ".", "LRN", ".", "CAFFE", ")", "\n", "\n", "net", ".", "pool2", "=", "L", ".", "Pooling", "(", "net", ".", "norm2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "net", ".", "conv3", "=", "L", ".", "Convolution", "(", "net", ".", "pool2", ",", "num_output", "=", "384", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu3", "=", "L", ".", "ReLU", "(", "net", ".", "conv3", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4", "=", "L", ".", "Convolution", "(", "net", ".", "relu3", ",", "num_output", "=", "384", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu4", "=", "L", ".", "ReLU", "(", "net", ".", "conv4", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5", "=", "L", ".", "Convolution", "(", "net", ".", "relu4", ",", "num_output", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu5", "=", "L", ".", "ReLU", "(", "net", ".", "conv5", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "need_fc", ":", "\n", "        ", "if", "dilated", ":", "\n", "            ", "name", "=", "'pool5'", "\n", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu5", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ")", "\n", "", "else", ":", "\n", "            ", "name", "=", "'pool5'", "\n", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu5", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "", "if", "fully_conv", ":", "\n", "            ", "if", "dilated", ":", "\n", "                ", "if", "reduced", ":", "\n", "                    ", "net", ".", "fc6", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "1024", ",", "pad", "=", "5", ",", "kernel_size", "=", "3", ",", "dilation", "=", "5", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "                    ", "net", ".", "fc6", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "4096", ",", "pad", "=", "5", ",", "kernel_size", "=", "6", ",", "dilation", "=", "2", ",", "**", "kwargs", ")", "\n", "", "", "else", ":", "\n", "                ", "if", "reduced", ":", "\n", "                    ", "net", ".", "fc6", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "1024", ",", "pad", "=", "2", ",", "kernel_size", "=", "3", ",", "dilation", "=", "2", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "                    ", "net", ".", "fc6", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "4096", ",", "pad", "=", "2", ",", "kernel_size", "=", "6", ",", "**", "kwargs", ")", "\n", "\n", "", "", "net", ".", "relu6", "=", "L", ".", "ReLU", "(", "net", ".", "fc6", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop6", "=", "L", ".", "Dropout", "(", "net", ".", "relu6", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "\n", "", "if", "reduced", ":", "\n", "                ", "net", ".", "fc7", "=", "L", ".", "Convolution", "(", "net", ".", "relu6", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "fc7", "=", "L", ".", "Convolution", "(", "net", ".", "relu6", ",", "num_output", "=", "4096", ",", "kernel_size", "=", "1", ",", "**", "kwargs", ")", "\n", "", "net", ".", "relu7", "=", "L", ".", "ReLU", "(", "net", ".", "fc7", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop7", "=", "L", ".", "Dropout", "(", "net", ".", "relu7", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "", "", "else", ":", "\n", "            ", "net", ".", "fc6", "=", "L", ".", "InnerProduct", "(", "net", ".", "pool5", ",", "num_output", "=", "4096", ")", "\n", "net", ".", "relu6", "=", "L", ".", "ReLU", "(", "net", ".", "fc6", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop6", "=", "L", ".", "Dropout", "(", "net", ".", "relu6", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "", "net", ".", "fc7", "=", "L", ".", "InnerProduct", "(", "net", ".", "relu6", ",", "num_output", "=", "4096", ")", "\n", "net", ".", "relu7", "=", "L", ".", "ReLU", "(", "net", ".", "fc7", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop7", "=", "L", ".", "Dropout", "(", "net", ".", "relu7", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "", "", "", "if", "need_fc8", ":", "\n", "        ", "from_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "if", "fully_conv", ":", "\n", "            ", "net", ".", "fc8", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "1000", ",", "kernel_size", "=", "1", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "            ", "net", ".", "fc8", "=", "L", ".", "InnerProduct", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "1000", ")", "\n", "", "net", ".", "prob", "=", "L", ".", "Softmax", "(", "net", ".", "fc8", ")", "\n", "\n", "# Update freeze layers.", "\n", "", "kwargs", "[", "'param'", "]", "=", "[", "dict", "(", "lr_mult", "=", "0", ",", "decay_mult", "=", "0", ")", ",", "dict", "(", "lr_mult", "=", "0", ",", "decay_mult", "=", "0", ")", "]", "\n", "layers", "=", "net", ".", "keys", "(", ")", "\n", "for", "freeze_layer", "in", "freeze_layers", ":", "\n", "        ", "if", "freeze_layer", "in", "layers", ":", "\n", "            ", "net", ".", "update", "(", "freeze_layer", ",", "kwargs", ")", "\n", "\n", "", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.VGGNetBody": [[329, 470], ["caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.ReLU", "net.keys", "dict", "dict", "net.keys", "caffe.layers.Convolution", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.Pooling", "caffe.layers.Convolution", "int", "dict", "dict", "dict", "dict", "caffe.layers.Pooling", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.ReLU", "caffe.layers.InnerProduct", "caffe.layers.ReLU", "caffe.layers.InnerProduct", "caffe.layers.ReLU", "net.update", "caffe.layers.Convolution", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.Pooling", "int", "caffe.layers.Dropout", "caffe.layers.Convolution", "caffe.layers.Convolution", "caffe.layers.Dropout", "caffe.layers.Dropout", "caffe.layers.Dropout"], "function", ["None"], ["", "def", "VGGNetBody", "(", "net", ",", "from_layer", ",", "need_fc", "=", "True", ",", "fully_conv", "=", "False", ",", "reduced", "=", "False", ",", "\n", "dilated", "=", "False", ",", "nopool", "=", "False", ",", "dropout", "=", "True", ",", "freeze_layers", "=", "[", "]", ",", "dilate_pool4", "=", "False", ")", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", ",", "dict", "(", "lr_mult", "=", "2", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "}", "\n", "\n", "assert", "from_layer", "in", "net", ".", "keys", "(", ")", "\n", "net", ".", "conv1_1", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "64", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "\n", "net", ".", "relu1_1", "=", "L", ".", "ReLU", "(", "net", ".", "conv1_1", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv1_2", "=", "L", ".", "Convolution", "(", "net", ".", "relu1_1", ",", "num_output", "=", "64", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu1_2", "=", "L", ".", "ReLU", "(", "net", ".", "conv1_2", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "nopool", ":", "\n", "        ", "name", "=", "'conv1_3'", "\n", "net", "[", "name", "]", "=", "L", ".", "Convolution", "(", "net", ".", "relu1_2", ",", "num_output", "=", "64", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "        ", "name", "=", "'pool1'", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "relu1_2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ")", "\n", "\n", "", "net", ".", "conv2_1", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "128", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu2_1", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_1", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv2_2", "=", "L", ".", "Convolution", "(", "net", ".", "relu2_1", ",", "num_output", "=", "128", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu2_2", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_2", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "nopool", ":", "\n", "        ", "name", "=", "'conv2_3'", "\n", "net", "[", "name", "]", "=", "L", ".", "Convolution", "(", "net", ".", "relu2_2", ",", "num_output", "=", "128", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "        ", "name", "=", "'pool2'", "\n", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu2_2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ")", "\n", "\n", "", "net", ".", "conv3_1", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu3_1", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_1", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_2", "=", "L", ".", "Convolution", "(", "net", ".", "relu3_1", ",", "num_output", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu3_2", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_2", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_3", "=", "L", ".", "Convolution", "(", "net", ".", "relu3_2", ",", "num_output", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu3_3", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_3", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "nopool", ":", "\n", "        ", "name", "=", "'conv3_4'", "\n", "net", "[", "name", "]", "=", "L", ".", "Convolution", "(", "net", ".", "relu3_3", ",", "num_output", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "        ", "name", "=", "'pool3'", "\n", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu3_3", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ")", "\n", "\n", "", "net", ".", "conv4_1", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "512", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu4_1", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_1", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_2", "=", "L", ".", "Convolution", "(", "net", ".", "relu4_1", ",", "num_output", "=", "512", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu4_2", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_2", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_3", "=", "L", ".", "Convolution", "(", "net", ".", "relu4_2", ",", "num_output", "=", "512", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "**", "kwargs", ")", "\n", "net", ".", "relu4_3", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_3", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "nopool", ":", "\n", "        ", "name", "=", "'conv4_4'", "\n", "net", "[", "name", "]", "=", "L", ".", "Convolution", "(", "net", ".", "relu4_3", ",", "num_output", "=", "512", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "        ", "name", "=", "'pool4'", "\n", "if", "dilate_pool4", ":", "\n", "            ", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu4_3", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "pad", "=", "1", ")", "\n", "dilation", "=", "2", "\n", "", "else", ":", "\n", "            ", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu4_3", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ")", "\n", "dilation", "=", "1", "\n", "\n", "", "", "kernel_size", "=", "3", "\n", "pad", "=", "int", "(", "(", "kernel_size", "+", "(", "dilation", "-", "1", ")", "*", "(", "kernel_size", "-", "1", ")", ")", "-", "1", ")", "/", "2", "\n", "net", ".", "conv5_1", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "512", ",", "pad", "=", "pad", ",", "kernel_size", "=", "kernel_size", ",", "dilation", "=", "dilation", ",", "**", "kwargs", ")", "\n", "net", ".", "relu5_1", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_1", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5_2", "=", "L", ".", "Convolution", "(", "net", ".", "relu5_1", ",", "num_output", "=", "512", ",", "pad", "=", "pad", ",", "kernel_size", "=", "kernel_size", ",", "dilation", "=", "dilation", ",", "**", "kwargs", ")", "\n", "net", ".", "relu5_2", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_2", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5_3", "=", "L", ".", "Convolution", "(", "net", ".", "relu5_2", ",", "num_output", "=", "512", ",", "pad", "=", "pad", ",", "kernel_size", "=", "kernel_size", ",", "dilation", "=", "dilation", ",", "**", "kwargs", ")", "\n", "net", ".", "relu5_3", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_3", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "need_fc", ":", "\n", "        ", "if", "dilated", ":", "\n", "            ", "if", "nopool", ":", "\n", "                ", "name", "=", "'conv5_4'", "\n", "net", "[", "name", "]", "=", "L", ".", "Convolution", "(", "net", ".", "relu5_3", ",", "num_output", "=", "512", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "                ", "name", "=", "'pool5'", "\n", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ")", "\n", "", "", "else", ":", "\n", "            ", "if", "nopool", ":", "\n", "                ", "name", "=", "'conv5_4'", "\n", "net", "[", "name", "]", "=", "L", ".", "Convolution", "(", "net", ".", "relu5_3", ",", "num_output", "=", "512", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "                ", "name", "=", "'pool5'", "\n", "net", "[", "name", "]", "=", "L", ".", "Pooling", "(", "net", ".", "relu5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "2", ",", "stride", "=", "2", ")", "\n", "\n", "", "", "if", "fully_conv", ":", "\n", "            ", "if", "dilated", ":", "\n", "                ", "if", "reduced", ":", "\n", "                    ", "dilation", "=", "dilation", "*", "6", "\n", "kernel_size", "=", "3", "\n", "num_output", "=", "1024", "\n", "", "else", ":", "\n", "                    ", "dilation", "=", "dilation", "*", "2", "\n", "kernel_size", "=", "7", "\n", "num_output", "=", "4096", "\n", "", "", "else", ":", "\n", "                ", "if", "reduced", ":", "\n", "                    ", "dilation", "=", "dilation", "*", "3", "\n", "kernel_size", "=", "3", "\n", "num_output", "=", "1024", "\n", "", "else", ":", "\n", "                    ", "kernel_size", "=", "7", "\n", "num_output", "=", "4096", "\n", "", "", "pad", "=", "int", "(", "(", "kernel_size", "+", "(", "dilation", "-", "1", ")", "*", "(", "kernel_size", "-", "1", ")", ")", "-", "1", ")", "/", "2", "\n", "net", ".", "fc6", "=", "L", ".", "Convolution", "(", "net", "[", "name", "]", ",", "num_output", "=", "num_output", ",", "pad", "=", "pad", ",", "kernel_size", "=", "kernel_size", ",", "dilation", "=", "dilation", ",", "**", "kwargs", ")", "\n", "\n", "net", ".", "relu6", "=", "L", ".", "ReLU", "(", "net", ".", "fc6", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop6", "=", "L", ".", "Dropout", "(", "net", ".", "relu6", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "\n", "", "if", "reduced", ":", "\n", "                ", "net", ".", "fc7", "=", "L", ".", "Convolution", "(", "net", ".", "relu6", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "fc7", "=", "L", ".", "Convolution", "(", "net", ".", "relu6", ",", "num_output", "=", "4096", ",", "kernel_size", "=", "1", ",", "**", "kwargs", ")", "\n", "", "net", ".", "relu7", "=", "L", ".", "ReLU", "(", "net", ".", "fc7", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop7", "=", "L", ".", "Dropout", "(", "net", ".", "relu7", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "", "", "else", ":", "\n", "            ", "net", ".", "fc6", "=", "L", ".", "InnerProduct", "(", "net", ".", "pool5", ",", "num_output", "=", "4096", ")", "\n", "net", ".", "relu6", "=", "L", ".", "ReLU", "(", "net", ".", "fc6", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop6", "=", "L", ".", "Dropout", "(", "net", ".", "relu6", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "", "net", ".", "fc7", "=", "L", ".", "InnerProduct", "(", "net", ".", "relu6", ",", "num_output", "=", "4096", ")", "\n", "net", ".", "relu7", "=", "L", ".", "ReLU", "(", "net", ".", "fc7", ",", "in_place", "=", "True", ")", "\n", "if", "dropout", ":", "\n", "                ", "net", ".", "drop7", "=", "L", ".", "Dropout", "(", "net", ".", "relu7", ",", "dropout_ratio", "=", "0.5", ",", "in_place", "=", "True", ")", "\n", "\n", "# Update freeze layers.", "\n", "", "", "", "kwargs", "[", "'param'", "]", "=", "[", "dict", "(", "lr_mult", "=", "0", ",", "decay_mult", "=", "0", ")", ",", "dict", "(", "lr_mult", "=", "0", ",", "decay_mult", "=", "0", ")", "]", "\n", "layers", "=", "net", ".", "keys", "(", ")", "\n", "for", "freeze_layer", "in", "freeze_layers", ":", "\n", "        ", "if", "freeze_layer", "in", "layers", ":", "\n", "            ", "net", ".", "update", "(", "freeze_layer", ",", "kwargs", ")", "\n", "\n", "", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.ResNet101Body": [[472, 521], ["model_libs_org.ConvBNLayer", "caffe.layers.Pooling", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "xrange", "model_libs_org.ResBody", "xrange", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "caffe.layers.Pooling"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody"], ["", "def", "ResNet101Body", "(", "net", ",", "from_layer", ",", "use_pool5", "=", "True", ",", "use_dilation_conv5", "=", "False", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn_'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale_'", "\n", "scale_postfix", "=", "''", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "conv1", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ResBody", "(", "net", ",", "'pool1'", ",", "'2a'", ",", "out2a", "=", "64", ",", "out2b", "=", "64", ",", "out2c", "=", "256", ",", "stride", "=", "1", ",", "use_branch1", "=", "True", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res2a'", ",", "'2b'", ",", "out2a", "=", "64", ",", "out2b", "=", "64", ",", "out2c", "=", "256", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res2b'", ",", "'2c'", ",", "out2a", "=", "64", ",", "out2b", "=", "64", ",", "out2c", "=", "256", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "\n", "ResBody", "(", "net", ",", "'res2c'", ",", "'3a'", ",", "out2a", "=", "128", ",", "out2b", "=", "128", ",", "out2c", "=", "512", ",", "stride", "=", "2", ",", "use_branch1", "=", "True", ",", "**", "bn_param", ")", "\n", "\n", "from_layer", "=", "'res3a'", "\n", "for", "i", "in", "xrange", "(", "1", ",", "4", ")", ":", "\n", "      ", "block_name", "=", "'3b{}'", ".", "format", "(", "i", ")", "\n", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", "=", "128", ",", "out2b", "=", "128", ",", "out2c", "=", "512", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "\n", "", "ResBody", "(", "net", ",", "from_layer", ",", "'4a'", ",", "out2a", "=", "256", ",", "out2b", "=", "256", ",", "out2c", "=", "1024", ",", "stride", "=", "2", ",", "use_branch1", "=", "True", ",", "**", "bn_param", ")", "\n", "\n", "from_layer", "=", "'res4a'", "\n", "for", "i", "in", "xrange", "(", "1", ",", "23", ")", ":", "\n", "      ", "block_name", "=", "'4b{}'", ".", "format", "(", "i", ")", "\n", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", "=", "256", ",", "out2b", "=", "256", ",", "out2c", "=", "1024", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "\n", "", "stride", "=", "2", "\n", "dilation", "=", "1", "\n", "if", "use_dilation_conv5", ":", "\n", "      ", "stride", "=", "1", "\n", "dilation", "=", "2", "\n", "\n", "", "ResBody", "(", "net", ",", "from_layer", ",", "'5a'", ",", "out2a", "=", "512", ",", "out2b", "=", "512", ",", "out2c", "=", "2048", ",", "stride", "=", "stride", ",", "use_branch1", "=", "True", ",", "dilation", "=", "dilation", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res5a'", ",", "'5b'", ",", "out2a", "=", "512", ",", "out2b", "=", "512", ",", "out2c", "=", "2048", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "dilation", "=", "dilation", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res5b'", ",", "'5c'", ",", "out2a", "=", "512", ",", "out2b", "=", "512", ",", "out2c", "=", "2048", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "dilation", "=", "dilation", ",", "**", "bn_param", ")", "\n", "\n", "if", "use_pool5", ":", "\n", "      ", "net", ".", "pool5", "=", "L", ".", "Pooling", "(", "net", ".", "res5c", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "global_pooling", "=", "True", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.ResNet152Body": [[523, 572], ["model_libs_org.ConvBNLayer", "caffe.layers.Pooling", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "xrange", "model_libs_org.ResBody", "xrange", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "model_libs_org.ResBody", "caffe.layers.Pooling"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody"], ["", "def", "ResNet152Body", "(", "net", ",", "from_layer", ",", "use_pool5", "=", "True", ",", "use_dilation_conv5", "=", "False", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn_'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale_'", "\n", "scale_postfix", "=", "''", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "conv1", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ResBody", "(", "net", ",", "'pool1'", ",", "'2a'", ",", "out2a", "=", "64", ",", "out2b", "=", "64", ",", "out2c", "=", "256", ",", "stride", "=", "1", ",", "use_branch1", "=", "True", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res2a'", ",", "'2b'", ",", "out2a", "=", "64", ",", "out2b", "=", "64", ",", "out2c", "=", "256", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res2b'", ",", "'2c'", ",", "out2a", "=", "64", ",", "out2b", "=", "64", ",", "out2c", "=", "256", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "\n", "ResBody", "(", "net", ",", "'res2c'", ",", "'3a'", ",", "out2a", "=", "128", ",", "out2b", "=", "128", ",", "out2c", "=", "512", ",", "stride", "=", "2", ",", "use_branch1", "=", "True", ",", "**", "bn_param", ")", "\n", "\n", "from_layer", "=", "'res3a'", "\n", "for", "i", "in", "xrange", "(", "1", ",", "8", ")", ":", "\n", "      ", "block_name", "=", "'3b{}'", ".", "format", "(", "i", ")", "\n", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", "=", "128", ",", "out2b", "=", "128", ",", "out2c", "=", "512", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "\n", "", "ResBody", "(", "net", ",", "from_layer", ",", "'4a'", ",", "out2a", "=", "256", ",", "out2b", "=", "256", ",", "out2c", "=", "1024", ",", "stride", "=", "2", ",", "use_branch1", "=", "True", ",", "**", "bn_param", ")", "\n", "\n", "from_layer", "=", "'res4a'", "\n", "for", "i", "in", "xrange", "(", "1", ",", "36", ")", ":", "\n", "      ", "block_name", "=", "'4b{}'", ".", "format", "(", "i", ")", "\n", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", "=", "256", ",", "out2b", "=", "256", ",", "out2c", "=", "1024", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "\n", "", "stride", "=", "2", "\n", "dilation", "=", "1", "\n", "if", "use_dilation_conv5", ":", "\n", "      ", "stride", "=", "1", "\n", "dilation", "=", "2", "\n", "\n", "", "ResBody", "(", "net", ",", "from_layer", ",", "'5a'", ",", "out2a", "=", "512", ",", "out2b", "=", "512", ",", "out2c", "=", "2048", ",", "stride", "=", "stride", ",", "use_branch1", "=", "True", ",", "dilation", "=", "dilation", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res5a'", ",", "'5b'", ",", "out2a", "=", "512", ",", "out2b", "=", "512", ",", "out2c", "=", "2048", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "dilation", "=", "dilation", ",", "**", "bn_param", ")", "\n", "ResBody", "(", "net", ",", "'res5b'", ",", "'5c'", ",", "out2a", "=", "512", ",", "out2b", "=", "512", ",", "out2c", "=", "2048", ",", "stride", "=", "1", ",", "use_branch1", "=", "False", ",", "dilation", "=", "dilation", ",", "**", "bn_param", ")", "\n", "\n", "if", "use_pool5", ":", "\n", "      ", "net", ".", "pool5", "=", "L", ".", "Pooling", "(", "net", ".", "res5c", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "global_pooling", "=", "True", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.InceptionV3Body": [[574, 812], ["model_libs_org.ConvBNLayer", "model_libs_org.ConvBNLayer", "model_libs_org.ConvBNLayer", "caffe.layers.Pooling", "model_libs_org.ConvBNLayer", "model_libs_org.ConvBNLayer", "caffe.layers.Pooling", "xrange", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "caffe.layers.Concat", "xrange", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "caffe.layers.Concat", "xrange", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "caffe.layers.Concat", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "towers.append", "caffe.layers.Concat", "model_libs_org.InceptionTower", "towers.append", "model_libs_org.InceptionTower", "model_libs_org.InceptionTower", "subtowers.append", "model_libs_org.InceptionTower", "subtowers.append", "caffe.layers.Concat", "towers.append", "model_libs_org.InceptionTower", "model_libs_org.InceptionTower", "subtowers.append", "model_libs_org.InceptionTower", "subtowers.append", "caffe.layers.Concat", "towers.append", "model_libs_org.InceptionTower", "towers.append", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.InnerProduct", "caffe.layers.Softmax", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower"], ["", "def", "InceptionV3Body", "(", "net", ",", "from_layer", ",", "output_pred", "=", "False", ",", "**", "bn_param", ")", ":", "\n", "# scale is fixed to 1, thus we ignore it.", "\n", "  ", "use_scale", "=", "False", "\n", "\n", "out_layer", "=", "'conv'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "32", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "use_scale", "=", "use_scale", ",", "\n", "**", "bn_param", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "out_layer", "=", "'conv_1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "32", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "**", "bn_param", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "out_layer", "=", "'conv_2'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "**", "bn_param", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "out_layer", "=", "'pool'", "\n", "net", "[", "out_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "\n", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "pad", "=", "0", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "out_layer", "=", "'conv_3'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "80", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "**", "bn_param", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "out_layer", "=", "'conv_4'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "**", "bn_param", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "out_layer", "=", "'pool_1'", "\n", "net", "[", "out_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "\n", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "pad", "=", "0", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "# inceptions with 1x1, 3x3, 5x5 convolutions", "\n", "for", "inception_id", "in", "xrange", "(", "0", ",", "3", ")", ":", "\n", "    ", "if", "inception_id", "==", "0", ":", "\n", "      ", "out_layer", "=", "'mixed'", "\n", "tower_2_conv_num_output", "=", "32", "\n", "", "else", ":", "\n", "      ", "out_layer", "=", "'mixed_{}'", ".", "format", "(", "inception_id", ")", "\n", "tower_2_conv_num_output", "=", "64", "\n", "", "towers", "=", "[", "]", "\n", "tower_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "48", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "64", ",", "kernel_size", "=", "5", ",", "pad", "=", "2", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower_1'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_2'", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower_2'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'pool'", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "tower_2_conv_num_output", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "out_layer", "=", "'{}/join'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "out_layer", "]", "=", "L", ".", "Concat", "(", "*", "towers", ",", "axis", "=", "1", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "# inceptions with 1x1, 3x3(in sequence) convolutions", "\n", "", "out_layer", "=", "'mixed_3'", "\n", "towers", "=", "[", "]", "\n", "tower_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "384", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "2", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_2'", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "2", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'pool'", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "2", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "out_layer", "=", "'{}/join'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "out_layer", "]", "=", "L", ".", "Concat", "(", "*", "towers", ",", "axis", "=", "1", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "# inceptions with 1x1, 7x1, 1x7 convolutions", "\n", "for", "inception_id", "in", "xrange", "(", "4", ",", "8", ")", ":", "\n", "    ", "if", "inception_id", "==", "4", ":", "\n", "      ", "num_output", "=", "128", "\n", "", "elif", "inception_id", "==", "5", "or", "inception_id", "==", "6", ":", "\n", "      ", "num_output", "=", "160", "\n", "", "elif", "inception_id", "==", "7", ":", "\n", "      ", "num_output", "=", "192", "\n", "", "out_layer", "=", "'mixed_{}'", ".", "format", "(", "inception_id", ")", "\n", "towers", "=", "[", "]", "\n", "tower_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "1", ",", "7", "]", ",", "pad", "=", "[", "0", ",", "3", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "dict", "(", "name", "=", "'conv_2'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "[", "7", ",", "1", "]", ",", "pad", "=", "[", "3", ",", "0", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower_1'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "7", ",", "1", "]", ",", "pad", "=", "[", "3", ",", "0", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "dict", "(", "name", "=", "'conv_2'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "1", ",", "7", "]", ",", "pad", "=", "[", "0", ",", "3", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "dict", "(", "name", "=", "'conv_3'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "7", ",", "1", "]", ",", "pad", "=", "[", "3", ",", "0", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "dict", "(", "name", "=", "'conv_4'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "[", "1", ",", "7", "]", ",", "pad", "=", "[", "0", ",", "3", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower_2'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'pool'", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "out_layer", "=", "'{}/join'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "out_layer", "]", "=", "L", ".", "Concat", "(", "*", "towers", ",", "axis", "=", "1", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "# inceptions with 1x1, 3x3, 1x7, 7x1 filters", "\n", "", "out_layer", "=", "'mixed_8'", "\n", "towers", "=", "[", "]", "\n", "tower_name", "=", "'{}/tower'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "320", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "2", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}/tower_1'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "[", "1", ",", "7", "]", ",", "pad", "=", "[", "0", ",", "3", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "dict", "(", "name", "=", "'conv_2'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "[", "7", ",", "1", "]", ",", "pad", "=", "[", "3", ",", "0", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "dict", "(", "name", "=", "'conv_3'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "2", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "tower_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'pool'", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "pad", "=", "0", ",", "stride", "=", "2", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "out_layer", "=", "'{}/join'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "out_layer", "]", "=", "L", ".", "Concat", "(", "*", "towers", ",", "axis", "=", "1", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "for", "inception_id", "in", "xrange", "(", "9", ",", "11", ")", ":", "\n", "    ", "num_output", "=", "384", "\n", "num_output2", "=", "448", "\n", "if", "inception_id", "==", "9", ":", "\n", "      ", "pool", "=", "P", ".", "Pooling", ".", "AVE", "\n", "", "else", ":", "\n", "      ", "pool", "=", "P", ".", "Pooling", ".", "MAX", "\n", "", "out_layer", "=", "'mixed_{}'", ".", "format", "(", "inception_id", ")", "\n", "towers", "=", "[", "]", "\n", "tower_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "320", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "\n", "tower_name", "=", "'{}/tower'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "subtowers", "=", "[", "]", "\n", "subtower_name", "=", "'{}/mixed'", ".", "format", "(", "tower_name", ")", "\n", "subtower", "=", "InceptionTower", "(", "net", ",", "'{}/conv'", ".", "format", "(", "tower_name", ")", ",", "subtower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "1", ",", "3", "]", ",", "pad", "=", "[", "0", ",", "1", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "subtowers", ".", "append", "(", "subtower", ")", "\n", "subtower", "=", "InceptionTower", "(", "net", ",", "'{}/conv'", ".", "format", "(", "tower_name", ")", ",", "subtower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "3", ",", "1", "]", ",", "pad", "=", "[", "1", ",", "0", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "subtowers", ".", "append", "(", "subtower", ")", "\n", "net", "[", "subtower_name", "]", "=", "L", ".", "Concat", "(", "*", "subtowers", ",", "axis", "=", "1", ")", "\n", "towers", ".", "append", "(", "net", "[", "subtower_name", "]", ")", "\n", "\n", "tower_name", "=", "'{}/tower_1'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "num_output2", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "subtowers", "=", "[", "]", "\n", "subtower_name", "=", "'{}/mixed'", ".", "format", "(", "tower_name", ")", "\n", "subtower", "=", "InceptionTower", "(", "net", ",", "'{}/conv_1'", ".", "format", "(", "tower_name", ")", ",", "subtower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "1", ",", "3", "]", ",", "pad", "=", "[", "0", ",", "1", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "subtowers", ".", "append", "(", "subtower", ")", "\n", "subtower", "=", "InceptionTower", "(", "net", ",", "'{}/conv_1'", ".", "format", "(", "tower_name", ")", ",", "subtower_name", ",", "[", "\n", "dict", "(", "name", "=", "'conv_1'", ",", "num_output", "=", "num_output", ",", "kernel_size", "=", "[", "3", ",", "1", "]", ",", "pad", "=", "[", "1", ",", "0", "]", ",", "stride", "=", "[", "1", ",", "1", "]", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "subtowers", ".", "append", "(", "subtower", ")", "\n", "net", "[", "subtower_name", "]", "=", "L", ".", "Concat", "(", "*", "subtowers", ",", "axis", "=", "1", ")", "\n", "towers", ".", "append", "(", "net", "[", "subtower_name", "]", ")", "\n", "\n", "tower_name", "=", "'{}/tower_2'", ".", "format", "(", "out_layer", ")", "\n", "tower", "=", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "[", "\n", "dict", "(", "name", "=", "'pool'", ",", "pool", "=", "pool", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "dict", "(", "name", "=", "'conv'", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", ",", "\n", "]", ",", "**", "bn_param", ")", "\n", "towers", ".", "append", "(", "tower", ")", "\n", "out_layer", "=", "'{}/join'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "out_layer", "]", "=", "L", ".", "Concat", "(", "*", "towers", ",", "axis", "=", "1", ")", "\n", "from_layer", "=", "out_layer", "\n", "\n", "", "if", "output_pred", ":", "\n", "    ", "net", ".", "pool_3", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "8", ",", "pad", "=", "0", ",", "stride", "=", "1", ")", "\n", "net", ".", "softmax", "=", "L", ".", "InnerProduct", "(", "net", ".", "pool_3", ",", "num_output", "=", "1008", ")", "\n", "net", ".", "softmax_prob", "=", "L", ".", "Softmax", "(", "net", ".", "softmax", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.CreateMultiBoxHead": [[813, 955], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_org.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_org.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_org.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_org.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_org.CreateRefineDetHead": [[958, 1168], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_org.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_org.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_org.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_org.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_org.ResBody", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_org.ResBody", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ResBody", "(", "net", ",", "from_layer", ",", "inter_name", ",", "out2a", "=", "256", ",", "out2b", "=", "256", ",", "out2c", "=", "1024", ",", "stride", "=", "1", ",", "use_branch1", "=", "True", ")", "\n", "# ConvBNLayer(net, from_layer, inter_name, use_bn=use_batchnorm, use_relu=True, lr_mult=lr_mult,", "\n", "#       num_output=inter_layer_depth[i], kernel_size=3, pad=1, stride=1, **bn_param)", "\n", "from_layer", "=", "\"res{}\"", ".", "format", "(", "inter_name", ")", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ResBody", "(", "net", ",", "from_layer", ",", "inter_name", ",", "out2a", "=", "256", ",", "out2b", "=", "256", ",", "out2c", "=", "1024", ",", "stride", "=", "1", ",", "use_branch1", "=", "True", ")", "\n", "# ConvBNLayer(net, from_layer, inter_name, use_bn=use_batchnorm, use_relu=True, lr_mult=lr_mult,", "\n", "#       num_output=inter_layer_depth[i], kernel_size=3, pad=1, stride=1, **bn_param)", "\n", "# from_layer = inter_name", "\n", "from_layer", "=", "\"res{}\"", ".", "format", "(", "inter_name", ")", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.MobileNetV1_COCO_320.AddExtraLayers": [[15, 84], ["DWConvBNLayer", "ConvBNLayer", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer2", "dict", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer2"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "# Last layer in body", "\n", "DWConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv7/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'7/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Seperate layer", "\n", "ConvBNLayer", "(", "net", ",", "'conv7/dw'", ",", "'conv7/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'7/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.ConvBNGroupLayer": [[31, 91], ["model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.ConvBNGroupLayer2": [[92, 152], ["model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.MergedConvGroupLayer": [[153, 213], ["model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.ConvBNLayer2": [[214, 274], ["model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "    ", "bn_name", "=", "'{}{}'", ".", "format", "(", "bn_prefix", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "#sb_name = '{}{}{}'.format(scale_prefix, out_layer, scale_postfix)", "\n", "      ", "sb_name", "=", "'{}{}'", ".", "format", "(", "scale_prefix", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_prefix", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.DeconvBNLayer2": [[275, 322], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "#deconv_name = '{}{}{}'.format(deconv_prefix, out_layer, deconv_postfix)", "\n", "", "deconv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(deconv_name)", "\n", "      ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.ConvBNLayer": [[323, 379], ["model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.DeconvBNLayer": [[380, 425], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.MergedDeconvLayer": [[426, 471], ["caffe.layers.Deconvolution", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "MergedDeconvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[deconv_name], in_place=True)", "\n", "      ", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.MergedConvLayer": [[472, 528], ["model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "model_libs_ResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.EltwiseLayer": [[530, 533], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.ResBody": [[535, 593], ["model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.InceptionTower": [[595, 608], ["caffe.layers.Pooling", "param.update", "model_libs_ResNeXt50.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.CreateAnnotatedDataLayer": [[609, 634], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.ResNeXt50Body": [[636, 863], ["model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Pooling", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNGroupLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "dict", "caffe.layers.Pooling", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResNeXt50Body", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "conv1", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'pool1'", ",", "'resx1_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx1_conv1'", ",", "'resx1_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx1_conv2'", ",", "'resx1_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'pool1'", ",", "'resx1_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx1_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx1_match_conv", ",", "net", ".", "resx1_conv3", ")", "\n", "net", ".", "resx1_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx1_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx1_elewise'", ",", "'resx2_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx2_conv1'", ",", "'resx2_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx2_conv2'", ",", "'resx2_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx2_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx1_elewise", ",", "net", ".", "resx2_conv3", ")", "\n", "net", ".", "resx2_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx2_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx2_elewise'", ",", "'resx3_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx3_conv1'", ",", "'resx3_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx3_conv2'", ",", "'resx3_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx3_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx2_elewise", ",", "net", ".", "resx3_conv3", ")", "\n", "net", ".", "resx3_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx3_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx3_elewise'", ",", "'resx4_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx4_conv1'", ",", "'resx4_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx4_conv2'", ",", "'resx4_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx3_elewise'", ",", "'resx4_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx4_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx4_match_conv", ",", "net", ".", "resx4_conv3", ")", "\n", "net", ".", "resx4_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx4_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx4_elewise'", ",", "'resx5_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx5_conv1'", ",", "'resx5_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx5_conv2'", ",", "'resx5_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx5_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx4_elewise", ",", "net", ".", "resx5_conv3", ")", "\n", "net", ".", "resx5_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx5_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx5_elewise'", ",", "'resx6_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx6_conv1'", ",", "'resx6_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx6_conv2'", ",", "'resx6_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx6_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx5_elewise", ",", "net", ".", "resx6_conv3", ")", "\n", "net", ".", "resx6_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx6_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx6_elewise'", ",", "'resx7_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx7_conv1'", ",", "'resx7_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx7_conv2'", ",", "'resx7_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx7_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx6_elewise", ",", "net", ".", "resx7_conv3", ")", "\n", "net", ".", "resx7_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx7_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx7_elewise'", ",", "'resx8_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx8_conv1'", ",", "'resx8_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx8_conv2'", ",", "'resx8_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx7_elewise'", ",", "'resx8_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx8_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx8_match_conv", ",", "net", ".", "resx8_conv3", ")", "\n", "net", ".", "resx8_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx8_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx8_elewise'", ",", "'resx9_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx9_conv1'", ",", "'resx9_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx9_conv2'", ",", "'resx9_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx9_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx8_elewise", ",", "net", ".", "resx9_conv3", ")", "\n", "net", ".", "resx9_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx9_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx9_elewise'", ",", "'resx10_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx10_conv1'", ",", "'resx10_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx10_conv2'", ",", "'resx10_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx10_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx9_elewise", ",", "net", ".", "resx10_conv3", ")", "\n", "net", ".", "resx10_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx10_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx10_elewise'", ",", "'resx11_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx11_conv1'", ",", "'resx11_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx11_conv2'", ",", "'resx11_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx11_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx10_elewise", ",", "net", ".", "resx11_conv3", ")", "\n", "net", ".", "resx11_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx11_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx11_elewise'", ",", "'resx12_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx12_conv1'", ",", "'resx12_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx12_conv2'", ",", "'resx12_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx12_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx11_elewise", ",", "net", ".", "resx12_conv3", ")", "\n", "net", ".", "resx12_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx12_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx12_elewise'", ",", "'resx13_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx13_conv1'", ",", "'resx13_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx13_conv2'", ",", "'resx13_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx13_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx12_elewise", ",", "net", ".", "resx13_conv3", ")", "\n", "net", ".", "resx13_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx13_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx13_elewise'", ",", "'resx14_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx14_conv1'", ",", "'resx14_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx14_conv2'", ",", "'resx14_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx13_elewise'", ",", "'resx14_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx14_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx14_match_conv", ",", "net", ".", "resx14_conv3", ")", "\n", "net", ".", "resx14_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx14_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx14_elewise'", ",", "'resx15_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx15_conv1'", ",", "'resx15_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx15_conv2'", ",", "'resx15_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx15_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx14_elewise", ",", "net", ".", "resx15_conv3", ")", "\n", "net", ".", "resx15_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx15_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx15_elewise'", ",", "'resx16_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx16_conv1'", ",", "'resx16_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx16_conv2'", ",", "'resx16_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx16_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx15_elewise", ",", "net", ".", "resx16_conv3", ")", "\n", "net", ".", "resx16_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx16_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "7", ",", "stride", "=", "1", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.CreateMultiBoxHead": [[864, 1006], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_ResNeXt50.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt50.CreateRefineDetHead": [[1009, 1598], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "model_libs_ResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "# ResNet101 Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# ResBody(net, from_layer, inter_name, out2a=256, out2b=256, out2c=1024, stride=1, use_branch1=True)", "\n", "# # ConvBNLayer(net, from_layer, inter_name, use_bn=use_batchnorm, use_relu=True, lr_mult=lr_mult,", "\n", "# #       num_output=inter_layer_depth[i], kernel_size=3, pad=1, stride=1, **bn_param)", "\n", "# from_layer = \"res{}\".format(inter_name)", "\n", "\n", "# ResNet18 Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inter_branch1", "=", "inter_name", "+", "\"_branch1\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2a", "=", "inter_name", "+", "\"_branch2a\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch2a", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2b", "=", "inter_name", "+", "\"_branch2b\"", "\n", "ConvBNLayer", "(", "net", ",", "inter_branch2a", ",", "inter_branch2b", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_eltwise", "=", "inter_name", "+", "\"_eltwise\"", "\n", "net", "[", "inter_eltwise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "inter_branch1", "]", ",", "net", "[", "inter_branch2b", "]", ")", "\n", "inter_eltwise_relu", "=", "inter_name", "+", "\"_eltwise_relu\"", "\n", "net", "[", "inter_eltwise_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_eltwise", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "inter_eltwise", "\n", "\n", "# ResNeXt Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# resx_inter_conv1 = inter_name + '_conv1'", "\n", "# ConvBNLayer(net, from_layer, resx_inter_conv1, use_bn=True, use_relu=True, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv2 = inter_name + '_conv2'", "\n", "# ConvBNGroupLayer(net, resx_inter_conv1, resx_inter_conv2, use_bn=True, use_relu=True, num_output=256, kernel_size=3, pad=1, stride=1, group=32,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv3 = inter_name + '_conv3'", "\n", "# ConvBNLayer(net, resx_inter_conv2, resx_inter_conv3, use_bn=True, use_relu=False, num_output=1024, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_match = inter_name + '_match'", "\n", "# ConvBNLayer(net, from_layer, resx_inter_match, use_bn=True, use_relu=False, num_output=1024, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_elewise = inter_name + '_elewise'", "\n", "# net[resx_inter_elewise] = L.Eltwise(net[resx_inter_match], net[resx_inter_conv3])", "\n", "# resx_inter_relu = inter_name + '_elewise_relu'", "\n", "# net[resx_inter_relu] = L.ReLU(net[resx_inter_elewise], in_place=True)", "\n", "# from_layer = resx_inter_elewise", "\n", "\n", "# ResNeXtMerged Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# resx_inter_conv1 = inter_name + '_conv1'", "\n", "# MergedConvLayer(net, from_layer, resx_inter_conv1, use_bn=True, use_relu=True, num_output=128, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv2 = inter_name + '_conv2'", "\n", "# MergedConvGroupLayer(net, resx_inter_conv1, resx_inter_conv2, use_bn=True, use_relu=True, num_output=128, kernel_size=3, pad=1, stride=1, group=32,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv3 = inter_name + '_conv3'", "\n", "# MergedConvLayer(net, resx_inter_conv2, resx_inter_conv3, use_bn=True, use_relu=False, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_match = inter_name + '_match'", "\n", "# MergedConvLayer(net, from_layer, resx_inter_match, use_bn=True, use_relu=False, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_elewise = inter_name + '_elewise'", "\n", "# net[resx_inter_elewise] = L.Eltwise(net[resx_inter_match], net[resx_inter_conv3])", "\n", "# resx_inter_relu = inter_name + '_elewise_relu'", "\n", "# net[resx_inter_relu] = L.ReLU(net[resx_inter_elewise], in_place=True)", "\n", "# from_layer = resx_inter_elewise", "\n", "\n", "# Xception Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# inter_match = inter_name + '_match'", "\n", "# ConvBNLayer(net, from_layer, inter_match, use_bn=True, use_relu=False, num_output=364, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_relu = inter_name + '_relu'", "\n", "# net[inter_relu] = L.ReLU(net[from_layer])", "\n", "# inter_conv1_1 = inter_name + '_conv1_1'", "\n", "# net[inter_conv1_1] = L.ConvolutionDepthwise(net[inter_relu],", "\n", "#     convolution_param = dict(num_output=364, group=364, pad=1, kernel_size=3, stride=1, bias_term=False, ", "\n", "#     weight_filler = dict(type='gaussian', std=0.01)), param=[dict(lr_mult=1, decay_mult=1)])", "\n", "# inter_conv1_2 = inter_name + '_conv1_2'", "\n", "# ConvBNLayer(net, inter_conv1_1, inter_conv1_2, use_bn=True, use_relu=True, num_output=364, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_conv2_1 = inter_name + '_conv2_1'", "\n", "# net[inter_conv2_1] = L.ConvolutionDepthwise(net[inter_conv1_2],", "\n", "#     convolution_param = dict(num_output=364, group=364, pad=1, kernel_size=3, stride=1, bias_term=False, ", "\n", "#     weight_filler = dict(type='gaussian', std=0.01)), param=[dict(lr_mult=1, decay_mult=1)])", "\n", "# inter_conv2_2 = inter_name + '_conv2_2'", "\n", "# ConvBNLayer(net, inter_conv2_1, inter_conv2_2, use_bn=True, use_relu=False, num_output=364, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)                                ", "\n", "# inter_elewise = inter_name + '_elewise'", "\n", "# net[inter_elewise] = L.Eltwise(net[inter_match], net[inter_conv2_2])", "\n", "# from_layer = inter_elewise", "\n", "\n", "# SENeXt50 Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)                ", "\n", "# inter_1x1_reduce = inter_name + '_1x1_reduce'", "\n", "# ConvBNLayer(net, from_layer, inter_1x1_reduce, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_3x3 = inter_name + '_3x3'", "\n", "# ConvBNGroupLayer(net, inter_1x1_reduce, inter_3x3, use_bn=True, use_relu=True, num_output=64, kernel_size=3, pad=1, stride=1, group=32,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_1x1_increase = inter_name + '_1x1_increase'", "\n", "# ConvBNLayer(net, inter_3x3, inter_1x1_increase, use_bn=True, use_relu=False, num_output=128, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)                ", "\n", "# inter_global_pool = inter_name + '_global_pool'", "\n", "# net[inter_global_pool] = L.Pooling(net[inter_1x1_increase], pool=P.Pooling.AVE, engine=P.Pooling.CAFFE, global_pooling=True)                ", "\n", "# inter_1x1_down = inter_name + '_1x1_down'", "\n", "# net[inter_1x1_down] = L.Convolution(net[inter_global_pool], num_output=8, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inter_1x1_down_relu = inter_name + '_1x1_down/relu'", "\n", "# net[inter_1x1_down_relu] = L.ReLU(net[inter_1x1_down], in_place=True)                ", "\n", "# inter_1x1_up = inter_name + '_1x1_up'", "\n", "# net[inter_1x1_up] = L.Convolution(net[inter_1x1_down], num_output=128, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inter_prob = inter_name + '_prob'", "\n", "# net[inter_prob] = L.Sigmoid(net[inter_1x1_up], in_place=True)                ", "\n", "# inter_1x1_proj = inter_name + '_1x1_proj'", "\n", "# ConvBNLayer(net, from_layer, inter_1x1_proj, use_bn=True, use_relu=False, num_output=128, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_axpy = inter_name + '_axpy'", "\n", "# net[inter_axpy] = L.Axpy(net[inter_1x1_up], net[inter_1x1_increase], net[inter_1x1_proj])", "\n", "# inter_relu = inter_name + '/relu'", "\n", "# net[inter_relu] = L.ReLU(net[inter_axpy], in_place=True)", "\n", "# from_layer = inter_axpy", "\n", "\n", "# SEBNInception Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# inception1 = inter_name + '_1x1'", "\n", "# ConvBNLayer2(net, from_layer, inception1, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_1x1', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception2_1 = inter_name + '_3x3_reduce'", "\n", "# ConvBNLayer2(net, from_layer, inception2_1, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_3x3_reduce', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception2_2 = inter_name + '_3x3'", "\n", "# ConvBNLayer2(net, inception2_1, inception2_2, use_bn=True, use_relu=True, num_output=64, kernel_size=3, pad=1, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_3x3', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception3_1 = inter_name + '_double3_3_reduce'", "\n", "# ConvBNLayer2(net, from_layer, inception3_1, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_double3x3_reduce', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception3_2 = inter_name + '_double3_3a'", "\n", "# ConvBNLayer2(net, inception3_1, inception3_2, use_bn=True, use_relu=True, num_output=96, kernel_size=3, pad=1, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_double3x3a', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception3_3 = inter_name + '_double3_3b'", "\n", "# ConvBNLayer2(net, inception3_2, inception3_3, use_bn=True, use_relu=True, num_output=96, kernel_size=3, pad=1, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_double3x3b', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception_pool = inter_name + '_pool'", "\n", "# net[inception_pool] = L.Pooling(net[from_layer], pool=P.Pooling.AVE, kernel_size=3, pad=1, stride=1)", "\n", "# inception4 = inter_name + '_pool_proj'", "\n", "# ConvBNLayer2(net, inception_pool, inception4, use_bn=True, use_relu=True, num_output=32, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_pool_proj', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# concat_layer = inter_name + '_concat'", "\n", "# net[concat_layer] = L.Concat(net[inception1], net[inception2_2], net[inception3_3], net[inception4])                ", "\n", "# inception_global_pool = inter_name + '_global_pool'", "\n", "# net[inception_global_pool] = L.Pooling(net[concat_layer], pool=P.Pooling.AVE, engine=P.Pooling.CAFFE, global_pooling=True)                ", "\n", "# inception_down = inter_name + '_1x1_down'", "\n", "# net[inception_down] = L.Convolution(net[inception_global_pool], num_output=16, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inception_down_relu = inter_name + '_1x1_down_relu'", "\n", "# net[inception_down_relu] = L.ReLU(net[inception_down], in_place=True)", "\n", "# inception_up = inter_name + '_1x1_up'", "\n", "# net[inception_up] = L.Convolution(net[inception_down], num_output=256, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inception_prob = inter_name + '_prob'", "\n", "# net[inception_prob] = L.Sigmoid(net[inception_up], in_place=True)", "\n", "# inception_prob_reshape = inter_name + '_prob_reshape'", "\n", "# net[inception_prob_reshape] = L.Reshape(net[inception_up], reshape_param={'shape':{'dim': [0,0]}})", "\n", "# inception_scale = inter_name + '_scale'", "\n", "# net[inception_scale] = L.Scale(net[concat_layer], net[inception_prob_reshape], **kwargs_sb)", "\n", "# from_layer = inception_scale", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "# ResNet101 Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# ResBody(net, from_layer, inter_name, out2a=256, out2b=256, out2c=1024, stride=1, use_branch1=True)", "\n", "# # ConvBNLayer(net, from_layer, inter_name, use_bn=use_batchnorm, use_relu=True, lr_mult=lr_mult,", "\n", "# #       num_output=inter_layer_depth[i], kernel_size=3, pad=1, stride=1, **bn_param)", "\n", "# from_layer = \"res{}\".format(inter_name)", "\n", "\n", "# ResNet18 Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inter_branch1", "=", "inter_name", "+", "\"_branch1\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2a", "=", "inter_name", "+", "\"_branch2a\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch2a", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2b", "=", "inter_name", "+", "\"_branch2b\"", "\n", "ConvBNLayer", "(", "net", ",", "inter_branch2a", ",", "inter_branch2b", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_eltwise", "=", "inter_name", "+", "\"_eltwise\"", "\n", "net", "[", "inter_eltwise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "inter_branch1", "]", ",", "net", "[", "inter_branch2b", "]", ")", "\n", "inter_eltwise_relu", "=", "inter_name", "+", "\"_eltwise_relu\"", "\n", "net", "[", "inter_eltwise_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_eltwise", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "inter_eltwise", "\n", "\n", "# ResNeXt Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# resx_inter_conv1 = inter_name + '_conv1'", "\n", "# ConvBNLayer(net, from_layer, resx_inter_conv1, use_bn=True, use_relu=True, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv2 = inter_name + '_conv2'", "\n", "# ConvBNGroupLayer(net, resx_inter_conv1, resx_inter_conv2, use_bn=True, use_relu=True, num_output=256, kernel_size=3, pad=1, stride=1, group=32,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv3 = inter_name + '_conv3'", "\n", "# ConvBNLayer(net, resx_inter_conv2, resx_inter_conv3, use_bn=True, use_relu=False, num_output=1024, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_match = inter_name + '_match'", "\n", "# ConvBNLayer(net, from_layer, resx_inter_match, use_bn=True, use_relu=False, num_output=1024, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_elewise = inter_name + '_elewise'", "\n", "# net[resx_inter_elewise] = L.Eltwise(net[resx_inter_match], net[resx_inter_conv3])", "\n", "# resx_inter_relu = inter_name + '_elewise_relu'", "\n", "# net[resx_inter_relu] = L.ReLU(net[resx_inter_elewise], in_place=True)", "\n", "# from_layer = resx_inter_elewise", "\n", "\n", "# ResNeXtMerged Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# resx_inter_conv1 = inter_name + '_conv1'", "\n", "# MergedConvLayer(net, from_layer, resx_inter_conv1, use_bn=True, use_relu=True, num_output=128, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv2 = inter_name + '_conv2'", "\n", "# MergedConvGroupLayer(net, resx_inter_conv1, resx_inter_conv2, use_bn=True, use_relu=True, num_output=128, kernel_size=3, pad=1, stride=1, group=32,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv3 = inter_name + '_conv3'", "\n", "# MergedConvLayer(net, resx_inter_conv2, resx_inter_conv3, use_bn=True, use_relu=False, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_match = inter_name + '_match'", "\n", "# MergedConvLayer(net, from_layer, resx_inter_match, use_bn=True, use_relu=False, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_elewise = inter_name + '_elewise'", "\n", "# net[resx_inter_elewise] = L.Eltwise(net[resx_inter_match], net[resx_inter_conv3])", "\n", "# resx_inter_relu = inter_name + '_elewise_relu'", "\n", "# net[resx_inter_relu] = L.ReLU(net[resx_inter_elewise], in_place=True)", "\n", "# from_layer = resx_inter_elewise", "\n", "\n", "# Xception Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# inter_match = inter_name + '_match'", "\n", "# ConvBNLayer(net, from_layer, inter_match, use_bn=True, use_relu=False, num_output=364, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_relu = inter_name + '_relu'", "\n", "# net[inter_relu] = L.ReLU(net[from_layer])", "\n", "# inter_conv1_1 = inter_name + '_conv1_1'", "\n", "# net[inter_conv1_1] = L.ConvolutionDepthwise(net[inter_relu],", "\n", "#     convolution_param = dict(num_output=364, group=364, pad=1, kernel_size=3, stride=1, bias_term=False, ", "\n", "#     weight_filler = dict(type='gaussian', std=0.01)), param=[dict(lr_mult=1, decay_mult=1)])", "\n", "# inter_conv1_2 = inter_name + '_conv1_2'", "\n", "# ConvBNLayer(net, inter_conv1_1, inter_conv1_2, use_bn=True, use_relu=True, num_output=728, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_conv2_1 = inter_name + '_conv2_1'", "\n", "# net[inter_conv2_1] = L.ConvolutionDepthwise(net[inter_conv1_2],", "\n", "#     convolution_param = dict(num_output=364, group=364, pad=1, kernel_size=3, stride=1, bias_term=False, ", "\n", "#     weight_filler = dict(type='gaussian', std=0.01)), param=[dict(lr_mult=1, decay_mult=1)])", "\n", "# inter_conv2_2 = inter_name + '_conv2_2'", "\n", "# ConvBNLayer(net, inter_conv2_1, inter_conv2_2, use_bn=True, use_relu=False, num_output=364, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)                                ", "\n", "# inter_elewise = inter_name + '_elewise'", "\n", "# net[inter_elewise] = L.Eltwise(net[inter_match], net[inter_conv2_2])", "\n", "# from_layer = inter_elewise", "\n", "\n", "#SEResNexX50 Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)                ", "\n", "# inter_1x1_reduce = inter_name + '_1x1_reduce'", "\n", "# ConvBNLayer(net, from_layer, inter_1x1_reduce, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_3x3 = inter_name + '_3x3'", "\n", "# ConvBNGroupLayer(net, inter_1x1_reduce, inter_3x3, use_bn=True, use_relu=True, num_output=64, kernel_size=3, pad=1, stride=1, group=32,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_1x1_increase = inter_name + '_1x1_increase'", "\n", "# ConvBNLayer(net, inter_3x3, inter_1x1_increase, use_bn=True, use_relu=False, num_output=128, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)                ", "\n", "# inter_global_pool = inter_name + '_global_pool'", "\n", "# net[inter_global_pool] = L.Pooling(net[inter_1x1_increase], pool=P.Pooling.AVE, engine=P.Pooling.CAFFE, global_pooling=True)                ", "\n", "# inter_1x1_down = inter_name + '_1x1_down'", "\n", "# net[inter_1x1_down] = L.Convolution(net[inter_global_pool], num_output=8, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inter_1x1_down_relu = inter_name + '_1x1_down/relu'", "\n", "# net[inter_1x1_down_relu] = L.ReLU(net[inter_1x1_down], in_place=True)                ", "\n", "# inter_1x1_up = inter_name + '_1x1_up'", "\n", "# net[inter_1x1_up] = L.Convolution(net[inter_1x1_down], num_output=128, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inter_prob = inter_name + '_prob'", "\n", "# net[inter_prob] = L.Sigmoid(net[inter_1x1_up], in_place=True)                ", "\n", "# inter_1x1_proj = inter_name + '_1x1_proj'", "\n", "# ConvBNLayer(net, from_layer, inter_1x1_proj, use_bn=True, use_relu=False, num_output=128, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inter_axpy = inter_name + '_axpy'", "\n", "# net[inter_axpy] = L.Axpy(net[inter_1x1_up], net[inter_1x1_increase], net[inter_1x1_proj])", "\n", "# inter_relu = inter_name + '/relu'", "\n", "# net[inter_relu] = L.ReLU(net[inter_axpy], in_place=True)", "\n", "# from_layer = inter_axpy", "\n", "\n", "# SEBNInception Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# inception1 = inter_name + '_1x1'", "\n", "# ConvBNLayer2(net, from_layer, inception1, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_1x1', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception2_1 = inter_name + '_3x3_reduce'", "\n", "# ConvBNLayer2(net, from_layer, inception2_1, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_3x3_reduce', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception2_2 = inter_name + '_3x3'", "\n", "# ConvBNLayer2(net, inception2_1, inception2_2, use_bn=True, use_relu=True, num_output=64, kernel_size=3, pad=1, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_3x3', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception3_1 = inter_name + '_double3_3_reduce'", "\n", "# ConvBNLayer2(net, from_layer, inception3_1, use_bn=True, use_relu=True, num_output=64, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_double3x3_reduce', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception3_2 = inter_name + '_double3_3a'", "\n", "# ConvBNLayer2(net, inception3_1, inception3_2, use_bn=True, use_relu=True, num_output=96, kernel_size=3, pad=1, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_double3x3a', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception3_3 = inter_name + '_double3_3b'", "\n", "# ConvBNLayer2(net, inception3_2, inception3_3, use_bn=True, use_relu=True, num_output=96, kernel_size=3, pad=1, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_double3x3b', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# inception_pool = inter_name + '_pool'", "\n", "# net[inception_pool] = L.Pooling(net[from_layer], pool=P.Pooling.AVE, kernel_size=3, pad=1, stride=1)", "\n", "# inception4 = inter_name + '_pool_proj'", "\n", "# ConvBNLayer2(net, inception_pool, inception4, use_bn=True, use_relu=True, num_output=32, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=inter_name, conv_postfix='_pool_proj', bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# concat_layer = inter_name + '_concat'", "\n", "# net[concat_layer] = L.Concat(net[inception1], net[inception2_2], net[inception3_3], net[inception4])                ", "\n", "# inception_global_pool = inter_name + '_global_pool'", "\n", "# net[inception_global_pool] = L.Pooling(net[concat_layer], pool=P.Pooling.AVE, engine=P.Pooling.CAFFE, global_pooling=True)                ", "\n", "# inception_down = inter_name + '_1x1_down'", "\n", "# net[inception_down] = L.Convolution(net[inception_global_pool], num_output=16, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inception_down_relu = inter_name + '_1x1_down_relu'", "\n", "# net[inception_down_relu] = L.ReLU(net[inception_down], in_place=True)", "\n", "# inception_up = inter_name + '_1x1_up'", "\n", "# net[inception_up] = L.Convolution(net[inception_down], num_output=256, kernel_size=1, stride=1, **kwargs2)                ", "\n", "# inception_prob = inter_name + '_prob'", "\n", "# net[inception_prob] = L.Sigmoid(net[inception_up], in_place=True)", "\n", "# inception_prob_reshape = inter_name + '_prob_reshape'", "\n", "# net[inception_prob_reshape] = L.Reshape(net[inception_up], reshape_param={'shape':{'dim': [0,0]}})", "\n", "# inception_scale = inter_name + '_scale'", "\n", "# net[inception_scale] = L.Scale(net[concat_layer], net[inception_prob_reshape], **kwargs_sb)", "\n", "# from_layer = inception_scale", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.ConvBNGroupLayer": [[31, 91], ["model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.ConvBNGroupLayer2": [[92, 152], ["model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.MergedConvGroupLayer": [[153, 213], ["model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.ConvBNLayer2": [[214, 274], ["model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "#bn_name = '{}{}'.format(bn_prefix, bn_postfix)", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "#sb_name = '{}{}'.format(scale_prefix, scale_postfix)", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_prefix)    ", "\n", "    ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.DeconvBNLayer2": [[275, 322], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "#deconv_name = '{}{}{}'.format(deconv_prefix, out_layer, deconv_postfix)", "\n", "", "deconv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(deconv_name)", "\n", "      ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.ConvBNLayer": [[323, 379], ["model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.DeconvBNLayer": [[380, 425], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.MergedDeconvLayer": [[426, 471], ["caffe.layers.Deconvolution", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "MergedDeconvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[deconv_name], in_place=True)", "\n", "      ", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.MergedConvLayer": [[472, 528], ["model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "model_libs_SEResNeXt50.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.EltwiseLayer": [[530, 533], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.ResBody": [[535, 593], ["model_libs_SEResNeXt50.ConvBNLayer", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer", "model_libs_SEResNeXt50.ConvBNLayer", "model_libs_SEResNeXt50.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.InceptionTower": [[595, 608], ["caffe.layers.Pooling", "param.update", "model_libs_SEResNeXt50.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.CreateAnnotatedDataLayer": [[609, 634], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.SEResNeXt50Body": [[635, 948], ["model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "model_libs_SEResNeXt50.ConvBNLayer2", "model_libs_SEResNeXt50.ConvBNGroupLayer2", "model_libs_SEResNeXt50.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Axpy", "caffe.layers.ReLU", "dict", "dict", "caffe.layers.Pooling", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2"], ["", "def", "SEResNeXt50Body", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/bn/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "'conv1/7x7_s2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'conv1'", ",", "conv_postfix", "=", "'_7x7_s2'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", "[", "'pool1/3x3_s2'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'conv1/7x7_s2'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'pool1/3x3_s2'", ",", "'conv2_1_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv2_1_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv2_1_1x1_reduce'", ",", "'conv2_1_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv2_1_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2_1_3x3'", ",", "'conv2_1_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv2_1_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv2_1_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv2_1_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv2_1_global_pool", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv2_1_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_1_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv2_1_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv2_1_1x1_down", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv2_1_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv2_1_1x1_up", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'pool1/3x3_s2'", ",", "'conv2_1_1x1_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv2_1", "=", "L", ".", "Axpy", "(", "net", ".", "conv2_1_1x1_up", ",", "net", ".", "conv2_1_1x1_increase", ",", "net", ".", "conv2_1_1x1_proj", ")", "\n", "net", "[", "'conv2_1/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_1", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2_1'", ",", "'conv2_2_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv2_2_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv2_2_1x1_reduce'", ",", "'conv2_2_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv2_2_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2_2_3x3'", ",", "'conv2_2_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv2_2_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv2_2_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv2_2_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv2_2_global_pool", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv2_2_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_2_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv2_2_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv2_2_1x1_down", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv2_2_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv2_2_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv2_2", "=", "L", ".", "Axpy", "(", "net", ".", "conv2_2_1x1_up", ",", "net", ".", "conv2_2_1x1_increase", ",", "net", ".", "conv2_1", ")", "\n", "net", "[", "'conv2_2/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_2", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2_2'", ",", "'conv2_3_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv2_3_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv2_3_1x1_reduce'", ",", "'conv2_3_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv2_3_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2_3_3x3'", ",", "'conv2_3_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv2_3_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv2_3_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv2_3_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv2_3_global_pool", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv2_3_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_3_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv2_3_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv2_3_1x1_down", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv2_3_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv2_3_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv2_3", "=", "L", ".", "Axpy", "(", "net", ".", "conv2_3_1x1_up", ",", "net", ".", "conv2_3_1x1_increase", ",", "net", ".", "conv2_2", ")", "\n", "net", "[", "'conv2_3/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv2_3", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2_3'", ",", "'conv3_1_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv3_1_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv3_1_1x1_reduce'", ",", "'conv3_1_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv3_1_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_1_3x3'", ",", "'conv3_1_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv3_1_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv3_1_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv3_1_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_1_global_pool", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv3_1_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_1_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_1_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_1_1x1_down", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv3_1_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv3_1_1x1_up", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2_3'", ",", "'conv3_1_1x1_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv3_1", "=", "L", ".", "Axpy", "(", "net", ".", "conv3_1_1x1_up", ",", "net", ".", "conv3_1_1x1_increase", ",", "net", ".", "conv3_1_1x1_proj", ")", "\n", "net", "[", "'conv3_1/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_1", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_1'", ",", "'conv3_2_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv3_2_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv3_2_1x1_reduce'", ",", "'conv3_2_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv3_2_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_2_3x3'", ",", "'conv3_2_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv3_2_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv3_2_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv3_2_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_2_global_pool", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv3_2_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_2_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_2_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_2_1x1_down", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv3_2_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv3_2_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_2", "=", "L", ".", "Axpy", "(", "net", ".", "conv3_2_1x1_up", ",", "net", ".", "conv3_2_1x1_increase", ",", "net", ".", "conv3_1", ")", "\n", "net", "[", "'conv3_2/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_2", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_2'", ",", "'conv3_3_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv3_3_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv3_3_1x1_reduce'", ",", "'conv3_3_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv3_3_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_3_3x3'", ",", "'conv3_3_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv3_3_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv3_3_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv3_3_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_3_global_pool", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv3_3_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_3_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_3_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_3_1x1_down", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv3_3_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv3_3_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_3", "=", "L", ".", "Axpy", "(", "net", ".", "conv3_3_1x1_up", ",", "net", ".", "conv3_3_1x1_increase", ",", "net", ".", "conv3_2", ")", "\n", "net", "[", "'conv3_3/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_3", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_3'", ",", "'conv3_4_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv3_4_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv3_4_1x1_reduce'", ",", "'conv3_4_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv3_4_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_4_3x3'", ",", "'conv3_4_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv3_4_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv3_4_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv3_4_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_4_global_pool", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv3_4_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_4_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_4_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv3_4_1x1_down", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv3_4_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv3_4_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv3_4", "=", "L", ".", "Axpy", "(", "net", ".", "conv3_4_1x1_up", ",", "net", ".", "conv3_4_1x1_increase", ",", "net", ".", "conv3_3", ")", "\n", "net", "[", "'conv3_4/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv3_4", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_4'", ",", "'conv4_1_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv4_1_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv4_1_1x1_reduce'", ",", "'conv4_1_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv4_1_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_1_3x3'", ",", "'conv4_1_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv4_1_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv4_1_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv4_1_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_1_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv4_1_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_1_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_1_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_1_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv4_1_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv4_1_1x1_up", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_4'", ",", "'conv4_1_1x1_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv4_1", "=", "L", ".", "Axpy", "(", "net", ".", "conv4_1_1x1_up", ",", "net", ".", "conv4_1_1x1_increase", ",", "net", ".", "conv4_1_1x1_proj", ")", "\n", "net", "[", "'conv4_1/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_1", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_1'", ",", "'conv4_2_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv4_2_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv4_2_1x1_reduce'", ",", "'conv4_2_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv4_2_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_2_3x3'", ",", "'conv4_2_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv4_2_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv4_2_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv4_2_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_2_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv4_2_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_2_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_2_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_2_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv4_2_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv4_2_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_2", "=", "L", ".", "Axpy", "(", "net", ".", "conv4_2_1x1_up", ",", "net", ".", "conv4_2_1x1_increase", ",", "net", ".", "conv4_1", ")", "\n", "net", "[", "'conv4_2/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_2", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_2'", ",", "'conv4_3_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv4_3_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv4_3_1x1_reduce'", ",", "'conv4_3_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv4_3_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_3_3x3'", ",", "'conv4_3_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv4_3_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv4_3_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv4_3_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_3_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv4_3_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_3_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_3_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_3_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv4_3_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv4_3_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_3", "=", "L", ".", "Axpy", "(", "net", ".", "conv4_3_1x1_up", ",", "net", ".", "conv4_3_1x1_increase", ",", "net", ".", "conv4_2", ")", "\n", "net", "[", "'conv4_3/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_3", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_3'", ",", "'conv4_4_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv4_4_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv4_4_1x1_reduce'", ",", "'conv4_4_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv4_4_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_4_3x3'", ",", "'conv4_4_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv4_4_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv4_4_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv4_4_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_4_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv4_4_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_4_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_4_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_4_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv4_4_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv4_4_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_4", "=", "L", ".", "Axpy", "(", "net", ".", "conv4_4_1x1_up", ",", "net", ".", "conv4_4_1x1_increase", ",", "net", ".", "conv4_3", ")", "\n", "net", "[", "'conv4_4/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_4", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_4'", ",", "'conv4_5_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv4_5_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv4_5_1x1_reduce'", ",", "'conv4_5_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv4_5_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_5_3x3'", ",", "'conv4_5_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv4_5_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv4_5_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv4_5_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_5_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv4_5_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_5_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_5_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_5_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv4_5_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv4_5_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_5", "=", "L", ".", "Axpy", "(", "net", ".", "conv4_5_1x1_up", ",", "net", ".", "conv4_5_1x1_increase", ",", "net", ".", "conv4_4", ")", "\n", "net", "[", "'conv4_5/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_5", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_5'", ",", "'conv4_6_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv4_6_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv4_6_1x1_reduce'", ",", "'conv4_6_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv4_6_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_6_3x3'", ",", "'conv4_6_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv4_6_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv4_6_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv4_6_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_6_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv4_6_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_6_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_6_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv4_6_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv4_6_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv4_6_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv4_6", "=", "L", ".", "Axpy", "(", "net", ".", "conv4_6_1x1_up", ",", "net", ".", "conv4_6_1x1_increase", ",", "net", ".", "conv4_5", ")", "\n", "net", "[", "'conv4_6/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv4_6", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_6'", ",", "'conv5_1_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv5_1_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv5_1_1x1_reduce'", ",", "'conv5_1_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv5_1_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv5_1_3x3'", ",", "'conv5_1_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv5_1_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_1_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv5_1_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv5_1_global_pool", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv5_1_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_1_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5_1_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv5_1_1x1_down", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv5_1_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv5_1_1x1_up", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_6'", ",", "'conv5_1_1x1_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv5_1", "=", "L", ".", "Axpy", "(", "net", ".", "conv5_1_1x1_up", ",", "net", ".", "conv5_1_1x1_increase", ",", "net", ".", "conv5_1_1x1_proj", ")", "\n", "net", "[", "'conv5_1/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_1", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv5_1'", ",", "'conv5_2_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv5_2_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv5_2_1x1_reduce'", ",", "'conv5_2_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv5_2_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv5_2_3x3'", ",", "'conv5_2_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv5_2_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_2_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv5_2_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv5_2_global_pool", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv5_2_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_2_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5_2_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv5_2_1x1_down", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv5_2_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv5_2_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5_2", "=", "L", ".", "Axpy", "(", "net", ".", "conv5_2_1x1_up", ",", "net", ".", "conv5_2_1x1_increase", ",", "net", ".", "conv5_1", ")", "\n", "net", "[", "'conv5_2/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_2", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'conv5_2'", ",", "'conv5_3_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv5_3_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv5_3_1x1_reduce'", ",", "'conv5_3_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv5_3_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv5_3_3x3'", ",", "'conv5_3_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv5_3_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_3_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv5_3_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv5_3_global_pool", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'conv5_3_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_3_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5_3_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv5_3_1x1_down", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "conv5_3_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv5_3_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv5_3", "=", "L", ".", "Axpy", "(", "net", ".", "conv5_3_1x1_up", ",", "net", ".", "conv5_3_1x1_increase", ",", "net", ".", "conv5_2", ")", "\n", "net", "[", "'conv5_3/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv5_3", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "7", ",", "stride", "=", "1", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.CreateMultiBoxHead": [[949, 1091], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_SEResNeXt50.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEResNeXt50.CreateRefineDetHead": [[1094, 1379], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_SEResNeXt50.ConvBNLayer", "model_libs_SEResNeXt50.ConvBNGroupLayer", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Axpy", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_SEResNeXt50.ConvBNLayer", "model_libs_SEResNeXt50.ConvBNGroupLayer", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "model_libs_SEResNeXt50.ConvBNLayer", "caffe.layers.Axpy", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# SENeXt50 Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inter_1x1_reduce", "=", "inter_name", "+", "'_1x1_reduce'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_1x1_reduce", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_3x3", "=", "inter_name", "+", "'_3x3'", "\n", "ConvBNGroupLayer", "(", "net", ",", "inter_1x1_reduce", ",", "inter_3x3", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_1x1_increase", "=", "inter_name", "+", "'_1x1_increase'", "\n", "ConvBNLayer", "(", "net", ",", "inter_3x3", ",", "inter_1x1_increase", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_global_pool", "=", "inter_name", "+", "'_global_pool'", "\n", "net", "[", "inter_global_pool", "]", "=", "L", ".", "Pooling", "(", "net", "[", "inter_1x1_increase", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "inter_1x1_down", "=", "inter_name", "+", "'_1x1_down'", "\n", "net", "[", "inter_1x1_down", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inter_global_pool", "]", ",", "num_output", "=", "8", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inter_1x1_down_relu", "=", "inter_name", "+", "'_1x1_down/relu'", "\n", "net", "[", "inter_1x1_down_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_1x1_down", "]", ",", "in_place", "=", "True", ")", "\n", "inter_1x1_up", "=", "inter_name", "+", "'_1x1_up'", "\n", "net", "[", "inter_1x1_up", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inter_1x1_down", "]", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inter_prob", "=", "inter_name", "+", "'_prob'", "\n", "net", "[", "inter_prob", "]", "=", "L", ".", "Sigmoid", "(", "net", "[", "inter_1x1_up", "]", ",", "in_place", "=", "True", ")", "\n", "inter_1x1_proj", "=", "inter_name", "+", "'_1x1_proj'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_1x1_proj", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_axpy", "=", "inter_name", "+", "'_axpy'", "\n", "net", "[", "inter_axpy", "]", "=", "L", ".", "Axpy", "(", "net", "[", "inter_1x1_up", "]", ",", "net", "[", "inter_1x1_increase", "]", ",", "net", "[", "inter_1x1_proj", "]", ")", "\n", "inter_relu", "=", "inter_name", "+", "'/relu'", "\n", "net", "[", "inter_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_axpy", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "inter_axpy", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# SEResNexX50 Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inter_1x1_reduce", "=", "inter_name", "+", "'_1x1_reduce'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_1x1_reduce", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_3x3", "=", "inter_name", "+", "'_3x3'", "\n", "ConvBNGroupLayer", "(", "net", ",", "inter_1x1_reduce", ",", "inter_3x3", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_1x1_increase", "=", "inter_name", "+", "'_1x1_increase'", "\n", "ConvBNLayer", "(", "net", ",", "inter_3x3", ",", "inter_1x1_increase", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_global_pool", "=", "inter_name", "+", "'_global_pool'", "\n", "net", "[", "inter_global_pool", "]", "=", "L", ".", "Pooling", "(", "net", "[", "inter_1x1_increase", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "inter_1x1_down", "=", "inter_name", "+", "'_1x1_down'", "\n", "net", "[", "inter_1x1_down", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inter_global_pool", "]", ",", "num_output", "=", "8", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inter_1x1_down_relu", "=", "inter_name", "+", "'_1x1_down/relu'", "\n", "net", "[", "inter_1x1_down_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_1x1_down", "]", ",", "in_place", "=", "True", ")", "\n", "inter_1x1_up", "=", "inter_name", "+", "'_1x1_up'", "\n", "net", "[", "inter_1x1_up", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inter_1x1_down", "]", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inter_prob", "=", "inter_name", "+", "'_prob'", "\n", "net", "[", "inter_prob", "]", "=", "L", ".", "Sigmoid", "(", "net", "[", "inter_1x1_up", "]", ",", "in_place", "=", "True", ")", "\n", "inter_1x1_proj", "=", "inter_name", "+", "'_1x1_proj'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_1x1_proj", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_axpy", "=", "inter_name", "+", "'_axpy'", "\n", "net", "[", "inter_axpy", "]", "=", "L", ".", "Axpy", "(", "net", "[", "inter_1x1_up", "]", ",", "net", "[", "inter_1x1_increase", "]", ",", "net", "[", "inter_1x1_proj", "]", ")", "\n", "inter_relu", "=", "inter_name", "+", "'/relu'", "\n", "net", "[", "inter_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_axpy", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "inter_axpy", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.SEBNInception_COCO_512.AddExtraLayers": [[15, 104], ["ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "L.Pooling", "ConvBNLayer2", "L.Concat", "L.Pooling", "L.Convolution", "L.ReLU", "L.Convolution", "L.Sigmoid", "L.Reshape", "L.Scale", "arm_source_layers.reverse", "enumerate", "dict", "dict", "net.keys", "ConvBNLayer", "dict", "dict", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/bn/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_rs", "=", "{", "\n", "#'shape': [dict(dim=0, dim=0)],", "\n", "'shape'", ":", "[", "dict", "(", "dim", "=", "0", ")", "]", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b_scale'", ",", "'inception_6/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b_scale'", ",", "'inception_6/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/3x3_reduce'", ",", "'inception_6/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b_scale'", ",", "'inception_6/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/double3x3_reduce'", ",", "'inception_6/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/double3x3a'", ",", "'inception_6/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_6/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_5b_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/pool'", ",", "'inception_6/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_6/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_6/1x1'", "]", ",", "net", "[", "'inception_6/3x3'", "]", ",", "net", "[", "'inception_6/double3x3b'", "]", ",", "net", "[", "'inception_6/pool_proj'", "]", ")", "\n", "net", ".", "inception_6_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_6/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_6_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_6_global_pool", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_6_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_6_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_6_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_6_1x1_down", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_6_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_6_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_6_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_6_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_6_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_6/concat'", "]", ",", "net", ".", "inception_6_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.Xception_COCO_320.AddExtraLayers": [[15, 100], ["ConvBNLayer", "L.ReLU", "L.ConvolutionDepthwise", "ConvBNLayer", "L.ConvolutionDepthwise", "ConvBNLayer", "L.Pooling", "L.Eltwise", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer", "dict", "dict", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "\n", "# Matched convolution toward left branch of intermediate layers", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'xception13_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution toard right branch of intermediate layers", "\n", "net", ".", "xception13_relu", "=", "L", ".", "ReLU", "(", "net", "[", "from_layer", "]", ")", "\n", "net", ".", "xception13_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception13_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer", "(", "net", ",", "'xception13_conv1_1'", ",", "'xception13_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception13_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception13_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer", "(", "net", ",", "'xception13_conv2_1'", ",", "'xception13_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Pool and merge", "\n", "net", ".", "xception13_pool", "=", "L", ".", "Pooling", "(", "net", ".", "xception13_conv2_2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "0", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "net", ".", "xception13_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception13_match_conv", ",", "net", ".", "xception13_pool", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.ConvBNGroupLayer": [[31, 91], ["model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.ConvBNGroupLayer2": [[92, 152], ["model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.MergedConvGroupLayer": [[153, 213], ["model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.ConvBNLayer2": [[214, 274], ["model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "    ", "bn_name", "=", "'{}{}'", ".", "format", "(", "bn_prefix", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "#sb_name = '{}{}{}'.format(scale_prefix, out_layer, scale_postfix)", "\n", "      ", "sb_name", "=", "'{}{}'", ".", "format", "(", "scale_prefix", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_prefix", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.DeconvBNLayer2": [[275, 322], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "#deconv_name = '{}{}{}'.format(deconv_prefix, out_layer, deconv_postfix)", "\n", "", "deconv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(deconv_name)", "\n", "      ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.ConvBNLayer": [[323, 379], ["model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.DeconvBNLayer": [[380, 425], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.MergedDeconvLayer": [[426, 471], ["caffe.layers.Deconvolution", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "MergedDeconvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[deconv_name], in_place=True)", "\n", "      ", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.MergedConvLayer": [[472, 528], ["model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "model_libs_ResNeXt26.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.EltwiseLayer": [[530, 533], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.ResBody": [[535, 593], ["model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.InceptionTower": [[595, 608], ["caffe.layers.Pooling", "param.update", "model_libs_ResNeXt26.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.CreateAnnotatedDataLayer": [[609, 634], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.ResNeXt26Body": [[635, 766], ["model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Pooling", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "dict", "caffe.layers.Pooling", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResNeXt26Body", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "conv1", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'pool1'", ",", "'resx1_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx1_conv1'", ",", "'resx1_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx1_conv2'", ",", "'resx1_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'pool1'", ",", "'resx1_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx1_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx1_match_conv", ",", "net", ".", "resx1_conv3", ")", "\n", "net", ".", "resx1_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx1_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx1_elewise'", ",", "'resx2_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx2_conv1'", ",", "'resx2_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx2_conv2'", ",", "'resx2_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx2_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx1_elewise", ",", "net", ".", "resx2_conv3", ")", "\n", "net", ".", "resx2_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx2_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx2_elewise'", ",", "'resx3_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx3_conv1'", ",", "'resx3_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx3_conv2'", ",", "'resx3_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx2_elewise'", ",", "'resx3_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx3_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx3_match_conv", ",", "net", ".", "resx3_conv3", ")", "\n", "net", ".", "resx3_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx3_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx3_elewise'", ",", "'resx4_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx4_conv1'", ",", "'resx4_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx4_conv2'", ",", "'resx4_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx4_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx3_elewise", ",", "net", ".", "resx4_conv3", ")", "\n", "net", ".", "resx4_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx4_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx4_elewise'", ",", "'resx5_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx5_conv1'", ",", "'resx5_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx5_conv2'", ",", "'resx5_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx4_elewise'", ",", "'resx5_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx5_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx5_match_conv", ",", "net", ".", "resx5_conv3", ")", "\n", "net", ".", "resx5_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx5_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx5_elewise'", ",", "'resx6_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx6_conv1'", ",", "'resx6_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx6_conv2'", ",", "'resx6_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx6_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx5_elewise", ",", "net", ".", "resx6_conv3", ")", "\n", "net", ".", "resx6_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx6_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx6_elewise'", ",", "'resx7_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx7_conv1'", ",", "'resx7_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx7_conv2'", ",", "'resx7_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx6_elewise'", ",", "'resx7_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx7_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx7_match_conv", ",", "net", ".", "resx7_conv3", ")", "\n", "net", ".", "resx7_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx7_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'resx7_elewise'", ",", "'resx8_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx8_conv1'", ",", "'resx8_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx8_conv2'", ",", "'resx8_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx8_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx7_elewise", ",", "net", ".", "resx8_conv3", ")", "\n", "net", ".", "resx8_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx8_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "7", ",", "stride", "=", "1", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.ResNeXtMerged26Body": [[767, 898], ["model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Pooling", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNeXt26.MergedConvLayer", "model_libs_ResNeXt26.MergedConvGroupLayer", "model_libs_ResNeXt26.MergedConvLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "dict", "caffe.layers.Pooling", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer"], ["", "def", "ResNeXtMerged26Body", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "MergedConvLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "conv1", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'pool1'", ",", "'resx1_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx1_conv1'", ",", "'resx1_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx1_conv2'", ",", "'resx1_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'pool1'", ",", "'resx1_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx1_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx1_match_conv", ",", "net", ".", "resx1_conv3", ")", "\n", "net", ".", "resx1_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx1_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'resx1_elewise'", ",", "'resx2_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx2_conv1'", ",", "'resx2_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx2_conv2'", ",", "'resx2_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx2_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx1_elewise", ",", "net", ".", "resx2_conv3", ")", "\n", "net", ".", "resx2_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx2_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'resx2_elewise'", ",", "'resx3_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx3_conv1'", ",", "'resx3_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx3_conv2'", ",", "'resx3_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx2_elewise'", ",", "'resx3_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx3_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx3_match_conv", ",", "net", ".", "resx3_conv3", ")", "\n", "net", ".", "resx3_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx3_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'resx3_elewise'", ",", "'resx4_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx4_conv1'", ",", "'resx4_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx4_conv2'", ",", "'resx4_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx4_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx3_elewise", ",", "net", ".", "resx4_conv3", ")", "\n", "net", ".", "resx4_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx4_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'resx4_elewise'", ",", "'resx5_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx5_conv1'", ",", "'resx5_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx5_conv2'", ",", "'resx5_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx4_elewise'", ",", "'resx5_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx5_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx5_match_conv", ",", "net", ".", "resx5_conv3", ")", "\n", "net", ".", "resx5_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx5_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'resx5_elewise'", ",", "'resx6_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx6_conv1'", ",", "'resx6_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx6_conv2'", ",", "'resx6_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx6_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx5_elewise", ",", "net", ".", "resx6_conv3", ")", "\n", "net", ".", "resx6_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx6_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'resx6_elewise'", ",", "'resx7_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx7_conv1'", ",", "'resx7_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx7_conv2'", ",", "'resx7_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx6_elewise'", ",", "'resx7_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx7_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx7_match_conv", ",", "net", ".", "resx7_conv3", ")", "\n", "net", ".", "resx7_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx7_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "MergedConvLayer", "(", "net", ",", "'resx7_elewise'", ",", "'resx8_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvGroupLayer", "(", "net", ",", "'resx8_conv1'", ",", "'resx8_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "MergedConvLayer", "(", "net", ",", "'resx8_conv2'", ",", "'resx8_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx8_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx7_elewise", ",", "net", ".", "resx8_conv3", ")", "\n", "net", ".", "resx8_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx8_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "7", ",", "stride", "=", "1", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.CreateMultiBoxHead": [[899, 1041], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_ResNeXt26.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNeXt26.CreateRefineDetHead": [[1044, 1333], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNGroupLayer", "model_libs_ResNeXt26.ConvBNLayer", "model_libs_ResNeXt26.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# ResNeXt Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "resx_inter_conv1", "=", "inter_name", "+", "'_conv1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "resx_inter_conv1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_conv2", "=", "inter_name", "+", "'_conv2'", "\n", "ConvBNGroupLayer", "(", "net", ",", "resx_inter_conv1", ",", "resx_inter_conv2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_conv3", "=", "inter_name", "+", "'_conv3'", "\n", "ConvBNLayer", "(", "net", ",", "resx_inter_conv2", ",", "resx_inter_conv3", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_match", "=", "inter_name", "+", "'_match'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "resx_inter_match", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_elewise", "=", "inter_name", "+", "'_elewise'", "\n", "net", "[", "resx_inter_elewise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "resx_inter_match", "]", ",", "net", "[", "resx_inter_conv3", "]", ")", "\n", "resx_inter_relu", "=", "inter_name", "+", "'_elewise_relu'", "\n", "net", "[", "resx_inter_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "resx_inter_elewise", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "resx_inter_elewise", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# ResNeXt Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "resx_inter_conv1", "=", "inter_name", "+", "'_conv1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "resx_inter_conv1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_conv2", "=", "inter_name", "+", "'_conv2'", "\n", "ConvBNGroupLayer", "(", "net", ",", "resx_inter_conv1", ",", "resx_inter_conv2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_conv3", "=", "inter_name", "+", "'_conv3'", "\n", "ConvBNLayer", "(", "net", ",", "resx_inter_conv2", ",", "resx_inter_conv3", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_match", "=", "inter_name", "+", "'_match'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "resx_inter_match", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "resx_inter_elewise", "=", "inter_name", "+", "'_elewise'", "\n", "net", "[", "resx_inter_elewise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "resx_inter_match", "]", ",", "net", "[", "resx_inter_conv3", "]", ")", "\n", "resx_inter_relu", "=", "inter_name", "+", "'_elewise_relu'", "\n", "net", "[", "resx_inter_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "resx_inter_elewise", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "resx_inter_elewise", "\n", "\n", "# ResNeXtMerged Head", "\n", "# inter_name = \"{}_inter\".format(from_layer)", "\n", "# resx_inter_conv1 = inter_name + '_conv1'", "\n", "# MergedConvLayer(net, from_layer, resx_inter_conv1, use_bn=True, use_relu=True, num_output=128, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv2 = inter_name + '_conv2'", "\n", "# MergedConvGroupLayer(net, resx_inter_conv1, resx_inter_conv2, use_bn=True, use_relu=True, num_output=128, kernel_size=3, pad=1, stride=1, group=32,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_conv3 = inter_name + '_conv3'", "\n", "# MergedConvLayer(net, resx_inter_conv2, resx_inter_conv3, use_bn=True, use_relu=False, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_match = inter_name + '_match'", "\n", "# MergedConvLayer(net, from_layer, resx_inter_match, use_bn=True, use_relu=False, num_output=256, kernel_size=1, pad=0, stride=1,", "\n", "#     conv_prefix=conv_prefix, conv_postfix=conv_postfix, bn_prefix=bn_prefix, bn_postfix=bn_postfix,", "\n", "#     scale_prefix=scale_prefix, scale_postfix=scale_postfix, **bn_param)", "\n", "# resx_inter_elewise = inter_name + '_elewise'", "\n", "# net[resx_inter_elewise] = L.Eltwise(net[resx_inter_match], net[resx_inter_conv3])", "\n", "# resx_inter_relu = inter_name + '_elewise_relu'", "\n", "# net[resx_inter_relu] = L.ReLU(net[resx_inter_elewise], in_place=True)", "\n", "# from_layer = resx_inter_elewise", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.ConvBNGroupLayer": [[31, 91], ["model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.ConvBNGroupLayer2": [[92, 152], ["model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.MergedConvGroupLayer": [[153, 213], ["model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.ConvBNLayer2": [[214, 274], ["model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "    ", "bn_name", "=", "'{}{}'", ".", "format", "(", "bn_prefix", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "#sb_name = '{}{}{}'.format(scale_prefix, out_layer, scale_postfix)", "\n", "      ", "sb_name", "=", "'{}{}'", ".", "format", "(", "scale_prefix", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_prefix", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.DeconvBNLayer2": [[275, 322], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "#deconv_name = '{}{}{}'.format(deconv_prefix, out_layer, deconv_postfix)", "\n", "", "deconv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(deconv_name)", "\n", "      ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.ConvBNLayer": [[323, 379], ["model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.DeconvBNLayer": [[380, 425], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.MergedDeconvLayer": [[426, 471], ["caffe.layers.Deconvolution", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "MergedDeconvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[deconv_name], in_place=True)", "\n", "      ", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.MergedConvLayer": [[472, 528], ["model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "model_libs_ResNet18.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.EltwiseLayer": [[530, 533], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.ResBody": [[535, 593], ["model_libs_ResNet18.ConvBNLayer", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer", "model_libs_ResNet18.ConvBNLayer", "model_libs_ResNet18.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.InceptionTower": [[595, 608], ["caffe.layers.Pooling", "param.update", "model_libs_ResNet18.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.CreateAnnotatedDataLayer": [[609, 634], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.ResNet18Body": [[635, 729], ["model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_ResNet18.ConvBNLayer2", "model_libs_ResNet18.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.Pooling"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2"], ["", "def", "ResNet18Body", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "'bn_'", ",", "bn_postfix", "=", "'conv1'", ",", "\n", "scale_prefix", "=", "'scale_'", ",", "scale_postfix", "=", "'conv1'", ",", "**", "bn_param", ")", "\n", "\n", "net", ".", "pool1", "=", "L", ".", "Pooling", "(", "net", ".", "conv1", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'pool1'", ",", "'res2a_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'res2a_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'2a_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'2a_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res2a_branch2a'", ",", "'res2a_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'2a_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'2a_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res2a", "=", "L", ".", "Eltwise", "(", "net", ".", "pool1", ",", "net", ".", "res2a_branch2b", ")", "\n", "net", ".", "res2a_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res2a", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res2a'", ",", "'res2b_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'res2b_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'2b_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'2b_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res2b_branch2a'", ",", "'res2b_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'2b_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'2b_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res2b", "=", "L", ".", "Eltwise", "(", "net", ".", "res2a", ",", "net", ".", "res2b_branch2b", ")", "\n", "net", ".", "res2b_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res2b", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'res2b'", ",", "'res3a_branch1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'3a_branch1'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'3a_branch1'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res2b'", ",", "'res3a_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'res3a_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'3a_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'3a_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res3a_branch2a'", ",", "'res3a_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'3a_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'3a_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res3a", "=", "L", ".", "Eltwise", "(", "net", ".", "res3a_branch1", ",", "net", ".", "res3a_branch2b", ")", "\n", "net", ".", "res3a_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res3a", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res3a'", ",", "'res3b_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'res3b_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'3b_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'3b_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res3b_branch2a'", ",", "'res3b_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'3b_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'3b_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res3b", "=", "L", ".", "Eltwise", "(", "net", ".", "res3a", ",", "net", ".", "res3b_branch2b", ")", "\n", "net", ".", "res3b_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res3b", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'res3b'", ",", "'res4a_branch1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'4a_branch1'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'4a_branch1'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res3b'", ",", "'res4a_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'res4a_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'4a_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'4a_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res4a_branch2a'", ",", "'res4a_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'4a_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'4a_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res4a", "=", "L", ".", "Eltwise", "(", "net", ".", "res4a_branch1", ",", "net", ".", "res4a_branch2b", ")", "\n", "net", ".", "res4a_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res4a", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res4a'", ",", "'res4b_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'res4b_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'4b_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'4b_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res4b_branch2a'", ",", "'res4b_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'4b_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'4b_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res4b", "=", "L", ".", "Eltwise", "(", "net", ".", "res4a", ",", "net", ".", "res4b_branch2b", ")", "\n", "net", ".", "res4b_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res4b", ",", "in_place", "=", "True", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'res4b'", ",", "'res5a_branch1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'5a_branch1'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'5a_branch1'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res4b'", ",", "'res5a_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'res5a_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'5a_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'5a_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res5a_branch2a'", ",", "'res5a_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'5a_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'5a_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res5a", "=", "L", ".", "Eltwise", "(", "net", ".", "res5a_branch1", ",", "net", ".", "res5a_branch2b", ")", "\n", "net", ".", "res5a_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res5a", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res5a'", ",", "'res5b_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'res5b_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'5b_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'5b_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res5b_branch2a'", ",", "'res5b_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'5b_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'5b_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res5b", "=", "L", ".", "Eltwise", "(", "net", ".", "res5a", ",", "net", ".", "res5b_branch2b", ")", "\n", "net", ".", "res5b_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res5b", ",", "in_place", "=", "True", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "7", ",", "stride", "=", "1", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.CreateMultiBoxHead": [[730, 872], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_ResNet18.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_ResNet18.CreateRefineDetHead": [[873, 1128], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_ResNet18.ConvBNLayer", "model_libs_ResNet18.ConvBNLayer", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_ResNet18.ConvBNLayer", "model_libs_ResNet18.ConvBNLayer", "model_libs_ResNet18.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "# ResNet18 Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inter_branch1", "=", "inter_name", "+", "\"_branch1\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2a", "=", "inter_name", "+", "\"_branch2a\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch2a", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2b", "=", "inter_name", "+", "\"_branch2b\"", "\n", "ConvBNLayer", "(", "net", ",", "inter_branch2a", ",", "inter_branch2b", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_eltwise", "=", "inter_name", "+", "\"_eltwise\"", "\n", "net", "[", "inter_eltwise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "inter_branch1", "]", ",", "net", "[", "inter_branch2b", "]", ")", "\n", "inter_eltwise_relu", "=", "inter_name", "+", "\"_eltwise_relu\"", "\n", "net", "[", "inter_eltwise_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_eltwise", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "inter_eltwise", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "# ResNet18 Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inter_branch1", "=", "inter_name", "+", "\"_branch1\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2a", "=", "inter_name", "+", "\"_branch2a\"", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_branch2a", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_branch2b", "=", "inter_name", "+", "\"_branch2b\"", "\n", "ConvBNLayer", "(", "net", ",", "inter_branch2a", ",", "inter_branch2b", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_eltwise", "=", "inter_name", "+", "\"_eltwise\"", "\n", "net", "[", "inter_eltwise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "inter_branch1", "]", ",", "net", "[", "inter_branch2b", "]", ")", "\n", "inter_eltwise_relu", "=", "inter_name", "+", "\"_eltwise_relu\"", "\n", "net", "[", "inter_eltwise_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inter_eltwise", "]", ",", "in_place", "=", "True", ")", "\n", "from_layer", "=", "inter_eltwise", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.MobileNetV2_COCO_320.AddExtraLayers": [[15, 88], ["ConvBNLayer", "DWConvBNLayer", "ConvBNLayer", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer2", "dict", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer2"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "# Last layer in body", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv7/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'7/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Depthwise convolution layer", "\n", "DWConvBNLayer", "(", "net", ",", "'conv7/expand'", ",", "'conv7/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "group", "=", "576", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'7/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Linear layer", "\n", "ConvBNLayer", "(", "net", ",", "'conv7/dwise'", ",", "'conv7/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'7/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.SEResNeXt50_COCO_320.AddExtraLayers": [[15, 94], ["ConvBNLayer2", "ConvBNGroupLayer2", "ConvBNLayer2", "L.Pooling", "L.Convolution", "L.ReLU", "L.Convolution", "L.Sigmoid", "ConvBNLayer2", "L.Axpy", "L.ReLU", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/bn/scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "ConvBNLayer2", "(", "net", ",", "'conv5_3'", ",", "'conv6_1x1_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv6_1x1_reduce'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer2", "(", "net", ",", "'conv6_1x1_reduce'", ",", "'conv6_3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "'conv6_3x3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv6_3x3'", ",", "'conv6_1x1_increase'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv6_global_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv6_1x1_increase", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "conv6_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "conv6_global_pool", ",", "num_output", "=", "8", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs", ")", "\n", "net", "[", "'conv6_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv6_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "conv6_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "conv6_1x1_down", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs", ")", "\n", "net", ".", "conv6_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "conv6_1x1_up", ",", "in_place", "=", "True", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv5_3'", ",", "'conv6_1x1_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "conv6", "=", "L", ".", "Axpy", "(", "net", ".", "conv6_1x1_up", ",", "net", ".", "conv6_1x1_increase", ",", "net", ".", "conv6_1x1_proj", ")", "\n", "net", "[", "'conv6/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "conv6", ",", "in_place", "=", "True", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "256", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.ConvBNLayer2": [[31, 88], ["model_libs_MobileNetV1.UnpackVariable", "model_libs_MobileNetV1.UnpackVariable", "model_libs_MobileNetV1.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.ConvBNLayer": [[89, 147], ["model_libs_MobileNetV1.UnpackVariable", "model_libs_MobileNetV1.UnpackVariable", "model_libs_MobileNetV1.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'relu{}'", ".", "format", "(", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.DWConvBNLayer": [[148, 212], ["model_libs_MobileNetV1.UnpackVariable", "model_libs_MobileNetV1.UnpackVariable", "model_libs_MobileNetV1.UnpackVariable", "caffe.layers.ConvolutionDepthwise", "caffe.layers.ConvolutionDepthwise", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "DWConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "group", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "#net[conv_name] = L.ConvolutionDepthwise(net[from_layer], num_output=num_output, group=group,", "\n", "#    kernel_size=kernel_h, pad=pad_h, stride=stride_h, **kwargs)", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "from_layer", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "num_output", ",", "group", "=", "group", ",", "pad", "=", "pad_h", ",", "kernel_size", "=", "kernel_h", ",", "stride", "=", "stride_h", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "", "else", ":", "\n", "#net[conv_name] = L.ConvolutionDepthwise(net[from_layer], num_output=num_output, group=group,", "\n", "#    kernel_h=kernel_h, kernel_w=kernel_w, pad_h=pad_h, pad_w=pad_w,", "\n", "#    stride_h=stride_h, stride_w=stride_w, **kwargs)", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "from_layer", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "num_output", ",", "group", "=", "group", ",", "kernel_h", "=", "kernel_h", ",", "\n", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'relu{}'", ".", "format", "(", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.DeconvBNLayer": [[213, 258], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.EltwiseLayer": [[259, 262], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.ResBody": [[264, 322], ["model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.InceptionTower": [[324, 337], ["caffe.layers.Pooling", "param.update", "model_libs_MobileNetV1.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.CreateAnnotatedDataLayer": [[338, 363], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.MobileNetV1Body": [[364, 491], ["model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "dict", "caffe.layers.Pooling", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "MobileNetV1Body", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Convoution 1", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 2_1", "\n", "DWConvBNLayer", "(", "net", ",", "'conv1'", ",", "'conv2_1/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "group", "=", "32", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_1/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv2_1/dw'", ",", "'conv2_1/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_1/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Dpethwise convolution 2_2", "\n", "DWConvBNLayer", "(", "net", ",", "'conv2_1/sep'", ",", "'conv2_2/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "group", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_2/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv2_2/dw'", ",", "'conv2_2/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_2/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 3_1", "\n", "DWConvBNLayer", "(", "net", ",", "'conv2_2/sep'", ",", "'conv3_1/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "group", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_1/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv3_1/dw'", ",", "'conv3_1/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_1/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 3_2", "\n", "DWConvBNLayer", "(", "net", ",", "'conv3_1/sep'", ",", "'conv3_2/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "group", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_2/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv3_2/dw'", ",", "'conv3_2/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_2/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 4_1", "\n", "DWConvBNLayer", "(", "net", ",", "'conv3_2/sep'", ",", "'conv4_1/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "group", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_1/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_1/dw'", ",", "'conv4_1/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_1/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 4_2", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_1/sep'", ",", "'conv4_2/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "group", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_2/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_2/dw'", ",", "'conv4_2/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_2/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 5_1", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_2/sep'", ",", "'conv5_1/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_1/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_1/dw'", ",", "'conv5_1/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_1/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 5_2", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_1/sep'", ",", "'conv5_2/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_2/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_2/dw'", ",", "'conv5_2/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_2/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 5_3", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_2/sep'", ",", "'conv5_3/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_3/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_3/dw'", ",", "'conv5_3/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_3/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 5_4", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_3/sep'", ",", "'conv5_4/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_4/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_4/dw'", ",", "'conv5_4/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_4/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 5_5", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_4/sep'", ",", "'conv5_5/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_5/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_5/dw'", ",", "'conv5_5/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_5/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 5_6", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_5/sep'", ",", "'conv5_6/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_6/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_6/dw'", ",", "'conv5_6/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_6/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 6", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_6/sep'", ",", "'conv6/dw'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "group", "=", "1024", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6/dw'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv6/dw'", ",", "'conv6/sep'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6/sep'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'conv6/dw'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "global_pooling", "=", "True", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.CreateMultiBoxHead": [[492, 635], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_MobileNetV1.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV1.CreateRefineDetHead": [[636, 885], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_MobileNetV1.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_MobileNetV1.DWConvBNLayer", "model_libs_MobileNetV1.ConvBNLayer", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "use_relu", "=", "True", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# Inter layer from body to head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "# Depthwise convolution layer", "\n", "inter_dw", "=", "inter_name", "+", "'/dw'", "\n", "DWConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_dw", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_dw", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Seperate layer", "\n", "inter_sep", "=", "inter_name", "+", "'/sep'", "\n", "ConvBNLayer", "(", "net", ",", "inter_dw", ",", "inter_sep", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_sep", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Bridge of rest of head", "\n", "from_layer", "=", "inter_sep", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# Inter layer from body to head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "# Depthwise convolution layer", "\n", "inter_dw", "=", "inter_name", "+", "'/dw'", "\n", "DWConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_dw", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "group", "=", "512", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_dw", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Seperate layer", "\n", "inter_sep", "=", "inter_name", "+", "'/sep'", "\n", "ConvBNLayer", "(", "net", ",", "inter_dw", ",", "inter_sep", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_sep", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Bridge of rest of head", "\n", "from_layer", "=", "inter_sep", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "\n", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.ResNet18_COCO_512.AddExtraLayers": [[15, 80], ["ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "L.Eltwise", "L.ReLU", "arm_source_layers.reverse", "enumerate", "net.keys", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 512/32: 16 x 16", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 512/64: 8 x 8", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "'res6_branch1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'6_branch1'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'6_branch1'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "'res6_branch2a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'res6_branch2a'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'6_branch2a'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'6_branch2a'", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'res6_branch2a'", ",", "'res6_branch2b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "'6_branch2b'", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "'6_branch2b'", ",", "**", "bn_param", ")", "\n", "net", ".", "res6", "=", "L", ".", "Eltwise", "(", "net", ".", "res6_branch1", ",", "net", ".", "res6_branch2b", ")", "\n", "net", ".", "res6_relu", "=", "L", ".", "ReLU", "(", "net", ".", "res6", ",", "in_place", "=", "True", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer": [[31, 91], ["model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer2": [[92, 152], ["model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNGroupLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvGroupLayer": [[153, 213], ["model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvGroupLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "group", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "#conv_name = '{}'.format(out_layer)", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "group", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'group'", ":", "group", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "#relu_name = '{}/relu{}'.format(conv_prefix,conv_postfix)", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNLayer2": [[214, 274], ["model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "#bn_name = '{}{}'.format(bn_prefix, bn_postfix)", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "#sb_name = '{}{}'.format(scale_prefix, scale_postfix)", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_prefix)    ", "\n", "    ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.DeconvBNLayer2": [[275, 322], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "#deconv_name = '{}{}{}'.format(deconv_prefix, out_layer, deconv_postfix)", "\n", "", "deconv_name", "=", "'{}'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(deconv_name)", "\n", "      ", "relu_name", "=", "'{}/relu{}'", ".", "format", "(", "conv_prefix", ",", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNLayer": [[323, 379], ["model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.DeconvBNLayer": [[380, 425], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedDeconvLayer": [[426, 471], ["caffe.layers.Deconvolution", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "MergedDeconvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[deconv_name], in_place=True)", "\n", "      ", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.MergedConvLayer": [[472, 528], ["model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "model_libs_SEBNInception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "MergedConvLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(bn_prefix, out_layer, bn_postfix)", "\n", "#net[bn_name] = L.BatchNorm(net[conv_name], in_place=True)", "\n", "    ", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.EltwiseLayer": [[530, 533], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ResBody": [[535, 593], ["model_libs_SEBNInception.ConvBNLayer", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_SEBNInception.ConvBNLayer", "model_libs_SEBNInception.ConvBNLayer", "model_libs_SEBNInception.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.InceptionTower": [[595, 608], ["caffe.layers.Pooling", "param.update", "model_libs_SEBNInception.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.CreateAnnotatedDataLayer": [[609, 634], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.SEBNInceptionBody": [[635, 974], ["model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "dict", "dict", "caffe.layers.Pooling", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2"], ["", "def", "SEBNInceptionBody", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/bn/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "'conv1/7x7_s2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "7", ",", "pad", "=", "3", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'conv1'", ",", "conv_postfix", "=", "'_7x7'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", "[", "'pool1/3x3_s2'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'conv1/7x7_s2'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'pool1/3x3_s2'", ",", "'conv2/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv2'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv2/3x3_reduce'", ",", "'conv2/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv2'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", "[", "'pool2/3x3_s2'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'conv2/3x3'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'pool2/3x3_s2'", ",", "'inception_3a/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3a'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'pool2/3x3_s2'", ",", "'inception_3a/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3a'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3a/3x3_reduce'", ",", "'inception_3a/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3a'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'pool2/3x3_s2'", ",", "'inception_3a/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3a'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3a/double3x3_reduce'", ",", "'inception_3a/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3a'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3a/double3x3a'", ",", "'inception_3a/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3a'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_3a/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'pool2/3x3_s2'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3a/pool'", ",", "'inception_3a/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3a'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_3a/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_3a/1x1'", "]", ",", "net", "[", "'inception_3a/3x3'", "]", ",", "net", "[", "'inception_3a/double3x3b'", "]", ",", "net", "[", "'inception_3a/pool_proj'", "]", ")", "\n", "net", ".", "inception_3a_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_3a/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_3a_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_3a_global_pool", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_3a_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_3a_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_3a_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_3a_1x1_down", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_3a_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_3a_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_3a_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_3a_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_3a_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_3a/concat'", "]", ",", "net", ".", "inception_3a_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3a_scale'", ",", "'inception_3b/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3b'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3a_scale'", ",", "'inception_3b/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3b'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3b/3x3_reduce'", ",", "'inception_3b/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3b'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3a_scale'", ",", "'inception_3b/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3b'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3b/double3x3_reduce'", ",", "'inception_3b/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3b'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3b/double3x3a'", ",", "'inception_3b/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3b'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_3b/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_3a_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3b/pool'", ",", "'inception_3b/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3b'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_3b/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_3b/1x1'", "]", ",", "net", "[", "'inception_3b/3x3'", "]", ",", "net", "[", "'inception_3b/double3x3b'", "]", ",", "net", "[", "'inception_3b/pool_proj'", "]", ")", "\n", "net", ".", "inception_3b_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_3b/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_3b_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_3b_global_pool", ",", "num_output", "=", "20", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_3b_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_3b_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_3b_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_3b_1x1_down", ",", "num_output", "=", "320", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_3b_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_3b_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_3b_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_3b_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_3b_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_3b/concat'", "]", ",", "net", ".", "inception_3b_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3b_scale'", ",", "'inception_3c/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3c'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3c/3x3_reduce'", ",", "'inception_3c/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "160", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'inception_3c'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3b_scale'", ",", "'inception_3c/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3c'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3c/double3x3_reduce'", ",", "'inception_3c/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_3c'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3c/double3x3a'", ",", "'inception_3c/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'inception_3c'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_3c/pool/3x3_s2'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_3b_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "net", "[", "'inception_3c/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_3c/3x3'", "]", ",", "net", "[", "'inception_3c/double3x3b'", "]", ",", "net", "[", "'inception_3c/pool/3x3_s2'", "]", ")", "\n", "net", ".", "inception_3c_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_3c/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_3c_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_3c_global_pool", ",", "num_output", "=", "36", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_3c_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_3c_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_3c_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_3c_1x1_down", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_3c_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_3c_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_3c_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_3c_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_3c_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_3c/concat'", "]", ",", "net", ".", "inception_3c_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3c_scale'", ",", "'inception_4a/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "224", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4a'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3c_scale'", ",", "'inception_4a/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4a'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4a/3x3_reduce'", ",", "'inception_4a/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4a'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_3c_scale'", ",", "'inception_4a/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4a'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4a/double3x3_reduce'", ",", "'inception_4a/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4a'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4a/double3x3a'", ",", "'inception_4a/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4a'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4a/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_3c_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4a/pool'", ",", "'inception_4a/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4a'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4a/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_4a/1x1'", "]", ",", "net", "[", "'inception_4a/3x3'", "]", ",", "net", "[", "'inception_4a/double3x3b'", "]", ",", "net", "[", "'inception_4a/pool_proj'", "]", ")", "\n", "net", ".", "inception_4a_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4a/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_4a_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4a_global_pool", ",", "num_output", "=", "36", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_4a_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_4a_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4a_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4a_1x1_down", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_4a_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_4a_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4a_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_4a_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_4a_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_4a/concat'", "]", ",", "net", ".", "inception_4a_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4a_scale'", ",", "'inception_4b/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4b'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4a_scale'", ",", "'inception_4b/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4b'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4b/3x3_reduce'", ",", "'inception_4b/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4b'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4a_scale'", ",", "'inception_4b/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4b'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4b/double3x3_reduce'", ",", "'inception_4b/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4b'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4b/double3x3a'", ",", "'inception_4b/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4b'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4b/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4a_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4b/pool'", ",", "'inception_4b/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4b'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4b/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_4b/1x1'", "]", ",", "net", "[", "'inception_4b/3x3'", "]", ",", "net", "[", "'inception_4b/double3x3b'", "]", ",", "net", "[", "'inception_4b/pool_proj'", "]", ")", "\n", "net", ".", "inception_4b_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4b/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_4b_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4b_global_pool", ",", "num_output", "=", "36", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_4b_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_4b_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4b_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4b_1x1_down", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_4b_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_4b_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4b_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_4b_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_4b_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_4b/concat'", "]", ",", "net", ".", "inception_4b_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4b_scale'", ",", "'inception_4c/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "160", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4c'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4b_scale'", ",", "'inception_4c/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4c'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4c/3x3_reduce'", ",", "'inception_4c/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "160", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4c'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4b_scale'", ",", "'inception_4c/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4c'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4c/double3x3_reduce'", ",", "'inception_4c/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "160", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4c'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4c/double3x3a'", ",", "'inception_4c/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "160", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4c'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4c/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4b_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4c/pool'", ",", "'inception_4c/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4c'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4c/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_4c/1x1'", "]", ",", "net", "[", "'inception_4c/3x3'", "]", ",", "net", "[", "'inception_4c/double3x3b'", "]", ",", "net", "[", "'inception_4c/pool_proj'", "]", ")", "\n", "net", ".", "inception_4c_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4c/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_4c_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4c_global_pool", ",", "num_output", "=", "38", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_4c_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_4c_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4c_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4c_1x1_down", ",", "num_output", "=", "608", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_4c_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_4c_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4c_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_4c_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_4c_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_4c/concat'", "]", ",", "net", ".", "inception_4c_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4c_scale'", ",", "'inception_4d/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4d'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4c_scale'", ",", "'inception_4d/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4d'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4d/3x3_reduce'", ",", "'inception_4d/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4d'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4c_scale'", ",", "'inception_4d/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "160", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4d'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4d/double3x3_reduce'", ",", "'inception_4d/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4d'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4d/double3x3a'", ",", "'inception_4d/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4d'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4d/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4c_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4d/pool'", ",", "'inception_4d/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4d'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4d/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_4d/1x1'", "]", ",", "net", "[", "'inception_4d/3x3'", "]", ",", "net", "[", "'inception_4d/double3x3b'", "]", ",", "net", "[", "'inception_4d/pool_proj'", "]", ")", "\n", "net", ".", "inception_4d_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4d/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_4d_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4d_global_pool", ",", "num_output", "=", "38", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_4d_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_4d_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4d_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4d_1x1_down", ",", "num_output", "=", "608", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_4d_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_4d_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4d_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_4d_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_4d_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_4d/concat'", "]", ",", "net", ".", "inception_4d_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4d_scale'", ",", "'inception_4e/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4e'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4e/3x3_reduce'", ",", "'inception_4e/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'inception_4e'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4d_scale'", ",", "'inception_4e/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4e'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4e/double3x3_reduce'", ",", "'inception_4e/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_4e'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4e/double3x3a'", ",", "'inception_4e/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "'inception_4e'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_4e/pool/3x3_s2'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4d_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "net", "[", "'inception_4e/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_4e/3x3'", "]", ",", "net", "[", "'inception_4e/double3x3b'", "]", ",", "net", "[", "'inception_4e/pool/3x3_s2'", "]", ")", "\n", "net", ".", "inception_4e_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4e/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_4e_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4e_global_pool", ",", "num_output", "=", "66", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_4e_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_4e_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4e_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_4e_1x1_down", ",", "num_output", "=", "1056", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_4e_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_4e_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_4e_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_4e_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_4e_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_4e/concat'", "]", ",", "net", ".", "inception_4e_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4e_scale'", ",", "'inception_5a/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "352", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5a'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4e_scale'", ",", "'inception_5a/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5a'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5a/3x3_reduce'", ",", "'inception_5a/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "320", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5a'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_4e_scale'", ",", "'inception_5a/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "160", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5a'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5a/double3x3_reduce'", ",", "'inception_5a/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "224", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5a'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5a/double3x3a'", ",", "'inception_5a/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "224", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5a'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_5a/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_4e_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5a/pool'", ",", "'inception_5a/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5a'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_5a/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_5a/1x1'", "]", ",", "net", "[", "'inception_5a/3x3'", "]", ",", "net", "[", "'inception_5a/double3x3b'", "]", ",", "net", "[", "'inception_5a/pool_proj'", "]", ")", "\n", "net", ".", "inception_5a_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_5a/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_5a_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_5a_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_5a_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_5a_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_5a_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_5a_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_5a_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_5a_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_5a_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_5a_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_5a_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_5a/concat'", "]", ",", "net", ".", "inception_5a_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5a_scale'", ",", "'inception_5b/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "352", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5b'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5a_scale'", ",", "'inception_5b/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5b'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b/3x3_reduce'", ",", "'inception_5b/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "320", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5b'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5a_scale'", ",", "'inception_5b/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5b'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b/double3x3_reduce'", ",", "'inception_5b/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "224", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5b'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b/double3x3a'", ",", "'inception_5b/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "224", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5b'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_5b/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_5a_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b/pool'", ",", "'inception_5b/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'inception_5b'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_5b/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_5b/1x1'", "]", ",", "net", "[", "'inception_5b/3x3'", "]", ",", "net", "[", "'inception_5b/double3x3b'", "]", ",", "net", "[", "'inception_5b/pool_proj'", "]", ")", "\n", "net", ".", "inception_5b_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_5b/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_5b_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_5b_global_pool", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_5b_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_5b_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_5b_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_5b_1x1_down", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_5b_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_5b_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_5b_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_5b_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_5b_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_5b/concat'", "]", ",", "net", ".", "inception_5b_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv5_3", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "7", ",", "stride", "=", "1", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.CreateMultiBoxHead": [[975, 1117], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_SEBNInception.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.CreateRefineDetHead": [[1120, 1435], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_SEBNInception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Pooling", "model_libs_SEBNInception.ConvBNLayer2", "caffe.layers.Concat", "caffe.layers.Pooling", "caffe.layers.Convolution", "caffe.layers.ReLU", "caffe.layers.Convolution", "caffe.layers.Sigmoid", "caffe.layers.Reshape", "caffe.layers.Scale", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "# SEBNInception Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inception1", "=", "inter_name", "+", "'_1x1'", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "inception1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception2_1", "=", "inter_name", "+", "'_3x3_reduce'", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "inception2_1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception2_2", "=", "inter_name", "+", "'_3x3'", "\n", "ConvBNLayer2", "(", "net", ",", "inception2_1", ",", "inception2_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception3_1", "=", "inter_name", "+", "'_double3_3_reduce'", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "inception3_1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception3_2", "=", "inter_name", "+", "'_double3_3a'", "\n", "ConvBNLayer2", "(", "net", ",", "inception3_1", ",", "inception3_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception3_3", "=", "inter_name", "+", "'_double3_3b'", "\n", "ConvBNLayer2", "(", "net", ",", "inception3_2", ",", "inception3_3", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception_pool", "=", "inter_name", "+", "'_pool'", "\n", "net", "[", "inception_pool", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "inception4", "=", "inter_name", "+", "'_pool_proj'", "\n", "ConvBNLayer2", "(", "net", ",", "inception_pool", ",", "inception4", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "concat_layer", "=", "inter_name", "+", "'_concat'", "\n", "net", "[", "concat_layer", "]", "=", "L", ".", "Concat", "(", "net", "[", "inception1", "]", ",", "net", "[", "inception2_2", "]", ",", "net", "[", "inception3_3", "]", ",", "net", "[", "inception4", "]", ")", "\n", "inception_global_pool", "=", "inter_name", "+", "'_global_pool'", "\n", "net", "[", "inception_global_pool", "]", "=", "L", ".", "Pooling", "(", "net", "[", "concat_layer", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "inception_down", "=", "inter_name", "+", "'_1x1_down'", "\n", "net", "[", "inception_down", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inception_global_pool", "]", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inception_down_relu", "=", "inter_name", "+", "'_1x1_down_relu'", "\n", "net", "[", "inception_down_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inception_down", "]", ",", "in_place", "=", "True", ")", "\n", "inception_up", "=", "inter_name", "+", "'_1x1_up'", "\n", "net", "[", "inception_up", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inception_down", "]", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inception_prob", "=", "inter_name", "+", "'_prob'", "\n", "net", "[", "inception_prob", "]", "=", "L", ".", "Sigmoid", "(", "net", "[", "inception_up", "]", ",", "in_place", "=", "True", ")", "\n", "inception_prob_reshape", "=", "inter_name", "+", "'_prob_reshape'", "\n", "net", "[", "inception_prob_reshape", "]", "=", "L", ".", "Reshape", "(", "net", "[", "inception_up", "]", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "inception_scale", "=", "inter_name", "+", "'_scale'", "\n", "net", "[", "inception_scale", "]", "=", "L", ".", "Scale", "(", "net", "[", "concat_layer", "]", ",", "net", "[", "inception_prob_reshape", "]", ",", "**", "kwargs_sb", ")", "\n", "from_layer", "=", "inception_scale", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "# SEBNInception Head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "inception1", "=", "inter_name", "+", "'_1x1'", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "inception1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception2_1", "=", "inter_name", "+", "'_3x3_reduce'", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "inception2_1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception2_2", "=", "inter_name", "+", "'_3x3'", "\n", "ConvBNLayer2", "(", "net", ",", "inception2_1", ",", "inception2_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception3_1", "=", "inter_name", "+", "'_double3_3_reduce'", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "inception3_1", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception3_2", "=", "inter_name", "+", "'_double3_3a'", "\n", "ConvBNLayer2", "(", "net", ",", "inception3_1", ",", "inception3_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception3_3", "=", "inter_name", "+", "'_double3_3b'", "\n", "ConvBNLayer2", "(", "net", ",", "inception3_2", ",", "inception3_3", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inception_pool", "=", "inter_name", "+", "'_pool'", "\n", "net", "[", "inception_pool", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "inception4", "=", "inter_name", "+", "'_pool_proj'", "\n", "ConvBNLayer2", "(", "net", ",", "inception_pool", ",", "inception4", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "inter_name", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "concat_layer", "=", "inter_name", "+", "'_concat'", "\n", "net", "[", "concat_layer", "]", "=", "L", ".", "Concat", "(", "net", "[", "inception1", "]", ",", "net", "[", "inception2_2", "]", ",", "net", "[", "inception3_3", "]", ",", "net", "[", "inception4", "]", ")", "\n", "inception_global_pool", "=", "inter_name", "+", "'_global_pool'", "\n", "net", "[", "inception_global_pool", "]", "=", "L", ".", "Pooling", "(", "net", "[", "concat_layer", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "inception_down", "=", "inter_name", "+", "'_1x1_down'", "\n", "net", "[", "inception_down", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inception_global_pool", "]", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inception_down_relu", "=", "inter_name", "+", "'_1x1_down_relu'", "\n", "net", "[", "inception_down_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "inception_down", "]", ",", "in_place", "=", "True", ")", "\n", "inception_up", "=", "inter_name", "+", "'_1x1_up'", "\n", "net", "[", "inception_up", "]", "=", "L", ".", "Convolution", "(", "net", "[", "inception_down", "]", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "inception_prob", "=", "inter_name", "+", "'_prob'", "\n", "net", "[", "inception_prob", "]", "=", "L", ".", "Sigmoid", "(", "net", "[", "inception_up", "]", ",", "in_place", "=", "True", ")", "\n", "inception_prob_reshape", "=", "inter_name", "+", "'_prob_reshape'", "\n", "net", "[", "inception_prob_reshape", "]", "=", "L", ".", "Reshape", "(", "net", "[", "inception_up", "]", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "inception_scale", "=", "inter_name", "+", "'_scale'", "\n", "net", "[", "inception_scale", "]", "=", "L", ".", "Scale", "(", "net", "[", "concat_layer", "]", ",", "net", "[", "inception_prob_reshape", "]", ",", "**", "kwargs_sb", ")", "\n", "from_layer", "=", "inception_scale", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "\n", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.ResNeXt50_COCO_512.AddExtraLayers": [[15, 89], ["ConvBNLayer", "ConvBNGroupLayer", "ConvBNLayer", "ConvBNLayer", "L.Eltwise", "L.ReLU", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx17_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx17_conv1'", ",", "'resx17_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx17_conv2'", ",", "'resx17_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx17_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx17_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx17_match_conv", ",", "net", ".", "resx17_conv3", ")", "\n", "net", ".", "resx17_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx17_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.ResNetXt26_COCO_512.AddExtraLayers": [[15, 89], ["ConvBNLayer", "ConvBNGroupLayer", "ConvBNLayer", "ConvBNLayer", "L.Eltwise", "L.ReLU", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 512/32: 16 x 16", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 512/64: 8 x 8", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx9_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx9_conv1'", ",", "'resx9_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx9_conv2'", ",", "'resx9_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx9_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx9_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx9_match_conv", ",", "net", ".", "resx9_conv3", ")", "\n", "net", ".", "resx9_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx9_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.ResNeXt26_COCO_320.AddExtraLayers": [[15, 89], ["ConvBNLayer", "ConvBNGroupLayer", "ConvBNLayer", "ConvBNLayer", "L.Eltwise", "L.ReLU", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx9_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx9_conv1'", ",", "'resx9_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx9_conv2'", ",", "'resx9_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx9_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "512", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx9_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx9_match_conv", ",", "net", ".", "resx9_conv3", ")", "\n", "net", ".", "resx9_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx9_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "256", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "256", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.ConvBNLayer2": [[31, 87], ["model_libs_MobileNetV2.UnpackVariable", "model_libs_MobileNetV2.UnpackVariable", "model_libs_MobileNetV2.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.ConvBNLayer": [[88, 146], ["model_libs_MobileNetV2.UnpackVariable", "model_libs_MobileNetV2.UnpackVariable", "model_libs_MobileNetV2.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'relu{}'", ".", "format", "(", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.DWConvBNLayer": [[147, 211], ["model_libs_MobileNetV2.UnpackVariable", "model_libs_MobileNetV2.UnpackVariable", "model_libs_MobileNetV2.UnpackVariable", "caffe.layers.ConvolutionDepthwise", "caffe.layers.ConvolutionDepthwise", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "DWConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "group", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "#net[conv_name] = L.ConvolutionDepthwise(net[from_layer], num_output=num_output, group=group,", "\n", "#    kernel_size=kernel_h, pad=pad_h, stride=stride_h, **kwargs)", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "from_layer", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "num_output", ",", "group", "=", "group", ",", "pad", "=", "pad_h", ",", "kernel_size", "=", "kernel_h", ",", "stride", "=", "stride_h", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "", "else", ":", "\n", "#net[conv_name] = L.ConvolutionDepthwise(net[from_layer], num_output=num_output, group=group,", "\n", "#    kernel_h=kernel_h, kernel_w=kernel_w, pad_h=pad_h, pad_w=pad_w,", "\n", "#    stride_h=stride_h, stride_w=stride_w, **kwargs)", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "from_layer", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "num_output", ",", "group", "=", "group", ",", "kernel_h", "=", "kernel_h", ",", "\n", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'relu{}'", ".", "format", "(", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.DeconvBNLayer": [[212, 257], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.EltwiseLayer": [[258, 261], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.ResBody": [[263, 321], ["model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.InceptionTower": [[323, 336], ["caffe.layers.Pooling", "param.update", "model_libs_MobileNetV2.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.CreateAnnotatedDataLayer": [[337, 362], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.MobileNetV2Body": [[363, 588], ["model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Eltwise", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "dict", "caffe.layers.Pooling", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "MobileNetV2Body", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Convoution 1", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution 2_1", "\n", "ConvBNLayer", "(", "net", ",", "'conv1'", ",", "'conv2_1/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_1/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv2_1/expand'", ",", "'conv2_1/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "group", "=", "32", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_1/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv2_1/dwise'", ",", "'conv2_1/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_1/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Dpethwise convolution 2_2", "\n", "ConvBNLayer", "(", "net", ",", "'conv2_1/linear'", ",", "'conv2_2/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_2/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv2_2/expand'", ",", "'conv2_2/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "group", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_2/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv2_2/dwise'", ",", "'conv2_2/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "24", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'2_2/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Right branch of depthwise convolution 3_1", "\n", "ConvBNLayer", "(", "net", ",", "'conv2_2/linear'", ",", "'conv3_1/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "144", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_1/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv3_1/expand'", ",", "'conv3_1/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "144", ",", "group", "=", "144", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_1/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv3_1/dwise'", ",", "'conv3_1/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "24", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_1/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_3_1", "=", "L", ".", "Eltwise", "(", "net", "[", "'conv2_2/linear'", "]", ",", "net", "[", "'conv3_1/linear'", "]", ")", "\n", "\n", "# Depthwise convolution 3_2", "\n", "ConvBNLayer", "(", "net", ",", "'block_3_1'", ",", "'conv3_2/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "144", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_2/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv3_2/expand'", ",", "'conv3_2/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "144", ",", "group", "=", "144", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_2/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv3_2/dwise'", ",", "'conv3_2/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'3_2/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Right branch of depthwise convolution 4_1", "\n", "ConvBNLayer", "(", "net", ",", "'conv3_2/linear'", ",", "'conv4_1/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_1/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_1/expand'", ",", "'conv4_1/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "group", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_1/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_1/dwise'", ",", "'conv4_1/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_1/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_4_1", "=", "L", ".", "Eltwise", "(", "net", "[", "'conv3_2/linear'", "]", ",", "net", "[", "'conv4_1/linear'", "]", ")", "\n", "\n", "# Right branch of depthwise convolution 4_2", "\n", "ConvBNLayer", "(", "net", ",", "'block_4_1'", ",", "'conv4_2/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_2/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_2/expand'", ",", "'conv4_2/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "group", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_2/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_2/dwise'", ",", "'conv4_2/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_2/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_4_2", "=", "L", ".", "Eltwise", "(", "net", "[", "'block_4_1'", "]", ",", "net", "[", "'conv4_2/linear'", "]", ")", "\n", "\n", "# Right branch of depthwise convolution 4_3", "\n", "ConvBNLayer", "(", "net", ",", "'block_4_2'", ",", "'conv4_3/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_3/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_3/expand'", ",", "'conv4_3/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "192", ",", "group", "=", "192", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_3/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_3/dwise'", ",", "'conv4_3/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_3/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Right branch of depthwise convolution 4_4", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_3/linear'", ",", "'conv4_4/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_4/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_4/expand'", ",", "'conv4_4/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "group", "=", "384", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_4/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_4/dwise'", ",", "'conv4_4/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_4/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_4_4", "=", "L", ".", "Eltwise", "(", "net", "[", "'conv4_3/linear'", "]", ",", "net", "[", "'conv4_4/linear'", "]", ")", "\n", "\n", "# Right branch of depthwise convolution 4_5", "\n", "ConvBNLayer", "(", "net", ",", "'block_4_4'", ",", "'conv4_5/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_5/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_5/expand'", ",", "'conv4_5/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "group", "=", "384", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_5/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_5/dwise'", ",", "'conv4_5/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_5/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_4_5", "=", "L", ".", "Eltwise", "(", "net", "[", "'block_4_4'", "]", ",", "net", "[", "'conv4_5/linear'", "]", ")", "\n", "\n", "# Right branch of depthwise convolution 4_6", "\n", "ConvBNLayer", "(", "net", ",", "'block_4_5'", ",", "'conv4_6/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_6/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_6/expand'", ",", "'conv4_6/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "group", "=", "384", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_6/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_6/dwise'", ",", "'conv4_6/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_6/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_4_6", "=", "L", ".", "Eltwise", "(", "net", "[", "'block_4_5'", "]", ",", "net", "[", "'conv4_6/linear'", "]", ")", "\n", "\n", "# Depthwise convolution 4_7", "\n", "ConvBNLayer", "(", "net", ",", "'block_4_6'", ",", "'conv4_7/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_7/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv4_7/expand'", ",", "'conv4_7/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "384", ",", "group", "=", "384", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_7/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_7/dwise'", ",", "'conv4_7/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'4_7/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Right branch of depthwise convolution 5_1", "\n", "ConvBNLayer", "(", "net", ",", "'conv4_7/linear'", ",", "'conv5_1/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_1/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_1/expand'", ",", "'conv5_1/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "group", "=", "576", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_1/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_1/dwise'", ",", "'conv5_1/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_1/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_5_1", "=", "L", ".", "Eltwise", "(", "net", "[", "'conv4_7/linear'", "]", ",", "net", "[", "'conv5_1/linear'", "]", ")", "\n", "\n", "# Right branch of depthwise convolution 5_2", "\n", "ConvBNLayer", "(", "net", ",", "'block_5_1'", ",", "'conv5_2/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_2/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_2/expand'", ",", "'conv5_2/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "group", "=", "576", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_2/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_2/dwise'", ",", "'conv5_2/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_2/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_5_2", "=", "L", ".", "Eltwise", "(", "net", "[", "'block_5_1'", "]", ",", "net", "[", "'conv5_2/linear'", "]", ")", "\n", "\n", "# Depthwise convolution 5_3", "\n", "ConvBNLayer", "(", "net", ",", "'block_5_2'", ",", "'conv5_3/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_3/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv5_3/expand'", ",", "'conv5_3/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "group", "=", "576", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_3/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_3/dwise'", ",", "'conv5_3/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "160", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'5_3/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Right branch of depthwise convolution 6_1", "\n", "ConvBNLayer", "(", "net", ",", "'conv5_3/linear'", ",", "'conv6_1/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "960", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_1/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv6_1/expand'", ",", "'conv6_1/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "960", ",", "group", "=", "960", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_1/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv6_1/dwise'", ",", "'conv6_1/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "160", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_1/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_6_1", "=", "L", ".", "Eltwise", "(", "net", "[", "'conv5_3/linear'", "]", ",", "net", "[", "'conv6_1/linear'", "]", ")", "\n", "\n", "# Right branch of depthwise convolution 6_2", "\n", "ConvBNLayer", "(", "net", ",", "'block_6_1'", ",", "'conv6_2/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "960", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_2/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv6_2/expand'", ",", "'conv6_2/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "960", ",", "group", "=", "960", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_2/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv6_2/dwise'", ",", "'conv6_2/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "160", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_2/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "block_6_2", "=", "L", ".", "Eltwise", "(", "net", "[", "'block_6_1'", "]", ",", "net", "[", "'conv6_2/linear'", "]", ")", "\n", "\n", "# Depthwise convolution 6_3", "\n", "ConvBNLayer", "(", "net", ",", "'block_6_2'", ",", "'conv6_3/expand'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "960", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_3/expand'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "DWConvBNLayer", "(", "net", ",", "'conv6_3/expand'", ",", "'conv6_3/dwise'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "960", ",", "group", "=", "960", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_3/dwise'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv6_3/dwise'", ",", "'conv6_3/linear'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "320", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_3/linear'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Convolution 6_4", "\n", "ConvBNLayer", "(", "net", ",", "'conv6_3/linear'", ",", "'conv6_4'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1280", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "'6_4'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'conv6_4'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "global_pooling", "=", "True", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.CreateMultiBoxHead": [[589, 732], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_MobileNetV2.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_MobileNetV2.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_MobileNetV2.CreateRefineDetHead": [[733, 992], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_MobileNetV2.ConvBNLayer2", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_MobileNetV2.ConvBNLayer2", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_MobileNetV2.ConvBNLayer2", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_MobileNetV2.ConvBNLayer2", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_MobileNetV2.ConvBNLayer", "model_libs_MobileNetV2.DWConvBNLayer", "model_libs_MobileNetV2.ConvBNLayer", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "use_relu", "=", "True", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# Inter layer from body to head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "# Expand layer", "\n", "inter_expand", "=", "inter_name", "+", "'/expand'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_expand", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_expand", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Depthwise convolution layer", "\n", "inter_dwise", "=", "inter_name", "+", "'/dwise'", "\n", "DWConvBNLayer", "(", "net", ",", "inter_expand", ",", "inter_dwise", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "group", "=", "576", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_dwise", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Linear layer", "\n", "inter_linear", "=", "inter_name", "+", "'/linear'", "\n", "ConvBNLayer", "(", "net", ",", "inter_dwise", ",", "inter_linear", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_linear", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Bridge of rest of head", "\n", "from_layer", "=", "inter_linear", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# Inter layer from body to head", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "# Expand layer", "\n", "inter_expand", "=", "inter_name", "+", "'/expand'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_expand", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_expand", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Depthwise convolution layer", "\n", "inter_dwise", "=", "inter_name", "+", "'/dwise'", "\n", "DWConvBNLayer", "(", "net", ",", "inter_expand", ",", "inter_dwise", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "576", ",", "group", "=", "576", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_dwise", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Linear layer", "\n", "inter_linear", "=", "inter_name", "+", "'/linear'", "\n", "ConvBNLayer", "(", "net", ",", "inter_dwise", ",", "inter_linear", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "96", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "inter_linear", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "# Bridge of rest of head", "\n", "from_layer", "=", "inter_linear", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "\n", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.check_if_exist": [[9, 11], ["os.path.exists"], "function", ["None"], ["def", "check_if_exist", "(", "path", ")", ":", "\n", "    ", "return", "os", ".", "path", ".", "exists", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.make_if_not_exist": [[12, 15], ["os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "make_if_not_exist", "(", "path", ")", ":", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable": [[16, 30], ["type", "len", "type", "xrange", "xrange", "len", "ret.append", "ret.append"], "function", ["None"], ["", "", "def", "UnpackVariable", "(", "var", ",", "num", ")", ":", "\n", "  ", "assert", "len", ">", "0", "\n", "if", "type", "(", "var", ")", "is", "list", "and", "len", "(", "var", ")", "==", "num", ":", "\n", "    ", "return", "var", "\n", "", "else", ":", "\n", "    ", "ret", "=", "[", "]", "\n", "if", "type", "(", "var", ")", "is", "list", ":", "\n", "      ", "assert", "len", "(", "var", ")", "==", "1", "\n", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", "[", "0", "]", ")", "\n", "", "", "else", ":", "\n", "      ", "for", "i", "in", "xrange", "(", "0", ",", "num", ")", ":", "\n", "        ", "ret", ".", "append", "(", "var", ")", "\n", "", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer": [[31, 87], ["model_libs_Xception.UnpackVariable", "model_libs_Xception.UnpackVariable", "model_libs_Xception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2": [[88, 148], ["model_libs_Xception.UnpackVariable", "model_libs_Xception.UnpackVariable", "model_libs_Xception.UnpackVariable", "caffe.layers.Convolution", "caffe.layers.Convolution", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "ConvBNLayer2", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "#conv_name = '{}{}{}'.format(conv_prefix, out_layer, conv_postfix)", "\n", "", "conv_name", "=", "'{}{}'", ".", "format", "(", "out_layer", ",", "conv_postfix", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_h", ",", "pad", "=", "pad_h", ",", "stride", "=", "stride_h", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "Convolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_h", "=", "kernel_h", ",", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "\n", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "**", "kwargs", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "#bn_name = '{}{}{}'.format(conv_prefix, out_layer, bn_postfix)", "\n", "    ", "bn_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "#sb_name = '{}{}{}'.format(scale_prefix, out_layer, scale_postfix)", "\n", "      ", "sb_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "#bias_name = '{}{}{}'.format(bias_prefix, out_layer, bias_postfix)", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "conv_prefix", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "    ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "conv_prefix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DWConvBNLayer": [[149, 213], ["model_libs_Xception.UnpackVariable", "model_libs_Xception.UnpackVariable", "model_libs_Xception.UnpackVariable", "caffe.layers.ConvolutionDepthwise", "caffe.layers.ConvolutionDepthwise", "net.update", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.UnpackVariable"], ["", "", "def", "DWConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "group", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "dilation", "=", "1", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "conv_prefix", "=", "''", ",", "conv_postfix", "=", "''", ",", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "\n", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "bias_postfix", "=", "'_bias'", ",", "\n", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "# parameters for convolution layer with batchnorm.", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "\n", "", "conv_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "out_layer", ")", "\n", "[", "kernel_h", ",", "kernel_w", "]", "=", "UnpackVariable", "(", "kernel_size", ",", "2", ")", "\n", "[", "pad_h", ",", "pad_w", "]", "=", "UnpackVariable", "(", "pad", ",", "2", ")", "\n", "[", "stride_h", ",", "stride_w", "]", "=", "UnpackVariable", "(", "stride", ",", "2", ")", "\n", "if", "kernel_h", "==", "kernel_w", ":", "\n", "#net[conv_name] = L.ConvolutionDepthwise(net[from_layer], num_output=num_output, group=group,", "\n", "#    kernel_size=kernel_h, pad=pad_h, stride=stride_h, **kwargs)", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "from_layer", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "num_output", ",", "group", "=", "group", ",", "pad", "=", "pad_h", ",", "kernel_size", "=", "kernel_h", ",", "stride", "=", "stride_h", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "", "else", ":", "\n", "#net[conv_name] = L.ConvolutionDepthwise(net[from_layer], num_output=num_output, group=group,", "\n", "#    kernel_h=kernel_h, kernel_w=kernel_w, pad_h=pad_h, pad_w=pad_w,", "\n", "#    stride_h=stride_h, stride_w=stride_w, **kwargs)", "\n", "    ", "net", "[", "conv_name", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "from_layer", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "num_output", ",", "group", "=", "group", ",", "kernel_h", "=", "kernel_h", ",", "\n", "kernel_w", "=", "kernel_w", ",", "pad_h", "=", "pad_h", ",", "pad_w", "=", "pad_w", ",", "stride_h", "=", "stride_h", ",", "stride_w", "=", "stride_w", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "", "if", "dilation", ">", "1", ":", "\n", "    ", "net", ".", "update", "(", "conv_name", ",", "{", "'dilation'", ":", "dilation", "}", ")", "\n", "", "if", "use_bn", ":", "\n", "    ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "      ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "      ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "", "", "if", "use_relu", ":", "\n", "#relu_name = '{}_relu'.format(conv_name)", "\n", "    ", "relu_name", "=", "'relu{}'", ".", "format", "(", "conv_postfix", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "conv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer": [[214, 259], ["caffe.layers.Deconvolution", "caffe.layers.BatchNorm", "caffe.layers.ReLU", "dict", "dict", "dict", "caffe.layers.Scale", "caffe.layers.Bias", "dict", "dict", "dict", "dict", "dict"], "function", ["None"], ["", "", "def", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_bn", ",", "use_relu", ",", "num_output", ",", "\n", "kernel_size", ",", "pad", ",", "stride", ",", "use_scale", "=", "True", ",", "lr_mult", "=", "1", ",", "deconv_prefix", "=", "''", ",", "deconv_postfix", "=", "''", ",", "\n", "bn_prefix", "=", "''", ",", "bn_postfix", "=", "'_bn'", ",", "scale_prefix", "=", "''", ",", "scale_postfix", "=", "'_scale'", ",", "bias_prefix", "=", "''", ",", "\n", "bias_postfix", "=", "'_bias'", ",", "**", "bn_params", ")", ":", "\n", "  ", "if", "use_bn", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "# parameters for scale bias layer after batchnorm.", "\n", "if", "use_scale", ":", "\n", "      ", "sb_kwargs", "=", "{", "\n", "'bias_term'", ":", "True", ",", "\n", "}", "\n", "", "else", ":", "\n", "      ", "bias_kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0.0", ")", ",", "\n", "}", "\n", "", "", "else", ":", "\n", "    ", "kwargs", "=", "{", "\n", "'param'", ":", "[", "\n", "dict", "(", "lr_mult", "=", "lr_mult", ",", "decay_mult", "=", "1", ")", ",", "\n", "dict", "(", "lr_mult", "=", "2", "*", "lr_mult", ",", "decay_mult", "=", "0", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'xavier'", ")", ",", "\n", "'bias_filler'", ":", "dict", "(", "type", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "}", "\n", "", "deconv_name", "=", "'{}{}{}'", ".", "format", "(", "deconv_prefix", ",", "out_layer", ",", "deconv_postfix", ")", "\n", "net", "[", "deconv_name", "]", "=", "L", ".", "Deconvolution", "(", "net", "[", "from_layer", "]", ",", "num_output", "=", "num_output", ",", "\n", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "stride", ",", "**", "kwargs", ")", "\n", "\n", "if", "use_bn", ":", "\n", "      ", "bn_name", "=", "'{}{}{}'", ".", "format", "(", "bn_prefix", ",", "out_layer", ",", "bn_postfix", ")", "\n", "net", "[", "bn_name", "]", "=", "L", ".", "BatchNorm", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "if", "use_scale", ":", "\n", "          ", "sb_name", "=", "'{}{}{}'", ".", "format", "(", "scale_prefix", ",", "out_layer", ",", "scale_postfix", ")", "\n", "net", "[", "sb_name", "]", "=", "L", ".", "Scale", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "sb_kwargs", ")", "\n", "", "else", ":", "\n", "          ", "bias_name", "=", "'{}{}{}'", ".", "format", "(", "bias_prefix", ",", "out_layer", ",", "bias_postfix", ")", "\n", "net", "[", "bias_name", "]", "=", "L", ".", "Bias", "(", "net", "[", "bn_name", "]", ",", "in_place", "=", "True", ",", "**", "bias_kwargs", ")", "\n", "\n", "", "", "if", "use_relu", ":", "\n", "      ", "relu_name", "=", "'{}_relu'", ".", "format", "(", "deconv_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "deconv_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer": [[260, 263], ["caffe.layers.Eltwise"], "function", ["None"], ["", "", "def", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", ":", "\n", "  ", "elt_name", "=", "out_layer", "\n", "net", "[", "elt_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "from_layer", "[", "0", "]", "]", ",", "net", "[", "from_layer", "[", "1", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ResBody": [[265, 323], ["model_libs_Xception.ConvBNLayer", "model_libs_Xception.ConvBNLayer", "caffe.layers.Eltwise", "caffe.layers.ReLU", "model_libs_Xception.ConvBNLayer", "model_libs_Xception.ConvBNLayer", "model_libs_Xception.ConvBNLayer", "int"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "ResBody", "(", "net", ",", "from_layer", ",", "block_name", ",", "out2a", ",", "out2b", ",", "out2c", ",", "stride", ",", "use_branch1", ",", "dilation", "=", "1", ",", "**", "bn_param", ")", ":", "\n", "# ResBody(net, 'pool1', '2a', 64, 64, 256, 1, True)", "\n", "\n", "  ", "conv_prefix", "=", "'res{}_'", ".", "format", "(", "block_name", ")", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn{}_'", ".", "format", "(", "block_name", ")", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale{}_'", ".", "format", "(", "block_name", ")", "\n", "scale_postfix", "=", "''", "\n", "use_scale", "=", "True", "\n", "\n", "if", "use_branch1", ":", "\n", "    ", "branch_name", "=", "'branch1'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch1", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "", "else", ":", "\n", "    ", "branch1", "=", "from_layer", "\n", "\n", "", "branch_name", "=", "'branch2a'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2a", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "stride", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2b'", "\n", "if", "dilation", "==", "1", ":", "\n", "    ", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "else", ":", "\n", "    ", "pad", "=", "int", "(", "(", "3", "+", "(", "dilation", "-", "1", ")", "*", "2", ")", "-", "1", ")", "/", "2", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "num_output", "=", "out2b", ",", "kernel_size", "=", "3", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "dilation", "=", "dilation", ",", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "", "out_name", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "branch_name", "=", "'branch2c'", "\n", "ConvBNLayer", "(", "net", ",", "out_name", ",", "branch_name", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "\n", "num_output", "=", "out2c", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "use_scale", "=", "use_scale", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "\n", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "branch2", "=", "'{}{}'", ".", "format", "(", "conv_prefix", ",", "branch_name", ")", "\n", "\n", "res_name", "=", "'res{}'", ".", "format", "(", "block_name", ")", "\n", "net", "[", "res_name", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "branch1", "]", ",", "net", "[", "branch2", "]", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "res_name", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "res_name", "]", ",", "in_place", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.InceptionTower": [[325, 338], ["caffe.layers.Pooling", "param.update", "model_libs_Xception.ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "InceptionTower", "(", "net", ",", "from_layer", ",", "tower_name", ",", "layer_params", ",", "**", "bn_param", ")", ":", "\n", "  ", "use_scale", "=", "False", "\n", "for", "param", "in", "layer_params", ":", "\n", "    ", "tower_layer", "=", "'{}/{}'", ".", "format", "(", "tower_name", ",", "param", "[", "'name'", "]", ")", "\n", "del", "param", "[", "'name'", "]", "\n", "if", "'pool'", "in", "tower_layer", ":", "\n", "      ", "net", "[", "tower_layer", "]", "=", "L", ".", "Pooling", "(", "net", "[", "from_layer", "]", ",", "**", "param", ")", "\n", "", "else", ":", "\n", "      ", "param", ".", "update", "(", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "tower_layer", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "\n", "use_scale", "=", "use_scale", ",", "**", "param", ")", "\n", "", "from_layer", "=", "tower_layer", "\n", "", "return", "net", "[", "from_layer", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.CreateAnnotatedDataLayer": [[339, 364], ["caffe.layers.AnnotatedData", "annotated_data_param.update", "dict", "dict", "dict", "caffe.proto.caffe_pb2.Phase.Value", "caffe.proto.caffe_pb2.Phase.Value"], "function", ["None"], ["", "def", "CreateAnnotatedDataLayer", "(", "source", ",", "batch_size", "=", "32", ",", "backend", "=", "P", ".", "Data", ".", "LMDB", ",", "\n", "output_label", "=", "True", ",", "train", "=", "True", ",", "label_map_file", "=", "''", ",", "anno_type", "=", "None", ",", "\n", "transform_param", "=", "{", "}", ",", "batch_sampler", "=", "[", "{", "}", "]", ")", ":", "\n", "    ", "if", "train", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TRAIN'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "else", ":", "\n", "        ", "kwargs", "=", "{", "\n", "'include'", ":", "dict", "(", "phase", "=", "caffe_pb2", ".", "Phase", ".", "Value", "(", "'TEST'", ")", ")", ",", "\n", "'transform_param'", ":", "transform_param", ",", "\n", "}", "\n", "", "ntop", "=", "1", "\n", "if", "output_label", ":", "\n", "        ", "ntop", "=", "2", "\n", "", "annotated_data_param", "=", "{", "\n", "'label_map_file'", ":", "label_map_file", ",", "\n", "'batch_sampler'", ":", "batch_sampler", ",", "\n", "}", "\n", "if", "anno_type", "is", "not", "None", ":", "\n", "        ", "annotated_data_param", ".", "update", "(", "{", "'anno_type'", ":", "anno_type", "}", ")", "\n", "", "return", "L", ".", "AnnotatedData", "(", "name", "=", "\"data\"", ",", "annotated_data_param", "=", "annotated_data_param", ",", "\n", "data_param", "=", "dict", "(", "batch_size", "=", "batch_size", ",", "backend", "=", "backend", ",", "source", "=", "source", ")", ",", "\n", "ntop", "=", "ntop", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.XceptionBody": [[365, 661], ["model_libs_Xception.ConvBNLayer", "model_libs_Xception.ConvBNLayer", "model_libs_Xception.ConvBNLayer", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Eltwise", "model_libs_Xception.ConvBNLayer", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Eltwise", "model_libs_Xception.ConvBNLayer", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Eltwise", "model_libs_Xception.ConvBNLayer", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.Pooling", "caffe.layers.Eltwise", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer2", "dict", "caffe.layers.Pooling", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2"], ["", "def", "XceptionBody", "(", "net", ",", "from_layer", ",", "use_final_pool", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# First and second conv", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'conv1'", ",", "'conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Match convolution toward left branch", "\n", "ConvBNLayer", "(", "net", ",", "'conv2'", ",", "'xception1_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution toward right branch", "\n", "net", ".", "xception1_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "conv2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "64", ",", "group", "=", "64", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception1_conv1_1'", ",", "'xception1_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception1_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception1_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception1_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "128", ",", "group", "=", "128", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception1_conv2_1'", ",", "'xception1_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception1_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception1_pool", "=", "L", ".", "Pooling", "(", "net", ".", "xception1_conv2_2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "0", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "# Merge left and right branch by element-wise summation", "\n", "net", ".", "xception1_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception1_match_conv", ",", "net", ".", "xception1_pool", ")", "\n", "\n", "# Match convolution toward left branch", "\n", "ConvBNLayer", "(", "net", ",", "'xception1_elewise'", ",", "'xception2_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution toward right branch", "\n", "net", ".", "xception2_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception1_elewise", ")", "\n", "net", ".", "xception2_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception2_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "128", ",", "group", "=", "128", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception2_conv1_1'", ",", "'xception2_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception2_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception2_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception2_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception2_conv2_1'", ",", "'xception2_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception2_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception2_pool", "=", "L", ".", "Pooling", "(", "net", ".", "xception2_conv2_2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "0", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "# Merge left and right branch by element-wise summation", "\n", "net", ".", "xception2_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception2_match_conv", ",", "net", ".", "xception2_pool", ")", "\n", "\n", "# Match convolution toward left branch", "\n", "ConvBNLayer", "(", "net", ",", "'xception2_elewise'", ",", "'xception3_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception3_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception2_elewise", ")", "\n", "net", ".", "xception3_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception3_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception3_conv1_1'", ",", "'xception3_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception3_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception3_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception3_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception3_conv2_1'", ",", "'xception3_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception3_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception3_pool", "=", "L", ".", "Pooling", "(", "net", ".", "xception3_conv2_2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "0", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "\n", "# Merge left and right branch by element-wise summation", "\n", "net", ".", "xception3_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception3_match_conv", ",", "net", ".", "xception3_pool", ")", "\n", "\n", "net", ".", "xception4_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception3_elewise", ")", "\n", "net", ".", "xception4_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception4_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception4_conv1_1'", ",", "'xception4_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception4_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception4_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception4_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception4_conv2_1'", ",", "'xception4_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception4_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception4_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception4_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception4_conv3_1'", ",", "'xception4_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception4_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception4_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception3_elewise", ",", "net", ".", "xception4_conv3_2", ")", "\n", "\n", "net", ".", "xception5_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception4_elewise", ")", "\n", "net", ".", "xception5_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception5_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception5_conv1_1'", ",", "'xception5_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception5_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception5_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception5_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception5_conv2_1'", ",", "'xception5_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception5_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception5_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception5_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception5_conv3_1'", ",", "'xception5_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception5_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception5_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception4_elewise", ",", "net", ".", "xception5_conv3_2", ")", "\n", "\n", "net", ".", "xception6_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception5_elewise", ")", "\n", "net", ".", "xception6_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception6_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception6_conv1_1'", ",", "'xception6_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception6_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception6_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception6_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception6_conv2_1'", ",", "'xception6_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception6_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception6_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception6_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception6_conv3_1'", ",", "'xception6_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception6_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception6_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception5_elewise", ",", "net", ".", "xception6_conv3_2", ")", "\n", "\n", "net", ".", "xception7_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception6_elewise", ")", "\n", "net", ".", "xception7_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception7_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception7_conv1_1'", ",", "'xception7_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception7_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception7_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception7_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception7_conv2_1'", ",", "'xception7_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception7_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception7_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception7_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception7_conv3_1'", ",", "'xception7_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception7_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception7_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception6_elewise", ",", "net", ".", "xception7_conv3_2", ")", "\n", "\n", "net", ".", "xception8_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception7_elewise", ")", "\n", "net", ".", "xception8_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception8_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception8_conv1_1'", ",", "'xception8_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception8_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception8_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception8_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception8_conv2_1'", ",", "'xception8_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception8_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception8_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception8_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception8_conv3_1'", ",", "'xception8_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception8_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception8_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception7_elewise", ",", "net", ".", "xception8_conv3_2", ")", "\n", "\n", "net", ".", "xception9_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception8_elewise", ")", "\n", "net", ".", "xception9_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception9_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception9_conv1_1'", ",", "'xception9_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception9_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception9_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception9_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception9_conv2_1'", ",", "'xception9_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception9_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception9_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception9_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception9_conv3_1'", ",", "'xception9_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception9_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception9_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception8_elewise", ",", "net", ".", "xception9_conv3_2", ")", "\n", "\n", "net", ".", "xception10_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception9_elewise", ")", "\n", "net", ".", "xception10_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception10_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception10_conv1_1'", ",", "'xception10_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception10_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception10_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception10_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception10_conv2_1'", ",", "'xception10_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception10_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception10_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception10_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception10_conv3_1'", ",", "'xception10_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception10_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception10_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception9_elewise", ",", "net", ".", "xception10_conv3_2", ")", "\n", "\n", "net", ".", "xception11_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception10_elewise", ")", "\n", "net", ".", "xception11_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception11_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception11_conv1_1'", ",", "'xception11_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception11_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception11_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception11_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception11_conv2_1'", ",", "'xception11_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception11_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception11_conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception11_conv2_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception11_conv3_1'", ",", "'xception11_conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception11_conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception11_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception10_elewise", ",", "net", ".", "xception11_conv3_2", ")", "\n", "\n", "ConvBNLayer", "(", "net", ",", "'xception11_elewise'", ",", "'xception12_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception12_relu", "=", "L", ".", "ReLU", "(", "net", ".", "xception11_elewise", ")", "\n", "net", ".", "xception12_conv1_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception12_relu", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception12_conv1_1'", ",", "'xception12_conv1_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "728", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception12_conv1'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception12_conv2_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception12_conv1_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "728", ",", "group", "=", "728", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'xception12_conv2_1'", ",", "'xception12_conv2_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "1024", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'xception12_conv2'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "xception12_pool", "=", "L", ".", "Pooling", "(", "net", ".", "xception12_conv2_2", ",", "pool", "=", "P", ".", "Pooling", ".", "MAX", ",", "pad", "=", "0", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "net", ".", "xception12_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "xception12_match_conv", ",", "net", ".", "xception12_pool", ")", "\n", "\n", "net", ".", "conv3_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "xception12_elewise", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "1024", ",", "group", "=", "1024", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv3_1'", ",", "'conv3_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "1536", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv3'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "net", ".", "conv4_1", "=", "L", ".", "ConvolutionDepthwise", "(", "net", ".", "conv3_2", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "1536", ",", "group", "=", "1536", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'conv4_1'", ",", "'conv4_2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "2048", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "'conv4'", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "if", "use_final_pool", ":", "\n", "      ", "net", ".", "final_pool", "=", "L", ".", "Pooling", "(", "net", ".", "conv4_2", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "global_pooling", "=", "True", ")", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.CreateMultiBoxHead": [[662, 805], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "model_libs_Xception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_Xception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "type", "len", "len", "len", "net.update", "net.update", "net.update", "model_libs_Xception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "objectness_layers.append", "caffe.layers.Normalize", "model_libs_Xception.ConvBNLayer", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "len", "len", "len", "len", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateMultiBoxHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "\n", "use_objectness", "=", "False", ",", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "\n", "use_scale", "=", "True", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "prefix", "=", "''", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "objectness_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "True", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "inter_layer_depth", "[", "i", "]", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "from_layer", "=", "inter_name", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", ";", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Create objectness prediction layer.", "\n", "if", "use_objectness", ":", "\n", "            ", "name", "=", "\"{}_mbox_objectness\"", ".", "format", "(", "from_layer", ")", "\n", "num_obj_output", "=", "num_priors_per_location", "*", "2", ";", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_obj_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "objectness_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "if", "use_objectness", ":", "\n", "        ", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_objectness\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "objectness_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "", "return", "mbox_layers", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.CreateRefineDetHead": [[808, 1094], ["net.keys", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "range", "caffe.layers.Concat", "mbox_layers.append", "caffe.layers.Concat", "mbox_layers.append", "len", "len", "dict", "dict", "model_libs_Xception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_Xception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "caffe.layers.PriorBox", "priorbox_layers.append", "model_libs_Xception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "loc_layers.append", "model_libs_Xception.ConvBNLayer", "caffe.layers.Permute", "caffe.layers.Flatten", "conf_layers.append", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "type", "len", "len", "len", "net.update", "net.update", "net.update", "type", "len", "len", "caffe.layers.Normalize", "model_libs_Xception.ConvBNLayer", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer", "caffe.layers.Eltwise", "type", "type", "len", "len", "len", "len", "net.update", "net.update", "caffe.layers.Normalize", "model_libs_Xception.ConvBNLayer", "caffe.layers.ReLU", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer", "caffe.layers.ConvolutionDepthwise", "model_libs_Xception.ConvBNLayer", "caffe.layers.Eltwise", "type", "type", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "len", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict", "dict"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["", "def", "CreateRefineDetHead", "(", "net", ",", "data_layer", "=", "\"data\"", ",", "num_classes", "=", "[", "]", ",", "from_layers", "=", "[", "]", ",", "from_layers2", "=", "[", "]", ",", "\n", "normalizations", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "lr_mult", "=", "1", ",", "min_sizes", "=", "[", "]", ",", "max_sizes", "=", "[", "]", ",", "prior_variance", "=", "[", "0.1", "]", ",", "\n", "aspect_ratios", "=", "[", "]", ",", "steps", "=", "[", "]", ",", "img_height", "=", "0", ",", "img_width", "=", "0", ",", "share_location", "=", "True", ",", "\n", "flip", "=", "True", ",", "clip", "=", "True", ",", "offset", "=", "0.5", ",", "inter_layer_depth", "=", "[", "]", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "\n", "conf_postfix", "=", "''", ",", "loc_postfix", "=", "''", ",", "**", "bn_param", ")", ":", "\n", "    ", "assert", "num_classes", ",", "\"must provide num_classes\"", "\n", "assert", "num_classes", ">", "0", ",", "\"num_classes must be positive number\"", "\n", "if", "normalizations", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "normalizations", ")", ",", "\"from_layers and normalizations should have same length\"", "\n", "", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "min_sizes", ")", ",", "\"from_layers and min_sizes should have same length\"", "\n", "if", "max_sizes", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "max_sizes", ")", ",", "\"from_layers and max_sizes should have same length\"", "\n", "", "if", "aspect_ratios", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "aspect_ratios", ")", ",", "\"from_layers and aspect_ratios should have same length\"", "\n", "", "if", "steps", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "steps", ")", ",", "\"from_layers and steps should have same length\"", "\n", "", "net_layers", "=", "net", ".", "keys", "(", ")", "\n", "assert", "data_layer", "in", "net_layers", ",", "\"data_layer is not in net's layers\"", "\n", "if", "inter_layer_depth", ":", "\n", "        ", "assert", "len", "(", "from_layers", ")", "==", "len", "(", "inter_layer_depth", ")", ",", "\"from_layers and inter_layer_depth should have same length\"", "\n", "\n", "", "use_relu", "=", "True", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "'bn'", "\n", "bn_postfix", "=", "''", "\n", "scale_prefix", "=", "'scale'", "\n", "scale_postfix", "=", "''", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "prefix", "=", "'arm'", "\n", "num_classes_rpn", "=", "2", "\n", "num", "=", "len", "(", "from_layers", ")", "\n", "priorbox_layers", "=", "[", "]", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "\n", "# Xception bridge", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "\n", "# Matched convolution toward left branch of intermediate layers", "\n", "inter_match", "=", "inter_name", "+", "'_match'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_match", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution toard right branch of intermediate layers", "\n", "inter_relu", "=", "inter_name", "+", "'_relu'", "\n", "net", "[", "inter_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "from_layer", "]", ")", "\n", "inter_conv1_1", "=", "inter_name", "+", "'_conv1_1'", "\n", "net", "[", "inter_conv1_1", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "inter_relu", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "inter_conv1_2", "=", "inter_name", "+", "'_conv1_2'", "\n", "ConvBNLayer", "(", "net", ",", "inter_conv1_1", ",", "inter_conv1_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_conv2_1", "=", "inter_name", "+", "'_conv2_1'", "\n", "net", "[", "inter_conv2_1", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "inter_conv1_2", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "inter_conv2_2", "=", "inter_name", "+", "'_conv2_2'", "\n", "ConvBNLayer", "(", "net", ",", "inter_conv2_1", ",", "inter_conv2_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Element wise summation", "\n", "inter_elewise", "=", "inter_name", "+", "'_eltwise'", "\n", "net", "[", "inter_elewise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "inter_match", "]", ",", "net", "[", "inter_conv2_2", "]", ")", "\n", "from_layer", "=", "inter_elewise", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "", "step", "=", "[", "]", "\n", "if", "len", "(", "steps", ")", ">", "i", ":", "\n", "            ", "step", "=", "steps", "[", "i", "]", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes_rpn", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes_rpn", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create prior generation layer.", "\n", "name", "=", "\"{}_mbox_priorbox\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "PriorBox", "(", "net", "[", "from_layer", "]", ",", "net", "[", "data_layer", "]", ",", "min_size", "=", "min_size", ",", "\n", "clip", "=", "clip", ",", "variance", "=", "prior_variance", ",", "offset", "=", "offset", ")", "\n", "\n", "if", "max_size", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'max_size'", ":", "max_size", "}", ")", "\n", "", "if", "aspect_ratio", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'aspect_ratio'", ":", "aspect_ratio", ",", "'flip'", ":", "flip", "}", ")", "\n", "", "if", "step", ":", "\n", "            ", "net", ".", "update", "(", "name", ",", "{", "'step'", ":", "step", "}", ")", "\n", "", "if", "img_height", "!=", "0", "and", "img_width", "!=", "0", ":", "\n", "            ", "if", "img_height", "==", "img_width", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_size'", ":", "img_height", "}", ")", "\n", "", "else", ":", "\n", "                ", "net", ".", "update", "(", "name", ",", "{", "'img_h'", ":", "img_height", ",", "'img_w'", ":", "img_width", "}", ")", "\n", "", "", "priorbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "mbox_layers", "=", "[", "]", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_priorbox\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "priorbox_layers", ",", "axis", "=", "2", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "prefix", "=", "'odm'", "\n", "num", "=", "len", "(", "from_layers2", ")", "\n", "loc_layers", "=", "[", "]", "\n", "conf_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "0", ",", "num", ")", ":", "\n", "        ", "from_layer", "=", "from_layers2", "[", "i", "]", "\n", "\n", "# Get the normalize value.", "\n", "if", "normalizations", ":", "\n", "            ", "if", "normalizations", "[", "i", "]", "!=", "-", "1", ":", "\n", "                ", "norm_name", "=", "\"{}_norm\"", ".", "format", "(", "from_layer", ")", "\n", "net", "[", "norm_name", "]", "=", "L", ".", "Normalize", "(", "net", "[", "from_layer", "]", ",", "scale_filler", "=", "dict", "(", "type", "=", "\"constant\"", ",", "value", "=", "normalizations", "[", "i", "]", ")", ",", "\n", "across_spatial", "=", "False", ",", "channel_shared", "=", "False", ")", "\n", "from_layer", "=", "norm_name", "\n", "\n", "# Add intermediate layers.", "\n", "", "", "if", "inter_layer_depth", ":", "\n", "            ", "if", "inter_layer_depth", "[", "i", "]", ">", "0", ":", "\n", "# Xception bridge", "\n", "                ", "inter_name", "=", "\"{}_inter\"", ".", "format", "(", "from_layer", ")", "\n", "\n", "# Matched convolution toward left branch of intermediate layers", "\n", "inter_match", "=", "inter_name", "+", "'_match'", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "inter_match", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Depthwise convolution toard right branch of intermediate layers", "\n", "inter_relu", "=", "inter_name", "+", "'_relu'", "\n", "net", "[", "inter_relu", "]", "=", "L", ".", "ReLU", "(", "net", "[", "from_layer", "]", ")", "\n", "inter_conv1_1", "=", "inter_name", "+", "'_conv1_1'", "\n", "net", "[", "inter_conv1_1", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "inter_relu", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "inter_conv1_2", "=", "inter_name", "+", "'_conv1_2'", "\n", "ConvBNLayer", "(", "net", ",", "inter_conv1_1", ",", "inter_conv1_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "inter_conv2_1", "=", "inter_name", "+", "'_conv2_1'", "\n", "net", "[", "inter_conv2_1", "]", "=", "L", ".", "ConvolutionDepthwise", "(", "net", "[", "inter_conv1_2", "]", ",", "\n", "convolution_param", "=", "dict", "(", "num_output", "=", "256", ",", "group", "=", "256", ",", "pad", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "bias_term", "=", "False", ",", "\n", "weight_filler", "=", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ")", ",", "param", "=", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ")", "\n", "inter_conv2_2", "=", "inter_name", "+", "'_conv2_2'", "\n", "ConvBNLayer", "(", "net", ",", "inter_conv2_1", ",", "inter_conv2_2", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "\n", "# Element wise summation", "\n", "inter_elewise", "=", "inter_name", "+", "'_eltwise'", "\n", "net", "[", "inter_elewise", "]", "=", "L", ".", "Eltwise", "(", "net", "[", "inter_match", "]", ",", "net", "[", "inter_conv2_2", "]", ")", "\n", "from_layer", "=", "inter_elewise", "\n", "\n", "# Estimate number of priors per location given provided parameters.", "\n", "", "", "min_size", "=", "min_sizes", "[", "i", "]", "\n", "if", "type", "(", "min_size", ")", "is", "not", "list", ":", "\n", "            ", "min_size", "=", "[", "min_size", "]", "\n", "", "aspect_ratio", "=", "[", "]", "\n", "if", "len", "(", "aspect_ratios", ")", ">", "i", ":", "\n", "            ", "aspect_ratio", "=", "aspect_ratios", "[", "i", "]", "\n", "if", "type", "(", "aspect_ratio", ")", "is", "not", "list", ":", "\n", "                ", "aspect_ratio", "=", "[", "aspect_ratio", "]", "\n", "", "", "max_size", "=", "[", "]", "\n", "if", "len", "(", "max_sizes", ")", ">", "i", ":", "\n", "            ", "max_size", "=", "max_sizes", "[", "i", "]", "\n", "if", "type", "(", "max_size", ")", "is", "not", "list", ":", "\n", "                ", "max_size", "=", "[", "max_size", "]", "\n", "", "if", "max_size", ":", "\n", "                ", "assert", "len", "(", "max_size", ")", "==", "len", "(", "min_size", ")", ",", "\"max_size and min_size should have same length.\"", "\n", "", "", "if", "max_size", ":", "\n", "            ", "num_priors_per_location", "=", "(", "2", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "else", ":", "\n", "            ", "num_priors_per_location", "=", "(", "1", "+", "len", "(", "aspect_ratio", ")", ")", "*", "len", "(", "min_size", ")", "\n", "", "if", "flip", ":", "\n", "            ", "num_priors_per_location", "+=", "len", "(", "aspect_ratio", ")", "*", "len", "(", "min_size", ")", "\n", "\n", "# Create location prediction layer.", "\n", "", "name", "=", "\"{}_mbox_loc{}\"", ".", "format", "(", "from_layer", ",", "loc_postfix", ")", "\n", "num_loc_output", "=", "num_priors_per_location", "*", "4", "\n", "if", "not", "share_location", ":", "\n", "            ", "num_loc_output", "*=", "num_classes", "\n", "", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_loc_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "loc_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "# Create confidence prediction layer.", "\n", "name", "=", "\"{}_mbox_conf{}\"", ".", "format", "(", "from_layer", ",", "conf_postfix", ")", "\n", "num_conf_output", "=", "num_priors_per_location", "*", "num_classes", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "name", ",", "use_bn", "=", "use_batchnorm", ",", "use_relu", "=", "False", ",", "lr_mult", "=", "lr_mult", ",", "\n", "num_output", "=", "num_conf_output", ",", "kernel_size", "=", "kernel_size", ",", "pad", "=", "pad", ",", "stride", "=", "1", ",", "**", "bn_param", ")", "\n", "permute_name", "=", "\"{}_perm\"", ".", "format", "(", "name", ")", "\n", "net", "[", "permute_name", "]", "=", "L", ".", "Permute", "(", "net", "[", "name", "]", ",", "order", "=", "[", "0", ",", "2", ",", "3", ",", "1", "]", ")", "\n", "flatten_name", "=", "\"{}_flat\"", ".", "format", "(", "name", ")", "\n", "net", "[", "flatten_name", "]", "=", "L", ".", "Flatten", "(", "net", "[", "permute_name", "]", ",", "axis", "=", "1", ")", "\n", "conf_layers", ".", "append", "(", "net", "[", "flatten_name", "]", ")", "\n", "\n", "\n", "# Concatenate priorbox, loc, and conf layers.", "\n", "", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_loc\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "loc_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "name", "=", "'{}{}'", ".", "format", "(", "prefix", ",", "\"_conf\"", ")", "\n", "net", "[", "name", "]", "=", "L", ".", "Concat", "(", "*", "conf_layers", ",", "axis", "=", "1", ")", "\n", "mbox_layers", ".", "append", "(", "net", "[", "name", "]", ")", "\n", "\n", "return", "mbox_layers", "\n", "", ""]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.ResNeXt50_COCO_320.AddExtraLayers": [[15, 89], ["ConvBNLayer", "ConvBNGroupLayer", "ConvBNLayer", "ConvBNLayer", "L.Eltwise", "L.ReLU", "arm_source_layers.reverse", "enumerate", "dict", "net.keys", "ConvBNLayer", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_SEBNInception.ConvBNGroupLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'_bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'_scale'", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx17_conv1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNGroupLayer", "(", "net", ",", "'resx17_conv1'", ",", "'resx17_conv2'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "128", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "group", "=", "32", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "'resx17_conv2'", ",", "'resx17_conv3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "'resx17_match_conv'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "False", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "\n", "conv_prefix", "=", "conv_prefix", ",", "conv_postfix", "=", "conv_postfix", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "\n", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", ".", "resx17_elewise", "=", "L", ".", "Eltwise", "(", "net", ".", "resx17_match_conv", ",", "net", ".", "resx17_conv3", ")", "\n", "net", ".", "resx17_elewise_relu", "=", "L", ".", "ReLU", "(", "net", ".", "resx17_elewise", ",", "in_place", "=", "True", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.SEBNInception_COCO_320.AddExtraLayers": [[15, 104], ["ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "ConvBNLayer2", "L.Pooling", "ConvBNLayer2", "L.Concat", "L.Pooling", "L.Convolution", "L.ReLU", "L.Convolution", "L.Sigmoid", "L.Reshape", "L.Scale", "arm_source_layers.reverse", "enumerate", "dict", "dict", "net.keys", "ConvBNLayer", "dict", "dict", "dict", "ConvBNLayer", "ConvBNLayer", "ConvBNLayer", "DeconvBNLayer", "EltwiseLayer", "L.ReLU", "ConvBNLayer"], "function", ["home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer2", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.DeconvBNLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.EltwiseLayer", "home.repos.pwc.inspect_result.mkchoi-0323_modified_refinedet.heads.model_libs_Xception.ConvBNLayer"], ["def", "AddExtraLayers", "(", "net", ",", "arm_source_layers", "=", "[", "]", ",", "use_batchnorm", "=", "True", ",", "**", "bn_param", ")", ":", "\n", "    ", "use_relu", "=", "True", "\n", "\n", "conv_prefix", "=", "''", "\n", "conv_postfix", "=", "''", "\n", "bn_prefix", "=", "''", "\n", "bn_postfix", "=", "'/bn'", "\n", "scale_prefix", "=", "''", "\n", "scale_postfix", "=", "'/bn/scale'", "\n", "\n", "kwargs", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "'bias_term'", ":", "False", ",", "\n", "}", "\n", "kwargs2", "=", "{", "\n", "'param'", ":", "[", "dict", "(", "lr_mult", "=", "1", ",", "decay_mult", "=", "1", ")", "]", ",", "\n", "'weight_filler'", ":", "dict", "(", "type", "=", "'gaussian'", ",", "std", "=", "0.01", ")", ",", "\n", "}", "\n", "kwargs_rs", "=", "{", "\n", "#'shape': [dict(dim=0, dim=0)],", "\n", "'shape'", ":", "[", "dict", "(", "dim", "=", "0", ")", "]", ",", "\n", "}", "\n", "kwargs_sb", "=", "{", "\n", "'axis'", ":", "0", ",", "\n", "'bias_term'", ":", "False", "\n", "}", "\n", "\n", "# Add additional convolutional layers.", "\n", "# 320/32: 10 x 10", "\n", "last_layer", "=", "net", ".", "keys", "(", ")", "[", "-", "1", "]", "\n", "from_layer", "=", "last_layer", "\n", "\n", "# 320/64: 5 x 5", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b_scale'", ",", "'inception_6/1x1'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_1x1'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b_scale'", ",", "'inception_6/3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/3x3_reduce'", ",", "'inception_6/3x3'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_3x3'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_5b_scale'", ",", "'inception_6/double3x3_reduce'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "64", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "1", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_double3x3_reduce'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/double3x3_reduce'", ",", "'inception_6/double3x3a'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_double3x3a'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/double3x3a'", ",", "'inception_6/double3x3b'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "96", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_double3x3b'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_6/pool'", "]", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_5b_scale'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "kernel_size", "=", "3", ",", "pad", "=", "1", ",", "stride", "=", "1", ")", "\n", "ConvBNLayer2", "(", "net", ",", "'inception_6/pool'", ",", "'inception_6/pool_proj'", ",", "use_bn", "=", "True", ",", "use_relu", "=", "True", ",", "num_output", "=", "32", ",", "kernel_size", "=", "1", ",", "pad", "=", "0", ",", "stride", "=", "2", ",", "conv_prefix", "=", "'inception_6'", ",", "conv_postfix", "=", "'_pool_proj'", ",", "bn_prefix", "=", "bn_prefix", ",", "bn_postfix", "=", "bn_postfix", ",", "scale_prefix", "=", "scale_prefix", ",", "scale_postfix", "=", "scale_postfix", ",", "**", "bn_param", ")", "\n", "net", "[", "'inception_6/concat'", "]", "=", "L", ".", "Concat", "(", "net", "[", "'inception_6/1x1'", "]", ",", "net", "[", "'inception_6/3x3'", "]", ",", "net", "[", "'inception_6/double3x3b'", "]", ",", "net", "[", "'inception_6/pool_proj'", "]", ")", "\n", "net", ".", "inception_6_global_pool", "=", "L", ".", "Pooling", "(", "net", "[", "'inception_6/concat'", "]", ",", "pool", "=", "P", ".", "Pooling", ".", "AVE", ",", "engine", "=", "P", ".", "Pooling", ".", "CAFFE", ",", "global_pooling", "=", "True", ")", "\n", "net", ".", "inception_6_1x1_down", "=", "L", ".", "Convolution", "(", "net", ".", "inception_6_global_pool", ",", "num_output", "=", "16", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", "[", "'inception_6_1x1_down/relu'", "]", "=", "L", ".", "ReLU", "(", "net", ".", "inception_6_1x1_down", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_6_1x1_up", "=", "L", ".", "Convolution", "(", "net", ".", "inception_6_1x1_down", ",", "num_output", "=", "256", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "**", "kwargs2", ")", "\n", "net", ".", "inception_6_prob", "=", "L", ".", "Sigmoid", "(", "net", ".", "inception_6_1x1_up", ",", "in_place", "=", "True", ")", "\n", "net", ".", "inception_6_prob_reshape", "=", "L", ".", "Reshape", "(", "net", ".", "inception_6_1x1_up", ",", "reshape_param", "=", "{", "'shape'", ":", "{", "'dim'", ":", "[", "0", ",", "0", "]", "}", "}", ")", "\n", "net", ".", "inception_6_scale", "=", "L", ".", "Scale", "(", "net", "[", "'inception_6/concat'", "]", ",", "net", ".", "inception_6_prob_reshape", ",", "**", "kwargs_sb", ")", "\n", "\n", "arm_source_layers", ".", "reverse", "(", ")", "\n", "num_p", "=", "6", "\n", "for", "index", ",", "layer", "in", "enumerate", "(", "arm_source_layers", ")", ":", "\n", "        ", "from_layer", "=", "layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "1", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "if", "num_p", "==", "6", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "", "else", ":", "\n", "            ", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "\n", "from_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "out_layer", "=", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "\n", "DeconvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "False", ",", "128", ",", "2", ",", "0", ",", "2", ")", "\n", "\n", "from_layer", "=", "[", "\"TL{}_{}\"", ".", "format", "(", "num_p", ",", "2", ")", ",", "\"P{}-up\"", ".", "format", "(", "num_p", "+", "1", ")", "]", "\n", "out_layer", "=", "\"Elt{}\"", ".", "format", "(", "num_p", ")", "\n", "EltwiseLayer", "(", "net", ",", "from_layer", ",", "out_layer", ")", "\n", "relu_name", "=", "'{}_relu'", ".", "format", "(", "out_layer", ")", "\n", "net", "[", "relu_name", "]", "=", "L", ".", "ReLU", "(", "net", "[", "out_layer", "]", ",", "in_place", "=", "True", ")", "\n", "out_layer", "=", "relu_name", "\n", "\n", "from_layer", "=", "out_layer", "\n", "out_layer", "=", "\"P{}\"", ".", "format", "(", "num_p", ")", "\n", "ConvBNLayer", "(", "net", ",", "from_layer", ",", "out_layer", ",", "use_batchnorm", ",", "use_relu", ",", "128", ",", "3", ",", "1", ",", "1", ")", "\n", "", "num_p", "=", "num_p", "-", "1", "\n", "\n", "", "return", "net", "\n", "\n"]]}