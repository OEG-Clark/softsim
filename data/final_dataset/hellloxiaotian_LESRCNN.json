{"home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.parse_args": [[18, 30], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.parse_args"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "parser", ".", "add_argument", "(", "\"--model\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_path\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--group\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "parser", ".", "add_argument", "(", "\"--sample_dir\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--test_data_dir\"", ",", "type", "=", "str", ",", "default", "=", "\"dataset/Urban100\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--cuda\"", ",", "action", "=", "\"store_true\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--scale\"", ",", "type", "=", "int", ",", "default", "=", "4", ")", "\n", "parser", ".", "add_argument", "(", "\"--shave\"", ",", "type", "=", "int", ",", "default", "=", "20", ")", "\n", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.save_image": [[32, 37], ["tensor.cpu.cpu", "tensor.cpu.mul().clamp().byte().permute().numpy", "PIL.Image.fromarray", "Image.fromarray.save", "tensor.cpu.mul().clamp().byte().permute", "tensor.cpu.mul().clamp().byte", "tensor.cpu.mul().clamp", "tensor.cpu.mul"], "function", ["None"], ["", "def", "save_image", "(", "tensor", ",", "filename", ")", ":", "\n", "    ", "tensor", "=", "tensor", ".", "cpu", "(", ")", "\n", "ndarr", "=", "tensor", ".", "mul", "(", "255", ")", ".", "clamp", "(", "0", ",", "255", ")", ".", "byte", "(", ")", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "numpy", "(", ")", "\n", "im", "=", "Image", ".", "fromarray", "(", "ndarr", ")", "\n", "im", ".", "save", "(", "filename", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.psnr": [[38, 48], ["tcw_sample.psnr.im2double"], "function", ["None"], ["", "def", "psnr", "(", "im1", ",", "im2", ")", ":", "#tcw201904101621", "\n", "    ", "def", "im2double", "(", "im", ")", ":", "\n", "        ", "min_val", ",", "max_val", "=", "0", ",", "255", "\n", "out", "=", "(", "im", ".", "astype", "(", "np", ".", "float64", ")", "-", "min_val", ")", "/", "(", "max_val", "-", "min_val", ")", "\n", "return", "out", "\n", "\n", "", "im1", "=", "im2double", "(", "im1", ")", "\n", "im2", "=", "im2double", "(", "im2", ")", "\n", "psnr", "=", "measure", ".", "compare_psnr", "(", "im1", ",", "im2", ",", "data_range", "=", "1", ")", "\n", "return", "psnr", "\n", "#tcw20190413043", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.calculate_ssim": [[49, 72], ["ValueError", "tcw_sample.ssim", "ValueError", "range", "numpy.array().mean", "ssims.append", "tcw_sample.ssim", "tcw_sample.ssim", "numpy.array", "numpy.squeeze", "numpy.squeeze"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.ssim", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.ssim", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.ssim"], ["", "def", "calculate_ssim", "(", "img1", ",", "img2", ",", "border", "=", "0", ")", ":", "\n", "    ", "'''calculate SSIM\n    the same outputs as MATLAB's\n    img1, img2: [0, 255]\n    '''", "\n", "if", "not", "img1", ".", "shape", "==", "img2", ".", "shape", ":", "\n", "        ", "raise", "ValueError", "(", "'Input images must have the same dimensions.'", ")", "\n", "", "h", ",", "w", "=", "img1", ".", "shape", "[", ":", "2", "]", "\n", "img1", "=", "img1", "[", "border", ":", "h", "-", "border", ",", "border", ":", "w", "-", "border", "]", "\n", "img2", "=", "img2", "[", "border", ":", "h", "-", "border", ",", "border", ":", "w", "-", "border", "]", "\n", "\n", "if", "img1", ".", "ndim", "==", "2", ":", "\n", "        ", "return", "ssim", "(", "img1", ",", "img2", ")", "\n", "", "elif", "img1", ".", "ndim", "==", "3", ":", "\n", "        ", "if", "img1", ".", "shape", "[", "2", "]", "==", "3", ":", "\n", "            ", "ssims", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "3", ")", ":", "\n", "                ", "ssims", ".", "append", "(", "ssim", "(", "img1", ",", "img2", ")", ")", "\n", "", "return", "np", ".", "array", "(", "ssims", ")", ".", "mean", "(", ")", "\n", "", "elif", "img1", ".", "shape", "[", "2", "]", "==", "1", ":", "\n", "            ", "return", "ssim", "(", "np", ".", "squeeze", "(", "img1", ")", ",", "np", ".", "squeeze", "(", "img2", ")", ")", "\n", "", "", "else", ":", "\n", "        ", "raise", "ValueError", "(", "'Wrong input image dimensions.'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.ssim": [[73, 94], ["img1.astype.astype", "img2.astype.astype", "cv2.getGaussianKernel", "numpy.outer", "ssim_map.mean", "cv2.getGaussianKernel.transpose", "cv2.filter2D", "cv2.filter2D", "cv2.filter2D", "cv2.filter2D", "cv2.filter2D"], "function", ["None"], ["", "", "def", "ssim", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "C1", "=", "(", "0.01", "*", "255", ")", "**", "2", "\n", "C2", "=", "(", "0.03", "*", "255", ")", "**", "2", "\n", "\n", "img1", "=", "img1", ".", "astype", "(", "np", ".", "float64", ")", "\n", "img2", "=", "img2", ".", "astype", "(", "np", ".", "float64", ")", "\n", "kernel", "=", "cv2", ".", "getGaussianKernel", "(", "11", ",", "1.5", ")", "\n", "window", "=", "np", ".", "outer", "(", "kernel", ",", "kernel", ".", "transpose", "(", ")", ")", "\n", "\n", "mu1", "=", "cv2", ".", "filter2D", "(", "img1", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "# valid", "\n", "mu2", "=", "cv2", ".", "filter2D", "(", "img2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "\n", "mu1_sq", "=", "mu1", "**", "2", "\n", "mu2_sq", "=", "mu2", "**", "2", "\n", "mu1_mu2", "=", "mu1", "*", "mu2", "\n", "sigma1_sq", "=", "cv2", ".", "filter2D", "(", "img1", "**", "2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "-", "mu1_sq", "\n", "sigma2_sq", "=", "cv2", ".", "filter2D", "(", "img2", "**", "2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "-", "mu2_sq", "\n", "sigma12", "=", "cv2", ".", "filter2D", "(", "img1", "*", "img2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "-", "mu1_mu2", "\n", "\n", "ssim_map", "=", "(", "(", "2", "*", "mu1_mu2", "+", "C1", ")", "*", "(", "2", "*", "sigma12", "+", "C2", ")", ")", "/", "(", "(", "mu1_sq", "+", "mu2_sq", "+", "C1", ")", "*", "\n", "(", "sigma1_sq", "+", "sigma2_sq", "+", "C2", ")", ")", "\n", "return", "ssim_map", ".", "mean", "(", ")", "\n", "", "def", "rgb2ycbcr", "(", "img", ",", "only_y", "=", "True", ")", ":", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.rgb2ycbcr": [[94, 110], ["img.astype", "rlt.round.astype", "rlt.round.round", "numpy.dot", "numpy.matmul"], "function", ["None"], ["", "def", "rgb2ycbcr", "(", "img", ",", "only_y", "=", "True", ")", ":", "\n", "    ", "in_img_type", "=", "img", ".", "dtype", "\n", "img", ".", "astype", "(", "np", ".", "float32", ")", "\n", "if", "in_img_type", "!=", "np", ".", "uint8", ":", "\n", "        ", "img", "*=", "255.", "\n", "# convert", "\n", "", "if", "only_y", ":", "\n", "        ", "rlt", "=", "np", ".", "dot", "(", "img", ",", "[", "65.481", ",", "128.553", ",", "24.966", "]", ")", "/", "255.0", "+", "16.0", "\n", "", "else", ":", "\n", "        ", "rlt", "=", "np", ".", "matmul", "(", "img", ",", "[", "[", "65.481", ",", "-", "37.797", ",", "112.0", "]", ",", "[", "128.553", ",", "-", "74.203", ",", "-", "93.786", "]", ",", "\n", "[", "24.966", ",", "112.0", ",", "-", "18.214", "]", "]", ")", "/", "255.0", "+", "[", "16", ",", "128", ",", "128", "]", "\n", "", "if", "in_img_type", "==", "np", ".", "uint8", ":", "\n", "        ", "rlt", "=", "rlt", ".", "round", "(", ")", "\n", "", "else", ":", "\n", "        ", "rlt", "/=", "255.", "\n", "", "return", "rlt", ".", "astype", "(", "in_img_type", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.sample": [[111, 188], ["enumerate", "print", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "tcw_sample.save_image", "tcw_sample.save_image", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp().byte().permute().numpy", "net().detach().squeeze.cpu().mul().clamp().byte().permute().numpy", "tcw_sample.rgb2ycbcr", "tcw_sample.rgb2ycbcr", "time.time", "torch.tensor", "torch.tensor", "lr_patch[].copy_", "lr_patch[].copy_", "lr_patch[].copy_", "lr_patch[].copy_", "lr_patch.to.to", "net().detach", "torch.tensor().to", "torch.tensor().to", "result[].copy_", "result[].copy_", "result[].copy_", "result[].copy_", "time.time", "time.time", "lr.squeeze.unsqueeze().to", "net().detach().squeeze", "lr.squeeze.squeeze", "time.time", "[].split", "os.path.exists", "os.makedirs", "os.path.exists", "os.makedirs", "tcw_sample.psnr", "len", "tcw_sample.calculate_ssim", "len", "lr.squeeze.size", "int", "int", "cfg.test_data_dir.split", "cfg.test_data_dir.split", "name.replace", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp().byte().permute", "net().detach().squeeze.cpu().mul().clamp().byte().permute", "net", "torch.tensor", "torch.tensor", "lr.squeeze.unsqueeze", "net().detach", "cfg.ckpt_path.split", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp().byte", "net().detach().squeeze.cpu().mul().clamp().byte", "net", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp", "net().detach().squeeze.cpu().mul().clamp", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul", "net().detach().squeeze.cpu().mul", "hr.cpu().mul().clamp().byte().permute().numpy.cpu", "net().detach().squeeze.cpu"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.save_image", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.save_image", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.rgb2ycbcr", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.rgb2ycbcr", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.psnr", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.calculate_ssim"], ["", "def", "sample", "(", "net", ",", "device", ",", "dataset", ",", "cfg", ")", ":", "\n", "    ", "scale", "=", "cfg", ".", "scale", "\n", "mean_psnr", "=", "0", "\n", "mean_psnr1", "=", "0", "\n", "mean_psnr2", "=", "0", "\n", "mean_ssim", "=", "0", "#tcw20190413047", "\n", "i", "=", "0", "\n", "for", "step", ",", "(", "hr", ",", "lr", ",", "name", ")", "in", "enumerate", "(", "dataset", ")", ":", "\n", "        ", "if", "\"DIV2K\"", "in", "dataset", ".", "name", ":", "\n", "            ", "t1", "=", "time", ".", "time", "(", ")", "\n", "h", ",", "w", "=", "lr", ".", "size", "(", ")", "[", "1", ":", "]", "\n", "h_half", ",", "w_half", "=", "int", "(", "h", "/", "2", ")", ",", "int", "(", "w", "/", "2", ")", "\n", "h_chop", ",", "w_chop", "=", "h_half", "+", "cfg", ".", "shave", ",", "w_half", "+", "cfg", ".", "shave", "\n", "\n", "lr_patch", "=", "torch", ".", "tensor", "(", "(", "4", ",", "3", ",", "h_chop", ",", "w_chop", ")", ",", "dtype", "=", "torch", ".", "float", ")", "\n", "lr_patch", "[", "0", "]", ".", "copy_", "(", "lr", "[", ":", ",", "0", ":", "h_chop", ",", "0", ":", "w_chop", "]", ")", "\n", "lr_patch", "[", "1", "]", ".", "copy_", "(", "lr", "[", ":", ",", "0", ":", "h_chop", ",", "w", "-", "w_chop", ":", "w", "]", ")", "\n", "lr_patch", "[", "2", "]", ".", "copy_", "(", "lr", "[", ":", ",", "h", "-", "h_chop", ":", "h", ",", "0", ":", "w_chop", "]", ")", "\n", "lr_patch", "[", "3", "]", ".", "copy_", "(", "lr", "[", ":", ",", "h", "-", "h_chop", ":", "h", ",", "w", "-", "w_chop", ":", "w", "]", ")", "\n", "lr_patch", "=", "lr_patch", ".", "to", "(", "device", ")", "\n", "\n", "sr", "=", "net", "(", "lr_patch", ",", "cfg", ".", "scale", ")", ".", "detach", "(", ")", "\n", "\n", "h", ",", "h_half", ",", "h_chop", "=", "h", "*", "scale", ",", "h_half", "*", "scale", ",", "h_chop", "*", "scale", "\n", "w", ",", "w_half", ",", "w_chop", "=", "w", "*", "scale", ",", "w_half", "*", "scale", ",", "w_chop", "*", "scale", "\n", "\n", "result", "=", "torch", ".", "tensor", "(", "(", "3", ",", "h", ",", "w", ")", ",", "dtype", "=", "torch", ".", "float", ")", ".", "to", "(", "device", ")", "\n", "result", "[", ":", ",", "0", ":", "h_half", ",", "0", ":", "w_half", "]", ".", "copy_", "(", "sr", "[", "0", ",", ":", ",", "0", ":", "h_half", ",", "0", ":", "w_half", "]", ")", "\n", "result", "[", ":", ",", "0", ":", "h_half", ",", "w_half", ":", "w", "]", ".", "copy_", "(", "sr", "[", "1", ",", ":", ",", "0", ":", "h_half", ",", "w_chop", "-", "w", "+", "w_half", ":", "w_chop", "]", ")", "\n", "result", "[", ":", ",", "h_half", ":", "h", ",", "0", ":", "w_half", "]", ".", "copy_", "(", "sr", "[", "2", ",", ":", ",", "h_chop", "-", "h", "+", "h_half", ":", "h_chop", ",", "0", ":", "w_half", "]", ")", "\n", "result", "[", ":", ",", "h_half", ":", "h", ",", "w_half", ":", "w", "]", ".", "copy_", "(", "sr", "[", "3", ",", ":", ",", "h_chop", "-", "h", "+", "h_half", ":", "h_chop", ",", "w_chop", "-", "w", "+", "w_half", ":", "w_chop", "]", ")", "\n", "sr", "=", "result", "\n", "t2", "=", "time", ".", "time", "(", ")", "\n", "", "else", ":", "\n", "            ", "t1", "=", "time", ".", "time", "(", ")", "\n", "lr", "=", "lr", ".", "unsqueeze", "(", "0", ")", ".", "to", "(", "device", ")", "\n", "sr", "=", "net", "(", "lr", ",", "cfg", ".", "scale", ")", ".", "detach", "(", ")", ".", "squeeze", "(", "0", ")", "#detach() break the reversed transformation.", "\n", "#print sr.size() #(3,1024,1024)", "\n", "lr", "=", "lr", ".", "squeeze", "(", "0", ")", "\n", "#print lr.size() #(3,512,512)", "\n", "t2", "=", "time", ".", "time", "(", ")", "\n", "", "model_name", "=", "cfg", ".", "ckpt_path", ".", "split", "(", "\".\"", ")", "[", "0", "]", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "#''", "\n", "sr_dir", "=", "os", ".", "path", ".", "join", "(", "cfg", ".", "sample_dir", ",", "\n", "model_name", ",", "\n", "cfg", ".", "test_data_dir", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", ",", "\n", "\"x{}\"", ".", "format", "(", "cfg", ".", "scale", ")", ",", "\n", "\"SR\"", ")", "\n", "hr_dir", "=", "os", ".", "path", ".", "join", "(", "cfg", ".", "sample_dir", ",", "\n", "model_name", ",", "\n", "cfg", ".", "test_data_dir", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", ",", "\n", "\"x{}\"", ".", "format", "(", "cfg", ".", "scale", ")", ",", "\n", "\"HR\"", ")", "\n", "#print sr_dir #sample/Urban100/x2/SR", "\n", "#print hr_dir #sample/Urban100/x2/HR", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "sr_dir", ")", ":", "#201904072208 tcw", "\n", "#os.makedirs(sr_dir, exist_ok=Ture)             #201904072211tcw, it is given at first, but it is wrong. So, I mark it.", "\n", "#os.makedirs(hr_dir, exist_ok=Ture)", "\n", "            ", "os", ".", "makedirs", "(", "sr_dir", ",", "mode", "=", "0o777", ")", "\n", "", "if", "not", "os", ".", "path", ".", "exists", "(", "hr_dir", ")", ":", "#201904072208 tcw", "\n", "            ", "os", ".", "makedirs", "(", "hr_dir", ",", "mode", "=", "0o777", ")", "\n", "\n", "", "sr_im_path", "=", "os", ".", "path", ".", "join", "(", "sr_dir", ",", "\"{}\"", ".", "format", "(", "name", ".", "replace", "(", "\"HR\"", ",", "\"SR\"", ")", ")", ")", "#use SR instead of HR in the name of high-resolution image", "\n", "hr_im_path", "=", "os", ".", "path", ".", "join", "(", "hr_dir", ",", "\"{}\"", ".", "format", "(", "name", ")", ")", "#name is a name of high-resolution image", "\n", "#print sr_im_path #sample/Urban100/x2/SR/img_100_SRF_2_SR.png", "\n", "#print hr_im_path #sample/Urban100/x2/HR/img_100_SRF_2_HR.png", "\n", "save_image", "(", "sr", ",", "sr_im_path", ")", "\n", "save_image", "(", "hr", ",", "hr_im_path", ")", "\n", "hr", "=", "hr", ".", "cpu", "(", ")", ".", "mul", "(", "255", ")", ".", "clamp", "(", "0", ",", "255", ")", ".", "byte", "(", ")", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "numpy", "(", ")", "#(644.1024,3) is the same dimensional with the size of input test image in dataset.py. #201904101617tcw", "\n", "sr", "=", "sr", ".", "cpu", "(", ")", ".", "mul", "(", "255", ")", ".", "clamp", "(", "0", ",", "255", ")", ".", "byte", "(", ")", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "numpy", "(", ")", "#tcw201904101617", "\n", "bnd", "=", "scale", "#tcw", "\n", "sr_1", "=", "rgb2ycbcr", "(", "sr", ")", "\n", "hr_1", "=", "rgb2ycbcr", "(", "hr", ")", "\n", "sr_1", "=", "sr_1", "[", "bnd", ":", "-", "bnd", ",", "bnd", ":", "-", "bnd", "]", "#tcw201904111837", "\n", "hr_1", "=", "hr_1", "[", "bnd", ":", "-", "bnd", ",", "bnd", ":", "-", "bnd", "]", "#tcw201904111837", "\n", "mean_psnr2", "+=", "psnr", "(", "sr_1", ",", "hr_1", ")", "/", "len", "(", "dataset", ")", "\n", "mean_ssim", "+=", "calculate_ssim", "(", "sr_1", ",", "hr_1", ")", "/", "len", "(", "dataset", ")", "\n", "", "print", "(", "mean_psnr2", ",", "mean_ssim", ")", "\n", "#print '-------------------'z", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.tcw_sample.main": [[190, 207], ["importlib.import_module", "importlib.import_module.Net", "print", "torch.load", "torch.load", "collections.OrderedDict", "torch.load.items", "net.to.load_state_dict", "torch.device", "torch.device", "net.to.to", "dataset.TestDataset", "tcw_sample.sample", "json.dumps", "vars", "torch.cuda.is_available", "torch.cuda.is_available"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.sample"], ["", "def", "main", "(", "cfg", ")", ":", "\n", "    ", "module", "=", "importlib", ".", "import_module", "(", "\"model.{}\"", ".", "format", "(", "cfg", ".", "model", ")", ")", "\n", "net", "=", "module", ".", "Net", "(", "scale", "=", "cfg", ".", "scale", ",", "\n", "group", "=", "cfg", ".", "group", ")", "\n", "print", "(", "json", ".", "dumps", "(", "vars", "(", "cfg", ")", ",", "indent", "=", "4", ",", "sort_keys", "=", "True", ")", ")", "#print cfg information according order.", "\n", "state_dict", "=", "torch", ".", "load", "(", "cfg", ".", "ckpt_path", ")", "\n", "new_state_dict", "=", "OrderedDict", "(", ")", "\n", "for", "k", ",", "v", "in", "state_dict", ".", "items", "(", ")", ":", "\n", "        ", "name", "=", "k", "\n", "# name = k[7:] # remove \"module.\"", "\n", "new_state_dict", "[", "name", "]", "=", "v", "\n", "\n", "", "net", ".", "load_state_dict", "(", "new_state_dict", ")", "\n", "device", "=", "torch", ".", "device", "(", "\"cuda:0\"", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", "else", "\"cpu\"", ")", "#0 is number of gpu, if this gpu1 is work, you can set it into 1 (device=torch.device(\"cuda:1\" if torch.cuda.is_available() else \"cpu\"))", "\n", "net", "=", "net", ".", "to", "(", "device", ")", "\n", "dataset", "=", "TestDataset", "(", "cfg", ".", "test_data_dir", ",", "cfg", ".", "scale", ")", "\n", "sample", "(", "net", ",", "device", ",", "dataset", ",", "cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.train.parse_args": [[9, 42], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.parse_args"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "parser", ".", "add_argument", "(", "\"--model\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_name\"", ",", "type", "=", "str", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--print_interval\"", ",", "type", "=", "int", ",", "default", "=", "1000", ")", "#original data is 1000", "\n", "parser", ".", "add_argument", "(", "\"--train_data_path\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"dataset/DIV2K_train.h5\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"checkpoint\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--sample_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"sample/\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--num_gpu\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "parser", ".", "add_argument", "(", "\"--shave\"", ",", "type", "=", "int", ",", "default", "=", "20", ")", "\n", "parser", ".", "add_argument", "(", "\"--scale\"", ",", "type", "=", "int", ",", "default", "=", "2", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--verbose\"", ",", "action", "=", "\"store_true\"", ",", "default", "=", "\"store_true\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--group\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--patch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--batch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--max_steps\"", ",", "type", "=", "int", ",", "default", "=", "200000", ")", "\n", "parser", ".", "add_argument", "(", "\"--decay\"", ",", "type", "=", "int", ",", "default", "=", "150000", ")", "\n", "parser", ".", "add_argument", "(", "\"--lr\"", ",", "type", "=", "float", ",", "default", "=", "0.0001", ")", "\n", "parser", ".", "add_argument", "(", "\"--clip\"", ",", "type", "=", "float", ",", "default", "=", "10.0", ")", "\n", "\n", "#parser.add_argument(\"--loss_fn\", type=str, ", "\n", "#choices=[\"MSE\", \"L1\", \"SmoothL1\"], default=\"L1\") #tcw201904082029", "\n", "parser", ".", "add_argument", "(", "\"--loss_fn\"", ",", "type", "=", "str", ",", "\n", "choices", "=", "[", "\"MSE\"", ",", "\"L1\"", ",", "\"SmoothL1\"", "]", ",", "default", "=", "\"MSE\"", ")", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.train.main": [[43, 51], ["print", "solver.Solver", "solver.Solver.fit", "importlib.import_module", "json.dumps", "vars"], "function", ["None"], ["", "def", "main", "(", "cfg", ")", ":", "\n", "# dynamic import using --model argument", "\n", "    ", "net", "=", "importlib", ".", "import_module", "(", "\"model.{}\"", ".", "format", "(", "cfg", ".", "model", ")", ")", ".", "Net", "\n", "print", "(", "json", ".", "dumps", "(", "vars", "(", "cfg", ")", ",", "indent", "=", "4", ",", "sort_keys", "=", "True", ")", ")", "\n", "\n", "solver", "=", "Solver", "(", "net", ",", "cfg", ")", "\n", "#print 'ds'", "\n", "solver", ".", "fit", "(", ")", "\n", "#print 'sdsddwdew'", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.TrainDataset.__init__": [[42, 62], ["torch.Dataset.__init__", "h5py.File", "h5py.File.close", "torchvision.Compose", "h5f[].values", "torchvision.ToTensor", "h5f[].values", "h5f[].values"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "path", ",", "size", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TrainDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "size", "=", "size", "\n", "h5f", "=", "h5py", ".", "File", "(", "path", ",", "\"r\"", ")", "\n", "\n", "self", ".", "hr", "=", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"HR\"", "]", ".", "values", "(", ")", "]", "\n", "# perform multi-scale training", "\n", "if", "scale", "==", "0", ":", "\n", "            ", "self", ".", "scale", "=", "[", "2", ",", "3", ",", "4", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "i", ")", "]", ".", "values", "(", ")", "]", "for", "i", "in", "self", ".", "scale", "]", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "scale", "=", "[", "scale", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "scale", ")", "]", ".", "values", "(", ")", "]", "]", "\n", "\n", "", "h5f", ".", "close", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.TrainDataset.__getitem__": [[64, 72], ["dataset.random_crop", "dataset.random_flip_and_rotate", "enumerate", "enumerate", "dataset.TrainDataset.transform", "dataset.TrainDataset.transform"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_crop", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_flip_and_rotate"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "size", "=", "self", ".", "size", "\n", "item", "=", "[", "(", "self", ".", "hr", "[", "index", "]", ",", "self", ".", "lr", "[", "i", "]", "[", "index", "]", ")", "for", "i", ",", "_", "in", "enumerate", "(", "self", ".", "lr", ")", "]", "\n", "#i is the number, _ is the context", "\n", "item", "=", "[", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "self", ".", "scale", "[", "i", "]", ")", "for", "i", ",", "(", "hr", ",", "lr", ")", "in", "enumerate", "(", "item", ")", "]", "\n", "item", "=", "[", "random_flip_and_rotate", "(", "hr", ",", "lr", ")", "for", "hr", ",", "lr", "in", "item", "]", "\n", "\n", "return", "[", "(", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ")", "for", "hr", ",", "lr", "in", "item", "]", "#tranform array (hr,lr) into tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.TrainDataset.__len__": [[73, 75], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.TestDataset.__init__": [[78, 98], ["torch.Dataset.__init__", "dataset.TestDataset.hr.sort", "dataset.TestDataset.lr.sort", "torchvision.Compose", "dirname.split", "glob.glob", "glob.glob", "glob.glob", "os.path.join", "os.path.join", "os.path.join", "torchvision.ToTensor"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dirname", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TestDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "name", "=", "dirname", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "self", ".", "scale", "=", "scale", "\n", "\n", "if", "\"DIV\"", "in", "self", ".", "name", ":", "\n", "            ", "self", ".", "hr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_HR\"", ".", "format", "(", "dirname", ")", ",", "\"*.png\"", ")", ")", "\n", "self", ".", "lr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_LR_bicubic\"", ".", "format", "(", "dirname", ")", ",", "\n", "\"X{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "", "else", ":", "\n", "            ", "all_files", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "dirname", ",", "\"x{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "self", ".", "hr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"HR\"", "in", "name", "]", "\n", "self", ".", "lr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"LR\"", "in", "name", "]", "\n", "\n", "", "self", ".", "hr", ".", "sort", "(", ")", "\n", "self", ".", "lr", ".", "sort", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.TestDataset.__getitem__": [[100, 117], ["PIL.Image.open", "PIL.Image.open", "hr.convert.convert.convert", "lr.convert.convert.convert", "dataset.TestDataset.hr[].split", "dataset.TestDataset.transform", "dataset.TestDataset.transform"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "hr", "=", "Image", ".", "open", "(", "self", ".", "hr", "[", "index", "]", ")", "\n", "lr", "=", "Image", ".", "open", "(", "self", ".", "lr", "[", "index", "]", ")", "\n", "'''\n        #This is only used to test code, which makes me more know the code. \n        ss = np.asarray(hr) (644,1024,3)\n        print ss.shape\n        '''", "\n", "hr", "=", "hr", ".", "convert", "(", "\"RGB\"", ")", "\n", "lr", "=", "lr", ".", "convert", "(", "\"RGB\"", ")", "\n", "'''\n        tss = np.asarray(hr) (644,1024,3)\n        print tss.shape\n        '''", "\n", "filename", "=", "self", ".", "hr", "[", "index", "]", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "#keep the last string, which is after /. For example, a= 'aaa/asds.bmp', a.split(\"/\")[-1] = asds ", "\n", "return", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ",", "filename", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.TestDataset.__len__": [[118, 120], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.random_crop": [[10, 22], ["random.randint", "random.randint", "lr[].copy", "hr[].copy"], "function", ["None"], ["def", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "scale", ")", ":", "\n", "    ", "h", ",", "w", "=", "lr", ".", "shape", "[", ":", "-", "1", "]", "#h,w,channel [:-1] beside the final element, such as channel ", "\n", "x", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "size", ")", "#random number", "\n", "y", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "size", ")", "\n", "\n", "hsize", "=", "size", "*", "scale", "\n", "hx", ",", "hy", "=", "x", "*", "scale", ",", "y", "*", "scale", "\n", "\n", "crop_lr", "=", "lr", "[", "y", ":", "y", "+", "size", ",", "x", ":", "x", "+", "size", "]", ".", "copy", "(", ")", "#low-resolution patch", "\n", "crop_hr", "=", "hr", "[", "hy", ":", "hy", "+", "hsize", ",", "hx", ":", "hx", "+", "hsize", "]", ".", "copy", "(", ")", "#high-resolution patch", "\n", "\n", "return", "crop_hr", ",", "crop_lr", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x2.dataset.random_flip_and_rotate": [[24, 39], ["random.choice", "numpy.rot90", "numpy.rot90", "random.random", "numpy.flipud", "numpy.flipud", "random.random", "numpy.fliplr", "numpy.fliplr", "np.fliplr.copy", "np.fliplr.copy"], "function", ["None"], ["", "def", "random_flip_and_rotate", "(", "im1", ",", "im2", ")", ":", "\n", "    ", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "\n", "        ", "im1", "=", "np", ".", "flipud", "(", "im1", ")", "#left and right move", "\n", "im2", "=", "np", ".", "flipud", "(", "im2", ")", "\n", "\n", "", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "#up and down move", "\n", "        ", "im1", "=", "np", ".", "fliplr", "(", "im1", ")", "\n", "im2", "=", "np", ".", "fliplr", "(", "im2", ")", "\n", "\n", "", "angle", "=", "random", ".", "choice", "(", "[", "0", ",", "1", ",", "2", ",", "3", "]", ")", "#rote", "\n", "im1", "=", "np", ".", "rot90", "(", "im1", ",", "angle", ")", "\n", "im2", "=", "np", ".", "rot90", "(", "im2", ",", "angle", ")", "\n", "\n", "# have to copy before be called by transform function", "\n", "return", "im1", ".", "copy", "(", ")", ",", "im2", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.MeanShift.__init__": [[12, 27], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.eye().view", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "ops.MeanShift.shifter.parameters", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye", "torch.eye"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "mean_rgb", ",", "sub", ")", ":", "\n", "        ", "super", "(", "MeanShift", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "sign", "=", "-", "1", "if", "sub", "else", "1", "\n", "r", "=", "mean_rgb", "[", "0", "]", "*", "sign", "\n", "g", "=", "mean_rgb", "[", "1", "]", "*", "sign", "\n", "b", "=", "mean_rgb", "[", "2", "]", "*", "sign", "\n", "\n", "self", ".", "shifter", "=", "nn", ".", "Conv2d", "(", "3", ",", "3", ",", "1", ",", "1", ",", "0", ")", "#3 is size of output, 3 is size of input, 1 is kernel 1 is padding, 0 is group ", "\n", "self", ".", "shifter", ".", "weight", ".", "data", "=", "torch", ".", "eye", "(", "3", ")", ".", "view", "(", "3", ",", "3", ",", "1", ",", "1", ")", "# view(3,3,1,1) convert a shape into (3,3,1,1) eye(3) is a 3x3 matrix and diagonal is 1.", "\n", "self", ".", "shifter", ".", "bias", ".", "data", "=", "torch", ".", "Tensor", "(", "[", "r", ",", "g", ",", "b", "]", ")", "\n", "#in_channels, out_channels,ksize=3, stride=1, pad=1", "\n", "# Freeze the mean shift layer", "\n", "for", "params", "in", "self", ".", "shifter", ".", "parameters", "(", ")", ":", "\n", "            ", "params", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.MeanShift.forward": [[28, 31], ["ops.MeanShift.shifter"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "shifter", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.BasicBlock.__init__": [[34, 45], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "ops.init_weights", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "\n", "in_channels", ",", "out_channels", ",", "\n", "ksize", "=", "3", ",", "stride", "=", "1", ",", "pad", "=", "1", ")", ":", "\n", "        ", "super", "(", "BasicBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "ksize", ",", "stride", ",", "pad", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", ")", "\n", "\n", "init_weights", "(", "self", ".", "modules", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.BasicBlock.forward": [[46, 49], ["ops.BasicBlock.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "self", ".", "body", "(", "x", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.ResidualBlock.__init__": [[52, 63], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "ops.init_weights", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "\n", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "ResidualBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "3", ",", "1", ",", "1", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "out_channels", ",", "out_channels", ",", "3", ",", "1", ",", "1", ")", ",", "\n", ")", "\n", "\n", "init_weights", "(", "self", ".", "modules", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.ResidualBlock.forward": [[64, 68], ["ops.ResidualBlock.body", "torch.relu", "torch.relu", "torch.relu", "torch.relu"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "self", ".", "body", "(", "x", ")", "\n", "out", "=", "F", ".", "relu", "(", "out", "+", "x", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.EResidualBlock.__init__": [[71, 85], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "ops.init_weights", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "\n", "in_channels", ",", "out_channels", ",", "\n", "group", "=", "1", ")", ":", "\n", "        ", "super", "(", "EResidualBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "3", ",", "1", ",", "1", ",", "groups", "=", "group", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "out_channels", ",", "out_channels", ",", "3", ",", "1", ",", "1", ",", "groups", "=", "group", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "out_channels", ",", "out_channels", ",", "1", ",", "1", ",", "0", ")", ",", "\n", ")", "\n", "\n", "init_weights", "(", "self", ".", "modules", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.EResidualBlock.forward": [[86, 90], ["ops.EResidualBlock.body", "torch.relu", "torch.relu", "torch.relu", "torch.relu"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "self", ".", "body", "(", "x", ")", "\n", "out", "=", "F", ".", "relu", "(", "out", "+", "x", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.UpsampleBlock.__init__": [[93, 106], ["torch.Module.__init__", "ops._UpsampleBlock", "ops._UpsampleBlock", "ops._UpsampleBlock", "ops._UpsampleBlock"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "\n", "n_channels", ",", "scale", ",", "multi_scale", ",", "\n", "group", "=", "1", ")", ":", "\n", "        ", "super", "(", "UpsampleBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "if", "multi_scale", ":", "\n", "            ", "self", ".", "up2", "=", "_UpsampleBlock", "(", "n_channels", ",", "scale", "=", "2", ",", "group", "=", "group", ")", "\n", "self", ".", "up3", "=", "_UpsampleBlock", "(", "n_channels", ",", "scale", "=", "3", ",", "group", "=", "group", ")", "\n", "self", ".", "up4", "=", "_UpsampleBlock", "(", "n_channels", ",", "scale", "=", "4", ",", "group", "=", "group", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "up", "=", "_UpsampleBlock", "(", "n_channels", ",", "scale", "=", "scale", ",", "group", "=", "group", ")", "\n", "\n", "", "self", ".", "multi_scale", "=", "multi_scale", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.UpsampleBlock.forward": [[107, 117], ["ops.UpsampleBlock.up", "ops.UpsampleBlock.up2", "ops.UpsampleBlock.up3", "ops.UpsampleBlock.up4"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "scale", ")", ":", "\n", "        ", "if", "self", ".", "multi_scale", ":", "\n", "            ", "if", "scale", "==", "2", ":", "\n", "                ", "return", "self", ".", "up2", "(", "x", ")", "\n", "", "elif", "scale", "==", "3", ":", "\n", "                ", "return", "self", ".", "up3", "(", "x", ")", "\n", "", "elif", "scale", "==", "4", ":", "\n", "                ", "return", "self", ".", "up4", "(", "x", ")", "\n", "", "", "else", ":", "\n", "            ", "return", "self", ".", "up", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops._UpsampleBlock.__init__": [[120, 138], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "ops.init_weights", "range", "int", "math.log", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.PixelShuffle", "torch.PixelShuffle", "torch.PixelShuffle", "torch.PixelShuffle", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.PixelShuffle", "torch.PixelShuffle", "torch.PixelShuffle", "torch.PixelShuffle"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "\n", "n_channels", ",", "scale", ",", "\n", "group", "=", "1", ")", ":", "\n", "        ", "super", "(", "_UpsampleBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "modules", "=", "[", "]", "\n", "if", "scale", "==", "2", "or", "scale", "==", "4", "or", "scale", "==", "8", ":", "\n", "            ", "for", "_", "in", "range", "(", "int", "(", "math", ".", "log", "(", "scale", ",", "2", ")", ")", ")", ":", "\n", "#modules += [nn.Conv2d(n_channels, 4*n_channels, 3, 1, 1, groups=group), nn.ReLU(inplace=True)]", "\n", "                ", "modules", "+=", "[", "nn", ".", "Conv2d", "(", "n_channels", ",", "4", "*", "n_channels", ",", "3", ",", "1", ",", "1", ",", "groups", "=", "group", ")", "]", "\n", "modules", "+=", "[", "nn", ".", "PixelShuffle", "(", "2", ")", "]", "\n", "", "", "elif", "scale", "==", "3", ":", "\n", "#modules += [nn.Conv2d(n_channels, 9*n_channels, 3, 1, 1, groups=group), nn.ReLU(inplace=True)]", "\n", "            ", "modules", "+=", "[", "nn", ".", "Conv2d", "(", "n_channels", ",", "9", "*", "n_channels", ",", "3", ",", "1", ",", "1", ",", "groups", "=", "group", ")", "]", "\n", "modules", "+=", "[", "nn", ".", "PixelShuffle", "(", "3", ")", "]", "\n", "\n", "", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "*", "modules", ")", "\n", "init_weights", "(", "self", ".", "modules", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops._UpsampleBlock.forward": [[139, 142], ["ops._UpsampleBlock.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "self", ".", "body", "(", "x", ")", "\n", "return", "out", "\n", "", "", ""]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.ops.init_weights": [[7, 9], ["None"], "function", ["None"], ["def", "init_weights", "(", "modules", ")", ":", "\n", "    ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.lesrcnn.Block.__init__": [[6, 15], ["torch.Module.__init__", "model.EResidualBlock", "model.BasicBlock", "model.BasicBlock", "model.BasicBlock"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "\n", "in_channels", ",", "out_channels", ",", "\n", "group", "=", "1", ")", ":", "\n", "        ", "super", "(", "Block", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "b1", "=", "ops", ".", "EResidualBlock", "(", "64", ",", "64", ",", "group", "=", "group", ")", "\n", "self", ".", "c1", "=", "ops", ".", "BasicBlock", "(", "64", "*", "2", ",", "64", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "c2", "=", "ops", ".", "BasicBlock", "(", "64", "*", "3", ",", "64", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "c3", "=", "ops", ".", "BasicBlock", "(", "64", "*", "4", ",", "64", ",", "1", ",", "1", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.lesrcnn.Block.forward": [[16, 32], ["lesrcnn.Block.b1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "lesrcnn.Block.c1", "lesrcnn.Block.b1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "lesrcnn.Block.c2", "lesrcnn.Block.b1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "lesrcnn.Block.c3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "c0", "=", "o0", "=", "x", "\n", "\n", "b1", "=", "self", ".", "b1", "(", "o0", ")", "\n", "c1", "=", "torch", ".", "cat", "(", "[", "c0", ",", "b1", "]", ",", "dim", "=", "1", ")", "\n", "o1", "=", "self", ".", "c1", "(", "c1", ")", "\n", "\n", "b2", "=", "self", ".", "b1", "(", "o1", ")", "\n", "c2", "=", "torch", ".", "cat", "(", "[", "c1", ",", "b2", "]", ",", "dim", "=", "1", ")", "\n", "o2", "=", "self", ".", "c2", "(", "c2", ")", "\n", "\n", "b3", "=", "self", ".", "b1", "(", "o2", ")", "\n", "c3", "=", "torch", ".", "cat", "(", "[", "c2", ",", "b3", "]", ",", "dim", "=", "1", ")", "\n", "o3", "=", "self", ".", "c3", "(", "c3", ")", "\n", "\n", "return", "o3", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.lesrcnn.Net.__init__": [[35, 82], ["torch.Module.__init__", "kwargs.get", "kwargs.get", "kwargs.get", "model.MeanShift", "model.MeanShift", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.ReLU", "torch.ReLU", "model.UpsampleBlock", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "Net", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "scale", "=", "kwargs", ".", "get", "(", "\"scale\"", ")", "#value of scale is scale. ", "\n", "multi_scale", "=", "kwargs", ".", "get", "(", "\"multi_scale\"", ")", "# value of multi_scale is multi_scale in args.", "\n", "group", "=", "kwargs", ".", "get", "(", "\"group\"", ",", "1", ")", "#if valule of group isn't given, group is 1.", "\n", "kernel_size", "=", "3", "#tcw 201904091123", "\n", "kernel_size1", "=", "1", "#tcw 201904091123", "\n", "padding1", "=", "0", "#tcw 201904091124", "\n", "padding", "=", "1", "#tcw201904091123", "\n", "features", "=", "64", "#tcw201904091124", "\n", "groups", "=", "1", "#tcw201904091124", "\n", "channels", "=", "3", "\n", "features1", "=", "64", "\n", "self", ".", "sub_mean", "=", "ops", ".", "MeanShift", "(", "(", "0.4488", ",", "0.4371", ",", "0.4040", ")", ",", "sub", "=", "True", ")", "\n", "self", ".", "add_mean", "=", "ops", ".", "MeanShift", "(", "(", "0.4488", ",", "0.4371", ",", "0.4040", ")", ",", "sub", "=", "False", ")", "\n", "'''\n           in_channels, out_channels, kernel_size, stride, padding,dialation, groups,\n        '''", "\n", "self", ".", "conv1", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "channels", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "padding", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv4", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv5", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv6", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv7", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv8", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv9", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv10", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv11", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv12", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv13", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv14", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv15", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv16", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv17", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size1", ",", "padding", "=", "0", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "self", ".", "conv17_1", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv17_2", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv17_3", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv17_4", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "features", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "False", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", "self", ".", "conv18", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "features", ",", "out_channels", "=", "3", ",", "kernel_size", "=", "kernel_size", ",", "padding", "=", "padding", ",", "groups", "=", "groups", ",", "bias", "=", "False", ")", ")", "\n", "'''\n        self.conv18 =  nn.Conv2d(in_channels=features,out_channels=features1,kernel_size=kernel_size1,padding=padding1,groups=groups,bias=False)\n        self.ReLU = nn.ReLU(inplace=True)\n        '''", "\n", "self", ".", "ReLU", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "upsample", "=", "ops", ".", "UpsampleBlock", "(", "64", ",", "scale", "=", "scale", ",", "multi_scale", "=", "multi_scale", ",", "group", "=", "1", ")", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "scale", ")", ":", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.model.lesrcnn.Net.forward": [[82, 132], ["lesrcnn.Net.sub_mean", "lesrcnn.Net.conv1", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv2", "lesrcnn.Net.conv3", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv4", "lesrcnn.Net.conv5", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv6", "lesrcnn.Net.conv7", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv8", "lesrcnn.Net.conv9", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv10", "lesrcnn.Net.conv11", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv12", "lesrcnn.Net.conv13", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv14", "lesrcnn.Net.conv15", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv16", "lesrcnn.Net.conv17", "lesrcnn.Net.ReLU", "lesrcnn.Net.upsample", "lesrcnn.Net.upsample", "lesrcnn.Net.ReLU", "lesrcnn.Net.conv17_1", "lesrcnn.Net.conv17_2", "lesrcnn.Net.conv17_3", "lesrcnn.Net.conv17_4", "lesrcnn.Net.conv18", "lesrcnn.Net.add_mean"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "scale", ")", ":", "\n", "#print '-------dfd'", "\n", "        ", "x", "=", "self", ".", "sub_mean", "(", "x", ")", "\n", "c0", "=", "x", "\n", "x1", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x1_1", "=", "self", ".", "ReLU", "(", "x1", ")", "\n", "x2", "=", "self", ".", "conv2", "(", "x1_1", ")", "\n", "x3", "=", "self", ".", "conv3", "(", "x2", ")", "\n", "x2_3", "=", "x1", "+", "x3", "\n", "x2_4", "=", "self", ".", "ReLU", "(", "x2_3", ")", "\n", "x4", "=", "self", ".", "conv4", "(", "x2_4", ")", "\n", "x5", "=", "self", ".", "conv5", "(", "x4", ")", "\n", "x3_5", "=", "x2_3", "+", "x5", "\n", "x3_6", "=", "self", ".", "ReLU", "(", "x3_5", ")", "\n", "x6", "=", "self", ".", "conv6", "(", "x3_6", ")", "\n", "x7", "=", "self", ".", "conv7", "(", "x6", ")", "\n", "x7_1", "=", "x3_5", "+", "x7", "\n", "x7_2", "=", "self", ".", "ReLU", "(", "x7_1", ")", "\n", "x8", "=", "self", ".", "conv8", "(", "x7_2", ")", "\n", "x9", "=", "self", ".", "conv9", "(", "x8", ")", "\n", "x9_2", "=", "x7_1", "+", "x9", "\n", "x9_1", "=", "self", ".", "ReLU", "(", "x9_2", ")", "\n", "x10", "=", "self", ".", "conv10", "(", "x9_1", ")", "\n", "x11", "=", "self", ".", "conv11", "(", "x10", ")", "\n", "x11_1", "=", "x9_2", "+", "x11", "\n", "x11_2", "=", "self", ".", "ReLU", "(", "x11_1", ")", "\n", "x12", "=", "self", ".", "conv12", "(", "x11_2", ")", "\n", "x13", "=", "self", ".", "conv13", "(", "x12", ")", "\n", "x13_1", "=", "x11_1", "+", "x13", "\n", "x13_2", "=", "self", ".", "ReLU", "(", "x13_1", ")", "\n", "x14", "=", "self", ".", "conv14", "(", "x13_2", ")", "\n", "x15", "=", "self", ".", "conv15", "(", "x14", ")", "\n", "x15_1", "=", "x15", "+", "x13_1", "\n", "x15_2", "=", "self", ".", "ReLU", "(", "x15_1", ")", "\n", "x16", "=", "self", ".", "conv16", "(", "x15_2", ")", "\n", "x17", "=", "self", ".", "conv17", "(", "x16", ")", "\n", "x17_2", "=", "x17", "+", "x15_1", "\n", "x17_3", "=", "self", ".", "ReLU", "(", "x17_2", ")", "\n", "temp", "=", "self", ".", "upsample", "(", "x17_3", ",", "scale", "=", "scale", ")", "\n", "x1111", "=", "self", ".", "upsample", "(", "x1_1", ",", "scale", "=", "scale", ")", "#tcw", "\n", "temp1", "=", "x1111", "+", "temp", "#tcw", "\n", "temp2", "=", "self", ".", "ReLU", "(", "temp1", ")", "\n", "temp3", "=", "self", ".", "conv17_1", "(", "temp2", ")", "\n", "temp4", "=", "self", ".", "conv17_2", "(", "temp3", ")", "\n", "temp5", "=", "self", ".", "conv17_3", "(", "temp4", ")", "\n", "temp6", "=", "self", ".", "conv17_4", "(", "temp5", ")", "\n", "x18", "=", "self", ".", "conv18", "(", "temp6", ")", "\n", "out", "=", "self", ".", "add_mean", "(", "x18", ")", "\n", "#out = x18", "\n", "return", "out", "\n", "", "", ""]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.train.parse_args": [[9, 42], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.parse_args"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "parser", ".", "add_argument", "(", "\"--model\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_name\"", ",", "type", "=", "str", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--print_interval\"", ",", "type", "=", "int", ",", "default", "=", "1000", ")", "#original data is 1000", "\n", "parser", ".", "add_argument", "(", "\"--train_data_path\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"dataset/DIV2K_train.h5\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"checkpoint\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--sample_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"sample/\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--num_gpu\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "parser", ".", "add_argument", "(", "\"--shave\"", ",", "type", "=", "int", ",", "default", "=", "20", ")", "\n", "parser", ".", "add_argument", "(", "\"--scale\"", ",", "type", "=", "int", ",", "default", "=", "2", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--verbose\"", ",", "action", "=", "\"store_true\"", ",", "default", "=", "\"store_true\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--group\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--patch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--batch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--max_steps\"", ",", "type", "=", "int", ",", "default", "=", "200000", ")", "\n", "parser", ".", "add_argument", "(", "\"--decay\"", ",", "type", "=", "int", ",", "default", "=", "150000", ")", "\n", "parser", ".", "add_argument", "(", "\"--lr\"", ",", "type", "=", "float", ",", "default", "=", "0.0001", ")", "\n", "parser", ".", "add_argument", "(", "\"--clip\"", ",", "type", "=", "float", ",", "default", "=", "10.0", ")", "\n", "\n", "#parser.add_argument(\"--loss_fn\", type=str, ", "\n", "#choices=[\"MSE\", \"L1\", \"SmoothL1\"], default=\"L1\") #tcw201904082029", "\n", "parser", ".", "add_argument", "(", "\"--loss_fn\"", ",", "type", "=", "str", ",", "\n", "choices", "=", "[", "\"MSE\"", ",", "\"L1\"", ",", "\"SmoothL1\"", "]", ",", "default", "=", "\"MSE\"", ")", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.train.main": [[43, 51], ["print", "solver.Solver", "solver.Solver.fit", "importlib.import_module", "json.dumps", "vars"], "function", ["None"], ["", "def", "main", "(", "cfg", ")", ":", "\n", "# dynamic import using --model argument", "\n", "    ", "net", "=", "importlib", ".", "import_module", "(", "\"model.{}\"", ".", "format", "(", "cfg", ".", "model", ")", ")", ".", "Net", "\n", "print", "(", "json", ".", "dumps", "(", "vars", "(", "cfg", ")", ",", "indent", "=", "4", ",", "sort_keys", "=", "True", ")", ")", "\n", "\n", "solver", "=", "Solver", "(", "net", ",", "cfg", ")", "\n", "#print 'ds'", "\n", "solver", ".", "fit", "(", ")", "\n", "#print 'sdsddwdew'", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.TrainDataset.__init__": [[42, 62], ["torch.Dataset.__init__", "h5py.File", "h5py.File.close", "torchvision.Compose", "h5f[].values", "torchvision.ToTensor", "h5f[].values", "h5f[].values"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "path", ",", "size", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TrainDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "size", "=", "size", "\n", "h5f", "=", "h5py", ".", "File", "(", "path", ",", "\"r\"", ")", "\n", "\n", "self", ".", "hr", "=", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"HR\"", "]", ".", "values", "(", ")", "]", "\n", "# perform multi-scale training", "\n", "if", "scale", "==", "0", ":", "\n", "            ", "self", ".", "scale", "=", "[", "2", ",", "3", ",", "4", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "i", ")", "]", ".", "values", "(", ")", "]", "for", "i", "in", "self", ".", "scale", "]", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "scale", "=", "[", "scale", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "scale", ")", "]", ".", "values", "(", ")", "]", "]", "\n", "\n", "", "h5f", ".", "close", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.TrainDataset.__getitem__": [[64, 72], ["dataset.random_crop", "dataset.random_flip_and_rotate", "enumerate", "enumerate", "dataset.TrainDataset.transform", "dataset.TrainDataset.transform"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_crop", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_flip_and_rotate"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "size", "=", "self", ".", "size", "\n", "item", "=", "[", "(", "self", ".", "hr", "[", "index", "]", ",", "self", ".", "lr", "[", "i", "]", "[", "index", "]", ")", "for", "i", ",", "_", "in", "enumerate", "(", "self", ".", "lr", ")", "]", "\n", "#i is the number, _ is the context", "\n", "item", "=", "[", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "self", ".", "scale", "[", "i", "]", ")", "for", "i", ",", "(", "hr", ",", "lr", ")", "in", "enumerate", "(", "item", ")", "]", "\n", "item", "=", "[", "random_flip_and_rotate", "(", "hr", ",", "lr", ")", "for", "hr", ",", "lr", "in", "item", "]", "\n", "\n", "return", "[", "(", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ")", "for", "hr", ",", "lr", "in", "item", "]", "#tranform array (hr,lr) into tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.TrainDataset.__len__": [[73, 75], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.TestDataset.__init__": [[78, 98], ["torch.Dataset.__init__", "dataset.TestDataset.hr.sort", "dataset.TestDataset.lr.sort", "torchvision.Compose", "dirname.split", "glob.glob", "glob.glob", "glob.glob", "os.path.join", "os.path.join", "os.path.join", "torchvision.ToTensor"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dirname", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TestDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "name", "=", "dirname", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "self", ".", "scale", "=", "scale", "\n", "\n", "if", "\"DIV\"", "in", "self", ".", "name", ":", "\n", "            ", "self", ".", "hr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_HR\"", ".", "format", "(", "dirname", ")", ",", "\"*.png\"", ")", ")", "\n", "self", ".", "lr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_LR_bicubic\"", ".", "format", "(", "dirname", ")", ",", "\n", "\"X{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "", "else", ":", "\n", "            ", "all_files", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "dirname", ",", "\"x{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "self", ".", "hr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"HR\"", "in", "name", "]", "\n", "self", ".", "lr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"LR\"", "in", "name", "]", "\n", "\n", "", "self", ".", "hr", ".", "sort", "(", ")", "\n", "self", ".", "lr", ".", "sort", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.TestDataset.__getitem__": [[100, 117], ["PIL.Image.open", "PIL.Image.open", "hr.convert.convert.convert", "lr.convert.convert.convert", "dataset.TestDataset.hr[].split", "dataset.TestDataset.transform", "dataset.TestDataset.transform"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "hr", "=", "Image", ".", "open", "(", "self", ".", "hr", "[", "index", "]", ")", "\n", "lr", "=", "Image", ".", "open", "(", "self", ".", "lr", "[", "index", "]", ")", "\n", "'''\n        #This is only used to test code, which makes me more know the code. \n        ss = np.asarray(hr) (644,1024,3)\n        print ss.shape\n        '''", "\n", "hr", "=", "hr", ".", "convert", "(", "\"RGB\"", ")", "\n", "lr", "=", "lr", ".", "convert", "(", "\"RGB\"", ")", "\n", "'''\n        tss = np.asarray(hr) (644,1024,3)\n        print tss.shape\n        '''", "\n", "filename", "=", "self", ".", "hr", "[", "index", "]", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "#keep the last string, which is after /. For example, a= 'aaa/asds.bmp', a.split(\"/\")[-1] = asds ", "\n", "return", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ",", "filename", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.TestDataset.__len__": [[118, 120], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.random_crop": [[10, 22], ["random.randint", "random.randint", "lr[].copy", "hr[].copy"], "function", ["None"], ["def", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "scale", ")", ":", "\n", "    ", "h", ",", "w", "=", "lr", ".", "shape", "[", ":", "-", "1", "]", "#h,w,channel [:-1] beside the final element, such as channel ", "\n", "x", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "size", ")", "#random number", "\n", "y", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "size", ")", "\n", "\n", "hsize", "=", "size", "*", "scale", "\n", "hx", ",", "hy", "=", "x", "*", "scale", ",", "y", "*", "scale", "\n", "\n", "crop_lr", "=", "lr", "[", "y", ":", "y", "+", "size", ",", "x", ":", "x", "+", "size", "]", ".", "copy", "(", ")", "#low-resolution patch", "\n", "crop_hr", "=", "hr", "[", "hy", ":", "hy", "+", "hsize", ",", "hx", ":", "hx", "+", "hsize", "]", ".", "copy", "(", ")", "#high-resolution patch", "\n", "\n", "return", "crop_hr", ",", "crop_lr", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x3.dataset.random_flip_and_rotate": [[24, 39], ["random.choice", "numpy.rot90", "numpy.rot90", "random.random", "numpy.flipud", "numpy.flipud", "random.random", "numpy.fliplr", "numpy.fliplr", "np.fliplr.copy", "np.fliplr.copy"], "function", ["None"], ["", "def", "random_flip_and_rotate", "(", "im1", ",", "im2", ")", ":", "\n", "    ", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "\n", "        ", "im1", "=", "np", ".", "flipud", "(", "im1", ")", "#left and right move", "\n", "im2", "=", "np", ".", "flipud", "(", "im2", ")", "\n", "\n", "", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "#up and down move", "\n", "        ", "im1", "=", "np", ".", "fliplr", "(", "im1", ")", "\n", "im2", "=", "np", ".", "fliplr", "(", "im2", ")", "\n", "\n", "", "angle", "=", "random", ".", "choice", "(", "[", "0", ",", "1", ",", "2", ",", "3", "]", ")", "#rote", "\n", "im1", "=", "np", ".", "rot90", "(", "im1", ",", "angle", ")", "\n", "im2", "=", "np", ".", "rot90", "(", "im2", ",", "angle", ")", "\n", "\n", "# have to copy before be called by transform function", "\n", "return", "im1", ".", "copy", "(", ")", ",", "im2", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.parse_args": [[18, 30], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.parse_args"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "parser", ".", "add_argument", "(", "\"--model\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_path\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--group\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "parser", ".", "add_argument", "(", "\"--sample_dir\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--test_data_dir\"", ",", "type", "=", "str", ",", "default", "=", "\"dataset/Urban100\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--cuda\"", ",", "action", "=", "\"store_true\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--scale\"", ",", "type", "=", "int", ",", "default", "=", "4", ")", "\n", "parser", ".", "add_argument", "(", "\"--shave\"", ",", "type", "=", "int", ",", "default", "=", "20", ")", "\n", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.save_image": [[32, 37], ["tensor.cpu.cpu", "tensor.cpu.mul().clamp().byte().permute().numpy", "PIL.Image.fromarray", "Image.fromarray.save", "tensor.cpu.mul().clamp().byte().permute", "tensor.cpu.mul().clamp().byte", "tensor.cpu.mul().clamp", "tensor.cpu.mul"], "function", ["None"], ["", "def", "save_image", "(", "tensor", ",", "filename", ")", ":", "\n", "    ", "tensor", "=", "tensor", ".", "cpu", "(", ")", "\n", "ndarr", "=", "tensor", ".", "mul", "(", "255", ")", ".", "clamp", "(", "0", ",", "255", ")", ".", "byte", "(", ")", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "numpy", "(", ")", "\n", "im", "=", "Image", ".", "fromarray", "(", "ndarr", ")", "\n", "im", ".", "save", "(", "filename", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.psnr": [[38, 48], ["tcw_sample.psnr.im2double"], "function", ["None"], ["", "def", "psnr", "(", "im1", ",", "im2", ")", ":", "#tcw201904101621", "\n", "    ", "def", "im2double", "(", "im", ")", ":", "\n", "        ", "min_val", ",", "max_val", "=", "0", ",", "255", "\n", "out", "=", "(", "im", ".", "astype", "(", "np", ".", "float64", ")", "-", "min_val", ")", "/", "(", "max_val", "-", "min_val", ")", "\n", "return", "out", "\n", "\n", "", "im1", "=", "im2double", "(", "im1", ")", "\n", "im2", "=", "im2double", "(", "im2", ")", "\n", "psnr", "=", "measure", ".", "compare_psnr", "(", "im1", ",", "im2", ",", "data_range", "=", "1", ")", "\n", "return", "psnr", "\n", "#tcw20190413043", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.calculate_ssim": [[49, 72], ["ValueError", "tcw_sample.ssim", "ValueError", "range", "numpy.array().mean", "ssims.append", "tcw_sample.ssim", "tcw_sample.ssim", "numpy.array", "numpy.squeeze", "numpy.squeeze"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.ssim", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.ssim", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.ssim"], ["", "def", "calculate_ssim", "(", "img1", ",", "img2", ",", "border", "=", "0", ")", ":", "\n", "    ", "'''calculate SSIM\n    the same outputs as MATLAB's\n    img1, img2: [0, 255]\n    '''", "\n", "if", "not", "img1", ".", "shape", "==", "img2", ".", "shape", ":", "\n", "        ", "raise", "ValueError", "(", "'Input images must have the same dimensions.'", ")", "\n", "", "h", ",", "w", "=", "img1", ".", "shape", "[", ":", "2", "]", "\n", "img1", "=", "img1", "[", "border", ":", "h", "-", "border", ",", "border", ":", "w", "-", "border", "]", "\n", "img2", "=", "img2", "[", "border", ":", "h", "-", "border", ",", "border", ":", "w", "-", "border", "]", "\n", "\n", "if", "img1", ".", "ndim", "==", "2", ":", "\n", "        ", "return", "ssim", "(", "img1", ",", "img2", ")", "\n", "", "elif", "img1", ".", "ndim", "==", "3", ":", "\n", "        ", "if", "img1", ".", "shape", "[", "2", "]", "==", "3", ":", "\n", "            ", "ssims", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "3", ")", ":", "\n", "                ", "ssims", ".", "append", "(", "ssim", "(", "img1", ",", "img2", ")", ")", "\n", "", "return", "np", ".", "array", "(", "ssims", ")", ".", "mean", "(", ")", "\n", "", "elif", "img1", ".", "shape", "[", "2", "]", "==", "1", ":", "\n", "            ", "return", "ssim", "(", "np", ".", "squeeze", "(", "img1", ")", ",", "np", ".", "squeeze", "(", "img2", ")", ")", "\n", "", "", "else", ":", "\n", "        ", "raise", "ValueError", "(", "'Wrong input image dimensions.'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.ssim": [[73, 94], ["img1.astype.astype", "img2.astype.astype", "cv2.getGaussianKernel", "numpy.outer", "ssim_map.mean", "cv2.getGaussianKernel.transpose", "cv2.filter2D", "cv2.filter2D", "cv2.filter2D", "cv2.filter2D", "cv2.filter2D"], "function", ["None"], ["", "", "def", "ssim", "(", "img1", ",", "img2", ")", ":", "\n", "    ", "C1", "=", "(", "0.01", "*", "255", ")", "**", "2", "\n", "C2", "=", "(", "0.03", "*", "255", ")", "**", "2", "\n", "\n", "img1", "=", "img1", ".", "astype", "(", "np", ".", "float64", ")", "\n", "img2", "=", "img2", ".", "astype", "(", "np", ".", "float64", ")", "\n", "kernel", "=", "cv2", ".", "getGaussianKernel", "(", "11", ",", "1.5", ")", "\n", "window", "=", "np", ".", "outer", "(", "kernel", ",", "kernel", ".", "transpose", "(", ")", ")", "\n", "\n", "mu1", "=", "cv2", ".", "filter2D", "(", "img1", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "# valid", "\n", "mu2", "=", "cv2", ".", "filter2D", "(", "img2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "\n", "mu1_sq", "=", "mu1", "**", "2", "\n", "mu2_sq", "=", "mu2", "**", "2", "\n", "mu1_mu2", "=", "mu1", "*", "mu2", "\n", "sigma1_sq", "=", "cv2", ".", "filter2D", "(", "img1", "**", "2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "-", "mu1_sq", "\n", "sigma2_sq", "=", "cv2", ".", "filter2D", "(", "img2", "**", "2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "-", "mu2_sq", "\n", "sigma12", "=", "cv2", ".", "filter2D", "(", "img1", "*", "img2", ",", "-", "1", ",", "window", ")", "[", "5", ":", "-", "5", ",", "5", ":", "-", "5", "]", "-", "mu1_mu2", "\n", "\n", "ssim_map", "=", "(", "(", "2", "*", "mu1_mu2", "+", "C1", ")", "*", "(", "2", "*", "sigma12", "+", "C2", ")", ")", "/", "(", "(", "mu1_sq", "+", "mu2_sq", "+", "C1", ")", "*", "\n", "(", "sigma1_sq", "+", "sigma2_sq", "+", "C2", ")", ")", "\n", "return", "ssim_map", ".", "mean", "(", ")", "\n", "", "def", "rgb2ycbcr", "(", "img", ",", "only_y", "=", "True", ")", ":", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.rgb2ycbcr": [[94, 117], ["img.astype", "rlt.round.astype", "rlt.round.round", "numpy.dot", "numpy.matmul"], "function", ["None"], ["", "def", "rgb2ycbcr", "(", "img", ",", "only_y", "=", "True", ")", ":", "\n", "    ", "in_img_type", "=", "img", ".", "dtype", "\n", "img", ".", "astype", "(", "np", ".", "float32", ")", "\n", "if", "in_img_type", "!=", "np", ".", "uint8", ":", "\n", "        ", "img", "*=", "255.", "\n", "# convert", "\n", "", "if", "only_y", ":", "\n", "        ", "rlt", "=", "np", ".", "dot", "(", "img", ",", "[", "65.481", ",", "128.553", ",", "24.966", "]", ")", "/", "255.0", "+", "16.0", "\n", "", "else", ":", "\n", "        ", "rlt", "=", "np", ".", "matmul", "(", "img", ",", "[", "[", "65.481", ",", "-", "37.797", ",", "112.0", "]", ",", "[", "128.553", ",", "-", "74.203", ",", "-", "93.786", "]", ",", "\n", "[", "24.966", ",", "112.0", ",", "-", "18.214", "]", "]", ")", "/", "255.0", "+", "[", "16", ",", "128", ",", "128", "]", "\n", "", "if", "in_img_type", "==", "np", ".", "uint8", ":", "\n", "        ", "rlt", "=", "rlt", ".", "round", "(", ")", "\n", "", "else", ":", "\n", "        ", "rlt", "/=", "255.", "\n", "", "return", "rlt", ".", "astype", "(", "in_img_type", ")", "\n", "\n", "", "def", "sample", "(", "net", ",", "device", ",", "dataset", ",", "cfg", ")", ":", "\n", "    ", "scale", "=", "cfg", ".", "scale", "\n", "mean_psnr", "=", "0", "\n", "mean_psnr1", "=", "0", "\n", "mean_psnr2", "=", "0", "\n", "mean_ssim", "=", "0", "#tcw20190413047", "\n", "i", "=", "0", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.sample": [[118, 242], ["enumerate", "print", "os.path.join", "os.path.join", "os.path.join", "os.path.join", "tcw_sample.save_image", "tcw_sample.save_image", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp().byte().permute().numpy", "net().detach().squeeze.cpu().mul().clamp().byte().permute().numpy", "tcw_sample.rgb2ycbcr", "tcw_sample.rgb2ycbcr", "time.time", "torch.tensor", "torch.tensor", "lr_patch[].copy_", "lr_patch[].copy_", "lr_patch[].copy_", "lr_patch[].copy_", "lr_patch.to.to", "net().detach", "torch.tensor().to", "torch.tensor().to", "result[].copy_", "result[].copy_", "result[].copy_", "result[].copy_", "time.time", "time.time", "lr.squeeze.unsqueeze().to", "net().detach().squeeze", "lr.squeeze.squeeze", "time.time", "[].split", "os.path.exists", "os.makedirs", "os.path.exists", "os.makedirs", "tcw_sample.psnr", "len", "tcw_sample.calculate_ssim", "len", "lr.squeeze.size", "int", "int", "cfg.test_data_dir.split", "cfg.test_data_dir.split", "name.replace", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp().byte().permute", "net().detach().squeeze.cpu().mul().clamp().byte().permute", "net", "torch.tensor", "torch.tensor", "lr.squeeze.unsqueeze", "net().detach", "cfg.ckpt_path.split", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp().byte", "net().detach().squeeze.cpu().mul().clamp().byte", "net", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul().clamp", "net().detach().squeeze.cpu().mul().clamp", "hr.cpu().mul().clamp().byte().permute().numpy.cpu().mul", "net().detach().squeeze.cpu().mul", "hr.cpu().mul().clamp().byte().permute().numpy.cpu", "net().detach().squeeze.cpu"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.save_image", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.save_image", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.rgb2ycbcr", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.rgb2ycbcr", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.psnr", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.calculate_ssim"], ["for", "step", ",", "(", "hr", ",", "lr", ",", "name", ")", "in", "enumerate", "(", "dataset", ")", ":", "\n", "        ", "if", "\"DIV2K\"", "in", "dataset", ".", "name", ":", "\n", "            ", "t1", "=", "time", ".", "time", "(", ")", "\n", "h", ",", "w", "=", "lr", ".", "size", "(", ")", "[", "1", ":", "]", "\n", "h_half", ",", "w_half", "=", "int", "(", "h", "/", "2", ")", ",", "int", "(", "w", "/", "2", ")", "\n", "h_chop", ",", "w_chop", "=", "h_half", "+", "cfg", ".", "shave", ",", "w_half", "+", "cfg", ".", "shave", "\n", "\n", "lr_patch", "=", "torch", ".", "tensor", "(", "(", "4", ",", "3", ",", "h_chop", ",", "w_chop", ")", ",", "dtype", "=", "torch", ".", "float", ")", "\n", "lr_patch", "[", "0", "]", ".", "copy_", "(", "lr", "[", ":", ",", "0", ":", "h_chop", ",", "0", ":", "w_chop", "]", ")", "\n", "lr_patch", "[", "1", "]", ".", "copy_", "(", "lr", "[", ":", ",", "0", ":", "h_chop", ",", "w", "-", "w_chop", ":", "w", "]", ")", "\n", "lr_patch", "[", "2", "]", ".", "copy_", "(", "lr", "[", ":", ",", "h", "-", "h_chop", ":", "h", ",", "0", ":", "w_chop", "]", ")", "\n", "lr_patch", "[", "3", "]", ".", "copy_", "(", "lr", "[", ":", ",", "h", "-", "h_chop", ":", "h", ",", "w", "-", "w_chop", ":", "w", "]", ")", "\n", "lr_patch", "=", "lr_patch", ".", "to", "(", "device", ")", "\n", "\n", "sr", "=", "net", "(", "lr_patch", ",", "cfg", ".", "scale", ")", ".", "detach", "(", ")", "\n", "\n", "h", ",", "h_half", ",", "h_chop", "=", "h", "*", "scale", ",", "h_half", "*", "scale", ",", "h_chop", "*", "scale", "\n", "w", ",", "w_half", ",", "w_chop", "=", "w", "*", "scale", ",", "w_half", "*", "scale", ",", "w_chop", "*", "scale", "\n", "\n", "result", "=", "torch", ".", "tensor", "(", "(", "3", ",", "h", ",", "w", ")", ",", "dtype", "=", "torch", ".", "float", ")", ".", "to", "(", "device", ")", "\n", "result", "[", ":", ",", "0", ":", "h_half", ",", "0", ":", "w_half", "]", ".", "copy_", "(", "sr", "[", "0", ",", ":", ",", "0", ":", "h_half", ",", "0", ":", "w_half", "]", ")", "\n", "result", "[", ":", ",", "0", ":", "h_half", ",", "w_half", ":", "w", "]", ".", "copy_", "(", "sr", "[", "1", ",", ":", ",", "0", ":", "h_half", ",", "w_chop", "-", "w", "+", "w_half", ":", "w_chop", "]", ")", "\n", "result", "[", ":", ",", "h_half", ":", "h", ",", "0", ":", "w_half", "]", ".", "copy_", "(", "sr", "[", "2", ",", ":", ",", "h_chop", "-", "h", "+", "h_half", ":", "h_chop", ",", "0", ":", "w_half", "]", ")", "\n", "result", "[", ":", ",", "h_half", ":", "h", ",", "w_half", ":", "w", "]", ".", "copy_", "(", "sr", "[", "3", ",", ":", ",", "h_chop", "-", "h", "+", "h_half", ":", "h_chop", ",", "w_chop", "-", "w", "+", "w_half", ":", "w_chop", "]", ")", "\n", "sr", "=", "result", "\n", "t2", "=", "time", ".", "time", "(", ")", "\n", "", "else", ":", "\n", "            ", "t1", "=", "time", ".", "time", "(", ")", "\n", "lr", "=", "lr", ".", "unsqueeze", "(", "0", ")", ".", "to", "(", "device", ")", "\n", "sr", "=", "net", "(", "lr", ",", "cfg", ".", "scale", ")", ".", "detach", "(", ")", ".", "squeeze", "(", "0", ")", "#detach() break the reversed transformation.", "\n", "#print sr.size() #(3,1024,1024)", "\n", "lr", "=", "lr", ".", "squeeze", "(", "0", ")", "\n", "#print lr.size() #(3,512,512)", "\n", "t2", "=", "time", ".", "time", "(", ")", "\n", "", "model_name", "=", "cfg", ".", "ckpt_path", ".", "split", "(", "\".\"", ")", "[", "0", "]", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "#''", "\n", "sr_dir", "=", "os", ".", "path", ".", "join", "(", "cfg", ".", "sample_dir", ",", "\n", "model_name", ",", "\n", "cfg", ".", "test_data_dir", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", ",", "\n", "\"x{}\"", ".", "format", "(", "cfg", ".", "scale", ")", ",", "\n", "\"SR\"", ")", "\n", "hr_dir", "=", "os", ".", "path", ".", "join", "(", "cfg", ".", "sample_dir", ",", "\n", "model_name", ",", "\n", "cfg", ".", "test_data_dir", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", ",", "\n", "\"x{}\"", ".", "format", "(", "cfg", ".", "scale", ")", ",", "\n", "\"HR\"", ")", "\n", "#print sr_dir #sample/Urban100/x2/SR", "\n", "#print hr_dir #sample/Urban100/x2/HR", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "sr_dir", ")", ":", "#201904072208 tcw", "\n", "#os.makedirs(sr_dir, exist_ok=Ture)             #201904072211tcw, it is given at first, but it is wrong. So, I mark it.", "\n", "#os.makedirs(hr_dir, exist_ok=Ture)", "\n", "            ", "os", ".", "makedirs", "(", "sr_dir", ",", "mode", "=", "0o777", ")", "\n", "", "if", "not", "os", ".", "path", ".", "exists", "(", "hr_dir", ")", ":", "#201904072208 tcw", "\n", "            ", "os", ".", "makedirs", "(", "hr_dir", ",", "mode", "=", "0o777", ")", "\n", "\n", "", "sr_im_path", "=", "os", ".", "path", ".", "join", "(", "sr_dir", ",", "\"{}\"", ".", "format", "(", "name", ".", "replace", "(", "\"HR\"", ",", "\"SR\"", ")", ")", ")", "#use SR instead of HR in the name of high-resolution image", "\n", "hr_im_path", "=", "os", ".", "path", ".", "join", "(", "hr_dir", ",", "\"{}\"", ".", "format", "(", "name", ")", ")", "#name is a name of high-resolution image", "\n", "#print sr_im_path #sample/Urban100/x2/SR/img_100_SRF_2_SR.png", "\n", "#print hr_im_path #sample/Urban100/x2/HR/img_100_SRF_2_HR.png", "\n", "save_image", "(", "sr", ",", "sr_im_path", ")", "\n", "save_image", "(", "hr", ",", "hr_im_path", ")", "\n", "hr", "=", "hr", ".", "cpu", "(", ")", ".", "mul", "(", "255", ")", ".", "clamp", "(", "0", ",", "255", ")", ".", "byte", "(", ")", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "numpy", "(", ")", "#(644.1024,3) is the same dimensional with the size of input test image in dataset.py. #201904101617tcw", "\n", "sr", "=", "sr", ".", "cpu", "(", ")", ".", "mul", "(", "255", ")", ".", "clamp", "(", "0", ",", "255", ")", ".", "byte", "(", ")", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "numpy", "(", ")", "#tcw201904101617", "\n", "bnd", "=", "scale", "#tcw", "\n", "sr_1", "=", "rgb2ycbcr", "(", "sr", ")", "\n", "hr_1", "=", "rgb2ycbcr", "(", "hr", ")", "\n", "sr_1", "=", "sr_1", "[", "bnd", ":", "-", "bnd", ",", "bnd", ":", "-", "bnd", "]", "#tcw201904111837", "\n", "hr_1", "=", "hr_1", "[", "bnd", ":", "-", "bnd", ",", "bnd", ":", "-", "bnd", "]", "#tcw201904111837", "\n", "mean_psnr2", "+=", "psnr", "(", "sr_1", ",", "hr_1", ")", "/", "len", "(", "dataset", ")", "\n", "mean_ssim", "+=", "calculate_ssim", "(", "sr_1", ",", "hr_1", ")", "/", "len", "(", "dataset", ")", "\n", "", "print", "(", "mean_psnr2", ",", "mean_ssim", ")", "\n", "#print '-------------------'z", "\n", "\n", "", "def", "main", "(", "cfg", ")", ":", "\n", "    ", "module", "=", "importlib", ".", "import_module", "(", "\"model.{}\"", ".", "format", "(", "cfg", ".", "model", ")", ")", "\n", "net", "=", "module", ".", "Net", "(", "scale", "=", "cfg", ".", "scale", ",", "\n", "group", "=", "cfg", ".", "group", ")", "\n", "print", "(", "json", ".", "dumps", "(", "vars", "(", "cfg", ")", ",", "indent", "=", "4", ",", "sort_keys", "=", "True", ")", ")", "#print cfg information according order.", "\n", "state_dict", "=", "torch", ".", "load", "(", "cfg", ".", "ckpt_path", ")", "\n", "new_state_dict", "=", "OrderedDict", "(", ")", "\n", "for", "k", ",", "v", "in", "state_dict", ".", "items", "(", ")", ":", "\n", "        ", "name", "=", "k", "\n", "# name = k[7:] # remove \"module.\"", "\n", "new_state_dict", "[", "name", "]", "=", "v", "\n", "\n", "", "net", ".", "load_state_dict", "(", "new_state_dict", ")", "\n", "device", "=", "torch", ".", "device", "(", "\"cuda:0\"", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", "else", "\"cpu\"", ")", "#0 is number of gpu, if this gpu1 is work, you can set it into 1 (device=torch.device(\"cuda:1\" if torch.cuda.is_available() else \"cpu\"))", "\n", "net", "=", "net", ".", "to", "(", "device", ")", "\n", "dataset", "=", "TestDataset", "(", "cfg", ".", "test_data_dir", ",", "cfg", ".", "scale", ")", "\n", "sample", "(", "net", ",", "device", ",", "dataset", ",", "cfg", ")", "\n", "\n", "\n", "", "if", "__name__", "==", "\"__main__\"", ":", "\n", "    ", "cfg", "=", "parse_args", "(", ")", "\n", "main", "(", "cfg", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.main": [[244, 281], ["importlib.import_module", "importlib.import_module.Net", "print", "torch.load", "torch.load", "collections.OrderedDict", "torch.load.items", "net.to.load_state_dict", "torch.device", "torch.device", "net.to.to", "dataset.TestDataset", "tcw_sample.sample", "json.dumps", "vars", "torch.cuda.is_available", "torch.cuda.is_available"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.tcw_sample.sample"], []], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.train.parse_args": [[9, 42], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.parse_args"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "parser", ".", "add_argument", "(", "\"--model\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_name\"", ",", "type", "=", "str", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--print_interval\"", ",", "type", "=", "int", ",", "default", "=", "1000", ")", "#original data is 1000", "\n", "parser", ".", "add_argument", "(", "\"--train_data_path\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"dataset/DIV2K_train.h5\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"checkpoint\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--sample_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"sample/\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--num_gpu\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "parser", ".", "add_argument", "(", "\"--shave\"", ",", "type", "=", "int", ",", "default", "=", "20", ")", "\n", "parser", ".", "add_argument", "(", "\"--scale\"", ",", "type", "=", "int", ",", "default", "=", "2", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--verbose\"", ",", "action", "=", "\"store_true\"", ",", "default", "=", "\"store_true\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--group\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--patch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--batch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--max_steps\"", ",", "type", "=", "int", ",", "default", "=", "200000", ")", "\n", "parser", ".", "add_argument", "(", "\"--decay\"", ",", "type", "=", "int", ",", "default", "=", "150000", ")", "\n", "parser", ".", "add_argument", "(", "\"--lr\"", ",", "type", "=", "float", ",", "default", "=", "0.0001", ")", "\n", "parser", ".", "add_argument", "(", "\"--clip\"", ",", "type", "=", "float", ",", "default", "=", "10.0", ")", "\n", "\n", "#parser.add_argument(\"--loss_fn\", type=str, ", "\n", "#choices=[\"MSE\", \"L1\", \"SmoothL1\"], default=\"L1\") #tcw201904082029", "\n", "parser", ".", "add_argument", "(", "\"--loss_fn\"", ",", "type", "=", "str", ",", "\n", "choices", "=", "[", "\"MSE\"", ",", "\"L1\"", ",", "\"SmoothL1\"", "]", ",", "default", "=", "\"MSE\"", ")", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.train.main": [[43, 51], ["print", "solver.Solver", "solver.Solver.fit", "importlib.import_module", "json.dumps", "vars"], "function", ["None"], ["", "def", "main", "(", "cfg", ")", ":", "\n", "# dynamic import using --model argument", "\n", "    ", "net", "=", "importlib", ".", "import_module", "(", "\"model.{}\"", ".", "format", "(", "cfg", ".", "model", ")", ")", ".", "Net", "\n", "print", "(", "json", ".", "dumps", "(", "vars", "(", "cfg", ")", ",", "indent", "=", "4", ",", "sort_keys", "=", "True", ")", ")", "\n", "\n", "solver", "=", "Solver", "(", "net", ",", "cfg", ")", "\n", "#print 'ds'", "\n", "solver", ".", "fit", "(", ")", "\n", "#print 'sdsddwdew'", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.TrainDataset.__init__": [[42, 62], ["torch.Dataset.__init__", "h5py.File", "h5py.File.close", "torchvision.Compose", "h5f[].values", "torchvision.ToTensor", "h5f[].values", "h5f[].values"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "path", ",", "size", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TrainDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "size", "=", "size", "\n", "h5f", "=", "h5py", ".", "File", "(", "path", ",", "\"r\"", ")", "\n", "\n", "self", ".", "hr", "=", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"HR\"", "]", ".", "values", "(", ")", "]", "\n", "# perform multi-scale training", "\n", "if", "scale", "==", "0", ":", "\n", "            ", "self", ".", "scale", "=", "[", "2", ",", "3", ",", "4", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "i", ")", "]", ".", "values", "(", ")", "]", "for", "i", "in", "self", ".", "scale", "]", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "scale", "=", "[", "scale", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "scale", ")", "]", ".", "values", "(", ")", "]", "]", "\n", "\n", "", "h5f", ".", "close", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.TrainDataset.__getitem__": [[64, 72], ["dataset.random_crop", "dataset.random_flip_and_rotate", "enumerate", "enumerate", "dataset.TrainDataset.transform", "dataset.TrainDataset.transform"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_crop", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_flip_and_rotate"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "size", "=", "self", ".", "size", "\n", "item", "=", "[", "(", "self", ".", "hr", "[", "index", "]", ",", "self", ".", "lr", "[", "i", "]", "[", "index", "]", ")", "for", "i", ",", "_", "in", "enumerate", "(", "self", ".", "lr", ")", "]", "\n", "#i is the number, _ is the context", "\n", "item", "=", "[", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "self", ".", "scale", "[", "i", "]", ")", "for", "i", ",", "(", "hr", ",", "lr", ")", "in", "enumerate", "(", "item", ")", "]", "\n", "item", "=", "[", "random_flip_and_rotate", "(", "hr", ",", "lr", ")", "for", "hr", ",", "lr", "in", "item", "]", "\n", "\n", "return", "[", "(", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ")", "for", "hr", ",", "lr", "in", "item", "]", "#tranform array (hr,lr) into tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.TrainDataset.__len__": [[73, 75], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.TestDataset.__init__": [[78, 98], ["torch.Dataset.__init__", "dataset.TestDataset.hr.sort", "dataset.TestDataset.lr.sort", "torchvision.Compose", "dirname.split", "glob.glob", "glob.glob", "glob.glob", "os.path.join", "os.path.join", "os.path.join", "torchvision.ToTensor"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dirname", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TestDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "name", "=", "dirname", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "self", ".", "scale", "=", "scale", "\n", "\n", "if", "\"DIV\"", "in", "self", ".", "name", ":", "\n", "            ", "self", ".", "hr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_HR\"", ".", "format", "(", "dirname", ")", ",", "\"*.png\"", ")", ")", "\n", "self", ".", "lr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_LR_bicubic\"", ".", "format", "(", "dirname", ")", ",", "\n", "\"X{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "", "else", ":", "\n", "            ", "all_files", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "dirname", ",", "\"x{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "self", ".", "hr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"HR\"", "in", "name", "]", "\n", "self", ".", "lr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"LR\"", "in", "name", "]", "\n", "\n", "", "self", ".", "hr", ".", "sort", "(", ")", "\n", "self", ".", "lr", ".", "sort", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.TestDataset.__getitem__": [[100, 117], ["PIL.Image.open", "PIL.Image.open", "hr.convert.convert.convert", "lr.convert.convert.convert", "dataset.TestDataset.hr[].split", "dataset.TestDataset.transform", "dataset.TestDataset.transform"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "hr", "=", "Image", ".", "open", "(", "self", ".", "hr", "[", "index", "]", ")", "\n", "lr", "=", "Image", ".", "open", "(", "self", ".", "lr", "[", "index", "]", ")", "\n", "'''\n        #This is only used to test code, which makes me more know the code. \n        ss = np.asarray(hr) (644,1024,3)\n        print ss.shape\n        '''", "\n", "hr", "=", "hr", ".", "convert", "(", "\"RGB\"", ")", "\n", "lr", "=", "lr", ".", "convert", "(", "\"RGB\"", ")", "\n", "'''\n        tss = np.asarray(hr) (644,1024,3)\n        print tss.shape\n        '''", "\n", "filename", "=", "self", ".", "hr", "[", "index", "]", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "#keep the last string, which is after /. For example, a= 'aaa/asds.bmp', a.split(\"/\")[-1] = asds ", "\n", "return", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ",", "filename", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.TestDataset.__len__": [[118, 120], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.random_crop": [[10, 22], ["random.randint", "random.randint", "lr[].copy", "hr[].copy"], "function", ["None"], ["def", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "scale", ")", ":", "\n", "    ", "h", ",", "w", "=", "lr", ".", "shape", "[", ":", "-", "1", "]", "#h,w,channel [:-1] beside the final element, such as channel ", "\n", "x", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "size", ")", "#random number", "\n", "y", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "size", ")", "\n", "\n", "hsize", "=", "size", "*", "scale", "\n", "hx", ",", "hy", "=", "x", "*", "scale", ",", "y", "*", "scale", "\n", "\n", "crop_lr", "=", "lr", "[", "y", ":", "y", "+", "size", ",", "x", ":", "x", "+", "size", "]", ".", "copy", "(", ")", "#low-resolution patch", "\n", "crop_hr", "=", "hr", "[", "hy", ":", "hy", "+", "hsize", ",", "hx", ":", "hx", "+", "hsize", "]", ".", "copy", "(", ")", "#high-resolution patch", "\n", "\n", "return", "crop_hr", ",", "crop_lr", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.x4.dataset.random_flip_and_rotate": [[24, 39], ["random.choice", "numpy.rot90", "numpy.rot90", "random.random", "numpy.flipud", "numpy.flipud", "random.random", "numpy.fliplr", "numpy.fliplr", "np.fliplr.copy", "np.fliplr.copy"], "function", ["None"], ["", "def", "random_flip_and_rotate", "(", "im1", ",", "im2", ")", ":", "\n", "    ", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "\n", "        ", "im1", "=", "np", ".", "flipud", "(", "im1", ")", "#left and right move", "\n", "im2", "=", "np", ".", "flipud", "(", "im2", ")", "\n", "\n", "", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "#up and down move", "\n", "        ", "im1", "=", "np", ".", "fliplr", "(", "im1", ")", "\n", "im2", "=", "np", ".", "fliplr", "(", "im2", ")", "\n", "\n", "", "angle", "=", "random", ".", "choice", "(", "[", "0", ",", "1", ",", "2", ",", "3", "]", ")", "#rote", "\n", "im1", "=", "np", ".", "rot90", "(", "im1", ",", "angle", ")", "\n", "im2", "=", "np", ".", "rot90", "(", "im2", ",", "angle", ")", "\n", "\n", "# have to copy before be called by transform function", "\n", "return", "im1", ".", "copy", "(", ")", ",", "im2", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.parse_args": [[9, 42], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.parse_args"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "parser", ".", "add_argument", "(", "\"--model\"", ",", "type", "=", "str", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_name\"", ",", "type", "=", "str", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--print_interval\"", ",", "type", "=", "int", ",", "default", "=", "1000", ")", "#original data is 1000", "\n", "parser", ".", "add_argument", "(", "\"--train_data_path\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"dataset/DIV2K_train.h5\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--ckpt_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"checkpoint\"", ")", "\n", "parser", ".", "add_argument", "(", "\"--sample_dir\"", ",", "type", "=", "str", ",", "\n", "default", "=", "\"sample/\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--num_gpu\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "parser", ".", "add_argument", "(", "\"--shave\"", ",", "type", "=", "int", ",", "default", "=", "20", ")", "\n", "parser", ".", "add_argument", "(", "\"--scale\"", ",", "type", "=", "int", ",", "default", "=", "2", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--verbose\"", ",", "action", "=", "\"store_true\"", ",", "default", "=", "\"store_true\"", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--group\"", ",", "type", "=", "int", ",", "default", "=", "1", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--patch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--batch_size\"", ",", "type", "=", "int", ",", "default", "=", "64", ")", "\n", "parser", ".", "add_argument", "(", "\"--max_steps\"", ",", "type", "=", "int", ",", "default", "=", "200000", ")", "\n", "parser", ".", "add_argument", "(", "\"--decay\"", ",", "type", "=", "int", ",", "default", "=", "150000", ")", "\n", "parser", ".", "add_argument", "(", "\"--lr\"", ",", "type", "=", "float", ",", "default", "=", "0.0001", ")", "\n", "parser", ".", "add_argument", "(", "\"--clip\"", ",", "type", "=", "float", ",", "default", "=", "10.0", ")", "\n", "\n", "#parser.add_argument(\"--loss_fn\", type=str, ", "\n", "#choices=[\"MSE\", \"L1\", \"SmoothL1\"], default=\"L1\") #tcw201904082029", "\n", "parser", ".", "add_argument", "(", "\"--loss_fn\"", ",", "type", "=", "str", ",", "\n", "choices", "=", "[", "\"MSE\"", ",", "\"L1\"", ",", "\"SmoothL1\"", "]", ",", "default", "=", "\"MSE\"", ")", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.train.main": [[43, 51], ["print", "solver.Solver", "solver.Solver.fit", "importlib.import_module", "json.dumps", "vars"], "function", ["None"], ["", "def", "main", "(", "cfg", ")", ":", "\n", "# dynamic import using --model argument", "\n", "    ", "net", "=", "importlib", ".", "import_module", "(", "\"model.{}\"", ".", "format", "(", "cfg", ".", "model", ")", ")", ".", "Net", "\n", "print", "(", "json", ".", "dumps", "(", "vars", "(", "cfg", ")", ",", "indent", "=", "4", ",", "sort_keys", "=", "True", ")", ")", "\n", "\n", "solver", "=", "Solver", "(", "net", ",", "cfg", ")", "\n", "#print 'ds'", "\n", "solver", ".", "fit", "(", ")", "\n", "#print 'sdsddwdew'", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TrainDataset.__init__": [[42, 62], ["torch.Dataset.__init__", "h5py.File", "h5py.File.close", "torchvision.Compose", "h5f[].values", "torchvision.ToTensor", "h5f[].values", "h5f[].values"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "path", ",", "size", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TrainDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "size", "=", "size", "\n", "h5f", "=", "h5py", ".", "File", "(", "path", ",", "\"r\"", ")", "\n", "\n", "self", ".", "hr", "=", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"HR\"", "]", ".", "values", "(", ")", "]", "\n", "# perform multi-scale training", "\n", "if", "scale", "==", "0", ":", "\n", "            ", "self", ".", "scale", "=", "[", "2", ",", "3", ",", "4", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "i", ")", "]", ".", "values", "(", ")", "]", "for", "i", "in", "self", ".", "scale", "]", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "scale", "=", "[", "scale", "]", "\n", "self", ".", "lr", "=", "[", "[", "v", "[", ":", "]", "for", "v", "in", "h5f", "[", "\"X{}\"", ".", "format", "(", "scale", ")", "]", ".", "values", "(", ")", "]", "]", "\n", "\n", "", "h5f", ".", "close", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TrainDataset.__getitem__": [[64, 72], ["dataset.random_crop", "dataset.random_flip_and_rotate", "enumerate", "enumerate", "dataset.TrainDataset.transform", "dataset.TrainDataset.transform"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_crop", "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_flip_and_rotate"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "size", "=", "self", ".", "size", "\n", "item", "=", "[", "(", "self", ".", "hr", "[", "index", "]", ",", "self", ".", "lr", "[", "i", "]", "[", "index", "]", ")", "for", "i", ",", "_", "in", "enumerate", "(", "self", ".", "lr", ")", "]", "\n", "#i is the number, _ is the context", "\n", "item", "=", "[", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "self", ".", "scale", "[", "i", "]", ")", "for", "i", ",", "(", "hr", ",", "lr", ")", "in", "enumerate", "(", "item", ")", "]", "\n", "item", "=", "[", "random_flip_and_rotate", "(", "hr", ",", "lr", ")", "for", "hr", ",", "lr", "in", "item", "]", "\n", "\n", "return", "[", "(", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ")", "for", "hr", ",", "lr", "in", "item", "]", "#tranform array (hr,lr) into tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TrainDataset.__len__": [[73, 75], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__": [[78, 98], ["torch.Dataset.__init__", "dataset.TestDataset.hr.sort", "dataset.TestDataset.lr.sort", "torchvision.Compose", "dirname.split", "glob.glob", "glob.glob", "glob.glob", "os.path.join", "os.path.join", "os.path.join", "torchvision.ToTensor"], "methods", ["home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dirname", ",", "scale", ")", ":", "\n", "        ", "super", "(", "TestDataset", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "name", "=", "dirname", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "self", ".", "scale", "=", "scale", "\n", "\n", "if", "\"DIV\"", "in", "self", ".", "name", ":", "\n", "            ", "self", ".", "hr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_HR\"", ".", "format", "(", "dirname", ")", ",", "\"*.png\"", ")", ")", "\n", "self", ".", "lr", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "\"{}_LR_bicubic\"", ".", "format", "(", "dirname", ")", ",", "\n", "\"X{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "", "else", ":", "\n", "            ", "all_files", "=", "glob", ".", "glob", "(", "os", ".", "path", ".", "join", "(", "dirname", ",", "\"x{}/*.png\"", ".", "format", "(", "scale", ")", ")", ")", "\n", "self", ".", "hr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"HR\"", "in", "name", "]", "\n", "self", ".", "lr", "=", "[", "name", "for", "name", "in", "all_files", "if", "\"LR\"", "in", "name", "]", "\n", "\n", "", "self", ".", "hr", ".", "sort", "(", ")", "\n", "self", ".", "lr", ".", "sort", "(", ")", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__getitem__": [[100, 117], ["PIL.Image.open", "PIL.Image.open", "hr.convert.convert.convert", "lr.convert.convert.convert", "dataset.TestDataset.hr[].split", "dataset.TestDataset.transform", "dataset.TestDataset.transform"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "hr", "=", "Image", ".", "open", "(", "self", ".", "hr", "[", "index", "]", ")", "\n", "lr", "=", "Image", ".", "open", "(", "self", ".", "lr", "[", "index", "]", ")", "\n", "'''\n        #This is only used to test code, which makes me more know the code. \n        ss = np.asarray(hr) (644,1024,3)\n        print ss.shape\n        '''", "\n", "hr", "=", "hr", ".", "convert", "(", "\"RGB\"", ")", "\n", "lr", "=", "lr", ".", "convert", "(", "\"RGB\"", ")", "\n", "'''\n        tss = np.asarray(hr) (644,1024,3)\n        print tss.shape\n        '''", "\n", "filename", "=", "self", ".", "hr", "[", "index", "]", ".", "split", "(", "\"/\"", ")", "[", "-", "1", "]", "\n", "#keep the last string, which is after /. For example, a= 'aaa/asds.bmp', a.split(\"/\")[-1] = asds ", "\n", "return", "self", ".", "transform", "(", "hr", ")", ",", "self", ".", "transform", "(", "lr", ")", ",", "filename", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.TestDataset.__len__": [[118, 120], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "hr", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_crop": [[10, 22], ["random.randint", "random.randint", "lr[].copy", "hr[].copy"], "function", ["None"], ["def", "random_crop", "(", "hr", ",", "lr", ",", "size", ",", "scale", ")", ":", "\n", "    ", "h", ",", "w", "=", "lr", ".", "shape", "[", ":", "-", "1", "]", "#h,w,channel [:-1] beside the final element, such as channel ", "\n", "x", "=", "random", ".", "randint", "(", "0", ",", "w", "-", "size", ")", "#random number", "\n", "y", "=", "random", ".", "randint", "(", "0", ",", "h", "-", "size", ")", "\n", "\n", "hsize", "=", "size", "*", "scale", "\n", "hx", ",", "hy", "=", "x", "*", "scale", ",", "y", "*", "scale", "\n", "\n", "crop_lr", "=", "lr", "[", "y", ":", "y", "+", "size", ",", "x", ":", "x", "+", "size", "]", ".", "copy", "(", ")", "#low-resolution patch", "\n", "crop_hr", "=", "hr", "[", "hy", ":", "hy", "+", "hsize", ",", "hx", ":", "hx", "+", "hsize", "]", ".", "copy", "(", ")", "#high-resolution patch", "\n", "\n", "return", "crop_hr", ",", "crop_lr", "\n", "\n"]], "home.repos.pwc.inspect_result.hellloxiaotian_LESRCNN.lesrcnn_b.dataset.random_flip_and_rotate": [[24, 39], ["random.choice", "numpy.rot90", "numpy.rot90", "random.random", "numpy.flipud", "numpy.flipud", "random.random", "numpy.fliplr", "numpy.fliplr", "np.fliplr.copy", "np.fliplr.copy"], "function", ["None"], ["", "def", "random_flip_and_rotate", "(", "im1", ",", "im2", ")", ":", "\n", "    ", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "\n", "        ", "im1", "=", "np", ".", "flipud", "(", "im1", ")", "#left and right move", "\n", "im2", "=", "np", ".", "flipud", "(", "im2", ")", "\n", "\n", "", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "#up and down move", "\n", "        ", "im1", "=", "np", ".", "fliplr", "(", "im1", ")", "\n", "im2", "=", "np", ".", "fliplr", "(", "im2", ")", "\n", "\n", "", "angle", "=", "random", ".", "choice", "(", "[", "0", ",", "1", ",", "2", ",", "3", "]", ")", "#rote", "\n", "im1", "=", "np", ".", "rot90", "(", "im1", ",", "angle", ")", "\n", "im2", "=", "np", ".", "rot90", "(", "im2", ",", "angle", ")", "\n", "\n", "# have to copy before be called by transform function", "\n", "return", "im1", ".", "copy", "(", ")", ",", "im2", ".", "copy", "(", ")", "\n", "\n"]]}