{"home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.Convnet.__init__": [[15, 24], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "convnet.conv_block", "convnet.conv_block", "convnet.conv_block", "convnet.conv_block"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.__init__", "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.conv_block", "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.conv_block", "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.conv_block", "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.conv_block"], ["    ", "def", "__init__", "(", "self", ",", "x_dim", "=", "3", ",", "hid_dim", "=", "64", ",", "z_dim", "=", "64", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "encoder", "=", "nn", ".", "Sequential", "(", "\n", "conv_block", "(", "x_dim", ",", "hid_dim", ")", ",", "\n", "conv_block", "(", "hid_dim", ",", "hid_dim", ")", ",", "\n", "conv_block", "(", "hid_dim", ",", "hid_dim", ")", ",", "\n", "conv_block", "(", "hid_dim", ",", "z_dim", ")", ",", "\n", ")", "\n", "self", ".", "out_channels", "=", "1600", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.Convnet.forward": [[25, 28], ["convnet.Convnet.encoder", "convnet.Convnet.view", "convnet.Convnet.size"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.generator.encoder"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "encoder", "(", "x", ")", "\n", "return", "x", ".", "view", "(", "x", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.generator.__init__": [[30, 39], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.__init__"], ["    ", "def", "__init__", "(", "self", ",", "input", ",", "output", ")", ":", "\n", "        ", "super", "(", "generator", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "output", "=", "output", "\n", "self", ".", "fc1", "=", "nn", ".", "Linear", "(", "input", ",", "600", ")", "\n", "#self.fc2=nn.Linear(1000,1000)", "\n", "#self.fc3=nn.Linear(1000,1000)", "\n", "self", ".", "fc4", "=", "nn", ".", "Linear", "(", "600", ",", "2", "*", "self", ".", "output", ")", "\n", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.generator.reparameterize": [[40, 46], ["torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable.mul().add", "torch.autograd.Variable.mul().add", "var.data.new().normal_", "torch.autograd.Variable.mul", "torch.autograd.Variable.mul", "var.data.new", "var.size"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Averager.add", "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Averager.add"], ["", "def", "reparameterize", "(", "self", ",", "mean", ",", "var", ")", ":", "\n", "        ", "if", "self", ".", "training", ":", "\n", "            ", "eps", "=", "Variable", "(", "var", ".", "data", ".", "new", "(", "var", ".", "size", "(", ")", ")", ".", "normal_", "(", ")", ")", "\n", "return", "eps", ".", "mul", "(", "var", ")", ".", "add", "(", "mean", ")", "\n", "", "else", ":", "\n", "            ", "return", "mean", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.generator.encoder": [[47, 55], ["convnet.generator.relu", "torch.split", "torch.split", "torch.split", "torch.split", "logmean.exp", "convnet.generator.fc1", "convnet.generator.fc4", "torch.ones().cuda", "torch.ones().cuda", "torch.ones().cuda", "torch.ones().cuda", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "logvar.size"], "methods", ["None"], ["", "", "def", "encoder", "(", "self", ",", "x", ",", "output", ")", ":", "\n", "#rep=self.relu(self.fc3(self.relu(self.fc2(self.relu(self.fc1(x))))))", "\n", "        ", "rep", "=", "self", ".", "relu", "(", "self", ".", "fc1", "(", "x", ")", ")", "\n", "logmean", ",", "logvar", "=", "torch", ".", "split", "(", "self", ".", "fc4", "(", "rep", ")", ",", "output", ",", "dim", "=", "-", "1", ")", "\n", "mean", "=", "logmean", ".", "exp", "(", ")", "\n", "#var = logvar.exp()", "\n", "var", "=", "torch", ".", "ones", "(", "logvar", ".", "size", "(", ")", ")", ".", "cuda", "(", ")", "*", "1.0", "\n", "return", "mean", ",", "var", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.generator.forward": [[56, 59], ["convnet.generator.encoder", "convnet.generator.reparameterize"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.generator.encoder", "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.generator.reparameterize"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "mean", ",", "var", "=", "self", ".", "encoder", "(", "x", ",", "self", ".", "output", ")", "\n", "return", "self", ".", "reparameterize", "(", "mean", ",", "var", ")", ",", "mean", ",", "var", "", "", "", ""]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.convnet.conv_block": [[5, 11], ["torch.Sequential", "torch.Conv2d", "torch.BatchNorm2d", "torch.ReLU", "torch.MaxPool2d"], "function", ["None"], ["def", "conv_block", "(", "in_channels", ",", "out_channels", ")", ":", "\n", "    ", "return", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "3", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "MaxPool2d", "(", "2", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.samplers.CategoriesSampler.__init__": [[7, 18], ["numpy.array", "range", "numpy.argwhere().reshape", "torch.from_numpy", "samplers.CategoriesSampler.m_ind.append", "max", "numpy.argwhere"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "label", ",", "n_batch", ",", "n_cls", ",", "n_per", ")", ":", "\n", "        ", "self", ".", "n_batch", "=", "n_batch", "\n", "self", ".", "n_cls", "=", "n_cls", "\n", "self", ".", "n_per", "=", "n_per", "\n", "\n", "label", "=", "np", ".", "array", "(", "label", ")", "\n", "self", ".", "m_ind", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "max", "(", "label", ")", "+", "1", ")", ":", "\n", "            ", "ind", "=", "np", ".", "argwhere", "(", "label", "==", "i", ")", ".", "reshape", "(", "-", "1", ")", "\n", "ind", "=", "torch", ".", "from_numpy", "(", "ind", ")", "\n", "self", ".", "m_ind", ".", "append", "(", "ind", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.samplers.CategoriesSampler.__len__": [[19, 21], ["None"], "methods", ["None"], ["", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "n_batch", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.samplers.CategoriesSampler.__iter__": [[22, 32], ["range", "torch.stack().t().reshape", "torch.randperm", "torch.stack().t().reshape.append", "len", "torch.randperm", "torch.stack().t", "len", "torch.stack"], "methods", ["None"], ["", "def", "__iter__", "(", "self", ")", ":", "\n", "        ", "for", "i_batch", "in", "range", "(", "self", ".", "n_batch", ")", ":", "\n", "            ", "batch", "=", "[", "]", "\n", "classes", "=", "torch", ".", "randperm", "(", "len", "(", "self", ".", "m_ind", ")", ")", "[", ":", "self", ".", "n_cls", "]", "\n", "for", "c", "in", "classes", ":", "\n", "                ", "l", "=", "self", ".", "m_ind", "[", "c", "]", "\n", "pos", "=", "torch", ".", "randperm", "(", "len", "(", "l", ")", ")", "[", ":", "self", ".", "n_per", "]", "\n", "batch", ".", "append", "(", "l", "[", "pos", "]", ")", "\n", "", "batch", "=", "torch", ".", "stack", "(", "batch", ")", ".", "t", "(", ")", ".", "reshape", "(", "-", "1", ")", "\n", "yield", "batch", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.mini_imagenet.MiniImageNet.__init__": [[15, 40], ["os.join", "numpy.random.permutation", "torchvision.transforms.Compose", "l.split", "os.join", "data.append", "label.append", "len", "numpy.array", "numpy.array", "x.strip", "mini_imagenet.MiniImageNet.wnids.append", "torchvision.transforms.ToTensor", "open().readlines", "open"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "setname", ")", ":", "\n", "        ", "csv_path", "=", "osp", ".", "join", "(", "ROOT_PATH", ",", "setname", "+", "'.csv'", ")", "\n", "lines", "=", "[", "x", ".", "strip", "(", ")", "for", "x", "in", "open", "(", "csv_path", ",", "'r'", ")", ".", "readlines", "(", ")", "]", "[", "1", ":", "]", "\n", "\n", "data", "=", "[", "]", "\n", "label", "=", "[", "]", "\n", "lb", "=", "-", "1", "\n", "\n", "self", ".", "wnids", "=", "[", "]", "\n", "\n", "for", "l", "in", "lines", ":", "\n", "            ", "name", ",", "wnid", "=", "l", ".", "split", "(", "','", ")", "\n", "path", "=", "osp", ".", "join", "(", "ROOT_PATH_IMG", ",", "name", ")", "\n", "if", "wnid", "not", "in", "self", ".", "wnids", ":", "\n", "                ", "self", ".", "wnids", ".", "append", "(", "wnid", ")", "\n", "lb", "+=", "1", "\n", "", "data", ".", "append", "(", "path", ")", "\n", "label", ".", "append", "(", "lb", ")", "\n", "", "permutation", "=", "np", ".", "random", ".", "permutation", "(", "len", "(", "label", ")", ")", "\n", "\n", "self", ".", "data", "=", "np", ".", "array", "(", "data", ")", "[", "permutation", "]", "\n", "self", ".", "label", "=", "np", ".", "array", "(", "label", ")", "[", "permutation", "]", "\n", "\n", "self", ".", "transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "ToTensor", "(", ")", "\n", "]", ")", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.mini_imagenet.MiniImageNet.__len__": [[42, 44], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "data", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.mini_imagenet.MiniImageNet.__getitem__": [[45, 67], ["scipy.misc.imread", "min", "scipy.misc.imresize", "mini_imagenet.MiniImageNet.transform"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "i", ")", ":", "\n", "        ", "path", ",", "label", "=", "self", ".", "data", "[", "i", "]", ",", "self", ".", "label", "[", "i", "]", "\n", "# image = self.transform(Image.open(path).convert('RGB'))", "\n", "#image = imageio.imread(path, pilmode='RGB')", "\n", "image", "=", "scipy", ".", "misc", ".", "imread", "(", "path", ",", "mode", "=", "'RGB'", ")", "\n", "\n", "# Infer class from filename.", "\n", "\n", "\n", "# Central square crop of size equal to the image's smallest side.", "\n", "height", ",", "width", ",", "channels", "=", "image", ".", "shape", "\n", "crop_size", "=", "min", "(", "height", ",", "width", ")", "\n", "start_height", "=", "(", "height", "//", "2", ")", "-", "(", "crop_size", "//", "2", ")", "\n", "start_width", "=", "(", "width", "//", "2", ")", "-", "(", "crop_size", "//", "2", ")", "\n", "image", "=", "image", "[", "\n", "start_height", ":", "start_height", "+", "crop_size", ",", "\n", "start_width", ":", "start_width", "+", "crop_size", ",", ":", "]", "\n", "\n", "image", "=", "scipy", ".", "misc", ".", "imresize", "(", "image", ",", "(", "84", ",", "84", ")", ",", "interp", "=", "'bilinear'", ")", "\n", "image", "=", "self", ".", "transform", "(", "image", ")", "\n", "\n", "return", "image", ",", "label", "\n", "", "", ""]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Averager.__init__": [[28, 31], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "n", "=", "0", "\n", "self", ".", "v", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Averager.add": [[32, 35], ["None"], "methods", ["None"], ["", "def", "add", "(", "self", ",", "x", ")", ":", "\n", "        ", "self", ".", "v", "=", "(", "self", ".", "v", "*", "self", ".", "n", "+", "x", ")", "/", "(", "self", ".", "n", "+", "1", ")", "\n", "self", ".", "n", "+=", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Averager.item": [[36, 38], ["None"], "methods", ["None"], ["", "def", "item", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "v", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Timer.__init__": [[74, 76], ["time.time"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "o", "=", "time", ".", "time", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Timer.measure": [[77, 85], ["int", "time.time", "round"], "methods", ["None"], ["", "def", "measure", "(", "self", ",", "p", "=", "1", ")", ":", "\n", "        ", "x", "=", "(", "time", ".", "time", "(", ")", "-", "self", ".", "o", ")", "/", "p", "\n", "x", "=", "int", "(", "x", ")", "\n", "if", "x", ">=", "3600", ":", "\n", "            ", "return", "'{:.1f}h'", ".", "format", "(", "x", "/", "3600", ")", "\n", "", "if", "x", ">=", "60", ":", "\n", "            ", "return", "'{}m'", ".", "format", "(", "round", "(", "x", "/", "60", ")", ")", "\n", "", "return", "'{}s'", ".", "format", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.scaling.__init__": [[96, 100], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.__init__"], ["    ", "def", "__init__", "(", "self", ",", "margin", ")", ":", "\n", "        ", "super", "(", "scaling", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "margin", "=", "margin", "\n", "return", "\n", "", "def", "forward", "(", "self", ",", "logits", ",", "label", ")", ":", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.scaling.forward": [[100, 106], ["numpy.ones", "numpy.ones", "numpy.ones", "numpy.ones", "range", "torch.from_numpy().float().cuda", "torch.from_numpy().float().cuda", "torch.from_numpy().float().cuda", "torch.from_numpy().float().cuda", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "logits", ",", "label", ")", ":", "\n", "        ", "mask", "=", "numpy", ".", "ones", "(", "logits", ".", "shape", ")", "\n", "for", "i", "in", "range", "(", "logits", ".", "shape", "[", "0", "]", ")", ":", "\n", "            ", "mask", "[", "i", "]", "[", "label", "[", "i", "]", "]", "=", "self", ".", "margin", "\n", "", "mask", "=", "torch", ".", "from_numpy", "(", "mask", ")", ".", "float", "(", ")", ".", "cuda", "(", ")", "\n", "return", "logits", "*", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.sample.__init__": [[108, 113], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.__init__"], ["    ", "def", "__init__", "(", "self", ",", "mean", ",", "std", ")", ":", "\n", "        ", "super", "(", "sample", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "mean", "=", "mean", "\n", "self", ".", "std", "=", "std", "\n", "return", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.sample.forward": [[114, 117], ["torch.normal().cuda", "torch.normal().cuda", "torch.normal().cuda", "torch.normal().cuda", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.normal", "torch.normal", "torch.normal", "torch.normal", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "logits", ")", ":", "\n", "        ", "B", "=", "torch", ".", "normal", "(", "mean", "=", "torch", ".", "tensor", "(", "self", ".", "mean", ")", ",", "std", "=", "torch", ".", "tensor", "(", "self", ".", "std", ")", ")", ".", "cuda", "(", ")", "\n", "return", "logits", "*", "torch", ".", "abs", "(", "B", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.__init__": [[119, 125], ["torch.Linear.__init__", "utils.Bufferswitch.register_buffer", "utils.Bufferswitch.register_buffer", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones"], "methods", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.__init__"], ["    ", "def", "__init__", "(", "self", ",", "multiscale", "=", "True", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "1", ",", "1", ")", "\n", "if", "multiscale", ":", "\n", "            ", "self", ".", "register_buffer", "(", "'mask'", ",", "torch", ".", "ones", "(", "1600", ")", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "register_buffer", "(", "'mask'", ",", "torch", ".", "ones", "(", "1", ")", ")", "#torch.ones(1600) for multiscale", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.set": [[126, 128], ["utils.Bufferswitch.mask.data.copy_"], "methods", ["None"], ["", "", "def", "set", "(", "self", ",", "mask", ")", ":", "\n", "        ", "self", ".", "mask", ".", "data", ".", "copy_", "(", "mask", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.Bufferswitch.get": [[129, 131], ["None"], "methods", ["None"], ["", "def", "get", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "mask", ".", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.set_gpu": [[13, 16], ["print"], "function", ["None"], ["def", "set_gpu", "(", "x", ")", ":", "\n", "    ", "os", ".", "environ", "[", "'CUDA_VISIBLE_DEVICES'", "]", "=", "x", "\n", "print", "(", "'using gpu:'", ",", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.ensure_path": [[17, 24], ["os.path.exists", "os.mkdir", "input", "shutil.rmtree", "os.mkdir"], "function", ["None"], ["", "def", "ensure_path", "(", "path", ")", ":", "\n", "    ", "if", "os", ".", "path", ".", "exists", "(", "path", ")", ":", "\n", "        ", "if", "input", "(", "'{} exists, remove? ([y]/n)'", ".", "format", "(", "path", ")", ")", "!=", "'n'", ":", "\n", "            ", "shutil", ".", "rmtree", "(", "path", ")", "\n", "os", ".", "mkdir", "(", "path", ")", "\n", "", "", "else", ":", "\n", "        ", "os", ".", "mkdir", "(", "path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.count_acc": [[40, 43], ["torch.argmax", "torch.argmax"], "function", ["None"], ["", "", "def", "count_acc", "(", "logits", ",", "label", ")", ":", "\n", "    ", "pred", "=", "torch", ".", "argmax", "(", "logits", ",", "dim", "=", "1", ")", "\n", "return", "(", "pred", "==", "label", ")", ".", "type", "(", "torch", ".", "cuda", ".", "FloatTensor", ")", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.dot_metric": [[44, 46], ["torch.mm", "torch.mm", "b.t"], "function", ["None"], ["", "def", "dot_metric", "(", "a", ",", "b", ")", ":", "\n", "    ", "return", "torch", ".", "mm", "(", "a", ",", "b", ".", "t", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.dot_metric_normalize": [[47, 51], ["torch.mm", "torch.mm", "torch.div", "torch.div", "torch.div().t", "torch.div().t", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.div", "torch.div", "torch.norm", "torch.norm", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.norm", "torch.norm"], "function", ["None"], ["", "def", "dot_metric_normalize", "(", "a", ",", "b", ",", "B", ")", ":", "\n", "    ", "logits", "=", "torch", ".", "mm", "(", "torch", ".", "div", "(", "a", ",", "torch", ".", "norm", "(", "a", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", ",", "torch", ".", "div", "(", "b", ",", "torch", ".", "norm", "(", "b", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", ".", "t", "(", ")", ")", "\n", "logits_scaled", "=", "logits", "*", "B", "\n", "return", "logits", ",", "logits_scaled", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.euclidean_metric": [[52, 59], ["a.unsqueeze().expand.unsqueeze().expand", "b.unsqueeze().expand.unsqueeze().expand", "a.unsqueeze().expand.unsqueeze", "b.unsqueeze().expand.unsqueeze"], "function", ["None"], ["", "def", "euclidean_metric", "(", "a", ",", "b", ")", ":", "\n", "    ", "n", "=", "a", ".", "shape", "[", "0", "]", "\n", "m", "=", "b", ".", "shape", "[", "0", "]", "\n", "a", "=", "a", ".", "unsqueeze", "(", "1", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "\n", "b", "=", "b", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "\n", "logits", "=", "-", "(", "(", "a", "-", "b", ")", "**", "2", ")", ".", "sum", "(", "dim", "=", "2", ")", "\n", "return", "logits", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.euclidean_metric_normalize": [[60, 71], ["torch.div", "torch.div", "torch.div", "torch.div", "a.unsqueeze().expand.unsqueeze().expand", "b.unsqueeze().expand.unsqueeze().expand", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "a.unsqueeze().expand.unsqueeze", "b.unsqueeze().expand.unsqueeze", "torch.norm", "torch.norm", "torch.norm", "torch.norm"], "function", ["None"], ["", "def", "euclidean_metric_normalize", "(", "a", ",", "b", ",", "B", ")", ":", "\n", "    ", "a", "=", "torch", ".", "div", "(", "a", ",", "torch", ".", "norm", "(", "a", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", "\n", "b", "=", "torch", ".", "div", "(", "b", ",", "torch", ".", "norm", "(", "b", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", "\n", "n", "=", "a", ".", "shape", "[", "0", "]", "\n", "m", "=", "b", ".", "shape", "[", "0", "]", "\n", "a", "=", "a", ".", "unsqueeze", "(", "1", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "\n", "b", "=", "b", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "\n", "logits", "=", "-", "(", "(", "a", "-", "b", ")", "**", "2", ")", ".", "sum", "(", "dim", "=", "2", ")", "\n", "logits_scaled", "=", "logits", "*", "(", "B", "/", "2", ")", "\n", "#logits = -((a - b)**2).sum(dim=2).sqrt()*(B)", "\n", "return", "logits", ",", "logits_scaled", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.pprint": [[87, 89], ["_utils_pp.pprint"], "function", ["home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.pprint"], ["def", "pprint", "(", "x", ")", ":", "\n", "    ", "_utils_pp", ".", "pprint", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.l2_loss": [[91, 93], ["len"], "function", ["None"], ["", "def", "l2_loss", "(", "pred", ",", "label", ")", ":", "\n", "    ", "return", "(", "(", "pred", "-", "label", ")", "**", "2", ")", ".", "sum", "(", ")", "/", "len", "(", "pred", ")", "/", "2", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.euclidean_multiscale": [[133, 141], ["a.unsqueeze().expand.unsqueeze().expand", "b.unsqueeze().expand.unsqueeze().expand", "a.unsqueeze().expand.unsqueeze", "b.unsqueeze().expand.unsqueeze", "B.squeeze().unsqueeze().unsqueeze", "B.squeeze().unsqueeze", "B.squeeze"], "function", ["None"], ["", "", "def", "euclidean_multiscale", "(", "a", ",", "b", ",", "B", ")", ":", "\n", "    ", "n", "=", "a", ".", "shape", "[", "0", "]", "\n", "m", "=", "b", ".", "shape", "[", "0", "]", "\n", "a", "=", "a", ".", "unsqueeze", "(", "1", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "\n", "b", "=", "b", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "\n", "logits_vector", "=", "-", "(", "(", "a", "-", "b", ")", "**", "2", ")", "\n", "logits_scaled", "=", "(", "(", "B", ".", "squeeze", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "1", ")", "/", "2", ")", "*", "logits_vector", ")", ".", "sum", "(", "dim", "=", "2", ")", "\n", "return", "logits_vector", ",", "logits_scaled", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.euclidean_normalize_multiscale": [[142, 153], ["torch.div", "torch.div", "torch.div", "torch.div", "a.unsqueeze().expand.unsqueeze().expand", "b.unsqueeze().expand.unsqueeze().expand", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "a.unsqueeze().expand.unsqueeze", "b.unsqueeze().expand.unsqueeze", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "B.squeeze().unsqueeze().unsqueeze", "B.squeeze().unsqueeze", "B.squeeze"], "function", ["None"], ["", "def", "euclidean_normalize_multiscale", "(", "a", ",", "b", ",", "B", ")", ":", "\n", "    ", "a", "=", "torch", ".", "div", "(", "a", ",", "torch", ".", "norm", "(", "a", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", "\n", "b", "=", "torch", ".", "div", "(", "b", ",", "torch", ".", "norm", "(", "b", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", "\n", "n", "=", "a", ".", "shape", "[", "0", "]", "\n", "m", "=", "b", ".", "shape", "[", "0", "]", "\n", "a", "=", "a", ".", "unsqueeze", "(", "1", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "#75 1600 1600", "\n", "b", "=", "b", ".", "unsqueeze", "(", "0", ")", ".", "expand", "(", "n", ",", "m", ",", "-", "1", ")", "#75 1600 5", "\n", "logits_vector", "=", "-", "(", "(", "a", "-", "b", ")", "**", "2", ")", "\n", "#print(B.shape,logits_vector.shape) [1600],[75,5,1600]", "\n", "logits_scaled", "=", "(", "(", "B", ".", "squeeze", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "1", ")", "/", "2", ")", "*", "logits_vector", ")", ".", "sum", "(", "dim", "=", "2", ")", "\n", "return", "logits_vector", ",", "logits_scaled", "\n", "\n"]], "home.repos.pwc.inspect_result.jiaxinchen666_variational-scaling.None.utils.dot_normalize_multiscale": [[154, 161], ["torch.div", "torch.div", "torch.div", "torch.div", "torch.stack", "torch.stack", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "torch.norm().unsqueeze", "range", "torch.norm", "torch.norm", "torch.norm", "torch.norm", "B.squeeze().unsqueeze().unsqueeze", "B.squeeze().unsqueeze", "B.squeeze"], "function", ["None"], ["", "def", "dot_normalize_multiscale", "(", "a", ",", "b", ",", "B", ")", ":", "\n", "    ", "a", "=", "torch", ".", "div", "(", "a", ",", "torch", ".", "norm", "(", "a", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", "#75,1600 nm", "\n", "b", "=", "torch", ".", "div", "(", "b", ",", "torch", ".", "norm", "(", "b", ",", "dim", "=", "1", ")", ".", "unsqueeze", "(", "1", ")", ")", "#5,1600 t() 1600,way mp query*way way 1600", "\n", "l", "=", "[", "a", "[", "i", "]", "*", "b", "for", "i", "in", "range", "(", "a", ".", "shape", "[", "0", "]", ")", "]", "\n", "logits_vector", "=", "torch", ".", "stack", "(", "l", ")", "\n", "logits_scaled", "=", "(", "(", "B", ".", "squeeze", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "1", ")", ")", "*", "logits_vector", ")", ".", "sum", "(", "dim", "=", "2", ")", "\n", "return", "logits_vector", ",", "logits_scaled", "\n", "\n"]]}