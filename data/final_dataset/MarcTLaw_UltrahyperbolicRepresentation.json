{"home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.__init__": [[82, 105], ["torch.Module.__init__", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "nips_dataset_experiments.Model.sqrtbeta.weight.data.fill_", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "nips_dataset_experiments.Model.rad.weight.data.fill_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "math.log", "math.log", "math.exp", "math.exp", "abs"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.__init__"], ["    ", "def", "__init__", "(", "self", ",", "beta", ",", "q", ")", ":", "\n", "        ", "super", "(", "Model", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "embedding", "=", "nn", ".", "Embedding", "(", "author_numbers", ",", "d", ")", "\n", "if", "q", "==", "1", ":", "\n", "            ", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "0", "]", ",", "1", ",", "1", ")", "\n", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "1", ":", "]", ",", "-", "0.1", ",", "0.1", ")", "\n", "", "else", ":", "\n", "            ", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "0", "]", ",", "1", ",", "1", ")", "\n", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "1", ":", "]", ",", "-", "0.1", ",", "0.1", ")", "\n", "", "self", ".", "sqrtbeta", "=", "nn", ".", "Embedding", "(", "1", ",", "1", ")", "\n", "self", ".", "sqrtbeta", ".", "weight", ".", "data", ".", "fill_", "(", "math", ".", "log", "(", "math", ".", "exp", "(", "abs", "(", "beta", ")", ")", "-", "1", ")", ")", "\n", "self", ".", "q", "=", "q", "\n", "self", ".", "d", "=", "d", "\n", "self", ".", "rad", "=", "nn", ".", "Embedding", "(", "1", ",", "1", ")", "\n", "self", ".", "rad", ".", "weight", ".", "data", ".", "fill_", "(", "math", ".", "log", "(", "math", ".", "exp", "(", "0.5", ")", "-", "1", ")", ")", "\n", "\n", "\n", "\n", "self", ".", "embedding", ".", "weight", ".", "requires_grad", "=", "True", "\n", "self", ".", "rad", ".", "weight", ".", "requires_grad", "=", "False", "\n", "self", ".", "sqrtbeta", ".", "weight", ".", "requires_grad", "=", "False", "\n", "\n", "self", ".", "euclidean_space", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.map_on_pseudohyperboloid": [[106, 108], ["nips_dataset_experiments.Model.embeddings"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.embeddings"], ["", "def", "map_on_pseudohyperboloid", "(", "self", ",", "beta_scaling", "=", "True", ")", ":", "\n", "        ", "self", ".", "embedding", ".", "weight", ".", "data", "=", "self", ".", "embeddings", "(", "beta_scaling", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.print": [[109, 111], ["nips_dataset_experiments.Model.print"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.print"], ["", "def", "print", "(", "self", ")", ":", "\n", "        ", "print", "(", "self", ".", "embedding", ".", "weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.embeddings": [[112, 142], ["torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "X[].view", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "nips_dataset_experiments.Model.psqrtbeta", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "nips_dataset_experiments.Model.psqrtbeta", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "nips_dataset_experiments.Model.psqrtbeta", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "nips_dataset_experiments.Model.psqrtbeta", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "X[].view", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "nips_dataset_experiments.Model.psqrtbeta", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "embeddings", "(", "self", ",", "beta_scaling", "=", "True", ",", "use_mapping", "=", "True", ")", ":", "\n", "        ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "if", "self", ".", "q", "==", "0", ":", "\n", "            ", "return", "X", "\n", "", "if", "not", "use_mapping", ":", "\n", "            ", "return", "X", "\n", "", "elif", "self", ".", "q", "==", "X", ".", "shape", "[", "0", "]", ":", "\n", "            ", "if", "beta_scaling", ":", "\n", "                ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "F", ".", "normalize", "(", "X", ")", "\n", "", "else", ":", "\n", "                ", "return", "F", ".", "normalize", "(", "X", ")", "\n", "", "", "elif", "self", ".", "q", ">", "1", ":", "\n", "            ", "X0", "=", "X", "[", ":", ",", "0", "]", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "Xtime", "=", "F", ".", "normalize", "(", "torch", ".", "cat", "(", "(", "X0", ",", "X", "[", ":", ",", "1", ":", "self", ".", "q", "]", ".", "view", "(", "-", "1", ",", "self", ".", "q", "-", "1", ")", ")", ",", "1", ")", ")", "\n", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "spaceNorm", ".", "add", "(", "1.0", ")", ")", ".", "expand_as", "(", "Xtime", ")", "*", "Xtime", "\n", "if", "beta_scaling", ":", "\n", "                ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "else", ":", "\n", "                ", "return", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "", "elif", "self", ".", "q", "==", "1", ":", "\n", "            ", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "(", "spaceNorm", ")", ".", "add", "(", "1.0", ")", ")", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "if", "beta_scaling", ":", "\n", "                ", "return", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "else", ":", "\n", "                ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "", "return", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.compute_similarity_matrix_without_mapping": [[144, 161], ["torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X.t", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X.t", "nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.psqrtbeta", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X.t", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "Xspace.t", "Xtime.t"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "compute_similarity_matrix_without_mapping", "(", "self", ",", "beta_scaling", "=", "False", ",", "X", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "", "d", "=", "X", ".", "shape", "[", "1", "]", "\n", "if", "self", ".", "euclidean_space", ":", "\n", "            ", "K", "=", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "0", ":", "\n", "            ", "K", "=", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "d", ":", "\n", "            ", "K", "=", "-", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", ">=", "1", ":", "\n", "            ", "Xtime", "=", "X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "K", "=", "torch", ".", "matmul", "(", "Xspace", ",", "Xspace", ".", "t", "(", ")", ")", "-", "torch", ".", "matmul", "(", "Xtime", ",", "Xtime", ".", "t", "(", ")", ")", "\n", "", "if", "beta_scaling", ":", "\n", "            ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "psqrtbeta", "(", ")", "*", "K", "\n", "", "return", "K", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.compute_similarity_matrix_with_mapping": [[162, 185], ["torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X.t", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X.t", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.normalize.t", "nips_dataset_experiments.Model.psqrtbeta", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "X[].div.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "nips_dataset_experiments.Model.psqrtbeta", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "X[].div.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "compute_similarity_matrix_with_mapping", "(", "self", ",", "X", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "", "d", "=", "X", ".", "shape", "[", "1", "]", "\n", "if", "self", ".", "euclidean_space", ":", "\n", "            ", "K", "=", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "0", ":", "\n", "            ", "K", "=", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "d", ":", "\n", "            ", "XX", "=", "F", ".", "normalize", "(", "X", ")", "\n", "K", "=", "-", "torch", ".", "matmul", "(", "XX", ",", "XX", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", ">", "1", ":", "\n", "            ", "Xtime", "=", "F", ".", "normalize", "(", "X", "[", ":", ",", "0", ":", "self", ".", "q", "]", ")", "\n", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "spaceNorm", ".", "add", "(", "1.0", ")", ")", ".", "expand_as", "(", "Xtime", ")", "*", "Xtime", "\n", "K", "=", "torch", ".", "matmul", "(", "Xspace", ",", "Xspace", ".", "t", "(", ")", ")", "-", "torch", ".", "matmul", "(", "Xtime", ",", "Xtime", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "1", ":", "\n", "            ", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "(", "spaceNorm", ")", ".", "add", "(", "1.0", ")", ")", "\n", "K", "=", "torch", ".", "matmul", "(", "Xspace", ",", "Xspace", ".", "t", "(", ")", ")", "-", "torch", ".", "matmul", "(", "Xtime", ",", "Xtime", ".", "t", "(", ")", ")", "\n", "", "return", "K", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.compute_distance_matrix": [[186, 205], ["nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.acosh", "nips_dataset_experiments.Model.psqrtbeta", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.psqrtbeta", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "nips_dataset_experiments.Model.psqrtbeta", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "nips_dataset_experiments.Model.psqrtbeta", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.psqrtbeta"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.acosh", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "compute_distance_matrix", "(", "self", ",", "K", ",", "beta_scaling", "=", "False", ")", ":", "\n", "        ", "if", "beta_scaling", ":", "\n", "            ", "K", "=", "K", "/", "(", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "", "if", "self", ".", "q", "==", "0", ":", "\n", "            ", "K", "=", "-", "K", "\n", "", "epsilon", "=", "0.00001", "\n", "if", "self", ".", "q", "==", "d", ":", "\n", "            ", "euclidean_indices", "=", "(", "K", "<", "-", "1.0", "+", "epsilon", ")", "\n", "K", "[", "euclidean_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "abs", "(", "2.0", "*", "(", "1.0", "+", "K", "[", "euclidean_indices", "]", ")", ")", "\n", "K", "[", "~", "euclidean_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "acos", "(", "-", "K", "[", "~", "euclidean_indices", "]", ")", "\n", "", "hyperbolic_indices", "=", "K", "<", "-", "1.0", "-", "epsilon", "\n", "euclidean_indices", "=", "(", "K", "<", "-", "1.0", "+", "epsilon", ")", "&", "(", "~", "hyperbolic_indices", ")", "\n", "positive_similarity", "=", "K", ">=", "0.0", "\n", "spherical_indices", "=", "(", "~", "positive_similarity", ")", "&", "(", "~", "(", "K", "<", "-", "1.0", "+", "epsilon", ")", ")", "\n", "K", "[", "hyperbolic_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "acosh", "(", "-", "K", "[", "hyperbolic_indices", "]", ")", "\n", "K", "[", "euclidean_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "abs", "(", "2.0", "*", "(", "1.0", "+", "K", "[", "euclidean_indices", "]", ")", ")", "\n", "K", "[", "positive_similarity", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "(", "math", ".", "pi", "/", "2", "+", "K", "[", "positive_similarity", "]", ")", "\n", "K", "[", "spherical_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "acos", "(", "-", "K", "[", "spherical_indices", "]", ")", "\n", "return", "K", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.stopping_criterion": [[209, 211], ["None"], "methods", ["None"], ["", "def", "stopping_criterion", "(", "self", ",", "use_mapping", "=", "True", ")", ":", "\n", "        ", "return", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.rescale_beta": [[213, 220], ["nips_dataset_experiments.Model.psqrtbeta", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "rescale_beta", "(", "self", ",", "X", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", ".", "data", "\n", "", "norm_X", "=", "X", "*", "X", "\n", "norm_Xtime", "=", "norm_X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "norm_Xspace", "=", "norm_X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "return", "X", "/", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "norm_Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "norm_Xtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ")", ".", "sqrt", "(", ")", ".", "expand_as", "(", "X", ")", "*", "self", ".", "psqrtbeta", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.perform_rescaling_beta": [[222, 229], ["nips_dataset_experiments.Model.psqrtbeta", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "perform_rescaling_beta", "(", "self", ",", "X", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "", "norm_X", "=", "X", "*", "X", "\n", "norm_Xtime", "=", "norm_X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "norm_Xspace", "=", "norm_X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "self", ".", "embedding", ".", "weight", ".", "data", "=", "X", "/", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "norm_Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "norm_Xtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ")", ".", "sqrt", "(", ")", ".", "expand_as", "(", "X", ")", "*", "self", ".", "psqrtbeta", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.scalar_product": [[230, 233], ["None"], "methods", ["None"], ["", "def", "scalar_product", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "z", "=", "x", "*", "y", "\n", "return", "z", "[", "self", ".", "q", ":", "]", "-", "z", "[", "0", ":", "self", ".", "q", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.change_metric": [[234, 238], ["x.clone"], "methods", ["None"], ["", "def", "change_metric", "(", "self", ",", "x", ")", ":", "\n", "        ", "z", "=", "x", ".", "clone", "(", ")", "\n", "z", "[", ":", ",", "0", ":", "self", ".", "q", "]", "=", "-", "z", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "return", "z", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.exponential_map": [[239, 312], ["nips_dataset_experiments.Model.psqrtbeta", "gradient.clone", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "norm_xi.view.view.view", "nips_dataset_experiments.Model.rescale_beta", "nips_dataset_experiments.Model.embedding.weight.clone", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "U.to.to.to", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "nips_dataset_experiments.Model.change_metric", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "nips_dataset_experiments.Model.change_metric", "nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.psqrtbeta", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.psqrtbeta", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.psqrtbeta"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.rescale_beta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.change_metric", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.change_metric", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "exponential_map", "(", "self", ",", "gradient", ",", "step_size", ",", "X", "=", "None", ")", ":", "\n", "        ", "t", "=", "-", "step_size", "\n", "n", "=", "gradient", ".", "shape", "[", "0", "]", "\n", "d", "=", "gradient", ".", "shape", "[", "1", "]", "\n", "sqrt_beta", "=", "self", ".", "psqrtbeta", "(", ")", "\n", "g", "=", "gradient", ".", "clone", "(", ")", "\n", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", ".", "clone", "(", ")", "\n", "", "gX", "=", "g", "*", "X", "\n", "gXtime", "=", "gX", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "gXspace", "=", "gX", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "gXsum", "=", "torch", ".", "sum", "(", "gX", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "norm_X", "=", "X", "*", "X", "\n", "norm_Xtime", "=", "norm_X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "norm_Xspace", "=", "norm_X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "sq_normX", "=", "torch", ".", "sum", "(", "norm_Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "norm_Xtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "l2_sq_normX", "=", "torch", ".", "sum", "(", "norm_X", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "\n", "epsilon", "=", "0.000000000001", "\n", "\n", "\n", "if", "use_pseudoRiemannian_gradient", "or", "(", "self", ".", "q", "==", "1", ")", "or", "(", "self", ".", "q", "==", "d", ")", ":", "\n", "            ", "apply_precondition", "=", "False", "\n", "", "else", ":", "\n", "            ", "apply_precondition", "=", "True", "\n", "", "if", "apply_precondition", ":", "\n", "            ", "xi_preconditioned", "=", "g", "-", "self", ".", "change_metric", "(", "X", ")", "*", "(", "gXsum", "/", "sq_normX", ")", ".", "expand_as", "(", "X", ")", "-", "X", "*", "(", "(", "torch", ".", "sum", "(", "gXspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "gXtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ")", "/", "sq_normX", ")", ".", "expand_as", "(", "X", ")", "+", "X", "*", "(", "l2_sq_normX", "*", "gXsum", "/", "(", "sq_normX", "*", "sq_normX", ")", ")", ".", "expand_as", "(", "X", ")", "\n", "#xi_preconditioned = g - self.change_metric(X) * (gXsum / sq_normX).expand_as(X) + X * ((l2_sq_normX * gXsum / (sq_normX * sq_normX)) - (torch.sum(gXspace,dim=1, keepdim=True) - torch.sum(gXtime,dim=1, keepdim=True)) / sq_normX).expand_as(X)", "\n", "sq_norm_xi_preconditioned_1", "=", "xi_preconditioned", "*", "xi_preconditioned", "\n", "sq_norm_xitime_preconditioned", "=", "sq_norm_xi_preconditioned_1", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "sq_norm_xispace_preconditioned", "=", "sq_norm_xi_preconditioned_1", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "sq_norm_xi_preconditioned", "=", "torch", ".", "sum", "(", "sq_norm_xispace_preconditioned", ",", "dim", "=", "1", ")", "-", "torch", ".", "sum", "(", "sq_norm_xitime_preconditioned", ",", "dim", "=", "1", ")", "\n", "norm_xi_preconditioned", "=", "torch", ".", "abs", "(", "sq_norm_xi_preconditioned", ")", ".", "sqrt", "(", ")", "\n", "sq_norm_xi", "=", "sq_norm_xi_preconditioned", "\n", "norm_xi", "=", "norm_xi_preconditioned", "\n", "xi", "=", "xi_preconditioned", "\n", "", "else", ":", "\n", "            ", "xi_sr", "=", "self", ".", "change_metric", "(", "gradient", ")", "-", "X", "*", "(", "gXsum", "/", "sq_normX", ")", ".", "expand_as", "(", "X", ")", "\n", "sq_norm_xi_sr", "=", "xi_sr", "*", "xi_sr", "\n", "sq_norm_xitime_sr", "=", "sq_norm_xi_sr", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "sq_norm_xispace_sr", "=", "sq_norm_xi_sr", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "sq_norm_xi_sr", "=", "torch", ".", "sum", "(", "sq_norm_xispace_sr", ",", "dim", "=", "1", ")", "-", "torch", ".", "sum", "(", "sq_norm_xitime_sr", ",", "dim", "=", "1", ")", "\n", "norm_xi_sr", "=", "torch", ".", "abs", "(", "sq_norm_xi_sr", ")", ".", "sqrt", "(", ")", "\n", "sq_norm_xi", "=", "sq_norm_xi_sr", "\n", "norm_xi", "=", "norm_xi_sr", "\n", "xi", "=", "xi_sr", "\n", "if", "self", ".", "q", "==", "d", ":", "\n", "                ", "t", "=", "-", "t", "\n", "", "", "cpt", "=", "0", "\n", "U", "=", "torch", ".", "empty", "(", "n", ",", "d", ")", "\n", "if", "use_cuda", ":", "\n", "            ", "U", "=", "U", ".", "to", "(", "device", ")", "\n", "\n", "", "time_like", "=", "sq_norm_xi", "<", "-", "epsilon", "\n", "space_like", "=", "sq_norm_xi", ">", "epsilon", "\n", "null_geodesic", "=", "(", "~", "space_like", ")", "&", "(", "~", "time_like", ")", "\n", "norm_xi", "=", "norm_xi", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "U", "[", "time_like", ",", ":", "]", "=", "X", "[", "time_like", ",", ":", "]", "*", "torch", ".", "cos", "(", "t", "*", "norm_xi", "[", "time_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", ".", "repeat", "(", "1", ",", "d", ")", "+", "(", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "sin", "(", "t", "*", "norm_xi", "[", "time_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", "/", "norm_xi", "[", "time_like", "]", ")", ".", "repeat", "(", "1", ",", "d", ")", "*", "xi", "[", "time_like", ",", ":", "]", "\n", "U", "[", "space_like", ",", ":", "]", "=", "X", "[", "space_like", ",", ":", "]", "*", "torch", ".", "cosh", "(", "t", "*", "norm_xi", "[", "space_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", ".", "repeat", "(", "1", ",", "d", ")", "+", "(", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "sinh", "(", "t", "*", "norm_xi", "[", "space_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", "/", "norm_xi", "[", "space_like", "]", ")", ".", "repeat", "(", "1", ",", "d", ")", "*", "xi", "[", "space_like", ",", ":", "]", "\n", "U", "[", "null_geodesic", ",", ":", "]", "=", "X", "[", "null_geodesic", ",", ":", "]", "+", "t", "*", "xi", "[", "null_geodesic", ",", ":", "]", "\n", "if", "self", ".", "q", "==", "1", ":", "\n", "            ", "U", "[", ":", ",", "0", "]", "=", "torch", ".", "abs", "(", "U", "[", ":", ",", "0", "]", ")", "\n", "\n", "#for i in range(0,n):", "\n", "#    if sq_norm_xi[i] < -epsilon:", "\n", "#        U[i,:] = X[i,:] * torch.cos(t * norm_xi[i] / self.psqrtbeta()) + self.psqrtbeta() * torch.sin(t * norm_xi[i] / self.psqrtbeta()) * (xi[i,:] / norm_xi[i])", "\n", "#    elif sq_norm_xi[i] > epsilon:", "\n", "#        U[i,:] = X[i,:] * torch.cosh(t * norm_xi[i] / self.psqrtbeta()) + self.psqrtbeta() * torch.sinh(t * norm_xi[i] / self.psqrtbeta()) * (xi[i,:] / norm_xi[i])", "\n", "#    else:", "\n", "#        U[i,:] = X[i,:] + t * xi[i,:]", "\n", "#    if q == 1:", "\n", "#        U[i,0] = torch.abs(U[i,0])", "\n", "", "self", ".", "embedding", ".", "weight", ".", "data", "=", "self", ".", "rescale_beta", "(", "X", "=", "U", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.loss_function": [[313, 359], ["torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "nips_dataset_experiments.Model.compute_similarity_matrix_with_mapping", "nips_dataset_experiments.Model.compute_similarity_matrix_without_mapping", "torch.CrossEntropyLoss.", "torch.CrossEntropyLoss.", "positives_c.view", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "zeros.repeat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "zeros.repeat", "nips_dataset_experiments.Model.compute_distance_matrix", "positives_c.view", "positives_c.view", "negative_distance_list[].view", "positives_c.view", "torch.cat.repeat().view", "torch.cat.repeat().view", "torch.cat.repeat().view", "torch.cat.repeat().view", "negative_distance_list[].view", "torch.cat.repeat", "torch.cat.repeat", "torch.cat.repeat", "torch.cat.repeat"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_with_mapping", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_without_mapping", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_distance_matrix"], ["", "def", "loss_function", "(", "self", ",", "use_mapping", "=", "True", ",", "beta_scaling", "=", "True", ",", "similarity_matrix", "=", "None", ")", ":", "\n", "        ", "if", "similarity_matrix", "is", "None", ":", "\n", "            ", "if", "use_mapping", ":", "\n", "                ", "K", "=", "self", ".", "compute_similarity_matrix_with_mapping", "(", ")", "\n", "", "else", ":", "\n", "                ", "K", "=", "self", ".", "compute_similarity_matrix_without_mapping", "(", ")", "\n", "", "", "else", ":", "\n", "                ", "K", "=", "similarity_matrix", "\n", "\n", "", "total_loss", "=", "0.0", "\n", "temperature_inv", "=", "10000.0", "\n", "nb_positive", "=", "0", "\n", "nb_negative", "=", "0", "\n", "nb_satisfied", "=", "0", "\n", "nb_constraints", "=", "0", "\n", "celoss", "=", "nn", ".", "CrossEntropyLoss", "(", "reduction", "=", "\"sum\"", ")", "\n", "losses", "=", "None", "\n", "negative_distance_list", "=", "None", "\n", "positive_distance_list", "=", "{", "}", "\n", "cpt", "=", "0", "\n", "n", "=", "K", ".", "shape", "[", "0", "]", "\n", "drawn_number", "=", "n", "\n", "K", "=", "(", "-", "self", ".", "compute_distance_matrix", "(", "K", ")", "*", "temperature_inv", ")", ".", "view", "(", "-", "1", ")", "\n", "\n", "total_c", "=", "0", "\n", "negative_distance_list", "=", "K", "[", "positive_indices", "[", "0", "]", "]", "\n", "weaker_positive", "=", "None", "\n", "\n", "cptindx", "=", "0", "\n", "nb_positives", "=", "0", "\n", "for", "c", "in", "ordered_c", ":", "\n", "            ", "if", "c", "not", "in", "positive_indices", ":", "\n", "                ", "continue", "\n", "", "positives_c", "=", "K", "[", "positive_indices", "[", "c", "]", "]", "\n", "clength", "=", "positives_c", ".", "shape", "[", "0", "]", "\n", "neg_indices", "=", "torch", ".", "randint", "(", "total_negatives", ",", "(", "clength", "*", "negative_batch_size", ",", ")", ")", "\n", "if", "weaker_positive", "is", "None", ":", "\n", "                ", "total_loss", "+=", "celoss", "(", "torch", ".", "cat", "(", "(", "positives_c", ".", "view", "(", "-", "1", ",", "1", ")", ",", "negative_distance_list", "[", "neg_indices", "]", ".", "view", "(", "clength", ",", "-", "1", ")", ")", ",", "1", ")", ",", "zeros", ".", "repeat", "(", "clength", ")", ")", "\n", "", "else", ":", "\n", "                ", "total_loss", "+=", "celoss", "(", "torch", ".", "cat", "(", "(", "positives_c", ".", "view", "(", "-", "1", ",", "1", ")", ",", "weaker_positive", ".", "repeat", "(", "clength", ",", "1", ")", ".", "view", "(", "clength", ",", "-", "1", ")", ",", "negative_distance_list", "[", "neg_indices", "]", ".", "view", "(", "clength", ",", "-", "1", ")", ")", ",", "1", ")", ",", "zeros", ".", "repeat", "(", "clength", ")", ")", "\n", "\n", "", "if", "weaker_positive", "is", "None", ":", "\n", "                ", "weaker_positive", "=", "positives_c", ".", "view", "(", "1", ",", "-", "1", ")", "\n", "", "else", ":", "\n", "                ", "weaker_positive", "=", "torch", ".", "cat", "(", "(", "weaker_positive", ",", "positives_c", ".", "view", "(", "1", ",", "-", "1", ")", ")", ",", "1", ")", "\n", "", "", "return", "total_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.save_matrix": [[361, 373], ["nips_dataset_experiments.Model.embeddings", "open", "range", "open.close", "shutil.copyfile", "range", "open.write", "open.write"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.embeddings"], ["", "def", "save_matrix", "(", "self", ",", "use_mapping", "=", "True", ")", ":", "\n", "        ", "X", "=", "self", ".", "embeddings", "(", "use_mapping", ")", "\n", "n", "=", "X", ".", "shape", "[", "0", "]", "\n", "d", "=", "X", ".", "shape", "[", "1", "]", "\n", "file_name", "=", "\"embedding_matrix_q_%d_d_%d.txt\"", "%", "(", "self", ".", "q", ",", "self", ".", "d", ")", "\n", "f", "=", "open", "(", "file_name", ",", "\"w\"", ")", "\n", "for", "i", "in", "range", "(", "0", ",", "n", ")", ":", "\n", "            ", "for", "j", "in", "range", "(", "0", ",", "d", ")", ":", "\n", "                ", "f", ".", "write", "(", "\"%17.12f \"", "%", "X", "[", "i", ",", "j", "]", ")", "\n", "", "f", ".", "write", "(", "\"\\n\"", ")", "\n", "", "f", ".", "close", "(", ")", "\n", "shutil", ".", "copyfile", "(", "file_name", ",", "\"x.txt\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.radius": [[374, 376], ["nips_dataset_experiments.Model.psqrtbeta", "torch.softplus", "torch.softplus", "torch.softplus", "torch.softplus"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "radius", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "F", ".", "softplus", "(", "self", ".", "rad", ".", "weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.acosh": [[377, 379], ["torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log"], "methods", ["None"], ["", "def", "acosh", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "torch", ".", "log", "(", "x", "+", "(", "x", "*", "x", "-", "1.0", ")", ".", "sqrt", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.psqrtbeta": [[380, 382], ["torch.softplus", "torch.softplus", "torch.softplus", "torch.softplus"], "methods", ["None"], ["", "def", "psqrtbeta", "(", "self", ")", ":", "\n", "        ", "return", "F", ".", "softplus", "(", "self", ".", "sqrtbeta", ".", "weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.nips_dataset_experiments.nips_dataset_experiments.Model.beta": [[383, 385], ["nips_dataset_experiments.Model.psqrtbeta", "nips_dataset_experiments.Model.psqrtbeta"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "beta", "(", "self", ")", ":", "\n", "        ", "return", "-", "(", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.__init__": [[79, 98], ["torch.Module.__init__", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "zachary_experiments.Model.sqrtbeta.weight.data.fill_", "torch.Embedding", "torch.Embedding", "torch.Embedding", "torch.Embedding", "zachary_experiments.Model.rad.weight.data.fill_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "torch.init.uniform_", "math.log", "math.log", "math.exp", "math.exp", "abs"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.__init__"], ["    ", "def", "__init__", "(", "self", ",", "beta", ",", "q", ")", ":", "\n", "        ", "super", "(", "Model", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "embedding", "=", "nn", ".", "Embedding", "(", "nb_nodes", ",", "d", ")", "\n", "if", "q", "==", "1", ":", "\n", "            ", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "0", "]", ",", "1", ",", "1", ")", "\n", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "1", ":", "]", ",", "-", "0.1", ",", "0.1", ")", "\n", "", "else", ":", "\n", "            ", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "0", "]", ",", "1", ",", "1", ")", "\n", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "embedding", ".", "weight", "[", ":", ",", "1", ":", "]", ",", "-", "0.1", ",", "0.1", ")", "\n", "", "self", ".", "sqrtbeta", "=", "nn", ".", "Embedding", "(", "1", ",", "1", ")", "\n", "self", ".", "sqrtbeta", ".", "weight", ".", "data", ".", "fill_", "(", "math", ".", "log", "(", "math", ".", "exp", "(", "abs", "(", "beta", ")", ")", "-", "1", ")", ")", "\n", "self", ".", "q", "=", "q", "\n", "self", ".", "d", "=", "d", "\n", "self", ".", "rad", "=", "nn", ".", "Embedding", "(", "1", ",", "1", ")", "\n", "self", ".", "rad", ".", "weight", ".", "data", ".", "fill_", "(", "math", ".", "log", "(", "math", ".", "exp", "(", "0.5", ")", "-", "1", ")", ")", "\n", "\n", "self", ".", "embedding", ".", "weight", ".", "requires_grad", "=", "True", "\n", "self", ".", "rad", ".", "weight", ".", "requires_grad", "=", "False", "\n", "self", ".", "sqrtbeta", ".", "weight", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.map_on_pseudohyperboloid": [[99, 101], ["zachary_experiments.Model.embeddings"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.embeddings"], ["", "def", "map_on_pseudohyperboloid", "(", "self", ",", "beta_scaling", "=", "True", ")", ":", "\n", "        ", "self", ".", "embedding", ".", "weight", ".", "data", "=", "self", ".", "embeddings", "(", "beta_scaling", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.embeddings": [[102, 132], ["torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "X[].view", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "zachary_experiments.Model.psqrtbeta", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "zachary_experiments.Model.psqrtbeta", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "torch.sqrt().view", "zachary_experiments.Model.psqrtbeta", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "zachary_experiments.Model.psqrtbeta", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "X[].view", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "zachary_experiments.Model.psqrtbeta", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "embeddings", "(", "self", ",", "beta_scaling", "=", "True", ",", "use_mapping", "=", "True", ")", ":", "\n", "        ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "if", "self", ".", "q", "==", "0", ":", "\n", "            ", "return", "X", "\n", "", "if", "not", "use_mapping", ":", "\n", "            ", "return", "X", "\n", "", "elif", "self", ".", "q", "==", "X", ".", "shape", "[", "0", "]", ":", "\n", "            ", "if", "beta_scaling", ":", "\n", "                ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "F", ".", "normalize", "(", "X", ")", "\n", "", "else", ":", "\n", "                ", "return", "F", ".", "normalize", "(", "X", ")", "\n", "", "", "elif", "self", ".", "q", ">", "1", ":", "\n", "            ", "X0", "=", "X", "[", ":", ",", "0", "]", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "Xtime", "=", "F", ".", "normalize", "(", "torch", ".", "cat", "(", "(", "X0", ",", "X", "[", ":", ",", "1", ":", "self", ".", "q", "]", ".", "view", "(", "-", "1", ",", "self", ".", "q", "-", "1", ")", ")", ",", "1", ")", ")", "\n", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "spaceNorm", ".", "add", "(", "1.0", ")", ")", ".", "expand_as", "(", "Xtime", ")", "*", "Xtime", "\n", "if", "beta_scaling", ":", "\n", "                ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "else", ":", "\n", "                ", "return", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "", "elif", "self", ".", "q", "==", "1", ":", "\n", "            ", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "(", "spaceNorm", ")", ".", "add", "(", "1.0", ")", ")", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "if", "beta_scaling", ":", "\n", "                ", "return", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "else", ":", "\n", "                ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "cat", "(", "(", "Xtime", ",", "Xspace", ")", ",", "1", ")", "\n", "", "", "return", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_without_mapping": [[134, 151], ["torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X.t", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.psqrtbeta", "X.t", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "Xspace.t", "Xtime.t"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "compute_similarity_matrix_without_mapping", "(", "self", ",", "beta_scaling", "=", "False", ",", "X", "=", "None", ",", "sample_list", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "", "if", "sample_list", "is", "not", "None", ":", "\n", "            ", "X", "=", "X", "[", "sample_list", ",", ":", "]", "\n", "", "d", "=", "X", ".", "shape", "[", "1", "]", "\n", "if", "self", ".", "q", "==", "0", ":", "\n", "            ", "K", "=", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "d", ":", "\n", "            ", "K", "=", "-", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", ">=", "1", ":", "\n", "            ", "Xtime", "=", "X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "K", "=", "torch", ".", "matmul", "(", "Xspace", ",", "Xspace", ".", "t", "(", ")", ")", "-", "torch", ".", "matmul", "(", "Xtime", ",", "Xtime", ".", "t", "(", ")", ")", "\n", "", "if", "beta_scaling", ":", "\n", "            ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "psqrtbeta", "(", ")", "*", "K", "\n", "", "return", "K", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_with_mapping": [[152, 175], ["torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X.t", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.normalize.t", "zachary_experiments.Model.psqrtbeta", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.sqrt().expand_as", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "X[].div", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "X[].div.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "zachary_experiments.Model.psqrtbeta", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "X[].div.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sqrt.t", "torch.sum.add", "torch.sum.add", "torch.sum.add", "torch.sum.add"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "compute_similarity_matrix_with_mapping", "(", "self", ",", "X", "=", "None", ",", "sample_list", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "", "if", "sample_list", "is", "not", "None", ":", "\n", "            ", "X", "=", "X", "[", "sample_list", ",", ":", "]", "\n", "", "d", "=", "X", ".", "shape", "[", "1", "]", "\n", "if", "self", ".", "q", "==", "0", ":", "\n", "            ", "K", "=", "torch", ".", "matmul", "(", "X", ",", "X", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "d", ":", "\n", "            ", "XX", "=", "F", ".", "normalize", "(", "X", ")", "\n", "K", "=", "-", "torch", ".", "matmul", "(", "XX", ",", "XX", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", ">", "1", ":", "\n", "            ", "Xtime", "=", "F", ".", "normalize", "(", "X", "[", ":", ",", "0", ":", "self", ".", "q", "]", ")", "\n", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "spaceNorm", ".", "add", "(", "1.0", ")", ")", ".", "expand_as", "(", "Xtime", ")", "*", "Xtime", "\n", "K", "=", "torch", ".", "matmul", "(", "Xspace", ",", "Xspace", ".", "t", "(", ")", ")", "-", "torch", ".", "matmul", "(", "Xtime", ",", "Xtime", ".", "t", "(", ")", ")", "\n", "", "elif", "self", ".", "q", "==", "1", ":", "\n", "            ", "Xspace", "=", "X", "[", ":", ",", "self", ".", "q", ":", "]", ".", "div", "(", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "spaceNorm", "=", "torch", ".", "sum", "(", "Xspace", "*", "Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "Xtime", "=", "torch", ".", "sqrt", "(", "(", "spaceNorm", ")", ".", "add", "(", "1.0", ")", ")", "\n", "K", "=", "torch", ".", "matmul", "(", "Xspace", ",", "Xspace", ".", "t", "(", ")", ")", "-", "torch", ".", "matmul", "(", "Xtime", ",", "Xtime", ".", "t", "(", ")", ")", "\n", "", "return", "K", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_distance_matrix": [[177, 197], ["zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.acosh", "zachary_experiments.Model.psqrtbeta", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.psqrtbeta", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "zachary_experiments.Model.psqrtbeta", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "zachary_experiments.Model.psqrtbeta", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "torch.acos", "zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.psqrtbeta"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.acosh", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "compute_distance_matrix", "(", "self", ",", "K", ",", "beta_scaling", "=", "False", ")", ":", "\n", "        ", "if", "beta_scaling", ":", "\n", "            ", "K", "=", "K", "/", "(", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "", "if", "self", ".", "q", "==", "0", ":", "\n", "            ", "K", "=", "-", "K", "\n", "", "epsilon", "=", "0.00001", "\n", "if", "self", ".", "q", "==", "d", ":", "\n", "            ", "euclidean_indices", "=", "(", "K", "<", "-", "1.0", "+", "epsilon", ")", "\n", "K", "[", "euclidean_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "abs", "(", "2.0", "*", "(", "1.0", "+", "K", "[", "euclidean_indices", "]", ")", ")", "\n", "K", "[", "~", "euclidean_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "acos", "(", "-", "K", "[", "~", "euclidean_indices", "]", ")", "\n", "\n", "", "hyperbolic_indices", "=", "K", "<", "-", "1.0", "-", "epsilon", "\n", "euclidean_indices", "=", "(", "K", "<", "-", "1.0", "+", "epsilon", ")", "&", "(", "~", "hyperbolic_indices", ")", "\n", "positive_similarity", "=", "K", ">=", "0.0", "\n", "spherical_indices", "=", "(", "~", "positive_similarity", ")", "&", "(", "~", "(", "K", "<", "-", "1.0", "+", "epsilon", ")", ")", "\n", "K", "[", "hyperbolic_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "acosh", "(", "-", "K", "[", "hyperbolic_indices", "]", ")", "\n", "K", "[", "euclidean_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "abs", "(", "2.0", "*", "(", "1.0", "+", "K", "[", "euclidean_indices", "]", ")", ")", "\n", "K", "[", "positive_similarity", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "(", "math", ".", "pi", "/", "2", "+", "K", "[", "positive_similarity", "]", ")", "\n", "K", "[", "spherical_indices", "]", "=", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "acos", "(", "-", "K", "[", "spherical_indices", "]", ")", "\n", "return", "K", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.stopping_criterion": [[201, 237], ["zachary_experiments.Model.compute_distance_matrix", "range", "zachary_experiments.Model.compute_similarity_matrix_with_mapping", "zachary_experiments.Model.compute_similarity_matrix_without_mapping", "range", "negative_distance_list.append", "positive_distance_list[].append", "positive_distance_list[].append"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_distance_matrix", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_with_mapping", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_without_mapping"], ["", "def", "stopping_criterion", "(", "self", ",", "use_mapping", "=", "True", ")", ":", "\n", "        ", "if", "use_mapping", ":", "\n", "            ", "K", "=", "self", ".", "compute_similarity_matrix_with_mapping", "(", ")", "\n", "", "else", ":", "\n", "            ", "K", "=", "self", ".", "compute_similarity_matrix_without_mapping", "(", ")", "\n", "", "n", "=", "K", ".", "shape", "[", "0", "]", "\n", "K", "=", "self", ".", "compute_distance_matrix", "(", "K", ",", "not", "use_mapping", ")", "\n", "cpt", "=", "0", "\n", "negative_distance_list", "=", "[", "]", "\n", "positive_distance_list", "=", "{", "}", "\n", "for", "i", "in", "range", "(", "0", ",", "n", ")", ":", "\n", "            ", "for", "j", "in", "range", "(", "i", "+", "1", ",", "n", ")", ":", "\n", "                ", "d", "=", "K", "[", "i", ",", "j", "]", "\n", "if", "(", "j", ",", "i", ")", "in", "edge_list", ":", "\n", "                    ", "if", "weighted_version", ":", "\n", "                        ", "k", "=", "weights_78", "[", "cpt", "]", "\n", "", "else", ":", "\n", "                        ", "k", "=", "1", "\n", "", "cpt", "+=", "1", "\n", "if", "k", "in", "positive_distance_list", ":", "\n", "                        ", "positive_distance_list", "[", "k", "]", ".", "append", "(", "d", ")", "\n", "", "else", ":", "\n", "                        ", "positive_distance_list", "[", "k", "]", "=", "[", "]", "\n", "positive_distance_list", "[", "k", "]", ".", "append", "(", "d", ")", "\n", "\n", "", "", "else", ":", "\n", "                    ", "negative_distance_list", ".", "append", "(", "d", ")", "\n", "\n", "", "", "", "for", "c", "in", "ordered_c", ":", "\n", "            ", "for", "positive", "in", "positive_distance_list", "[", "c", "]", ":", "\n", "                ", "for", "neg", "in", "negative_distance_list", ":", "\n", "                    ", "if", "positive", ">", "neg", ":", "\n", "                        ", "return", "False", "\n", "", "", "", "negative_distance_list", "=", "positive_distance_list", "[", "c", "]", "\n", "\n", "", "return", "True", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.rescale_beta": [[239, 246], ["zachary_experiments.Model.psqrtbeta", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "rescale_beta", "(", "self", ",", "X", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", ".", "data", "\n", "", "norm_X", "=", "X", "*", "X", "\n", "norm_Xtime", "=", "norm_X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "norm_Xspace", "=", "norm_X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "return", "X", "/", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "norm_Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "norm_Xtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ")", ".", "sqrt", "(", ")", ".", "expand_as", "(", "X", ")", "*", "self", ".", "psqrtbeta", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.perform_rescaling_beta": [[247, 254], ["zachary_experiments.Model.psqrtbeta", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt().expand_as", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "perform_rescaling_beta", "(", "self", ",", "X", "=", "None", ")", ":", "\n", "        ", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", "\n", "", "norm_X", "=", "X", "*", "X", "\n", "norm_Xtime", "=", "norm_X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "norm_Xspace", "=", "norm_X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "self", ".", "embedding", ".", "weight", ".", "data", "=", "X", "/", "torch", ".", "abs", "(", "torch", ".", "sum", "(", "norm_Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "norm_Xtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ")", ".", "sqrt", "(", ")", ".", "expand_as", "(", "X", ")", "*", "self", ".", "psqrtbeta", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.scalar_product": [[255, 258], ["None"], "methods", ["None"], ["", "def", "scalar_product", "(", "self", ",", "x", ",", "y", ")", ":", "\n", "        ", "z", "=", "x", "*", "y", "\n", "return", "z", "[", "self", ".", "q", ":", "]", "-", "z", "[", "0", ":", "self", ".", "q", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.change_metric": [[259, 263], ["x.clone"], "methods", ["None"], ["", "def", "change_metric", "(", "self", ",", "x", ")", ":", "\n", "        ", "z", "=", "x", ".", "clone", "(", ")", "\n", "z", "[", ":", ",", "0", ":", "self", ".", "q", "]", "=", "-", "z", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "return", "z", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.exponential_map": [[264, 329], ["zachary_experiments.Model.psqrtbeta", "gradient.clone", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "torch.empty", "norm_xi.view.view.view", "zachary_experiments.Model.rescale_beta", "zachary_experiments.Model.embedding.weight.clone", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "torch.abs().sqrt", "U.to.to.to", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "zachary_experiments.Model.change_metric", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cos().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.cosh().repeat", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "zachary_experiments.Model.change_metric", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cos", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "torch.cosh", "zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.psqrtbeta", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "torch.sin", "zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.psqrtbeta", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "torch.sinh", "zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.psqrtbeta"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.rescale_beta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.change_metric", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.change_metric", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "exponential_map", "(", "self", ",", "gradient", ",", "step_size", ",", "X", "=", "None", ")", ":", "\n", "        ", "t", "=", "-", "step_size", "\n", "n", "=", "gradient", ".", "shape", "[", "0", "]", "\n", "d", "=", "gradient", ".", "shape", "[", "1", "]", "\n", "sqrt_beta", "=", "self", ".", "psqrtbeta", "(", ")", "\n", "g", "=", "gradient", ".", "clone", "(", ")", "\n", "if", "X", "is", "None", ":", "\n", "            ", "X", "=", "self", ".", "embedding", ".", "weight", ".", "clone", "(", ")", "\n", "", "gX", "=", "g", "*", "X", "\n", "gXtime", "=", "gX", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "gXspace", "=", "gX", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "gXsum", "=", "torch", ".", "sum", "(", "gX", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "gXsumq", "=", "torch", ".", "sum", "(", "gXspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "gXtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "norm_X", "=", "X", "*", "X", "\n", "norm_Xtime", "=", "norm_X", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "norm_Xspace", "=", "norm_X", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "sq_normX", "=", "torch", ".", "sum", "(", "norm_Xspace", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "-", "torch", ".", "sum", "(", "norm_Xtime", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "l2_sq_normX", "=", "torch", ".", "sum", "(", "norm_X", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "\n", "epsilon", "=", "0.000000000001", "\n", "\n", "\n", "if", "use_pseudoRiemannian_gradient", "or", "(", "self", ".", "q", "==", "1", ")", "or", "(", "self", ".", "q", "==", "d", ")", ":", "\n", "            ", "apply_precondition", "=", "False", "\n", "", "else", ":", "\n", "            ", "apply_precondition", "=", "True", "\n", "", "if", "apply_precondition", ":", "\n", "#xi_preconditioned = g - self.change_metric(X) * (gXsum / sq_normX).expand_as(X) - X * ((torch.sum(gXspace,dim=1, keepdim=True) - torch.sum(gXtime,dim=1, keepdim=True)) / sq_normX).expand_as(X) + X * (l2_sq_normX * gXsum / (sq_normX * sq_normX)).expand_as(X)", "\n", "            ", "xi_preconditioned", "=", "g", "-", "self", ".", "change_metric", "(", "X", ")", "*", "(", "gXsum", "/", "sq_normX", ")", ".", "expand_as", "(", "X", ")", "+", "X", "*", "(", "(", "l2_sq_normX", "*", "gXsum", ")", "/", "(", "sq_normX", "*", "sq_normX", ")", "-", "(", "gXsumq", "/", "sq_normX", ")", ")", ".", "expand_as", "(", "X", ")", "\n", "sq_norm_xi_preconditioned_1", "=", "xi_preconditioned", "*", "xi_preconditioned", "\n", "sq_norm_xitime_preconditioned", "=", "sq_norm_xi_preconditioned_1", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "sq_norm_xispace_preconditioned", "=", "sq_norm_xi_preconditioned_1", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "sq_norm_xi_preconditioned", "=", "torch", ".", "sum", "(", "sq_norm_xispace_preconditioned", ",", "dim", "=", "1", ")", "-", "torch", ".", "sum", "(", "sq_norm_xitime_preconditioned", ",", "dim", "=", "1", ")", "\n", "norm_xi_preconditioned", "=", "torch", ".", "abs", "(", "sq_norm_xi_preconditioned", ")", ".", "sqrt", "(", ")", "\n", "sq_norm_xi", "=", "sq_norm_xi_preconditioned", "\n", "norm_xi", "=", "norm_xi_preconditioned", "\n", "xi", "=", "xi_preconditioned", "\n", "", "else", ":", "\n", "            ", "xi_sr", "=", "self", ".", "change_metric", "(", "gradient", ")", "-", "X", "*", "(", "gXsum", "/", "sq_normX", ")", ".", "expand_as", "(", "X", ")", "\n", "sq_norm_xi_sr", "=", "xi_sr", "*", "xi_sr", "\n", "sq_norm_xitime_sr", "=", "sq_norm_xi_sr", "[", ":", ",", "0", ":", "self", ".", "q", "]", "\n", "sq_norm_xispace_sr", "=", "sq_norm_xi_sr", "[", ":", ",", "self", ".", "q", ":", "]", "\n", "sq_norm_xi_sr", "=", "torch", ".", "sum", "(", "sq_norm_xispace_sr", ",", "dim", "=", "1", ")", "-", "torch", ".", "sum", "(", "sq_norm_xitime_sr", ",", "dim", "=", "1", ")", "\n", "norm_xi_sr", "=", "torch", ".", "abs", "(", "sq_norm_xi_sr", ")", ".", "sqrt", "(", ")", "\n", "sq_norm_xi", "=", "sq_norm_xi_sr", "\n", "norm_xi", "=", "norm_xi_sr", "\n", "xi", "=", "xi_sr", "\n", "if", "(", "self", ".", "q", "==", "d", ")", ":", "\n", "                ", "t", "=", "-", "t", "\n", "", "", "cpt", "=", "0", "\n", "U", "=", "torch", ".", "empty", "(", "n", ",", "d", ")", "\n", "if", "use_cuda", ":", "\n", "            ", "U", "=", "U", ".", "to", "(", "device", ")", "\n", "\n", "", "time_like", "=", "sq_norm_xi", "<", "-", "epsilon", "\n", "space_like", "=", "sq_norm_xi", ">", "epsilon", "\n", "null_geodesic", "=", "(", "~", "space_like", ")", "&", "(", "~", "time_like", ")", "\n", "norm_xi", "=", "norm_xi", ".", "view", "(", "-", "1", ",", "1", ")", "\n", "U", "[", "time_like", ",", ":", "]", "=", "X", "[", "time_like", ",", ":", "]", "*", "torch", ".", "cos", "(", "t", "*", "norm_xi", "[", "time_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", ".", "repeat", "(", "1", ",", "d", ")", "+", "(", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "sin", "(", "t", "*", "norm_xi", "[", "time_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", "/", "norm_xi", "[", "time_like", "]", ")", ".", "repeat", "(", "1", ",", "d", ")", "*", "xi", "[", "time_like", ",", ":", "]", "\n", "U", "[", "space_like", ",", ":", "]", "=", "X", "[", "space_like", ",", ":", "]", "*", "torch", ".", "cosh", "(", "t", "*", "norm_xi", "[", "space_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", ".", "repeat", "(", "1", ",", "d", ")", "+", "(", "self", ".", "psqrtbeta", "(", ")", "*", "torch", ".", "sinh", "(", "t", "*", "norm_xi", "[", "space_like", "]", "/", "self", ".", "psqrtbeta", "(", ")", ")", "/", "norm_xi", "[", "space_like", "]", ")", ".", "repeat", "(", "1", ",", "d", ")", "*", "xi", "[", "space_like", ",", ":", "]", "\n", "U", "[", "null_geodesic", ",", ":", "]", "=", "X", "[", "null_geodesic", ",", ":", "]", "+", "t", "*", "xi", "[", "null_geodesic", ",", ":", "]", "\n", "\n", "if", "self", ".", "q", "==", "1", ":", "\n", "            ", "U", "[", ":", ",", "0", "]", "=", "torch", ".", "abs", "(", "U", "[", ":", ",", "0", "]", ")", "\n", "", "self", ".", "embedding", ".", "weight", ".", "data", "=", "self", ".", "rescale_beta", "(", "X", "=", "U", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.loss_function": [[330, 365], ["torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "K[].view", "torch.CrossEntropyLoss.", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "zachary_experiments.Model.compute_similarity_matrix_with_mapping", "zachary_experiments.Model.compute_similarity_matrix_without_mapping", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "zeros.repeat", "positives_c.view", "zachary_experiments.Model.compute_distance_matrix", "positives_c.view", "torch.cat.repeat", "torch.cat.repeat", "torch.cat.repeat", "torch.cat.repeat"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_with_mapping", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_without_mapping", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_distance_matrix"], ["", "def", "loss_function", "(", "self", ",", "use_mapping", "=", "True", ",", "beta_scaling", "=", "True", ",", "similarity_matrix", "=", "None", ",", "sample_list", "=", "None", ")", ":", "\n", "        ", "if", "similarity_matrix", "is", "None", ":", "\n", "            ", "if", "use_mapping", ":", "\n", "                ", "K", "=", "self", ".", "compute_similarity_matrix_with_mapping", "(", "sample_list", "=", "sample_list", ")", "\n", "", "else", ":", "\n", "                ", "K", "=", "self", ".", "compute_similarity_matrix_without_mapping", "(", "sample_list", "=", "sample_list", ")", "\n", "", "", "else", ":", "\n", "                ", "K", "=", "similarity_matrix", "\n", "", "total_loss", "=", "0.0", "\n", "temperature_inv", "=", "100.0", "\n", "nb_positive", "=", "0", "\n", "nb_negative", "=", "0", "\n", "nb_satisfied", "=", "0", "\n", "nb_constraints", "=", "0", "\n", "celoss", "=", "nn", ".", "CrossEntropyLoss", "(", "reduction", "=", "\"sum\"", ")", "\n", "losses", "=", "None", "\n", "negative_distance_list", "=", "None", "\n", "positive_distance_list", "=", "{", "}", "\n", "cpt", "=", "0", "\n", "n", "=", "K", ".", "shape", "[", "0", "]", "\n", "drawn_number", "=", "n", "\n", "K", "=", "(", "-", "self", ".", "compute_distance_matrix", "(", "K", ")", "*", "temperature_inv", ")", ".", "view", "(", "-", "1", ")", "\n", "total_c", "=", "0", "\n", "negative_distance_list", "=", "K", "[", "positive_indices", "[", "0", "]", "]", ".", "view", "(", "1", ",", "-", "1", ")", "\n", "\n", "cptindx", "=", "0", "\n", "nb_positives", "=", "0", "\n", "for", "c", "in", "ordered_c", ":", "\n", "            ", "if", "c", "not", "in", "positive_indices", ":", "\n", "                ", "continue", "\n", "", "positives_c", "=", "K", "[", "positive_indices", "[", "c", "]", "]", "\n", "clength", "=", "positives_c", ".", "shape", "[", "0", "]", "\n", "total_loss", "+=", "celoss", "(", "torch", ".", "cat", "(", "(", "positives_c", ".", "view", "(", "-", "1", ",", "1", ")", ",", "negative_distance_list", ".", "repeat", "(", "clength", ",", "1", ")", ")", ",", "1", ")", ",", "zeros", ".", "repeat", "(", "clength", ")", ")", "\n", "negative_distance_list", "=", "torch", ".", "cat", "(", "(", "negative_distance_list", ",", "positives_c", ".", "view", "(", "1", ",", "-", "1", ")", ")", ",", "1", ")", "\n", "", "return", "total_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.save_matrix": [[366, 389], ["zachary_experiments.Model.embeddings", "open", "range", "open.close", "shutil.copyfile", "zachary_experiments.Model.compute_distance_matrix", "open", "range", "open.close", "range", "open.write", "zachary_experiments.Model.compute_similarity_matrix_with_mapping", "zachary_experiments.Model.compute_similarity_matrix_without_mapping", "range", "open.write", "open.write", "open.write"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.embeddings", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_distance_matrix", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_with_mapping", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.compute_similarity_matrix_without_mapping"], ["", "def", "save_matrix", "(", "self", ",", "use_mapping", "=", "True", ")", ":", "\n", "        ", "X", "=", "self", ".", "embeddings", "(", "use_mapping", ")", "\n", "n", "=", "X", ".", "shape", "[", "0", "]", "\n", "d", "=", "X", ".", "shape", "[", "1", "]", "\n", "file_name", "=", "\"embedding_matrix_q_%d_d_%d.txt\"", "%", "(", "self", ".", "q", ",", "self", ".", "d", ")", "\n", "f", "=", "open", "(", "file_name", ",", "\"w\"", ")", "\n", "for", "i", "in", "range", "(", "0", ",", "n", ")", ":", "\n", "            ", "for", "j", "in", "range", "(", "0", ",", "d", ")", ":", "\n", "                ", "f", ".", "write", "(", "\"%17.12f \"", "%", "X", "[", "i", ",", "j", "]", ")", "\n", "", "f", ".", "write", "(", "\"\\n\"", ")", "\n", "", "f", ".", "close", "(", ")", "\n", "shutil", ".", "copyfile", "(", "file_name", ",", "\"x.txt\"", ")", "\n", "if", "use_mapping", ":", "\n", "            ", "K", "=", "self", ".", "compute_similarity_matrix_with_mapping", "(", ")", "\n", "", "else", ":", "\n", "            ", "K", "=", "self", ".", "compute_similarity_matrix_without_mapping", "(", ")", "\n", "", "K", "=", "self", ".", "compute_distance_matrix", "(", "K", ",", "not", "use_mapping", ")", "\n", "f", "=", "open", "(", "\"d.txt\"", ",", "\"w\"", ")", "\n", "for", "i", "in", "range", "(", "0", ",", "n", ")", ":", "\n", "            ", "for", "j", "in", "range", "(", "0", ",", "n", ")", ":", "\n", "                ", "f", ".", "write", "(", "\"%17.12f \"", "%", "K", "[", "i", ",", "j", "]", ")", "\n", "", "f", ".", "write", "(", "\"\\n\"", ")", "\n", "", "f", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.radius": [[391, 393], ["zachary_experiments.Model.psqrtbeta", "torch.softplus", "torch.softplus", "torch.softplus", "torch.softplus"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "radius", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "psqrtbeta", "(", ")", "*", "F", ".", "softplus", "(", "self", ".", "rad", ".", "weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.acosh": [[394, 396], ["torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log"], "methods", ["None"], ["", "def", "acosh", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "torch", ".", "log", "(", "x", "+", "(", "x", "*", "x", "-", "1.0", ")", ".", "sqrt", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta": [[397, 399], ["torch.softplus", "torch.softplus", "torch.softplus", "torch.softplus"], "methods", ["None"], ["", "def", "psqrtbeta", "(", "self", ")", ":", "\n", "        ", "return", "F", ".", "softplus", "(", "self", ".", "sqrtbeta", ".", "weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.beta": [[400, 402], ["zachary_experiments.Model.psqrtbeta", "zachary_experiments.Model.psqrtbeta"], "methods", ["home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta", "home.repos.pwc.inspect_result.MarcTLaw_UltrahyperbolicRepresentation.zachary_experiments.zachary_experiments.Model.psqrtbeta"], ["", "def", "beta", "(", "self", ")", ":", "\n", "        ", "return", "-", "(", "self", ".", "psqrtbeta", "(", ")", "*", "self", ".", "psqrtbeta", "(", ")", ")", "\n", "\n"]]}