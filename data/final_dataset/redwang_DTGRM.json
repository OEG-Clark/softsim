{"home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.read_file": [[5, 10], ["open", "f.read", "f.close"], "function", ["None"], ["def", "read_file", "(", "path", ")", ":", "\n", "    ", "with", "open", "(", "path", ",", "'r'", ")", "as", "f", ":", "\n", "        ", "content", "=", "f", ".", "read", "(", ")", "\n", "f", ".", "close", "(", ")", "\n", "", "return", "content", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.get_labels_start_end_time": [[12, 31], ["range", "labels.append", "starts.append", "len", "ends.append", "labels.append", "starts.append", "ends.append"], "function", ["None"], ["", "def", "get_labels_start_end_time", "(", "frame_wise_labels", ",", "bg_class", "=", "[", "\"background\"", "]", ")", ":", "\n", "    ", "labels", "=", "[", "]", "\n", "starts", "=", "[", "]", "\n", "ends", "=", "[", "]", "\n", "last_label", "=", "frame_wise_labels", "[", "0", "]", "\n", "if", "frame_wise_labels", "[", "0", "]", "not", "in", "bg_class", ":", "\n", "        ", "labels", ".", "append", "(", "frame_wise_labels", "[", "0", "]", ")", "\n", "starts", ".", "append", "(", "0", ")", "\n", "", "for", "i", "in", "range", "(", "len", "(", "frame_wise_labels", ")", ")", ":", "\n", "        ", "if", "frame_wise_labels", "[", "i", "]", "!=", "last_label", ":", "\n", "            ", "if", "frame_wise_labels", "[", "i", "]", "not", "in", "bg_class", ":", "\n", "                ", "labels", ".", "append", "(", "frame_wise_labels", "[", "i", "]", ")", "\n", "starts", ".", "append", "(", "i", ")", "\n", "", "if", "last_label", "not", "in", "bg_class", ":", "\n", "                ", "ends", ".", "append", "(", "i", ")", "\n", "", "last_label", "=", "frame_wise_labels", "[", "i", "]", "\n", "", "", "if", "last_label", "not", "in", "bg_class", ":", "\n", "        ", "ends", ".", "append", "(", "i", ")", "\n", "", "return", "labels", ",", "starts", ",", "ends", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.levenstein": [[33, 57], ["len", "len", "numpy.zeros", "range", "range", "range", "range", "min", "max"], "function", ["None"], ["", "def", "levenstein", "(", "p", ",", "y", ",", "norm", "=", "False", ")", ":", "\n", "    ", "m_row", "=", "len", "(", "p", ")", "\n", "n_col", "=", "len", "(", "y", ")", "\n", "D", "=", "np", ".", "zeros", "(", "[", "m_row", "+", "1", ",", "n_col", "+", "1", "]", ",", "np", ".", "float", ")", "\n", "for", "i", "in", "range", "(", "m_row", "+", "1", ")", ":", "\n", "        ", "D", "[", "i", ",", "0", "]", "=", "i", "\n", "", "for", "i", "in", "range", "(", "n_col", "+", "1", ")", ":", "\n", "        ", "D", "[", "0", ",", "i", "]", "=", "i", "\n", "\n", "", "for", "j", "in", "range", "(", "1", ",", "n_col", "+", "1", ")", ":", "\n", "        ", "for", "i", "in", "range", "(", "1", ",", "m_row", "+", "1", ")", ":", "\n", "            ", "if", "y", "[", "j", "-", "1", "]", "==", "p", "[", "i", "-", "1", "]", ":", "\n", "                ", "D", "[", "i", ",", "j", "]", "=", "D", "[", "i", "-", "1", ",", "j", "-", "1", "]", "\n", "", "else", ":", "\n", "                ", "D", "[", "i", ",", "j", "]", "=", "min", "(", "D", "[", "i", "-", "1", ",", "j", "]", "+", "1", ",", "\n", "D", "[", "i", ",", "j", "-", "1", "]", "+", "1", ",", "\n", "D", "[", "i", "-", "1", ",", "j", "-", "1", "]", "+", "1", ")", "\n", "\n", "", "", "", "if", "norm", ":", "\n", "        ", "score", "=", "(", "1", "-", "D", "[", "-", "1", ",", "-", "1", "]", "/", "max", "(", "m_row", ",", "n_col", ")", ")", "*", "100", "\n", "", "else", ":", "\n", "        ", "score", "=", "D", "[", "-", "1", ",", "-", "1", "]", "\n", "\n", "", "return", "score", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.edit_score": [[59, 63], ["eval.get_labels_start_end_time", "eval.get_labels_start_end_time", "eval.levenstein"], "function", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.get_labels_start_end_time", "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.get_labels_start_end_time", "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.levenstein"], ["", "def", "edit_score", "(", "recognized", ",", "ground_truth", ",", "norm", "=", "True", ",", "bg_class", "=", "[", "\"background\"", "]", ")", ":", "\n", "    ", "P", ",", "_", ",", "_", "=", "get_labels_start_end_time", "(", "recognized", ",", "bg_class", ")", "\n", "Y", ",", "_", ",", "_", "=", "get_labels_start_end_time", "(", "ground_truth", ",", "bg_class", ")", "\n", "return", "levenstein", "(", "P", ",", "Y", ",", "norm", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.f_score": [[65, 88], ["eval.get_labels_start_end_time", "eval.get_labels_start_end_time", "numpy.zeros", "range", "len", "len", "numpy.array().argmax", "len", "sum", "float", "float", "float", "numpy.minimum", "numpy.maximum", "numpy.maximum", "numpy.minimum", "numpy.array", "range", "len"], "function", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.get_labels_start_end_time", "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.get_labels_start_end_time"], ["", "def", "f_score", "(", "recognized", ",", "ground_truth", ",", "overlap", ",", "bg_class", "=", "[", "\"background\"", "]", ")", ":", "\n", "    ", "p_label", ",", "p_start", ",", "p_end", "=", "get_labels_start_end_time", "(", "recognized", ",", "bg_class", ")", "\n", "y_label", ",", "y_start", ",", "y_end", "=", "get_labels_start_end_time", "(", "ground_truth", ",", "bg_class", ")", "\n", "\n", "tp", "=", "0", "\n", "fp", "=", "0", "\n", "\n", "hits", "=", "np", ".", "zeros", "(", "len", "(", "y_label", ")", ")", "\n", "\n", "for", "j", "in", "range", "(", "len", "(", "p_label", ")", ")", ":", "\n", "        ", "intersection", "=", "np", ".", "minimum", "(", "p_end", "[", "j", "]", ",", "y_end", ")", "-", "np", ".", "maximum", "(", "p_start", "[", "j", "]", ",", "y_start", ")", "\n", "union", "=", "np", ".", "maximum", "(", "p_end", "[", "j", "]", ",", "y_end", ")", "-", "np", ".", "minimum", "(", "p_start", "[", "j", "]", ",", "y_start", ")", "\n", "IoU", "=", "(", "1.0", "*", "intersection", "/", "union", ")", "*", "(", "[", "p_label", "[", "j", "]", "==", "y_label", "[", "x", "]", "for", "x", "in", "range", "(", "len", "(", "y_label", ")", ")", "]", ")", "\n", "# Get the best scoring segment", "\n", "idx", "=", "np", ".", "array", "(", "IoU", ")", ".", "argmax", "(", ")", "\n", "\n", "if", "IoU", "[", "idx", "]", ">=", "overlap", "and", "not", "hits", "[", "idx", "]", ":", "\n", "            ", "tp", "+=", "1", "\n", "hits", "[", "idx", "]", "=", "1", "\n", "", "else", ":", "\n", "            ", "fp", "+=", "1", "\n", "", "", "fn", "=", "len", "(", "y_label", ")", "-", "sum", "(", "hits", ")", "\n", "return", "float", "(", "tp", ")", ",", "float", "(", "fp", ")", ",", "float", "(", "fn", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.main": [[90, 148], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "print", "print", "print", "range", "read_file().split", "numpy.zeros", "numpy.zeros", "numpy.zeros", "[].split", "range", "eval.edit_score", "range", "len", "print", "read_file().split", "len", "len", "eval.f_score", "float", "float", "numpy.nan_to_num", "eval.read_file", "vid.split", "len", "eval.read_file", "read_file().split", "float", "eval.read_file"], "function", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.edit_score", "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.f_score", "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.read_file", "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.read_file", "home.repos.pwc.inspect_result.redwang_DTGRM.None.eval.read_file"], ["", "def", "main", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--dataset'", ",", "default", "=", "\"gtea\"", ")", "\n", "parser", ".", "add_argument", "(", "'--split'", ",", "default", "=", "'1'", ")", "\n", "parser", ".", "add_argument", "(", "'--num_stages'", ",", "type", "=", "str", ",", "default", "=", "'4'", ")", "\n", "parser", ".", "add_argument", "(", "'--num_layers'", ",", "type", "=", "str", ",", "default", "=", "'10'", ")", "\n", "parser", ".", "add_argument", "(", "'--num_f_maps'", ",", "type", "=", "str", ",", "default", "=", "'64'", ")", "\n", "parser", ".", "add_argument", "(", "'--df_size'", ",", "type", "=", "str", ",", "default", "=", "'3'", ")", "\n", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "print", "(", "\"Eval::\"", "+", "args", ".", "dataset", "+", "\"_split_\"", "+", "args", ".", "split", "+", "\"---stages_\"", "+", "args", ".", "num_stages", "+", "\n", "\"_layers_\"", "+", "args", ".", "num_layers", "+", "\"_fmaps_\"", "+", "args", ".", "num_f_maps", "+", "\"_dfsize_\"", "+", "args", ".", "df_size", ")", "\n", "\n", "ground_truth_path", "=", "\"./data/\"", "+", "args", ".", "dataset", "+", "\"/groundTruth/\"", "\n", "recog_path", "=", "\"./results/\"", "+", "args", ".", "dataset", "+", "\"/split_\"", "+", "args", ".", "split", "+", "\"/stages_\"", "+", "args", ".", "num_stages", "+", "\"_layers_\"", "+", "args", ".", "num_layers", "+", "\"_fmaps_\"", "+", "args", ".", "num_f_maps", "+", "\"_dfsize_\"", "+", "args", ".", "df_size", "+", "\"/\"", "\n", "file_list", "=", "\"./data/\"", "+", "args", ".", "dataset", "+", "\"/splits/test.split\"", "+", "args", ".", "split", "+", "\".bundle\"", "\n", "\n", "list_of_videos", "=", "read_file", "(", "file_list", ")", ".", "split", "(", "'\\n'", ")", "[", ":", "-", "1", "]", "\n", "\n", "overlap", "=", "[", ".1", ",", ".25", ",", ".5", "]", "\n", "tp", ",", "fp", ",", "fn", "=", "np", ".", "zeros", "(", "3", ")", ",", "np", ".", "zeros", "(", "3", ")", ",", "np", ".", "zeros", "(", "3", ")", "\n", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "edit", "=", "0", "\n", "\n", "for", "vid", "in", "list_of_videos", ":", "\n", "        ", "gt_file", "=", "ground_truth_path", "+", "vid", "\n", "gt_content", "=", "read_file", "(", "gt_file", ")", ".", "split", "(", "'\\n'", ")", "[", "0", ":", "-", "1", "]", "\n", "\n", "recog_file", "=", "recog_path", "+", "vid", ".", "split", "(", "'.'", ")", "[", "0", "]", "\n", "recog_content", "=", "read_file", "(", "recog_file", ")", ".", "split", "(", "'\\n'", ")", "[", "1", "]", ".", "split", "(", ")", "\n", "\n", "for", "i", "in", "range", "(", "len", "(", "gt_content", ")", ")", ":", "\n", "            ", "total", "+=", "1", "\n", "if", "gt_content", "[", "i", "]", "==", "recog_content", "[", "i", "]", ":", "\n", "                ", "correct", "+=", "1", "\n", "\n", "", "", "edit", "+=", "edit_score", "(", "recog_content", ",", "gt_content", ")", "\n", "\n", "for", "s", "in", "range", "(", "len", "(", "overlap", ")", ")", ":", "\n", "            ", "tp1", ",", "fp1", ",", "fn1", "=", "f_score", "(", "recog_content", ",", "gt_content", ",", "overlap", "[", "s", "]", ")", "\n", "tp", "[", "s", "]", "+=", "tp1", "\n", "fp", "[", "s", "]", "+=", "fp1", "\n", "fn", "[", "s", "]", "+=", "fn1", "\n", "\n", "", "", "print", "(", "\"Acc: %.4f\"", "%", "(", "100", "*", "float", "(", "correct", ")", "/", "total", ")", ")", "\n", "print", "(", "'Edit: %.4f'", "%", "(", "(", "1.0", "*", "edit", ")", "/", "len", "(", "list_of_videos", ")", ")", ")", "\n", "for", "s", "in", "range", "(", "len", "(", "overlap", ")", ")", ":", "\n", "        ", "precision", "=", "tp", "[", "s", "]", "/", "float", "(", "tp", "[", "s", "]", "+", "fp", "[", "s", "]", ")", "\n", "recall", "=", "tp", "[", "s", "]", "/", "float", "(", "tp", "[", "s", "]", "+", "fn", "[", "s", "]", ")", "\n", "\n", "f1", "=", "2.0", "*", "(", "precision", "*", "recall", ")", "/", "(", "precision", "+", "recall", ")", "\n", "\n", "f1", "=", "np", ".", "nan_to_num", "(", "f1", ")", "*", "100", "\n", "print", "(", "'F1@%0.2f: %.4f'", "%", "(", "overlap", "[", "s", "]", ",", "f1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.SingleStageModel.__init__": [[33, 39], ["torch.Module.__init__", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "copy.deepcopy", "layers.DilatedResidualLayer", "range"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_layers", ",", "num_f_maps", ",", "dim", ",", "num_classes", ")", ":", "\n", "        ", "super", "(", "SingleStageModel", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv_1x1", "=", "nn", ".", "Conv1d", "(", "dim", ",", "num_f_maps", ",", "1", ")", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", "[", "copy", ".", "deepcopy", "(", "DilatedResidualLayer", "(", "2", "**", "i", ",", "num_f_maps", ",", "num_f_maps", ")", ")", "for", "i", "in", "range", "(", "num_layers", ")", "]", ")", "\n", "self", ".", "conv_out", "=", "nn", ".", "Conv1d", "(", "num_f_maps", ",", "num_classes", ",", "1", ")", "\n", "self", ".", "exchange_out", "=", "nn", ".", "Conv1d", "(", "num_f_maps", ",", "2", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.SingleStageModel.forward": [[40, 53], ["layers.SingleStageModel.conv_1x1", "layers.SingleStageModel.conv_1x1", "layer", "layers.SingleStageModel.conv_out", "layer", "layers.SingleStageModel.exchange_out", "layers.SingleStageModel.conv_out"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "mask", ",", "ex_x", ",", "ex_label", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1x1", "(", "x", ")", "\n", "for", "layer", "in", "self", ".", "layers", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "mask", ")", "\n", "", "pred", "=", "self", ".", "conv_out", "(", "out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "\n", "ex_out", "=", "self", ".", "conv_1x1", "(", "ex_x", ")", "\n", "for", "layer", "in", "self", ".", "layers", ":", "\n", "            ", "ex_out", "=", "layer", "(", "ex_out", ",", "mask", ")", "\n", "", "ex_pred", "=", "self", ".", "exchange_out", "(", "ex_out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "ex_clspred", "=", "self", ".", "conv_out", "(", "ex_out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "\n", "return", "pred", ",", "ex_pred", ",", "ex_label", ",", "ex_clspred", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DilatedResidualLayer.__init__": [[56, 61], ["torch.Module.__init__", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Dropout", "torch.Dropout", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dilation", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "DilatedResidualLayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv_dilated", "=", "nn", ".", "Conv1d", "(", "in_channels", ",", "out_channels", ",", "3", ",", "padding", "=", "dilation", ",", "dilation", "=", "dilation", ")", "\n", "self", ".", "conv_1x1", "=", "nn", ".", "Conv1d", "(", "out_channels", ",", "out_channels", ",", "1", ")", "\n", "self", ".", "dropout", "=", "nn", ".", "Dropout", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DilatedResidualLayer.forward": [[62, 67], ["torch.relu", "torch.relu", "torch.relu", "layers.DilatedResidualLayer.conv_1x1", "layers.DilatedResidualLayer.dropout", "layers.DilatedResidualLayer.conv_dilated"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "mask", ")", ":", "\n", "        ", "out", "=", "F", ".", "relu", "(", "self", ".", "conv_dilated", "(", "x", ")", ")", "\n", "out", "=", "self", ".", "conv_1x1", "(", "out", ")", "\n", "out", "=", "self", ".", "dropout", "(", "out", ")", "\n", "return", "(", "x", "+", "out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DRCGraphConvolution.__init__": [[70, 84], ["torch.nn.modules.module.Module.__init__", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "torch.Dropout", "torch.Dropout", "torch.Dropout", "layers.DRCGraphConvolution.reset_parameters", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "layers.DRCGraphConvolution.register_parameter", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.__init__", "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DRCGraphConvolution.reset_parameters"], ["    ", "def", "__init__", "(", "self", ",", "in_features", ",", "out_features", ",", "bias", "=", "True", ",", "kernel_size", "=", "3", ",", "dilation", "=", "1", ",", "padding", "=", "1", ")", ":", "\n", "        ", "super", "(", "DRCGraphConvolution", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_features", "=", "in_features", "\n", "self", ".", "out_features", "=", "out_features", "\n", "self", ".", "kernel_size", "=", "kernel_size", "\n", "self", ".", "dilation", "=", "dilation", "\n", "self", ".", "padding", "=", "padding", "\n", "self", ".", "weight", "=", "Parameter", "(", "torch", ".", "FloatTensor", "(", "in_features", ",", "out_features", ")", ")", "\n", "if", "bias", ":", "\n", "            ", "self", ".", "bias", "=", "Parameter", "(", "torch", ".", "FloatTensor", "(", "out_features", ")", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "register_parameter", "(", "'bias'", ",", "None", ")", "\n", "", "self", ".", "dropout", "=", "nn", ".", "Dropout", "(", ")", "\n", "self", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DRCGraphConvolution.reset_parameters": [[85, 90], ["layers.DRCGraphConvolution.weight.data.uniform_", "math.sqrt", "layers.DRCGraphConvolution.bias.data.uniform_", "layers.DRCGraphConvolution.weight.size"], "methods", ["None"], ["", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "stdv", "=", "1.", "/", "math", ".", "sqrt", "(", "self", ".", "weight", ".", "size", "(", "1", ")", ")", "\n", "self", ".", "weight", ".", "data", ".", "uniform_", "(", "-", "stdv", ",", "stdv", ")", "\n", "if", "self", ".", "bias", "is", "not", "None", ":", "\n", "            ", "self", ".", "bias", ".", "data", ".", "uniform_", "(", "-", "stdv", ",", "stdv", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DRCGraphConvolution.cosine_pairwise": [[91, 99], ["x.permute.permute.permute", "torch.cosine_similarity", "torch.cosine_similarity", "torch.cosine_similarity", "cos_sim_pairwise.permute.permute.permute", "cos_sim_pairwise.permute.permute.reshape", "torch.softmax().reshape", "torch.softmax().reshape", "torch.softmax().reshape", "x.permute.permute.unsqueeze", "torch.softmax", "torch.softmax", "torch.softmax"], "methods", ["None"], ["", "", "def", "cosine_pairwise", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "x", ".", "permute", "(", "(", "1", ",", "3", ",", "0", ",", "2", ")", ")", "\n", "cos_sim_pairwise", "=", "F", ".", "cosine_similarity", "(", "x", ",", "x", ".", "unsqueeze", "(", "1", ")", ",", "dim", "=", "-", "3", ")", "\n", "cos_sim_pairwise", "=", "cos_sim_pairwise", ".", "permute", "(", "(", "2", ",", "3", ",", "0", ",", "1", ")", ")", "\n", "batch_size", ",", "seq_length", ",", "kernel_size", ",", "_", "=", "cos_sim_pairwise", ".", "shape", "\n", "adj", "=", "cos_sim_pairwise", ".", "reshape", "(", "batch_size", ",", "seq_length", ",", "-", "1", ")", "\n", "adj", "=", "F", ".", "softmax", "(", "adj", ",", "dim", "=", "1", ")", ".", "reshape", "(", "batch_size", ",", "seq_length", ",", "kernel_size", ",", "kernel_size", ")", "\n", "return", "adj", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DRCGraphConvolution.forward": [[100, 116], ["x.unsqueeze.unsqueeze.unsqueeze", "torch.unfold", "torch.unfold", "torch.unfold", "input.reshape().permute.reshape().permute.reshape().permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "support.permute.permute.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "output.squeeze.squeeze.permute().reshape", "torch.fold", "torch.fold", "torch.fold", "output.squeeze.squeeze.squeeze", "layers.DRCGraphConvolution.cosine_pairwise", "input.reshape().permute.reshape().permute.reshape", "output.squeeze.squeeze.permute"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DRCGraphConvolution.cosine_pairwise"], ["", "def", "forward", "(", "self", ",", "x", ",", "adj", "=", "None", ")", ":", "\n", "        ", "batch_size", ",", "feat_dim", ",", "L", "=", "x", ".", "shape", "\n", "x", "=", "x", ".", "unsqueeze", "(", "3", ")", "\n", "input", "=", "F", ".", "unfold", "(", "x", ",", "kernel_size", "=", "(", "self", ".", "kernel_size", ",", "1", ")", ",", "dilation", "=", "(", "self", ".", "dilation", ",", "1", ")", ",", "padding", "=", "(", "self", ".", "padding", ",", "0", ")", ")", "\n", "input", "=", "input", ".", "reshape", "(", "batch_size", ",", "feat_dim", ",", "self", ".", "kernel_size", ",", "L", ")", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "if", "adj", "is", "None", ":", "\n", "            ", "adj", "=", "self", ".", "cosine_pairwise", "(", "input", ")", "\n", "", "support", "=", "torch", ".", "matmul", "(", "input", ",", "self", ".", "weight", ")", "\n", "support", "=", "support", ".", "permute", "(", "0", ",", "2", ",", "1", ",", "3", ")", "\n", "output", "=", "torch", ".", "matmul", "(", "adj", ",", "support", ")", "\n", "if", "self", ".", "bias", "is", "not", "None", ":", "\n", "            ", "output", "=", "output", "+", "self", ".", "bias", "\n", "", "output", "=", "output", ".", "permute", "(", "0", ",", "3", ",", "2", ",", "1", ")", ".", "reshape", "(", "(", "batch_size", ",", "feat_dim", "*", "self", ".", "kernel_size", ",", "L", ")", ")", "\n", "output", "=", "F", ".", "fold", "(", "output", ",", "(", "1", ",", "L", ")", ",", "(", "self", ".", "kernel_size", ",", "1", ")", ",", "dilation", "=", "(", "self", ".", "dilation", ",", "1", ")", ",", "padding", "=", "(", "self", ".", "padding", ",", "0", ")", ")", "\n", "output", "=", "output", ".", "squeeze", "(", "2", ")", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.DRCGraphConvolution.__repr__": [[117, 121], ["str", "str"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "__class__", ".", "__name__", "+", "' ('", "+", "str", "(", "self", ".", "in_features", ")", "+", "' -> '", "+", "str", "(", "self", ".", "out_features", ")", "+", "')'", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.GCNResidualLayer.__init__": [[124, 133], ["torch.Module.__init__", "int", "layers.DRCGraphConvolution", "layers.DRCGraphConvolution", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Dropout", "torch.Dropout", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dilation", ",", "df_size", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "GCNResidualLayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "padding", "=", "int", "(", "(", "dilation", "*", "(", "df_size", "-", "1", ")", ")", "/", "2", ")", "\n", "self", ".", "df_size", "=", "df_size", "\n", "self", ".", "gcn_dilated1", "=", "DRCGraphConvolution", "(", "in_channels", ",", "out_channels", ",", "kernel_size", "=", "df_size", ",", "dilation", "=", "dilation", ",", "padding", "=", "padding", ")", "\n", "self", ".", "gcn_dilated2", "=", "DRCGraphConvolution", "(", "in_channels", ",", "out_channels", ",", "kernel_size", "=", "df_size", ",", "dilation", "=", "dilation", ",", "padding", "=", "padding", ")", "\n", "self", ".", "conv_dilated_adj", "=", "nn", ".", "Conv1d", "(", "out_channels", ",", "df_size", "*", "df_size", ",", "df_size", ",", "padding", "=", "padding", ",", "dilation", "=", "dilation", ")", "\n", "self", ".", "conv_1x1", "=", "nn", ".", "Conv1d", "(", "out_channels", ",", "out_channels", ",", "1", ")", "\n", "self", ".", "dropout", "=", "nn", ".", "Dropout", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.GCNResidualLayer.forward": [[134, 143], ["layers.GCNResidualLayer.conv_dilated_adj", "torch.softmax().permute", "torch.softmax().permute", "torch.softmax().permute", "adj.reshape.reshape.reshape", "layers.GCNResidualLayer.conv_1x1", "layers.GCNResidualLayer.dropout", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.softmax", "torch.softmax", "torch.softmax", "layers.GCNResidualLayer.gcn_dilated1", "layers.GCNResidualLayer.gcn_dilated2"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "mask", ")", ":", "\n", "        ", "batch_size", ",", "_", ",", "seq_length", "=", "x", ".", "shape", "\n", "adj", "=", "self", ".", "conv_dilated_adj", "(", "x", ")", "\n", "adj", "=", "F", ".", "softmax", "(", "adj", ",", "dim", "=", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "adj", "=", "adj", ".", "reshape", "(", "batch_size", ",", "seq_length", ",", "self", ".", "df_size", ",", "self", ".", "df_size", ")", "\n", "out", "=", "F", ".", "relu", "(", "self", ".", "gcn_dilated1", "(", "x", ")", ")", "+", "F", ".", "relu", "(", "self", ".", "gcn_dilated2", "(", "x", ",", "adj", ")", ")", "\n", "out", "=", "self", ".", "conv_1x1", "(", "out", ")", "\n", "out", "=", "self", ".", "dropout", "(", "out", ")", "\n", "return", "(", "x", "+", "out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.GCNStageModel.__init__": [[146, 152], ["torch.Module.__init__", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d", "copy.deepcopy", "layers.GCNResidualLayer", "range"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_layers", ",", "num_f_maps", ",", "df_size", ",", "dim", ",", "num_classes", ")", ":", "\n", "        ", "super", "(", "GCNStageModel", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv_1x1", "=", "nn", ".", "Conv1d", "(", "dim", ",", "num_f_maps", ",", "1", ")", "\n", "self", ".", "gcn_layers", "=", "nn", ".", "ModuleList", "(", "[", "copy", ".", "deepcopy", "(", "GCNResidualLayer", "(", "2", "**", "i", ",", "df_size", ",", "num_f_maps", ",", "num_f_maps", ")", ")", "for", "i", "in", "range", "(", "num_layers", ")", "]", ")", "\n", "self", ".", "conv_out", "=", "nn", ".", "Conv1d", "(", "num_f_maps", ",", "num_classes", ",", "1", ")", "\n", "self", ".", "exchange_out", "=", "nn", ".", "Conv1d", "(", "num_f_maps", ",", "2", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.GCNStageModel.forward": [[153, 166], ["layers.GCNStageModel.conv_1x1", "layers.GCNStageModel.conv_1x1", "layer", "layers.GCNStageModel.conv_out", "layer", "layers.GCNStageModel.exchange_out", "layers.GCNStageModel.conv_out"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "mask", ",", "ex_x", ",", "ex_label", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv_1x1", "(", "x", ")", "\n", "for", "layer", "in", "self", ".", "gcn_layers", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "mask", ")", "\n", "", "pred", "=", "self", ".", "conv_out", "(", "out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "\n", "ex_out", "=", "self", ".", "conv_1x1", "(", "ex_x", ")", "\n", "for", "layer", "in", "self", ".", "gcn_layers", ":", "\n", "            ", "ex_out", "=", "layer", "(", "ex_out", ",", "mask", ")", "\n", "", "ex_pred", "=", "self", ".", "exchange_out", "(", "ex_out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "ex_clspred", "=", "self", ".", "conv_out", "(", "ex_out", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", "\n", "\n", "return", "pred", ",", "ex_pred", ",", "ex_label", ",", "ex_clspred", "", "", "", ""]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.exchange_time": [[15, 31], ["torch.zeros().to", "torch.zeros().to", "torch.zeros().to", "int", "[].reshape", "torch.arange", "torch.arange", "torch.arange", "torch.zeros", "torch.zeros", "torch.zeros", "torch.randperm", "torch.randperm", "torch.randperm"], "function", ["None"], ["def", "exchange_time", "(", "x", ",", "exchange_rate", "=", "0.2", ")", ":", "\n", "    ", "exchange_label", "=", "torch", ".", "zeros", "(", "x", ".", "shape", "[", "0", "]", ",", "x", ".", "shape", "[", "2", "]", ",", "dtype", "=", "torch", ".", "long", ")", ".", "to", "(", "x", ".", "device", ")", "\n", "seq_length", "=", "(", "x", ".", "shape", "[", "2", "]", "//", "2", ")", "*", "2", "\n", "exchange_num", "=", "int", "(", "seq_length", "/", "2", "*", "exchange_rate", ")", "\n", "randn_pair", "=", "torch", ".", "randperm", "(", "x", ".", "shape", "[", "2", "]", ")", "[", ":", "seq_length", "]", ".", "reshape", "(", "2", ",", "-", "1", ")", "\n", "exchange_pair", "=", "randn_pair", "[", ":", ",", ":", "exchange_num", "]", "\n", "\n", "exchange_index", "=", "torch", ".", "arange", "(", "start", "=", "0", ",", "end", "=", "x", ".", "shape", "[", "2", "]", ")", "\n", "exchange_index", "[", "exchange_pair", "[", "0", "]", "]", "=", "exchange_pair", "[", "1", "]", "\n", "exchange_index", "[", "exchange_pair", "[", "1", "]", "]", "=", "exchange_pair", "[", "0", "]", "\n", "\n", "exchange_x", "=", "x", "[", ":", ",", ":", ",", "exchange_index", "]", "\n", "exchange_label", "[", ":", ",", "exchange_pair", "[", "0", "]", "]", "=", "1", "\n", "exchange_label", "[", ":", ",", "exchange_pair", "[", "1", "]", "]", "=", "1", "\n", "\n", "return", "exchange_x", ",", "exchange_label", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.__init__": [[7, 15], ["list"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "num_classes", ",", "actions_dict", ",", "gt_path", ",", "features_path", ",", "sample_rate", ")", ":", "\n", "        ", "self", ".", "list_of_examples", "=", "list", "(", ")", "\n", "self", ".", "index", "=", "0", "\n", "self", ".", "num_classes", "=", "num_classes", "\n", "self", ".", "actions_dict", "=", "actions_dict", "\n", "self", ".", "gt_path", "=", "gt_path", "\n", "self", ".", "features_path", "=", "features_path", "\n", "self", ".", "sample_rate", "=", "sample_rate", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.reset": [[16, 19], ["random.shuffle"], "methods", ["None"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "self", ".", "index", "=", "0", "\n", "random", ".", "shuffle", "(", "self", ".", "list_of_examples", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.has_next": [[20, 24], ["len"], "methods", ["None"], ["", "def", "has_next", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "index", "<", "len", "(", "self", ".", "list_of_examples", ")", ":", "\n", "            ", "return", "True", "\n", "", "return", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.read_data": [[25, 30], ["open", "open.close", "random.shuffle", "open.read().split", "open.read"], "methods", ["None"], ["", "def", "read_data", "(", "self", ",", "vid_list_file", ")", ":", "\n", "        ", "file_ptr", "=", "open", "(", "vid_list_file", ",", "'r'", ")", "\n", "self", ".", "list_of_examples", "=", "file_ptr", ".", "read", "(", ")", ".", "split", "(", "'\\n'", ")", "[", ":", "-", "1", "]", "\n", "file_ptr", ".", "close", "(", ")", "\n", "random", ".", "shuffle", "(", "self", ".", "list_of_examples", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.next_batch": [[31, 56], ["list", "torch.zeros", "torch.zeros", "range", "numpy.load", "open", "numpy.zeros", "range", "batch_input.append", "batch_target.append", "map", "len", "max", "torch.ones", "len", "max", "len", "torch.from_numpy", "torch.from_numpy", "torch.ones", "open.read().split", "min", "len", "numpy.shape", "len", "max", "len", "numpy.shape", "open.read", "numpy.shape", "vid.split", "numpy.shape", "numpy.shape", "numpy.shape"], "methods", ["None"], ["", "def", "next_batch", "(", "self", ",", "batch_size", ")", ":", "\n", "        ", "batch", "=", "self", ".", "list_of_examples", "[", "self", ".", "index", ":", "self", ".", "index", "+", "batch_size", "]", "\n", "self", ".", "index", "+=", "batch_size", "\n", "\n", "batch_input", "=", "[", "]", "\n", "batch_target", "=", "[", "]", "\n", "for", "vid", "in", "batch", ":", "\n", "            ", "features", "=", "np", ".", "load", "(", "self", ".", "features_path", "+", "vid", ".", "split", "(", "'.'", ")", "[", "0", "]", "+", "'.npy'", ")", "\n", "file_ptr", "=", "open", "(", "self", ".", "gt_path", "+", "vid", ",", "'r'", ")", "\n", "content", "=", "file_ptr", ".", "read", "(", ")", ".", "split", "(", "'\\n'", ")", "[", ":", "-", "1", "]", "\n", "classes", "=", "np", ".", "zeros", "(", "min", "(", "np", ".", "shape", "(", "features", ")", "[", "1", "]", ",", "len", "(", "content", ")", ")", ")", "\n", "for", "i", "in", "range", "(", "len", "(", "classes", ")", ")", ":", "\n", "                ", "classes", "[", "i", "]", "=", "self", ".", "actions_dict", "[", "content", "[", "i", "]", "]", "\n", "", "batch_input", ".", "append", "(", "features", "[", ":", ",", ":", ":", "self", ".", "sample_rate", "]", ")", "\n", "batch_target", ".", "append", "(", "classes", "[", ":", ":", "self", ".", "sample_rate", "]", ")", "\n", "", "length_of_sequences", "=", "list", "(", "map", "(", "len", ",", "batch_target", ")", ")", "\n", "batch_input_tensor", "=", "torch", ".", "zeros", "(", "len", "(", "batch_input", ")", ",", "np", ".", "shape", "(", "batch_input", "[", "0", "]", ")", "[", "0", "]", ",", "max", "(", "length_of_sequences", ")", ",", "dtype", "=", "torch", ".", "float", ")", "\n", "batch_target_tensor", "=", "torch", ".", "ones", "(", "len", "(", "batch_input", ")", ",", "max", "(", "length_of_sequences", ")", ",", "dtype", "=", "torch", ".", "long", ")", "*", "(", "-", "100", ")", "\n", "mask", "=", "torch", ".", "zeros", "(", "len", "(", "batch_input", ")", ",", "self", ".", "num_classes", ",", "max", "(", "length_of_sequences", ")", ",", "dtype", "=", "torch", ".", "float", ")", "\n", "for", "i", "in", "range", "(", "len", "(", "batch_input", ")", ")", ":", "\n", "            ", "batch_input_tensor", "[", "i", ",", ":", ",", ":", "np", ".", "shape", "(", "batch_input", "[", "i", "]", ")", "[", "1", "]", "]", "=", "torch", ".", "from_numpy", "(", "batch_input", "[", "i", "]", ")", "\n", "batch_target_tensor", "[", "i", ",", ":", "np", ".", "shape", "(", "batch_target", "[", "i", "]", ")", "[", "0", "]", "]", "=", "torch", ".", "from_numpy", "(", "batch_target", "[", "i", "]", ")", "\n", "mask", "[", "i", ",", ":", ",", ":", "np", ".", "shape", "(", "batch_target", "[", "i", "]", ")", "[", "0", "]", "]", "=", "torch", ".", "ones", "(", "self", ".", "num_classes", ",", "np", ".", "shape", "(", "batch_target", "[", "i", "]", ")", "[", "0", "]", ")", "\n", "\n", "", "return", "batch_input_tensor", ",", "batch_target_tensor", ",", "mask", "\n", "", "", ""]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.model.MultiStageModel.__init__": [[11, 18], ["torch.Module.__init__", "layers.SingleStageModel", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "copy.deepcopy", "layers.GCNStageModel", "range"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_stages", ",", "num_layers", ",", "num_f_maps", ",", "df_size", ",", "dim", ",", "num_classes", ",", "actions_dict", ")", ":", "\n", "        ", "super", "(", "MultiStageModel", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "actions_dict", "=", "actions_dict", "\n", "\n", "self", ".", "stage1", "=", "SingleStageModel", "(", "num_layers", ",", "num_f_maps", ",", "dim", ",", "num_classes", ")", "\n", "self", ".", "stages", "=", "nn", ".", "ModuleList", "(", "[", "copy", ".", "deepcopy", "(", "GCNStageModel", "(", "num_layers", ",", "num_f_maps", ",", "df_size", ",", "num_classes", ",", "num_classes", ")", ")", "\n", "for", "s", "in", "range", "(", "num_stages", "-", "1", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.model.MultiStageModel.forward": [[19, 40], ["layers.exchange_time", "model.MultiStageModel.stage1", "out.unsqueeze", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "s", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.stack.append", "torch.softmax", "torch.softmax", "torch.softmax", "torch.softmax", "torch.softmax", "torch.softmax", "out.unsqueeze"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.layers.exchange_time"], ["", "def", "forward", "(", "self", ",", "x", ",", "mask", ")", ":", "\n", "        ", "exchange_outputs", "=", "[", "]", "\n", "exchange_labels", "=", "[", "]", "\n", "exchange_cls_outputs", "=", "[", "]", "\n", "\n", "ex_x", ",", "ex_label", "=", "exchange_time", "(", "x", ")", "\n", "out", ",", "ex_out", ",", "ex_gt", ",", "ex_pred", "=", "self", ".", "stage1", "(", "x", ",", "mask", ",", "ex_x", ",", "ex_label", ")", "\n", "outputs", "=", "out", ".", "unsqueeze", "(", "0", ")", "\n", "exchange_outputs", ".", "append", "(", "ex_out", ")", "\n", "exchange_labels", ".", "append", "(", "ex_gt", ")", "\n", "exchange_cls_outputs", ".", "append", "(", "ex_pred", ")", "\n", "for", "s", "in", "self", ".", "stages", ":", "\n", "            ", "out", ",", "ex_out", ",", "ex_gt", ",", "ex_pred", "=", "s", "(", "F", ".", "softmax", "(", "out", ",", "dim", "=", "1", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", ",", "mask", ",", "F", ".", "softmax", "(", "ex_pred", ",", "dim", "=", "1", ")", "*", "mask", "[", ":", ",", "0", ":", "1", ",", ":", "]", ",", "ex_label", ")", "\n", "outputs", "=", "torch", ".", "cat", "(", "(", "outputs", ",", "out", ".", "unsqueeze", "(", "0", ")", ")", ",", "dim", "=", "0", ")", "\n", "exchange_outputs", ".", "append", "(", "ex_out", ")", "\n", "exchange_labels", ".", "append", "(", "ex_gt", ")", "\n", "exchange_cls_outputs", ".", "append", "(", "ex_pred", ")", "\n", "", "exchange_outputs", "=", "torch", ".", "stack", "(", "exchange_outputs", ")", "\n", "exchange_labels", "=", "torch", ".", "stack", "(", "exchange_labels", ")", "\n", "exchange_cls_outputs", "=", "torch", ".", "stack", "(", "exchange_cls_outputs", ")", "\n", "return", "outputs", ",", "exchange_outputs", ",", "exchange_labels", ",", "exchange_cls_outputs", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.__init__": [[44, 49], ["model.MultiStageModel", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.CrossEntropyLoss", "torch.MSELoss", "torch.MSELoss", "torch.MSELoss"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "num_blocks", ",", "num_layers", ",", "num_f_maps", ",", "df_size", ",", "dim", ",", "num_classes", ",", "actions_dict", ")", ":", "\n", "        ", "self", ".", "model", "=", "MultiStageModel", "(", "num_blocks", ",", "num_layers", ",", "num_f_maps", ",", "df_size", ",", "dim", ",", "num_classes", ",", "actions_dict", ")", "\n", "self", ".", "ce", "=", "nn", ".", "CrossEntropyLoss", "(", "ignore_index", "=", "-", "100", ")", "\n", "self", ".", "mse", "=", "nn", ".", "MSELoss", "(", "reduction", "=", "'none'", ")", "\n", "self", ".", "num_classes", "=", "num_classes", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.train": [[50, 89], ["model.Trainer.model.train", "model.Trainer.model.to", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "range", "model.Trainer.model.parameters", "batch_gen.has_next", "batch_gen.reset", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "print", "batch_gen.next_batch", "torch.optim.Adam.zero_grad", "model.Trainer.model", "zip", "loss.item", "loss.backward", "torch.optim.Adam.step", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "model.Trainer.model.state_dict", "torch.optim.Adam.state_dict", "batch_input.to", "batch_target.to", "mask.to", "model.Trainer.ce", "p.transpose().contiguous().view", "batch_target.view", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "model.Trainer.ce", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "model.Trainer.ce", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "str", "str", "p.transpose().contiguous().view", "batch_target.view", "pred.transpose().contiguous().view", "gt.view", "len", "float", "p.transpose().contiguous", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "model.Trainer.mse", "p.transpose().contiguous", "model.Trainer.mse", "pred.transpose().contiguous", "mask[].squeeze", "p.transpose", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "torch.log_softmax", "p.transpose", "pred.transpose", "p.detach", "p.detach"], "methods", ["home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.train", "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.has_next", "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.reset", "home.repos.pwc.inspect_result.redwang_DTGRM.None.batch_gen.BatchGenerator.next_batch"], ["", "def", "train", "(", "self", ",", "save_dir", ",", "batch_gen", ",", "num_epochs", ",", "batch_size", ",", "learning_rate", ",", "device", ")", ":", "\n", "        ", "self", ".", "model", ".", "train", "(", ")", "\n", "self", ".", "model", ".", "to", "(", "device", ")", "\n", "optimizer", "=", "optim", ".", "Adam", "(", "self", ".", "model", ".", "parameters", "(", ")", ",", "lr", "=", "learning_rate", ")", "\n", "for", "epoch", "in", "range", "(", "num_epochs", ")", ":", "\n", "            ", "epoch_loss", "=", "0", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "while", "batch_gen", ".", "has_next", "(", ")", ":", "\n", "                ", "batch_input", ",", "batch_target", ",", "mask", "=", "batch_gen", ".", "next_batch", "(", "batch_size", ")", "\n", "batch_input", ",", "batch_target", ",", "mask", "=", "batch_input", ".", "to", "(", "device", ")", ",", "batch_target", ".", "to", "(", "device", ")", ",", "mask", ".", "to", "(", "device", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "predictions", ",", "exchange_outputs", ",", "exchange_labels", ",", "exchange_cls_outputs", "=", "self", ".", "model", "(", "batch_input", ",", "mask", ")", "\n", "\n", "loss", "=", "0", "\n", "for", "p", "in", "predictions", ":", "\n", "                    ", "loss", "+=", "self", ".", "ce", "(", "p", ".", "transpose", "(", "2", ",", "1", ")", ".", "contiguous", "(", ")", ".", "view", "(", "-", "1", ",", "self", ".", "num_classes", ")", ",", "batch_target", ".", "view", "(", "-", "1", ")", ")", "\n", "loss", "+=", "0.15", "*", "torch", ".", "mean", "(", "torch", ".", "clamp", "(", "self", ".", "mse", "(", "F", ".", "log_softmax", "(", "p", "[", ":", ",", ":", ",", "1", ":", "]", ",", "dim", "=", "1", ")", ",", "F", ".", "log_softmax", "(", "p", ".", "detach", "(", ")", "[", ":", ",", ":", ",", ":", "-", "1", "]", ",", "dim", "=", "1", ")", ")", ",", "min", "=", "0", ",", "max", "=", "16", ")", "*", "mask", "[", ":", ",", ":", ",", "1", ":", "]", ")", "\n", "\n", "", "for", "p", "in", "exchange_cls_outputs", ":", "\n", "                    ", "loss", "+=", "0.5", "*", "self", ".", "ce", "(", "p", ".", "transpose", "(", "2", ",", "1", ")", ".", "contiguous", "(", ")", ".", "view", "(", "-", "1", ",", "self", ".", "num_classes", ")", ",", "batch_target", ".", "view", "(", "-", "1", ")", ")", "\n", "loss", "+=", "0.15", "*", "torch", ".", "mean", "(", "torch", ".", "clamp", "(", "self", ".", "mse", "(", "F", ".", "log_softmax", "(", "p", "[", ":", ",", ":", ",", "1", ":", "]", ",", "dim", "=", "1", ")", ",", "F", ".", "log_softmax", "(", "p", ".", "detach", "(", ")", "[", ":", ",", ":", ",", ":", "-", "1", "]", ",", "dim", "=", "1", ")", ")", ",", "min", "=", "0", ",", "max", "=", "16", ")", "*", "mask", "[", ":", ",", ":", ",", "1", ":", "]", ")", "\n", "\n", "", "for", "pred", ",", "gt", "in", "zip", "(", "exchange_outputs", ",", "exchange_labels", ")", ":", "\n", "                    ", "loss", "+=", "2", "*", "self", ".", "ce", "(", "pred", ".", "transpose", "(", "2", ",", "1", ")", ".", "contiguous", "(", ")", ".", "view", "(", "-", "1", ",", "2", ")", ",", "gt", ".", "view", "(", "-", "1", ")", ")", "\n", "\n", "", "epoch_loss", "+=", "loss", ".", "item", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "\n", "_", ",", "predicted", "=", "torch", ".", "max", "(", "predictions", "[", "-", "1", "]", ".", "data", ",", "1", ")", "\n", "correct", "+=", "(", "(", "predicted", "==", "batch_target", ")", ".", "float", "(", ")", "*", "mask", "[", ":", ",", "0", ",", ":", "]", ".", "squeeze", "(", "1", ")", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "total", "+=", "torch", ".", "sum", "(", "mask", "[", ":", ",", "0", ",", ":", "]", ")", ".", "item", "(", ")", "\n", "\n", "", "batch_gen", ".", "reset", "(", ")", "\n", "torch", ".", "save", "(", "self", ".", "model", ".", "state_dict", "(", ")", ",", "save_dir", "+", "\"/epoch-\"", "+", "str", "(", "epoch", "+", "1", ")", "+", "\".model\"", ")", "\n", "torch", ".", "save", "(", "optimizer", ".", "state_dict", "(", ")", ",", "save_dir", "+", "\"/epoch-\"", "+", "str", "(", "epoch", "+", "1", ")", "+", "\".opt\"", ")", "\n", "print", "(", "\"[epoch %d]: epoch loss = %f,   acc = %f\"", "%", "(", "epoch", "+", "1", ",", "epoch_loss", "/", "len", "(", "batch_gen", ".", "list_of_examples", ")", ",", "\n", "float", "(", "correct", ")", "/", "total", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.redwang_DTGRM.None.model.Trainer.predict": [[90, 116], ["model.Trainer.model.eval", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "model.Trainer.model.to", "model.Trainer.model.load_state_dict", "open", "open.close", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "open.read().split", "numpy.load", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "input_x.to.to.unsqueeze_", "input_x.to.to.to", "model.Trainer.model", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "predicted.squeeze.squeeze.squeeze", "range", "open", "open.write", "open.write", "open.close", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "len", "numpy.concatenate", "[].split", "open.read", "input_x.to.to.size", "str", "vid.split", "vid.split", "list", "actions_dict.keys", "list().index", "predicted[].item", "list", "actions_dict.values"], "methods", ["None"], ["", "", "def", "predict", "(", "self", ",", "model_dir", ",", "results_dir", ",", "features_path", ",", "vid_list_file", ",", "epoch", ",", "actions_dict", ",", "device", ",", "sample_rate", ")", ":", "\n", "        ", "self", ".", "model", ".", "eval", "(", ")", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "self", ".", "model", ".", "to", "(", "device", ")", "\n", "self", ".", "model", ".", "load_state_dict", "(", "torch", ".", "load", "(", "model_dir", "+", "\"/epoch-\"", "+", "str", "(", "epoch", ")", "+", "\".model\"", ")", ")", "\n", "file_ptr", "=", "open", "(", "vid_list_file", ",", "'r'", ")", "\n", "list_of_vids", "=", "file_ptr", ".", "read", "(", ")", ".", "split", "(", "'\\n'", ")", "[", ":", "-", "1", "]", "\n", "file_ptr", ".", "close", "(", ")", "\n", "for", "vid", "in", "list_of_vids", ":", "\n", "# print(vid)", "\n", "                ", "features", "=", "np", ".", "load", "(", "features_path", "+", "vid", ".", "split", "(", "'.'", ")", "[", "0", "]", "+", "'.npy'", ")", "\n", "features", "=", "features", "[", ":", ",", ":", ":", "sample_rate", "]", "\n", "input_x", "=", "torch", ".", "tensor", "(", "features", ",", "dtype", "=", "torch", ".", "float", ")", "\n", "input_x", ".", "unsqueeze_", "(", "0", ")", "\n", "input_x", "=", "input_x", ".", "to", "(", "device", ")", "\n", "predictions", ",", "_", ",", "_", ",", "_", "=", "self", ".", "model", "(", "input_x", ",", "torch", ".", "ones", "(", "input_x", ".", "size", "(", ")", ",", "device", "=", "device", ")", ")", "\n", "_", ",", "predicted", "=", "torch", ".", "max", "(", "predictions", "[", "-", "1", "]", ".", "data", ",", "1", ")", "\n", "predicted", "=", "predicted", ".", "squeeze", "(", ")", "\n", "recognition", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "predicted", ")", ")", ":", "\n", "                    ", "recognition", "=", "np", ".", "concatenate", "(", "(", "recognition", ",", "[", "list", "(", "actions_dict", ".", "keys", "(", ")", ")", "[", "list", "(", "actions_dict", ".", "values", "(", ")", ")", ".", "index", "(", "predicted", "[", "i", "]", ".", "item", "(", ")", ")", "]", "]", "*", "sample_rate", ")", ")", "\n", "", "f_name", "=", "vid", ".", "split", "(", "'/'", ")", "[", "-", "1", "]", ".", "split", "(", "'.'", ")", "[", "0", "]", "\n", "f_ptr", "=", "open", "(", "results_dir", "+", "\"/\"", "+", "f_name", ",", "\"w\"", ")", "\n", "f_ptr", ".", "write", "(", "\"### Frame level recognition: ###\\n\"", ")", "\n", "f_ptr", ".", "write", "(", "' '", ".", "join", "(", "recognition", ")", ")", "\n", "f_ptr", ".", "close", "(", ")", "\n", "", "", "", "", ""]]}