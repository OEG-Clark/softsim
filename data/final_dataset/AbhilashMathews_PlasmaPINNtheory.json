{"home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.__init__": [[64, 125], ["numpy.concatenate", "numpy.concatenate.min", "numpy.concatenate.max", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.initialize_NN", "tensorflow.Session", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.net_plasma", "tensorflow.reduce_mean", "tensorflow.reduce_mean", "tensorflow.reduce_mean", "tensorflow.reduce_mean", "tensorflow.contrib.opt.ScipyOptimizerInterface", "tensorflow.contrib.opt.ScipyOptimizerInterface", "tensorflow.contrib.opt.ScipyOptimizerInterface", "tensorflow.global_variables_initializer", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.sess.run", "tensorflow.ConfigProto", "tensorflow.square", "tensorflow.square", "tensorflow.square", "tensorflow.square", "numpy.finfo", "numpy.finfo", "numpy.finfo"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.net_plasma"], ["    ", "def", "__init__", "(", "self", ",", "x", ",", "y", ",", "t", ",", "v1", ",", "v5", ",", "layers", ")", ":", "\n", "        ", "X", "=", "np", ".", "concatenate", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", "\n", "self", ".", "lb", "=", "X", ".", "min", "(", "0", ")", "\n", "self", ".", "ub", "=", "X", ".", "max", "(", "0", ")", "\n", "self", ".", "X", "=", "X", "\n", "self", ".", "x", "=", "X", "[", ":", ",", "0", ":", "1", "]", "\n", "self", ".", "y", "=", "X", "[", ":", ",", "1", ":", "2", "]", "\n", "self", ".", "t", "=", "X", "[", ":", ",", "2", ":", "3", "]", "\n", "self", ".", "v1", "=", "v1", "\n", "self", ".", "v5", "=", "v5", "\n", "self", ".", "layers", "=", "layers", "\n", "self", ".", "current_time", "=", "0.0", "\n", "self", ".", "start_time", "=", "0.0", "\n", "self", ".", "weights_v1", ",", "self", ".", "biases_v1", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v2", ",", "self", ".", "biases_v2", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v3", ",", "self", ".", "biases_v3", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v4", ",", "self", ".", "biases_v4", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v5", ",", "self", ".", "biases_v5", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "sess", "=", "tf", ".", "Session", "(", "config", "=", "tf", ".", "ConfigProto", "(", "allow_soft_placement", "=", "False", ",", "\n", "log_device_placement", "=", "False", ",", "\n", "device_count", "=", "{", "\"CPU\"", ":", "32", "}", ",", "\n", "inter_op_parallelism_threads", "=", "1", ",", "\n", "intra_op_parallelism_threads", "=", "32", ")", ")", "\n", "self", ".", "x_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "x", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "y_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "y", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "t_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "t", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "v1_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "v1", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "v5_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "v5", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "v1_pred", ",", "self", ".", "v5_pred", ",", "self", ".", "PINN_v2_pred", ",", "self", ".", "PINN_v3_pred", ",", "self", ".", "PINN_v4_pred", ",", "self", ".", "f_v1_pred", ",", "self", ".", "f_v5_pred", "=", "self", ".", "net_plasma", "(", "self", ".", "x_tf", ",", "self", ".", "y_tf", ",", "self", ".", "t_tf", ")", "\n", "self", ".", "loss1", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_den", "*", "tf", ".", "square", "(", "self", ".", "v1_tf", "-", "self", ".", "v1_pred", ")", ")", "\n", "self", ".", "loss5", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_Te", "*", "tf", ".", "square", "(", "self", ".", "v5_tf", "-", "self", ".", "v5_pred", ")", ")", "\n", "self", ".", "lossf1", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_den", "*", "tf", ".", "square", "(", "self", ".", "f_v1_pred", ")", ")", "\n", "self", ".", "lossf5", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_Te", "*", "tf", ".", "square", "(", "self", ".", "f_v5_pred", ")", ")", "\n", "self", ".", "optimizer_v1", "=", "tf", ".", "contrib", ".", "opt", ".", "ScipyOptimizerInterface", "(", "self", ".", "loss1", ",", "\n", "method", "=", "'L-BFGS-B'", ",", "\n", "var_list", "=", "self", ".", "weights_v1", "+", "self", ".", "biases_v1", ",", "\n", "options", "=", "{", "'maxiter'", ":", "50", ",", "\n", "'maxfun'", ":", "50000", ",", "\n", "'maxcor'", ":", "50", ",", "\n", "'maxls'", ":", "50", ",", "\n", "'ftol'", ":", "1.0", "*", "np", ".", "finfo", "(", "float", ")", ".", "eps", "}", ")", "\n", "self", ".", "optimizer_v5", "=", "tf", ".", "contrib", ".", "opt", ".", "ScipyOptimizerInterface", "(", "self", ".", "loss5", ",", "\n", "method", "=", "'L-BFGS-B'", ",", "\n", "var_list", "=", "self", ".", "weights_v5", "+", "self", ".", "biases_v5", ",", "\n", "options", "=", "{", "'maxiter'", ":", "50", ",", "\n", "'maxfun'", ":", "50000", ",", "\n", "'maxcor'", ":", "50", ",", "\n", "'maxls'", ":", "50", ",", "\n", "'ftol'", ":", "1.0", "*", "np", ".", "finfo", "(", "float", ")", ".", "eps", "}", ")", "\n", "self", ".", "optimizer_f", "=", "tf", ".", "contrib", ".", "opt", ".", "ScipyOptimizerInterface", "(", "(", "self", ".", "lossf1", "+", "self", ".", "lossf5", ")", ",", "\n", "method", "=", "'L-BFGS-B'", ",", "\n", "var_list", "=", "self", ".", "weights_v2", "+", "self", ".", "biases_v2", "+", "self", ".", "weights_v3", "+", "self", ".", "biases_v3", "+", "self", ".", "weights_v4", "+", "self", ".", "biases_v4", ",", "\n", "options", "=", "{", "'maxiter'", ":", "50", ",", "\n", "'maxfun'", ":", "50000", ",", "\n", "'maxcor'", ":", "50", ",", "\n", "'maxls'", ":", "50", ",", "\n", "'ftol'", ":", "1.0", "*", "np", ".", "finfo", "(", "float", ")", ".", "eps", "}", ")", "\n", "init", "=", "tf", ".", "global_variables_initializer", "(", ")", "# Initialize Tensorflow variables", "\n", "self", ".", "sess", ".", "run", "(", "init", ")", "\n", "", "def", "initialize_NN", "(", "self", ",", "layers", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.initialize_NN": [[125, 135], ["len", "range", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.xavier_init", "tensorflow.Variable", "weights.append", "biases.append", "tensorflow.zeros"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.xavier_init"], ["", "def", "initialize_NN", "(", "self", ",", "layers", ")", ":", "\n", "        ", "weights", "=", "[", "]", "\n", "biases", "=", "[", "]", "\n", "num_layers", "=", "len", "(", "layers", ")", "\n", "for", "l", "in", "range", "(", "0", ",", "num_layers", "-", "1", ")", ":", "\n", "            ", "W", "=", "self", ".", "xavier_init", "(", "size", "=", "[", "layers", "[", "l", "]", ",", "layers", "[", "l", "+", "1", "]", "]", ")", "\n", "b", "=", "tf", ".", "Variable", "(", "tf", ".", "zeros", "(", "[", "1", ",", "layers", "[", "l", "+", "1", "]", "]", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ")", "\n", "weights", ".", "append", "(", "W", ")", "\n", "biases", ".", "append", "(", "b", ")", "\n", "", "return", "weights", ",", "biases", "\n", "", "def", "xavier_init", "(", "self", ",", "size", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.xavier_init": [[135, 140], ["numpy.sqrt", "tensorflow.Variable", "tensorflow.truncated_normal"], "methods", ["None"], ["", "def", "xavier_init", "(", "self", ",", "size", ")", ":", "\n", "        ", "in_dim", "=", "size", "[", "0", "]", "\n", "out_dim", "=", "size", "[", "1", "]", "\n", "xavier_stddev", "=", "np", ".", "sqrt", "(", "2", "/", "(", "in_dim", "+", "out_dim", ")", ")", "\n", "return", "tf", ".", "Variable", "(", "tf", ".", "truncated_normal", "(", "[", "in_dim", ",", "out_dim", "]", ",", "stddev", "=", "xavier_stddev", ")", ",", "dtype", "=", "tf", ".", "float32", ")", "\n", "", "def", "neural_net", "(", "self", ",", "X", ",", "weights", ",", "biases", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.neural_net": [[140, 155], ["max", "max", "max", "numpy.array", "range", "tensorflow.add", "len", "tensorflow.tanh", "tensorflow.matmul", "tensorflow.add", "tensorflow.matmul"], "methods", ["None"], ["", "def", "neural_net", "(", "self", ",", "X", ",", "weights", ",", "biases", ")", ":", "\n", "        ", "num_layers", "=", "len", "(", "weights", ")", "+", "1", "\n", "X_d0", "=", "max", "(", "self", ".", "ub", "[", "0", "]", "-", "self", ".", "lb", "[", "0", "]", ",", "1e-6", ")", "\n", "X_d1", "=", "max", "(", "self", ".", "ub", "[", "1", "]", "-", "self", ".", "lb", "[", "1", "]", ",", "1e-6", ")", "\n", "X_d2", "=", "max", "(", "self", ".", "ub", "[", "2", "]", "-", "self", ".", "lb", "[", "2", "]", ",", "1e-6", ")", "\n", "X_d", "=", "np", ".", "array", "(", "[", "X_d0", ",", "X_d1", ",", "X_d2", "]", ")", "\n", "H", "=", "2.0", "*", "(", "X", "-", "self", ".", "lb", ")", "/", "X_d", "-", "1.0", "\n", "for", "l", "in", "range", "(", "0", ",", "num_layers", "-", "2", ")", ":", "\n", "            ", "W", "=", "weights", "[", "l", "]", "\n", "b", "=", "biases", "[", "l", "]", "\n", "H", "=", "tf", ".", "tanh", "(", "tf", ".", "add", "(", "tf", ".", "matmul", "(", "H", ",", "W", ")", ",", "b", ")", ")", "\n", "", "W", "=", "weights", "[", "-", "1", "]", "\n", "b", "=", "biases", "[", "-", "1", "]", "\n", "Y", "=", "tf", ".", "add", "(", "tf", ".", "matmul", "(", "H", ",", "W", ")", ",", "b", ")", "\n", "return", "Y", "\n", "", "def", "net_plasma", "(", "self", ",", "x", ",", "y", ",", "t", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.net_plasma": [[155, 189], ["Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.neural_net", "tensorflow.concat", "tensorflow.concat", "tensorflow.concat", "tensorflow.concat", "tensorflow.concat", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net"], ["", "def", "net_plasma", "(", "self", ",", "x", ",", "y", ",", "t", ")", ":", "\n", "        ", "mi_me", "=", "3672.3036", "\n", "eta", "=", "67.1566", "\n", "B", "=", "(", "R_ref", ")", "/", "(", "a0", "*", "x", ")", "#has to use B_ref as norm since curvature needs to be evaluated at R0 + a0", "\n", "eps_R", "=", "0.7407", "\n", "eps_v", "=", "0.4303", "\n", "alpha_d", "=", "0.0067", "\n", "tau_T", "=", "1.0", "\n", "kappa_e", "=", "11.0176", "\n", "kappa_i", "=", "0.3134", "\n", "v1", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v1", ",", "self", ".", "biases_v1", ")", "\n", "v2", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v2", ",", "self", ".", "biases_v2", ")", "\n", "v3", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v3", ",", "self", ".", "biases_v3", ")", "\n", "v4", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v4", ",", "self", ".", "biases_v4", ")", "\n", "v5", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v5", ",", "self", ".", "biases_v5", ")", "\n", "PINN_v2", "=", "v2", "\n", "PINN_v3", "=", "v3", "\n", "PINN_v4", "=", "v4", "\n", "v1_t", "=", "tf", ".", "gradients", "(", "v1", ",", "t", ")", "[", "0", "]", "\n", "v1_x", "=", "tf", ".", "gradients", "(", "v1", ",", "x", ")", "[", "0", "]", "\n", "v1_y", "=", "tf", ".", "gradients", "(", "v1", ",", "y", ")", "[", "0", "]", "\n", "v2_x", "=", "tf", ".", "gradients", "(", "PINN_v2", ",", "x", ")", "[", "0", "]", "\n", "v2_y", "=", "tf", ".", "gradients", "(", "PINN_v2", ",", "y", ")", "[", "0", "]", "\n", "v5_t", "=", "tf", ".", "gradients", "(", "v5", ",", "t", ")", "[", "0", "]", "\n", "v5_x", "=", "tf", ".", "gradients", "(", "v5", ",", "x", ")", "[", "0", "]", "\n", "v5_y", "=", "tf", ".", "gradients", "(", "v5", ",", "y", ")", "[", "0", "]", "\n", "pe", "=", "v1", "*", "v5", "\n", "pe_y", "=", "tf", ".", "gradients", "(", "pe", ",", "y", ")", "[", "0", "]", "\n", "jp", "=", "v1", "*", "(", "(", "tau_T", "**", "0.5", ")", "*", "v4", "-", "v3", ")", "\n", "f_v1", "=", "v1_t", "+", "(", "1.", "/", "B", ")", "*", "(", "-", "v2_y", "*", "v1_x", "+", "v2_x", "*", "v1_y", ")", "-", "(", "-", "eps_R", "*", "(", "-", "v1", "*", "v2_y", "+", "alpha_d", "*", "pe_y", ")", ")", "\n", "f_v5", "=", "v5_t", "+", "(", "1.", "/", "B", ")", "*", "(", "-", "v2_y", "*", "v5_x", "+", "v2_x", "*", "v5_y", ")", "-", "v5", "*", "(", "-", "5.", "*", "eps_R", "*", "alpha_d", "*", "v5_y", "/", "3.", "+", "(", "2.", "/", "3.", ")", "*", "(", "-", "eps_R", "*", "(", "-", "v2_y", "+", "alpha_d", "*", "pe_y", "/", "v1", ")", "+", "(", "1.", "/", "v1", ")", "*", "(", "0.71", "*", "eps_v", "*", "(", "0.0", ")", "+", "eta", "*", "jp", "*", "jp", "/", "(", "v5", "*", "mi_me", ")", ")", ")", ")", "\n", "return", "v1", ",", "v5", ",", "PINN_v2", ",", "PINN_v3", ",", "PINN_v4", ",", "f_v1", ",", "f_v5", "\n", "", "def", "callback", "(", "self", ",", "loss1", ",", "loss5", ",", "lossf1", ",", "lossf5", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.callback": [[189, 193], ["print", "str"], "methods", ["None"], ["", "def", "callback", "(", "self", ",", "loss1", ",", "loss5", ",", "lossf1", ",", "lossf5", ")", ":", "\n", "        ", "global", "Nfeval", "\n", "print", "(", "str", "(", "Nfeval", ")", "+", "' - PDE loss in loop: %.3e, %.3e, %.3e, %.3e'", "%", "(", "loss1", ",", "loss5", ",", "lossf1", ",", "lossf5", ")", ")", "\n", "Nfeval", "+=", "1", "\n", "", "def", "fetch_minibatch", "(", "self", ",", "x_in", ",", "y_in", ",", "t_in", ",", "den_in", ",", "Te_in", ",", "N_train_sample", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.fetch_minibatch": [[193, 201], ["numpy.random.choice", "len"], "methods", ["None"], ["", "def", "fetch_minibatch", "(", "self", ",", "x_in", ",", "y_in", ",", "t_in", ",", "den_in", ",", "Te_in", ",", "N_train_sample", ")", ":", "\n", "        ", "idx_batch", "=", "np", ".", "random", ".", "choice", "(", "len", "(", "x_in", ")", ",", "N_train_sample", ",", "replace", "=", "False", ")", "\n", "x_batch", "=", "x_in", "[", "idx_batch", ",", ":", "]", "\n", "y_batch", "=", "y_in", "[", "idx_batch", ",", ":", "]", "\n", "t_batch", "=", "t_in", "[", "idx_batch", ",", ":", "]", "\n", "v1_batch", "=", "den_in", "[", "idx_batch", ",", ":", "]", "\n", "v5_batch", "=", "Te_in", "[", "idx_batch", ",", ":", "]", "\n", "return", "x_batch", ",", "y_batch", ",", "t_batch", ",", "v1_batch", ",", "v5_batch", "\n", "", "def", "train", "(", "self", ",", "timelen_end", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.train": [[201, 226], ["time.time", "print", "time.time", "print", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.fetch_minibatch", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.optimizer_v1.minimize", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.optimizer_v5.minimize", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.optimizer_f.minimize", "time.time", "str"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.fetch_minibatch"], ["", "def", "train", "(", "self", ",", "timelen_end", ")", ":", "\n", "        ", "self", ".", "start_time", "=", "time", ".", "time", "(", ")", "\n", "self", ".", "current_time", "=", "time", ".", "time", "(", ")", "-", "self", ".", "start_time", "\n", "try", ":", "\n", "            ", "it", "=", "0", "\n", "while", "self", ".", "current_time", "<", "timelen_end", ":", "\n", "                ", "it", "=", "it", "+", "1", "\n", "print", "(", "'Full iteration: '", "+", "str", "(", "it", ")", ")", "\n", "x_res_batch", ",", "y_res_batch", ",", "t_res_batch", ",", "v1_res_batch", ",", "v5_res_batch", "=", "self", ".", "fetch_minibatch", "(", "self", ".", "x", ",", "self", ".", "y", ",", "self", ".", "t", ",", "self", ".", "v1", ",", "self", ".", "v5", ",", "sample_batch_size", ")", "# Fetch residual mini-batch", "\n", "tf_dict", "=", "{", "self", ".", "x_tf", ":", "x_res_batch", ",", "self", ".", "y_tf", ":", "y_res_batch", ",", "self", ".", "t_tf", ":", "t_res_batch", ",", "\n", "self", ".", "v1_tf", ":", "v1_res_batch", ",", "self", ".", "v5_tf", ":", "v5_res_batch", "}", "\n", "self", ".", "optimizer_v1", ".", "minimize", "(", "self", ".", "sess", ",", "\n", "feed_dict", "=", "tf_dict", ",", "\n", "fetches", "=", "[", "self", ".", "loss1", "]", ")", "\n", "self", ".", "optimizer_v5", ".", "minimize", "(", "self", ".", "sess", ",", "\n", "feed_dict", "=", "tf_dict", ",", "\n", "fetches", "=", "[", "self", ".", "loss5", "]", ")", "\n", "self", ".", "optimizer_f", ".", "minimize", "(", "self", ".", "sess", ",", "\n", "feed_dict", "=", "tf_dict", ",", "\n", "fetches", "=", "[", "self", ".", "loss1", ",", "self", ".", "loss5", ",", "self", ".", "lossf1", ",", "self", ".", "lossf5", "]", ",", "\n", "loss_callback", "=", "self", ".", "callback", ")", "\n", "self", ".", "current_time", "=", "time", ".", "time", "(", ")", "-", "self", ".", "start_time", "\n", "", "", "except", "KeyboardInterrupt", ":", "\n", "            ", "raise", "\n", "", "print", "(", "'Finishing up training'", ")", "\n", "", "def", "predict", "(", "self", ",", "x_star", ",", "y_star", ",", "t_star", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.predict": [[226, 234], ["Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_high_beta.PhysicsInformedNN.sess.run"], "methods", ["None"], ["", "def", "predict", "(", "self", ",", "x_star", ",", "y_star", ",", "t_star", ")", ":", "\n", "        ", "tf_dict", "=", "{", "self", ".", "x_tf", ":", "x_star", ",", "self", ".", "y_tf", ":", "y_star", ",", "self", ".", "t_tf", ":", "t_star", "}", "\n", "v1_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "v1_pred", ",", "tf_dict", ")", "\n", "v5_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "v5_pred", ",", "tf_dict", ")", "\n", "PINN_v2_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "PINN_v2_pred", ",", "tf_dict", ")", "\n", "PINN_v3_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "PINN_v3_pred", ",", "tf_dict", ")", "\n", "PINN_v4_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "PINN_v4_pred", ",", "tf_dict", ")", "\n", "return", "v1_star", ",", "v5_star", ",", "PINN_v2_star", ",", "PINN_v3_star", ",", "PINN_v4_star", "\n", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_high_beta.grid": [[262, 268], ["numpy.meshgrid", "scipy.interpolate.griddata"], "function", ["None"], ["def", "grid", "(", "x", ",", "y", ",", "z", ",", "input_x", ",", "input_y", ")", ":", "\n", "    ", "xi", "=", "input_x", "\n", "yi", "=", "input_y", "\n", "X", ",", "Y", "=", "np", ".", "meshgrid", "(", "xi", ",", "yi", ")", "\n", "Z", "=", "griddata", "(", "(", "x", ",", "y", ")", ",", "z", ",", "(", "X", ",", "Y", ")", ",", "method", "=", "'cubic'", ")", "\n", "return", "X", ",", "Y", ",", "Z", "\n", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_plots_manuscript.grid": [[736, 742], ["numpy.meshgrid", "scipy.interpolate.griddata"], "function", ["None"], ["def", "grid", "(", "x", ",", "y", ",", "z", ",", "input_x", ",", "input_y", ")", ":", "\n", "    ", "xi", "=", "input_x", "\n", "yi", "=", "input_y", "\n", "X", ",", "Y", "=", "np", ".", "meshgrid", "(", "xi", ",", "yi", ")", "\n", "Z", "=", "griddata", "(", "(", "x", ",", "y", ")", ",", "z", ",", "(", "X", ",", "Y", ")", ",", "method", "=", "'cubic'", ")", "\n", "return", "X", ",", "Y", ",", "Z", "\n", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.__init__": [[64, 125], ["numpy.concatenate", "numpy.concatenate.min", "numpy.concatenate.max", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "tensorflow.Session", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.net_plasma", "tensorflow.reduce_mean", "tensorflow.reduce_mean", "tensorflow.reduce_mean", "tensorflow.reduce_mean", "tensorflow.contrib.opt.ScipyOptimizerInterface", "tensorflow.contrib.opt.ScipyOptimizerInterface", "tensorflow.contrib.opt.ScipyOptimizerInterface", "tensorflow.global_variables_initializer", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.sess.run", "tensorflow.ConfigProto", "tensorflow.square", "tensorflow.square", "tensorflow.square", "tensorflow.square", "numpy.finfo", "numpy.finfo", "numpy.finfo"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.net_plasma"], ["    ", "def", "__init__", "(", "self", ",", "x", ",", "y", ",", "t", ",", "v1", ",", "v5", ",", "layers", ")", ":", "\n", "        ", "X", "=", "np", ".", "concatenate", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", "\n", "self", ".", "lb", "=", "X", ".", "min", "(", "0", ")", "\n", "self", ".", "ub", "=", "X", ".", "max", "(", "0", ")", "\n", "self", ".", "X", "=", "X", "\n", "self", ".", "x", "=", "X", "[", ":", ",", "0", ":", "1", "]", "\n", "self", ".", "y", "=", "X", "[", ":", ",", "1", ":", "2", "]", "\n", "self", ".", "t", "=", "X", "[", ":", ",", "2", ":", "3", "]", "\n", "self", ".", "v1", "=", "v1", "\n", "self", ".", "v5", "=", "v5", "\n", "self", ".", "layers", "=", "layers", "\n", "self", ".", "current_time", "=", "0.0", "\n", "self", ".", "start_time", "=", "0.0", "\n", "self", ".", "weights_v1", ",", "self", ".", "biases_v1", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v2", ",", "self", ".", "biases_v2", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v3", ",", "self", ".", "biases_v3", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v4", ",", "self", ".", "biases_v4", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "weights_v5", ",", "self", ".", "biases_v5", "=", "self", ".", "initialize_NN", "(", "layers", ")", "\n", "self", ".", "sess", "=", "tf", ".", "Session", "(", "config", "=", "tf", ".", "ConfigProto", "(", "allow_soft_placement", "=", "False", ",", "\n", "log_device_placement", "=", "False", ",", "\n", "device_count", "=", "{", "\"CPU\"", ":", "32", "}", ",", "\n", "inter_op_parallelism_threads", "=", "1", ",", "\n", "intra_op_parallelism_threads", "=", "32", ")", ")", "\n", "self", ".", "x_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "x", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "y_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "y", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "t_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "t", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "v1_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "v1", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "v5_tf", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "shape", "=", "[", "None", ",", "self", ".", "v5", ".", "shape", "[", "1", "]", "]", ")", "\n", "self", ".", "v1_pred", ",", "self", ".", "v5_pred", ",", "self", ".", "PINN_v2_pred", ",", "self", ".", "PINN_v3_pred", ",", "self", ".", "PINN_v4_pred", ",", "self", ".", "f_v1_pred", ",", "self", ".", "f_v5_pred", "=", "self", ".", "net_plasma", "(", "self", ".", "x_tf", ",", "self", ".", "y_tf", ",", "self", ".", "t_tf", ")", "\n", "self", ".", "loss1", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_den", "*", "tf", ".", "square", "(", "self", ".", "v1_tf", "-", "self", ".", "v1_pred", ")", ")", "\n", "self", ".", "loss5", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_Te", "*", "tf", ".", "square", "(", "self", ".", "v5_tf", "-", "self", ".", "v5_pred", ")", ")", "\n", "self", ".", "lossf1", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_den", "*", "tf", ".", "square", "(", "self", ".", "f_v1_pred", ")", ")", "\n", "self", ".", "lossf5", "=", "tf", ".", "reduce_mean", "(", "1.0", "*", "init_weight_Te", "*", "tf", ".", "square", "(", "self", ".", "f_v5_pred", ")", ")", "\n", "self", ".", "optimizer_v1", "=", "tf", ".", "contrib", ".", "opt", ".", "ScipyOptimizerInterface", "(", "self", ".", "loss1", ",", "\n", "method", "=", "'L-BFGS-B'", ",", "\n", "var_list", "=", "self", ".", "weights_v1", "+", "self", ".", "biases_v1", ",", "\n", "options", "=", "{", "'maxiter'", ":", "50", ",", "\n", "'maxfun'", ":", "50000", ",", "\n", "'maxcor'", ":", "50", ",", "\n", "'maxls'", ":", "50", ",", "\n", "'ftol'", ":", "1.0", "*", "np", ".", "finfo", "(", "float", ")", ".", "eps", "}", ")", "\n", "self", ".", "optimizer_v5", "=", "tf", ".", "contrib", ".", "opt", ".", "ScipyOptimizerInterface", "(", "self", ".", "loss5", ",", "\n", "method", "=", "'L-BFGS-B'", ",", "\n", "var_list", "=", "self", ".", "weights_v5", "+", "self", ".", "biases_v5", ",", "\n", "options", "=", "{", "'maxiter'", ":", "50", ",", "\n", "'maxfun'", ":", "50000", ",", "\n", "'maxcor'", ":", "50", ",", "\n", "'maxls'", ":", "50", ",", "\n", "'ftol'", ":", "1.0", "*", "np", ".", "finfo", "(", "float", ")", ".", "eps", "}", ")", "\n", "self", ".", "optimizer_f", "=", "tf", ".", "contrib", ".", "opt", ".", "ScipyOptimizerInterface", "(", "(", "self", ".", "lossf1", "+", "self", ".", "lossf5", ")", ",", "\n", "method", "=", "'L-BFGS-B'", ",", "\n", "var_list", "=", "self", ".", "weights_v2", "+", "self", ".", "biases_v2", "+", "self", ".", "weights_v3", "+", "self", ".", "biases_v3", "+", "self", ".", "weights_v4", "+", "self", ".", "biases_v4", ",", "\n", "options", "=", "{", "'maxiter'", ":", "50", ",", "\n", "'maxfun'", ":", "50000", ",", "\n", "'maxcor'", ":", "50", ",", "\n", "'maxls'", ":", "50", ",", "\n", "'ftol'", ":", "1.0", "*", "np", ".", "finfo", "(", "float", ")", ".", "eps", "}", ")", "\n", "init", "=", "tf", ".", "global_variables_initializer", "(", ")", "# Initialize Tensorflow variables", "\n", "self", ".", "sess", ".", "run", "(", "init", ")", "\n", "", "def", "initialize_NN", "(", "self", ",", "layers", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.initialize_NN": [[125, 135], ["len", "range", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.xavier_init", "tensorflow.Variable", "weights.append", "biases.append", "tensorflow.zeros"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.xavier_init"], ["", "def", "initialize_NN", "(", "self", ",", "layers", ")", ":", "\n", "        ", "weights", "=", "[", "]", "\n", "biases", "=", "[", "]", "\n", "num_layers", "=", "len", "(", "layers", ")", "\n", "for", "l", "in", "range", "(", "0", ",", "num_layers", "-", "1", ")", ":", "\n", "            ", "W", "=", "self", ".", "xavier_init", "(", "size", "=", "[", "layers", "[", "l", "]", ",", "layers", "[", "l", "+", "1", "]", "]", ")", "\n", "b", "=", "tf", ".", "Variable", "(", "tf", ".", "zeros", "(", "[", "1", ",", "layers", "[", "l", "+", "1", "]", "]", ",", "dtype", "=", "tf", ".", "float32", ")", ",", "dtype", "=", "tf", ".", "float32", ")", "\n", "weights", ".", "append", "(", "W", ")", "\n", "biases", ".", "append", "(", "b", ")", "\n", "", "return", "weights", ",", "biases", "\n", "", "def", "xavier_init", "(", "self", ",", "size", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.xavier_init": [[135, 140], ["numpy.sqrt", "tensorflow.Variable", "tensorflow.truncated_normal"], "methods", ["None"], ["", "def", "xavier_init", "(", "self", ",", "size", ")", ":", "\n", "        ", "in_dim", "=", "size", "[", "0", "]", "\n", "out_dim", "=", "size", "[", "1", "]", "\n", "xavier_stddev", "=", "np", ".", "sqrt", "(", "2", "/", "(", "in_dim", "+", "out_dim", ")", ")", "\n", "return", "tf", ".", "Variable", "(", "tf", ".", "truncated_normal", "(", "[", "in_dim", ",", "out_dim", "]", ",", "stddev", "=", "xavier_stddev", ")", ",", "dtype", "=", "tf", ".", "float32", ")", "\n", "", "def", "neural_net", "(", "self", ",", "X", ",", "weights", ",", "biases", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net": [[140, 155], ["max", "max", "max", "numpy.array", "range", "tensorflow.add", "len", "tensorflow.tanh", "tensorflow.matmul", "tensorflow.add", "tensorflow.matmul"], "methods", ["None"], ["", "def", "neural_net", "(", "self", ",", "X", ",", "weights", ",", "biases", ")", ":", "\n", "        ", "num_layers", "=", "len", "(", "weights", ")", "+", "1", "\n", "X_d0", "=", "max", "(", "self", ".", "ub", "[", "0", "]", "-", "self", ".", "lb", "[", "0", "]", ",", "1e-6", ")", "\n", "X_d1", "=", "max", "(", "self", ".", "ub", "[", "1", "]", "-", "self", ".", "lb", "[", "1", "]", ",", "1e-6", ")", "\n", "X_d2", "=", "max", "(", "self", ".", "ub", "[", "2", "]", "-", "self", ".", "lb", "[", "2", "]", ",", "1e-6", ")", "\n", "X_d", "=", "np", ".", "array", "(", "[", "X_d0", ",", "X_d1", ",", "X_d2", "]", ")", "\n", "H", "=", "2.0", "*", "(", "X", "-", "self", ".", "lb", ")", "/", "X_d", "-", "1.0", "\n", "for", "l", "in", "range", "(", "0", ",", "num_layers", "-", "2", ")", ":", "\n", "            ", "W", "=", "weights", "[", "l", "]", "\n", "b", "=", "biases", "[", "l", "]", "\n", "H", "=", "tf", ".", "tanh", "(", "tf", ".", "add", "(", "tf", ".", "matmul", "(", "H", ",", "W", ")", ",", "b", ")", ")", "\n", "", "W", "=", "weights", "[", "-", "1", "]", "\n", "b", "=", "biases", "[", "-", "1", "]", "\n", "Y", "=", "tf", ".", "add", "(", "tf", ".", "matmul", "(", "H", ",", "W", ")", ",", "b", ")", "\n", "return", "Y", "\n", "", "def", "net_plasma", "(", "self", ",", "x", ",", "y", ",", "t", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.net_plasma": [[155, 189], ["Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "tensorflow.concat", "tensorflow.concat", "tensorflow.concat", "tensorflow.concat", "tensorflow.concat", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients", "tensorflow.gradients"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net", "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.neural_net"], ["", "def", "net_plasma", "(", "self", ",", "x", ",", "y", ",", "t", ")", ":", "\n", "        ", "mi_me", "=", "3672.3036", "\n", "eta", "=", "7.3437", "\n", "B", "=", "(", "R_ref", ")", "/", "(", "a0", "*", "x", ")", "#has to use B_ref as norm since curvature needs to be evaluated at R0 + a0", "\n", "eps_R", "=", "0.7407", "\n", "eps_v", "=", "0.4303", "\n", "alpha_d", "=", "0.0067", "\n", "tau_T", "=", "1.0", "\n", "kappa_e", "=", "100.7538", "\n", "kappa_i", "=", "2.8656", "\n", "v1", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v1", ",", "self", ".", "biases_v1", ")", "\n", "v2", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v2", ",", "self", ".", "biases_v2", ")", "\n", "v3", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v3", ",", "self", ".", "biases_v3", ")", "\n", "v4", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v4", ",", "self", ".", "biases_v4", ")", "\n", "v5", "=", "self", ".", "neural_net", "(", "tf", ".", "concat", "(", "[", "x", ",", "y", ",", "t", "]", ",", "1", ")", ",", "self", ".", "weights_v5", ",", "self", ".", "biases_v5", ")", "\n", "PINN_v2", "=", "v2", "\n", "PINN_v3", "=", "v3", "\n", "PINN_v4", "=", "v4", "\n", "v1_t", "=", "tf", ".", "gradients", "(", "v1", ",", "t", ")", "[", "0", "]", "\n", "v1_x", "=", "tf", ".", "gradients", "(", "v1", ",", "x", ")", "[", "0", "]", "\n", "v1_y", "=", "tf", ".", "gradients", "(", "v1", ",", "y", ")", "[", "0", "]", "\n", "v2_x", "=", "tf", ".", "gradients", "(", "PINN_v2", ",", "x", ")", "[", "0", "]", "\n", "v2_y", "=", "tf", ".", "gradients", "(", "PINN_v2", ",", "y", ")", "[", "0", "]", "\n", "v5_t", "=", "tf", ".", "gradients", "(", "v5", ",", "t", ")", "[", "0", "]", "\n", "v5_x", "=", "tf", ".", "gradients", "(", "v5", ",", "x", ")", "[", "0", "]", "\n", "v5_y", "=", "tf", ".", "gradients", "(", "v5", ",", "y", ")", "[", "0", "]", "\n", "pe", "=", "v1", "*", "v5", "\n", "pe_y", "=", "tf", ".", "gradients", "(", "pe", ",", "y", ")", "[", "0", "]", "\n", "jp", "=", "v1", "*", "(", "(", "tau_T", "**", "0.5", ")", "*", "v4", "-", "v3", ")", "\n", "f_v1", "=", "v1_t", "+", "(", "1.", "/", "B", ")", "*", "(", "-", "v2_y", "*", "v1_x", "+", "v2_x", "*", "v1_y", ")", "-", "(", "-", "eps_R", "*", "(", "-", "v1", "*", "v2_y", "+", "alpha_d", "*", "pe_y", ")", ")", "\n", "f_v5", "=", "v5_t", "+", "(", "1.", "/", "B", ")", "*", "(", "-", "v2_y", "*", "v5_x", "+", "v2_x", "*", "v5_y", ")", "-", "v5", "*", "(", "-", "5.", "*", "eps_R", "*", "alpha_d", "*", "v5_y", "/", "3.", "+", "(", "2.", "/", "3.", ")", "*", "(", "-", "eps_R", "*", "(", "-", "v2_y", "+", "alpha_d", "*", "pe_y", "/", "v1", ")", "+", "(", "1.", "/", "v1", ")", "*", "(", "0.71", "*", "eps_v", "*", "(", "0.0", ")", "+", "eta", "*", "jp", "*", "jp", "/", "(", "v5", "*", "mi_me", ")", ")", ")", ")", "\n", "return", "v1", ",", "v5", ",", "PINN_v2", ",", "PINN_v3", ",", "PINN_v4", ",", "f_v1", ",", "f_v5", "\n", "", "def", "callback", "(", "self", ",", "loss1", ",", "loss5", ",", "lossf1", ",", "lossf5", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.callback": [[189, 193], ["print", "str"], "methods", ["None"], ["", "def", "callback", "(", "self", ",", "loss1", ",", "loss5", ",", "lossf1", ",", "lossf5", ")", ":", "\n", "        ", "global", "Nfeval", "\n", "print", "(", "str", "(", "Nfeval", ")", "+", "' - PDE loss in loop: %.3e, %.3e, %.3e, %.3e'", "%", "(", "loss1", ",", "loss5", ",", "lossf1", ",", "lossf5", ")", ")", "\n", "Nfeval", "+=", "1", "\n", "", "def", "fetch_minibatch", "(", "self", ",", "x_in", ",", "y_in", ",", "t_in", ",", "den_in", ",", "Te_in", ",", "N_train_sample", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.fetch_minibatch": [[193, 201], ["numpy.random.choice", "len"], "methods", ["None"], ["", "def", "fetch_minibatch", "(", "self", ",", "x_in", ",", "y_in", ",", "t_in", ",", "den_in", ",", "Te_in", ",", "N_train_sample", ")", ":", "\n", "        ", "idx_batch", "=", "np", ".", "random", ".", "choice", "(", "len", "(", "x_in", ")", ",", "N_train_sample", ",", "replace", "=", "False", ")", "\n", "x_batch", "=", "x_in", "[", "idx_batch", ",", ":", "]", "\n", "y_batch", "=", "y_in", "[", "idx_batch", ",", ":", "]", "\n", "t_batch", "=", "t_in", "[", "idx_batch", ",", ":", "]", "\n", "v1_batch", "=", "den_in", "[", "idx_batch", ",", ":", "]", "\n", "v5_batch", "=", "Te_in", "[", "idx_batch", ",", ":", "]", "\n", "return", "x_batch", ",", "y_batch", ",", "t_batch", ",", "v1_batch", ",", "v5_batch", "\n", "", "def", "train", "(", "self", ",", "timelen_end", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.train": [[201, 226], ["time.time", "print", "time.time", "print", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.fetch_minibatch", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.optimizer_v1.minimize", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.optimizer_v5.minimize", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.optimizer_f.minimize", "time.time", "str"], "methods", ["home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.fetch_minibatch"], ["", "def", "train", "(", "self", ",", "timelen_end", ")", ":", "\n", "        ", "self", ".", "start_time", "=", "time", ".", "time", "(", ")", "\n", "self", ".", "current_time", "=", "time", ".", "time", "(", ")", "-", "self", ".", "start_time", "\n", "try", ":", "\n", "            ", "it", "=", "0", "\n", "while", "self", ".", "current_time", "<", "timelen_end", ":", "\n", "                ", "it", "=", "it", "+", "1", "\n", "print", "(", "'Full iteration: '", "+", "str", "(", "it", ")", ")", "\n", "x_res_batch", ",", "y_res_batch", ",", "t_res_batch", ",", "v1_res_batch", ",", "v5_res_batch", "=", "self", ".", "fetch_minibatch", "(", "self", ".", "x", ",", "self", ".", "y", ",", "self", ".", "t", ",", "self", ".", "v1", ",", "self", ".", "v5", ",", "sample_batch_size", ")", "# Fetch residual mini-batch", "\n", "tf_dict", "=", "{", "self", ".", "x_tf", ":", "x_res_batch", ",", "self", ".", "y_tf", ":", "y_res_batch", ",", "self", ".", "t_tf", ":", "t_res_batch", ",", "\n", "self", ".", "v1_tf", ":", "v1_res_batch", ",", "self", ".", "v5_tf", ":", "v5_res_batch", "}", "\n", "self", ".", "optimizer_v1", ".", "minimize", "(", "self", ".", "sess", ",", "\n", "feed_dict", "=", "tf_dict", ",", "\n", "fetches", "=", "[", "self", ".", "loss1", "]", ")", "\n", "self", ".", "optimizer_v5", ".", "minimize", "(", "self", ".", "sess", ",", "\n", "feed_dict", "=", "tf_dict", ",", "\n", "fetches", "=", "[", "self", ".", "loss5", "]", ")", "\n", "self", ".", "optimizer_f", ".", "minimize", "(", "self", ".", "sess", ",", "\n", "feed_dict", "=", "tf_dict", ",", "\n", "fetches", "=", "[", "self", ".", "loss1", ",", "self", ".", "loss5", ",", "self", ".", "lossf1", ",", "self", ".", "lossf5", "]", ",", "\n", "loss_callback", "=", "self", ".", "callback", ")", "\n", "self", ".", "current_time", "=", "time", ".", "time", "(", ")", "-", "self", ".", "start_time", "\n", "", "", "except", "KeyboardInterrupt", ":", "\n", "            ", "raise", "\n", "", "print", "(", "'Finishing up training'", ")", "\n", "", "def", "predict", "(", "self", ",", "x_star", ",", "y_star", ",", "t_star", ")", ":", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.predict": [[226, 234], ["Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.sess.run", "Plasma-PINN_DRBvGK_low_beta.PhysicsInformedNN.sess.run"], "methods", ["None"], ["", "def", "predict", "(", "self", ",", "x_star", ",", "y_star", ",", "t_star", ")", ":", "\n", "        ", "tf_dict", "=", "{", "self", ".", "x_tf", ":", "x_star", ",", "self", ".", "y_tf", ":", "y_star", ",", "self", ".", "t_tf", ":", "t_star", "}", "\n", "v1_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "v1_pred", ",", "tf_dict", ")", "\n", "v5_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "v5_pred", ",", "tf_dict", ")", "\n", "PINN_v2_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "PINN_v2_pred", ",", "tf_dict", ")", "\n", "PINN_v3_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "PINN_v3_pred", ",", "tf_dict", ")", "\n", "PINN_v4_star", "=", "self", ".", "sess", ".", "run", "(", "self", ".", "PINN_v4_pred", ",", "tf_dict", ")", "\n", "return", "v1_star", ",", "v5_star", ",", "PINN_v2_star", ",", "PINN_v3_star", ",", "PINN_v4_star", "\n", "\n"]], "home.repos.pwc.inspect_result.AbhilashMathews_PlasmaPINNtheory.None.Plasma-PINN_DRBvGK_low_beta.grid": [[262, 268], ["numpy.meshgrid", "scipy.interpolate.griddata"], "function", ["None"], ["def", "grid", "(", "x", ",", "y", ",", "z", ",", "input_x", ",", "input_y", ")", ":", "\n", "    ", "xi", "=", "input_x", "\n", "yi", "=", "input_y", "\n", "X", ",", "Y", "=", "np", ".", "meshgrid", "(", "xi", ",", "yi", ")", "\n", "Z", "=", "griddata", "(", "(", "x", ",", "y", ")", ",", "z", ",", "(", "X", ",", "Y", ")", ",", "method", "=", "'cubic'", ")", "\n", "return", "X", ",", "Y", ",", "Z", "\n", "\n"]]}