{"home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent.__init__": [[12, 23], ["collections.deque", "DQN.DQNAgent._build_model", "DQN.DQNAgent._build_model"], "methods", ["home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent._build_model", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent._build_model"], ["    ", "def", "__init__", "(", "self", ",", "state_size", ",", "action_size", ")", ":", "\n", "        ", "self", ".", "state_size", "=", "state_size", "\n", "self", ".", "action_size", "=", "action_size", "\n", "self", ".", "memory", "=", "deque", "(", "maxlen", "=", "10000", ")", "\n", "self", ".", "gamma", "=", "0.95", "# discount rate", "\n", "self", ".", "epsilon", "=", "1.0", "# exploration rate", "\n", "self", ".", "epsilon_min", "=", "0.01", "\n", "self", ".", "epsilon_decay", "=", "0.999", "\n", "self", ".", "learning_rate", "=", "0.001", "\n", "self", ".", "model", "=", "self", ".", "_build_model", "(", ")", "\n", "self", ".", "target_model", "=", "self", ".", "_build_model", "(", ")", "\n", "#", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent._build_model": [[24, 56], ["tensorflow.keras.Input", "tensorflow.keras.Input", "tensorflow.keras.activations.swish", "range", "tensorflow.keras.activations.swish", "tensorflow.keras.Model", "tensorflow.keras.activations.swish", "range", "tensorflow.keras.activations.swish", "tensorflow.keras.Model", "tensorflow.keras.activations.swish", "tensorflow.keras.Model", "tensorflow.keras.Model.compile", "tensorflow.keras.layers.Flatten", "tensorflow.keras.layers.Dense", "tensorflow.keras.activations.swish", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Flatten", "tensorflow.keras.layers.Dense", "tensorflow.keras.activations.swish", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Concatenate", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Add", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Dense", "tensorflow.keras.layers.Add"], "methods", ["None"], ["", "def", "_build_model", "(", "self", ")", ":", "\n", "        ", "inputA", "=", "tf", ".", "keras", ".", "Input", "(", "shape", "=", "self", ".", "state_size", "[", "0", "]", ",", "name", "=", "\"InputA\"", ")", "\n", "inputB", "=", "tf", ".", "keras", ".", "Input", "(", "shape", "=", "self", ".", "state_size", "[", "1", "]", ",", "name", "=", "\"InputB\"", ")", "\n", "x_A", "=", "Flatten", "(", ")", "(", "inputA", ")", "\n", "x_con", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_A", ")", "\n", "x_temp_A", "=", "tf", ".", "keras", ".", "activations", ".", "swish", "(", "x_con", ")", "\n", "for", "iRes", "in", "range", "(", "3", ")", ":", "\n", "            ", "x_con", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_temp_A", ")", "\n", "x_con", "=", "tf", ".", "keras", ".", "activations", ".", "swish", "(", "x_con", ")", "\n", "x_con", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_con", ")", "\n", "x_temp_A", "=", "tf", ".", "keras", ".", "layers", ".", "Add", "(", ")", "(", "[", "x_temp_A", ",", "x_con", "]", ")", "\n", "", "x_A", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_temp_A", ")", "\n", "x_A", "=", "tf", ".", "keras", ".", "activations", ".", "swish", "(", "x_A", ")", "\n", "ModelX", "=", "tf", ".", "keras", ".", "Model", "(", "inputs", "=", "inputA", ",", "outputs", "=", "x_A", ")", "\n", "x_B", "=", "Flatten", "(", ")", "(", "inputB", ")", "\n", "x_con", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_B", ")", "\n", "x_temp_B", "=", "tf", ".", "keras", ".", "activations", ".", "swish", "(", "x_con", ")", "\n", "for", "iRes", "in", "range", "(", "3", ")", ":", "\n", "            ", "x_con", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_temp_B", ")", "\n", "x_con", "=", "tf", ".", "keras", ".", "activations", ".", "swish", "(", "x_con", ")", "\n", "x_con", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_con", ")", "\n", "x_temp_B", "=", "tf", ".", "keras", ".", "layers", ".", "Add", "(", ")", "(", "[", "x_temp_B", ",", "x_con", "]", ")", "\n", "", "x_B", "=", "Dense", "(", "128", ",", "activation", "=", "'linear'", ")", "(", "x_temp_B", ")", "\n", "x_B", "=", "tf", ".", "keras", ".", "activations", ".", "swish", "(", "x_B", ")", "\n", "ModelY", "=", "tf", ".", "keras", ".", "Model", "(", "inputs", "=", "inputB", ",", "outputs", "=", "x_B", ")", "\n", "combinedXY", "=", "Concatenate", "(", "axis", "=", "-", "1", ")", "(", "[", "ModelX", ".", "output", ",", "ModelY", ".", "output", "]", ")", "\n", "combinedXY", "=", "Dense", "(", "256", ",", "activation", "=", "'linear'", ")", "(", "combinedXY", ")", "\n", "combinedXY", "=", "tf", ".", "keras", ".", "activations", ".", "swish", "(", "combinedXY", ")", "\n", "outputs", "=", "Dense", "(", "self", ".", "action_size", ",", "activation", "=", "'linear'", ",", "name", "=", "\"Outputs\"", ")", "(", "combinedXY", ")", "\n", "model", "=", "tf", ".", "keras", ".", "Model", "(", "inputs", "=", "[", "ModelX", ".", "input", ",", "ModelY", ".", "input", "]", ",", "outputs", "=", "[", "outputs", "]", ")", "\n", "model", ".", "compile", "(", "loss", "=", "'mse'", ",", "optimizer", "=", "'adam'", ")", "\n", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent.update_target_model": [[57, 59], ["DQN.DQNAgent.target_model.set_weights", "DQN.DQNAgent.model.get_weights"], "methods", ["None"], ["", "def", "update_target_model", "(", "self", ")", ":", "\n", "        ", "self", ".", "target_model", ".", "set_weights", "(", "self", ".", "model", ".", "get_weights", "(", ")", ")", "# copy weights from model to target_model", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent.memorize": [[60, 62], ["DQN.DQNAgent.memory.append"], "methods", ["None"], ["", "def", "memorize", "(", "self", ",", "state", ",", "action", ",", "reward", ",", "next_state", ")", ":", "\n", "        ", "self", ".", "memory", ".", "append", "(", "(", "state", ",", "action", ",", "reward", ",", "next_state", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent.act": [[63, 70], ["DQN.DQNAgent.model.predict", "numpy.random.rand", "numpy.argmax", "random.randrange"], "methods", ["None"], ["", "def", "act", "(", "self", ",", "state", ")", ":", "\n", "        ", "if", "np", ".", "random", ".", "rand", "(", ")", "<=", "self", ".", "epsilon", ":", "\n", "            ", "act_type", "=", "'random'", "\n", "return", "random", ".", "randrange", "(", "self", ".", "action_size", ")", ",", "act_type", "\n", "", "act_values", "=", "self", ".", "model", ".", "predict", "(", "state", ")", "\n", "act_type", "=", "'RL'", "\n", "return", "np", ".", "argmax", "(", "act_values", "[", "0", "]", ")", ",", "act_type", "# returns action", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent.replay": [[71, 90], ["random.sample", "DQN.DQNAgent.model.fit", "numpy.argmax", "DQN.DQNAgent.model.predict", "state_batch_0.append", "state_batch_1.append", "target_batch.append", "numpy.array", "numpy.array", "numpy.array", "len", "DQN.DQNAgent.model.predict", "DQN.DQNAgent.target_model.predict"], "methods", ["None"], ["", "def", "replay", "(", "self", ",", "batch_size", ")", ":", "\n", "        ", "minibatch", "=", "random", ".", "sample", "(", "self", ".", "memory", ",", "batch_size", ")", "\n", "minibatch", "[", "0", "]", "=", "self", ".", "memory", "[", "len", "(", "self", ".", "memory", ")", "-", "1", "]", "\n", "state_batch_0", ",", "state_batch_1", ",", "target_batch", "=", "[", "]", ",", "[", "]", ",", "[", "]", "\n", "for", "state", ",", "action", ",", "reward", ",", "next_state", "in", "minibatch", ":", "\n", "            ", "ActionIndex", "=", "np", ".", "argmax", "(", "self", ".", "model", ".", "predict", "(", "next_state", ")", "[", "0", "]", ")", "### Selection using DQN", "\n", "target", "=", "reward", "+", "self", ".", "gamma", "*", "self", ".", "target_model", ".", "predict", "(", "next_state", ")", "[", "0", "]", "[", "ActionIndex", "]", "# Evaluation using target network", "\n", "target_f", "=", "self", ".", "model", ".", "predict", "(", "state", ")", "## DQN", "\n", "target_f", "[", "0", "]", "[", "action", "]", "=", "target", "\n", "state_batch_0", ".", "append", "(", "state", "[", "0", "]", ")", "## Sub-state 1 -- Estimated Equivalent Wireless Channel H", "\n", "state_batch_1", ".", "append", "(", "state", "[", "1", "]", ")", "## Sub-state 2 -- Current Reflection Pattern", "\n", "target_batch", ".", "append", "(", "target_f", "[", "0", "]", ")", "## target batch", "\n", "", "history", "=", "self", ".", "model", ".", "fit", "(", "{", "\"InputA\"", ":", "np", ".", "array", "(", "state_batch_0", ")", ",", "\"InputB\"", ":", "np", ".", "array", "(", "state_batch_1", ")", "}", ",", "{", "\"Outputs\"", ":", "np", ".", "array", "(", "target_batch", ")", "}", ",", "epochs", "=", "1", ",", "verbose", "=", "0", ")", "\n", "\n", "# Keeping track of loss", "\n", "loss", "=", "history", ".", "history", "[", "'loss'", "]", "[", "0", "]", "\n", "if", "self", ".", "epsilon", ">", "self", ".", "epsilon_min", ":", "\n", "            ", "self", ".", "epsilon", "*=", "self", ".", "epsilon_decay", "\n", "", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent.load": [[91, 93], ["DQN.DQNAgent.model.load_weights"], "methods", ["None"], ["", "def", "load", "(", "self", ",", "name", ")", ":", "\n", "        ", "self", ".", "model", ".", "load_weights", "(", "name", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.DQN.DQNAgent.save": [[94, 96], ["DQN.DQNAgent.model.save_weights"], "methods", ["None"], ["", "def", "save", "(", "self", ",", "name", ")", ":", "\n", "        ", "self", ".", "model", ".", "save_weights", "(", "name", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MAB.MAB.__init__": [[9, 14], ["numpy.zeros", "numpy.zeros"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "BanditNum", ")", ":", "\n", "        ", "self", ".", "epsilon", "=", "0.01", "# exploration rate", "\n", "self", ".", "Q_MAB", "=", "np", ".", "zeros", "(", "BanditNum", ")", "\n", "self", ".", "Count_MAB", "=", "np", ".", "zeros", "(", "BanditNum", ")", "\n", "self", ".", "ActNum", "=", "BanditNum", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MAB.MAB.act_sel": [[15, 21], ["numpy.random.rand", "random.randrange", "numpy.argmax"], "methods", ["None"], ["", "def", "act_sel", "(", "self", ")", ":", "\n", "        ", "if", "np", ".", "random", ".", "rand", "(", ")", "<", "self", ".", "epsilon", ":", "\n", "            ", "act_index", "=", "random", ".", "randrange", "(", "self", ".", "ActNum", ")", "\n", "", "else", ":", "\n", "            ", "act_index", "=", "np", ".", "argmax", "(", "self", ".", "Q_MAB", ")", "\n", "", "return", "act_index", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MAB.MAB.Q_update": [[22, 25], ["None"], "methods", ["None"], ["", "def", "Q_update", "(", "self", ",", "act_index", ",", "Reward", ")", ":", "\n", "        ", "self", ".", "Q_MAB", "[", "act_index", "]", "=", "(", "self", ".", "Q_MAB", "[", "act_index", "]", "*", "self", ".", "Count_MAB", "[", "act_index", "]", "+", "Reward", ")", "/", "(", "self", ".", "Count_MAB", "[", "act_index", "]", "+", "1", ")", "\n", "self", ".", "Count_MAB", "[", "act_index", "]", "=", "self", ".", "Count_MAB", "[", "act_index", "]", "+", "1", "", "", "", ""]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.__init__": [[14, 18], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "NumAntBS", ",", "NumEleIRS", ",", "NumUser", ")", ":", "\n", "        ", "self", ".", "NumAntBS", "=", "NumAntBS", "\n", "self", ".", "NumEleIRS", "=", "NumEleIRS", "\n", "self", ".", "NumUser", "=", "NumUser", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.DFT_matrix": [[19, 24], ["numpy.meshgrid", "numpy.exp", "numpy.arange", "numpy.arange", "numpy.power", "sqrt"], "methods", ["None"], ["", "def", "DFT_matrix", "(", "self", ",", "N_point", ")", ":", "\n", "        ", "n", ",", "m", "=", "np", ".", "meshgrid", "(", "np", ".", "arange", "(", "N_point", ")", ",", "np", ".", "arange", "(", "N_point", ")", ")", "\n", "omega", "=", "np", ".", "exp", "(", "-", "2", "*", "pi", "*", "1j", "/", "N_point", ")", "\n", "W", "=", "np", ".", "power", "(", "omega", ",", "n", "*", "m", ")", "/", "sqrt", "(", "N_point", ")", "##", "\n", "return", "W", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.CH_Prop": [[25, 30], ["numpy.shape", "numpy.dot", "sqrt", "numpy.random.normal", "numpy.random.normal"], "methods", ["None"], ["", "def", "CH_Prop", "(", "self", ",", "H", ",", "sigma2", ",", "Pilot", ")", ":", "\n", "        ", "NumAnt", ",", "NumUser", "=", "np", ".", "shape", "(", "H", ")", "\n", "noise", "=", "1", "/", "sqrt", "(", "2", ")", "*", "(", "np", ".", "random", ".", "normal", "(", "0", ",", "sigma2", ",", "size", "=", "(", "NumAnt", ",", "NumUser", ")", ")", "+", "1j", "*", "np", ".", "random", ".", "normal", "(", "0", ",", "sigma2", ",", "size", "=", "(", "NumAnt", ",", "NumUser", ")", ")", ")", "## Gaussian Noise", "\n", "y_rx", "=", "np", ".", "dot", "(", "H", ",", "Pilot", ")", "+", "noise", "\n", "return", "y_rx", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.CH_est": [[31, 35], ["numpy.dot", "numpy.matrix.getH"], "methods", ["None"], ["", "def", "CH_est", "(", "self", ",", "y_rx", ",", "sigma2", ",", "Pilot", ")", ":", "\n", "        ", "MMSE_matrix", "=", "np", ".", "matrix", ".", "getH", "(", "Pilot", ")", "/", "(", "1", "+", "sigma2", ")", "## MMSE channel estimation", "\n", "H_est", "=", "np", ".", "dot", "(", "y_rx", ",", "MMSE_matrix", ")", "\n", "return", "H_est", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.Precoding": [[36, 42], ["numpy.dot", "abs", "numpy.dot", "numpy.linalg.inv", "numpy.matrix.getH", "numpy.diag", "numpy.sqrt", "numpy.diag", "numpy.dot", "numpy.dot", "numpy.matrix.getH", "numpy.matrix.getH"], "methods", ["None"], ["", "def", "Precoding", "(", "self", ",", "H_est", ")", ":", "\n", "        ", "F", "=", "np", ".", "dot", "(", "np", ".", "linalg", ".", "inv", "(", "np", ".", "dot", "(", "np", ".", "matrix", ".", "getH", "(", "H_est", ")", ",", "H_est", ")", ")", ",", "np", ".", "matrix", ".", "getH", "(", "H_est", ")", ")", "## Zero-forcing Precoding", "\n", "NormCoeff", "=", "abs", "(", "np", ".", "diag", "(", "np", ".", "dot", "(", "F", ",", "np", ".", "matrix", ".", "getH", "(", "F", ")", ")", ")", ")", "\n", "NormCoeff", "=", "1", "/", "np", ".", "sqrt", "(", "NormCoeff", ")", "\n", "F", "=", "np", ".", "dot", "(", "np", ".", "diag", "(", "NormCoeff", ")", ",", "F", ")", "## Normalization", "\n", "return", "F", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.GetRewards": [[43, 55], ["MuMIMOClass.envMuMIMO.CH_Prop", "MuMIMOClass.envMuMIMO.CH_est", "MuMIMOClass.envMuMIMO.Precoding", "numpy.dot", "abs", "numpy.diag", "abs.sum", "numpy.log2", "numpy.conj"], "methods", ["home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.CH_Prop", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.CH_est", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.Precoding"], ["", "def", "GetRewards", "(", "self", ",", "Pilot", ",", "H_synt", ",", "sigma2_BS", ",", "sigma2_UE", ")", ":", "\n", "        ", "y_rx", "=", "self", ".", "CH_Prop", "(", "H_synt", ",", "sigma2_BS", ",", "Pilot", ")", "### Received singal", "\n", "H_est", "=", "self", ".", "CH_est", "(", "y_rx", ",", "sigma2_BS", ",", "Pilot", ")", "### Estimated equivalent channel", "\n", "F", "=", "self", ".", "Precoding", "(", "H_est", ")", "### Zero-Forcing precoding", "\n", "H_eq", "=", "np", ".", "dot", "(", "F", ",", "H_synt", ")", "\n", "H_eq2", "=", "abs", "(", "H_eq", "*", "np", ".", "conj", "(", "H_eq", ")", ")", "\n", "SigPower", "=", "np", ".", "diag", "(", "H_eq2", ")", "#### Singal Power", "\n", "IntfPower", "=", "H_eq2", ".", "sum", "(", "axis", "=", "0", ")", "\n", "IntfPower", "=", "IntfPower", "-", "SigPower", "#### Interference Power", "\n", "SINR", "=", "SigPower", "/", "(", "IntfPower", "+", "sigma2_UE", ")", "### SNIR", "\n", "Rate", "=", "np", ".", "log2", "(", "1", "+", "SINR", ")", "#### Data Rate", "\n", "return", "Rate", ",", "y_rx", ",", "H_est", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.SubSteeringVec": [[56, 60], ["numpy.exp", "SSV.reshape.reshape.reshape", "numpy.arange"], "methods", ["None"], ["", "def", "SubSteeringVec", "(", "self", ",", "Angle", ",", "NumAnt", ")", ":", "\n", "        ", "SSV", "=", "np", ".", "exp", "(", "1j", "*", "Angle", "*", "math", ".", "pi", "*", "np", ".", "arange", "(", "0", ",", "NumAnt", ",", "1", ")", ")", "\n", "SSV", "=", "SSV", ".", "reshape", "(", "-", "1", ",", "1", ")", "\n", "return", "SSV", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.ChannelResponse": [[61, 76], ["numpy.linalg.norm", "numpy.kron", "numpy.kron", "numpy.kron", "numpy.kron", "numpy.linalg.multi_dot", "numpy.linalg.multi_dot", "numpy.linalg.multi_dot", "numpy.linalg.multi_dot", "MuMIMOClass.envMuMIMO.SubSteeringVec", "MuMIMOClass.envMuMIMO.SubSteeringVec", "MuMIMOClass.envMuMIMO.SubSteeringVec", "numpy.linalg.multi_dot", "numpy.linalg.multi_dot", "numpy.linalg.multi_dot", "MuMIMOClass.envMuMIMO.SubSteeringVec", "MuMIMOClass.envMuMIMO.SubSteeringVec", "MuMIMOClass.envMuMIMO.SubSteeringVec", "numpy.matrix.getH"], "methods", ["home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.SubSteeringVec", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.SubSteeringVec", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.SubSteeringVec", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.SubSteeringVec", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.SubSteeringVec", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.SubSteeringVec"], ["", "def", "ChannelResponse", "(", "self", ",", "Pos_A", ",", "Pos_B", ",", "ArrayShape_A", ",", "ArrayShape_B", ")", ":", "## LoS channel response, which is position dependent", "\n", "        ", "dis_AB", "=", "np", ".", "linalg", ".", "norm", "(", "Pos_A", "-", "Pos_B", ")", "## distance", "\n", "DirVec_AB", "=", "(", "Pos_A", "-", "Pos_B", ")", "/", "dis_AB", "## direction vector", "\n", "angleA", "=", "[", "np", ".", "linalg", ".", "multi_dot", "(", "[", "[", "1", ",", "0", ",", "0", "]", ",", "DirVec_AB", "]", ")", ",", "np", ".", "linalg", ".", "multi_dot", "(", "[", "[", "0", ",", "1", ",", "0", "]", ",", "DirVec_AB", "]", ")", ",", "\n", "np", ".", "linalg", ".", "multi_dot", "(", "[", "[", "0", ",", "0", ",", "1", "]", ",", "DirVec_AB", "]", ")", "]", "\n", "SteeringVectorA", "=", "np", ".", "kron", "(", "self", ".", "SubSteeringVec", "(", "angleA", "[", "0", "]", ",", "ArrayShape_A", "[", "0", "]", ")", ",", "\n", "self", ".", "SubSteeringVec", "(", "angleA", "[", "1", "]", ",", "ArrayShape_A", "[", "1", "]", ")", ")", "\n", "SteeringVectorA", "=", "np", ".", "kron", "(", "SteeringVectorA", ",", "self", ".", "SubSteeringVec", "(", "angleA", "[", "2", "]", ",", "ArrayShape_A", "[", "2", "]", ")", ")", "\n", "angleB", "=", "[", "np", ".", "linalg", ".", "multi_dot", "(", "[", "[", "1", ",", "0", ",", "0", "]", ",", "DirVec_AB", "]", ")", ",", "np", ".", "linalg", ".", "multi_dot", "(", "[", "[", "0", ",", "1", ",", "0", "]", ",", "DirVec_AB", "]", ")", ",", "\n", "np", ".", "linalg", ".", "multi_dot", "(", "[", "[", "0", ",", "0", ",", "1", "]", ",", "DirVec_AB", "]", ")", "]", "\n", "SteeringVectorB", "=", "np", ".", "kron", "(", "self", ".", "SubSteeringVec", "(", "angleB", "[", "0", "]", ",", "ArrayShape_B", "[", "0", "]", ")", ",", "\n", "self", ".", "SubSteeringVec", "(", "angleB", "[", "1", "]", ",", "ArrayShape_B", "[", "1", "]", ")", ")", "\n", "SteeringVectorB", "=", "np", ".", "kron", "(", "SteeringVectorB", ",", "self", ".", "SubSteeringVec", "(", "angleB", "[", "2", "]", ",", "ArrayShape_B", "[", "2", "]", ")", ")", "\n", "H_matrix", "=", "np", ".", "linalg", ".", "multi_dot", "(", "[", "SteeringVectorA", ",", "np", ".", "matrix", ".", "getH", "(", "SteeringVectorB", ")", "]", ")", "\n", "return", "H_matrix", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.H_GenFunLoS": [[78, 91], ["len", "numpy.prod", "numpy.prod", "range", "MuMIMOClass.envMuMIMO.ChannelResponse", "numpy.zeros", "numpy.zeros", "MuMIMOClass.envMuMIMO.ChannelResponse", "MuMIMOClass.envMuMIMO.reshape", "MuMIMOClass.envMuMIMO.ChannelResponse", "MuMIMOClass.envMuMIMO.reshape", "numpy.zeros", "numpy.zeros"], "methods", ["home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.ChannelResponse", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.ChannelResponse", "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.ChannelResponse"], ["", "def", "H_GenFunLoS", "(", "self", ",", "Pos_BS", ",", "Pos_IRS", ",", "Pos_UE", ",", "ArrayShape_BS", ",", "ArrayShape_IRS", ",", "ArrayShape_UE", ")", ":", "\n", "        ", "NumUE", "=", "len", "(", "Pos_UE", ")", "\n", "NumAntBS", "=", "np", ".", "prod", "(", "ArrayShape_BS", ")", "\n", "NumEleIRS", "=", "np", ".", "prod", "(", "ArrayShape_IRS", ")", "\n", "H_BU_LoS", "=", "np", ".", "zeros", "(", "(", "NumAntBS", ",", "NumUE", ")", ")", "+", "1j", "*", "np", ".", "zeros", "(", "(", "NumAntBS", ",", "NumUE", ")", ")", "\n", "H_RU_LoS", "=", "np", ".", "zeros", "(", "(", "NumEleIRS", ",", "NumUE", ")", ")", "+", "1j", "*", "np", ".", "zeros", "(", "(", "NumEleIRS", ",", "NumUE", ")", ")", "\n", "for", "iu", "in", "range", "(", "NumUE", ")", ":", "\n", "            ", "h_BU_LoS", "=", "self", ".", "ChannelResponse", "(", "Pos_BS", ",", "Pos_UE", "[", "iu", "]", ",", "ArrayShape_BS", ",", "ArrayShape_UE", ")", "\n", "H_BU_LoS", "[", ":", ",", "iu", "]", "=", "h_BU_LoS", ".", "reshape", "(", "-", "1", ")", "\n", "h_RU_LoS", "=", "self", ".", "ChannelResponse", "(", "Pos_IRS", ",", "Pos_UE", "[", "iu", "]", ",", "ArrayShape_IRS", ",", "ArrayShape_UE", ")", "\n", "H_RU_LoS", "[", ":", ",", "iu", "]", "=", "h_RU_LoS", ".", "reshape", "(", "-", "1", ")", "\n", "", "H_BR_LoS", "=", "self", ".", "ChannelResponse", "(", "Pos_BS", ",", "Pos_IRS", ",", "ArrayShape_BS", ",", "ArrayShape_IRS", ")", "\n", "return", "H_BU_LoS", ",", "H_BR_LoS", ",", "H_RU_LoS", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.H_GenFunNLoS": [[93, 98], ["sqrt", "numpy.random.normal", "sqrt", "numpy.random.normal", "sqrt", "numpy.random.normal", "numpy.random.normal", "numpy.random.normal", "numpy.random.normal"], "methods", ["None"], ["", "def", "H_GenFunNLoS", "(", "self", ",", "NumAntBS", ",", "NumEleIRS", ",", "NumUser", ")", ":", "\n", "        ", "H_U2B_NLoS", "=", "1", "/", "sqrt", "(", "2", ")", "*", "(", "np", ".", "random", ".", "normal", "(", "0", ",", "1", ",", "size", "=", "(", "NumAntBS", ",", "NumUser", ")", ")", "+", "1j", "*", "np", ".", "random", ".", "normal", "(", "0", ",", "1", ",", "size", "=", "(", "NumAntBS", ",", "NumUser", ")", ")", ")", "\n", "H_R2B_NLoS", "=", "1", "/", "sqrt", "(", "2", ")", "*", "(", "np", ".", "random", ".", "normal", "(", "0", ",", "1", ",", "size", "=", "(", "NumAntBS", ",", "NumEleIRS", ")", ")", "+", "1j", "*", "np", ".", "random", ".", "normal", "(", "0", ",", "1", ",", "size", "=", "(", "NumAntBS", ",", "NumEleIRS", ")", ")", ")", "\n", "H_U2R_NLoS", "=", "1", "/", "sqrt", "(", "2", ")", "*", "(", "np", ".", "random", ".", "normal", "(", "0", ",", "1", ",", "size", "=", "(", "NumEleIRS", ",", "NumUser", ")", ")", "+", "1j", "*", "np", ".", "random", ".", "normal", "(", "0", ",", "1", ",", "size", "=", "(", "NumEleIRS", ",", "NumUser", ")", ")", ")", "\n", "return", "H_U2B_NLoS", ",", "H_R2B_NLoS", ",", "H_U2R_NLoS", "\n", "\n"]], "home.repos.pwc.inspect_result.weiwang-wys_irsconfigurationdrl.None.MuMIMOClass.envMuMIMO.H_syntFun": [[99, 103], ["numpy.diag", "numpy.linalg.multi_dot"], "methods", ["None"], ["", "def", "H_syntFun", "(", "self", ",", "H_U2B", ",", "H_R2B", ",", "H_U2R", ",", "RefVector", ")", ":", "### Syntheize the aggregated wireless channel", "\n", "        ", "RefPattern_matrix", "=", "np", ".", "diag", "(", "RefVector", ")", "\n", "H_synt", "=", "H_U2B", "+", "1", "*", "np", ".", "linalg", ".", "multi_dot", "(", "[", "H_R2B", ",", "RefPattern_matrix", ",", "H_U2R", "]", ")", "\n", "return", "H_synt", "", "", "", ""]]}