{"home.repos.pwc.inspect_result.chenziku_train-procgen.train_procgen.train_load.main": [[18, 103], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "comm.Get_rank", "comm.Split", "baselines.logger.configure", "baselines.logger.info", "procgen.ProcgenEnv", "baselines.common.vec_env.VecExtractDictObs", "baselines.common.vec_env.VecMonitor", "baselines.common.vec_env.VecNormalize", "baselines.logger.info", "baselines.common.mpi_util.setup_mpi_gpus", "tensorflow.ConfigProto", "tensorflow.Session", "tf.Session.__enter__", "baselines.logger.info", "baselines.ppo2.ppo2_cvae.learn", "baselines.common.models.build_impala_cnn", "comm.Split.Get_rank", "comm.Get_rank"], "function", ["None"], ["def", "main", "(", ")", ":", "\n", "    ", "num_envs", "=", "64", "\n", "learning_rate", "=", "5e-4", "\n", "ent_coef", "=", ".01", "\n", "gamma", "=", ".999", "\n", "lam", "=", ".95", "\n", "nsteps", "=", "256", "\n", "nminibatches", "=", "8", "\n", "ppo_epochs", "=", "3", "\n", "clip_range", "=", ".2", "\n", "last_step", "=", "4587520", "# where we have left off in training", "\n", "timesteps_per_proc", "=", "25_000_000", "-", "last_step", "\n", "use_vf_clipping", "=", "True", "\n", "model_path", "=", "'../train-procgen/saved_model/policy_bossfight_vae560'", "\n", "vae_path", "=", "'../train-procgen/saved_model/bossfight_vae560'", "\n", "\n", "parser", "=", "argparse", ".", "ArgumentParser", "(", "description", "=", "'Process procgen training arguments.'", ")", "\n", "parser", ".", "add_argument", "(", "'--env_name'", ",", "type", "=", "str", ",", "default", "=", "'coinrun'", ")", "\n", "parser", ".", "add_argument", "(", "'--distribution_mode'", ",", "type", "=", "str", ",", "default", "=", "'hard'", ",", "choices", "=", "[", "\"easy\"", ",", "\"hard\"", ",", "\"exploration\"", ",", "\"memory\"", ",", "\"extreme\"", "]", ")", "\n", "parser", ".", "add_argument", "(", "'--num_levels'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "parser", ".", "add_argument", "(", "'--start_level'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "parser", ".", "add_argument", "(", "'--test_worker_interval'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n", "test_worker_interval", "=", "args", ".", "test_worker_interval", "\n", "\n", "comm", "=", "MPI", ".", "COMM_WORLD", "\n", "rank", "=", "comm", ".", "Get_rank", "(", ")", "\n", "\n", "is_test_worker", "=", "False", "\n", "\n", "if", "test_worker_interval", ">", "0", ":", "\n", "        ", "is_test_worker", "=", "comm", ".", "Get_rank", "(", ")", "%", "test_worker_interval", "==", "(", "test_worker_interval", "-", "1", ")", "\n", "\n", "", "mpi_rank_weight", "=", "0", "if", "is_test_worker", "else", "1", "\n", "num_levels", "=", "0", "if", "is_test_worker", "else", "args", ".", "num_levels", "\n", "\n", "log_comm", "=", "comm", ".", "Split", "(", "1", "if", "is_test_worker", "else", "0", ",", "0", ")", "\n", "format_strs", "=", "[", "'csv'", ",", "'stdout'", "]", "if", "log_comm", ".", "Get_rank", "(", ")", "==", "0", "else", "[", "]", "\n", "logger", ".", "configure", "(", "dir", "=", "LOG_DIR", ",", "format_strs", "=", "format_strs", ")", "\n", "\n", "logger", ".", "info", "(", "\"creating environment\"", ")", "\n", "venv", "=", "ProcgenEnv", "(", "num_envs", "=", "num_envs", ",", "env_name", "=", "args", ".", "env_name", ",", "num_levels", "=", "num_levels", ",", "start_level", "=", "args", ".", "start_level", ",", "distribution_mode", "=", "args", ".", "distribution_mode", ")", "\n", "venv", "=", "VecExtractDictObs", "(", "venv", ",", "\"rgb\"", ")", "\n", "\n", "venv", "=", "VecMonitor", "(", "\n", "venv", "=", "venv", ",", "filename", "=", "None", ",", "keep_buf", "=", "100", ",", "\n", ")", "\n", "\n", "venv", "=", "VecNormalize", "(", "venv", "=", "venv", ",", "ob", "=", "False", ")", "\n", "\n", "logger", ".", "info", "(", "\"creating tf session\"", ")", "\n", "setup_mpi_gpus", "(", ")", "\n", "config", "=", "tf", ".", "ConfigProto", "(", ")", "\n", "config", ".", "gpu_options", ".", "allow_growth", "=", "True", "#pylint: disable=E1101", "\n", "sess", "=", "tf", ".", "Session", "(", "config", "=", "config", ")", "\n", "sess", ".", "__enter__", "(", ")", "\n", "\n", "conv_fn", "=", "lambda", "x", ":", "build_impala_cnn", "(", "x", ",", "depths", "=", "[", "16", ",", "32", ",", "32", "]", ",", "emb_size", "=", "256", ")", "\n", "\n", "logger", ".", "info", "(", "\"training\"", ")", "\n", "ppo2_cvae", ".", "learn", "(", "\n", "env", "=", "venv", ",", "\n", "network", "=", "conv_fn", ",", "\n", "total_timesteps", "=", "timesteps_per_proc", ",", "\n", "save_interval", "=", "10", ",", "\n", "nsteps", "=", "nsteps", ",", "\n", "nminibatches", "=", "nminibatches", ",", "\n", "lam", "=", "lam", ",", "\n", "gamma", "=", "gamma", ",", "\n", "noptepochs", "=", "ppo_epochs", ",", "\n", "log_interval", "=", "1", ",", "\n", "ent_coef", "=", "ent_coef", ",", "\n", "mpi_rank_weight", "=", "mpi_rank_weight", ",", "\n", "clip_vf", "=", "use_vf_clipping", ",", "\n", "comm", "=", "comm", ",", "\n", "lr", "=", "learning_rate", ",", "\n", "cliprange", "=", "clip_range", ",", "\n", "update_fn", "=", "None", ",", "\n", "init_fn", "=", "None", ",", "\n", "vf_coef", "=", "0.5", ",", "\n", "max_grad_norm", "=", "0.5", ",", "\n", "load_path", "=", "model_path", ",", "\n", "vae_path", "=", "vae_path", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.chenziku_train-procgen.train_procgen.train.main": [[18, 98], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "comm.Get_rank", "comm.Split", "baselines.logger.configure", "baselines.logger.info", "procgen.ProcgenEnv", "baselines.common.vec_env.VecExtractDictObs", "baselines.common.vec_env.VecMonitor", "baselines.common.vec_env.VecNormalize", "baselines.logger.info", "baselines.common.mpi_util.setup_mpi_gpus", "tensorflow.ConfigProto", "tensorflow.Session", "tf.Session.__enter__", "baselines.logger.info", "baselines.ppo2.ppo2_cvae.learn", "baselines.common.models.build_impala_cnn", "comm.Split.Get_rank", "comm.Get_rank"], "function", ["None"], ["def", "main", "(", ")", ":", "\n", "    ", "num_envs", "=", "64", "\n", "learning_rate", "=", "5e-4", "\n", "ent_coef", "=", ".01", "\n", "gamma", "=", ".999", "\n", "lam", "=", ".95", "\n", "nsteps", "=", "256", "\n", "nminibatches", "=", "8", "\n", "ppo_epochs", "=", "3", "\n", "clip_range", "=", ".2", "\n", "timesteps_per_proc", "=", "25_000_000", "\n", "use_vf_clipping", "=", "True", "\n", "\n", "parser", "=", "argparse", ".", "ArgumentParser", "(", "description", "=", "'Process procgen training arguments.'", ")", "\n", "parser", ".", "add_argument", "(", "'--env_name'", ",", "type", "=", "str", ",", "default", "=", "'coinrun'", ")", "\n", "parser", ".", "add_argument", "(", "'--distribution_mode'", ",", "type", "=", "str", ",", "default", "=", "'hard'", ",", "choices", "=", "[", "\"easy\"", ",", "\"hard\"", ",", "\"exploration\"", ",", "\"memory\"", ",", "\"extreme\"", "]", ")", "\n", "parser", ".", "add_argument", "(", "'--num_levels'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "parser", ".", "add_argument", "(", "'--start_level'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "parser", ".", "add_argument", "(", "'--test_worker_interval'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n", "test_worker_interval", "=", "args", ".", "test_worker_interval", "\n", "\n", "comm", "=", "MPI", ".", "COMM_WORLD", "\n", "rank", "=", "comm", ".", "Get_rank", "(", ")", "\n", "\n", "is_test_worker", "=", "False", "\n", "\n", "if", "test_worker_interval", ">", "0", ":", "\n", "        ", "is_test_worker", "=", "comm", ".", "Get_rank", "(", ")", "%", "test_worker_interval", "==", "(", "test_worker_interval", "-", "1", ")", "\n", "\n", "", "mpi_rank_weight", "=", "0", "if", "is_test_worker", "else", "1", "\n", "num_levels", "=", "0", "if", "is_test_worker", "else", "args", ".", "num_levels", "\n", "\n", "log_comm", "=", "comm", ".", "Split", "(", "1", "if", "is_test_worker", "else", "0", ",", "0", ")", "\n", "format_strs", "=", "[", "'csv'", ",", "'stdout'", "]", "if", "log_comm", ".", "Get_rank", "(", ")", "==", "0", "else", "[", "]", "\n", "logger", ".", "configure", "(", "dir", "=", "LOG_DIR", ",", "format_strs", "=", "format_strs", ")", "\n", "\n", "logger", ".", "info", "(", "\"creating environment\"", ")", "\n", "venv", "=", "ProcgenEnv", "(", "num_envs", "=", "num_envs", ",", "env_name", "=", "args", ".", "env_name", ",", "num_levels", "=", "num_levels", ",", "start_level", "=", "args", ".", "start_level", ",", "distribution_mode", "=", "args", ".", "distribution_mode", ")", "\n", "venv", "=", "VecExtractDictObs", "(", "venv", ",", "\"rgb\"", ")", "\n", "\n", "venv", "=", "VecMonitor", "(", "\n", "venv", "=", "venv", ",", "filename", "=", "None", ",", "keep_buf", "=", "100", ",", "\n", ")", "\n", "\n", "venv", "=", "VecNormalize", "(", "venv", "=", "venv", ",", "ob", "=", "False", ")", "\n", "\n", "logger", ".", "info", "(", "\"creating tf session\"", ")", "\n", "setup_mpi_gpus", "(", ")", "\n", "config", "=", "tf", ".", "ConfigProto", "(", ")", "\n", "config", ".", "gpu_options", ".", "allow_growth", "=", "True", "#pylint: disable=E1101", "\n", "sess", "=", "tf", ".", "Session", "(", "config", "=", "config", ")", "\n", "sess", ".", "__enter__", "(", ")", "\n", "\n", "conv_fn", "=", "lambda", "x", ":", "build_impala_cnn", "(", "x", ",", "depths", "=", "[", "16", ",", "32", ",", "32", "]", ",", "emb_size", "=", "256", ")", "\n", "\n", "logger", ".", "info", "(", "\"training\"", ")", "\n", "ppo2_cvae", ".", "learn", "(", "\n", "env", "=", "venv", ",", "\n", "network", "=", "conv_fn", ",", "\n", "total_timesteps", "=", "timesteps_per_proc", ",", "\n", "save_interval", "=", "10", ",", "\n", "nsteps", "=", "nsteps", ",", "\n", "nminibatches", "=", "nminibatches", ",", "\n", "lam", "=", "lam", ",", "\n", "gamma", "=", "gamma", ",", "\n", "noptepochs", "=", "ppo_epochs", ",", "\n", "log_interval", "=", "1", ",", "\n", "ent_coef", "=", "ent_coef", ",", "\n", "mpi_rank_weight", "=", "mpi_rank_weight", ",", "\n", "clip_vf", "=", "use_vf_clipping", ",", "\n", "comm", "=", "comm", ",", "\n", "lr", "=", "learning_rate", ",", "\n", "cliprange", "=", "clip_range", ",", "\n", "update_fn", "=", "None", ",", "\n", "init_fn", "=", "None", ",", "\n", "vf_coef", "=", "0.5", ",", "\n", "max_grad_norm", "=", "0.5", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.chenziku_train-procgen.train_procgen.test.main": [[18, 101], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "comm.Get_rank", "comm.Split", "baselines.logger.configure", "baselines.logger.info", "procgen.ProcgenEnv", "baselines.common.vec_env.VecExtractDictObs", "baselines.common.vec_env.VecMonitor", "baselines.common.vec_env.VecNormalize", "baselines.logger.info", "baselines.common.mpi_util.setup_mpi_gpus", "tensorflow.ConfigProto", "tensorflow.Session", "tf.Session.__enter__", "baselines.logger.info", "baselines.ppo2.ppo2.learn", "baselines.common.models.build_impala_cnn", "comm.Split.Get_rank", "comm.Get_rank"], "function", ["None"], ["def", "main", "(", ")", ":", "\n", "    ", "num_envs", "=", "64", "\n", "learning_rate", "=", "5e-4", "\n", "ent_coef", "=", ".01", "\n", "gamma", "=", ".999", "\n", "lam", "=", ".95", "\n", "nsteps", "=", "256", "\n", "nminibatches", "=", "8", "\n", "ppo_epochs", "=", "3", "\n", "clip_range", "=", ".2", "\n", "timesteps_per_proc", "=", "25_000_000", "\n", "use_vf_clipping", "=", "True", "\n", "model_path", "=", "None", "# add saved model path", "\n", "model_path", "=", "'../train-procgen/saved_model/policy_bossfight_vae560'", "\n", "\n", "parser", "=", "argparse", ".", "ArgumentParser", "(", "description", "=", "'Process procgen training arguments.'", ")", "\n", "parser", ".", "add_argument", "(", "'--env_name'", ",", "type", "=", "str", ",", "default", "=", "'coinrun'", ")", "\n", "parser", ".", "add_argument", "(", "'--distribution_mode'", ",", "type", "=", "str", ",", "default", "=", "'hard'", ",", "choices", "=", "[", "\"easy\"", ",", "\"hard\"", ",", "\"exploration\"", ",", "\"memory\"", ",", "\"extreme\"", "]", ")", "\n", "parser", ".", "add_argument", "(", "'--num_levels'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "parser", ".", "add_argument", "(", "'--start_level'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "parser", ".", "add_argument", "(", "'--test_worker_interval'", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n", "test_worker_interval", "=", "args", ".", "test_worker_interval", "\n", "\n", "comm", "=", "MPI", ".", "COMM_WORLD", "\n", "rank", "=", "comm", ".", "Get_rank", "(", ")", "\n", "\n", "is_test_worker", "=", "False", "\n", "\n", "if", "test_worker_interval", ">", "0", ":", "\n", "        ", "is_test_worker", "=", "comm", ".", "Get_rank", "(", ")", "%", "test_worker_interval", "==", "(", "test_worker_interval", "-", "1", ")", "\n", "\n", "", "mpi_rank_weight", "=", "0", "if", "is_test_worker", "else", "1", "\n", "num_levels", "=", "0", "if", "is_test_worker", "else", "args", ".", "num_levels", "\n", "\n", "log_comm", "=", "comm", ".", "Split", "(", "1", "if", "is_test_worker", "else", "0", ",", "0", ")", "\n", "format_strs", "=", "[", "'csv'", ",", "'stdout'", "]", "if", "log_comm", ".", "Get_rank", "(", ")", "==", "0", "else", "[", "]", "\n", "logger", ".", "configure", "(", "dir", "=", "LOG_DIR", ",", "format_strs", "=", "format_strs", ")", "\n", "\n", "logger", ".", "info", "(", "\"creating environment\"", ")", "\n", "venv", "=", "ProcgenEnv", "(", "num_envs", "=", "num_envs", ",", "env_name", "=", "args", ".", "env_name", ",", "num_levels", "=", "num_levels", ",", "start_level", "=", "args", ".", "start_level", ",", "distribution_mode", "=", "args", ".", "distribution_mode", ")", "\n", "venv", "=", "VecExtractDictObs", "(", "venv", ",", "\"rgb\"", ")", "\n", "\n", "venv", "=", "VecMonitor", "(", "\n", "venv", "=", "venv", ",", "filename", "=", "None", ",", "keep_buf", "=", "100", ",", "\n", ")", "\n", "\n", "venv", "=", "VecNormalize", "(", "venv", "=", "venv", ",", "ob", "=", "False", ")", "\n", "\n", "logger", ".", "info", "(", "\"creating tf session\"", ")", "\n", "setup_mpi_gpus", "(", ")", "\n", "config", "=", "tf", ".", "ConfigProto", "(", ")", "\n", "config", ".", "gpu_options", ".", "allow_growth", "=", "True", "#pylint: disable=E1101", "\n", "sess", "=", "tf", ".", "Session", "(", "config", "=", "config", ")", "\n", "sess", ".", "__enter__", "(", ")", "\n", "\n", "conv_fn", "=", "lambda", "x", ":", "build_impala_cnn", "(", "x", ",", "depths", "=", "[", "16", ",", "32", ",", "32", "]", ",", "emb_size", "=", "256", ")", "\n", "\n", "logger", ".", "info", "(", "\"training\"", ")", "\n", "ppo2", ".", "learn", "(", "\n", "env", "=", "venv", ",", "\n", "network", "=", "conv_fn", ",", "\n", "total_timesteps", "=", "timesteps_per_proc", ",", "\n", "save_interval", "=", "0", ",", "\n", "nsteps", "=", "nsteps", ",", "\n", "nminibatches", "=", "nminibatches", ",", "\n", "lam", "=", "lam", ",", "\n", "gamma", "=", "gamma", ",", "\n", "noptepochs", "=", "ppo_epochs", ",", "\n", "log_interval", "=", "1", ",", "\n", "ent_coef", "=", "ent_coef", ",", "\n", "mpi_rank_weight", "=", "mpi_rank_weight", ",", "\n", "clip_vf", "=", "use_vf_clipping", ",", "\n", "comm", "=", "comm", ",", "\n", "lr", "=", "learning_rate", ",", "\n", "cliprange", "=", "clip_range", ",", "\n", "update_fn", "=", "None", ",", "\n", "init_fn", "=", "None", ",", "\n", "vf_coef", "=", "0.5", ",", "\n", "max_grad_norm", "=", "0.5", ",", "\n", "load_path", "=", "model_path", "\n", ")", "\n"]]}