{"home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.main.main": [[15, 38], ["os.path.join", "os.path.join", "utils.create_dirs", "tensorflow.Session", "print", "importlib.import_module", "importlib.import_module.create_model", "data.DataGenerator", "logger.Logger", "trainer.Trainer", "trainer.Trainer.train", "trainer.Trainer.test"], "function", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.create_dirs", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.MAMNet.create_model", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.trainer.Trainer.train", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.trainer.Trainer.test"], ["def", "main", "(", ")", ":", "\n", "# create the experiments directory", "\n", "    ", "ckpt_dir", "=", "os", ".", "path", ".", "join", "(", "args", ".", "exp_dir", ",", "args", ".", "exp_name", ")", "\n", "results_dir", "=", "os", ".", "path", ".", "join", "(", "ckpt_dir", ",", "'results'", ")", "\n", "create_dirs", "(", "[", "ckpt_dir", ",", "results_dir", "]", ")", "\n", "\n", "# create tensorflow session", "\n", "sess", "=", "tf", ".", "Session", "(", ")", "\n", "print", "(", "\"\\nSession is created!\"", ")", "\n", "\n", "# create instances of the model, data generator, logger, and trainer", "\n", "module", "=", "import_module", "(", "\"model.\"", "+", "args", ".", "model_name", ")", "\n", "model", "=", "module", ".", "create_model", "(", "args", ")", "\n", "\n", "if", "args", ".", "is_train", "or", "args", ".", "is_test", ":", "\n", "        ", "data", "=", "DataGenerator", "(", "args", ")", "\n", "logger", "=", "Logger", "(", "sess", ",", "args", ")", "\n", "trainer", "=", "Trainer", "(", "sess", ",", "model", ",", "data", ",", "logger", ",", "args", ")", "\n", "\n", "", "if", "args", ".", "is_train", ":", "\n", "        ", "trainer", ".", "train", "(", ")", "\n", "", "if", "args", ".", "is_test", ":", "\n", "        ", "trainer", ".", "test", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.trainer.Trainer.__init__": [[7, 17], ["tensorflow.group", "trainer.Trainer.sess.run", "tensorflow.global_variables_initializer", "tensorflow.local_variables_initializer", "trainer.Trainer.model.load"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.load"], ["    ", "def", "__init__", "(", "self", ",", "sess", ",", "model", ",", "data", ",", "logger", ",", "args", ")", ":", "\n", "        ", "self", ".", "sess", "=", "sess", "\n", "self", ".", "model", "=", "model", "\n", "self", ".", "data", "=", "data", "\n", "self", ".", "logger", "=", "logger", "\n", "self", ".", "args", "=", "args", "\n", "self", ".", "init", "=", "tf", ".", "group", "(", "tf", ".", "global_variables_initializer", "(", ")", ",", "tf", ".", "local_variables_initializer", "(", ")", ")", "\n", "self", ".", "sess", ".", "run", "(", "self", ".", "init", ")", "\n", "if", "args", ".", "is_resume", ":", "\n", "            ", "self", ".", "model", ".", "load", "(", "sess", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.trainer.Trainer.train": [[18, 58], ["print", "trainer.Trainer.model.global_step.eval", "range", "print", "trainer.Trainer.data.get_batch", "time.time", "trainer.Trainer.sess.run", "time.time", "print", "trainer.Trainer.logger.write", "trainer.Trainer.model.save"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.data.DataGenerator.get_batch", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.logger.Logger.write", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.save"], ["", "", "def", "train", "(", "self", ")", ":", "\n", "        ", "print", "(", "\"Begin training...\"", ")", "\n", "whole_time", "=", "0", "\n", "init_global_step", "=", "self", ".", "model", ".", "global_step", ".", "eval", "(", "self", ".", "sess", ")", "\n", "for", "_", "in", "range", "(", "init_global_step", ",", "self", ".", "args", ".", "num_iter", ")", ":", "\n", "            ", "idx_scale", "=", "0", "\n", "# get batch data and scale", "\n", "train_in_imgs", ",", "train_tar_imgs", "=", "self", ".", "data", ".", "get_batch", "(", "batch_size", "=", "self", ".", "args", ".", "num_batch", ",", "idx_scale", "=", "idx_scale", ",", "in_patch_size", "=", "self", ".", "args", ".", "patch_size", ")", "\n", "\n", "start_time", "=", "time", ".", "time", "(", ")", "\n", "# train the network  ", "\n", "feed_dict", "=", "{", "self", ".", "model", ".", "input", ":", "train_in_imgs", ",", "self", ".", "model", ".", "target", ":", "train_tar_imgs", "}", "\n", "_", ",", "loss", ",", "lr", ",", "output", ",", "global_step", "=", "self", ".", "sess", ".", "run", "(", "[", "self", ".", "model", ".", "train_op", ",", "self", ".", "model", ".", "loss", ",", "self", ".", "model", ".", "learning_rate", ",", "self", ".", "model", ".", "output", ",", "self", ".", "model", ".", "global_step", "]", ",", "feed_dict", "=", "feed_dict", ")", "\n", "\n", "# check the duration of each iteration", "\n", "end_time", "=", "time", ".", "time", "(", ")", "\n", "duration", "=", "end_time", "-", "start_time", "\n", "whole_time", "+=", "duration", "\n", "mean_duration", "=", "whole_time", "/", "(", "global_step", "-", "init_global_step", ")", "\n", "\n", "############################################## print loss and duratin of training  ################################################", "\n", "if", "global_step", "%", "self", ".", "args", ".", "print_freq", "==", "0", ":", "\n", "                ", "print", "(", "'Loss: %.1f, Duration: %d / %d (%.3f sec/batch)'", "%", "(", "loss", ",", "global_step", ",", "self", ".", "args", ".", "num_iter", ",", "mean_duration", ")", ")", "\n", "\n", "\n", "############################################## log the loss, PSNR, and lr of training ##############################################", "\n", "", "if", "global_step", "%", "self", ".", "args", ".", "log_freq", "==", "0", ":", "\n", "# write summary", "\n", "                ", "summaries_dict", "=", "{", "}", "\n", "summaries_dict", "[", "'loss'", "]", "=", "loss", "\n", "summaries_dict", "[", "'lr'", "]", "=", "lr", "\n", "self", ".", "logger", ".", "write", "(", "summaries_dict", ",", "global_step", ",", "is_train", "=", "True", ",", "idx_scale", "=", "idx_scale", ")", "\n", "\n", "######################################################## save the trained model ########################################################", "\n", "", "if", "global_step", "%", "self", ".", "args", ".", "save_freq", "==", "0", ":", "\n", "# save the trained model", "\n", "                ", "self", ".", "model", ".", "save", "(", "self", ".", "sess", ")", "\n", "\n", "", "", "print", "(", "\"Training is done!\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.trainer.Trainer.test": [[59, 100], ["print", "trainer.Trainer.model.load", "zip", "print", "time.time", "time.time", "os.path.join", "utils.create_dirs", "os.path.join", "utils.save_img", "numpy.zeros", "range", "utils.chop_forward", "str", "numpy.fliplr", "range", "range", "numpy.rot90", "utils.chop_forward", "numpy.fliplr", "numpy.rot90", "utils.chop_forward", "numpy.rot90", "trainer.Trainer.model.ckpt.split", "numpy.rot90"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.load", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.create_dirs", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.save_img", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.chop_forward", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.chop_forward", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.chop_forward"], ["", "def", "test", "(", "self", ")", ":", "\n", "        ", "print", "(", "\"Begin test...\"", ")", "\n", "# load trained model", "\n", "self", ".", "model", ".", "load", "(", "self", ".", "sess", ")", "\n", "\n", "# inference validation images & calculate PSNR", "\n", "mean_runtime", "=", "0", "\n", "mean_psnr", "=", "0", "\n", "file_name_list", "=", "self", ".", "data", ".", "file_names_for_dirs", "[", "0", "]", "\n", "for", "(", "in_img", ",", "file_name", ")", "in", "zip", "(", "self", ".", "data", ".", "dataset", "[", "0", "]", ",", "file_name_list", ")", ":", "\n", "# inference ", "\n", "            ", "start_time", "=", "time", ".", "time", "(", ")", "\n", "# Geometric self-ensemble", "\n", "if", "self", ".", "args", ".", "self_ensemble", ":", "\n", "                ", "tmp_img", "=", "np", ".", "zeros", "(", "[", "in_img", ".", "shape", "[", "0", "]", "*", "self", ".", "data", ".", "scale_list", "[", "0", "]", ",", "in_img", ".", "shape", "[", "1", "]", "*", "self", ".", "data", ".", "scale_list", "[", "0", "]", ",", "3", "]", ")", "\n", "for", "i", "in", "range", "(", "2", ")", ":", "\n", "                    ", "if", "i", "==", "0", ":", "\n", "                        ", "flip_img", "=", "np", ".", "fliplr", "(", "in_img", ")", "\n", "for", "j", "in", "range", "(", "4", ")", ":", "\n", "                            ", "rot_flip_img", "=", "np", ".", "rot90", "(", "flip_img", ",", "j", ")", "\n", "out_img", "=", "chop_forward", "(", "rot_flip_img", ",", "self", ".", "sess", ",", "self", ".", "model", ",", "scale", "=", "self", ".", "data", ".", "scale_list", "[", "0", "]", ",", "shave", "=", "10", ")", "\n", "tmp_img", "+=", "np", ".", "fliplr", "(", "np", ".", "rot90", "(", "out_img", ",", "4", "-", "j", ")", ")", "\n", "", "", "else", ":", "\n", "                        ", "for", "k", "in", "range", "(", "4", ")", ":", "\n", "                            ", "rot_img", "=", "np", ".", "rot90", "(", "in_img", ",", "k", ")", "\n", "out_img", "=", "chop_forward", "(", "rot_img", ",", "self", ".", "sess", ",", "self", ".", "model", ",", "scale", "=", "self", ".", "data", ".", "scale_list", "[", "0", "]", ",", "shave", "=", "10", ")", "\n", "tmp_img", "+=", "np", ".", "rot90", "(", "out_img", ",", "4", "-", "k", ")", "\n", "", "", "", "out_img", "=", "tmp_img", "/", "8", "\n", "", "else", ":", "\n", "                ", "out_img", "=", "chop_forward", "(", "in_img", ",", "self", ".", "sess", ",", "self", ".", "model", ",", "scale", "=", "self", ".", "data", ".", "scale_list", "[", "0", "]", ",", "shave", "=", "10", ")", "\n", "\n", "", "end_time", "=", "time", ".", "time", "(", ")", "\n", "mean_runtime", "+=", "(", "end_time", "-", "start_time", ")", "/", "self", ".", "args", ".", "num_test", "\n", "\n", "# save images", "\n", "dir_img_", "=", "os", ".", "path", ".", "join", "(", "self", ".", "args", ".", "exp_dir", ",", "self", ".", "args", ".", "exp_name", ",", "'results'", ",", "'iter_%s'", "%", "str", "(", "self", ".", "model", ".", "ckpt", ".", "split", "(", "'-'", ")", "[", "-", "1", "]", ")", ",", "self", ".", "args", ".", "dataset_name", ")", "\n", "create_dirs", "(", "[", "dir_img_", "]", ")", "\n", "dir_img", "=", "os", ".", "path", ".", "join", "(", "dir_img_", ",", "file_name", ")", "\n", "save_img", "(", "out_img", ",", "dir", "=", "dir_img", ")", "\n", "\n", "", "print", "(", "\"Test is done!\"", ")", "", "", "", ""]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.logger.Logger.__init__": [[5, 17], ["os.path.join", "list", "map", "print", "logger.Logger.args.scale.split", "tensorflow.summary.FileWriter", "tensorflow.summary.FileWriter", "int", "os.path.join", "os.path.join"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "sess", ",", "args", ")", ":", "\n", "        ", "self", ".", "sess", "=", "sess", "\n", "self", ".", "args", "=", "args", "\n", "self", ".", "ckpt_dir", "=", "os", ".", "path", ".", "join", "(", "self", ".", "args", ".", "exp_dir", ",", "self", ".", "args", ".", "exp_name", ")", "\n", "self", ".", "scale_list", "=", "list", "(", "map", "(", "lambda", "x", ":", "int", "(", "x", ")", ",", "self", ".", "args", ".", "scale", ".", "split", "(", "'+'", ")", ")", ")", "\n", "if", "not", "args", ".", "is_test", ":", "\n", "            ", "self", ".", "summary_placeholders", "=", "{", "}", "\n", "self", ".", "summary_ops", "=", "{", "}", "\n", "self", ".", "train_writer", "=", "[", "tf", ".", "summary", ".", "FileWriter", "(", "os", ".", "path", ".", "join", "(", "self", ".", "ckpt_dir", ",", "\"train_x%d\"", "%", "scale", ")", ")", "for", "scale", "in", "self", ".", "scale_list", "]", "\n", "self", ".", "valid_writer", "=", "[", "tf", ".", "summary", ".", "FileWriter", "(", "os", ".", "path", ".", "join", "(", "self", ".", "ckpt_dir", ",", "\"valid_x%d\"", "%", "scale", ")", ")", "for", "scale", "in", "self", ".", "scale_list", "]", "\n", "\n", "print", "(", "\"Logger is constructed!\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.logger.Logger.write": [[18, 41], ["summaries_dict.items", "summary_writer.flush", "summary_list.append", "summary_writer.add_summary", "tensorflow.placeholder", "logger.Logger.sess.run", "len", "tensorflow.summary.scalar", "tensorflow.summary.image"], "methods", ["None"], ["", "", "def", "write", "(", "self", ",", "summaries_dict", ",", "step", ",", "is_train", ",", "idx_scale", ",", "scope", "=", "\"\"", ")", ":", "\n", "# select training/validation", "\n", "        ", "if", "is_train", ":", "\n", "            ", "summary_writer", "=", "self", ".", "train_writer", "[", "idx_scale", "]", "\n", "", "else", ":", "\n", "            ", "summary_writer", "=", "self", ".", "valid_writer", "[", "idx_scale", "]", "\n", "\n", "", "if", "summaries_dict", "is", "not", "None", ":", "\n", "# make the list of summary (tf.summary.scalar + tf.scalar.image)", "\n", "            ", "summary_list", "=", "[", "]", "\n", "for", "tag", ",", "value", "in", "summaries_dict", ".", "items", "(", ")", ":", "\n", "                ", "if", "tag", "not", "in", "self", ".", "summary_ops", ":", "\n", "                    ", "self", ".", "summary_placeholders", "[", "tag", "]", "=", "tf", ".", "placeholder", "(", "'float32'", ",", "value", ".", "shape", ",", "name", "=", "tag", ")", "\n", "if", "len", "(", "value", ".", "shape", ")", "<=", "1", ":", "\n", "                        ", "self", ".", "summary_ops", "[", "tag", "]", "=", "tf", ".", "summary", ".", "scalar", "(", "tag", ",", "self", ".", "summary_placeholders", "[", "tag", "]", ")", "\n", "", "else", ":", "\n", "                        ", "self", ".", "summary_ops", "[", "tag", "]", "=", "tf", ".", "summary", ".", "image", "(", "tag", ",", "self", ".", "summary_placeholders", "[", "tag", "]", ")", "\n", "\n", "", "", "summary_list", ".", "append", "(", "self", ".", "sess", ".", "run", "(", "self", ".", "summary_ops", "[", "tag", "]", ",", "{", "self", ".", "summary_placeholders", "[", "tag", "]", ":", "value", "}", ")", ")", "\n", "# write the summaries", "\n", "", "for", "summary", "in", "summary_list", ":", "\n", "                ", "summary_writer", ".", "add_summary", "(", "summary", ",", "step", ")", "\n", "", "summary_writer", ".", "flush", "(", ")", "", "", "", "", ""]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.data.DataGenerator.__init__": [[6, 10], ["data.DataGenerator.load_data", "print"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.data.DataGenerator.load_data"], ["    ", "def", "__init__", "(", "self", ",", "args", ")", ":", "\n", "        ", "self", ".", "args", "=", "args", "\n", "self", ".", "load_data", "(", ")", "\n", "print", "(", "'Data is loaded!'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.data.DataGenerator.load_data": [[12, 45], ["list", "map", "dirs.append", "zip", "dirs.append", "zip", "data.DataGenerator.args.scale.split", "os.path.join", "os.path.join", "sorted", "data.DataGenerator.dataset.append", "os.path.join", "os.path.join", "data.DataGenerator.dataset.append", "int", "tmp.append", "sorted", "tmp.append", "imageio.imread", "imageio.imread", "os.listdir", "os.listdir"], "methods", ["None"], ["", "def", "load_data", "(", "self", ")", ":", "\n", "# initialze dataset", "\n", "        ", "self", ".", "dataset", "=", "[", "]", "\n", "# check scales used in an experiment ", "\n", "self", ".", "scale_list", "=", "list", "(", "map", "(", "lambda", "x", ":", "int", "(", "x", ")", ",", "self", ".", "args", ".", "scale", ".", "split", "(", "'+'", ")", ")", ")", "\n", "\n", "if", "self", ".", "args", ".", "is_test", ":", "\n", "            ", "dirs", "=", "[", "os", ".", "path", ".", "join", "(", "self", ".", "args", ".", "data_dir", ",", "\"LR\"", ",", "\"x%d\"", "%", "self", ".", "scale_list", "[", "0", "]", ",", "self", ".", "args", ".", "dataset_name", ")", "]", "\n", "dirs", ".", "append", "(", "os", ".", "path", ".", "join", "(", "self", ".", "args", ".", "data_dir", ",", "\"HR\"", ",", "self", ".", "args", ".", "dataset_name", ")", ")", "\n", "\n", "# The list of file_names for each directory ", "\n", "self", ".", "file_names_for_dirs", "=", "[", "sorted", "(", "[", "f", "for", "f", "in", "os", ".", "listdir", "(", "dir", ")", "if", "not", "f", "==", "'Thumbs.db'", "]", ")", "for", "dir", "in", "dirs", "]", "\n", "\n", "# Load data for LR ", "\n", "for", "dir", ",", "file_names", "in", "zip", "(", "dirs", ",", "self", ".", "file_names_for_dirs", ")", ":", "\n", "                ", "tmp", "=", "[", "]", "\n", "for", "file_name", "in", "file_names", ":", "\n", "                    ", "tmp", ".", "append", "(", "imageio", ".", "imread", "(", "dir", "+", "\"/\"", "+", "file_name", ",", "pilmode", "=", "\"RGB\"", ")", ")", "\n", "", "self", ".", "dataset", ".", "append", "(", "tmp", ")", "\n", "", "", "else", ":", "\n", "# directories for LR (for scale used) and HR (ex. [x2, x4, x8, HR])", "\n", "            ", "dirs", "=", "[", "os", ".", "path", ".", "join", "(", "self", ".", "args", ".", "data_dir", ",", "\"DIV2K_train_LR_bicubic/X%d\"", "%", "scale", ")", "for", "scale", "in", "self", ".", "scale_list", "]", "\n", "dirs", ".", "append", "(", "os", ".", "path", ".", "join", "(", "self", ".", "args", ".", "data_dir", ",", "\"DIV2K_train_HR\"", ")", ")", "\n", "\n", "# The list of file_names for each directory ", "\n", "self", ".", "file_names_for_dirs", "=", "[", "sorted", "(", "[", "f", "for", "f", "in", "os", ".", "listdir", "(", "dir", ")", "if", "not", "f", "==", "'Thumbs.db'", "]", ")", "[", ":", "self", ".", "args", ".", "num_train", "]", "for", "dir", "in", "dirs", "]", "\n", "\n", "# Load data for LR and HR (ex. self.dataset = [[x2_data], [x4_data], [x8_data], [HR_data]])", "\n", "for", "dir", ",", "file_names", "in", "zip", "(", "dirs", ",", "self", ".", "file_names_for_dirs", ")", ":", "\n", "                ", "tmp", "=", "[", "]", "\n", "for", "file_name", "in", "file_names", ":", "\n", "                    ", "tmp", ".", "append", "(", "imageio", ".", "imread", "(", "dir", "+", "\"/\"", "+", "file_name", ")", ")", "\n", "", "self", ".", "dataset", ".", "append", "(", "tmp", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.data.DataGenerator.get_batch": [[48, 86], ["range", "random.randrange", "random.randint", "random.randint", "random.randint", "numpy.rot90", "numpy.rot90", "in_batch.append", "tar_batch.append", "random.random", "numpy.fliplr", "numpy.fliplr"], "methods", ["None"], ["", "", "", "def", "get_batch", "(", "self", ",", "batch_size", ",", "idx_scale", ",", "in_patch_size", "=", "48", ")", ":", "\n", "# randomly selet scale", "\n", "        ", "scale", "=", "self", ".", "scale_list", "[", "idx_scale", "]", "\n", "\n", "# assgin target patch size", "\n", "tar_patch_size", "=", "in_patch_size", "*", "scale", "\n", "in_batch", "=", "[", "]", "\n", "tar_batch", "=", "[", "]", "\n", "for", "_", "in", "range", "(", "batch_size", ")", ":", "\n", "# select image", "\n", "            ", "idx_img", "=", "random", ".", "randrange", "(", "self", ".", "args", ".", "num_train", ")", "\n", "in_img", "=", "self", ".", "dataset", "[", "idx_scale", "]", "[", "idx_img", "]", "\n", "tar_img", "=", "self", ".", "dataset", "[", "-", "1", "]", "[", "idx_img", "]", "\n", "\n", "# random crop", "\n", "y", ",", "x", ",", "_", "=", "in_img", ".", "shape", "\n", "in_x", "=", "random", ".", "randint", "(", "0", ",", "x", "-", "in_patch_size", ")", "\n", "in_y", "=", "random", ".", "randint", "(", "0", ",", "y", "-", "in_patch_size", ")", "\n", "tar_x", "=", "in_x", "*", "scale", "\n", "tar_y", "=", "in_y", "*", "scale", "\n", "in_patch", "=", "in_img", "[", "in_y", ":", "in_y", "+", "in_patch_size", ",", "in_x", ":", "in_x", "+", "in_patch_size", "]", "\n", "tar_patch", "=", "tar_img", "[", "tar_y", ":", "tar_y", "+", "tar_patch_size", ",", "tar_x", ":", "tar_x", "+", "tar_patch_size", "]", "\n", "\n", "# random rotate", "\n", "rot_num", "=", "random", ".", "randint", "(", "1", ",", "4", ")", "\n", "in_patch", "=", "np", ".", "rot90", "(", "in_patch", ",", "rot_num", ")", "\n", "tar_patch", "=", "np", ".", "rot90", "(", "tar_patch", ",", "rot_num", ")", "\n", "\n", "# random flip left-to-right", "\n", "flipflag", "=", "random", ".", "random", "(", ")", ">", "0.5", "\n", "if", "flipflag", ":", "\n", "                ", "in_patch", "=", "np", ".", "fliplr", "(", "in_patch", ")", "\n", "tar_patch", "=", "np", ".", "fliplr", "(", "tar_patch", ")", "\n", "\n", "# construct mini-batch", "\n", "", "in_batch", ".", "append", "(", "in_patch", ")", "\n", "tar_batch", ".", "append", "(", "tar_patch", ")", "\n", "", "return", "in_batch", ",", "tar_batch", "\n", "", "", ""]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.create_dirs": [[5, 14], ["print", "exit", "os.path.exists", "os.makedirs"], "function", ["None"], ["def", "create_dirs", "(", "dirs", ")", ":", "\n", "    ", "try", ":", "\n", "        ", "for", "dir_", "in", "dirs", ":", "\n", "            ", "if", "not", "os", ".", "path", ".", "exists", "(", "dir_", ")", ":", "\n", "                ", "os", ".", "makedirs", "(", "dir_", ")", "\n", "", "", "return", "0", "\n", "", "except", "Exception", "as", "err", ":", "\n", "        ", "print", "(", "\"Creating directories error: {0}\"", ".", "format", "(", "err", ")", ")", "\n", "exit", "(", "-", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.quantize": [[15, 17], ["numpy.clip", "numpy.round"], "function", ["None"], ["", "", "def", "quantize", "(", "img", ",", "min_val", "=", "0", ",", "max_val", "=", "255", ")", ":", "\n", "    ", "return", "np", ".", "clip", "(", "np", ".", "round", "(", "img", ")", ",", "min_val", ",", "max_val", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.cal_psnr": [[18, 27], ["utils.quantize", "utils.quantize", "numpy.mean", "numpy.squeeze", "numpy.squeeze", "numpy.power", "numpy.log10"], "function", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.quantize", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.quantize"], ["", "def", "cal_psnr", "(", "out_img", ",", "tar_img", ",", "scale", ")", ":", "\n", "    ", "out_img", "=", "quantize", "(", "np", ".", "squeeze", "(", "out_img", ")", ")", "\n", "tar_img", "=", "quantize", "(", "np", ".", "squeeze", "(", "tar_img", ")", ")", "\n", "diff", "=", "out_img", "-", "tar_img", "\n", "shave", "=", "6", "+", "scale", "\n", "diff", "=", "diff", "[", "shave", ":", "-", "shave", ",", "shave", ":", "-", "shave", "]", "\n", "mse", "=", "np", ".", "mean", "(", "np", ".", "power", "(", "diff", ",", "2", ")", ")", "\n", "psnr", "=", "10.0", "*", "np", ".", "log10", "(", "255.0", "**", "2", "/", "mse", ")", "\n", "return", "psnr", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.save_img": [[28, 31], ["numpy.uint8", "imageio.imwrite", "utils.quantize", "numpy.squeeze"], "function", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.quantize"], ["", "def", "save_img", "(", "img", ",", "dir", ")", ":", "\n", "    ", "img", "=", "np", ".", "uint8", "(", "quantize", "(", "np", ".", "squeeze", "(", "img", ")", ")", ")", "\n", "imageio", ".", "imwrite", "(", "dir", ",", "img", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.mod_crop": [[32, 36], ["numpy.mod", "numpy.mod"], "function", ["None"], ["", "def", "mod_crop", "(", "img", ",", "scale", ")", ":", "\n", "    ", "h", ",", "w", ",", "c", "=", "img", ".", "shape", "\n", "img", "=", "img", "[", "0", ":", "h", "-", "np", ".", "mod", "(", "h", ",", "scale", ")", ",", "0", ":", "w", "-", "np", ".", "mod", "(", "w", ",", "scale", ")", "]", "\n", "return", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.code.utils.chop_forward": [[37, 59], ["print", "numpy.zeros", "sess.run", "sess.run", "sess.run", "sess.run"], "function", ["None"], ["", "def", "chop_forward", "(", "x", ",", "sess", ",", "model", ",", "scale", ",", "shave", "=", "10", ")", ":", "\n", "    ", "print", "(", "\"predicting...\"", ")", "\n", "h", ",", "w", ",", "c", "=", "x", ".", "shape", "\n", "h_half", ",", "w_half", "=", "h", "//", "2", ",", "w", "//", "2", "\n", "h_size", ",", "w_size", "=", "h_half", "+", "shave", ",", "w_half", "+", "shave", "\n", "input1", "=", "x", "[", "0", ":", "h_size", ",", "0", ":", "w_size", "]", "\n", "input2", "=", "x", "[", "0", ":", "h_size", ",", "(", "w", "-", "w_size", ")", ":", "w", "]", "\n", "input3", "=", "x", "[", "(", "h", "-", "h_size", ")", ":", "h", ",", "0", ":", "w_size", "]", "\n", "input4", "=", "x", "[", "(", "h", "-", "h_size", ")", ":", "h", ",", "(", "w", "-", "w_size", ")", ":", "w", "]", "\n", "tmp1", "=", "sess", ".", "run", "(", "model", ".", "output", ",", "feed_dict", "=", "{", "model", ".", "input", ":", "[", "input1", "]", "}", ")", "[", "0", "]", "\n", "tmp2", "=", "sess", ".", "run", "(", "model", ".", "output", ",", "feed_dict", "=", "{", "model", ".", "input", ":", "[", "input2", "]", "}", ")", "[", "0", "]", "\n", "tmp3", "=", "sess", ".", "run", "(", "model", ".", "output", ",", "feed_dict", "=", "{", "model", ".", "input", ":", "[", "input3", "]", "}", ")", "[", "0", "]", "\n", "tmp4", "=", "sess", ".", "run", "(", "model", ".", "output", ",", "feed_dict", "=", "{", "model", ".", "input", ":", "[", "input4", "]", "}", ")", "[", "0", "]", "\n", "tmp_image", "=", "np", ".", "zeros", "(", "[", "x", ".", "shape", "[", "0", "]", "*", "scale", ",", "x", ".", "shape", "[", "1", "]", "*", "scale", ",", "3", "]", ")", "\n", "h", ",", "w", "=", "h", "*", "scale", ",", "w", "*", "scale", "\n", "h_half", ",", "w_half", "=", "h_half", "*", "scale", ",", "w_half", "*", "scale", "\n", "h_size", ",", "w_size", "=", "h_size", "*", "scale", ",", "w_size", "*", "scale", "\n", "tmp_image", "[", "0", ":", "h_half", ",", "0", ":", "w_half", "]", "=", "tmp1", "[", "0", ":", "h_half", ",", "0", ":", "w_half", "]", "\n", "tmp_image", "[", "0", ":", "h_half", ",", "w_half", ":", "]", "=", "tmp2", "[", "0", ":", "h_half", ",", "(", "w_size", "-", "w", "+", "w_half", ")", ":", "w_size", "]", "\n", "tmp_image", "[", "h_half", ":", ",", "0", ":", "w_half", "]", "=", "tmp3", "[", "(", "h_size", "-", "h", "+", "h_half", ")", ":", "h_size", ",", "0", ":", "w_half", "]", "\n", "tmp_image", "[", "h_half", ":", ",", "w_half", ":", "]", "=", "tmp4", "[", "(", "h_size", "-", "h", "+", "h_half", ")", ":", "h_size", ",", "(", "w_size", "-", "w", "+", "w_half", ")", ":", "w_size", "]", "\n", "return", "tmp_image", "", "", ""]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.MAMNet.MAMNet.__init__": [[8, 15], ["model.base_model.BaseModel.__init__", "MAMNet.MAMNet.build_model", "MAMNet.MAMNet.init_saver", "MAMNet.MAMNet.count_num_trainable_params", "print", "print"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.__init__", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.MAMNet.MAMNet.build_model", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.init_saver", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.count_num_trainable_params"], ["\t", "def", "__init__", "(", "self", ",", "args", ")", ":", "\n", "\t\t", "super", "(", "MAMNet", ",", "self", ")", ".", "__init__", "(", "args", ")", "\n", "self", ".", "build_model", "(", ")", "\n", "self", ".", "init_saver", "(", ")", "\n", "num_params", "=", "self", ".", "count_num_trainable_params", "(", ")", "\n", "print", "(", "\"num_params: %d\"", "%", "num_params", ")", "\n", "print", "(", "\"MAMNet and Saver are initialized!\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.MAMNet.MAMNet.build_model": [[16, 56], ["mean_shift", "conv_xavier", "res_module", "scale_specific_upsampler", "mean_shift", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "int", "tensorflow.image.resize_bicubic", "tensorflow.image.resize_bicubic", "tensorflow.name_scope", "tensorflow.reduce_mean", "tensorflow.train.exponential_decay", "tensorflow.train.AdamOptimizer().minimize", "tensorflow.losses.absolute_difference", "int", "int", "tensorflow.train.AdamOptimizer", "int", "int", "nit", "int", "tensorflow.shape", "tensorflow.shape"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.mean_shift", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv_xavier", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.res_module", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.scale_specific_upsampler", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.mean_shift"], ["", "def", "build_model", "(", "self", ")", ":", "\n", "# Initialization", "\n", "\t\t", "num_feats", "=", "self", ".", "args", ".", "num_feats", "\n", "num_res", "=", "self", ".", "args", ".", "num_res", "\n", "mean_shift", "=", "self", ".", "mean_shift", "\n", "conv_xavier", "=", "self", ".", "conv_xavier", "\n", "res_module", "=", "self", ".", "res_module", "\n", "scale_specific_upsampler", "=", "self", ".", "scale_specific_upsampler", "\n", "\n", "# Placeholder for input, target, and flag_scale", "\n", "if", "self", ".", "args", ".", "is_test", ":", "\n", "\t\t\t", "self", ".", "input", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "1", ",", "None", ",", "None", ",", "3", "]", ")", "\n", "", "else", ":", "\n", "\t\t\t", "self", ".", "input", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "self", ".", "args", ".", "num_batch", ",", "self", ".", "args", ".", "patch_size", ",", "self", ".", "args", ".", "patch_size", ",", "3", "]", ")", "\n", "self", ".", "target", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "self", ".", "args", ".", "num_batch", ",", "self", ".", "args", ".", "patch_size", "*", "int", "(", "self", ".", "args", ".", "scale", ")", ",", "self", ".", "args", ".", "patch_size", "*", "int", "(", "self", ".", "args", ".", "scale", ")", ",", "3", "]", ")", "\n", "\n", "# Pre-processing", "\n", "", "in_img", "=", "mean_shift", "(", "self", ".", "input", ")", "\n", "\n", "# First convolution layer ", "\n", "x", "=", "conv_xavier", "(", "in_img", ",", "num_feats", ",", "[", "3", ",", "3", "]", ")", "\n", "x", "=", "res_module", "(", "x", ",", "num_feats", ",", "num_res", ")", "\n", "x", "=", "scale_specific_upsampler", "(", "x", ",", "int", "(", "self", ".", "args", ".", "scale", ")", ")", "\n", "\n", "# Post-processing", "\n", "self", ".", "output", "=", "mean_shift", "(", "x", ",", "is_add", "=", "True", ")", "\n", "\n", "# add bicubic upsampled", "\n", "if", "self", ".", "args", ".", "is_bicubic_upsampled", ":", "\n", "\t\t\t", "if", "self", ".", "args", ".", "is_test", ":", "\n", "\t\t\t\t", "self", ".", "output", "+=", "tf", ".", "image", ".", "resize_bicubic", "(", "self", ".", "input", ",", "[", "tf", ".", "shape", "(", "self", ".", "input", ")", "[", "1", "]", "*", "int", "(", "self", ".", "args", ".", "scale", ")", ",", "tf", ".", "shape", "(", "self", ".", "input", ")", "[", "2", "]", "*", "int", "(", "self", ".", "args", ".", "scale", ")", "]", ")", "\n", "", "else", ":", "\n", "\t\t\t\t", "self", ".", "output", "+=", "tf", ".", "image", ".", "resize_bicubic", "(", "self", ".", "input", ",", "[", "self", ".", "args", ".", "patch_size", "*", "nit", "(", "self", ".", "args", ".", "scale", ")", ",", "self", ".", "args", ".", "patch_size", "*", "int", "(", "self", ".", "args", ".", "scale", ")", "]", ")", "\n", "\n", "", "", "if", "self", ".", "args", ".", "is_train", ":", "\n", "# Loss & Training options", "\n", "\t\t\t", "with", "tf", ".", "name_scope", "(", "\"loss\"", ")", ":", "\n", "\t\t\t\t", "self", ".", "loss", "=", "tf", ".", "reduce_mean", "(", "tf", ".", "losses", ".", "absolute_difference", "(", "self", ".", "target", ",", "self", ".", "output", ")", ")", "\n", "self", ".", "learning_rate", "=", "tf", ".", "train", ".", "exponential_decay", "(", "self", ".", "args", ".", "init_lr", ",", "self", ".", "global_step", ",", "self", ".", "args", ".", "decay_step", ",", "self", ".", "args", ".", "decay_ratio", ",", "staircase", "=", "True", ")", "\n", "self", ".", "train_op", "=", "tf", ".", "train", ".", "AdamOptimizer", "(", "self", ".", "learning_rate", ")", ".", "minimize", "(", "self", ".", "loss", ",", "global_step", "=", "self", ".", "global_step", ")", "\n", "", "", "", "", ""]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.MAMNet.create_model": [[4, 6], ["MAMNet.MAMNet"], "function", ["None"], ["def", "create_model", "(", "args", ",", "parent", "=", "False", ")", ":", "\n", "    ", "return", "MAMNet", "(", "args", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.__init__": [[5, 9], ["base_model.BaseModel.init_global_step", "os.path.join"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.init_global_step"], ["    ", "def", "__init__", "(", "self", ",", "args", ")", ":", "\n", "        ", "self", ".", "args", "=", "args", "\n", "self", ".", "init_global_step", "(", ")", "\n", "self", ".", "ckpt_dir", "=", "os", ".", "path", ".", "join", "(", "self", ".", "args", ".", "exp_dir", ",", "self", ".", "args", ".", "exp_name", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv": [[10, 17], ["tensorflow.layers.conv2d", "list", "tensorflow.contrib.layers.variance_scaling_initializer", "map", "tensorflow.contrib.layers.variance_scaling_initializer", "base_model.BaseModel.args.scale.split", "int"], "methods", ["None"], ["", "def", "conv", "(", "self", ",", "x", ",", "num_feats", ",", "kernel_size", "=", "[", "3", ",", "3", "]", ",", "strides", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "'same'", ",", "activation", "=", "None", ",", "kernel_initializer", "=", "None", ")", ":", "\n", "        ", "if", "self", ".", "args", ".", "is_init_res", ":", "\n", "            ", "scale_list", "=", "list", "(", "map", "(", "lambda", "x", ":", "int", "(", "x", ")", ",", "self", ".", "args", ".", "scale", ".", "split", "(", "'+'", ")", ")", ")", "\n", "kernel_initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "variance_scaling_initializer", "(", "factor", "=", "0.0001", "/", "self", ".", "args", ".", "num_res", ",", "mode", "=", "\"FAN_IN\"", ",", "uniform", "=", "False", ")", "\n", "", "elif", "self", ".", "args", ".", "is_init_he", ":", "\n", "            ", "kernel_initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "variance_scaling_initializer", "(", ")", "\n", "", "return", "tf", ".", "layers", ".", "conv2d", "(", "x", ",", "num_feats", ",", "kernel_size", ",", "strides", "=", "strides", ",", "padding", "=", "padding", ",", "activation", "=", "activation", ",", "kernel_initializer", "=", "kernel_initializer", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv_xavier": [[18, 20], ["tensorflow.layers.conv2d"], "methods", ["None"], ["", "def", "conv_xavier", "(", "self", ",", "x", ",", "num_feats", ",", "kernel_size", ",", "padding", "=", "'same'", ",", "activation", "=", "None", ")", ":", "\n", "        ", "return", "tf", ".", "layers", ".", "conv2d", "(", "x", ",", "num_feats", ",", "kernel_size", ",", "padding", "=", "padding", ",", "activation", "=", "activation", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv_he": [[21, 23], ["tensorflow.layers.conv2d", "tensorflow.contrib.layers.variance_scaling_initializer"], "methods", ["None"], ["", "def", "conv_he", "(", "self", ",", "x", ",", "num_feats", ",", "kernel_size", ",", "padding", "=", "'same'", ",", "activation", "=", "None", ")", ":", "\n", "        ", "return", "tf", ".", "layers", ".", "conv2d", "(", "x", ",", "num_feats", ",", "kernel_size", ",", "padding", "=", "padding", ",", "activation", "=", "activation", ",", "kernel_initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "variance_scaling_initializer", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.mam": [[24, 52], ["tensorflow.sigmoid", "tensorflow.nn.moments", "tensorflow.nn.moments", "tensorflow.variable_scope", "tensorflow.variable_scope", "tensorflow.layers.dense", "tensorflow.layers.dense", "tensorflow.variable_scope", "tensorflow.get_variable", "tensorflow.get_variable", "tensorflow.sqrt", "tensorflow.nn.depthwise_conv2d", "tensorflow.contrib.layers.variance_scaling_initializer", "tensorflow.contrib.layers.xavier_initializer"], "methods", ["None"], ["", "def", "mam", "(", "self", ",", "x", ",", "num_feats", ",", "ratio", "=", "16", ")", ":", "\n", "        ", "modulation_map_CSI", "=", "0.0", "\n", "modulation_map_ICD", "=", "0.0", "\n", "modulation_map_CSD", "=", "0.0", "\n", "\n", "if", "self", ".", "args", ".", "is_CSI", "or", "self", ".", "args", ".", "is_ICD", ":", "\n", "            ", "_", ",", "tmp_var", "=", "tf", ".", "nn", ".", "moments", "(", "x", ",", "axes", "=", "[", "1", ",", "2", "]", ",", "keep_dims", "=", "True", ")", "\n", "if", "self", ".", "args", ".", "is_std_norm", ":", "\n", "                ", "mean_var", ",", "var_var", "=", "tf", ".", "nn", ".", "moments", "(", "tmp_var", ",", "axes", "=", "-", "1", ",", "keep_dims", "=", "True", ")", "\n", "tmp_var", "=", "(", "tmp_var", "-", "mean_var", ")", "/", "tf", ".", "sqrt", "(", "var_var", "+", "1e-5", ")", "\n", "\n", "", "", "if", "self", ".", "args", ".", "is_CSI", ":", "\n", "            ", "with", "tf", ".", "variable_scope", "(", "'CSI'", ")", ":", "\n", "                ", "modulation_map_CSI", "=", "tmp_var", "\n", "\n", "", "", "if", "self", ".", "args", ".", "is_ICD", ":", "\n", "            ", "with", "tf", ".", "variable_scope", "(", "'ICD'", ")", ":", "\n", "                ", "tmp", "=", "tf", ".", "layers", ".", "dense", "(", "tmp_var", ",", "num_feats", "//", "ratio", ",", "activation", "=", "tf", ".", "nn", ".", "relu", ",", "kernel_initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "variance_scaling_initializer", "(", ")", ")", "\n", "modulation_map_ICD", "=", "tf", ".", "layers", ".", "dense", "(", "tmp", ",", "num_feats", ")", "\n", "\n", "", "", "if", "self", ".", "args", ".", "is_CSD", ":", "\n", "            ", "with", "tf", ".", "variable_scope", "(", "'CSD'", ")", ":", "\n", "                ", "W", "=", "tf", ".", "get_variable", "(", "\"W\"", ",", "shape", "=", "[", "3", ",", "3", ",", "num_feats", ",", "1", "]", ",", "initializer", "=", "tf", ".", "contrib", ".", "layers", ".", "xavier_initializer", "(", ")", ")", "\n", "b", "=", "tf", ".", "get_variable", "(", "\"b\"", ",", "shape", "=", "[", "num_feats", "]", ",", "initializer", "=", "tf", ".", "zeros_initializer", ")", "\n", "modulation_map_CSD", "=", "tf", ".", "nn", ".", "depthwise_conv2d", "(", "x", ",", "filter", "=", "W", ",", "strides", "=", "[", "1", ",", "1", ",", "1", ",", "1", "]", ",", "padding", "=", "'SAME'", ")", "+", "b", "\n", "\n", "", "", "modulation_map", "=", "tf", ".", "sigmoid", "(", "modulation_map_CSI", "+", "modulation_map_ICD", "+", "modulation_map_CSD", ")", "\n", "return", "modulation_map", "*", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.res_block": [[53, 60], ["tensorflow.variable_scope", "base_model.BaseModel.conv", "base_model.BaseModel.conv", "base_model.BaseModel.mam"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.mam"], ["", "def", "res_block", "(", "self", ",", "x", ",", "num_feats", ",", "kernel_size", ",", "name", "=", "'RB'", ")", ":", "\n", "        ", "with", "tf", ".", "variable_scope", "(", "name", ")", ":", "\n", "            ", "tmp", "=", "self", ".", "conv", "(", "x", ",", "num_feats", ",", "kernel_size", ",", "activation", "=", "tf", ".", "nn", ".", "relu", ")", "\n", "tmp", "=", "self", ".", "conv", "(", "tmp", ",", "num_feats", ",", "kernel_size", ")", "\n", "if", "self", ".", "args", ".", "is_MAM", ":", "\n", "                ", "tmp", "=", "self", ".", "mam", "(", "tmp", ",", "num_feats", ")", "\n", "", "", "return", "x", "+", "tmp", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.res_module": [[61, 68], ["tensorflow.variable_scope", "range", "base_model.BaseModel.conv", "base_model.BaseModel.res_block", "str"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.res_block"], ["", "def", "res_module", "(", "self", ",", "x", ",", "num_feats", ",", "num_res", ",", "name", "=", "'RM'", ")", ":", "\n", "        ", "with", "tf", ".", "variable_scope", "(", "name", ")", ":", "\n", "            ", "before_res", "=", "x", "\n", "for", "_", "in", "range", "(", "num_res", ")", ":", "\n", "                ", "x", "=", "self", ".", "res_block", "(", "x", ",", "num_feats", ",", "[", "3", ",", "3", "]", ",", "name", "=", "'RB'", "+", "str", "(", "_", ")", ")", "\n", "", "x", "=", "self", ".", "conv", "(", "x", ",", "num_feats", ",", "[", "3", ",", "3", "]", ")", "\n", "", "return", "before_res", "+", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.mean_shift": [[69, 77], ["None"], "methods", ["None"], ["", "def", "mean_shift", "(", "self", ",", "x", ",", "is_add", "=", "False", ")", ":", "\n", "        ", "mean_vec", "=", "[", "0.4488", ",", "0.4371", ",", "0.4040", "]", "\n", "mean_vec", "=", "[", "x", "*", "255", "for", "x", "in", "mean_vec", "]", "\n", "if", "is_add", ":", "\n", "            ", "x", "=", "x", "+", "mean_vec", "\n", "", "else", ":", "\n", "            ", "x", "=", "x", "-", "mean_vec", "\n", "", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.scale_specific_upsampler": [[78, 82], ["base_model.BaseModel.upsampler", "base_model.BaseModel.conv_xavier"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.upsampler", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv_xavier"], ["", "def", "scale_specific_upsampler", "(", "self", ",", "x", ",", "scale", ")", ":", "\n", "        ", "x", "=", "self", ".", "upsampler", "(", "x", ",", "scale", ")", "\n", "x", "=", "self", ".", "conv_xavier", "(", "x", ",", "self", ".", "args", ".", "num_channels", ",", "[", "3", ",", "3", "]", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.upsampler": [[84, 97], ["tensorflow.variable_scope", "range", "str", "int", "base_model.BaseModel.conv_xavier", "tensorflow.depth_to_space", "base_model.BaseModel.conv_xavier", "tensorflow.depth_to_space", "math.log"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv_xavier", "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.conv_xavier"], ["", "def", "upsampler", "(", "self", ",", "x", ",", "scale", ")", ":", "\n", "        ", "with", "tf", ".", "variable_scope", "(", "'upsampler'", "+", "str", "(", "scale", ")", ")", ":", "\n", "            ", "if", "(", "scale", "&", "(", "scale", "-", "1", ")", ")", "==", "0", ":", "\n", "                ", "for", "_", "in", "range", "(", "int", "(", "math", ".", "log", "(", "scale", ",", "2", ")", ")", ")", ":", "\n", "                    ", "x", "=", "self", ".", "conv_xavier", "(", "x", ",", "self", ".", "args", ".", "num_feats", "*", "4", ",", "[", "3", ",", "3", "]", ")", "\n", "x", "=", "tf", ".", "depth_to_space", "(", "x", ",", "2", ")", "\n", "", "return", "x", "\n", "", "elif", "scale", "==", "3", ":", "\n", "                ", "x", "=", "self", ".", "conv_xavier", "(", "x", ",", "self", ".", "args", ".", "num_feats", "*", "9", ",", "[", "3", ",", "3", "]", ")", "\n", "x", "=", "tf", ".", "depth_to_space", "(", "x", ",", "3", ")", "\n", "return", "x", "\n", "", "else", ":", "\n", "                ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.save": [[99, 103], ["print", "base_model.BaseModel.saver.save", "print"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.save"], ["", "", "", "def", "save", "(", "self", ",", "sess", ")", ":", "\n", "        ", "print", "(", "\"Saving model...\"", ")", "\n", "self", ".", "saver", ".", "save", "(", "sess", ",", "self", ".", "ckpt_dir", "+", "\"/model.ckpt\"", ",", "self", ".", "global_step", ")", "\n", "print", "(", "\"Model saved\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.load": [[105, 114], ["tensorflow.train.latest_checkpoint", "print", "base_model.BaseModel.saver.restore", "print"], "methods", ["None"], ["", "def", "load", "(", "self", ",", "sess", ")", ":", "\n", "        ", "latest_checkpoint", "=", "tf", ".", "train", ".", "latest_checkpoint", "(", "self", ".", "ckpt_dir", ")", "\n", "if", "self", ".", "args", ".", "ckpt_name", ":", "\n", "            ", "self", ".", "ckpt", "=", "self", ".", "ckpt_dir", "+", "\"/\"", "+", "self", ".", "args", ".", "ckpt_name", "\n", "", "else", ":", "\n", "            ", "self", ".", "ckpt", "=", "latest_checkpoint", "\n", "", "print", "(", "\"Loading model checkpoint {} ...\\n\"", ".", "format", "(", "self", ".", "ckpt", ")", ")", "\n", "self", ".", "saver", ".", "restore", "(", "sess", ",", "self", ".", "ckpt", ")", "\n", "print", "(", "\"Model loaded\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.init_global_step": [[116, 119], ["tensorflow.variable_scope", "tensorflow.Variable"], "methods", ["None"], ["", "def", "init_global_step", "(", "self", ")", ":", "\n", "        ", "with", "tf", ".", "variable_scope", "(", "'global_step'", ")", ":", "\n", "            ", "self", ".", "global_step", "=", "tf", ".", "Variable", "(", "0", ",", "trainable", "=", "False", ",", "name", "=", "'global_step'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.init_saver": [[120, 122], ["tensorflow.train.Saver"], "methods", ["None"], ["", "", "def", "init_saver", "(", "self", ")", ":", "\n", "        ", "self", ".", "saver", "=", "tf", ".", "train", ".", "Saver", "(", "max_to_keep", "=", "self", ".", "args", ".", "max_to_keep", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.count_num_trainable_params": [[123, 130], ["tensorflow.trainable_variables", "trainable_variable.get_shape", "base_model.BaseModel.get_num_params_shape"], "methods", ["home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.get_num_params_shape"], ["", "def", "count_num_trainable_params", "(", "self", ")", ":", "\n", "        ", "tot_nb_params", "=", "0", "\n", "for", "trainable_variable", "in", "tf", ".", "trainable_variables", "(", ")", ":", "\n", "            ", "shape", "=", "trainable_variable", ".", "get_shape", "(", ")", "# e.g [D,F] or [W,H,C]", "\n", "current_nb_params", "=", "self", ".", "get_num_params_shape", "(", "shape", ")", "\n", "tot_nb_params", "=", "tot_nb_params", "+", "current_nb_params", "\n", "", "return", "tot_nb_params", "\n", "\n"]], "home.repos.pwc.inspect_result.junhyukk_MAMNet-Tensorflow.model.base_model.BaseModel.get_num_params_shape": [[131, 136], ["int"], "methods", ["None"], ["", "def", "get_num_params_shape", "(", "self", ",", "shape", ")", ":", "\n", "        ", "nb_params", "=", "1", "\n", "for", "dim", "in", "shape", ":", "\n", "            ", "nb_params", "=", "nb_params", "*", "int", "(", "dim", ")", "\n", "", "return", "nb_params", "", "", "", ""]]}