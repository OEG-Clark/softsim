{"home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.None.train.main": [[9, 25], ["train.parse_args", "getattr", "isegm.utils.exp.init_experiment", "torch.multiprocessing.set_sharing_strategy", "load_module.main", "train.load_module", "train.load_module"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.init_experiment", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.main", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.None.train.load_module", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.None.train.load_module"], ["def", "main", "(", ")", ":", "\n", "    ", "args", "=", "parse_args", "(", ")", "\n", "if", "args", ".", "temp_model_path", ":", "\n", "        ", "model_script", "=", "load_module", "(", "args", ".", "temp_model_path", ")", "\n", "", "else", ":", "\n", "        ", "model_script", "=", "load_module", "(", "args", ".", "model_path", ")", "\n", "\n", "", "model_base_name", "=", "getattr", "(", "model_script", ",", "'MODEL_NAME'", ",", "None", ")", "\n", "\n", "args", ".", "distributed", "=", "'WORLD_SIZE'", "in", "os", ".", "environ", "\n", "cfg", "=", "init_experiment", "(", "args", ",", "model_base_name", ")", "\n", "\n", "torch", ".", "backends", ".", "cudnn", ".", "benchmark", "=", "True", "\n", "torch", ".", "multiprocessing", ".", "set_sharing_strategy", "(", "'file_system'", ")", "\n", "\n", "model_script", ".", "main", "(", "cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.None.train.parse_args": [[27, 71], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args"], ["", "def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'model_path'", ",", "type", "=", "str", ",", "\n", "help", "=", "'Path to the model script.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--exp-name'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "\n", "help", "=", "'Here you can specify the name of the experiment. '", "\n", "'It will be added as a suffix to the experiment folder.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--workers'", ",", "type", "=", "int", ",", "default", "=", "4", ",", "\n", "metavar", "=", "'N'", ",", "help", "=", "'Dataloader threads.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--batch-size'", ",", "type", "=", "int", ",", "default", "=", "-", "1", ",", "\n", "help", "=", "'You can override model batch size by specify positive number.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--ngpus'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "\n", "help", "=", "'Number of GPUs. '", "\n", "'If you only specify \"--gpus\" argument, the ngpus value will be calculated automatically. '", "\n", "'You should use either this argument or \"--gpus\".'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--gpus'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "required", "=", "False", ",", "\n", "help", "=", "'Ids of used GPUs. You should use either this argument or \"--ngpus\".'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--resume-exp'", ",", "type", "=", "str", ",", "default", "=", "None", ",", "\n", "help", "=", "'The prefix of the name of the experiment to be continued. '", "\n", "'If you use this field, you must specify the \"--resume-prefix\" argument.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--resume-prefix'", ",", "type", "=", "str", ",", "default", "=", "'latest'", ",", "\n", "help", "=", "'The prefix of the name of the checkpoint to be loaded.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--start-epoch'", ",", "type", "=", "int", ",", "default", "=", "0", ",", "\n", "help", "=", "'The number of the starting epoch from which training will continue. '", "\n", "'(it is important for correct logging and learning rate)'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--weights'", ",", "type", "=", "str", ",", "default", "=", "None", ",", "\n", "help", "=", "'Model weights will be loaded from the specified path if you use this argument.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--temp-model-path'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "\n", "help", "=", "'Do not use this argument (for internal purposes).'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "\"--local_rank\"", ",", "type", "=", "int", ",", "default", "=", "0", ")", "\n", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.None.train.load_module": [[73, 79], ["importlib.util.spec_from_file_location", "importlib.util.module_from_spec", "importlib.util.spec_from_file_location.loader.exec_module"], "function", ["None"], ["", "def", "load_module", "(", "script_path", ")", ":", "\n", "    ", "spec", "=", "importlib", ".", "util", ".", "spec_from_file_location", "(", "\"model_script\"", ",", "script_path", ")", "\n", "model_script", "=", "importlib", ".", "util", ".", "module_from_spec", "(", "spec", ")", "\n", "spec", ".", "loader", ".", "exec_module", "(", "model_script", ")", "\n", "\n", "return", "model_script", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.init_experiment": [[16, 102], ["pathlib.Path", "exp.get_model_family_tree", "exp.load_config", "exp.update_config", "pathlib.Path", "exp_parent_path.mkdir", "distributed.synchronize", "len", "print", "sys.exit", "torch.distributed.init_process_group", "exp.find_resume_exp", "exp.find_last_exp_indx", "distributed.synchronize", "load_config.LOGS_PATH.mkdir", "load_config.CHECKPOINTS_PATH.mkdir", "load_config.VIS_PATH.mkdir", "list", "torch.device", "torch.cuda.set_device", "torch.device", "log.add_logging", "log.logger.info", "log.logger.info", "log.logger.info", "torch.multiprocessing.set_start_method", "find_resume_exp.mkdir", "shutil.copy", "os.remove", "shutil.copy", "int", "range", "torch.cuda.device_count", "log.logger.info", "pprint.pformat", "datetime.datetime.strftime", "load_config.gpus.split", "max", "str", "datetime.datetime.today", "distributed.get_world_size"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.get_model_family_tree", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.update_config", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.synchronize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.find_resume_exp", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.find_last_exp_indx", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.synchronize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.add_logging", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_world_size"], ["def", "init_experiment", "(", "args", ",", "model_name", ")", ":", "\n", "    ", "model_path", "=", "Path", "(", "args", ".", "model_path", ")", "\n", "ftree", "=", "get_model_family_tree", "(", "model_path", ",", "model_name", "=", "model_name", ")", "\n", "\n", "if", "ftree", "is", "None", ":", "\n", "        ", "print", "(", "'Models can only be located in the \"models\" directory in the root of the repository'", ")", "\n", "sys", ".", "exit", "(", "1", ")", "\n", "\n", "", "cfg", "=", "load_config", "(", "model_path", ")", "\n", "update_config", "(", "cfg", ",", "args", ")", "\n", "\n", "cfg", ".", "distributed", "=", "args", ".", "distributed", "\n", "cfg", ".", "local_rank", "=", "args", ".", "local_rank", "\n", "if", "cfg", ".", "distributed", ":", "\n", "        ", "torch", ".", "distributed", ".", "init_process_group", "(", "backend", "=", "'nccl'", ",", "init_method", "=", "'env://'", ")", "\n", "if", "args", ".", "workers", ">", "0", ":", "\n", "            ", "torch", ".", "multiprocessing", ".", "set_start_method", "(", "'forkserver'", ",", "force", "=", "True", ")", "\n", "\n", "", "", "experiments_path", "=", "Path", "(", "cfg", ".", "EXPS_PATH", ")", "\n", "exp_parent_path", "=", "experiments_path", "/", "'/'", ".", "join", "(", "ftree", ")", "\n", "exp_parent_path", ".", "mkdir", "(", "parents", "=", "True", ",", "exist_ok", "=", "True", ")", "\n", "\n", "if", "cfg", ".", "resume_exp", ":", "\n", "        ", "exp_path", "=", "find_resume_exp", "(", "exp_parent_path", ",", "cfg", ".", "resume_exp", ")", "\n", "", "else", ":", "\n", "        ", "last_exp_indx", "=", "find_last_exp_indx", "(", "exp_parent_path", ")", "\n", "exp_name", "=", "f'{last_exp_indx:03d}'", "\n", "if", "cfg", ".", "exp_name", ":", "\n", "            ", "exp_name", "+=", "'_'", "+", "cfg", ".", "exp_name", "\n", "", "exp_path", "=", "exp_parent_path", "/", "exp_name", "\n", "synchronize", "(", ")", "\n", "if", "cfg", ".", "local_rank", "==", "0", ":", "\n", "            ", "exp_path", ".", "mkdir", "(", "parents", "=", "True", ")", "\n", "\n", "", "", "cfg", ".", "EXP_PATH", "=", "exp_path", "\n", "cfg", ".", "CHECKPOINTS_PATH", "=", "exp_path", "/", "'checkpoints'", "\n", "cfg", ".", "VIS_PATH", "=", "exp_path", "/", "'vis'", "\n", "cfg", ".", "LOGS_PATH", "=", "exp_path", "/", "'logs'", "\n", "\n", "if", "cfg", ".", "local_rank", "==", "0", ":", "\n", "        ", "cfg", ".", "LOGS_PATH", ".", "mkdir", "(", "exist_ok", "=", "True", ")", "\n", "cfg", ".", "CHECKPOINTS_PATH", ".", "mkdir", "(", "exist_ok", "=", "True", ")", "\n", "cfg", ".", "VIS_PATH", ".", "mkdir", "(", "exist_ok", "=", "True", ")", "\n", "\n", "dst_script_path", "=", "exp_path", "/", "(", "model_path", ".", "stem", "+", "datetime", ".", "strftime", "(", "datetime", ".", "today", "(", ")", ",", "'_%Y-%m-%d-%H-%M-%S.py'", ")", ")", "\n", "if", "args", ".", "temp_model_path", ":", "\n", "            ", "shutil", ".", "copy", "(", "args", ".", "temp_model_path", ",", "dst_script_path", ")", "\n", "os", ".", "remove", "(", "args", ".", "temp_model_path", ")", "\n", "", "else", ":", "\n", "            ", "shutil", ".", "copy", "(", "model_path", ",", "dst_script_path", ")", "\n", "\n", "", "", "synchronize", "(", ")", "\n", "\n", "if", "cfg", ".", "gpus", "!=", "''", ":", "\n", "        ", "gpu_ids", "=", "[", "int", "(", "id", ")", "for", "id", "in", "cfg", ".", "gpus", ".", "split", "(", "','", ")", "]", "\n", "", "else", ":", "\n", "        ", "gpu_ids", "=", "list", "(", "range", "(", "max", "(", "cfg", ".", "ngpus", ",", "get_world_size", "(", ")", ")", ")", ")", "\n", "cfg", ".", "gpus", "=", "','", ".", "join", "(", "[", "str", "(", "id", ")", "for", "id", "in", "gpu_ids", "]", ")", "\n", "\n", "", "cfg", ".", "gpu_ids", "=", "gpu_ids", "\n", "cfg", ".", "ngpus", "=", "len", "(", "gpu_ids", ")", "\n", "cfg", ".", "multi_gpu", "=", "cfg", ".", "ngpus", ">", "1", "\n", "\n", "if", "cfg", ".", "distributed", ":", "\n", "        ", "cfg", ".", "device", "=", "torch", ".", "device", "(", "'cuda'", ")", "\n", "cfg", ".", "gpu_ids", "=", "[", "cfg", ".", "gpu_ids", "[", "cfg", ".", "local_rank", "]", "]", "\n", "torch", ".", "cuda", ".", "set_device", "(", "cfg", ".", "gpu_ids", "[", "0", "]", ")", "\n", "", "else", ":", "\n", "        ", "if", "cfg", ".", "multi_gpu", ":", "\n", "            ", "os", ".", "environ", "[", "'CUDA_VISIBLE_DEVICES'", "]", "=", "cfg", ".", "gpus", "\n", "ngpus", "=", "torch", ".", "cuda", ".", "device_count", "(", ")", "\n", "# Added by Xavier", "\n", "# cfg.gpu_ids = [i for i in range(ngpus)]", "\n", "# assert ngpus == cfg.ngpus", "\n", "", "cfg", ".", "device", "=", "torch", ".", "device", "(", "f'cuda:{cfg.gpu_ids[0]}'", ")", "\n", "\n", "", "if", "cfg", ".", "local_rank", "==", "0", ":", "\n", "        ", "add_logging", "(", "cfg", ".", "LOGS_PATH", ",", "prefix", "=", "'train_'", ")", "\n", "logger", ".", "info", "(", "f'Number of GPUs: {cfg.ngpus}'", ")", "\n", "if", "cfg", ".", "distributed", ":", "\n", "            ", "logger", ".", "info", "(", "f'Multi-Process Multi-GPU Distributed Training'", ")", "\n", "\n", "", "logger", ".", "info", "(", "'Run experiment with config:'", ")", "\n", "logger", ".", "info", "(", "pprint", ".", "pformat", "(", "cfg", ",", "indent", "=", "4", ")", ")", "\n", "\n", "", "return", "cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.get_model_family_tree": [[104, 116], ["family_tree.append"], "function", ["None"], ["", "def", "get_model_family_tree", "(", "model_path", ",", "terminate_name", "=", "'models'", ",", "model_name", "=", "None", ")", ":", "\n", "    ", "if", "model_name", "is", "None", ":", "\n", "        ", "model_name", "=", "model_path", ".", "stem", "\n", "", "family_tree", "=", "[", "model_name", "]", "\n", "for", "x", "in", "model_path", ".", "parents", ":", "\n", "        ", "if", "x", ".", "stem", "==", "terminate_name", ":", "\n", "            ", "break", "\n", "", "family_tree", ".", "append", "(", "x", ".", "stem", ")", "\n", "", "else", ":", "\n", "        ", "return", "None", "\n", "\n", "", "return", "family_tree", "[", ":", ":", "-", "1", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.find_last_exp_indx": [[118, 129], ["exp_parent_path.iterdir", "exp_name[].isnumeric", "x.is_dir", "max", "int"], "function", ["None"], ["", "def", "find_last_exp_indx", "(", "exp_parent_path", ")", ":", "\n", "    ", "indx", "=", "0", "\n", "for", "x", "in", "exp_parent_path", ".", "iterdir", "(", ")", ":", "\n", "        ", "if", "not", "x", ".", "is_dir", "(", ")", ":", "\n", "            ", "continue", "\n", "\n", "", "exp_name", "=", "x", ".", "stem", "\n", "if", "exp_name", "[", ":", "3", "]", ".", "isnumeric", "(", ")", ":", "\n", "            ", "indx", "=", "max", "(", "indx", ",", "int", "(", "exp_name", "[", ":", "3", "]", ")", "+", "1", ")", "\n", "\n", "", "", "return", "indx", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.find_resume_exp": [[131, 146], ["sorted", "exp_parent_path.glob", "len", "print", "sys.exit", "len", "print", "sys.exit", "print", "print"], "function", ["None"], ["", "def", "find_resume_exp", "(", "exp_parent_path", ",", "exp_pattern", ")", ":", "\n", "    ", "candidates", "=", "sorted", "(", "exp_parent_path", ".", "glob", "(", "f'{exp_pattern}*'", ")", ")", "\n", "if", "len", "(", "candidates", ")", "==", "0", ":", "\n", "        ", "print", "(", "f'No experiments could be found that satisfies the pattern = \"*{exp_pattern}\"'", ")", "\n", "sys", ".", "exit", "(", "1", ")", "\n", "", "elif", "len", "(", "candidates", ")", ">", "1", ":", "\n", "        ", "print", "(", "'More than one experiment found:'", ")", "\n", "for", "x", "in", "candidates", ":", "\n", "            ", "print", "(", "x", ")", "\n", "", "sys", ".", "exit", "(", "1", ")", "\n", "", "else", ":", "\n", "        ", "exp_path", "=", "candidates", "[", "0", "]", "\n", "print", "(", "f'Continue with experiment \"{exp_path}\"'", ")", "\n", "\n", "", "return", "exp_path", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.update_config": [[148, 153], ["vars().items", "vars", "param_name.lower", "param_name.upper"], "function", ["None"], ["", "def", "update_config", "(", "cfg", ",", "args", ")", ":", "\n", "    ", "for", "param_name", ",", "value", "in", "vars", "(", "args", ")", ".", "items", "(", ")", ":", "\n", "        ", "if", "param_name", ".", "lower", "(", ")", "in", "cfg", "or", "param_name", ".", "upper", "(", ")", "in", "cfg", ":", "\n", "            ", "continue", "\n", "", "cfg", "[", "param_name", "]", "=", "value", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config": [[155, 178], ["config_path.exists", "pathlib.Path.cwd", "config_path.parent.absolute", "easydict.EasyDict", "exp.load_config_file", "dict", "len", "config_path.exists", "exp.load_config_file", "dict.update", "config_path.parent.absolute.absolute", "load_config_file.items"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config_file", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config_file", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "", "def", "load_config", "(", "model_path", ")", ":", "\n", "    ", "model_name", "=", "model_path", ".", "stem", "\n", "config_path", "=", "model_path", ".", "parent", "/", "(", "model_name", "+", "'.yml'", ")", "\n", "\n", "if", "config_path", ".", "exists", "(", ")", ":", "\n", "        ", "cfg", "=", "load_config_file", "(", "config_path", ")", "\n", "", "else", ":", "\n", "        ", "cfg", "=", "dict", "(", ")", "\n", "\n", "", "cwd", "=", "Path", ".", "cwd", "(", ")", "\n", "config_parent", "=", "config_path", ".", "parent", ".", "absolute", "(", ")", "\n", "while", "len", "(", "config_parent", ".", "parents", ")", ">", "0", ":", "\n", "        ", "config_path", "=", "config_parent", "/", "'config.yml'", "\n", "\n", "if", "config_path", ".", "exists", "(", ")", ":", "\n", "            ", "local_config", "=", "load_config_file", "(", "config_path", ",", "model_name", "=", "model_name", ")", "\n", "cfg", ".", "update", "(", "{", "k", ":", "v", "for", "k", ",", "v", "in", "local_config", ".", "items", "(", ")", "if", "k", "not", "in", "cfg", "}", ")", "\n", "\n", "", "if", "config_parent", ".", "absolute", "(", ")", "==", "cwd", ":", "\n", "            ", "break", "\n", "", "config_parent", "=", "config_parent", ".", "parent", "\n", "\n", "", "return", "edict", "(", "cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config_file": [[180, 190], ["open", "yaml.safe_load", "easydict.EasyDict", "yaml.safe_load.update"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_config_file", "(", "config_path", ",", "model_name", "=", "None", ",", "return_edict", "=", "False", ")", ":", "\n", "    ", "with", "open", "(", "config_path", ",", "'r'", ")", "as", "f", ":", "\n", "        ", "cfg", "=", "yaml", ".", "safe_load", "(", "f", ")", "\n", "\n", "", "if", "'SUBCONFIGS'", "in", "cfg", ":", "\n", "        ", "if", "model_name", "is", "not", "None", "and", "model_name", "in", "cfg", "[", "'SUBCONFIGS'", "]", ":", "\n", "            ", "cfg", ".", "update", "(", "cfg", "[", "'SUBCONFIGS'", "]", "[", "model_name", "]", ")", "\n", "", "del", "cfg", "[", "'SUBCONFIGS'", "]", "\n", "\n", "", "return", "edict", "(", "cfg", ")", "if", "return_edict", "else", "cfg", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.map_point_in_bbox": [[5, 11], ["None"], "function", ["None"], ["def", "map_point_in_bbox", "(", "y", ",", "x", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "crop_l", ")", ":", "\n", "    ", "h", ",", "w", "=", "y2", "-", "y1", ",", "x2", "-", "x1", "\n", "ry", ",", "rx", "=", "crop_l", "/", "h", ",", "crop_l", "/", "w", "\n", "y", "=", "(", "y", "-", "y1", ")", "*", "ry", "\n", "x", "=", "(", "x", "-", "x1", ")", "*", "rx", "\n", "return", "y", ",", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.get_focus_cropv1": [[14, 44], ["numpy.logical_xor", "crop_local.expand_bbox", "max", "min", "max", "min", "previous_mask.sum", "crop_local.get_bbox_from_mask", "cv2.connectedComponents", "crop_local.get_bbox_from_mask", "crop_local.get_bbox_from_mask", "np.logical_xor.astype", "max"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.expand_bbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask"], ["", "def", "get_focus_cropv1", "(", "pred_mask", ",", "previous_mask", ",", "global_roi", ",", "y", ",", "x", ",", "ratio", ")", ":", "\n", "    ", "pred_mask", "=", "pred_mask", ">", "0.49", "\n", "previous_mask", "=", "previous_mask", ">", "0.49", "\n", "ymin", ",", "ymax", ",", "xmin", ",", "xmax", "=", "global_roi", "\n", "diff_regions", "=", "np", ".", "logical_xor", "(", "previous_mask", ",", "pred_mask", ")", "\n", "if", "previous_mask", ".", "sum", "(", ")", "==", "0", ":", "\n", "        ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "get_bbox_from_mask", "(", "pred_mask", ")", "\n", "", "else", ":", "\n", "        ", "num", ",", "labels", "=", "cv2", ".", "connectedComponents", "(", "diff_regions", ".", "astype", "(", "np", ".", "uint8", ")", ")", "\n", "label", "=", "labels", "[", "y", ",", "x", "]", "\n", "diff_conn_mask", "=", "labels", "==", "label", "\n", "y1d", ",", "y2d", ",", "x1d", ",", "x2d", "=", "get_bbox_from_mask", "(", "diff_conn_mask", ")", "\n", "hd", ",", "wd", "=", "y2d", "-", "y1d", ",", "x2d", "-", "x1d", "\n", "\n", "y1p", ",", "y2p", ",", "x1p", ",", "x2p", "=", "get_bbox_from_mask", "(", "pred_mask", ")", "\n", "hp", ",", "wp", "=", "y2p", "-", "y1p", ",", "x2p", "-", "x1p", "\n", "\n", "if", "hd", "<", "hp", "/", "3", "or", "wd", "<", "wp", "/", "3", ":", "\n", "            ", "r", "=", "0.2", "\n", "l", "=", "max", "(", "hp", ",", "wp", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "y", "-", "r", "*", "l", ",", "y", "+", "r", "*", "l", ",", "x", "-", "r", "*", "l", ",", "x", "+", "r", "*", "l", "\n", "", "else", ":", "\n", "            ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "y1d", ",", "y2d", ",", "x1d", ",", "x2d", "\n", "\n", "", "", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "expand_bbox", "(", "pred_mask", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "ratio", ")", "\n", "y1", "=", "max", "(", "y1", ",", "ymin", ")", "\n", "y2", "=", "min", "(", "y2", ",", "ymax", ")", "\n", "x1", "=", "max", "(", "x1", ",", "xmin", ")", "\n", "x2", "=", "min", "(", "x2", ",", "xmax", ")", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.get_focus_cropv2": [[46, 79], ["numpy.logical_xor", "cv2.connectedComponents", "crop_local.get_bbox_from_mask", "crop_local.get_bbox_from_mask", "crop_local.expand_bbox", "max", "min", "max", "min", "np.logical_xor.astype", "previous_mask.sum", "max", "diff_conn_mask.sum", "np.logical_xor.sum"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.expand_bbox"], ["", "def", "get_focus_cropv2", "(", "pred_mask", ",", "previous_mask", ",", "global_roi", ",", "y", ",", "x", ",", "ratio", ")", ":", "\n", "    ", "pred_mask", "=", "pred_mask", ">", "0.5", "\n", "previous_mask", "=", "previous_mask", ">", "0.5", "\n", "ymin", ",", "ymax", ",", "xmin", ",", "xmax", "=", "global_roi", "\n", "diff_regions", "=", "np", ".", "logical_xor", "(", "previous_mask", ",", "pred_mask", ")", "\n", "num", ",", "labels", "=", "cv2", ".", "connectedComponents", "(", "diff_regions", ".", "astype", "(", "np", ".", "uint8", ")", ")", "\n", "label", "=", "labels", "[", "y", ",", "x", "]", "\n", "diff_conn_mask", "=", "labels", "==", "label", "\n", "\n", "y1d", ",", "y2d", ",", "x1d", ",", "x2d", "=", "get_bbox_from_mask", "(", "diff_conn_mask", ")", "\n", "hd", ",", "wd", "=", "y2d", "-", "y1d", ",", "x2d", "-", "x1d", "\n", "\n", "y1p", ",", "y2p", ",", "x1p", ",", "x2p", "=", "get_bbox_from_mask", "(", "pred_mask", ")", "\n", "hp", ",", "wp", "=", "y2p", "-", "y1p", ",", "x2p", "-", "x1p", "\n", "\n", "if", "previous_mask", ".", "sum", "(", ")", "==", "0", ":", "\n", "        ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "y1p", ",", "y2p", ",", "x1p", ",", "x2p", "\n", "", "else", ":", "\n", "        ", "if", "hd", "<", "hp", "/", "3", "or", "wd", "<", "wp", "/", "3", ":", "\n", "            ", "r", "=", "0.16", "\n", "l", "=", "max", "(", "hp", ",", "wp", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "y", "-", "r", "*", "l", ",", "y", "+", "r", "*", "l", ",", "x", "-", "r", "*", "l", ",", "x", "+", "r", "*", "l", "\n", "", "else", ":", "\n", "            ", "if", "diff_conn_mask", ".", "sum", "(", ")", ">", "diff_regions", ".", "sum", "(", ")", "*", "0.5", ":", "\n", "                ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "y1d", ",", "y2d", ",", "x1d", ",", "x2d", "\n", "", "else", ":", "\n", "                ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "y1p", ",", "y2p", ",", "x1p", ",", "x2p", "\n", "", "", "", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "expand_bbox", "(", "pred_mask", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "ratio", ")", "\n", "y1", "=", "max", "(", "y1", ",", "ymin", ")", "\n", "y2", "=", "min", "(", "y2", ",", "ymax", ")", "\n", "x1", "=", "max", "(", "x1", ",", "xmin", ")", "\n", "x2", "=", "min", "(", "x2", ",", "xmax", ")", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.get_object_crop": [[81, 91], ["crop_local.get_bbox_from_mask", "crop_local.expand_bbox", "max", "min", "max", "min"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.expand_bbox"], ["", "def", "get_object_crop", "(", "pred_mask", ",", "previous_mask", ",", "global_roi", ",", "y", ",", "x", ",", "ratio", ")", ":", "\n", "    ", "pred_mask", "=", "pred_mask", ">", "0.49", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "get_bbox_from_mask", "(", "pred_mask", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "expand_bbox", "(", "pred_mask", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "ratio", ")", "\n", "ymin", ",", "ymax", ",", "xmin", ",", "xmax", "=", "global_roi", "\n", "y1", "=", "max", "(", "y1", ",", "ymin", ")", "\n", "y2", "=", "min", "(", "y2", ",", "ymax", ")", "\n", "x1", "=", "max", "(", "x1", ",", "xmin", ")", "\n", "x2", "=", "min", "(", "x2", ",", "xmax", ")", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.get_click_crop": [[94, 108], ["crop_local.get_bbox_from_mask", "max", "crop_local.expand_bbox", "max", "min", "max", "min"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.expand_bbox"], ["", "def", "get_click_crop", "(", "pred_mask", ",", "previous_mask", ",", "global_roi", ",", "y", ",", "x", ",", "ratio", ")", ":", "\n", "    ", "pred_mask", "=", "pred_mask", ">", "0.49", "\n", "y1p", ",", "y2p", ",", "x1p", ",", "x2p", "=", "get_bbox_from_mask", "(", "pred_mask", ")", "\n", "hp", ",", "wp", "=", "y2p", "-", "y1p", ",", "x2p", "-", "x1p", "\n", "r", "=", "0.2", "\n", "l", "=", "max", "(", "hp", ",", "wp", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "y", "-", "r", "*", "l", ",", "y", "+", "r", "*", "l", ",", "x", "-", "r", "*", "l", ",", "x", "+", "r", "*", "l", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "expand_bbox", "(", "pred_mask", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "ratio", ")", "\n", "ymin", ",", "ymax", ",", "xmin", ",", "xmax", "=", "global_roi", "\n", "y1", "=", "max", "(", "y1", ",", "ymin", ")", "\n", "y2", "=", "min", "(", "y2", ",", "ymax", ")", "\n", "x1", "=", "max", "(", "x1", ",", "xmin", ")", "\n", "x2", "=", "min", "(", "x2", ",", "xmax", ")", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.getLargestCC": [[112, 118], ["skimage.measure.label", "segmentation.sum", "numpy.argmax", "numpy.bincount"], "function", ["None"], ["", "def", "getLargestCC", "(", "segmentation", ")", ":", "\n", "    ", "if", "segmentation", ".", "sum", "(", ")", "<", "10", ":", "\n", "        ", "return", "segmentation", "\n", "", "labels", "=", "label", "(", "segmentation", ")", "\n", "largestCC", "=", "labels", "==", "np", ".", "argmax", "(", "np", ".", "bincount", "(", "labels", ".", "flat", ")", "[", "1", ":", "]", ")", "+", "1", "\n", "return", "largestCC", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.get_diff_region": [[121, 131], ["numpy.logical_xor", "int", "int", "np.logical_xor.sum", "cv2.connectedComponents", "np.logical_xor.astype"], "function", ["None"], ["", "def", "get_diff_region", "(", "pred_mask", ",", "previous_mask", ",", "y", ",", "x", ")", ":", "\n", "    ", "y", ",", "x", "=", "int", "(", "y", ")", ",", "int", "(", "x", ")", "\n", "diff_regions", "=", "np", ".", "logical_xor", "(", "previous_mask", ",", "pred_mask", ")", "\n", "if", "diff_regions", ".", "sum", "(", ")", ">", "1000", ":", "\n", "        ", "num", ",", "labels", "=", "cv2", ".", "connectedComponents", "(", "diff_regions", ".", "astype", "(", "np", ".", "uint8", ")", ")", "\n", "label", "=", "labels", "[", "y", ",", "x", "]", "\n", "corr_mask", "=", "labels", "==", "label", "\n", "", "else", ":", "\n", "        ", "corr_mask", "=", "pred_mask", "\n", "", "return", "corr_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.get_bbox_from_mask": [[135, 145], ["numpy.any", "numpy.any", "mask.sum", "numpy.where", "numpy.where"], "function", ["None"], ["", "def", "get_bbox_from_mask", "(", "mask", ")", ":", "\n", "    ", "h", ",", "w", "=", "mask", ".", "shape", "[", "0", "]", ",", "mask", ".", "shape", "[", "1", "]", "\n", "\n", "if", "mask", ".", "sum", "(", ")", "<", "10", ":", "\n", "        ", "return", "0", ",", "h", ",", "0", ",", "w", "\n", "", "rows", "=", "np", ".", "any", "(", "mask", ",", "axis", "=", "1", ")", "\n", "cols", "=", "np", ".", "any", "(", "mask", ",", "axis", "=", "0", ")", "\n", "y1", ",", "y2", "=", "np", ".", "where", "(", "rows", ")", "[", "0", "]", "[", "[", "0", ",", "-", "1", "]", "]", "\n", "x1", ",", "x2", "=", "np", ".", "where", "(", "cols", ")", "[", "0", "]", "[", "[", "0", ",", "-", "1", "]", "]", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.expand_bbox": [[146, 164], ["max", "max", "int", "int", "int", "int", "max", "min", "max", "min"], "function", ["None"], ["", "def", "expand_bbox", "(", "mask", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "ratio", ",", "min_crop", "=", "0", ")", ":", "\n", "    ", "H", ",", "W", "=", "mask", ".", "shape", "[", "0", "]", ",", "mask", ".", "shape", "[", "1", "]", "\n", "xc", ",", "yc", "=", "0.5", "*", "(", "x1", "+", "x2", ")", ",", "0.5", "*", "(", "y1", "+", "y2", ")", "\n", "h", "=", "ratio", "*", "(", "y2", "-", "y1", "+", "1", ")", "\n", "w", "=", "ratio", "*", "(", "x2", "-", "x1", "+", "1", ")", "\n", "h", "=", "max", "(", "h", ",", "min_crop", ")", "\n", "w", "=", "max", "(", "w", ",", "min_crop", ")", "\n", "\n", "x1", "=", "int", "(", "xc", "-", "w", "*", "0.5", ")", "\n", "x2", "=", "int", "(", "xc", "+", "w", "*", "0.5", ")", "\n", "y1", "=", "int", "(", "yc", "-", "h", "*", "0.5", ")", "\n", "y2", "=", "int", "(", "yc", "+", "h", "*", "0.5", ")", "\n", "\n", "x1", "=", "max", "(", "0", ",", "x1", ")", "\n", "x2", "=", "min", "(", "W", ",", "x2", ")", "\n", "y1", "=", "max", "(", "0", ",", "y1", ")", "\n", "y2", "=", "min", "(", "H", ",", "y2", ")", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.expand_bbox_with_bias": [[166, 187], ["max", "max", "numpy.random.randint", "numpy.random.randint", "max", "min", "max", "min", "int", "int", "int", "int", "int", "int"], "function", ["None"], ["", "def", "expand_bbox_with_bias", "(", "mask", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "ratio", ",", "min_crop", "=", "0", ",", "bias", "=", "0.3", ")", ":", "\n", "    ", "H", ",", "W", "=", "mask", ".", "shape", "[", "0", "]", ",", "mask", ".", "shape", "[", "1", "]", "\n", "xc", ",", "yc", "=", "0.5", "*", "(", "x1", "+", "x2", ")", ",", "0.5", "*", "(", "y1", "+", "y2", ")", "\n", "h", "=", "ratio", "*", "(", "y2", "-", "y1", "+", "1", ")", "\n", "w", "=", "ratio", "*", "(", "x2", "-", "x1", "+", "1", ")", "\n", "h", "=", "max", "(", "h", ",", "min_crop", ")", "\n", "w", "=", "max", "(", "w", ",", "min_crop", ")", "\n", "hmax", ",", "wmax", "=", "int", "(", "h", "*", "bias", ")", ",", "int", "(", "w", "*", "bias", ")", "\n", "h_bias", "=", "np", ".", "random", ".", "randint", "(", "-", "hmax", ",", "hmax", "+", "1", ")", "\n", "w_bias", "=", "np", ".", "random", ".", "randint", "(", "-", "wmax", ",", "wmax", "+", "1", ")", "\n", "\n", "x1", "=", "int", "(", "xc", "-", "w", "*", "0.5", ")", "+", "w_bias", "\n", "x2", "=", "int", "(", "xc", "+", "w", "*", "0.5", ")", "+", "w_bias", "\n", "y1", "=", "int", "(", "yc", "-", "h", "*", "0.5", ")", "+", "h_bias", "\n", "y2", "=", "int", "(", "yc", "+", "h", "*", "0.5", ")", "+", "h_bias", "\n", "\n", "x1", "=", "max", "(", "0", ",", "x1", ")", "\n", "x2", "=", "min", "(", "W", ",", "x2", ")", "\n", "y1", "=", "max", "(", "0", ",", "y1", ")", "\n", "y2", "=", "min", "(", "H", ",", "y2", ")", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.CalBox": [[190, 212], ["crop_local.get_bbox_from_mask", "int", "int", "int", "int", "max", "min", "max", "min", "min", "max", "min", "max"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask"], ["", "def", "CalBox", "(", "mask", ",", "last_y", "=", "None", ",", "last_x", "=", "None", ",", "expand", "=", "1.5", ")", ":", "\n", "    ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "get_bbox_from_mask", "(", "mask", ")", "\n", "H", ",", "W", "=", "mask", ".", "shape", "[", "0", "]", ",", "mask", ".", "shape", "[", "1", "]", "\n", "if", "last_y", "is", "not", "None", ":", "\n", "        ", "y1", "=", "min", "(", "y1", ",", "last_y", ")", "\n", "y2", "=", "max", "(", "y2", ",", "last_y", ")", "\n", "x1", "=", "min", "(", "x1", ",", "last_x", ")", "\n", "x2", "=", "max", "(", "x2", ",", "last_x", ")", "\n", "\n", "", "xc", ",", "yc", "=", "0.5", "*", "(", "x1", "+", "x2", ")", ",", "0.5", "*", "(", "y1", "+", "y2", ")", "\n", "h", "=", "expand", "*", "(", "y2", "-", "y1", "+", "1", ")", "\n", "w", "=", "expand", "*", "(", "x2", "-", "x1", "+", "1", ")", "\n", "x1", "=", "int", "(", "xc", "-", "w", "*", "0.5", ")", "\n", "x2", "=", "int", "(", "xc", "+", "w", "*", "0.5", ")", "\n", "y1", "=", "int", "(", "yc", "-", "h", "*", "0.5", ")", "\n", "y2", "=", "int", "(", "yc", "+", "h", "*", "0.5", ")", "\n", "\n", "x1", "=", "max", "(", "0", ",", "x1", ")", "\n", "x2", "=", "min", "(", "W", ",", "x2", ")", "\n", "y1", "=", "max", "(", "0", ",", "y1", ")", "\n", "y2", "=", "min", "(", "H", ",", "y2", ")", "\n", "return", "y1", ",", "y2", ",", "x1", ",", "x2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.points_back": [[213, 218], ["numpy.array().reshape", "numpy.array"], "function", ["None"], ["", "def", "points_back", "(", "p_np", ",", "y1", ",", "x1", ")", ":", "\n", "    ", "if", "p_np", "is", "None", ":", "\n", "        ", "return", "None", "\n", "", "bias", "=", "np", ".", "array", "(", "[", "[", "y1", ",", "x1", "]", "]", ")", ".", "reshape", "(", "(", "1", ",", "2", ")", ")", "\n", "return", "p_np", "+", "bias", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.PointsInBox": [[222, 251], ["numpy.full_like", "range", "range", "numpy.array"], "function", ["None"], ["", "def", "PointsInBox", "(", "points", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "H", ",", "W", ")", ":", "\n", "    ", "if", "points", "is", "None", ":", "\n", "        ", "return", "None", "\n", "\n", "", "y_ratio", "=", "H", "/", "(", "y2", "-", "y1", ")", "\n", "x_ratio", "=", "W", "/", "(", "x2", "-", "x1", ")", "\n", "num_pos", "=", "points", ".", "shape", "[", "0", "]", "//", "2", "\n", "new_points", "=", "np", ".", "full_like", "(", "points", ",", "-", "1", ")", "\n", "\n", "valid_pos", "=", "0", "\n", "for", "i", "in", "range", "(", "num_pos", ")", ":", "\n", "        ", "y", ",", "x", ",", "index", "=", "points", "[", "i", ",", "0", "]", ",", "points", "[", "i", ",", "1", "]", ",", "points", "[", "i", ",", "2", "]", "\n", "if", "y", ">", "y1", "and", "y", "<", "y2", "and", "x", ">", "x1", "and", "x", "<", "x2", ":", "\n", "            ", "new_x", ",", "new_y", "=", "(", "x", "-", "x1", ")", "*", "x_ratio", ",", "(", "y", "-", "y1", ")", "*", "y_ratio", "\n", "new_points", "[", "valid_pos", ",", "0", "]", ",", "new_points", "[", "valid_pos", ",", "1", "]", ",", "new_points", "[", "valid_pos", ",", "2", "]", "=", "new_y", ",", "new_x", ",", "index", "\n", "valid_pos", "+=", "1", "\n", "", "if", "y", "==", "-", "1", ":", "\n", "            ", "break", "\n", "\n", "", "", "valid_neg", "=", "num_pos", "\n", "for", "i", "in", "range", "(", "num_pos", ",", "num_pos", "*", "2", ")", ":", "\n", "        ", "y", ",", "x", ",", "index", "=", "points", "[", "i", ",", "0", "]", ",", "points", "[", "i", ",", "1", "]", ",", "points", "[", "i", ",", "2", "]", "\n", "if", "y", ">", "y1", "and", "y", "<", "y2", "and", "x", ">", "x1", "and", "x", "<", "x2", ":", "\n", "            ", "new_x", ",", "new_y", "=", "(", "x", "-", "x1", ")", "*", "x_ratio", ",", "(", "y", "-", "y1", ")", "*", "y_ratio", "\n", "new_points", "[", "valid_neg", ",", "0", "]", ",", "new_points", "[", "valid_neg", ",", "1", "]", ",", "new_points", "[", "valid_neg", ",", "2", "]", "=", "new_y", ",", "new_x", ",", "index", "\n", "valid_neg", "+=", "1", "\n", "", "if", "y", "==", "-", "1", ":", "\n", "            ", "break", "\n", "", "", "return", "np", ".", "array", "(", "new_points", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.random_choose_target": [[254, 295], ["numpy.zeros_like", "numpy.any", "len", "numpy.random.randint", "numpy.clip", "numpy.clip", "numpy.where", "numpy.any", "numpy.where"], "function", ["None"], ["", "def", "random_choose_target", "(", "unknown", ",", "crop_size", ")", ":", "\n", "    ", "\"\"\"Randomly choose an unknown start (top-left) point for a given crop_size.\n\n    Args:\n        unknown (np.ndarray): The binary unknown mask.\n        crop_size (tuple[int]): The given crop size.\n\n    Returns:\n        tuple[int]: The top-left point of the chosen bbox.\n    \"\"\"", "\n", "h", ",", "w", "=", "unknown", ".", "shape", "\n", "crop_h", ",", "crop_w", "=", "crop_size", "\n", "if", "crop_h", ">", "h", "or", "crop_w", ">", "w", ":", "\n", "        ", "return", "0", ",", "0", ",", "h", ",", "w", "\n", "\n", "\n", "", "delta_h", "=", "center_h", "=", "crop_h", "//", "2", "\n", "delta_w", "=", "center_w", "=", "crop_w", "//", "2", "\n", "\n", "# mask out the validate area for selecting the cropping center", "\n", "mask", "=", "np", ".", "zeros_like", "(", "unknown", ")", "\n", "mask", "[", "delta_h", ":", "h", "-", "delta_h", ",", "delta_w", ":", "w", "-", "delta_w", "]", "=", "1", "\n", "if", "np", ".", "any", "(", "unknown", "&", "mask", ")", ":", "\n", "        ", "center_h_list", ",", "center_w_list", "=", "np", ".", "where", "(", "unknown", "&", "mask", ")", "\n", "", "elif", "np", ".", "any", "(", "unknown", ")", ":", "\n", "        ", "center_h_list", ",", "center_w_list", "=", "np", ".", "where", "(", "unknown", ")", "\n", "", "else", ":", "\n", "#print_log('No unknown pixels found!', level=logging.WARNING)", "\n", "        ", "center_h_list", "=", "[", "center_h", "]", "\n", "center_w_list", "=", "[", "center_w", "]", "\n", "", "num_unknowns", "=", "len", "(", "center_h_list", ")", "\n", "rand_ind", "=", "np", ".", "random", ".", "randint", "(", "num_unknowns", ")", "\n", "center_h", "=", "center_h_list", "[", "rand_ind", "]", "\n", "center_w", "=", "center_w_list", "[", "rand_ind", "]", "\n", "\n", "# make sure the top-left point is valid", "\n", "top", "=", "np", ".", "clip", "(", "center_h", "-", "delta_h", ",", "0", ",", "h", "-", "crop_h", ")", "\n", "left", "=", "np", ".", "clip", "(", "center_w", "-", "delta_w", ",", "0", ",", "w", "-", "crop_w", ")", "\n", "y1", ",", "x1", ",", "y2", ",", "x2", "=", "top", ",", "left", ",", "top", "+", "crop_h", ",", "left", "+", "crop_w", "\n", "\n", "return", "y1", ",", "x1", ",", "y2", ",", "x2", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_rank": [[6, 10], ["torch.distributed.get_rank", "torch.distributed.is_available", "torch.distributed.is_initialized"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_rank"], ["def", "get_rank", "(", ")", ":", "\n", "    ", "if", "not", "dist", ".", "is_available", "(", ")", "or", "not", "dist", ".", "is_initialized", "(", ")", ":", "\n", "        ", "return", "0", "\n", "", "return", "dist", ".", "get_rank", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.synchronize": [[12, 16], ["torch.distributed.barrier", "torch.distributed.is_available", "torch.distributed.is_initialized", "torch.distributed.get_world_size"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_world_size"], ["", "def", "synchronize", "(", ")", ":", "\n", "    ", "if", "not", "dist", ".", "is_available", "(", ")", "or", "not", "dist", ".", "is_initialized", "(", ")", "or", "dist", ".", "get_world_size", "(", ")", "==", "1", ":", "\n", "        ", "return", "\n", "", "dist", ".", "barrier", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_world_size": [[18, 23], ["torch.distributed.get_world_size", "torch.distributed.is_available", "torch.distributed.is_initialized"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_world_size"], ["", "def", "get_world_size", "(", ")", ":", "\n", "    ", "if", "not", "dist", ".", "is_available", "(", ")", "or", "not", "dist", ".", "is_initialized", "(", ")", ":", "\n", "        ", "return", "1", "\n", "\n", "", "return", "dist", ".", "get_world_size", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.reduce_loss_dict": [[25, 48], ["distributed.get_world_size", "torch.no_grad", "loss_dict.keys", "torch.stack", "torch.distributed.reduce", "keys.append", "torch.stack.append", "torch.distributed.get_rank", "zip"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_world_size", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_rank"], ["", "def", "reduce_loss_dict", "(", "loss_dict", ")", ":", "\n", "    ", "world_size", "=", "get_world_size", "(", ")", "\n", "\n", "if", "world_size", "<", "2", ":", "\n", "        ", "return", "loss_dict", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "keys", "=", "[", "]", "\n", "losses", "=", "[", "]", "\n", "\n", "for", "k", "in", "loss_dict", ".", "keys", "(", ")", ":", "\n", "            ", "keys", ".", "append", "(", "k", ")", "\n", "losses", ".", "append", "(", "loss_dict", "[", "k", "]", ")", "\n", "\n", "", "losses", "=", "torch", ".", "stack", "(", "losses", ",", "0", ")", "\n", "dist", ".", "reduce", "(", "losses", ",", "dst", "=", "0", ")", "\n", "\n", "if", "dist", ".", "get_rank", "(", ")", "==", "0", ":", "\n", "            ", "losses", "/=", "world_size", "\n", "\n", "", "reduced_losses", "=", "{", "k", ":", "v", "for", "k", ",", "v", "in", "zip", "(", "keys", ",", "losses", ")", "}", "\n", "\n", "", "return", "reduced_losses", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_sampler": [[50, 58], ["torch.utils.data.distributed.DistributedSampler", "torch.utils.data.RandomSampler", "torch.utils.data.SequentialSampler"], "function", ["None"], ["", "def", "get_sampler", "(", "dataset", ",", "shuffle", ",", "distributed", ")", ":", "\n", "    ", "if", "distributed", ":", "\n", "        ", "return", "data", ".", "distributed", ".", "DistributedSampler", "(", "dataset", ",", "shuffle", "=", "shuffle", ")", "\n", "\n", "", "if", "shuffle", ":", "\n", "        ", "return", "data", ".", "RandomSampler", "(", "dataset", ")", "\n", "", "else", ":", "\n", "        ", "return", "data", ".", "SequentialSampler", "(", "dataset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_dp_wrapper": [[60, 68], ["super().__getattr__", "getattr"], "function", ["None"], ["", "", "def", "get_dp_wrapper", "(", "distributed", ")", ":", "\n", "    ", "class", "DPWrapper", "(", "torch", ".", "nn", ".", "parallel", ".", "DistributedDataParallel", "if", "distributed", "else", "torch", ".", "nn", ".", "DataParallel", ")", ":", "\n", "        ", "def", "__getattr__", "(", "self", ",", "name", ")", ":", "\n", "            ", "try", ":", "\n", "                ", "return", "super", "(", ")", ".", "__getattr__", "(", "name", ")", "\n", "", "except", "AttributeError", ":", "\n", "                ", "return", "getattr", "(", "self", ".", "module", ",", "name", ")", "\n", "", "", "", "return", "DPWrapper", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion": [[7, 13], ["list", "range", "list.remove"], "function", ["None"], ["def", "get_dims_with_exclusion", "(", "dim", ",", "exclude", "=", "None", ")", ":", "\n", "    ", "dims", "=", "list", "(", "range", "(", "dim", ")", ")", "\n", "if", "exclude", "is", "not", "None", ":", "\n", "        ", "dims", ".", "remove", "(", "exclude", ")", "\n", "\n", "", "return", "dims", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.save_checkpoint": [[15, 34], ["torch.save", "checkpoints_path.exists", "checkpoints_path.mkdir", "log.logger.info", "str", "net.state_dict", "str"], "function", ["None"], ["", "def", "save_checkpoint", "(", "net", ",", "checkpoints_path", ",", "epoch", "=", "None", ",", "prefix", "=", "''", ",", "verbose", "=", "True", ",", "multi_gpu", "=", "False", ")", ":", "\n", "    ", "if", "epoch", "is", "None", ":", "\n", "        ", "checkpoint_name", "=", "'last_checkpoint.pth'", "\n", "", "else", ":", "\n", "        ", "checkpoint_name", "=", "f'{epoch:03d}.pth'", "\n", "\n", "", "if", "prefix", ":", "\n", "        ", "checkpoint_name", "=", "f'{prefix}_{checkpoint_name}'", "\n", "\n", "", "if", "not", "checkpoints_path", ".", "exists", "(", ")", ":", "\n", "        ", "checkpoints_path", ".", "mkdir", "(", "parents", "=", "True", ")", "\n", "\n", "", "checkpoint_path", "=", "checkpoints_path", "/", "checkpoint_name", "\n", "if", "verbose", ":", "\n", "        ", "logger", ".", "info", "(", "f'Save checkpoint to {str(checkpoint_path)}'", ")", "\n", "\n", "", "net", "=", "net", ".", "module", "if", "multi_gpu", "else", "net", "\n", "torch", ".", "save", "(", "{", "'state_dict'", ":", "net", ".", "state_dict", "(", ")", ",", "\n", "'config'", ":", "net", ".", "_config", "}", ",", "str", "(", "checkpoint_path", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask": [[36, 43], ["numpy.any", "numpy.any", "numpy.where", "numpy.where"], "function", ["None"], ["", "def", "get_bbox_from_mask", "(", "mask", ")", ":", "\n", "    ", "rows", "=", "np", ".", "any", "(", "mask", ",", "axis", "=", "1", ")", "\n", "cols", "=", "np", ".", "any", "(", "mask", ",", "axis", "=", "0", ")", "\n", "rmin", ",", "rmax", "=", "np", ".", "where", "(", "rows", ")", "[", "0", "]", "[", "[", "0", ",", "-", "1", "]", "]", "\n", "cmin", ",", "cmax", "=", "np", ".", "where", "(", "cols", ")", "[", "0", "]", "[", "[", "0", ",", "-", "1", "]", "]", "\n", "\n", "return", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.expand_bbox": [[45, 61], ["int", "int", "int", "int", "max", "max", "round", "round", "round", "round"], "function", ["None"], ["", "def", "expand_bbox", "(", "bbox", ",", "expand_ratio", ",", "min_crop_size", "=", "None", ")", ":", "\n", "    ", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "=", "bbox", "\n", "rcenter", "=", "0.5", "*", "(", "rmin", "+", "rmax", ")", "\n", "ccenter", "=", "0.5", "*", "(", "cmin", "+", "cmax", ")", "\n", "height", "=", "expand_ratio", "*", "(", "rmax", "-", "rmin", "+", "1", ")", "\n", "width", "=", "expand_ratio", "*", "(", "cmax", "-", "cmin", "+", "1", ")", "\n", "if", "min_crop_size", "is", "not", "None", ":", "\n", "        ", "height", "=", "max", "(", "height", ",", "min_crop_size", ")", "\n", "width", "=", "max", "(", "width", ",", "min_crop_size", ")", "\n", "\n", "", "rmin", "=", "int", "(", "round", "(", "rcenter", "-", "0.5", "*", "height", ")", ")", "\n", "rmax", "=", "int", "(", "round", "(", "rcenter", "+", "0.5", "*", "height", ")", ")", "\n", "cmin", "=", "int", "(", "round", "(", "ccenter", "-", "0.5", "*", "width", ")", ")", "\n", "cmax", "=", "int", "(", "round", "(", "ccenter", "+", "0.5", "*", "width", ")", ")", "\n", "\n", "return", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.clamp_bbox": [[63, 66], ["max", "min", "max", "min"], "function", ["None"], ["", "def", "clamp_bbox", "(", "bbox", ",", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", ")", ":", "\n", "    ", "return", "(", "max", "(", "rmin", ",", "bbox", "[", "0", "]", ")", ",", "min", "(", "rmax", ",", "bbox", "[", "1", "]", ")", ",", "\n", "max", "(", "cmin", ",", "bbox", "[", "2", "]", ")", ",", "min", "(", "cmax", ",", "bbox", "[", "3", "]", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_iou": [[68, 72], ["misc.get_segments_iou", "misc.get_segments_iou"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_segments_iou", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_segments_iou"], ["", "def", "get_bbox_iou", "(", "b1", ",", "b2", ")", ":", "\n", "    ", "h_iou", "=", "get_segments_iou", "(", "b1", "[", ":", "2", "]", ",", "b2", "[", ":", "2", "]", ")", "\n", "w_iou", "=", "get_segments_iou", "(", "b1", "[", "2", ":", "4", "]", ",", "b2", "[", "2", ":", "4", "]", ")", "\n", "return", "h_iou", "*", "w_iou", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_segments_iou": [[74, 80], ["max", "max", "min", "max", "max", "min"], "function", ["None"], ["", "def", "get_segments_iou", "(", "s1", ",", "s2", ")", ":", "\n", "    ", "a", ",", "b", "=", "s1", "\n", "c", ",", "d", "=", "s2", "\n", "intersection", "=", "max", "(", "0", ",", "min", "(", "b", ",", "d", ")", "-", "max", "(", "a", ",", "c", ")", "+", "1", ")", "\n", "union", "=", "max", "(", "1e-6", ",", "max", "(", "b", ",", "d", ")", "-", "min", "(", "a", ",", "c", ")", "+", "1", ")", "\n", "return", "intersection", "/", "union", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_labels_with_sizes": [[82, 87], ["numpy.bincount", "[].tolist", "x.flatten", "obj_sizes[].tolist", "numpy.nonzero"], "function", ["None"], ["", "def", "get_labels_with_sizes", "(", "x", ")", ":", "\n", "    ", "obj_sizes", "=", "np", ".", "bincount", "(", "x", ".", "flatten", "(", ")", ")", "\n", "labels", "=", "np", ".", "nonzero", "(", "obj_sizes", ")", "[", "0", "]", ".", "tolist", "(", ")", "\n", "labels", "=", "[", "x", "for", "x", "in", "labels", "if", "x", "!=", "0", "]", "\n", "return", "labels", ",", "obj_sizes", "[", "labels", "]", ".", "tolist", "(", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.TqdmToLogger.__init__": [[35, 41], ["io.StringIO.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "logger", ",", "level", "=", "None", ",", "mininterval", "=", "5", ")", ":", "\n", "        ", "super", "(", "TqdmToLogger", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "logger", "=", "logger", "\n", "self", ".", "level", "=", "level", "or", "logging", ".", "INFO", "\n", "self", ".", "mininterval", "=", "mininterval", "\n", "self", ".", "last_time", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.TqdmToLogger.write": [[42, 44], ["buf.strip"], "methods", ["None"], ["", "def", "write", "(", "self", ",", "buf", ")", ":", "\n", "        ", "self", ".", "buf", "=", "buf", ".", "strip", "(", "'\\r\\n\\t '", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.TqdmToLogger.flush": [[45, 49], ["log.TqdmToLogger.logger.log", "time.time", "len", "time.time"], "methods", ["None"], ["", "def", "flush", "(", "self", ")", ":", "\n", "        ", "if", "len", "(", "self", ".", "buf", ")", ">", "0", "and", "time", ".", "time", "(", ")", "-", "self", ".", "last_time", ">", "self", ".", "mininterval", ":", "\n", "            ", "self", ".", "logger", ".", "log", "(", "self", ".", "level", ",", "self", ".", "buf", ")", "\n", "self", ".", "last_time", "=", "time", ".", "time", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.__init__": [[52, 56], ["torch.utils.tensorboard.SummaryWriter.__init__", "dict"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "*", "args", ",", "dump_period", "=", "20", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "*", "args", ",", "**", "kwargs", ")", "\n", "self", ".", "_dump_period", "=", "dump_period", "\n", "self", ".", "_avg_scalars", "=", "dict", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar": [[57, 70], ["isinstance", "super().add_scalar", "avg_scalar.add", "avg_scalar.is_full", "numpy.array", "log.ScalarAccumulator", "super().add_scalar", "avg_scalar.reset"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.add", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.is_full", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.reset"], ["", "def", "add_scalar", "(", "self", ",", "tag", ",", "value", ",", "global_step", "=", "None", ",", "disable_avg", "=", "False", ")", ":", "\n", "        ", "if", "disable_avg", "or", "isinstance", "(", "value", ",", "(", "tuple", ",", "list", ",", "dict", ")", ")", ":", "\n", "            ", "super", "(", ")", ".", "add_scalar", "(", "tag", ",", "np", ".", "array", "(", "value", ")", ",", "global_step", "=", "global_step", ")", "\n", "", "else", ":", "\n", "            ", "if", "tag", "not", "in", "self", ".", "_avg_scalars", ":", "\n", "                ", "self", ".", "_avg_scalars", "[", "tag", "]", "=", "ScalarAccumulator", "(", "self", ".", "_dump_period", ")", "\n", "", "avg_scalar", "=", "self", ".", "_avg_scalars", "[", "tag", "]", "\n", "avg_scalar", ".", "add", "(", "value", ")", "\n", "\n", "if", "avg_scalar", ".", "is_full", "(", ")", ":", "\n", "                ", "super", "(", ")", ".", "add_scalar", "(", "tag", ",", "avg_scalar", ".", "value", ",", "\n", "global_step", "=", "global_step", ")", "\n", "avg_scalar", ".", "reset", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.__init__": [[73, 77], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "period", ")", ":", "\n", "        ", "self", ".", "sum", "=", "0", "\n", "self", ".", "cnt", "=", "0", "\n", "self", ".", "period", "=", "period", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.add": [[78, 81], ["None"], "methods", ["None"], ["", "def", "add", "(", "self", ",", "value", ")", ":", "\n", "        ", "self", ".", "sum", "+=", "value", "\n", "self", ".", "cnt", "+=", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.value": [[82, 88], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "value", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "cnt", ">", "0", ":", "\n", "            ", "return", "self", ".", "sum", "/", "self", ".", "cnt", "\n", "", "else", ":", "\n", "            ", "return", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.reset": [[89, 92], ["None"], "methods", ["None"], ["", "", "def", "reset", "(", "self", ")", ":", "\n", "        ", "self", ".", "cnt", "=", "0", "\n", "self", ".", "sum", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.is_full": [[93, 95], ["None"], "methods", ["None"], ["", "def", "is_full", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "cnt", ">=", "self", ".", "period", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.ScalarAccumulator.__len__": [[96, 98], ["None"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "cnt", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.add_logging": [[19, 28], ["logging.FileHandler", "logging.Formatter", "logging.FileHandler.setFormatter", "logger.addHandler", "str", "datetime.datetime.strftime", "datetime.datetime.today"], "function", ["None"], ["def", "add_logging", "(", "logs_path", ",", "prefix", ")", ":", "\n", "    ", "log_name", "=", "prefix", "+", "datetime", ".", "strftime", "(", "datetime", ".", "today", "(", ")", ",", "'%Y-%m-%d_%H-%M-%S'", ")", "+", "'.log'", "\n", "stdout_log_path", "=", "logs_path", "/", "log_name", "\n", "\n", "fh", "=", "logging", ".", "FileHandler", "(", "str", "(", "stdout_log_path", ")", ")", "\n", "formatter", "=", "logging", ".", "Formatter", "(", "fmt", "=", "'(%(levelname)s) %(asctime)s: %(message)s'", ",", "\n", "datefmt", "=", "LOGGER_DATEFMT", ")", "\n", "fh", ".", "setFormatter", "(", "formatter", ")", "\n", "logger", ".", "addHandler", "(", "fh", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.serialize": [[7, 42], ["list", "functools.wraps", "copy.deepcopy", "zip", "set", "get_default_params().items", "list", "setattr", "init", "inspect.signature", "serialization.get_classname", "dict", "copy.deepcopy.keys", "copy.deepcopy.items", "inspect.isclass", "serialization.get_default_params", "serialization.get_classname"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_classname", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_default_params", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_classname"], ["def", "serialize", "(", "init", ")", ":", "\n", "    ", "parameters", "=", "list", "(", "inspect", ".", "signature", "(", "init", ")", ".", "parameters", ")", "\n", "\n", "@", "wraps", "(", "init", ")", "\n", "def", "new_init", "(", "self", ",", "*", "args", ",", "**", "kwargs", ")", ":", "\n", "        ", "params", "=", "deepcopy", "(", "kwargs", ")", "\n", "for", "pname", ",", "value", "in", "zip", "(", "parameters", "[", "1", ":", "]", ",", "args", ")", ":", "\n", "            ", "params", "[", "pname", "]", "=", "value", "\n", "\n", "", "config", "=", "{", "\n", "'class'", ":", "get_classname", "(", "self", ".", "__class__", ")", ",", "\n", "'params'", ":", "dict", "(", ")", "\n", "}", "\n", "specified_params", "=", "set", "(", "params", ".", "keys", "(", ")", ")", "\n", "\n", "for", "pname", ",", "param", "in", "get_default_params", "(", "self", ".", "__class__", ")", ".", "items", "(", ")", ":", "\n", "            ", "if", "pname", "not", "in", "params", ":", "\n", "                ", "params", "[", "pname", "]", "=", "param", ".", "default", "\n", "\n", "", "", "for", "name", ",", "value", "in", "list", "(", "params", ".", "items", "(", ")", ")", ":", "\n", "            ", "param_type", "=", "'builtin'", "\n", "if", "inspect", ".", "isclass", "(", "value", ")", ":", "\n", "                ", "param_type", "=", "'class'", "\n", "value", "=", "get_classname", "(", "value", ")", "\n", "\n", "", "config", "[", "'params'", "]", "[", "name", "]", "=", "{", "\n", "'type'", ":", "param_type", ",", "\n", "'value'", ":", "value", ",", "\n", "'specified'", ":", "name", "in", "specified_params", "\n", "}", "\n", "\n", "", "setattr", "(", "self", ",", "'_config'", ",", "config", ")", "\n", "init", "(", "self", ",", "*", "args", ",", "**", "kwargs", ")", "\n", "\n", "", "return", "new_init", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.load_model": [[44, 65], ["serialization.get_class_from_str", "serialization.get_default_params", "dict", "config[].items", "dict.update", "get_class_from_str.", "serialization.get_class_from_str"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_class_from_str", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_default_params", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_class_from_str"], ["", "def", "load_model", "(", "config", ",", "**", "kwargs", ")", ":", "\n", "    ", "model_class", "=", "get_class_from_str", "(", "config", "[", "'class'", "]", ")", "\n", "model_default_params", "=", "get_default_params", "(", "model_class", ")", "\n", "\n", "model_args", "=", "dict", "(", ")", "\n", "for", "pname", ",", "param", "in", "config", "[", "'params'", "]", ".", "items", "(", ")", ":", "\n", "        ", "value", "=", "param", "[", "'value'", "]", "\n", "if", "param", "[", "'type'", "]", "==", "'class'", ":", "\n", "            ", "value", "=", "get_class_from_str", "(", "value", ")", "\n", "\n", "", "if", "pname", "not", "in", "model_default_params", "and", "not", "param", "[", "'specified'", "]", ":", "\n", "            ", "continue", "\n", "\n", "", "assert", "pname", "in", "model_default_params", "\n", "if", "not", "param", "[", "'specified'", "]", "and", "model_default_params", "[", "pname", "]", ".", "default", "==", "value", ":", "\n", "            ", "continue", "\n", "", "model_args", "[", "pname", "]", "=", "value", "\n", "\n", "", "model_args", ".", "update", "(", "kwargs", ")", "\n", "\n", "return", "model_class", "(", "**", "model_args", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_config_repr": [[67, 78], ["config[].items", "value.split", "str"], "function", ["None"], ["", "def", "get_config_repr", "(", "config", ")", ":", "\n", "    ", "config_str", "=", "f'Model: {config[\"class\"]}\\n'", "\n", "for", "pname", ",", "param", "in", "config", "[", "'params'", "]", ".", "items", "(", ")", ":", "\n", "        ", "value", "=", "param", "[", "\"value\"", "]", "\n", "if", "param", "[", "'type'", "]", "==", "'class'", ":", "\n", "            ", "value", "=", "value", ".", "split", "(", "'.'", ")", "[", "-", "1", "]", "\n", "", "param_str", "=", "f'{pname:<22} = {str(value):<12}'", "\n", "if", "not", "param", "[", "'specified'", "]", ":", "\n", "            ", "param_str", "+=", "' (default)'", "\n", "", "config_str", "+=", "param_str", "+", "'\\n'", "\n", "", "return", "config_str", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_default_params": [[80, 92], ["dict", "some_class.mro", "mclass_params.items", "inspect.signature"], "function", ["None"], ["", "def", "get_default_params", "(", "some_class", ")", ":", "\n", "    ", "params", "=", "dict", "(", ")", "\n", "for", "mclass", "in", "some_class", ".", "mro", "(", ")", ":", "\n", "        ", "if", "mclass", "is", "nn", ".", "Module", "or", "mclass", "is", "object", ":", "\n", "            ", "continue", "\n", "\n", "", "mclass_params", "=", "inspect", ".", "signature", "(", "mclass", ".", "__init__", ")", ".", "parameters", "\n", "for", "pname", ",", "param", "in", "mclass_params", ".", "items", "(", ")", ":", "\n", "            ", "if", "param", ".", "default", "!=", "param", ".", "empty", "and", "pname", "not", "in", "params", ":", "\n", "                ", "params", "[", "pname", "]", "=", "param", "\n", "\n", "", "", "", "return", "params", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_classname": [[94, 100], ["None"], "function", ["None"], ["", "def", "get_classname", "(", "cls", ")", ":", "\n", "    ", "module", "=", "cls", ".", "__module__", "\n", "name", "=", "cls", ".", "__qualname__", "\n", "if", "module", "is", "not", "None", "and", "module", "!=", "\"__builtin__\"", ":", "\n", "        ", "name", "=", "module", "+", "\".\"", "+", "name", "\n", "", "return", "name", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_class_from_str": [[102, 108], ["class_str.split", "__import__", "getattr"], "function", ["None"], ["", "def", "get_class_from_str", "(", "class_str", ")", ":", "\n", "    ", "components", "=", "class_str", ".", "split", "(", "'.'", ")", "\n", "mod", "=", "__import__", "(", "'.'", ".", "join", "(", "components", "[", ":", "-", "1", "]", ")", ")", "\n", "for", "comp", "in", "components", "[", "1", ":", "]", ":", "\n", "        ", "mod", "=", "getattr", "(", "mod", ",", "comp", ")", "\n", "", "return", "mod", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.visualize_instances": [[6, 22], ["vis.get_palette", "palette[].astype", "imask.max", "vis.get_boundaries", "tresult.astype.astype", "result.astype.astype"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.get_palette", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.get_boundaries"], ["def", "visualize_instances", "(", "imask", ",", "bg_color", "=", "255", ",", "\n", "boundaries_color", "=", "None", ",", "boundaries_width", "=", "1", ",", "boundaries_alpha", "=", "0.8", ")", ":", "\n", "    ", "num_objects", "=", "imask", ".", "max", "(", ")", "+", "1", "\n", "palette", "=", "get_palette", "(", "num_objects", ")", "\n", "if", "bg_color", "is", "not", "None", ":", "\n", "        ", "palette", "[", "0", "]", "=", "bg_color", "\n", "\n", "", "result", "=", "palette", "[", "imask", "]", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "if", "boundaries_color", "is", "not", "None", ":", "\n", "        ", "boundaries_mask", "=", "get_boundaries", "(", "imask", ",", "boundaries_width", "=", "boundaries_width", ")", "\n", "tresult", "=", "result", ".", "astype", "(", "np", ".", "float32", ")", "\n", "tresult", "[", "boundaries_mask", "]", "=", "boundaries_color", "\n", "tresult", "=", "tresult", "*", "boundaries_alpha", "+", "(", "1", "-", "boundaries_alpha", ")", "*", "result", "\n", "result", "=", "tresult", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "\n", "", "return", "result", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.get_palette": [[24, 40], ["functools.lru_cache", "numpy.zeros", "range", "np.zeros.reshape"], "function", ["None"], ["", "@", "lru_cache", "(", "maxsize", "=", "16", ")", "\n", "def", "get_palette", "(", "num_cls", ")", ":", "\n", "    ", "palette", "=", "np", ".", "zeros", "(", "3", "*", "num_cls", ",", "dtype", "=", "np", ".", "int32", ")", "\n", "\n", "for", "j", "in", "range", "(", "0", ",", "num_cls", ")", ":", "\n", "        ", "lab", "=", "j", "\n", "i", "=", "0", "\n", "\n", "while", "lab", ">", "0", ":", "\n", "            ", "palette", "[", "j", "*", "3", "+", "0", "]", "|=", "(", "(", "(", "lab", ">>", "0", ")", "&", "1", ")", "<<", "(", "7", "-", "i", ")", ")", "\n", "palette", "[", "j", "*", "3", "+", "1", "]", "|=", "(", "(", "(", "lab", ">>", "1", ")", "&", "1", ")", "<<", "(", "7", "-", "i", ")", ")", "\n", "palette", "[", "j", "*", "3", "+", "2", "]", "|=", "(", "(", "(", "lab", ">>", "2", ")", "&", "1", ")", "<<", "(", "7", "-", "i", ")", ")", "\n", "i", "=", "i", "+", "1", "\n", "lab", ">>=", "3", "\n", "\n", "", "", "return", "palette", ".", "reshape", "(", "(", "-", "1", ",", "3", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.visualize_mask": [[42, 47], ["vis.get_palette", "palette[].astype"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.get_palette"], ["", "def", "visualize_mask", "(", "mask", ",", "num_cls", ")", ":", "\n", "    ", "palette", "=", "get_palette", "(", "num_cls", ")", "\n", "mask", "[", "mask", "==", "-", "1", "]", "=", "0", "\n", "\n", "return", "palette", "[", "mask", "]", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.visualize_proposals": [[49, 57], ["vis.draw_probmap", "cv2.circle"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap"], ["", "def", "visualize_proposals", "(", "proposals_info", ",", "point_color", "=", "(", "255", ",", "0", ",", "0", ")", ",", "point_radius", "=", "1", ")", ":", "\n", "    ", "proposal_map", ",", "colors", ",", "candidates", "=", "proposals_info", "\n", "\n", "proposal_map", "=", "draw_probmap", "(", "proposal_map", ")", "\n", "for", "x", ",", "y", "in", "candidates", ":", "\n", "        ", "proposal_map", "=", "cv2", ".", "circle", "(", "proposal_map", ",", "(", "y", ",", "x", ")", ",", "point_radius", ",", "point_color", ",", "-", "1", ")", "\n", "\n", "", "return", "proposal_map", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap": [[59, 61], ["cv2.applyColorMap"], "function", ["None"], ["", "def", "draw_probmap", "(", "x", ")", ":", "\n", "    ", "return", "cv2", ".", "applyColorMap", "(", "(", "x", "*", "255", ")", ".", "astype", "(", "np", ".", "uint8", ")", ",", "cv2", ".", "COLORMAP_HOT", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points": [[63, 75], ["cv2.circle.copy", "cv2.circle", "len", "int", "int", "numpy.np.uint8"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy"], ["", "def", "draw_points", "(", "image", ",", "points", ",", "color", ",", "radius", "=", "3", ")", ":", "\n", "    ", "image", "=", "image", ".", "copy", "(", ")", "\n", "for", "p", "in", "points", ":", "\n", "        ", "if", "p", "[", "0", "]", "<", "0", ":", "\n", "            ", "continue", "\n", "", "if", "len", "(", "p", ")", "==", "3", ":", "\n", "            ", "pradius", "=", "{", "0", ":", "8", ",", "1", ":", "6", ",", "2", ":", "4", "}", "[", "p", "[", "2", "]", "]", "if", "p", "[", "2", "]", "<", "3", "else", "2", "\n", "", "else", ":", "\n", "            ", "pradius", "=", "radius", "\n", "", "image", "=", "cv2", ".", "circle", "(", "image", ",", "(", "int", "(", "p", "[", "1", "]", ")", ",", "int", "(", "p", "[", "0", "]", ")", ")", ",", "pradius", ",", "color", ",", "-", "1", ")", "\n", "\n", "", "return", "image", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_instance_map": [[77, 83], ["palette[].astype", "x.max", "vis.get_palette"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.get_palette"], ["", "def", "draw_instance_map", "(", "x", ",", "palette", "=", "None", ")", ":", "\n", "    ", "num_colors", "=", "x", ".", "max", "(", ")", "+", "1", "\n", "if", "palette", "is", "None", ":", "\n", "        ", "palette", "=", "get_palette", "(", "num_colors", ")", "\n", "\n", "", "return", "palette", "[", "x", "]", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.blend_mask": [[85, 92], ["vis.draw_instance_map", "mask.min", "mask.copy"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_instance_map", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy"], ["", "def", "blend_mask", "(", "image", ",", "mask", ",", "alpha", "=", "0.6", ")", ":", "\n", "    ", "if", "mask", ".", "min", "(", ")", "==", "-", "1", ":", "\n", "        ", "mask", "=", "mask", ".", "copy", "(", ")", "+", "1", "\n", "\n", "", "imap", "=", "draw_instance_map", "(", "mask", ")", "\n", "result", "=", "(", "image", "*", "(", "1", "-", "alpha", ")", "+", "alpha", "*", "imap", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "return", "result", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.get_boundaries": [[94, 108], ["numpy.zeros", "numpy.unique", "instances_masks.flatten", "cv2.getStructuringElement", "cv2.erode().astype", "numpy.logical_xor", "numpy.logical_or", "numpy.logical_and", "cv2.erode", "obj_mask.astype"], "function", ["None"], ["", "def", "get_boundaries", "(", "instances_masks", ",", "boundaries_width", "=", "1", ")", ":", "\n", "    ", "boundaries", "=", "np", ".", "zeros", "(", "(", "instances_masks", ".", "shape", "[", "0", "]", ",", "instances_masks", ".", "shape", "[", "1", "]", ")", ",", "dtype", "=", "np", ".", "bool", ")", "\n", "\n", "for", "obj_id", "in", "np", ".", "unique", "(", "instances_masks", ".", "flatten", "(", ")", ")", ":", "\n", "        ", "if", "obj_id", "==", "0", ":", "\n", "            ", "continue", "\n", "\n", "", "obj_mask", "=", "instances_masks", "==", "obj_id", "\n", "kernel", "=", "cv2", ".", "getStructuringElement", "(", "cv2", ".", "MORPH_ELLIPSE", ",", "(", "3", ",", "3", ")", ")", "\n", "inner_mask", "=", "cv2", ".", "erode", "(", "obj_mask", ".", "astype", "(", "np", ".", "uint8", ")", ",", "kernel", ",", "iterations", "=", "boundaries_width", ")", ".", "astype", "(", "np", ".", "bool", ")", "\n", "\n", "obj_boundary", "=", "np", ".", "logical_xor", "(", "obj_mask", ",", "np", ".", "logical_and", "(", "inner_mask", ",", "obj_mask", ")", ")", "\n", "boundaries", "=", "np", ".", "logical_or", "(", "boundaries", ",", "obj_boundary", ")", "\n", "", "return", "boundaries", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_with_blend_and_clicks": [[110, 134], ["img.copy", "vis.get_palette", "draw_points.astype", "vis.draw_points", "vis.draw_points", "len", "numpy.max", "mask.astype"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.get_palette", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points"], ["", "def", "draw_with_blend_and_clicks", "(", "img", ",", "mask", "=", "None", ",", "alpha", "=", "0.6", ",", "clicks_list", "=", "None", ",", "pos_color", "=", "(", "0", ",", "255", ",", "0", ")", ",", "\n", "neg_color", "=", "(", "255", ",", "0", ",", "0", ")", ",", "radius", "=", "4", ")", ":", "\n", "    ", "result", "=", "img", ".", "copy", "(", ")", "\n", "\n", "if", "mask", "is", "not", "None", ":", "\n", "        ", "palette", "=", "get_palette", "(", "np", ".", "max", "(", "mask", ")", "+", "1", ")", "\n", "rgb_mask", "=", "palette", "[", "mask", ".", "astype", "(", "np", ".", "uint8", ")", "]", "\n", "\n", "mask_region", "=", "(", "mask", ">", "0", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "result", "=", "result", "*", "(", "1", "-", "mask_region", "[", ":", ",", ":", ",", "np", ".", "newaxis", "]", ")", "+", "(", "1", "-", "alpha", ")", "*", "mask_region", "[", ":", ",", ":", ",", "np", ".", "newaxis", "]", "*", "result", "+", "alpha", "*", "rgb_mask", "\n", "result", "=", "result", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "\n", "# result = (result * (1 - alpha) + alpha * rgb_mask).astype(np.uint8)", "\n", "\n", "", "if", "clicks_list", "is", "not", "None", "and", "len", "(", "clicks_list", ")", ">", "0", ":", "\n", "        ", "pos_points", "=", "[", "click", ".", "coords", "for", "click", "in", "clicks_list", "if", "click", ".", "is_positive", "]", "\n", "neg_points", "=", "[", "click", ".", "coords", "for", "click", "in", "clicks_list", "if", "not", "click", ".", "is_positive", "]", "\n", "\n", "result", "=", "draw_points", "(", "result", ",", "pos_points", ",", "pos_color", ",", "radius", "=", "radius", ")", "\n", "result", "=", "draw_points", "(", "result", ",", "neg_points", ",", "neg_color", ",", "radius", "=", "radius", ")", "\n", "\n", "", "return", "result", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag": [[136, 143], ["cv2.vconcat.astype", "cv2.putText", "cv2.vconcat", "numpy.ones().astype", "numpy.ones"], "function", ["None"], ["", "def", "add_tag", "(", "image", ",", "tag", "=", "'nodefined'", ",", "tag_h", "=", "40", ")", ":", "\n", "    ", "image", "=", "image", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "H", ",", "W", "=", "image", ".", "shape", "[", "0", "]", ",", "image", ".", "shape", "[", "1", "]", "\n", "tag_blanc", "=", "np", ".", "ones", "(", "(", "tag_h", ",", "W", ",", "3", ")", ")", ".", "astype", "(", "np", ".", "uint8", ")", "*", "255", "\n", "cv2", ".", "putText", "(", "tag_blanc", ",", "tag", ",", "(", "10", ",", "30", ")", ",", "cv2", ".", "FONT_HERSHEY_COMPLEX", ",", "0.5", ",", "(", "0", ",", "0", ",", "0", ")", ",", "1", ")", "\n", "image", "=", "cv2", ".", "vconcat", "(", "[", "image", ",", "tag_blanc", "]", ")", "\n", "return", "image", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cython._get_dist_maps.make_ext": [[3, 8], ["Extension", "numpy.get_include"], "function", ["None"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.BilinearConvTranspose2d.__init__": [[22, 35], ["torch.nn.ConvTranspose2d.__init__", "ops.BilinearConvTranspose2d.apply", "isegm.Bilinear"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "scale", ",", "groups", "=", "1", ")", ":", "\n", "        ", "kernel_size", "=", "2", "*", "scale", "-", "scale", "%", "2", "\n", "self", ".", "scale", "=", "scale", "\n", "\n", "super", "(", ")", ".", "__init__", "(", "\n", "in_channels", ",", "out_channels", ",", "\n", "kernel_size", "=", "kernel_size", ",", "\n", "stride", "=", "scale", ",", "\n", "padding", "=", "1", ",", "\n", "groups", "=", "groups", ",", "\n", "bias", "=", "False", ")", "\n", "\n", "self", ".", "apply", "(", "initializer", ".", "Bilinear", "(", "scale", "=", "scale", ",", "in_channels", "=", "in_channels", ",", "groups", "=", "groups", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.DistMaps.__init__": [[38, 47], ["torch.nn.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "norm_radius", ",", "spatial_scale", "=", "1.0", ",", "cpu_mode", "=", "False", ",", "use_disks", "=", "False", ")", ":", "\n", "        ", "super", "(", "DistMaps", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "spatial_scale", "=", "spatial_scale", "\n", "self", ".", "norm_radius", "=", "norm_radius", "\n", "self", ".", "cpu_mode", "=", "cpu_mode", "\n", "self", ".", "use_disks", "=", "use_disks", "\n", "if", "self", ".", "cpu_mode", ":", "\n", "            ", "from", "isegm", ".", "utils", ".", "cython", "import", "get_dist_maps", "\n", "self", ".", "_get_dist_maps", "=", "get_dist_maps", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.DistMaps.get_coord_features": [[48, 89], ["range", "torch.from_numpy().to().float", "points.view.view.view", "torch.split", "torch.arange", "torch.arange", "torch.meshgrid", "torch.stack().unsqueeze().repeat", "coords.view.view.add_", "coords.view.view.mul_", "coords.view.view.view", "coords.view.view.view", "coords.view.view.sqrt_().mul_().tanh_", "coords.view.view.append", "points.view.view.size", "points.view.view.size", "points.view.view.size", "points.view.view.size", "coords.view.view.div_", "coords.view.view.min", "ops.DistMaps._get_dist_maps", "torch.from_numpy().to", "torch.max", "torch.stack().unsqueeze", "coords.view.view.sqrt_().mul_", "points[].cpu().float().numpy", "torch.from_numpy", "torch.stack", "coords.view.view.sqrt_", "points[].cpu().float", "numpy.stack", "points[].cpu"], "methods", ["None"], ["", "", "def", "get_coord_features", "(", "self", ",", "points", ",", "batchsize", ",", "rows", ",", "cols", ")", ":", "\n", "        ", "if", "self", ".", "cpu_mode", ":", "\n", "            ", "coords", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "batchsize", ")", ":", "\n", "                ", "norm_delimeter", "=", "1.0", "if", "self", ".", "use_disks", "else", "self", ".", "spatial_scale", "*", "self", ".", "norm_radius", "\n", "coords", ".", "append", "(", "self", ".", "_get_dist_maps", "(", "points", "[", "i", "]", ".", "cpu", "(", ")", ".", "float", "(", ")", ".", "numpy", "(", ")", ",", "rows", ",", "cols", ",", "\n", "norm_delimeter", ")", ")", "\n", "", "coords", "=", "torch", ".", "from_numpy", "(", "np", ".", "stack", "(", "coords", ",", "axis", "=", "0", ")", ")", ".", "to", "(", "points", ".", "device", ")", ".", "float", "(", ")", "\n", "", "else", ":", "\n", "            ", "num_points", "=", "points", ".", "shape", "[", "1", "]", "//", "2", "\n", "points", "=", "points", ".", "view", "(", "-", "1", ",", "points", ".", "size", "(", "2", ")", ")", "\n", "points", ",", "points_order", "=", "torch", ".", "split", "(", "points", ",", "[", "2", ",", "1", "]", ",", "dim", "=", "1", ")", "\n", "\n", "invalid_points", "=", "torch", ".", "max", "(", "points", ",", "dim", "=", "1", ",", "keepdim", "=", "False", ")", "[", "0", "]", "<", "0", "\n", "row_array", "=", "torch", ".", "arange", "(", "start", "=", "0", ",", "end", "=", "rows", ",", "step", "=", "1", ",", "dtype", "=", "torch", ".", "float32", ",", "device", "=", "points", ".", "device", ")", "\n", "col_array", "=", "torch", ".", "arange", "(", "start", "=", "0", ",", "end", "=", "cols", ",", "step", "=", "1", ",", "dtype", "=", "torch", ".", "float32", ",", "device", "=", "points", ".", "device", ")", "\n", "\n", "coord_rows", ",", "coord_cols", "=", "torch", ".", "meshgrid", "(", "row_array", ",", "col_array", ")", "\n", "coords", "=", "torch", ".", "stack", "(", "(", "coord_rows", ",", "coord_cols", ")", ",", "dim", "=", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "points", ".", "size", "(", "0", ")", ",", "1", ",", "1", ",", "1", ")", "\n", "\n", "add_xy", "=", "(", "points", "*", "self", ".", "spatial_scale", ")", ".", "view", "(", "points", ".", "size", "(", "0", ")", ",", "points", ".", "size", "(", "1", ")", ",", "1", ",", "1", ")", "\n", "coords", ".", "add_", "(", "-", "add_xy", ")", "\n", "if", "not", "self", ".", "use_disks", ":", "\n", "                ", "coords", ".", "div_", "(", "self", ".", "norm_radius", "*", "self", ".", "spatial_scale", ")", "\n", "", "coords", ".", "mul_", "(", "coords", ")", "\n", "\n", "coords", "[", ":", ",", "0", "]", "+=", "coords", "[", ":", ",", "1", "]", "\n", "coords", "=", "coords", "[", ":", ",", ":", "1", "]", "\n", "\n", "coords", "[", "invalid_points", ",", ":", ",", ":", ",", ":", "]", "=", "1e6", "\n", "\n", "coords", "=", "coords", ".", "view", "(", "-", "1", ",", "num_points", ",", "1", ",", "rows", ",", "cols", ")", "\n", "coords", "=", "coords", ".", "min", "(", "dim", "=", "1", ")", "[", "0", "]", "# -> (bs * num_masks * 2) x 1 x h x w", "\n", "coords", "=", "coords", ".", "view", "(", "-", "1", ",", "2", ",", "rows", ",", "cols", ")", "\n", "\n", "", "if", "self", ".", "use_disks", ":", "\n", "            ", "coords", "=", "(", "coords", "<=", "(", "self", ".", "norm_radius", "*", "self", ".", "spatial_scale", ")", "**", "2", ")", ".", "float", "(", ")", "\n", "", "else", ":", "\n", "            ", "coords", ".", "sqrt_", "(", ")", ".", "mul_", "(", "2", ")", ".", "tanh_", "(", ")", "\n", "\n", "", "return", "coords", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.DistMaps.forward": [[90, 92], ["ops.DistMaps.get_coord_features"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features"], ["", "def", "forward", "(", "self", ",", "x", ",", "coords", ")", ":", "\n", "        ", "return", "self", ".", "get_coord_features", "(", "coords", ",", "x", ".", "shape", "[", "0", "]", ",", "x", ".", "shape", "[", "2", "]", ",", "x", ".", "shape", "[", "3", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.ScaleLayer.__init__": [[95, 100], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.full"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "init_value", "=", "1.0", ",", "lr_mult", "=", "1", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "lr_mult", "=", "lr_mult", "\n", "self", ".", "scale", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "full", "(", "(", "1", ",", ")", ",", "init_value", "/", "lr_mult", ",", "dtype", "=", "torch", ".", "float32", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.ScaleLayer.forward": [[102, 105], ["torch.abs"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "scale", "=", "torch", ".", "abs", "(", "self", ".", "scale", "*", "self", ".", "lr_mult", ")", "\n", "return", "x", "*", "scale", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.BatchImageNormalize.__init__": [[108, 111], ["torch.as_tensor", "torch.as_tensor"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "mean", ",", "std", ",", "dtype", "=", "torch", ".", "float", ")", ":", "\n", "        ", "self", ".", "mean", "=", "torch", ".", "as_tensor", "(", "mean", ",", "dtype", "=", "dtype", ")", "[", "None", ",", ":", ",", "None", ",", "None", "]", "\n", "self", ".", "std", "=", "torch", ".", "as_tensor", "(", "std", ",", "dtype", "=", "dtype", ")", "[", "None", ",", ":", ",", "None", ",", "None", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.BatchImageNormalize.__call__": [[112, 117], ["tensor.clone.clone.clone", "tensor.clone.clone.sub_().div_", "ops.BatchImageNormalize.std.to", "tensor.clone.clone.sub_", "ops.BatchImageNormalize.mean.to"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "tensor", ")", ":", "\n", "        ", "tensor", "=", "tensor", ".", "clone", "(", ")", "\n", "\n", "tensor", ".", "sub_", "(", "self", ".", "mean", ".", "to", "(", "tensor", ".", "device", ")", ")", ".", "div_", "(", "self", ".", "std", ".", "to", "(", "tensor", ".", "device", ")", ")", "\n", "return", "tensor", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.select_activation_function": [[7, 19], ["isinstance", "isinstance", "activation.lower", "ValueError", "activation.lower", "ValueError"], "function", ["None"], ["def", "select_activation_function", "(", "activation", ")", ":", "\n", "    ", "if", "isinstance", "(", "activation", ",", "str", ")", ":", "\n", "        ", "if", "activation", ".", "lower", "(", ")", "==", "'relu'", ":", "\n", "            ", "return", "nn", ".", "ReLU", "\n", "", "elif", "activation", ".", "lower", "(", ")", "==", "'softplus'", ":", "\n", "            ", "return", "nn", ".", "Softplus", "\n", "", "else", ":", "\n", "            ", "raise", "ValueError", "(", "f\"Unknown activation type {activation}\"", ")", "\n", "", "", "elif", "isinstance", "(", "activation", ",", "nn", ".", "Module", ")", ":", "\n", "        ", "return", "activation", "\n", "", "else", ":", "\n", "        ", "raise", "ValueError", "(", "f\"Unknown activation type {activation}\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_model.ISModel.__init__": [[10, 42], ["torch.Module.__init__", "isegm.model.ops.BatchImageNormalize", "torch.Sequential", "torch.Sequential", "isegm.model.ops.DistMaps", "isegm.model.ops.DistMaps", "len", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "isegm.model.ops.ScaleLayer", "torch.LeakyReLU", "torch.LeakyReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "use_rgb_conv", "=", "True", ",", "feature_stride", "=", "4", ",", "with_aux_output", "=", "False", ",", "\n", "norm_radius", "=", "260", ",", "use_disks", "=", "False", ",", "cpu_dist_maps", "=", "False", ",", "\n", "clicks_groups", "=", "None", ",", "with_prev_mask", "=", "False", ",", "use_leaky_relu", "=", "False", ",", "\n", "binary_prev_mask", "=", "False", ",", "conv_extend", "=", "False", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "\n", "norm_mean_std", "=", "(", "[", ".485", ",", ".456", ",", ".406", "]", ",", "[", ".229", ",", ".224", ",", ".225", "]", ")", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "with_aux_output", "=", "with_aux_output", "\n", "self", ".", "clicks_groups", "=", "clicks_groups", "\n", "self", ".", "with_prev_mask", "=", "with_prev_mask", "\n", "self", ".", "binary_prev_mask", "=", "binary_prev_mask", "\n", "self", ".", "normalization", "=", "BatchImageNormalize", "(", "norm_mean_std", "[", "0", "]", ",", "norm_mean_std", "[", "1", "]", ")", "\n", "\n", "self", ".", "coord_feature_ch", "=", "2", "\n", "if", "clicks_groups", "is", "not", "None", ":", "\n", "            ", "self", ".", "coord_feature_ch", "*=", "len", "(", "clicks_groups", ")", "\n", "\n", "", "if", "self", ".", "with_prev_mask", ":", "\n", "            ", "self", ".", "coord_feature_ch", "+=", "1", "\n", "\n", "", "mt_layers", "=", "[", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "coord_feature_ch", ",", "out_channels", "=", "16", ",", "kernel_size", "=", "1", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "negative_slope", "=", "0.2", ")", "if", "use_leaky_relu", "else", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "16", ",", "out_channels", "=", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ")", ",", "\n", "ScaleLayer", "(", "init_value", "=", "0.05", ",", "lr_mult", "=", "1", ")", "\n", "]", "\n", "self", ".", "maps_transform", "=", "nn", ".", "Sequential", "(", "*", "mt_layers", ")", "\n", "\n", "self", ".", "dist_maps_2", "=", "DistMaps", "(", "norm_radius", "=", "2", ",", "spatial_scale", "=", "1.0", ",", "\n", "cpu_mode", "=", "cpu_dist_maps", ",", "use_disks", "=", "use_disks", ")", "\n", "\n", "self", ".", "dist_maps_5", "=", "DistMaps", "(", "norm_radius", "=", "5", ",", "spatial_scale", "=", "1.0", ",", "\n", "cpu_mode", "=", "cpu_dist_maps", ",", "use_disks", "=", "use_disks", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_model.ISModel.prepare_input": [[45, 55], ["is_model.ISModel.normalization"], "methods", ["None"], ["", "def", "prepare_input", "(", "self", ",", "image", ")", ":", "\n", "        ", "prev_mask", "=", "None", "\n", "if", "self", ".", "with_prev_mask", ":", "\n", "            ", "prev_mask", "=", "image", "[", ":", ",", "3", ":", ",", ":", ",", ":", "]", "\n", "image", "=", "image", "[", ":", ",", ":", "3", ",", ":", ",", ":", "]", "\n", "if", "self", ".", "binary_prev_mask", ":", "\n", "                ", "prev_mask", "=", "(", "prev_mask", ">", "0.5", ")", ".", "float", "(", ")", "\n", "\n", "", "", "image", "=", "self", ".", "normalization", "(", "image", ")", "\n", "return", "image", ",", "prev_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_model.ISModel.backbone_forward": [[56, 58], ["None"], "methods", ["None"], ["", "def", "backbone_forward", "(", "self", ",", "image", ",", "coord_features", "=", "None", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_model.ISModel.get_coord_features": [[59, 71], ["is_model.split_points_by_order", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "is_model.ISModel.dist_maps_2", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "dist_map", "zip", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_model.split_points_by_order"], ["", "def", "get_coord_features", "(", "self", ",", "image", ",", "prev_mask", ",", "points", ")", ":", "\n", "        ", "if", "self", ".", "clicks_groups", "is", "not", "None", ":", "\n", "            ", "points_groups", "=", "split_points_by_order", "(", "points", ",", "groups", "=", "(", "2", ",", ")", "+", "(", "1", ",", ")", "*", "(", "len", "(", "self", ".", "clicks_groups", ")", "-", "2", ")", "+", "(", "-", "1", ",", ")", ")", "\n", "coord_features", "=", "[", "dist_map", "(", "image", ",", "pg", ")", "for", "dist_map", ",", "pg", "in", "zip", "(", "self", ".", "dist_maps", ",", "points_groups", ")", "]", "\n", "coord_features", "=", "torch", ".", "cat", "(", "coord_features", ",", "dim", "=", "1", ")", "\n", "", "else", ":", "\n", "            ", "coord_features", "=", "self", ".", "dist_maps_2", "(", "image", ",", "points", ")", "\n", "\n", "", "if", "prev_mask", "is", "not", "None", ":", "\n", "            ", "coord_features", "=", "torch", ".", "cat", "(", "(", "prev_mask", ",", "coord_features", ")", ",", "dim", "=", "1", ")", "\n", "\n", "", "return", "coord_features", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_model.ISModel.load_pretrained_weights": [[72, 88], ["is_model.ISModel.state_dict", "set", "set", "print", "print", "is_model.ISModel.update", "is_model.ISModel.load_state_dict", "torch.load", "torch.load", "torch.load", "torch.load", "pretrained_state_dict.keys", "is_model.ISModel.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_pretrained_weights", "(", "self", ",", "path_to_weights", "=", "''", ")", ":", "\n", "        ", "state_dict", "=", "self", ".", "state_dict", "(", ")", "\n", "pretrained_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "[", "'state_dict'", "]", "\n", "ckpt_keys", "=", "set", "(", "pretrained_state_dict", ".", "keys", "(", ")", ")", "\n", "own_keys", "=", "set", "(", "state_dict", ".", "keys", "(", ")", ")", "\n", "missing_keys", "=", "own_keys", "-", "ckpt_keys", "\n", "unexpected_keys", "=", "ckpt_keys", "-", "own_keys", "\n", "print", "(", "'Missing Keys: '", ",", "missing_keys", ")", "\n", "print", "(", "'Unexpected Keys: '", ",", "unexpected_keys", ")", "\n", "state_dict", ".", "update", "(", "pretrained_state_dict", ")", "\n", "self", ".", "load_state_dict", "(", "state_dict", ",", "strict", "=", "False", ")", "\n", "'''\n        if self.inference_mode:\n            for param in self.backbone.parameters():\n                param.requires_grad = False\n        '''", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_model.split_points_by_order": [[90, 124], ["tpoints.cpu().numpy", "len", "numpy.zeros", "enumerate", "range", "numpy.full", "range", "torch.tensor", "torch.tensor", "tpoints.cpu", "int", "int"], "function", ["None"], ["", "", "def", "split_points_by_order", "(", "tpoints", ":", "torch", ".", "Tensor", ",", "groups", ")", ":", "\n", "    ", "points", "=", "tpoints", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "num_groups", "=", "len", "(", "groups", ")", "\n", "bs", "=", "points", ".", "shape", "[", "0", "]", "\n", "num_points", "=", "points", ".", "shape", "[", "1", "]", "//", "2", "\n", "\n", "groups", "=", "[", "x", "if", "x", ">", "0", "else", "num_points", "for", "x", "in", "groups", "]", "\n", "group_points", "=", "[", "np", ".", "full", "(", "(", "bs", ",", "2", "*", "x", ",", "3", ")", ",", "-", "1", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "for", "x", "in", "groups", "]", "\n", "\n", "last_point_indx_group", "=", "np", ".", "zeros", "(", "(", "bs", ",", "num_groups", ",", "2", ")", ",", "dtype", "=", "np", ".", "int", ")", "\n", "for", "group_indx", ",", "group_size", "in", "enumerate", "(", "groups", ")", ":", "\n", "        ", "last_point_indx_group", "[", ":", ",", "group_indx", ",", "1", "]", "=", "group_size", "\n", "\n", "", "for", "bindx", "in", "range", "(", "bs", ")", ":", "\n", "        ", "for", "pindx", "in", "range", "(", "2", "*", "num_points", ")", ":", "\n", "            ", "point", "=", "points", "[", "bindx", ",", "pindx", ",", ":", "]", "\n", "group_id", "=", "int", "(", "point", "[", "2", "]", ")", "\n", "if", "group_id", "<", "0", ":", "\n", "                ", "continue", "\n", "\n", "", "is_negative", "=", "int", "(", "pindx", ">=", "num_points", ")", "\n", "if", "group_id", ">=", "num_groups", "or", "(", "group_id", "==", "0", "and", "is_negative", ")", ":", "# disable negative first click", "\n", "                ", "group_id", "=", "num_groups", "-", "1", "\n", "\n", "", "new_point_indx", "=", "last_point_indx_group", "[", "bindx", ",", "group_id", ",", "is_negative", "]", "\n", "last_point_indx_group", "[", "bindx", ",", "group_id", ",", "is_negative", "]", "+=", "1", "\n", "\n", "group_points", "[", "group_id", "]", "[", "bindx", ",", "new_point_indx", ",", ":", "]", "=", "point", "\n", "\n", "", "", "group_points", "=", "[", "torch", ".", "tensor", "(", "x", ",", "dtype", "=", "tpoints", ".", "dtype", ",", "device", "=", "tpoints", ".", "device", ")", "\n", "for", "x", "in", "group_points", "]", "\n", "\n", "return", "group_points", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.TrainMetric.__init__": [[8, 11], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "pred_outputs", ",", "gt_outputs", ")", ":", "\n", "        ", "self", ".", "pred_outputs", "=", "pred_outputs", "\n", "self", ".", "gt_outputs", "=", "gt_outputs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.TrainMetric.update": [[12, 14], ["None"], "methods", ["None"], ["", "def", "update", "(", "self", ",", "*", "args", ",", "**", "kwargs", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.TrainMetric.get_epoch_value": [[15, 17], ["None"], "methods", ["None"], ["", "def", "get_epoch_value", "(", "self", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.TrainMetric.reset_epoch_stats": [[18, 20], ["None"], "methods", ["None"], ["", "def", "reset_epoch_stats", "(", "self", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.TrainMetric.log_states": [[21, 23], ["None"], "methods", ["None"], ["", "def", "log_states", "(", "self", ",", "sw", ",", "tag_prefix", ",", "global_step", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.TrainMetric.name": [[24, 27], ["type"], "methods", ["None"], ["", "@", "property", "\n", "def", "name", "(", "self", ")", ":", "\n", "        ", "return", "type", "(", "self", ")", ".", "__name__", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.__init__": [[30, 43], ["metrics.TrainMetric.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "init_thresh", "=", "0.4", ",", "thresh_step", "=", "0.025", ",", "thresh_beta", "=", "0.99", ",", "iou_beta", "=", "0.9", ",", "\n", "ignore_label", "=", "-", "1", ",", "from_logits", "=", "True", ",", "\n", "pred_output", "=", "'instances'", ",", "gt_output", "=", "'instances'", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "pred_outputs", "=", "(", "pred_output", ",", ")", ",", "gt_outputs", "=", "(", "gt_output", ",", ")", ")", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "self", ".", "_from_logits", "=", "from_logits", "\n", "self", ".", "_iou_thresh", "=", "init_thresh", "\n", "self", ".", "_thresh_step", "=", "thresh_step", "\n", "self", ".", "_thresh_beta", "=", "thresh_beta", "\n", "self", ".", "_iou_beta", "=", "iou_beta", "\n", "self", ".", "_ema_iou", "=", "0.0", "\n", "self", ".", "_epoch_iou_sum", "=", "0.0", "\n", "self", ".", "_epoch_batch_count", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update": [[44, 66], ["torch.sum().detach().cpu().numpy", "numpy.all", "_compute_iou().mean", "torch.sigmoid", "_compute_iou().mean", "torch.sum().detach().cpu", "metrics._compute_iou", "metrics._compute_iou", "torch.sum().detach", "torch.sum"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics._compute_iou", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics._compute_iou"], ["", "def", "update", "(", "self", ",", "pred", ",", "gt", ")", ":", "\n", "        ", "gt_mask", "=", "gt", ">", "0.5", "\n", "if", "self", ".", "_from_logits", ":", "\n", "            ", "pred", "=", "torch", ".", "sigmoid", "(", "pred", ")", "\n", "\n", "", "gt_mask_area", "=", "torch", ".", "sum", "(", "gt_mask", ",", "dim", "=", "(", "1", ",", "2", ")", ")", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "np", ".", "all", "(", "gt_mask_area", "==", "0", ")", ":", "\n", "            ", "return", "\n", "\n", "", "ignore_mask", "=", "gt", "==", "self", ".", "_ignore_label", "\n", "max_iou", "=", "_compute_iou", "(", "pred", ">", "self", ".", "_iou_thresh", ",", "gt_mask", ",", "ignore_mask", ")", ".", "mean", "(", ")", "\n", "best_thresh", "=", "self", ".", "_iou_thresh", "\n", "for", "t", "in", "[", "best_thresh", "-", "self", ".", "_thresh_step", ",", "best_thresh", "+", "self", ".", "_thresh_step", "]", ":", "\n", "            ", "temp_iou", "=", "_compute_iou", "(", "pred", ">", "t", ",", "gt_mask", ",", "ignore_mask", ")", ".", "mean", "(", ")", "\n", "if", "temp_iou", ">", "max_iou", ":", "\n", "                ", "max_iou", "=", "temp_iou", "\n", "best_thresh", "=", "t", "\n", "\n", "", "", "self", ".", "_iou_thresh", "=", "self", ".", "_thresh_beta", "*", "self", ".", "_iou_thresh", "+", "(", "1", "-", "self", ".", "_thresh_beta", ")", "*", "best_thresh", "\n", "self", ".", "_ema_iou", "=", "self", ".", "_iou_beta", "*", "self", ".", "_ema_iou", "+", "(", "1", "-", "self", ".", "_iou_beta", ")", "*", "max_iou", "\n", "self", ".", "_epoch_iou_sum", "+=", "max_iou", "\n", "self", ".", "_epoch_batch_count", "+=", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.get_epoch_value": [[67, 72], ["None"], "methods", ["None"], ["", "def", "get_epoch_value", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "_epoch_batch_count", ">", "0", ":", "\n", "            ", "return", "self", ".", "_epoch_iou_sum", "/", "self", ".", "_epoch_batch_count", "\n", "", "else", ":", "\n", "            ", "return", "0.0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.reset_epoch_stats": [[73, 76], ["None"], "methods", ["None"], ["", "", "def", "reset_epoch_stats", "(", "self", ")", ":", "\n", "        ", "self", ".", "_epoch_iou_sum", "=", "0.0", "\n", "self", ".", "_epoch_batch_count", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.log_states": [[77, 80], ["sw.add_scalar", "sw.add_scalar"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar"], ["", "def", "log_states", "(", "self", ",", "sw", ",", "tag_prefix", ",", "global_step", ")", ":", "\n", "        ", "sw", ".", "add_scalar", "(", "tag", "=", "tag_prefix", "+", "'_ema_iou'", ",", "value", "=", "self", ".", "_ema_iou", ",", "global_step", "=", "global_step", ")", "\n", "sw", ".", "add_scalar", "(", "tag", "=", "tag_prefix", "+", "'_iou_thresh'", ",", "value", "=", "self", ".", "_iou_thresh", ",", "global_step", "=", "global_step", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.iou_thresh": [[81, 84], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "iou_thresh", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "_iou_thresh", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics._compute_iou": [[86, 102], ["isegm.utils.misc.get_dims_with_exclusion", "torch.mean().detach().cpu().numpy", "torch.mean().detach().cpu().numpy", "torch.where", "gt_mask.dim", "numpy.full_like", "torch.zeros_like", "torch.mean().detach().cpu", "torch.mean().detach().cpu", "torch.mean().detach", "torch.mean().detach", "torch.mean", "torch.mean"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion"], ["", "", "def", "_compute_iou", "(", "pred_mask", ",", "gt_mask", ",", "ignore_mask", "=", "None", ",", "keep_ignore", "=", "False", ")", ":", "\n", "    ", "if", "ignore_mask", "is", "not", "None", ":", "\n", "        ", "pred_mask", "=", "torch", ".", "where", "(", "ignore_mask", ",", "torch", ".", "zeros_like", "(", "pred_mask", ")", ",", "pred_mask", ")", "\n", "\n", "", "reduction_dims", "=", "misc", ".", "get_dims_with_exclusion", "(", "gt_mask", ".", "dim", "(", ")", ",", "0", ")", "\n", "union", "=", "torch", ".", "mean", "(", "(", "pred_mask", "|", "gt_mask", ")", ".", "float", "(", ")", ",", "dim", "=", "reduction_dims", ")", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "intersection", "=", "torch", ".", "mean", "(", "(", "pred_mask", "&", "gt_mask", ")", ".", "float", "(", ")", ",", "dim", "=", "reduction_dims", ")", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "nonzero", "=", "union", ">", "0", "\n", "\n", "iou", "=", "intersection", "[", "nonzero", "]", "/", "union", "[", "nonzero", "]", "\n", "if", "not", "keep_ignore", ":", "\n", "        ", "return", "iou", "\n", "", "else", ":", "\n", "        ", "result", "=", "np", ".", "full_like", "(", "intersection", ",", "-", "1", ")", "\n", "result", "[", "nonzero", "]", "=", "iou", "\n", "return", "result", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.HRNetModel.__init__": [[13, 42], ["is_model.ISModel.__init__", "modeling.hrnet_ocr.HighResolutionNet", "is_hrnet_model.HRNetModel.feature_extractor.apply", "is_hrnet_model.HRNetModel.feature_extractor.apply", "is_hrnet_model.RefineLayer", "isegm.model.ops.DistMaps", "isegm.model.ops.DistMaps", "isegm.model.modifiers.LRMult", "is_hrnet_model.HRNetModel.feature_extractor.ocr_distri_head.apply", "is_hrnet_model.HRNetModel.feature_extractor.ocr_gather_head.apply", "is_hrnet_model.HRNetModel.feature_extractor.conv3x3_ocr.apply", "isegm.model.modifiers.LRMult", "isegm.model.modifiers.LRMult", "isegm.model.modifiers.LRMult", "isegm.model.modifiers.LRMult"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "@", "serialize", "\n", "def", "__init__", "(", "self", ",", "width", "=", "48", ",", "ocr_width", "=", "256", ",", "small", "=", "True", ",", "backbone_lr_mult", "=", "0.1", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "pipeline_version", "=", "'s1'", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "norm_layer", "=", "norm_layer", ",", "**", "kwargs", ")", "\n", "\n", "self", ".", "feature_extractor", "=", "HighResolutionNet", "(", "width", "=", "width", ",", "ocr_width", "=", "ocr_width", ",", "small", "=", "small", ",", "\n", "num_classes", "=", "1", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "feature_extractor", ".", "apply", "(", "LRMult", "(", "backbone_lr_mult", ")", ")", "\n", "if", "ocr_width", ">", "0", ":", "\n", "            ", "self", ".", "feature_extractor", ".", "ocr_distri_head", ".", "apply", "(", "LRMult", "(", "1.0", ")", ")", "\n", "self", ".", "feature_extractor", ".", "ocr_gather_head", ".", "apply", "(", "LRMult", "(", "1.0", ")", ")", "\n", "self", ".", "feature_extractor", ".", "conv3x3_ocr", ".", "apply", "(", "LRMult", "(", "1.0", ")", ")", "\n", "\n", "", "self", ".", "feature_extractor", ".", "apply", "(", "LRMult", "(", "2", ")", ")", "\n", "self", ".", "width", "=", "width", "\n", "self", ".", "pipeline_version", "=", "pipeline_version", "\n", "if", "self", ".", "pipeline_version", "==", "'s1'", ":", "\n", "            ", "base_radius", "=", "2", "\n", "", "else", ":", "\n", "            ", "base_radius", "=", "5", "\n", "\n", "", "self", ".", "refiner", "=", "RefineLayer", "(", "feature_dims", "=", "ocr_width", "*", "2", ")", "\n", "\n", "self", ".", "dist_maps_base", "=", "DistMaps", "(", "norm_radius", "=", "base_radius", ",", "spatial_scale", "=", "1.0", ",", "\n", "cpu_mode", "=", "False", ",", "use_disks", "=", "True", ")", "\n", "\n", "self", ".", "dist_maps_refine", "=", "DistMaps", "(", "norm_radius", "=", "5", ",", "spatial_scale", "=", "1.0", ",", "\n", "cpu_mode", "=", "False", ",", "use_disks", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.HRNetModel.get_coord_features": [[43, 48], ["is_hrnet_model.HRNetModel.dist_maps_base", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "get_coord_features", "(", "self", ",", "image", ",", "prev_mask", ",", "points", ")", ":", "\n", "        ", "coord_features", "=", "self", ".", "dist_maps_base", "(", "image", ",", "points", ")", "\n", "if", "prev_mask", "is", "not", "None", ":", "\n", "            ", "coord_features", "=", "torch", ".", "cat", "(", "(", "prev_mask", ",", "coord_features", ")", ",", "dim", "=", "1", ")", "\n", "", "return", "coord_features", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.HRNetModel.backbone_forward": [[49, 52], ["is_hrnet_model.HRNetModel.feature_extractor"], "methods", ["None"], ["", "def", "backbone_forward", "(", "self", ",", "image", ",", "coord_features", "=", "None", ")", ":", "\n", "        ", "mask", ",", "mask_aux", ",", "feature", "=", "self", ".", "feature_extractor", "(", "image", ",", "coord_features", ")", "\n", "return", "{", "'instances'", ":", "mask", ",", "'instances_aux'", ":", "mask_aux", ",", "'feature'", ":", "feature", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.HRNetModel.refine": [[53, 67], ["torchvision", "torchvision", "is_hrnet_model.HRNetModel.dist_maps_refine", "is_hrnet_model.HRNetModel.refiner", "full_feature.size", "cropped_image.size"], "methods", ["None"], ["", "def", "refine", "(", "self", ",", "cropped_image", ",", "cropped_points", ",", "full_feature", ",", "full_logits", ",", "bboxes", ")", ":", "\n", "        ", "'''\n        bboxes : [b,5]\n        '''", "\n", "h1", "=", "cropped_image", ".", "shape", "[", "-", "1", "]", "\n", "h2", "=", "full_feature", ".", "shape", "[", "-", "1", "]", "\n", "r", "=", "h1", "/", "h2", "\n", "\n", "cropped_feature", "=", "roi_align", "(", "full_feature", ",", "bboxes", ",", "full_feature", ".", "size", "(", ")", "[", "2", ":", "]", ",", "spatial_scale", "=", "1", "/", "r", ",", "aligned", "=", "True", ")", "\n", "cropped_logits", "=", "roi_align", "(", "full_logits", ",", "bboxes", ",", "cropped_image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "spatial_scale", "=", "1", ",", "aligned", "=", "True", ")", "\n", "\n", "click_map", "=", "self", ".", "dist_maps_refine", "(", "cropped_image", ",", "cropped_points", ")", "\n", "refined_mask", ",", "trimap", "=", "self", ".", "refiner", "(", "cropped_image", ",", "click_map", ",", "cropped_feature", ",", "cropped_logits", ")", "\n", "return", "{", "'instances_refined'", ":", "refined_mask", ",", "'instances_coarse'", ":", "cropped_logits", ",", "'trimap'", ":", "trimap", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.HRNetModel.forward": [[68, 90], ["is_hrnet_model.HRNetModel.prepare_input", "is_hrnet_model.HRNetModel.get_coord_features", "is_hrnet_model.HRNetModel.maps_transform", "is_hrnet_model.HRNetModel.backbone_forward", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "image.size", "image.size"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.backbone_forward"], ["", "def", "forward", "(", "self", ",", "image", ",", "points", ")", ":", "\n", "        ", "image", ",", "prev_mask", "=", "self", ".", "prepare_input", "(", "image", ")", "\n", "coord_features", "=", "self", ".", "get_coord_features", "(", "image", ",", "prev_mask", ",", "points", ")", "\n", "click_map", "=", "coord_features", "[", ":", ",", "1", ":", ",", ":", ",", ":", "]", "\n", "\n", "if", "self", ".", "pipeline_version", "==", "'s1'", ":", "\n", "            ", "small_image", "=", "F", ".", "interpolate", "(", "image", ",", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "small_coord_features", "=", "F", ".", "interpolate", "(", "coord_features", ",", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "", "else", ":", "\n", "            ", "small_image", "=", "image", "\n", "small_coord_features", "=", "coord_features", "\n", "\n", "", "small_coord_features", "=", "self", ".", "maps_transform", "(", "small_coord_features", ")", "\n", "outputs", "=", "self", ".", "backbone_forward", "(", "small_image", ",", "small_coord_features", ")", "\n", "\n", "outputs", "[", "'click_map'", "]", "=", "click_map", "\n", "outputs", "[", "'instances'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'instances'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "if", "self", ".", "with_aux_output", ":", "\n", "            ", "outputs", "[", "'instances_aux'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'instances_aux'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "", "return", "outputs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.RefineLayer.__init__": [[99, 127], ["torch.Module.__init__", "is_hrnet_model.ConvModule", "is_hrnet_model.XConvBnRelu", "is_hrnet_model.XConvBnRelu", "is_hrnet_model.ConvModule", "is_hrnet_model.XConvBnRelu", "is_hrnet_model.XConvBnRelu", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "input_dims", "=", "6", ",", "mid_dims", "=", "32", ",", "feature_dims", "=", "96", ",", "num_classes", "=", "1", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "RefineLayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "num_classes", "=", "num_classes", "\n", "self", ".", "image_conv1", "=", "ConvModule", "(", "\n", "in_channels", "=", "input_dims", ",", "\n", "out_channels", "=", "mid_dims", ",", "\n", "kernel_size", "=", "3", ",", "\n", "stride", "=", "2", ",", "\n", "padding", "=", "1", ",", "\n", "#norm_cfg=dict(type='BN', requires_grad=True),", "\n", ")", "\n", "self", ".", "image_conv2", "=", "XConvBnRelu", "(", "mid_dims", ",", "mid_dims", ")", "\n", "self", ".", "image_conv3", "=", "XConvBnRelu", "(", "mid_dims", ",", "mid_dims", ")", "\n", "\n", "\n", "self", ".", "refine_fusion", "=", "ConvModule", "(", "\n", "in_channels", "=", "feature_dims", ",", "\n", "out_channels", "=", "mid_dims", ",", "\n", "kernel_size", "=", "1", ",", "\n", "stride", "=", "1", ",", "\n", "padding", "=", "0", ",", "\n", "#norm_cfg=dict(type='BN', requires_grad=True),", "\n", ")", "\n", "\n", "self", ".", "refine_fusion2", "=", "XConvBnRelu", "(", "mid_dims", ",", "mid_dims", ")", "\n", "self", ".", "refine_fusion3", "=", "XConvBnRelu", "(", "mid_dims", ",", "mid_dims", ")", "\n", "self", ".", "refine_pred", "=", "nn", ".", "Conv2d", "(", "mid_dims", ",", "num_classes", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "refine_trimap", "=", "nn", ".", "Conv2d", "(", "mid_dims", ",", "num_classes", ",", "3", ",", "1", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.RefineLayer.forward": [[129, 155], ["torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "is_hrnet_model.RefineLayer.refine_fusion", "is_hrnet_model.RefineLayer.image_conv1", "is_hrnet_model.RefineLayer.image_conv2", "is_hrnet_model.RefineLayer.image_conv3", "is_hrnet_model.resize", "is_hrnet_model.RefineLayer.refine_fusion2", "is_hrnet_model.RefineLayer.refine_fusion3", "is_hrnet_model.RefineLayer.refine_pred", "is_hrnet_model.RefineLayer.refine_trimap", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "is_hrnet_model.RefineLayer.size", "torch.cat.size", "torch.cat.size", "torch.cat.size", "torch.cat.size", "torch.cat.size", "torch.cat.size"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "def", "forward", "(", "self", ",", "input_image", ",", "click_map", ",", "final_feature", ",", "cropped_logits", ")", ":", "\n", "#cropped_logits = cropped_logits.clone().detach()", "\n", "#final_feature = final_feature.clone().detach()", "\n", "\n", "        ", "mask", "=", "cropped_logits", "#resize(cropped_logits, size=input_image.size()[2:],mode='bilinear',align_corners=True)", "\n", "bin_mask", "=", "torch", ".", "sigmoid", "(", "mask", ")", "#> 0.49", "\n", "input_image", "=", "torch", ".", "cat", "(", "[", "input_image", ",", "click_map", ",", "bin_mask", "]", ",", "1", ")", "\n", "\n", "final_feature", "=", "self", ".", "refine_fusion", "(", "final_feature", ")", "\n", "image_feature", "=", "self", ".", "image_conv1", "(", "input_image", ")", "\n", "image_feature", "=", "self", ".", "image_conv2", "(", "image_feature", ")", "\n", "image_feature", "=", "self", ".", "image_conv3", "(", "image_feature", ")", "\n", "pred_feature", "=", "resize", "(", "final_feature", ",", "size", "=", "image_feature", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "#fusion_gate = self.feature_gate(final_feature)", "\n", "#fusion_gate = resize(fusion_gate, size=image_feature.size()[2:],mode='bilinear',align_corners=True)", "\n", "pred_feature", "=", "pred_feature", "+", "image_feature", "#* fusion_gate", "\n", "\n", "pred_feature", "=", "self", ".", "refine_fusion2", "(", "pred_feature", ")", "\n", "pred_feature", "=", "self", ".", "refine_fusion3", "(", "pred_feature", ")", "\n", "pred_full", "=", "self", ".", "refine_pred", "(", "pred_feature", ")", "\n", "trimap", "=", "self", ".", "refine_trimap", "(", "pred_feature", ")", "\n", "trimap", "=", "F", ".", "interpolate", "(", "trimap", ",", "size", "=", "input_image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "pred_full", "=", "F", ".", "interpolate", "(", "pred_full", ",", "size", "=", "input_image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "trimap_sig", "=", "torch", ".", "sigmoid", "(", "trimap", ")", "\n", "pred", "=", "pred_full", "*", "trimap_sig", "+", "mask", "*", "(", "1", "-", "trimap_sig", ")", "\n", "return", "pred", ",", "trimap", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.ConvModule.__init__": [[157, 167], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "32", ",", "\n", "out_channels", "=", "32", ",", "\n", "kernel_size", "=", "3", ",", "\n", "stride", "=", "1", ",", "\n", "padding", "=", "1", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "padding", ")", "\n", "self", ".", "norm", "=", "nn", ".", "BatchNorm2d", "(", "out_channels", ")", "\n", "self", ".", "activation", "=", "nn", ".", "ReLU", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.ConvModule.forward": [[169, 171], ["is_hrnet_model.ConvModule.activation", "is_hrnet_model.ConvModule.norm", "is_hrnet_model.ConvModule.conv"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "activation", "(", "self", ".", "norm", "(", "self", ".", "conv", "(", "x", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.XConvBnRelu.__init__": [[179, 185], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "input_dims", "=", "3", ",", "out_dims", "=", "16", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "XConvBnRelu", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv3x3", "=", "nn", ".", "Conv2d", "(", "input_dims", ",", "input_dims", ",", "3", ",", "1", ",", "1", ",", "groups", "=", "input_dims", ")", "\n", "self", ".", "conv1x1", "=", "nn", ".", "Conv2d", "(", "input_dims", ",", "out_dims", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "norm", "=", "nn", ".", "BatchNorm2d", "(", "out_dims", ")", "\n", "self", ".", "activation", "=", "nn", ".", "ReLU", "(", ")", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.XConvBnRelu.forward": [[185, 191], ["is_hrnet_model.XConvBnRelu.conv3x3", "is_hrnet_model.XConvBnRelu.conv1x1", "is_hrnet_model.XConvBnRelu.norm", "is_hrnet_model.XConvBnRelu.activation"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv3x3", "(", "x", ")", "\n", "x", "=", "self", ".", "conv1x1", "(", "x", ")", "\n", "x", "=", "self", ".", "norm", "(", "x", ")", "\n", "x", "=", "self", ".", "activation", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_hrnet_model.resize": [[196, 205], ["isinstance", "torch.interpolate", "tuple", "int"], "function", ["None"], ["", "", "def", "resize", "(", "input", ",", "\n", "size", "=", "None", ",", "\n", "scale_factor", "=", "None", ",", "\n", "mode", "=", "'nearest'", ",", "\n", "align_corners", "=", "None", ",", "\n", ")", ":", "\n", "    ", "if", "isinstance", "(", "size", ",", "torch", ".", "Size", ")", ":", "\n", "        ", "size", "=", "tuple", "(", "int", "(", "x", ")", "for", "x", "in", "size", ")", "\n", "", "return", "F", ".", "interpolate", "(", "input", ",", "size", ",", "scale_factor", ",", "mode", ",", "align_corners", ")", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer.__init__": [[7, 10], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "local_init", "=", "True", ",", "gamma", "=", "None", ")", ":", "\n", "        ", "self", ".", "local_init", "=", "local_init", "\n", "self", ".", "gamma", "=", "gamma", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer.__call__": [[11, 30], ["getattr", "isinstance", "object.__setattr__", "initializer.Initializer._init_gamma", "initializer.Initializer._init_beta", "getattr", "initializer.Initializer._init_weight", "getattr", "initializer.Initializer._init_bias"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer._init_gamma", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer._init_beta", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.XavierGluon._init_weight", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer._init_bias"], ["", "def", "__call__", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "getattr", "(", "m", ",", "'__initialized'", ",", "False", ")", ":", "\n", "            ", "return", "\n", "\n", "", "if", "isinstance", "(", "m", ",", "(", "nn", ".", "BatchNorm1d", ",", "nn", ".", "BatchNorm2d", ",", "nn", ".", "BatchNorm3d", ",", "\n", "nn", ".", "InstanceNorm1d", ",", "nn", ".", "InstanceNorm2d", ",", "nn", ".", "InstanceNorm3d", ",", "\n", "nn", ".", "GroupNorm", ",", "nn", ".", "SyncBatchNorm", ")", ")", "or", "'BatchNorm'", "in", "m", ".", "__class__", ".", "__name__", ":", "\n", "            ", "if", "m", ".", "weight", "is", "not", "None", ":", "\n", "                ", "self", ".", "_init_gamma", "(", "m", ".", "weight", ".", "data", ")", "\n", "", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "self", ".", "_init_beta", "(", "m", ".", "bias", ".", "data", ")", "\n", "", "", "else", ":", "\n", "            ", "if", "getattr", "(", "m", ",", "'weight'", ",", "None", ")", "is", "not", "None", ":", "\n", "                ", "self", ".", "_init_weight", "(", "m", ".", "weight", ".", "data", ")", "\n", "", "if", "getattr", "(", "m", ",", "'bias'", ",", "None", ")", "is", "not", "None", ":", "\n", "                ", "self", ".", "_init_bias", "(", "m", ".", "bias", ".", "data", ")", "\n", "\n", "", "", "if", "self", ".", "local_init", ":", "\n", "            ", "object", ".", "__setattr__", "(", "m", ",", "'__initialized'", ",", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer._init_weight": [[31, 33], ["torch.init.uniform_", "torch.init.uniform_"], "methods", ["None"], ["", "", "def", "_init_weight", "(", "self", ",", "data", ")", ":", "\n", "        ", "nn", ".", "init", ".", "uniform_", "(", "data", ",", "-", "0.07", ",", "0.07", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer._init_bias": [[34, 36], ["torch.init.constant_", "torch.init.constant_"], "methods", ["None"], ["", "def", "_init_bias", "(", "self", ",", "data", ")", ":", "\n", "        ", "nn", ".", "init", ".", "constant_", "(", "data", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer._init_gamma": [[37, 42], ["torch.init.constant_", "torch.init.constant_", "torch.init.normal_", "torch.init.normal_"], "methods", ["None"], ["", "def", "_init_gamma", "(", "self", ",", "data", ")", ":", "\n", "        ", "if", "self", ".", "gamma", "is", "None", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "data", ",", "1.0", ")", "\n", "", "else", ":", "\n", "            ", "nn", ".", "init", ".", "normal_", "(", "data", ",", "1.0", ",", "self", ".", "gamma", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Initializer._init_beta": [[43, 45], ["torch.init.constant_", "torch.init.constant_"], "methods", ["None"], ["", "", "def", "_init_beta", "(", "self", ",", "data", ")", ":", "\n", "        ", "nn", ".", "init", ".", "constant_", "(", "data", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Bilinear.__init__": [[48, 53], ["initializer.Initializer.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "scale", ",", "groups", ",", "in_channels", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "scale", "=", "scale", "\n", "self", ".", "groups", "=", "groups", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Bilinear._init_weight": [[54, 65], ["initializer.Bilinear.get_bilinear_kernel", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "range"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Bilinear.get_bilinear_kernel"], ["", "def", "_init_weight", "(", "self", ",", "data", ")", ":", "\n", "        ", "\"\"\"Reset the weight and bias.\"\"\"", "\n", "bilinear_kernel", "=", "self", ".", "get_bilinear_kernel", "(", "self", ".", "scale", ")", "\n", "weight", "=", "torch", ".", "zeros_like", "(", "data", ")", "\n", "for", "i", "in", "range", "(", "self", ".", "in_channels", ")", ":", "\n", "            ", "if", "self", ".", "groups", "==", "1", ":", "\n", "                ", "j", "=", "i", "\n", "", "else", ":", "\n", "                ", "j", "=", "0", "\n", "", "weight", "[", "i", ",", "j", "]", "=", "bilinear_kernel", "\n", "", "data", "[", ":", "]", "=", "weight", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.Bilinear.get_bilinear_kernel": [[66, 77], ["torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "numpy.abs", "numpy.abs"], "methods", ["None"], ["", "@", "staticmethod", "\n", "def", "get_bilinear_kernel", "(", "scale", ")", ":", "\n", "        ", "\"\"\"Generate a bilinear upsampling kernel.\"\"\"", "\n", "kernel_size", "=", "2", "*", "scale", "-", "scale", "%", "2", "\n", "scale", "=", "(", "kernel_size", "+", "1", ")", "//", "2", "\n", "center", "=", "scale", "-", "0.5", "*", "(", "1", "+", "kernel_size", "%", "2", ")", "\n", "\n", "og", "=", "np", ".", "ogrid", "[", ":", "kernel_size", ",", ":", "kernel_size", "]", "\n", "kernel", "=", "(", "1", "-", "np", ".", "abs", "(", "og", "[", "0", "]", "-", "center", ")", "/", "scale", ")", "*", "(", "1", "-", "np", ".", "abs", "(", "og", "[", "1", "]", "-", "center", ")", "/", "scale", ")", "\n", "\n", "return", "torch", ".", "tensor", "(", "kernel", ",", "dtype", "=", "torch", ".", "float32", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.XavierGluon.__init__": [[80, 86], ["initializer.Initializer.__init__", "float"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "rnd_type", "=", "'uniform'", ",", "factor_type", "=", "'avg'", ",", "magnitude", "=", "3", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "\n", "self", ".", "rnd_type", "=", "rnd_type", "\n", "self", ".", "factor_type", "=", "factor_type", "\n", "self", ".", "magnitude", "=", "float", "(", "magnitude", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.initializer.XavierGluon._init_weight": [[87, 106], ["torch.init._calculate_fan_in_and_fan_out", "torch.init._calculate_fan_in_and_fan_out", "numpy.sqrt", "torch.init.uniform_", "torch.init.uniform_", "torch.init.normal_", "torch.init.normal_", "ValueError", "ValueError"], "methods", ["None"], ["", "def", "_init_weight", "(", "self", ",", "arr", ")", ":", "\n", "        ", "fan_in", ",", "fan_out", "=", "nn", ".", "init", ".", "_calculate_fan_in_and_fan_out", "(", "arr", ")", "\n", "\n", "if", "self", ".", "factor_type", "==", "'avg'", ":", "\n", "            ", "factor", "=", "(", "fan_in", "+", "fan_out", ")", "/", "2.0", "\n", "", "elif", "self", ".", "factor_type", "==", "'in'", ":", "\n", "            ", "factor", "=", "fan_in", "\n", "", "elif", "self", ".", "factor_type", "==", "'out'", ":", "\n", "            ", "factor", "=", "fan_out", "\n", "", "else", ":", "\n", "            ", "raise", "ValueError", "(", "'Incorrect factor type'", ")", "\n", "", "scale", "=", "np", ".", "sqrt", "(", "self", ".", "magnitude", "/", "factor", ")", "\n", "\n", "if", "self", ".", "rnd_type", "==", "'uniform'", ":", "\n", "            ", "nn", ".", "init", ".", "uniform_", "(", "arr", ",", "-", "scale", ",", "scale", ")", "\n", "", "elif", "self", ".", "rnd_type", "==", "'gaussian'", ":", "\n", "            ", "nn", ".", "init", ".", "normal_", "(", "arr", ",", "0", ",", "scale", ")", "\n", "", "else", ":", "\n", "            ", "raise", "ValueError", "(", "'Unknown random type'", ")", "\n", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.modifiers.LRMult.__init__": [[4, 6], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "lr_mult", "=", "1.", ")", ":", "\n", "        ", "self", ".", "lr_mult", "=", "lr_mult", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.modifiers.LRMult.__call__": [[7, 12], ["getattr", "getattr"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "getattr", "(", "m", ",", "'weight'", ",", "None", ")", "is", "not", "None", ":", "\n", "            ", "m", ".", "weight", ".", "lr_mult", "=", "self", ".", "lr_mult", "\n", "", "if", "getattr", "(", "m", ",", "'bias'", ",", "None", ")", "is", "not", "None", ":", "\n", "            ", "m", ".", "bias", ".", "lr_mult", "=", "self", ".", "lr_mult", "\n", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_deeplab_model.DeeplabModel.__init__": [[15, 30], ["is_model.ISModel.__init__", "modeling.deeplab_v3.DeepLabV3Plus", "is_deeplab_model.DeeplabModel.feature_extractor.backbone.apply", "modeling.basic_blocks.SepConvHead", "modeling.basic_blocks.SepConvHead", "isegm.model.ops.DistMaps", "isegm.model.ops.DistMaps", "isegm.model.modeling.cdnet.PDM.PDM", "isegm.model.modifiers.LRMult"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "@", "serialize", "\n", "def", "__init__", "(", "self", ",", "backbone", "=", "'resnet50'", ",", "deeplab_ch", "=", "256", ",", "aspp_dropout", "=", "0.5", ",", "\n", "backbone_norm_layer", "=", "None", ",", "backbone_lr_mult", "=", "0.1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "norm_layer", "=", "norm_layer", ",", "**", "kwargs", ")", "\n", "\n", "self", ".", "feature_extractor", "=", "DeepLabV3Plus", "(", "backbone", "=", "backbone", ",", "ch", "=", "deeplab_ch", ",", "project_dropout", "=", "aspp_dropout", ",", "\n", "norm_layer", "=", "norm_layer", ",", "backbone_norm_layer", "=", "backbone_norm_layer", ")", "\n", "self", ".", "feature_extractor", ".", "backbone", ".", "apply", "(", "LRMult", "(", "backbone_lr_mult", ")", ")", "\n", "self", ".", "head", "=", "SepConvHead", "(", "1", ",", "in_channels", "=", "deeplab_ch", ",", "mid_channels", "=", "deeplab_ch", "//", "2", ",", "\n", "num_layers", "=", "2", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "latent_head", "=", "SepConvHead", "(", "4", ",", "in_channels", "=", "deeplab_ch", ",", "mid_channels", "=", "deeplab_ch", "//", "2", ",", "\n", "num_layers", "=", "2", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "dist_maps", "=", "DistMaps", "(", "norm_radius", "=", "5", ",", "spatial_scale", "=", "1.0", ",", "cpu_mode", "=", "False", ",", "use_disks", "=", "True", ")", "\n", "self", ".", "fdm_dist_maps", "=", "DistMaps", "(", "norm_radius", "=", "24", ",", "spatial_scale", "=", "1.0", ",", "cpu_mode", "=", "False", ",", "use_disks", "=", "True", ")", "\n", "self", ".", "PDM", "=", "PDM", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_deeplab_model.DeeplabModel.get_coord_features": [[31, 42], ["is_deeplab_model.DeeplabModel.dist_maps", "is_deeplab_model.DeeplabModel.fdm_dist_maps", "torch.interpolate", "torch.interpolate", "torch.interpolate", "math.ceil", "math.ceil", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "get_coord_features", "(", "self", ",", "image", ",", "prev_mask", ",", "points", ")", ":", "\n", "        ", "coord_features", "=", "self", ".", "dist_maps", "(", "image", ",", "points", ")", "\n", "fdm_clicks", "=", "self", ".", "fdm_dist_maps", "(", "image", ",", "points", ")", "\n", "h", ",", "w", "=", "fdm_clicks", ".", "shape", "[", "-", "2", "]", ",", "fdm_clicks", ".", "shape", "[", "-", "1", "]", "\n", "hs", ",", "ws", "=", "math", ".", "ceil", "(", "h", "/", "8", ")", ",", "math", ".", "ceil", "(", "w", "/", "8", ")", "\n", "fdm_clicks", "=", "F", ".", "interpolate", "(", "fdm_clicks", ",", "(", "hs", ",", "ws", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "if", "prev_mask", "is", "not", "None", ":", "\n", "            ", "coord_features", "=", "torch", ".", "cat", "(", "(", "prev_mask", ",", "coord_features", ")", ",", "dim", "=", "1", ")", "\n", "\n", "", "return", "coord_features", ",", "fdm_clicks", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_deeplab_model.DeeplabModel.backbone_forward": [[44, 51], ["is_deeplab_model.DeeplabModel.feature_extractor", "is_deeplab_model.DeeplabModel.head", "is_deeplab_model.DeeplabModel.latent_head"], "methods", ["None"], ["", "def", "backbone_forward", "(", "self", ",", "image", ",", "coord_features", ",", "fdm_clicks", ")", ":", "\n", "        ", "backbone_features", ",", "pos_map", "=", "self", ".", "feature_extractor", "(", "image", ",", "coord_features", ",", "fdm_clicks", ")", "\n", "#detached_feature = backbone_features.clone().detach()", "\n", "#pred = self.head(detached_feature)", "\n", "pred", "=", "self", ".", "head", "(", "backbone_features", ")", "\n", "latent_preds", "=", "self", ".", "latent_head", "(", "backbone_features", ")", "\n", "return", "{", "'instances'", ":", "pred", ",", "'fdm_instances'", ":", "pos_map", ",", "'latent_instances'", ":", "latent_preds", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_deeplab_model.DeeplabModel.forward": [[53, 76], ["is_deeplab_model.DeeplabModel.prepare_input", "is_deeplab_model.DeeplabModel.get_coord_features", "is_deeplab_model.DeeplabModel.maps_transform", "is_deeplab_model.DeeplabModel.backbone_forward", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "image.size", "image.size", "image.size"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.backbone_forward"], ["", "def", "forward", "(", "self", ",", "image", ",", "points", ")", ":", "\n", "        ", "image", ",", "prev_mask", "=", "self", ".", "prepare_input", "(", "image", ")", "\n", "coord_features", ",", "fdm_clicks", "=", "self", ".", "get_coord_features", "(", "image", ",", "prev_mask", ",", "points", ")", "\n", "\n", "\n", "if", "coord_features", ".", "shape", "[", "1", "]", "==", "3", ":", "\n", "            ", "click_map", "=", "coord_features", "[", ":", ",", "1", ":", ",", ":", ",", ":", "]", "\n", "", "else", ":", "\n", "            ", "click_map", "=", "coord_features", "\n", "", "small_image", "=", "image", "\n", "small_coord_features", "=", "coord_features", "\n", "\n", "small_coord_features", "=", "self", ".", "maps_transform", "(", "small_coord_features", ")", "\n", "outputs", "=", "self", ".", "backbone_forward", "(", "small_image", ",", "small_coord_features", ",", "fdm_clicks", ")", "\n", "\n", "outputs", "[", "'click_map'", "]", "=", "click_map", "\n", "outputs", "[", "'instances'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'instances'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "outputs", "[", "'fdm_instances'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'fdm_instances'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "outputs", "[", "'latent_instances'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'latent_instances'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "return", "outputs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_deeplab_model.DeeplabModel.PixelDiffusion": [[77, 80], ["is_deeplab_model.DeeplabModel.PDM"], "methods", ["None"], ["", "def", "PixelDiffusion", "(", "self", ",", "image", ",", "mask", ",", "clickmap", ")", ":", "\n", "        ", "instance_out", "=", "self", ".", "PDM", "(", "image", ",", "mask", ",", "clickmap", ")", "\n", "return", "instance_out", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.__init__": [[16, 51], ["is_model.ISModel.__init__", "modeling.segformer.segformer_model.SegFormer", "is_segformer_model.SegFormerModel.feature_extractor.backbone.apply", "isegm.model.ops.DistMaps", "isegm.model.ops.DistMaps", "is_segformer_model.RefineLayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "isegm.model.modifiers.LRMult", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "isegm.model.ops.ScaleLayer"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "@", "serialize", "\n", "def", "__init__", "(", "self", ",", "feature_stride", "=", "4", ",", "backbone_lr_mult", "=", "0.1", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "pipeline_version", "=", "'s1'", ",", "model_version", "=", "'b0'", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "norm_layer", "=", "norm_layer", ",", "**", "kwargs", ")", "\n", "\n", "self", ".", "pipeline_version", "=", "pipeline_version", "\n", "self", ".", "model_version", "=", "model_version", "\n", "self", ".", "feature_extractor", "=", "SegFormer", "(", "self", ".", "model_version", ")", "\n", "self", ".", "feature_extractor", ".", "backbone", ".", "apply", "(", "LRMult", "(", "backbone_lr_mult", ")", ")", "\n", "\n", "if", "self", ".", "pipeline_version", "==", "'s1'", ":", "\n", "            ", "base_radius", "=", "3", "\n", "", "else", ":", "\n", "            ", "base_radius", "=", "5", "\n", "\n", "", "self", ".", "dist_maps_base", "=", "DistMaps", "(", "norm_radius", "=", "base_radius", ",", "spatial_scale", "=", "1.0", ",", "\n", "cpu_mode", "=", "False", ",", "use_disks", "=", "True", ")", "\n", "\n", "self", ".", "dist_maps_refine", "=", "DistMaps", "(", "norm_radius", "=", "5", ",", "spatial_scale", "=", "1.0", ",", "\n", "cpu_mode", "=", "False", ",", "use_disks", "=", "True", ")", "\n", "\n", "if", "self", ".", "model_version", "==", "'b0'", ":", "\n", "            ", "feature_indim", "=", "256", "\n", "", "else", ":", "\n", "            ", "feature_indim", "=", "512", "\n", "", "self", ".", "refiner", "=", "RefineLayer", "(", "feature_indim", "=", "feature_indim", ")", "\n", "\n", "mt_layers", "=", "[", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "3", ",", "out_channels", "=", "16", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "negative_slope", "=", "0.2", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "16", ",", "out_channels", "=", "32", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ")", ",", "\n", "ScaleLayer", "(", "init_value", "=", "0.05", ",", "lr_mult", "=", "1", ")", "\n", "]", "\n", "self", ".", "maps_transform", "=", "nn", ".", "Sequential", "(", "*", "mt_layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.get_coord_features": [[52, 57], ["is_segformer_model.SegFormerModel.dist_maps_base", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "get_coord_features", "(", "self", ",", "image", ",", "prev_mask", ",", "points", ")", ":", "\n", "        ", "coord_features", "=", "self", ".", "dist_maps_base", "(", "image", ",", "points", ")", "\n", "if", "prev_mask", "is", "not", "None", ":", "\n", "            ", "coord_features", "=", "torch", ".", "cat", "(", "(", "prev_mask", ",", "coord_features", ")", ",", "dim", "=", "1", ")", "\n", "", "return", "coord_features", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.backbone_forward": [[59, 62], ["is_segformer_model.SegFormerModel.feature_extractor"], "methods", ["None"], ["", "def", "backbone_forward", "(", "self", ",", "image", ",", "side_feature", ")", ":", "\n", "        ", "mask", ",", "feature", "=", "self", ".", "feature_extractor", "(", "image", ",", "side_feature", ")", "\n", "return", "{", "'instances'", ":", "mask", ",", "'instances_aux'", ":", "mask", ",", "'feature'", ":", "feature", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.refine": [[64, 77], ["torchvision", "torchvision", "is_segformer_model.SegFormerModel.dist_maps_refine", "is_segformer_model.SegFormerModel.refiner", "full_feature.size", "cropped_image.size"], "methods", ["None"], ["", "def", "refine", "(", "self", ",", "cropped_image", ",", "cropped_points", ",", "full_feature", ",", "full_logits", ",", "bboxes", ")", ":", "\n", "        ", "'''\n        bboxes : [b,5]\n        '''", "\n", "h1", "=", "cropped_image", ".", "shape", "[", "-", "1", "]", "\n", "h2", "=", "full_feature", ".", "shape", "[", "-", "1", "]", "\n", "r", "=", "h1", "/", "h2", "\n", "\n", "cropped_feature", "=", "roi_align", "(", "full_feature", ",", "bboxes", ",", "full_feature", ".", "size", "(", ")", "[", "2", ":", "]", ",", "spatial_scale", "=", "1", "/", "r", ",", "aligned", "=", "True", ")", "\n", "cropped_logits", "=", "roi_align", "(", "full_logits", ",", "bboxes", ",", "cropped_image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "spatial_scale", "=", "1", ",", "aligned", "=", "True", ")", "\n", "click_map", "=", "self", ".", "dist_maps_refine", "(", "cropped_image", ",", "cropped_points", ")", "\n", "refined_mask", ",", "trimap", "=", "self", ".", "refiner", "(", "cropped_image", ",", "click_map", ",", "cropped_feature", ",", "cropped_logits", ")", "\n", "return", "{", "'instances_refined'", ":", "refined_mask", ",", "'trimap'", ":", "trimap", ",", "'instances_coarse'", ":", "cropped_logits", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.forward": [[78, 101], ["is_segformer_model.SegFormerModel.prepare_input", "is_segformer_model.SegFormerModel.get_coord_features", "is_segformer_model.SegFormerModel.backbone_forward", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "image.size", "image.size"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.backbone_forward"], ["", "def", "forward", "(", "self", ",", "image", ",", "points", ")", ":", "\n", "        ", "image", ",", "prev_mask", "=", "self", ".", "prepare_input", "(", "image", ")", "\n", "coord_features", "=", "self", ".", "get_coord_features", "(", "image", ",", "prev_mask", ",", "points", ")", "\n", "click_map", "=", "coord_features", "[", ":", ",", "1", ":", ",", ":", ",", ":", "]", "\n", "\n", "if", "self", ".", "pipeline_version", "==", "'s1'", ":", "\n", "            ", "small_image", "=", "F", ".", "interpolate", "(", "image", ",", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "small_coord_features", "=", "F", ".", "interpolate", "(", "coord_features", ",", "scale_factor", "=", "0.5", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "", "else", ":", "\n", "            ", "small_image", "=", "image", "\n", "small_coord_features", "=", "coord_features", "\n", "\n", "#small_coord_features = self.maps_transform(small_coord_features)", "\n", "", "outputs", "=", "self", ".", "backbone_forward", "(", "small_image", ",", "small_coord_features", ")", "\n", "\n", "outputs", "[", "'click_map'", "]", "=", "click_map", "\n", "outputs", "[", "'instances'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'instances'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "if", "self", ".", "with_aux_output", ":", "\n", "            ", "outputs", "[", "'instances_aux'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'instances_aux'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "", "return", "outputs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.RefineLayer.__init__": [[108, 139], ["torch.Module.__init__", "is_segformer_model.ConvModule", "is_segformer_model.XConvBnRelu", "is_segformer_model.XConvBnRelu", "is_segformer_model.ConvModule", "is_segformer_model.XConvBnRelu", "is_segformer_model.XConvBnRelu", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "input_dims", "=", "6", ",", "feature_indim", "=", "256", ",", "feature_dims", "=", "32", ",", "num_classes", "=", "1", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "RefineLayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "num_classes", "=", "num_classes", "\n", "self", ".", "image_conv1", "=", "ConvModule", "(", "\n", "in_channels", "=", "input_dims", ",", "\n", "out_channels", "=", "feature_dims", ",", "\n", "kernel_size", "=", "3", ",", "\n", "stride", "=", "2", ",", "\n", "padding", "=", "1", ",", "\n", ")", "\n", "self", ".", "image_conv2", "=", "XConvBnRelu", "(", "feature_dims", ",", "feature_dims", ")", "\n", "self", ".", "image_conv3", "=", "XConvBnRelu", "(", "feature_dims", ",", "feature_dims", ")", "\n", "\n", "\n", "self", ".", "refine_fusion", "=", "ConvModule", "(", "\n", "in_channels", "=", "feature_indim", ",", "\n", "out_channels", "=", "feature_dims", ",", "\n", "kernel_size", "=", "1", ",", "\n", "stride", "=", "1", ",", "\n", "padding", "=", "0", ",", "\n", "#norm_cfg=dict(type='BN', requires_grad=True),", "\n", ")", "\n", "\n", "self", ".", "refine_fusion2", "=", "XConvBnRelu", "(", "feature_dims", ",", "feature_dims", ")", "\n", "self", ".", "refine_fusion3", "=", "XConvBnRelu", "(", "feature_dims", ",", "feature_dims", ")", "\n", "self", ".", "feature_gate", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "feature_dims", ",", "1", ",", "1", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n", "self", ".", "refine_pred", "=", "nn", ".", "Conv2d", "(", "feature_dims", ",", "num_classes", ",", "3", ",", "1", ",", "1", ")", "\n", "self", ".", "refine_trimap", "=", "nn", ".", "Conv2d", "(", "feature_dims", ",", "num_classes", ",", "3", ",", "1", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.RefineLayer.forward": [[141, 165], ["torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "is_segformer_model.RefineLayer.refine_fusion", "is_segformer_model.RefineLayer.image_conv1", "is_segformer_model.RefineLayer.image_conv2", "is_segformer_model.RefineLayer.image_conv3", "is_segformer_model.resize", "is_segformer_model.RefineLayer.refine_fusion2", "is_segformer_model.RefineLayer.refine_fusion3", "is_segformer_model.RefineLayer.refine_pred", "is_segformer_model.RefineLayer.refine_trimap", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "is_segformer_model.RefineLayer.size", "torch.cat.size", "torch.cat.size", "torch.cat.size", "torch.cat.size", "torch.cat.size", "torch.cat.size"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "def", "forward", "(", "self", ",", "input_image", ",", "click_map", ",", "final_feature", ",", "cropped_logits", ")", ":", "\n", "\n", "        ", "mask", "=", "cropped_logits", "#resize(cropped_logits, size=input_image.size()[2:],mode='bilinear',align_corners=True)", "\n", "bin_mask", "=", "torch", ".", "sigmoid", "(", "mask", ")", "#> 0.49", "\n", "input_image", "=", "torch", ".", "cat", "(", "[", "input_image", ",", "click_map", ",", "bin_mask", "]", ",", "1", ")", "\n", "\n", "final_feature", "=", "self", ".", "refine_fusion", "(", "final_feature", ")", "\n", "image_feature", "=", "self", ".", "image_conv1", "(", "input_image", ")", "\n", "image_feature", "=", "self", ".", "image_conv2", "(", "image_feature", ")", "\n", "image_feature", "=", "self", ".", "image_conv3", "(", "image_feature", ")", "\n", "pred_feature", "=", "resize", "(", "final_feature", ",", "size", "=", "image_feature", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "pred_feature", "=", "pred_feature", "+", "image_feature", "#* fusion_gate", "\n", "\n", "pred_feature", "=", "self", ".", "refine_fusion2", "(", "pred_feature", ")", "\n", "pred_feature", "=", "self", ".", "refine_fusion3", "(", "pred_feature", ")", "\n", "pred_full", "=", "self", ".", "refine_pred", "(", "pred_feature", ")", "\n", "trimap", "=", "self", ".", "refine_trimap", "(", "pred_feature", ")", "\n", "trimap", "=", "F", ".", "interpolate", "(", "trimap", ",", "size", "=", "input_image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "pred_full", "=", "F", ".", "interpolate", "(", "pred_full", ",", "size", "=", "input_image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "trimap_sig", "=", "torch", ".", "sigmoid", "(", "trimap", ")", "\n", "#trimap_sig = (trimap_sig > 0.8) * 0.99", "\n", "#trimap_sig[trimap_sig>0.7] = 1.0", "\n", "pred", "=", "pred_full", "*", "trimap_sig", "+", "mask", "*", "(", "1", "-", "trimap_sig", ")", "\n", "return", "pred", ",", "trimap", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.ConvModule.__init__": [[167, 177], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "32", ",", "\n", "out_channels", "=", "32", ",", "\n", "kernel_size", "=", "3", ",", "\n", "stride", "=", "1", ",", "\n", "padding", "=", "1", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "padding", ")", "\n", "self", ".", "norm", "=", "nn", ".", "BatchNorm2d", "(", "out_channels", ")", "\n", "self", ".", "activation", "=", "nn", ".", "ReLU", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.ConvModule.forward": [[179, 181], ["is_segformer_model.ConvModule.activation", "is_segformer_model.ConvModule.norm", "is_segformer_model.ConvModule.conv"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "activation", "(", "self", ".", "norm", "(", "self", ".", "conv", "(", "x", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.XConvBnRelu.__init__": [[189, 195], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "input_dims", "=", "3", ",", "out_dims", "=", "16", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "XConvBnRelu", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv3x3", "=", "nn", ".", "Conv2d", "(", "input_dims", ",", "input_dims", ",", "3", ",", "1", ",", "1", ",", "groups", "=", "input_dims", ")", "\n", "self", ".", "conv1x1", "=", "nn", ".", "Conv2d", "(", "input_dims", ",", "out_dims", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "norm", "=", "nn", ".", "BatchNorm2d", "(", "out_dims", ")", "\n", "self", ".", "activation", "=", "nn", ".", "ReLU", "(", ")", "\n", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.XConvBnRelu.forward": [[195, 201], ["is_segformer_model.XConvBnRelu.conv3x3", "is_segformer_model.XConvBnRelu.conv1x1", "is_segformer_model.XConvBnRelu.norm", "is_segformer_model.XConvBnRelu.activation"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv3x3", "(", "x", ")", "\n", "x", "=", "self", ".", "conv1x1", "(", "x", ")", "\n", "x", "=", "self", ".", "norm", "(", "x", ")", "\n", "x", "=", "self", ".", "activation", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.resize": [[206, 215], ["isinstance", "torch.interpolate", "tuple", "int"], "function", ["None"], ["", "", "def", "resize", "(", "input", ",", "\n", "size", "=", "None", ",", "\n", "scale_factor", "=", "None", ",", "\n", "mode", "=", "'nearest'", ",", "\n", "align_corners", "=", "None", ",", "\n", ")", ":", "\n", "    ", "if", "isinstance", "(", "size", ",", "torch", ".", "Size", ")", ":", "\n", "        ", "size", "=", "tuple", "(", "int", "(", "x", ")", "for", "x", "in", "size", ")", "\n", "", "return", "F", ".", "interpolate", "(", "input", ",", "size", ",", "scale_factor", ",", "mode", ",", "align_corners", ")", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.__init__": [[17, 42], ["is_model.ISModel.__init__", "is_strong_baseline.BaselineModel.feature_extractor.apply", "isegm.model.ops.DistMaps", "torch.Sequential", "torch.Sequential", "torch.Sequential", "isegm.model.modeling.ppclnet.segmentator.PPLCSeg", "isegm.model.modifiers.LRMult", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "isegm.model.ops.ScaleLayer", "isegm.model.modeling.mobilenet.segmentator.MobileSeg", "isegm.model.modeling.efficientnet.segmentator.EfficientSeg"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "@", "serialize", "\n", "def", "__init__", "(", "self", ",", "backbone", "=", "'PPLCNet'", ",", "backbone_lr_mult", "=", "0.1", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "norm_layer", "=", "norm_layer", ",", "**", "kwargs", ")", "\n", "if", "backbone", "==", "'PPLCNet'", ":", "\n", "            ", "self", ".", "feature_extractor", "=", "PPLCSeg", "(", ")", "\n", "side_feature_ch", "=", "32", "\n", "", "elif", "backbone", "==", "'MobleNetV2'", ":", "\n", "            ", "self", ".", "feature_extractor", "=", "MobileSeg", "(", ")", "\n", "side_feature_ch", "=", "32", "\n", "", "elif", "backbone", "==", "'EfficientNet'", ":", "\n", "            ", "self", ".", "feature_extractor", "=", "EfficientSeg", "(", ")", "\n", "side_feature_ch", "=", "32", "\n", "\n", "", "self", ".", "feature_extractor", ".", "apply", "(", "LRMult", "(", "backbone_lr_mult", ")", ")", "\n", "self", ".", "dist_maps", "=", "DistMaps", "(", "norm_radius", "=", "5", ",", "spatial_scale", "=", "1.0", ",", "\n", "cpu_mode", "=", "False", ",", "use_disks", "=", "True", ")", "\n", "\n", "mt_layers", "=", "[", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "3", ",", "out_channels", "=", "16", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "negative_slope", "=", "0.2", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "16", ",", "out_channels", "=", "side_feature_ch", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", ",", "\n", "ScaleLayer", "(", "init_value", "=", "0.05", ",", "lr_mult", "=", "1", ")", "\n", "]", "\n", "self", ".", "maps_transform", "=", "nn", ".", "Sequential", "(", "*", "mt_layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features": [[44, 49], ["is_strong_baseline.BaselineModel.dist_maps", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "get_coord_features", "(", "self", ",", "image", ",", "prev_mask", ",", "points", ")", ":", "\n", "        ", "coord_features", "=", "self", ".", "dist_maps", "(", "image", ",", "points", ")", "\n", "if", "prev_mask", "is", "not", "None", ":", "\n", "            ", "coord_features", "=", "torch", ".", "cat", "(", "(", "prev_mask", ",", "coord_features", ")", ",", "dim", "=", "1", ")", "\n", "", "return", "coord_features", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.backbone_forward": [[50, 53], ["is_strong_baseline.BaselineModel.feature_extractor"], "methods", ["None"], ["", "def", "backbone_forward", "(", "self", ",", "image", ",", "coord_features", "=", "None", ")", ":", "\n", "        ", "mask", ",", "mask_aux", ",", "feature", "=", "self", ".", "feature_extractor", "(", "image", ",", "coord_features", ")", "\n", "return", "{", "'instances'", ":", "mask", ",", "'instances_aux'", ":", "mask_aux", ",", "'feature'", ":", "feature", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.forward": [[55, 70], ["is_strong_baseline.BaselineModel.prepare_input", "is_strong_baseline.BaselineModel.get_coord_features", "is_strong_baseline.BaselineModel.maps_transform", "is_strong_baseline.BaselineModel.backbone_forward", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "torch.functional.interpolate", "image.size", "image.size"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.backbone_forward"], ["", "def", "forward", "(", "self", ",", "image", ",", "points", ")", ":", "\n", "        ", "image", ",", "prev_mask", "=", "self", ".", "prepare_input", "(", "image", ")", "\n", "coord_features", "=", "self", ".", "get_coord_features", "(", "image", ",", "prev_mask", ",", "points", ")", "\n", "click_map", "=", "coord_features", "[", ":", ",", "1", ":", ",", ":", ",", ":", "]", "\n", "\n", "coord_features", "=", "self", ".", "maps_transform", "(", "coord_features", ")", "\n", "outputs", "=", "self", ".", "backbone_forward", "(", "image", ",", "coord_features", ")", "\n", "\n", "outputs", "[", "'click_map'", "]", "=", "click_map", "\n", "outputs", "[", "'instances'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'instances'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "if", "self", ".", "with_aux_output", ":", "\n", "            ", "outputs", "[", "'instances_aux'", "]", "=", "nn", ".", "functional", ".", "interpolate", "(", "outputs", "[", "'instances_aux'", "]", ",", "size", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "", "return", "outputs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.NormalizedFocalLossSigmoid.__init__": [[10, 29], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "axis", "=", "-", "1", ",", "alpha", "=", "0.25", ",", "gamma", "=", "2", ",", "max_mult", "=", "-", "1", ",", "eps", "=", "1e-12", ",", "\n", "from_sigmoid", "=", "False", ",", "detach_delimeter", "=", "True", ",", "\n", "batch_axis", "=", "0", ",", "weight", "=", "None", ",", "size_average", "=", "True", ",", "\n", "ignore_label", "=", "-", "1", ")", ":", "\n", "        ", "super", "(", "NormalizedFocalLossSigmoid", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_axis", "=", "axis", "\n", "self", ".", "_alpha", "=", "alpha", "\n", "self", ".", "_gamma", "=", "gamma", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "self", ".", "_weight", "=", "weight", "if", "weight", "is", "not", "None", "else", "1.0", "\n", "self", ".", "_batch_axis", "=", "batch_axis", "\n", "\n", "self", ".", "_from_logits", "=", "from_sigmoid", "\n", "self", ".", "_eps", "=", "eps", "\n", "self", ".", "_size_average", "=", "size_average", "\n", "self", ".", "_detach_delimeter", "=", "detach_delimeter", "\n", "self", ".", "_max_mult", "=", "max_mult", "\n", "self", ".", "_k_sum", "=", "0", "\n", "self", ".", "_m_max", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.NormalizedFocalLossSigmoid.forward": [[30, 73], ["torch.sigmoid.float", "torch.sigmoid.float", "torch.sigmoid.float", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "mult.detach.detach.detach", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "numpy.any", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "beta_pmax.mean().item.mean().item.mean().item", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "isegm.utils.misc.get_dims_with_exclusion", "isegm.utils.misc.get_dims_with_exclusion", "sample_mult[].mean", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "beta_pmax.mean().item.mean().item.mean", "sample_weight.dim", "isegm.utils.misc.get_dims_with_exclusion", "torch.sum.dim", "torch.sum.dim", "torch.sum.dim", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.sum.dim", "torch.sum.dim", "torch.sum.dim", "tuple", "tuple", "range", "range", "label.dim", "mult.detach.detach.dim"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion"], ["", "def", "forward", "(", "self", ",", "pred", ",", "label", ")", ":", "\n", "#print(pred.shape, label.shape)", "\n", "        ", "pred", "=", "pred", ".", "float", "(", ")", "\n", "one_hot", "=", "label", ">", "0.5", "\n", "sample_weight", "=", "label", "!=", "self", ".", "_ignore_label", "\n", "\n", "if", "not", "self", ".", "_from_logits", ":", "\n", "            ", "pred", "=", "torch", ".", "sigmoid", "(", "pred", ")", "\n", "\n", "", "alpha", "=", "torch", ".", "where", "(", "one_hot", ",", "self", ".", "_alpha", "*", "sample_weight", ",", "(", "1", "-", "self", ".", "_alpha", ")", "*", "sample_weight", ")", "\n", "pt", "=", "torch", ".", "where", "(", "sample_weight", ",", "1.0", "-", "torch", ".", "abs", "(", "label", "-", "pred", ")", ",", "torch", ".", "ones_like", "(", "pred", ")", ")", "\n", "\n", "beta", "=", "(", "1", "-", "pt", ")", "**", "self", ".", "_gamma", "\n", "\n", "sw_sum", "=", "torch", ".", "sum", "(", "sample_weight", ",", "dim", "=", "(", "-", "2", ",", "-", "1", ")", ",", "keepdim", "=", "True", ")", "\n", "beta_sum", "=", "torch", ".", "sum", "(", "beta", ",", "dim", "=", "(", "-", "2", ",", "-", "1", ")", ",", "keepdim", "=", "True", ")", "\n", "mult", "=", "sw_sum", "/", "(", "beta_sum", "+", "self", ".", "_eps", ")", "\n", "if", "self", ".", "_detach_delimeter", ":", "\n", "            ", "mult", "=", "mult", ".", "detach", "(", ")", "\n", "", "beta", "=", "beta", "*", "mult", "\n", "if", "self", ".", "_max_mult", ">", "0", ":", "\n", "            ", "beta", "=", "torch", ".", "clamp_max", "(", "beta", ",", "self", ".", "_max_mult", ")", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "ignore_area", "=", "torch", ".", "sum", "(", "label", "==", "self", ".", "_ignore_label", ",", "dim", "=", "tuple", "(", "range", "(", "1", ",", "label", ".", "dim", "(", ")", ")", ")", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "sample_mult", "=", "torch", ".", "mean", "(", "mult", ",", "dim", "=", "tuple", "(", "range", "(", "1", ",", "mult", ".", "dim", "(", ")", ")", ")", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "np", ".", "any", "(", "ignore_area", "==", "0", ")", ":", "\n", "                ", "self", ".", "_k_sum", "=", "0.9", "*", "self", ".", "_k_sum", "+", "0.1", "*", "sample_mult", "[", "ignore_area", "==", "0", "]", ".", "mean", "(", ")", "\n", "\n", "beta_pmax", ",", "_", "=", "torch", ".", "flatten", "(", "beta", ",", "start_dim", "=", "1", ")", ".", "max", "(", "dim", "=", "1", ")", "\n", "beta_pmax", "=", "beta_pmax", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "self", ".", "_m_max", "=", "0.8", "*", "self", ".", "_m_max", "+", "0.2", "*", "beta_pmax", "\n", "\n", "", "", "loss", "=", "-", "alpha", "*", "beta", "*", "torch", ".", "log", "(", "torch", ".", "min", "(", "pt", "+", "self", ".", "_eps", ",", "torch", ".", "ones", "(", "1", ",", "dtype", "=", "torch", ".", "float", ")", ".", "to", "(", "pt", ".", "device", ")", ")", ")", "\n", "loss", "=", "self", ".", "_weight", "*", "(", "loss", "*", "sample_weight", ")", "\n", "\n", "if", "self", ".", "_size_average", ":", "\n", "            ", "bsum", "=", "torch", ".", "sum", "(", "sample_weight", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "sample_weight", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "\n", "loss", "=", "torch", ".", "sum", "(", "loss", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "loss", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "/", "(", "bsum", "+", "self", ".", "_eps", ")", "\n", "", "else", ":", "\n", "            ", "loss", "=", "torch", ".", "sum", "(", "loss", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "loss", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "\n", "\n", "", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.NormalizedFocalLossSigmoid.log_states": [[74, 77], ["sw.add_scalar", "sw.add_scalar"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar"], ["", "def", "log_states", "(", "self", ",", "sw", ",", "name", ",", "global_step", ")", ":", "\n", "        ", "sw", ".", "add_scalar", "(", "tag", "=", "name", "+", "'_k'", ",", "value", "=", "self", ".", "_k_sum", ",", "global_step", "=", "global_step", ")", "\n", "sw", ".", "add_scalar", "(", "tag", "=", "name", "+", "'_m'", ",", "value", "=", "self", ".", "_m_max", ",", "global_step", "=", "global_step", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.DiversityLoss.__init__": [[81, 85], ["torch.Module.__init__", "losses.NormalizedFocalLossSigmoid", "losses.ClickLoss"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "DiversityLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "baseloss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "self", ".", "click_loss", "=", "ClickLoss", "(", ")", "#WFNL(alpha=0.5, gamma=2, w = 0.99)", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.DiversityLoss.forward": [[87, 100], ["range", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "latent_preds[].unsqueeze", "losses.DiversityLoss.baseloss", "single_loss.unsqueeze.unsqueeze.unsqueeze", "div_loss_lst.append", "losses.DiversityLoss.click_loss", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "div_loss_min.mean", "click_loss.mean"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "latent_preds", ",", "label", ",", "click_map", ")", ":", "\n", "        ", "div_loss_lst", "=", "[", "]", "\n", "click_loss", "=", "0", "\n", "for", "i", "in", "range", "(", "latent_preds", ".", "shape", "[", "1", "]", ")", ":", "\n", "            ", "single_pred", "=", "latent_preds", "[", ":", ",", "i", ",", ":", ",", ":", "]", ".", "unsqueeze", "(", "1", ")", "\n", "single_loss", "=", "self", ".", "baseloss", "(", "single_pred", ",", "label", ")", "\n", "single_loss", "=", "single_loss", ".", "unsqueeze", "(", "-", "1", ")", "\n", "div_loss_lst", ".", "append", "(", "single_loss", ")", "\n", "click_loss", "+=", "self", ".", "click_loss", "(", "single_pred", ",", "label", ",", "click_map", ")", "\n", "\n", "", "div_losses", "=", "torch", ".", "cat", "(", "div_loss_lst", ",", "1", ")", "\n", "div_loss_min", "=", "torch", ".", "min", "(", "div_losses", ",", "dim", "=", "1", ")", "[", "0", "]", "\n", "return", "div_loss_min", ".", "mean", "(", ")", "+", "click_loss", ".", "mean", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.__init__": [[104, 124], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "axis", "=", "-", "1", ",", "alpha", "=", "0.25", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ",", "max_mult", "=", "-", "1", ",", "eps", "=", "1e-12", ",", "\n", "from_sigmoid", "=", "False", ",", "detach_delimeter", "=", "True", ",", "\n", "batch_axis", "=", "0", ",", "weight", "=", "None", ",", "size_average", "=", "True", ",", "\n", "ignore_label", "=", "-", "1", ")", ":", "\n", "        ", "super", "(", "WFNL", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_axis", "=", "axis", "\n", "self", ".", "_alpha", "=", "alpha", "\n", "self", ".", "_gamma", "=", "gamma", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "self", ".", "_weight", "=", "weight", "if", "weight", "is", "not", "None", "else", "1.0", "\n", "self", ".", "_batch_axis", "=", "batch_axis", "\n", "\n", "self", ".", "_from_logits", "=", "from_sigmoid", "\n", "self", ".", "_eps", "=", "eps", "\n", "self", ".", "_size_average", "=", "size_average", "\n", "self", ".", "_detach_delimeter", "=", "detach_delimeter", "\n", "self", ".", "_max_mult", "=", "max_mult", "\n", "self", ".", "_k_sum", "=", "0", "\n", "self", ".", "_m_max", "=", "0", "\n", "self", ".", "w", "=", "w", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.forward": [[125, 166], ["torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "mult.detach.detach.detach", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.clamp_max", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.sum().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "torch.mean().cpu().numpy", "numpy.any", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "torch.flatten().max", "beta_pmax.mean().item.mean().item.mean().item", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.sum().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.mean().cpu", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "weight.sum", "isegm.utils.misc.get_dims_with_exclusion", "sample_mult[].mean", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "torch.flatten", "beta_pmax.mean().item.mean().item.mean", "sample_weight.dim", "isegm.utils.misc.get_dims_with_exclusion", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "loss.dim", "tuple", "tuple", "range", "range", "label.dim", "mult.detach.detach.dim"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion"], ["", "def", "forward", "(", "self", ",", "pred", ",", "label", ",", "weight", "=", "None", ")", ":", "\n", "        ", "one_hot", "=", "label", ">", "0.5", "\n", "sample_weight", "=", "label", "!=", "self", ".", "_ignore_label", "\n", "\n", "if", "not", "self", ".", "_from_logits", ":", "\n", "            ", "pred", "=", "torch", ".", "sigmoid", "(", "pred", ")", "\n", "\n", "", "alpha", "=", "torch", ".", "where", "(", "one_hot", ",", "self", ".", "_alpha", "*", "sample_weight", ",", "(", "1", "-", "self", ".", "_alpha", ")", "*", "sample_weight", ")", "\n", "pt", "=", "torch", ".", "where", "(", "sample_weight", ",", "1.0", "-", "torch", ".", "abs", "(", "label", "-", "pred", ")", ",", "torch", ".", "ones_like", "(", "pred", ")", ")", "\n", "\n", "beta", "=", "(", "1", "-", "pt", ")", "**", "self", ".", "_gamma", "\n", "\n", "sw_sum", "=", "torch", ".", "sum", "(", "sample_weight", ",", "dim", "=", "(", "-", "2", ",", "-", "1", ")", ",", "keepdim", "=", "True", ")", "\n", "beta_sum", "=", "torch", ".", "sum", "(", "beta", ",", "dim", "=", "(", "-", "2", ",", "-", "1", ")", ",", "keepdim", "=", "True", ")", "\n", "mult", "=", "sw_sum", "/", "(", "beta_sum", "+", "self", ".", "_eps", ")", "\n", "if", "self", ".", "_detach_delimeter", ":", "\n", "            ", "mult", "=", "mult", ".", "detach", "(", ")", "\n", "", "beta", "=", "beta", "*", "mult", "\n", "if", "self", ".", "_max_mult", ">", "0", ":", "\n", "            ", "beta", "=", "torch", ".", "clamp_max", "(", "beta", ",", "self", ".", "_max_mult", ")", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "ignore_area", "=", "torch", ".", "sum", "(", "label", "==", "self", ".", "_ignore_label", ",", "dim", "=", "tuple", "(", "range", "(", "1", ",", "label", ".", "dim", "(", ")", ")", ")", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "sample_mult", "=", "torch", ".", "mean", "(", "mult", ",", "dim", "=", "tuple", "(", "range", "(", "1", ",", "mult", ".", "dim", "(", ")", ")", ")", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "np", ".", "any", "(", "ignore_area", "==", "0", ")", ":", "\n", "                ", "self", ".", "_k_sum", "=", "0.9", "*", "self", ".", "_k_sum", "+", "0.1", "*", "sample_mult", "[", "ignore_area", "==", "0", "]", ".", "mean", "(", ")", "\n", "\n", "beta_pmax", ",", "_", "=", "torch", ".", "flatten", "(", "beta", ",", "start_dim", "=", "1", ")", ".", "max", "(", "dim", "=", "1", ")", "\n", "beta_pmax", "=", "beta_pmax", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "self", ".", "_m_max", "=", "0.8", "*", "self", ".", "_m_max", "+", "0.2", "*", "beta_pmax", "\n", "\n", "", "", "loss", "=", "-", "alpha", "*", "beta", "*", "torch", ".", "log", "(", "torch", ".", "min", "(", "pt", "+", "self", ".", "_eps", ",", "torch", ".", "ones", "(", "1", ",", "dtype", "=", "torch", ".", "float", ")", ".", "to", "(", "pt", ".", "device", ")", ")", ")", "\n", "loss", "=", "self", ".", "_weight", "*", "(", "loss", "*", "sample_weight", ")", "\n", "\n", "if", "weight", "is", "not", "None", ":", "\n", "            ", "weight", "=", "weight", "*", "self", ".", "w", "+", "(", "1", "-", "self", ".", "w", ")", "\n", "loss", "=", "(", "loss", "*", "weight", ")", ".", "sum", "(", ")", "/", "(", "weight", ".", "sum", "(", ")", "+", "self", ".", "_eps", ")", "\n", "", "else", ":", "\n", "            ", "bsum", "=", "torch", ".", "sum", "(", "sample_weight", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "sample_weight", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "\n", "loss", "=", "torch", ".", "sum", "(", "loss", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "loss", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "/", "(", "bsum", "+", "self", ".", "_eps", ")", "\n", "", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states": [[167, 170], ["sw.add_scalar", "sw.add_scalar"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar"], ["", "def", "log_states", "(", "self", ",", "sw", ",", "name", ",", "global_step", ")", ":", "\n", "        ", "sw", ".", "add_scalar", "(", "tag", "=", "name", "+", "'_k'", ",", "value", "=", "self", ".", "_k_sum", ",", "global_step", "=", "global_step", ")", "\n", "sw", ".", "add_scalar", "(", "tag", "=", "name", "+", "'_m'", ",", "value", "=", "self", ".", "_m_max", ",", "global_step", "=", "global_step", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.FocalLoss.__init__": [[184, 202], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "axis", "=", "-", "1", ",", "alpha", "=", "0.25", ",", "gamma", "=", "2", ",", "\n", "from_logits", "=", "False", ",", "batch_axis", "=", "0", ",", "\n", "weight", "=", "None", ",", "num_class", "=", "None", ",", "\n", "eps", "=", "1e-9", ",", "size_average", "=", "True", ",", "scale", "=", "1.0", ",", "\n", "ignore_label", "=", "-", "1", ")", ":", "\n", "        ", "super", "(", "FocalLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_axis", "=", "axis", "\n", "self", ".", "_alpha", "=", "alpha", "\n", "self", ".", "_gamma", "=", "gamma", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "self", ".", "_weight", "=", "weight", "if", "weight", "is", "not", "None", "else", "1.0", "\n", "self", ".", "_batch_axis", "=", "batch_axis", "\n", "\n", "self", ".", "_scale", "=", "scale", "\n", "self", ".", "_num_class", "=", "num_class", "\n", "self", ".", "_from_logits", "=", "from_logits", "\n", "self", ".", "_eps", "=", "eps", "\n", "self", ".", "_size_average", "=", "size_average", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.FocalLoss.forward": [[203, 225], ["torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.min", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "torch.ones().to", "isegm.utils.misc.get_dims_with_exclusion", "isegm.utils.misc.get_dims_with_exclusion", "label.dim", "isegm.utils.misc.get_dims_with_exclusion", "torch.sum.dim", "torch.sum.dim", "torch.sum.dim", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.sum.dim", "torch.sum.dim", "torch.sum.dim"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion"], ["", "def", "forward", "(", "self", ",", "pred", ",", "label", ",", "sample_weight", "=", "None", ")", ":", "\n", "        ", "one_hot", "=", "label", ">", "0.5", "\n", "sample_weight", "=", "label", "!=", "self", ".", "_ignore_label", "\n", "\n", "if", "not", "self", ".", "_from_logits", ":", "\n", "            ", "pred", "=", "torch", ".", "sigmoid", "(", "pred", ")", "\n", "\n", "", "alpha", "=", "torch", ".", "where", "(", "one_hot", ",", "self", ".", "_alpha", "*", "sample_weight", ",", "(", "1", "-", "self", ".", "_alpha", ")", "*", "sample_weight", ")", "\n", "pt", "=", "torch", ".", "where", "(", "sample_weight", ",", "1.0", "-", "torch", ".", "abs", "(", "label", "-", "pred", ")", ",", "torch", ".", "ones_like", "(", "pred", ")", ")", "\n", "\n", "beta", "=", "(", "1", "-", "pt", ")", "**", "self", ".", "_gamma", "\n", "\n", "loss", "=", "-", "alpha", "*", "beta", "*", "torch", ".", "log", "(", "torch", ".", "min", "(", "pt", "+", "self", ".", "_eps", ",", "torch", ".", "ones", "(", "1", ",", "dtype", "=", "torch", ".", "float", ")", ".", "to", "(", "pt", ".", "device", ")", ")", ")", "\n", "loss", "=", "self", ".", "_weight", "*", "(", "loss", "*", "sample_weight", ")", "\n", "\n", "if", "self", ".", "_size_average", ":", "\n", "            ", "tsum", "=", "torch", ".", "sum", "(", "sample_weight", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "label", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "\n", "loss", "=", "torch", ".", "sum", "(", "loss", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "loss", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "/", "(", "tsum", "+", "self", ".", "_eps", ")", "\n", "", "else", ":", "\n", "            ", "loss", "=", "torch", ".", "sum", "(", "loss", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "loss", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "\n", "\n", "", "return", "self", ".", "_scale", "*", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.SoftIoU.__init__": [[228, 232], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "from_sigmoid", "=", "False", ",", "ignore_label", "=", "-", "1", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_from_sigmoid", "=", "from_sigmoid", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.SoftIoU.forward": [[233, 244], ["label.view.view.view", "torch.sigmoid.size", "torch.sigmoid.size", "torch.sigmoid.size", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "pred", ",", "label", ")", ":", "\n", "        ", "label", "=", "label", ".", "view", "(", "pred", ".", "size", "(", ")", ")", "\n", "sample_weight", "=", "label", "!=", "self", ".", "_ignore_label", "\n", "\n", "if", "not", "self", ".", "_from_sigmoid", ":", "\n", "            ", "pred", "=", "torch", ".", "sigmoid", "(", "pred", ")", "\n", "\n", "", "loss", "=", "1.0", "-", "torch", ".", "sum", "(", "pred", "*", "label", "*", "sample_weight", ",", "dim", "=", "(", "1", ",", "2", ",", "3", ")", ")", "/", "(", "torch", ".", "sum", "(", "torch", ".", "max", "(", "pred", ",", "label", ")", "*", "sample_weight", ",", "dim", "=", "(", "1", ",", "2", ",", "3", ")", ")", "+", "1e-8", ")", "\n", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.SigmoidBinaryCrossEntropyLoss.__init__": [[247, 253], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "from_sigmoid", "=", "False", ",", "weight", "=", "None", ",", "batch_axis", "=", "0", ",", "ignore_label", "=", "-", "1", ")", ":", "\n", "        ", "super", "(", "SigmoidBinaryCrossEntropyLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_from_sigmoid", "=", "from_sigmoid", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "self", ".", "_weight", "=", "weight", "if", "weight", "is", "not", "None", "else", "1.0", "\n", "self", ".", "_batch_axis", "=", "batch_axis", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.SigmoidBinaryCrossEntropyLoss.forward": [[254, 268], ["torch.where.view", "torch.where.view", "torch.where.view", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "pred.size", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.softplus", "torch.softplus", "torch.softplus", "isegm.utils.misc.get_dims_with_exclusion", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "loss.dim", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_dims_with_exclusion"], ["", "def", "forward", "(", "self", ",", "pred", ",", "label", ")", ":", "\n", "        ", "label", "=", "label", ".", "view", "(", "pred", ".", "size", "(", ")", ")", "\n", "sample_weight", "=", "label", "!=", "self", ".", "_ignore_label", "\n", "label", "=", "torch", ".", "where", "(", "sample_weight", ",", "label", ",", "torch", ".", "zeros_like", "(", "label", ")", ")", "\n", "\n", "if", "not", "self", ".", "_from_sigmoid", ":", "\n", "            ", "loss", "=", "torch", ".", "relu", "(", "pred", ")", "-", "pred", "*", "label", "+", "F", ".", "softplus", "(", "-", "torch", ".", "abs", "(", "pred", ")", ")", "\n", "", "else", ":", "\n", "            ", "eps", "=", "1e-12", "\n", "loss", "=", "-", "(", "torch", ".", "log", "(", "pred", "+", "eps", ")", "*", "label", "\n", "+", "torch", ".", "log", "(", "1.", "-", "pred", "+", "eps", ")", "*", "(", "1.", "-", "label", ")", ")", "\n", "\n", "", "loss", "=", "self", ".", "_weight", "*", "(", "loss", "*", "sample_weight", ")", "\n", "return", "torch", ".", "mean", "(", "loss", ",", "dim", "=", "misc", ".", "get_dims_with_exclusion", "(", "loss", ".", "dim", "(", ")", ",", "self", ".", "_batch_axis", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WeightedSigmoidBinaryCrossEntropyLoss.__init__": [[271, 277], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "from_sigmoid", "=", "False", ",", "weight", "=", "None", ",", "batch_axis", "=", "0", ",", "ignore_label", "=", "-", "1", ")", ":", "\n", "        ", "super", "(", "WeightedSigmoidBinaryCrossEntropyLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_from_sigmoid", "=", "from_sigmoid", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "self", ".", "_weight", "=", "weight", "if", "weight", "is", "not", "None", "else", "1.0", "\n", "self", ".", "_batch_axis", "=", "batch_axis", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WeightedSigmoidBinaryCrossEntropyLoss.forward": [[278, 292], ["torch.where.view", "torch.where.view", "torch.where.view", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "pred.size", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "weight.sum", "torch.softplus", "torch.softplus", "torch.softplus", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "pred", ",", "label", ",", "weight", ")", ":", "\n", "        ", "label", "=", "label", ".", "view", "(", "pred", ".", "size", "(", ")", ")", "\n", "sample_weight", "=", "label", "!=", "self", ".", "_ignore_label", "\n", "label", "=", "torch", ".", "where", "(", "sample_weight", ",", "label", ",", "torch", ".", "zeros_like", "(", "label", ")", ")", "\n", "\n", "if", "not", "self", ".", "_from_sigmoid", ":", "\n", "            ", "loss", "=", "torch", ".", "relu", "(", "pred", ")", "-", "pred", "*", "label", "+", "F", ".", "softplus", "(", "-", "torch", ".", "abs", "(", "pred", ")", ")", "\n", "", "else", ":", "\n", "            ", "eps", "=", "1e-12", "\n", "loss", "=", "-", "(", "torch", ".", "log", "(", "pred", "+", "eps", ")", "*", "label", "\n", "+", "torch", ".", "log", "(", "1.", "-", "pred", "+", "eps", ")", "*", "(", "1.", "-", "label", ")", ")", "\n", "#weight = weight * 0.8 + 0.2", "\n", "", "loss", "=", "(", "weight", "*", "loss", ")", ".", "sum", "(", ")", "/", "weight", ".", "sum", "(", ")", "\n", "return", "loss", "#torch.mean(loss, dim=misc.get_dims_with_exclusion(loss.dim(), self._batch_axis))", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.ClickLoss.__init__": [[297, 305], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "from_sigmoid", "=", "False", ",", "weight", "=", "None", ",", "batch_axis", "=", "0", ",", "ignore_label", "=", "-", "1", ",", "alpha", "=", "0.99", ",", "beta", "=", "0.01", ")", ":", "\n", "        ", "super", "(", "ClickLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_from_sigmoid", "=", "from_sigmoid", "\n", "self", ".", "_ignore_label", "=", "ignore_label", "\n", "self", ".", "_weight", "=", "weight", "if", "weight", "is", "not", "None", "else", "1.0", "\n", "self", ".", "_batch_axis", "=", "batch_axis", "\n", "self", ".", "alpha", "=", "alpha", "\n", "self", ".", "beta", "=", "beta", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.ClickLoss.forward": [[307, 330], ["torch.where.view", "torch.where.view", "torch.where.view", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate.size", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "weight_map.sum", "torch.softplus", "torch.softplus", "torch.softplus", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "gaussian_maps.max", "torch.where.size", "torch.where.size", "torch.where.size", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "pred", ",", "label", ",", "gaussian_maps", "=", "None", ")", ":", "\n", "        ", "h_gt", ",", "w_gt", "=", "label", ".", "shape", "[", "-", "2", "]", ",", "label", ".", "shape", "[", "-", "1", "]", "\n", "h_p", ",", "w_p", "=", "pred", ".", "shape", "[", "-", "2", "]", ",", "pred", ".", "shape", "[", "-", "1", "]", "\n", "if", "h_gt", "!=", "h_p", "or", "w_gt", "!=", "w_p", ":", "\n", "            ", "pred", "=", "F", ".", "interpolate", "(", "pred", ",", "size", "=", "label", ".", "size", "(", ")", "[", "-", "2", ":", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "\n", "", "label", "=", "label", ".", "view", "(", "pred", ".", "size", "(", ")", ")", "\n", "sample_weight", "=", "label", "!=", "self", ".", "_ignore_label", "\n", "label", "=", "torch", ".", "where", "(", "sample_weight", ",", "label", ",", "torch", ".", "zeros_like", "(", "label", ")", ")", "\n", "\n", "if", "not", "self", ".", "_from_sigmoid", ":", "\n", "            ", "loss", "=", "torch", ".", "relu", "(", "pred", ")", "-", "pred", "*", "label", "+", "F", ".", "softplus", "(", "-", "torch", ".", "abs", "(", "pred", ")", ")", "\n", "", "else", ":", "\n", "            ", "eps", "=", "1e-12", "\n", "loss", "=", "-", "(", "torch", ".", "log", "(", "pred", "+", "eps", ")", "*", "label", "\n", "+", "torch", ".", "log", "(", "1.", "-", "pred", "+", "eps", ")", "*", "(", "1.", "-", "label", ")", ")", "\n", "\n", "", "loss", "=", "self", ".", "_weight", "*", "(", "loss", "*", "sample_weight", ")", "\n", "weight_map", "=", "gaussian_maps", ".", "max", "(", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "[", "0", "]", "*", "self", ".", "alpha", "+", "self", ".", "beta", "\n", "loss", "=", "(", "loss", "*", "weight_map", ")", ".", "sum", "(", ")", "/", "weight_map", ".", "sum", "(", ")", "\n", "return", "loss", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.basic_blocks.ConvHead.__init__": [[7, 22], ["torch.Module.__init__", "range", "convhead.append", "torch.Sequential", "convhead.extend", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "norm_layer", "torch.Identity"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "out_channels", ",", "in_channels", "=", "32", ",", "num_layers", "=", "1", ",", "\n", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "ConvHead", ",", "self", ")", ".", "__init__", "(", ")", "\n", "convhead", "=", "[", "]", "\n", "\n", "for", "i", "in", "range", "(", "num_layers", ")", ":", "\n", "            ", "convhead", ".", "extend", "(", "[", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", ",", "kernel_size", ",", "padding", "=", "padding", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "norm_layer", "(", "in_channels", ")", "if", "norm_layer", "is", "not", "None", "else", "nn", ".", "Identity", "(", ")", "\n", "]", ")", "\n", "", "convhead", ".", "append", "(", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "padding", "=", "0", ")", ")", "\n", "\n", "self", ".", "convhead", "=", "nn", ".", "Sequential", "(", "*", "convhead", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.basic_blocks.ConvHead.forward": [[23, 25], ["basic_blocks.ConvHead.convhead"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "*", "inputs", ")", ":", "\n", "        ", "return", "self", ".", "convhead", "(", "inputs", "[", "0", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.basic_blocks.SepConvHead.__init__": [[28, 50], ["torch.Module.__init__", "range", "sepconvhead.append", "torch.Sequential", "sepconvhead.append", "torch.Conv2d", "basic_blocks.SeparableConv2d", "sepconvhead.append", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_outputs", ",", "in_channels", ",", "mid_channels", ",", "num_layers", "=", "1", ",", "\n", "kernel_size", "=", "3", ",", "padding", "=", "1", ",", "dropout_ratio", "=", "0.0", ",", "dropout_indx", "=", "0", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "SepConvHead", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "sepconvhead", "=", "[", "]", "\n", "\n", "for", "i", "in", "range", "(", "num_layers", ")", ":", "\n", "            ", "sepconvhead", ".", "append", "(", "\n", "SeparableConv2d", "(", "in_channels", "=", "in_channels", "if", "i", "==", "0", "else", "mid_channels", ",", "\n", "out_channels", "=", "mid_channels", ",", "\n", "dw_kernel", "=", "kernel_size", ",", "dw_padding", "=", "padding", ",", "\n", "norm_layer", "=", "norm_layer", ",", "activation", "=", "'relu'", ")", "\n", ")", "\n", "if", "dropout_ratio", ">", "0", "and", "dropout_indx", "==", "i", ":", "\n", "                ", "sepconvhead", ".", "append", "(", "nn", ".", "Dropout", "(", "dropout_ratio", ")", ")", "\n", "\n", "", "", "sepconvhead", ".", "append", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "mid_channels", ",", "out_channels", "=", "num_outputs", ",", "kernel_size", "=", "1", ",", "padding", "=", "0", ")", "\n", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "Sequential", "(", "*", "sepconvhead", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.basic_blocks.SepConvHead.forward": [[51, 55], ["basic_blocks.SepConvHead.layers"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "*", "inputs", ")", ":", "\n", "        ", "x", "=", "inputs", "[", "0", "]", "\n", "\n", "return", "self", ".", "layers", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.basic_blocks.SeparableConv2d.__init__": [[58, 68], ["torch.Module.__init__", "isegm.model.ops.select_activation_function", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "isegm.model.ops.select_activation_function.", "norm_layer", "torch.Identity"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.select_activation_function"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "dw_kernel", ",", "dw_padding", ",", "dw_stride", "=", "1", ",", "\n", "activation", "=", "None", ",", "use_bias", "=", "False", ",", "norm_layer", "=", "None", ")", ":", "\n", "        ", "super", "(", "SeparableConv2d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "_activation", "=", "ops", ".", "select_activation_function", "(", "activation", ")", "\n", "self", ".", "body", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "in_channels", ",", "kernel_size", "=", "dw_kernel", ",", "stride", "=", "dw_stride", ",", "\n", "padding", "=", "dw_padding", ",", "bias", "=", "use_bias", ",", "groups", "=", "in_channels", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "use_bias", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", "if", "norm_layer", "is", "not", "None", "else", "nn", ".", "Identity", "(", ")", ",", "\n", "_activation", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.basic_blocks.SeparableConv2d.forward": [[70, 72], ["basic_blocks.SeparableConv2d.body"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "body", "(", "x", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3.DeepLabV3Plus.__init__": [[13, 57], ["torch.nn.Module.__init__", "resnet.ResNetBackbone", "deeplab_v3._DeepLabHead", "deeplab_v3._SkipProject", "deeplab_v3._ASPP", "isegm.model.modeling.cdnet.FDM.FDM_v3", "deeplab_v3.DeepLabV3Plus.set_prediction_mode"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_model.SegFormer.set_prediction_mode"], ["    ", "def", "__init__", "(", "self", ",", "backbone", "=", "'resnet50'", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "\n", "backbone_norm_layer", "=", "None", ",", "\n", "ch", "=", "256", ",", "\n", "project_dropout", "=", "0.5", ",", "\n", "inference_mode", "=", "False", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "DeepLabV3Plus", ",", "self", ")", ".", "__init__", "(", ")", "\n", "if", "backbone_norm_layer", "is", "None", ":", "\n", "            ", "backbone_norm_layer", "=", "norm_layer", "\n", "\n", "", "self", ".", "backbone_name", "=", "backbone", "\n", "self", ".", "norm_layer", "=", "norm_layer", "\n", "self", ".", "backbone_norm_layer", "=", "backbone_norm_layer", "\n", "self", ".", "inference_mode", "=", "False", "\n", "self", ".", "ch", "=", "ch", "\n", "self", ".", "aspp_in_channels", "=", "2048", "\n", "self", ".", "skip_project_in_channels", "=", "256", "# layer 1 out_channels", "\n", "\n", "self", ".", "_kwargs", "=", "kwargs", "\n", "\n", "if", "backbone", "==", "'resnet34'", "or", "'resnet18'", ":", "\n", "            ", "self", ".", "aspp_in_channels", "=", "512", "\n", "self", ".", "skip_project_in_channels", "=", "64", "\n", "", "else", ":", "\n", "            ", "self", ".", "aspp_in_channels", "=", "512", "*", "4", "\n", "self", ".", "skip_project_in_channels", "=", "64", "*", "4", "\n", "\n", "\n", "\n", "", "self", ".", "backbone", "=", "ResNetBackbone", "(", "backbone", "=", "self", ".", "backbone_name", ",", "pretrained_base", "=", "False", ",", "\n", "norm_layer", "=", "self", ".", "backbone_norm_layer", ",", "**", "kwargs", ")", "\n", "\n", "self", ".", "head", "=", "_DeepLabHead", "(", "in_channels", "=", "ch", "+", "32", ",", "mid_channels", "=", "ch", ",", "out_channels", "=", "ch", ",", "\n", "norm_layer", "=", "self", ".", "norm_layer", ")", "\n", "self", ".", "skip_project", "=", "_SkipProject", "(", "self", ".", "skip_project_in_channels", ",", "32", ",", "norm_layer", "=", "self", ".", "norm_layer", ")", "\n", "self", ".", "aspp", "=", "_ASPP", "(", "in_channels", "=", "self", ".", "aspp_in_channels", ",", "\n", "atrous_rates", "=", "[", "12", ",", "24", ",", "36", "]", ",", "\n", "out_channels", "=", "ch", ",", "\n", "project_dropout", "=", "project_dropout", ",", "\n", "norm_layer", "=", "self", ".", "norm_layer", ")", "\n", "self", ".", "FDM", "=", "FDM_v3", "(", "self", ".", "ch", ",", "self", ".", "ch", ")", "\n", "\n", "if", "inference_mode", ":", "\n", "            ", "self", ".", "set_prediction_mode", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3.DeepLabV3Plus.load_pretrained_weights": [[58, 70], ["resnet.ResNetBackbone", "deeplab_v3.DeepLabV3Plus.backbone.state_dict", "resnet.ResNetBackbone.state_dict", "deeplab_v3.DeepLabV3Plus.update", "deeplab_v3.DeepLabV3Plus.backbone.load_state_dict", "deeplab_v3.DeepLabV3Plus.backbone.parameters"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "", "def", "load_pretrained_weights", "(", "self", ")", ":", "\n", "        ", "pretrained", "=", "ResNetBackbone", "(", "backbone", "=", "self", ".", "backbone_name", ",", "pretrained_base", "=", "True", ",", "\n", "norm_layer", "=", "self", ".", "backbone_norm_layer", ",", "**", "self", ".", "_kwargs", ")", "\n", "backbone_state_dict", "=", "self", ".", "backbone", ".", "state_dict", "(", ")", "\n", "pretrained_state_dict", "=", "pretrained", ".", "state_dict", "(", ")", "\n", "\n", "backbone_state_dict", ".", "update", "(", "pretrained_state_dict", ")", "\n", "self", ".", "backbone", ".", "load_state_dict", "(", "backbone_state_dict", ")", "\n", "\n", "if", "self", ".", "inference_mode", ":", "\n", "            ", "for", "param", "in", "self", ".", "backbone", ".", "parameters", "(", ")", ":", "\n", "                ", "param", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3.DeepLabV3Plus.set_prediction_mode": [[71, 74], ["deeplab_v3.DeepLabV3Plus.eval"], "methods", ["None"], ["", "", "", "def", "set_prediction_mode", "(", "self", ")", ":", "\n", "        ", "self", ".", "inference_mode", "=", "True", "\n", "self", ".", "eval", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3.DeepLabV3Plus.forward": [[75, 90], ["contextlib.ExitStack", "deeplab_v3.DeepLabV3Plus.backbone", "deeplab_v3.DeepLabV3Plus.skip_project", "deeplab_v3.DeepLabV3Plus.aspp", "deeplab_v3.DeepLabV3Plus.FDM", "torch.interpolate", "torch.interpolate", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "deeplab_v3.DeepLabV3Plus.head", "stack.enter_context", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "deeplab_v3.DeepLabV3Plus.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "additional_features", ",", "small_clicks", ")", ":", "\n", "\n", "        ", "with", "ExitStack", "(", ")", "as", "stack", ":", "\n", "            ", "if", "self", ".", "inference_mode", ":", "\n", "                ", "stack", ".", "enter_context", "(", "torch", ".", "no_grad", "(", ")", ")", "\n", "\n", "", "c1", ",", "_", ",", "c3", ",", "c4", "=", "self", ".", "backbone", "(", "x", ",", "additional_features", ")", "\n", "c1", "=", "self", ".", "skip_project", "(", "c1", ")", "\n", "\n", "x", "=", "self", ".", "aspp", "(", "c4", ")", "\n", "x", ",", "pos_map", ",", "neg_map", "=", "self", ".", "FDM", "(", "x", ",", "small_clicks", ")", "\n", "x", "=", "F", ".", "interpolate", "(", "x", ",", "c1", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x", "=", "torch", ".", "cat", "(", "(", "x", ",", "c1", ")", ",", "dim", "=", "1", ")", "\n", "x", "=", "self", ".", "head", "(", "x", ")", "\n", "", "return", "x", ",", "pos_map", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._SkipProject.__init__": [[93, 101], ["torch.nn.Module.__init__", "isegm.model.ops.select_activation_function", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Conv2d", "torch.nn.Conv2d", "norm_layer", "isegm.model.ops.select_activation_function."], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.ops.select_activation_function"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "_SkipProject", ",", "self", ")", ".", "__init__", "(", ")", "\n", "_activation", "=", "ops", ".", "select_activation_function", "(", "\"relu\"", ")", "\n", "\n", "self", ".", "skip_project", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "_activation", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._SkipProject.forward": [[103, 105], ["deeplab_v3._SkipProject.skip_project"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "skip_project", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._DeepLabHead.__init__": [[108, 117], ["torch.nn.Module.__init__", "torch.nn.Sequential", "torch.nn.Sequential", "basic_blocks.SeparableConv2d", "basic_blocks.SeparableConv2d", "torch.nn.Conv2d", "torch.nn.Conv2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "out_channels", ",", "in_channels", ",", "mid_channels", "=", "256", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "_DeepLabHead", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "block", "=", "nn", ".", "Sequential", "(", "\n", "SeparableConv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "mid_channels", ",", "dw_kernel", "=", "3", ",", "\n", "dw_padding", "=", "1", ",", "activation", "=", "'relu'", ",", "norm_layer", "=", "norm_layer", ")", ",", "\n", "SeparableConv2d", "(", "in_channels", "=", "mid_channels", ",", "out_channels", "=", "mid_channels", ",", "dw_kernel", "=", "3", ",", "\n", "dw_padding", "=", "1", ",", "activation", "=", "'relu'", ",", "norm_layer", "=", "norm_layer", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "mid_channels", ",", "out_channels", "=", "out_channels", ",", "kernel_size", "=", "1", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._DeepLabHead.forward": [[119, 121], ["deeplab_v3._DeepLabHead.block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "block", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._ASPP.__init__": [[124, 151], ["torch.nn.Module.__init__", "torch.nn.Sequential", "torch.nn.Sequential", "tuple", "deeplab_v3._ASPPConv", "deeplab_v3._ASPPConv", "deeplab_v3._ASPPConv", "deeplab_v3._AsppPooling", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Conv2d", "torch.nn.Conv2d", "norm_layer", "torch.nn.ReLU", "torch.nn.ReLU", "torch.nn.Conv2d", "torch.nn.Conv2d", "norm_layer", "torch.nn.ReLU", "torch.nn.ReLU", "project.append", "torch.nn.Dropout", "torch.nn.Dropout"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._ASPPConv", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._ASPPConv", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._ASPPConv"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "atrous_rates", ",", "out_channels", "=", "256", ",", "\n", "project_dropout", "=", "0.5", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "_ASPP", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "b0", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "out_channels", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "\n", "\n", "rate1", ",", "rate2", ",", "rate3", "=", "tuple", "(", "atrous_rates", ")", "\n", "b1", "=", "_ASPPConv", "(", "in_channels", ",", "out_channels", ",", "rate1", ",", "norm_layer", ")", "\n", "b2", "=", "_ASPPConv", "(", "in_channels", ",", "out_channels", ",", "rate2", ",", "norm_layer", ")", "\n", "b3", "=", "_ASPPConv", "(", "in_channels", ",", "out_channels", ",", "rate3", ",", "norm_layer", ")", "\n", "b4", "=", "_AsppPooling", "(", "in_channels", ",", "out_channels", ",", "norm_layer", "=", "norm_layer", ")", "\n", "\n", "self", ".", "concurent", "=", "nn", ".", "ModuleList", "(", "[", "b0", ",", "b1", ",", "b2", ",", "b3", ",", "b4", "]", ")", "\n", "\n", "project", "=", "[", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "5", "*", "out_channels", ",", "out_channels", "=", "out_channels", ",", "\n", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", "]", "\n", "if", "project_dropout", ">", "0", ":", "\n", "            ", "project", ".", "append", "(", "nn", ".", "Dropout", "(", "project_dropout", ")", ")", "\n", "", "self", ".", "project", "=", "nn", ".", "Sequential", "(", "*", "project", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._ASPP.forward": [[152, 156], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "deeplab_v3._ASPP.project", "block"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "torch", ".", "cat", "(", "[", "block", "(", "x", ")", "for", "block", "in", "self", ".", "concurent", "]", ",", "dim", "=", "1", ")", "\n", "\n", "return", "self", ".", "project", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._AsppPooling.__init__": [[159, 168], ["torch.nn.Module.__init__", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.AdaptiveAvgPool2d", "torch.nn.AdaptiveAvgPool2d", "torch.nn.Conv2d", "torch.nn.Conv2d", "norm_layer", "torch.nn.ReLU", "torch.nn.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "norm_layer", ")", ":", "\n", "        ", "super", "(", "_AsppPooling", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "gap", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "out_channels", ",", "\n", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._AsppPooling.forward": [[170, 173], ["deeplab_v3._AsppPooling.gap", "torch.interpolate", "torch.interpolate", "x.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "pool", "=", "self", ".", "gap", "(", "x", ")", "\n", "return", "F", ".", "interpolate", "(", "pool", ",", "x", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.deeplab_v3._ASPPConv": [[175, 185], ["torch.nn.Sequential", "torch.nn.Conv2d", "norm_layer", "torch.nn.ReLU"], "function", ["None"], ["", "", "def", "_ASPPConv", "(", "in_channels", ",", "out_channels", ",", "atrous_rate", ",", "norm_layer", ")", ":", "\n", "    ", "block", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "out_channels", ",", "\n", "kernel_size", "=", "3", ",", "padding", "=", "atrous_rate", ",", "\n", "dilation", "=", "atrous_rate", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "\n", "\n", "return", "block", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.BasicBlockV1b.__init__": [[9, 22], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "stride", "=", "1", ",", "dilation", "=", "1", ",", "downsample", "=", "None", ",", "\n", "previous_dilation", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "BasicBlockV1b", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "dilation", ",", "dilation", "=", "dilation", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "norm_layer", "(", "planes", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "previous_dilation", ",", "dilation", "=", "previous_dilation", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "norm_layer", "(", "planes", ")", "\n", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "stride", "=", "stride", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.BasicBlockV1b.forward": [[23, 40], ["resnetv1b.BasicBlockV1b.conv1", "resnetv1b.BasicBlockV1b.bn1", "resnetv1b.BasicBlockV1b.relu", "resnetv1b.BasicBlockV1b.conv2", "resnetv1b.BasicBlockV1b.bn2", "resnetv1b.BasicBlockV1b.relu", "resnetv1b.BasicBlockV1b.downsample"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "residual", "=", "x", "\n", "\n", "out", "=", "self", ".", "conv1", "(", "x", ")", "\n", "out", "=", "self", ".", "bn1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "out", "=", "self", ".", "bn2", "(", "out", ")", "\n", "\n", "if", "self", ".", "downsample", "is", "not", "None", ":", "\n", "            ", "residual", "=", "self", ".", "downsample", "(", "x", ")", "\n", "\n", "", "out", "=", "out", "+", "residual", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.BottleneckV1b.__init__": [[45, 61], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "stride", "=", "1", ",", "dilation", "=", "1", ",", "downsample", "=", "None", ",", "\n", "previous_dilation", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "BottleneckV1b", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "norm_layer", "(", "planes", ")", "\n", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", ",", "kernel_size", "=", "3", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "dilation", ",", "dilation", "=", "dilation", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "norm_layer", "(", "planes", ")", "\n", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "planes", ",", "planes", "*", "self", ".", "expansion", ",", "kernel_size", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn3", "=", "norm_layer", "(", "planes", "*", "self", ".", "expansion", ")", "\n", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "downsample", "=", "downsample", "\n", "self", ".", "stride", "=", "stride", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.BottleneckV1b.forward": [[62, 83], ["resnetv1b.BottleneckV1b.conv1", "resnetv1b.BottleneckV1b.bn1", "resnetv1b.BottleneckV1b.relu", "resnetv1b.BottleneckV1b.conv2", "resnetv1b.BottleneckV1b.bn2", "resnetv1b.BottleneckV1b.relu", "resnetv1b.BottleneckV1b.conv3", "resnetv1b.BottleneckV1b.bn3", "resnetv1b.BottleneckV1b.relu", "resnetv1b.BottleneckV1b.downsample"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "residual", "=", "x", "\n", "\n", "out", "=", "self", ".", "conv1", "(", "x", ")", "\n", "out", "=", "self", ".", "bn1", "(", "out", ")", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "out", "=", "self", ".", "bn2", "(", "out", ")", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv3", "(", "out", ")", "\n", "out", "=", "self", ".", "bn3", "(", "out", ")", "\n", "\n", "if", "self", ".", "downsample", "is", "not", "None", ":", "\n", "            ", "residual", "=", "self", ".", "downsample", "(", "x", ")", "\n", "\n", "", "out", "=", "out", "+", "residual", "\n", "out", "=", "self", ".", "relu", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.ResNetV1b.__init__": [[114, 152], ["torch.Module.__init__", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "resnetv1b.ResNetV1b._make_layer", "resnetv1b.ResNetV1b._make_layer", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Linear", "torch.Linear", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "resnetv1b.ResNetV1b._make_layer", "resnetv1b.ResNetV1b._make_layer", "resnetv1b.ResNetV1b._make_layer", "resnetv1b.ResNetV1b._make_layer", "torch.Dropout", "torch.Dropout", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer"], ["def", "__init__", "(", "self", ",", "block", ",", "layers", ",", "classes", "=", "1000", ",", "dilated", "=", "True", ",", "deep_stem", "=", "False", ",", "stem_width", "=", "32", ",", "\n", "avg_down", "=", "False", ",", "final_drop", "=", "0.0", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "self", ".", "inplanes", "=", "stem_width", "*", "2", "if", "deep_stem", "else", "64", "\n", "super", "(", "ResNetV1b", ",", "self", ")", ".", "__init__", "(", ")", "\n", "if", "not", "deep_stem", ":", "\n", "            ", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "7", ",", "stride", "=", "2", ",", "padding", "=", "3", ",", "bias", "=", "False", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "conv1", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "3", ",", "stem_width", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "stem_width", ")", ",", "\n", "nn", ".", "ReLU", "(", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "stem_width", ",", "stem_width", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "stem_width", ")", ",", "\n", "nn", ".", "ReLU", "(", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "stem_width", ",", "2", "*", "stem_width", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", ")", "\n", "", "self", ".", "bn1", "=", "norm_layer", "(", "self", ".", "inplanes", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "True", ")", "\n", "self", ".", "maxpool", "=", "nn", ".", "MaxPool2d", "(", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ")", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "block", ",", "64", ",", "layers", "[", "0", "]", ",", "avg_down", "=", "avg_down", ",", "\n", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer2", "=", "self", ".", "_make_layer", "(", "block", ",", "128", ",", "layers", "[", "1", "]", ",", "stride", "=", "2", ",", "avg_down", "=", "avg_down", ",", "\n", "norm_layer", "=", "norm_layer", ")", "\n", "if", "dilated", ":", "\n", "            ", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "layers", "[", "2", "]", ",", "stride", "=", "1", ",", "dilation", "=", "2", ",", "\n", "avg_down", "=", "avg_down", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "layers", "[", "3", "]", ",", "stride", "=", "1", ",", "dilation", "=", "4", ",", "\n", "avg_down", "=", "avg_down", ",", "norm_layer", "=", "norm_layer", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "block", ",", "256", ",", "layers", "[", "2", "]", ",", "stride", "=", "2", ",", "\n", "avg_down", "=", "avg_down", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "block", ",", "512", ",", "layers", "[", "3", "]", ",", "stride", "=", "2", ",", "\n", "avg_down", "=", "avg_down", ",", "norm_layer", "=", "norm_layer", ")", "\n", "", "self", ".", "avgpool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "drop", "=", "None", "\n", "if", "final_drop", ">", "0.0", ":", "\n", "            ", "self", ".", "drop", "=", "nn", ".", "Dropout", "(", "final_drop", ")", "\n", "", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "512", "*", "block", ".", "expansion", ",", "classes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.ResNetV1b._make_layer": [[153, 196], ["range", "torch.Sequential", "torch.Sequential", "layers.append", "layers.append", "torch.Sequential.extend", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "block", "layers.append", "RuntimeError", "block", "torch.Sequential.append", "torch.Sequential.append", "torch.Conv2d", "torch.Conv2d", "norm_layer", "block", "torch.AvgPool2d", "torch.AvgPool2d", "torch.AvgPool2d", "torch.AvgPool2d", "torch.Conv2d", "torch.Conv2d", "norm_layer"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "blocks", ",", "stride", "=", "1", ",", "dilation", "=", "1", ",", "\n", "avg_down", "=", "False", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "downsample", "=", "None", "\n", "if", "stride", "!=", "1", "or", "self", ".", "inplanes", "!=", "planes", "*", "block", ".", "expansion", ":", "\n", "            ", "downsample", "=", "[", "]", "\n", "if", "avg_down", ":", "\n", "                ", "if", "dilation", "==", "1", ":", "\n", "                    ", "downsample", ".", "append", "(", "\n", "nn", ".", "AvgPool2d", "(", "kernel_size", "=", "stride", ",", "stride", "=", "stride", ",", "ceil_mode", "=", "True", ",", "count_include_pad", "=", "False", ")", "\n", ")", "\n", "", "else", ":", "\n", "                    ", "downsample", ".", "append", "(", "\n", "nn", ".", "AvgPool2d", "(", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "ceil_mode", "=", "True", ",", "count_include_pad", "=", "False", ")", "\n", ")", "\n", "", "downsample", ".", "extend", "(", "[", "\n", "nn", ".", "Conv2d", "(", "self", ".", "inplanes", ",", "out_channels", "=", "planes", "*", "block", ".", "expansion", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "planes", "*", "block", ".", "expansion", ")", "\n", "]", ")", "\n", "downsample", "=", "nn", ".", "Sequential", "(", "*", "downsample", ")", "\n", "", "else", ":", "\n", "                ", "downsample", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "self", ".", "inplanes", ",", "out_channels", "=", "planes", "*", "block", ".", "expansion", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "planes", "*", "block", ".", "expansion", ")", "\n", ")", "\n", "\n", "", "", "layers", "=", "[", "]", "\n", "if", "dilation", "in", "(", "1", ",", "2", ")", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "inplanes", ",", "planes", ",", "stride", ",", "dilation", "=", "1", ",", "downsample", "=", "downsample", ",", "\n", "previous_dilation", "=", "dilation", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "", "elif", "dilation", "==", "4", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "inplanes", ",", "planes", ",", "stride", ",", "dilation", "=", "2", ",", "downsample", "=", "downsample", ",", "\n", "previous_dilation", "=", "dilation", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "", "else", ":", "\n", "            ", "raise", "RuntimeError", "(", "\"=> unknown dilation size: {}\"", ".", "format", "(", "dilation", ")", ")", "\n", "\n", "", "self", ".", "inplanes", "=", "planes", "*", "block", ".", "expansion", "\n", "for", "_", "in", "range", "(", "1", ",", "blocks", ")", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "inplanes", ",", "planes", ",", "dilation", "=", "dilation", ",", "\n", "previous_dilation", "=", "dilation", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.ResNetV1b.forward": [[197, 215], ["resnetv1b.ResNetV1b.conv1", "resnetv1b.ResNetV1b.bn1", "resnetv1b.ResNetV1b.relu", "resnetv1b.ResNetV1b.maxpool", "resnetv1b.ResNetV1b.layer1", "resnetv1b.ResNetV1b.layer2", "resnetv1b.ResNetV1b.layer3", "resnetv1b.ResNetV1b.layer4", "resnetv1b.ResNetV1b.avgpool", "resnetv1b.ResNetV1b.view", "resnetv1b.ResNetV1b.fc", "resnetv1b.ResNetV1b.size", "resnetv1b.ResNetV1b.drop"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x", "=", "self", ".", "bn1", "(", "x", ")", "\n", "x", "=", "self", ".", "relu", "(", "x", ")", "\n", "x", "=", "self", ".", "maxpool", "(", "x", ")", "\n", "\n", "x", "=", "self", ".", "layer1", "(", "x", ")", "\n", "x", "=", "self", ".", "layer2", "(", "x", ")", "\n", "x", "=", "self", ".", "layer3", "(", "x", ")", "\n", "x", "=", "self", ".", "layer4", "(", "x", ")", "\n", "\n", "x", "=", "self", ".", "avgpool", "(", "x", ")", "\n", "x", "=", "x", ".", "view", "(", "x", ".", "size", "(", "0", ")", ",", "-", "1", ")", "\n", "if", "self", ".", "drop", "is", "not", "None", ":", "\n", "            ", "x", "=", "self", ".", "drop", "(", "x", ")", "\n", "", "x", "=", "self", ".", "fc", "(", "x", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b._safe_state_dict_filtering": [[217, 225], ["orig_dict.items", "print"], "function", ["None"], ["", "", "def", "_safe_state_dict_filtering", "(", "orig_dict", ",", "model_dict_keys", ")", ":", "\n", "    ", "filtered_orig_dict", "=", "{", "}", "\n", "for", "k", ",", "v", "in", "orig_dict", ".", "items", "(", ")", ":", "\n", "        ", "if", "k", "in", "model_dict_keys", ":", "\n", "            ", "filtered_orig_dict", "[", "k", "]", "=", "v", "\n", "", "else", ":", "\n", "            ", "print", "(", "f\"[ERROR] Failed to load <{k}> in backbone\"", ")", "\n", "", "", "return", "filtered_orig_dict", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet18_v1b": [[228, 233], ["resnetv1b.ResNetV1b"], "function", ["None"], ["", "def", "resnet18_v1b", "(", "pretrained", "=", "False", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "ResNetV1b", "(", "BasicBlockV1b", ",", "[", "2", ",", "2", ",", "2", ",", "2", "]", ",", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "pass", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet34_v1b": [[235, 249], ["resnetv1b.ResNetV1b", "ResNetV1b.state_dict", "torch.load", "torch.load", "model.state_dict.update", "ResNetV1b.load_state_dict"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "resnet34_v1b", "(", "pretrained", "=", "False", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "ResNetV1b", "(", "BasicBlockV1b", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ",", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "model_dict", "=", "model", ".", "state_dict", "(", ")", "\n", "'''\n        filtered_orig_dict = _safe_state_dict_filtering(\n            torch.hub.load(GLUON_RESNET_TORCH_HUB, 'gluon_resnet34_v1b', pretrained=True).state_dict(),\n            model_dict.keys()\n        )\n        '''", "\n", "filtered_orig_dict", "=", "torch", ".", "load", "(", "'/home/admin/workspace/project/data/weights/gluon_resnet34_v1b-c6d82d59.pth'", ",", "map_location", "=", "'cpu'", ")", "#['state_dict']", "\n", "model_dict", ".", "update", "(", "filtered_orig_dict", ")", "\n", "model", ".", "load_state_dict", "(", "model_dict", ")", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet50_v1s": [[251, 264], ["resnetv1b.ResNetV1b", "ResNetV1b.state_dict", "torch.load", "torch.load", "model.state_dict.update", "ResNetV1b.load_state_dict"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "resnet50_v1s", "(", "pretrained", "=", "False", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "ResNetV1b", "(", "BottleneckV1b", ",", "[", "3", ",", "4", ",", "6", ",", "3", "]", ",", "deep_stem", "=", "True", ",", "stem_width", "=", "64", ",", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "model_dict", "=", "model", ".", "state_dict", "(", ")", "\n", "'''\n        filtered_orig_dict = _safe_state_dict_filtering(\n            torch.hub.load(GLUON_RESNET_TORCH_HUB, 'gluon_resnet50_v1s', pretrained=True).state_dict(),\n            model_dict.keys()\n        )'''", "\n", "filtered_orig_dict", "=", "torch", ".", "load", "(", "'/home/admin/workspace/project/data/weights/gluon_resnet50_v1s-1762acc0.pth'", ",", "map_location", "=", "'cpu'", ")", "#['state_dict']", "\n", "model_dict", ".", "update", "(", "filtered_orig_dict", ")", "\n", "model", ".", "load_state_dict", "(", "model_dict", ")", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet101_v1s": [[266, 277], ["resnetv1b.ResNetV1b", "ResNetV1b.state_dict", "resnetv1b._safe_state_dict_filtering", "model.state_dict.update", "ResNetV1b.load_state_dict", "torch.hub.load().state_dict", "torch.hub.load().state_dict", "model.state_dict.keys", "torch.hub.load", "torch.hub.load"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b._safe_state_dict_filtering", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "resnet101_v1s", "(", "pretrained", "=", "False", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "ResNetV1b", "(", "BottleneckV1b", ",", "[", "3", ",", "4", ",", "23", ",", "3", "]", ",", "deep_stem", "=", "True", ",", "stem_width", "=", "64", ",", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "model_dict", "=", "model", ".", "state_dict", "(", ")", "\n", "filtered_orig_dict", "=", "_safe_state_dict_filtering", "(", "\n", "torch", ".", "hub", ".", "load", "(", "GLUON_RESNET_TORCH_HUB", ",", "'gluon_resnet101_v1s'", ",", "pretrained", "=", "True", ")", ".", "state_dict", "(", ")", ",", "\n", "model_dict", ".", "keys", "(", ")", "\n", ")", "\n", "model_dict", ".", "update", "(", "filtered_orig_dict", ")", "\n", "model", ".", "load_state_dict", "(", "model_dict", ")", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet152_v1s": [[279, 290], ["resnetv1b.ResNetV1b", "ResNetV1b.state_dict", "resnetv1b._safe_state_dict_filtering", "model.state_dict.update", "ResNetV1b.load_state_dict", "torch.hub.load().state_dict", "torch.hub.load().state_dict", "model.state_dict.keys", "torch.hub.load", "torch.hub.load"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b._safe_state_dict_filtering", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "resnet152_v1s", "(", "pretrained", "=", "False", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "ResNetV1b", "(", "BottleneckV1b", ",", "[", "3", ",", "8", ",", "36", ",", "3", "]", ",", "deep_stem", "=", "True", ",", "stem_width", "=", "64", ",", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "model_dict", "=", "model", ".", "state_dict", "(", ")", "\n", "filtered_orig_dict", "=", "_safe_state_dict_filtering", "(", "\n", "torch", ".", "hub", ".", "load", "(", "GLUON_RESNET_TORCH_HUB", ",", "'gluon_resnet152_v1s'", ",", "pretrained", "=", "True", ")", ".", "state_dict", "(", ")", ",", "\n", "model_dict", ".", "keys", "(", ")", "\n", ")", "\n", "model_dict", ".", "update", "(", "filtered_orig_dict", ")", "\n", "model", ".", "load_state_dict", "(", "model_dict", ")", "\n", "", "return", "model", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule.__init__": [[14, 32], ["torch.Module.__init__", "hrnet_ocr.HighResolutionModule._check_branches", "hrnet_ocr.HighResolutionModule._make_branches", "hrnet_ocr.HighResolutionModule._make_fuse_layers", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._check_branches", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._make_branches", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._make_fuse_layers"], ["    ", "def", "__init__", "(", "self", ",", "num_branches", ",", "blocks", ",", "num_blocks", ",", "num_inchannels", ",", "\n", "num_channels", ",", "fuse_method", ",", "multi_scale_output", "=", "True", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "align_corners", "=", "True", ")", ":", "\n", "        ", "super", "(", "HighResolutionModule", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_check_branches", "(", "num_branches", ",", "num_blocks", ",", "num_inchannels", ",", "num_channels", ")", "\n", "\n", "self", ".", "num_inchannels", "=", "num_inchannels", "\n", "self", ".", "fuse_method", "=", "fuse_method", "\n", "self", ".", "num_branches", "=", "num_branches", "\n", "self", ".", "norm_layer", "=", "norm_layer", "\n", "self", ".", "align_corners", "=", "align_corners", "\n", "\n", "self", ".", "multi_scale_output", "=", "multi_scale_output", "\n", "\n", "self", ".", "branches", "=", "self", ".", "_make_branches", "(", "\n", "num_branches", ",", "blocks", ",", "num_blocks", ",", "num_channels", ")", "\n", "self", ".", "fuse_layers", "=", "self", ".", "_make_fuse_layers", "(", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._check_branches": [[33, 48], ["len", "ValueError", "len", "ValueError", "len", "ValueError", "len", "len", "len"], "methods", ["None"], ["", "def", "_check_branches", "(", "self", ",", "num_branches", ",", "num_blocks", ",", "num_inchannels", ",", "num_channels", ")", ":", "\n", "        ", "if", "num_branches", "!=", "len", "(", "num_blocks", ")", ":", "\n", "            ", "error_msg", "=", "'NUM_BRANCHES({}) <> NUM_BLOCKS({})'", ".", "format", "(", "\n", "num_branches", ",", "len", "(", "num_blocks", ")", ")", "\n", "raise", "ValueError", "(", "error_msg", ")", "\n", "\n", "", "if", "num_branches", "!=", "len", "(", "num_channels", ")", ":", "\n", "            ", "error_msg", "=", "'NUM_BRANCHES({}) <> NUM_CHANNELS({})'", ".", "format", "(", "\n", "num_branches", ",", "len", "(", "num_channels", ")", ")", "\n", "raise", "ValueError", "(", "error_msg", ")", "\n", "\n", "", "if", "num_branches", "!=", "len", "(", "num_inchannels", ")", ":", "\n", "            ", "error_msg", "=", "'NUM_BRANCHES({}) <> NUM_INCHANNELS({})'", ".", "format", "(", "\n", "num_branches", ",", "len", "(", "num_inchannels", ")", ")", "\n", "raise", "ValueError", "(", "error_msg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._make_one_branch": [[49, 73], ["layers.append", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "block", "layers.append", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "hrnet_ocr.HighResolutionModule.norm_layer", "block"], "methods", ["None"], ["", "", "def", "_make_one_branch", "(", "self", ",", "branch_index", ",", "block", ",", "num_blocks", ",", "num_channels", ",", "\n", "stride", "=", "1", ")", ":", "\n", "        ", "downsample", "=", "None", "\n", "if", "stride", "!=", "1", "or", "self", ".", "num_inchannels", "[", "branch_index", "]", "!=", "num_channels", "[", "branch_index", "]", "*", "block", ".", "expansion", ":", "\n", "            ", "downsample", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "self", ".", "num_inchannels", "[", "branch_index", "]", ",", "\n", "num_channels", "[", "branch_index", "]", "*", "block", ".", "expansion", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", ",", "\n", "self", ".", "norm_layer", "(", "num_channels", "[", "branch_index", "]", "*", "block", ".", "expansion", ")", ",", "\n", ")", "\n", "\n", "", "layers", "=", "[", "]", "\n", "layers", ".", "append", "(", "block", "(", "self", ".", "num_inchannels", "[", "branch_index", "]", ",", "\n", "num_channels", "[", "branch_index", "]", ",", "stride", ",", "\n", "downsample", "=", "downsample", ",", "norm_layer", "=", "self", ".", "norm_layer", ")", ")", "\n", "self", ".", "num_inchannels", "[", "branch_index", "]", "=", "num_channels", "[", "branch_index", "]", "*", "block", ".", "expansion", "\n", "for", "i", "in", "range", "(", "1", ",", "num_blocks", "[", "branch_index", "]", ")", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "self", ".", "num_inchannels", "[", "branch_index", "]", ",", "\n", "num_channels", "[", "branch_index", "]", ",", "\n", "norm_layer", "=", "self", ".", "norm_layer", ")", ")", "\n", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._make_branches": [[74, 82], ["range", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "branches.append", "hrnet_ocr.HighResolutionModule._make_one_branch"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._make_one_branch"], ["", "def", "_make_branches", "(", "self", ",", "num_branches", ",", "block", ",", "num_blocks", ",", "num_channels", ")", ":", "\n", "        ", "branches", "=", "[", "]", "\n", "\n", "for", "i", "in", "range", "(", "num_branches", ")", ":", "\n", "            ", "branches", ".", "append", "(", "\n", "self", ".", "_make_one_branch", "(", "i", ",", "block", ",", "num_blocks", ",", "num_channels", ")", ")", "\n", "\n", "", "return", "nn", ".", "ModuleList", "(", "branches", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule._make_fuse_layers": [[83, 124], ["range", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "fuse_layers.append", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "fuse_layer.append", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "fuse_layer.append", "range", "fuse_layer.append", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "hrnet_ocr.HighResolutionModule.norm_layer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "conv3x3s.append", "conv3x3s.append", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "hrnet_ocr.HighResolutionModule.norm_layer", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "hrnet_ocr.HighResolutionModule.norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["None"], ["", "def", "_make_fuse_layers", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "num_branches", "==", "1", ":", "\n", "            ", "return", "None", "\n", "\n", "", "num_branches", "=", "self", ".", "num_branches", "\n", "num_inchannels", "=", "self", ".", "num_inchannels", "\n", "fuse_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "num_branches", "if", "self", ".", "multi_scale_output", "else", "1", ")", ":", "\n", "            ", "fuse_layer", "=", "[", "]", "\n", "for", "j", "in", "range", "(", "num_branches", ")", ":", "\n", "                ", "if", "j", ">", "i", ":", "\n", "                    ", "fuse_layer", ".", "append", "(", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "num_inchannels", "[", "j", "]", ",", "\n", "out_channels", "=", "num_inchannels", "[", "i", "]", ",", "\n", "kernel_size", "=", "1", ",", "\n", "bias", "=", "False", ")", ",", "\n", "self", ".", "norm_layer", "(", "num_inchannels", "[", "i", "]", ")", ")", ")", "\n", "", "elif", "j", "==", "i", ":", "\n", "                    ", "fuse_layer", ".", "append", "(", "None", ")", "\n", "", "else", ":", "\n", "                    ", "conv3x3s", "=", "[", "]", "\n", "for", "k", "in", "range", "(", "i", "-", "j", ")", ":", "\n", "                        ", "if", "k", "==", "i", "-", "j", "-", "1", ":", "\n", "                            ", "num_outchannels_conv3x3", "=", "num_inchannels", "[", "i", "]", "\n", "conv3x3s", ".", "append", "(", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "num_inchannels", "[", "j", "]", ",", "\n", "num_outchannels_conv3x3", ",", "\n", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "self", ".", "norm_layer", "(", "num_outchannels_conv3x3", ")", ")", ")", "\n", "", "else", ":", "\n", "                            ", "num_outchannels_conv3x3", "=", "num_inchannels", "[", "j", "]", "\n", "conv3x3s", ".", "append", "(", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "num_inchannels", "[", "j", "]", ",", "\n", "num_outchannels_conv3x3", ",", "\n", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "self", ".", "norm_layer", "(", "num_outchannels_conv3x3", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", ")", ")", "\n", "", "", "fuse_layer", ".", "append", "(", "nn", ".", "Sequential", "(", "*", "conv3x3s", ")", ")", "\n", "", "", "fuse_layers", ".", "append", "(", "nn", ".", "ModuleList", "(", "fuse_layer", ")", ")", "\n", "\n", "", "return", "nn", ".", "ModuleList", "(", "fuse_layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule.get_num_inchannels": [[125, 127], ["None"], "methods", ["None"], ["", "def", "get_num_inchannels", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "num_inchannels", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule.forward": [[128, 153], ["range", "range", "len", "range", "x_fuse.append", "hrnet_ocr.HighResolutionModule.relu", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "if", "self", ".", "num_branches", "==", "1", ":", "\n", "            ", "return", "[", "self", ".", "branches", "[", "0", "]", "(", "x", "[", "0", "]", ")", "]", "\n", "\n", "", "for", "i", "in", "range", "(", "self", ".", "num_branches", ")", ":", "\n", "            ", "x", "[", "i", "]", "=", "self", ".", "branches", "[", "i", "]", "(", "x", "[", "i", "]", ")", "\n", "\n", "", "x_fuse", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "self", ".", "fuse_layers", ")", ")", ":", "\n", "            ", "y", "=", "x", "[", "0", "]", "if", "i", "==", "0", "else", "self", ".", "fuse_layers", "[", "i", "]", "[", "0", "]", "(", "x", "[", "0", "]", ")", "\n", "for", "j", "in", "range", "(", "1", ",", "self", ".", "num_branches", ")", ":", "\n", "                ", "if", "i", "==", "j", ":", "\n", "                    ", "y", "=", "y", "+", "x", "[", "j", "]", "\n", "", "elif", "j", ">", "i", ":", "\n", "                    ", "width_output", "=", "x", "[", "i", "]", ".", "shape", "[", "-", "1", "]", "\n", "height_output", "=", "x", "[", "i", "]", ".", "shape", "[", "-", "2", "]", "\n", "y", "=", "y", "+", "F", ".", "interpolate", "(", "\n", "self", ".", "fuse_layers", "[", "i", "]", "[", "j", "]", "(", "x", "[", "j", "]", ")", ",", "\n", "size", "=", "[", "height_output", ",", "width_output", "]", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "self", ".", "align_corners", ")", "\n", "", "else", ":", "\n", "                    ", "y", "=", "y", "+", "self", ".", "fuse_layers", "[", "i", "]", "[", "j", "]", "(", "x", "[", "j", "]", ")", "\n", "", "", "x_fuse", ".", "append", "(", "self", ".", "relu", "(", "y", ")", ")", "\n", "\n", "", "return", "x_fuse", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.__init__": [[156, 247], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "hrnet_ocr.HighResolutionNet._make_layer", "hrnet_ocr.HighResolutionNet._make_transition_layer", "hrnet_ocr.HighResolutionNet._make_stage", "hrnet_ocr.HighResolutionNet._make_transition_layer", "hrnet_ocr.HighResolutionNet._make_stage", "hrnet_ocr.HighResolutionNet._make_transition_layer", "hrnet_ocr.HighResolutionNet._make_stage", "numpy.int", "numpy.sum", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "ocr.SpatialGather_Module", "ocr.SpatialOCR_Module", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "range", "range", "range", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_transition_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_stage", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_transition_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_stage", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_transition_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_stage"], ["    ", "def", "__init__", "(", "self", ",", "width", ",", "num_classes", ",", "ocr_width", "=", "256", ",", "small", "=", "False", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "align_corners", "=", "True", ")", ":", "\n", "        ", "super", "(", "HighResolutionNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "norm_layer", "=", "norm_layer", "\n", "self", ".", "width", "=", "width", "\n", "self", ".", "ocr_width", "=", "ocr_width", "\n", "self", ".", "align_corners", "=", "align_corners", "\n", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn1", "=", "norm_layer", "(", "64", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "norm_layer", "(", "64", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", "\n", "\n", "num_blocks", "=", "2", "if", "small", "else", "4", "\n", "\n", "stage1_num_channels", "=", "64", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "BottleneckV1b", ",", "64", ",", "stage1_num_channels", ",", "blocks", "=", "num_blocks", ")", "\n", "stage1_out_channel", "=", "BottleneckV1b", ".", "expansion", "*", "stage1_num_channels", "\n", "\n", "self", ".", "stage2_num_branches", "=", "2", "\n", "num_channels", "=", "[", "width", ",", "2", "*", "width", "]", "\n", "num_inchannels", "=", "[", "\n", "num_channels", "[", "i", "]", "*", "BasicBlockV1b", ".", "expansion", "for", "i", "in", "range", "(", "len", "(", "num_channels", ")", ")", "]", "\n", "self", ".", "transition1", "=", "self", ".", "_make_transition_layer", "(", "\n", "[", "stage1_out_channel", "]", ",", "num_inchannels", ")", "\n", "self", ".", "stage2", ",", "pre_stage_channels", "=", "self", ".", "_make_stage", "(", "\n", "BasicBlockV1b", ",", "num_inchannels", "=", "num_inchannels", ",", "num_modules", "=", "1", ",", "num_branches", "=", "self", ".", "stage2_num_branches", ",", "\n", "num_blocks", "=", "2", "*", "[", "num_blocks", "]", ",", "num_channels", "=", "num_channels", ")", "\n", "\n", "self", ".", "stage3_num_branches", "=", "3", "\n", "num_channels", "=", "[", "width", ",", "2", "*", "width", ",", "4", "*", "width", "]", "\n", "num_inchannels", "=", "[", "\n", "num_channels", "[", "i", "]", "*", "BasicBlockV1b", ".", "expansion", "for", "i", "in", "range", "(", "len", "(", "num_channels", ")", ")", "]", "\n", "self", ".", "transition2", "=", "self", ".", "_make_transition_layer", "(", "\n", "pre_stage_channels", ",", "num_inchannels", ")", "\n", "self", ".", "stage3", ",", "pre_stage_channels", "=", "self", ".", "_make_stage", "(", "\n", "BasicBlockV1b", ",", "num_inchannels", "=", "num_inchannels", ",", "\n", "num_modules", "=", "3", "if", "small", "else", "4", ",", "num_branches", "=", "self", ".", "stage3_num_branches", ",", "\n", "num_blocks", "=", "3", "*", "[", "num_blocks", "]", ",", "num_channels", "=", "num_channels", ")", "\n", "\n", "self", ".", "stage4_num_branches", "=", "4", "\n", "num_channels", "=", "[", "width", ",", "2", "*", "width", ",", "4", "*", "width", ",", "8", "*", "width", "]", "\n", "num_inchannels", "=", "[", "\n", "num_channels", "[", "i", "]", "*", "BasicBlockV1b", ".", "expansion", "for", "i", "in", "range", "(", "len", "(", "num_channels", ")", ")", "]", "\n", "self", ".", "transition3", "=", "self", ".", "_make_transition_layer", "(", "\n", "pre_stage_channels", ",", "num_inchannels", ")", "\n", "self", ".", "stage4", ",", "pre_stage_channels", "=", "self", ".", "_make_stage", "(", "\n", "BasicBlockV1b", ",", "num_inchannels", "=", "num_inchannels", ",", "num_modules", "=", "2", "if", "small", "else", "3", ",", "\n", "num_branches", "=", "self", ".", "stage4_num_branches", ",", "\n", "num_blocks", "=", "4", "*", "[", "num_blocks", "]", ",", "num_channels", "=", "num_channels", ")", "\n", "\n", "last_inp_channels", "=", "np", ".", "int", "(", "np", ".", "sum", "(", "pre_stage_channels", ")", ")", "\n", "if", "self", ".", "ocr_width", ">", "0", ":", "\n", "            ", "ocr_mid_channels", "=", "2", "*", "self", ".", "ocr_width", "\n", "ocr_key_channels", "=", "self", ".", "ocr_width", "\n", "\n", "self", ".", "conv3x3_ocr", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "last_inp_channels", ",", "ocr_mid_channels", ",", "\n", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", ",", "\n", "norm_layer", "(", "ocr_mid_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", ",", "\n", ")", "\n", "self", ".", "ocr_gather_head", "=", "SpatialGather_Module", "(", "num_classes", ")", "\n", "\n", "self", ".", "ocr_distri_head", "=", "SpatialOCR_Module", "(", "in_channels", "=", "ocr_mid_channels", ",", "\n", "key_channels", "=", "ocr_key_channels", ",", "\n", "out_channels", "=", "ocr_mid_channels", ",", "\n", "scale", "=", "1", ",", "\n", "dropout", "=", "0.05", ",", "\n", "norm_layer", "=", "norm_layer", ",", "\n", "align_corners", "=", "align_corners", ")", "\n", "self", ".", "cls_head", "=", "nn", ".", "Conv2d", "(", "\n", "ocr_mid_channels", ",", "num_classes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", "\n", "\n", "self", ".", "aux_head", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "last_inp_channels", ",", "last_inp_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", ",", "\n", "norm_layer", "(", "last_inp_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", ",", "\n", "nn", ".", "Conv2d", "(", "last_inp_channels", ",", "num_classes", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", "\n", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "cls_head", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "last_inp_channels", ",", "last_inp_channels", ",", "\n", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", ",", "\n", "norm_layer", "(", "last_inp_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", ",", "\n", "nn", ".", "Conv2d", "(", "last_inp_channels", ",", "num_classes", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_transition_layer": [[249, 283], ["len", "len", "range", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "range", "transition_layers.append", "transition_layers.append", "transition_layers.append", "conv3x3s.append", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "hrnet_ocr.HighResolutionNet.norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "hrnet_ocr.HighResolutionNet.norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["None"], ["", "", "def", "_make_transition_layer", "(", "\n", "self", ",", "num_channels_pre_layer", ",", "num_channels_cur_layer", ")", ":", "\n", "        ", "num_branches_cur", "=", "len", "(", "num_channels_cur_layer", ")", "\n", "num_branches_pre", "=", "len", "(", "num_channels_pre_layer", ")", "\n", "\n", "transition_layers", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "num_branches_cur", ")", ":", "\n", "            ", "if", "i", "<", "num_branches_pre", ":", "\n", "                ", "if", "num_channels_cur_layer", "[", "i", "]", "!=", "num_channels_pre_layer", "[", "i", "]", ":", "\n", "                    ", "transition_layers", ".", "append", "(", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "num_channels_pre_layer", "[", "i", "]", ",", "\n", "num_channels_cur_layer", "[", "i", "]", ",", "\n", "kernel_size", "=", "3", ",", "\n", "stride", "=", "1", ",", "\n", "padding", "=", "1", ",", "\n", "bias", "=", "False", ")", ",", "\n", "self", ".", "norm_layer", "(", "num_channels_cur_layer", "[", "i", "]", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", ")", ")", "\n", "", "else", ":", "\n", "                    ", "transition_layers", ".", "append", "(", "None", ")", "\n", "", "", "else", ":", "\n", "                ", "conv3x3s", "=", "[", "]", "\n", "for", "j", "in", "range", "(", "i", "+", "1", "-", "num_branches_pre", ")", ":", "\n", "                    ", "inchannels", "=", "num_channels_pre_layer", "[", "-", "1", "]", "\n", "outchannels", "=", "num_channels_cur_layer", "[", "i", "]", "if", "j", "==", "i", "-", "num_branches_pre", "else", "inchannels", "\n", "conv3x3s", ".", "append", "(", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "inchannels", ",", "outchannels", ",", "\n", "kernel_size", "=", "3", ",", "stride", "=", "2", ",", "padding", "=", "1", ",", "bias", "=", "False", ")", ",", "\n", "self", ".", "norm_layer", "(", "outchannels", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "relu_inplace", ")", ")", ")", "\n", "", "transition_layers", ".", "append", "(", "nn", ".", "Sequential", "(", "*", "conv3x3s", ")", ")", "\n", "\n", "", "", "return", "nn", ".", "ModuleList", "(", "transition_layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_layer": [[284, 301], ["layers.append", "range", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "block", "layers.append", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "hrnet_ocr.HighResolutionNet.norm_layer", "block"], "methods", ["None"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "inplanes", ",", "planes", ",", "blocks", ",", "stride", "=", "1", ")", ":", "\n", "        ", "downsample", "=", "None", "\n", "if", "stride", "!=", "1", "or", "inplanes", "!=", "planes", "*", "block", ".", "expansion", ":", "\n", "            ", "downsample", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", "*", "block", ".", "expansion", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "stride", ",", "bias", "=", "False", ")", ",", "\n", "self", ".", "norm_layer", "(", "planes", "*", "block", ".", "expansion", ")", ",", "\n", ")", "\n", "\n", "", "layers", "=", "[", "]", "\n", "layers", ".", "append", "(", "block", "(", "inplanes", ",", "planes", ",", "stride", ",", "\n", "downsample", "=", "downsample", ",", "norm_layer", "=", "self", ".", "norm_layer", ")", ")", "\n", "inplanes", "=", "planes", "*", "block", ".", "expansion", "\n", "for", "i", "in", "range", "(", "1", ",", "blocks", ")", ":", "\n", "            ", "layers", ".", "append", "(", "block", "(", "inplanes", ",", "planes", ",", "norm_layer", "=", "self", ".", "norm_layer", ")", ")", "\n", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet._make_stage": [[302, 327], ["range", "modules.append", "modules[].get_num_inchannels", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "hrnet_ocr.HighResolutionModule"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionModule.get_num_inchannels"], ["", "def", "_make_stage", "(", "self", ",", "block", ",", "num_inchannels", ",", "\n", "num_modules", ",", "num_branches", ",", "num_blocks", ",", "num_channels", ",", "\n", "fuse_method", "=", "'SUM'", ",", "\n", "multi_scale_output", "=", "True", ")", ":", "\n", "        ", "modules", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "num_modules", ")", ":", "\n", "# multi_scale_output is only used last module", "\n", "            ", "if", "not", "multi_scale_output", "and", "i", "==", "num_modules", "-", "1", ":", "\n", "                ", "reset_multi_scale_output", "=", "False", "\n", "", "else", ":", "\n", "                ", "reset_multi_scale_output", "=", "True", "\n", "", "modules", ".", "append", "(", "\n", "HighResolutionModule", "(", "num_branches", ",", "\n", "block", ",", "\n", "num_blocks", ",", "\n", "num_inchannels", ",", "\n", "num_channels", ",", "\n", "fuse_method", ",", "\n", "reset_multi_scale_output", ",", "\n", "norm_layer", "=", "self", ".", "norm_layer", ",", "\n", "align_corners", "=", "self", ".", "align_corners", ")", "\n", ")", "\n", "num_inchannels", "=", "modules", "[", "-", "1", "]", ".", "get_num_inchannels", "(", ")", "\n", "\n", "", "return", "nn", ".", "Sequential", "(", "*", "modules", ")", ",", "num_inchannels", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.forward": [[328, 340], ["hrnet_ocr.HighResolutionNet.compute_hrnet_feats", "hrnet_ocr.HighResolutionNet.aux_head", "hrnet_ocr.HighResolutionNet.conv3x3_ocr", "hrnet_ocr.HighResolutionNet.ocr_gather_head", "hrnet_ocr.HighResolutionNet.ocr_distri_head", "hrnet_ocr.HighResolutionNet.cls_head", "hrnet_ocr.HighResolutionNet.cls_head"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.compute_hrnet_feats"], ["", "def", "forward", "(", "self", ",", "x", ",", "additional_features", "=", "None", ")", ":", "\n", "        ", "feats", "=", "self", ".", "compute_hrnet_feats", "(", "x", ",", "additional_features", ")", "\n", "if", "self", ".", "ocr_width", ">", "0", ":", "\n", "            ", "out_aux", "=", "self", ".", "aux_head", "(", "feats", ")", "\n", "feats", "=", "self", ".", "conv3x3_ocr", "(", "feats", ")", "\n", "\n", "context", "=", "self", ".", "ocr_gather_head", "(", "feats", ",", "out_aux", ")", "\n", "feats", "=", "self", ".", "ocr_distri_head", "(", "feats", ",", "context", ")", "\n", "out", "=", "self", ".", "cls_head", "(", "feats", ")", "\n", "return", "[", "out", ",", "out_aux", ",", "feats", "]", "\n", "", "else", ":", "\n", "            ", "return", "[", "self", ".", "cls_head", "(", "feats", ")", ",", "None", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.compute_hrnet_feats": [[341, 376], ["hrnet_ocr.HighResolutionNet.compute_pre_stage_features", "hrnet_ocr.HighResolutionNet.layer1", "range", "hrnet_ocr.HighResolutionNet.stage2", "range", "hrnet_ocr.HighResolutionNet.stage3", "range", "hrnet_ocr.HighResolutionNet.stage4", "hrnet_ocr.HighResolutionNet.aggregate_hrnet_features", "x_list.append", "x_list.append", "x_list.append", "x_list.append", "x_list.append", "x_list.append", "x_list.append", "x_list.append"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.compute_pre_stage_features", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.aggregate_hrnet_features"], ["", "", "def", "compute_hrnet_feats", "(", "self", ",", "x", ",", "additional_features", ")", ":", "\n", "        ", "x", "=", "self", ".", "compute_pre_stage_features", "(", "x", ",", "additional_features", ")", "\n", "x", "=", "self", ".", "layer1", "(", "x", ")", "\n", "\n", "x_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "self", ".", "stage2_num_branches", ")", ":", "\n", "            ", "if", "self", ".", "transition1", "[", "i", "]", "is", "not", "None", ":", "\n", "                ", "x_list", ".", "append", "(", "self", ".", "transition1", "[", "i", "]", "(", "x", ")", ")", "\n", "", "else", ":", "\n", "                ", "x_list", ".", "append", "(", "x", ")", "\n", "", "", "y_list", "=", "self", ".", "stage2", "(", "x_list", ")", "\n", "\n", "x_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "self", ".", "stage3_num_branches", ")", ":", "\n", "            ", "if", "self", ".", "transition2", "[", "i", "]", "is", "not", "None", ":", "\n", "                ", "if", "i", "<", "self", ".", "stage2_num_branches", ":", "\n", "                    ", "x_list", ".", "append", "(", "self", ".", "transition2", "[", "i", "]", "(", "y_list", "[", "i", "]", ")", ")", "\n", "", "else", ":", "\n", "                    ", "x_list", ".", "append", "(", "self", ".", "transition2", "[", "i", "]", "(", "y_list", "[", "-", "1", "]", ")", ")", "\n", "", "", "else", ":", "\n", "                ", "x_list", ".", "append", "(", "y_list", "[", "i", "]", ")", "\n", "", "", "y_list", "=", "self", ".", "stage3", "(", "x_list", ")", "\n", "\n", "x_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "self", ".", "stage4_num_branches", ")", ":", "\n", "            ", "if", "self", ".", "transition3", "[", "i", "]", "is", "not", "None", ":", "\n", "                ", "if", "i", "<", "self", ".", "stage3_num_branches", ":", "\n", "                    ", "x_list", ".", "append", "(", "self", ".", "transition3", "[", "i", "]", "(", "y_list", "[", "i", "]", ")", ")", "\n", "", "else", ":", "\n", "                    ", "x_list", ".", "append", "(", "self", ".", "transition3", "[", "i", "]", "(", "y_list", "[", "-", "1", "]", ")", ")", "\n", "", "", "else", ":", "\n", "                ", "x_list", ".", "append", "(", "y_list", "[", "i", "]", ")", "\n", "", "", "x", "=", "self", ".", "stage4", "(", "x_list", ")", "\n", "\n", "return", "self", ".", "aggregate_hrnet_features", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.compute_pre_stage_features": [[377, 386], ["hrnet_ocr.HighResolutionNet.conv1", "hrnet_ocr.HighResolutionNet.bn1", "hrnet_ocr.HighResolutionNet.relu", "hrnet_ocr.HighResolutionNet.conv2", "hrnet_ocr.HighResolutionNet.bn2", "hrnet_ocr.HighResolutionNet.relu"], "methods", ["None"], ["", "def", "compute_pre_stage_features", "(", "self", ",", "x", ",", "additional_features", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x", "=", "self", ".", "bn1", "(", "x", ")", "\n", "x", "=", "self", ".", "relu", "(", "x", ")", "\n", "if", "additional_features", "is", "not", "None", ":", "\n", "            ", "x", "=", "x", "+", "additional_features", "\n", "", "x", "=", "self", ".", "conv2", "(", "x", ")", "\n", "x", "=", "self", ".", "bn2", "(", "x", ")", "\n", "return", "self", ".", "relu", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.aggregate_hrnet_features": [[387, 398], ["torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "x[].size", "x[].size"], "methods", ["None"], ["", "def", "aggregate_hrnet_features", "(", "self", ",", "x", ")", ":", "\n", "# Upsampling", "\n", "        ", "x0_h", ",", "x0_w", "=", "x", "[", "0", "]", ".", "size", "(", "2", ")", ",", "x", "[", "0", "]", ".", "size", "(", "3", ")", "\n", "x1", "=", "F", ".", "interpolate", "(", "x", "[", "1", "]", ",", "size", "=", "(", "x0_h", ",", "x0_w", ")", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "self", ".", "align_corners", ")", "\n", "x2", "=", "F", ".", "interpolate", "(", "x", "[", "2", "]", ",", "size", "=", "(", "x0_h", ",", "x0_w", ")", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "self", ".", "align_corners", ")", "\n", "x3", "=", "F", ".", "interpolate", "(", "x", "[", "3", "]", ",", "size", "=", "(", "x0_h", ",", "x0_w", ")", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "self", ".", "align_corners", ")", "\n", "\n", "return", "torch", ".", "cat", "(", "[", "x", "[", "0", "]", ",", "x1", ",", "x2", ",", "x3", "]", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.load_pretrained_weights": [[399, 417], ["hrnet_ocr.HighResolutionNet.state_dict", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "hrnet_ocr.HighResolutionNet.update", "hrnet_ocr.HighResolutionNet.load_state_dict", "os.path.exists", "print", "print", "exit", "k.replace().replace", "torch.load.items", "torch.load.items", "torch.load.items", "torch.load.items", "torch.load.items", "torch.load.items", "torch.load.items", "torch.load.items", "k.replace", "hrnet_ocr.HighResolutionNet.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_pretrained_weights", "(", "self", ",", "pretrained_path", "=", "''", ")", ":", "\n", "        ", "model_dict", "=", "self", ".", "state_dict", "(", ")", "\n", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "pretrained_path", ")", ":", "\n", "            ", "print", "(", "f'\\nFile \"{pretrained_path}\" does not exist.'", ")", "\n", "print", "(", "'You need to specify the correct path to the pre-trained weights.\\n'", "\n", "'You can download the weights for HRNet from the repository:\\n'", "\n", "'https://github.com/HRNet/HRNet-Image-Classification'", ")", "\n", "exit", "(", "1", ")", "\n", "", "pretrained_dict", "=", "torch", ".", "load", "(", "pretrained_path", ",", "map_location", "=", "{", "'cuda:0'", ":", "'cpu'", "}", ")", "\n", "pretrained_dict", "=", "{", "k", ".", "replace", "(", "'last_layer'", ",", "'aux_head'", ")", ".", "replace", "(", "'model.'", ",", "''", ")", ":", "v", "for", "k", ",", "v", "in", "\n", "pretrained_dict", ".", "items", "(", ")", "}", "\n", "\n", "pretrained_dict", "=", "{", "k", ":", "v", "for", "k", ",", "v", "in", "pretrained_dict", ".", "items", "(", ")", "\n", "if", "k", "in", "model_dict", ".", "keys", "(", ")", "}", "\n", "\n", "model_dict", ".", "update", "(", "pretrained_dict", ")", "\n", "self", ".", "load_state_dict", "(", "model_dict", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnet.ResNetBackbone.__init__": [[6, 30], ["super().__init__", "resnetv1b.resnet18_v1b", "resnetv1b.resnet34_v1b", "resnetv1b.resnet50_v1s", "resnetv1b.resnet101_v1s", "resnetv1b.resnet152_v1s", "RuntimeError"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet18_v1b", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet34_v1b", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet50_v1s", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet101_v1s", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnetv1b.resnet152_v1s"], ["    ", "def", "__init__", "(", "self", ",", "backbone", "=", "'resnet50'", ",", "pretrained_base", "=", "True", ",", "dilated", "=", "True", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "ResNetBackbone", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "if", "backbone", "==", "'resnet18'", ":", "\n", "            ", "pretrained", "=", "resnet18_v1b", "(", "pretrained", "=", "pretrained_base", ",", "dilated", "=", "dilated", ",", "**", "kwargs", ")", "\n", "", "elif", "backbone", "==", "'resnet34'", ":", "\n", "            ", "pretrained", "=", "resnet34_v1b", "(", "pretrained", "=", "pretrained_base", ",", "dilated", "=", "dilated", ",", "**", "kwargs", ")", "\n", "", "elif", "backbone", "==", "'resnet50'", ":", "\n", "            ", "pretrained", "=", "resnet50_v1s", "(", "pretrained", "=", "pretrained_base", ",", "dilated", "=", "dilated", ",", "**", "kwargs", ")", "\n", "", "elif", "backbone", "==", "'resnet101'", ":", "\n", "            ", "pretrained", "=", "resnet101_v1s", "(", "pretrained", "=", "pretrained_base", ",", "dilated", "=", "dilated", ",", "**", "kwargs", ")", "\n", "", "elif", "backbone", "==", "'resnet152'", ":", "\n", "            ", "pretrained", "=", "resnet152_v1s", "(", "pretrained", "=", "pretrained_base", ",", "dilated", "=", "dilated", ",", "**", "kwargs", ")", "\n", "", "else", ":", "\n", "            ", "raise", "RuntimeError", "(", "f'unknown backbone: {backbone}'", ")", "\n", "\n", "", "self", ".", "conv1", "=", "pretrained", ".", "conv1", "\n", "self", ".", "bn1", "=", "pretrained", ".", "bn1", "\n", "self", ".", "relu", "=", "pretrained", ".", "relu", "\n", "self", ".", "maxpool", "=", "pretrained", ".", "maxpool", "\n", "self", ".", "layer1", "=", "pretrained", ".", "layer1", "\n", "self", ".", "layer2", "=", "pretrained", ".", "layer2", "\n", "self", ".", "layer3", "=", "pretrained", ".", "layer3", "\n", "self", ".", "layer4", "=", "pretrained", ".", "layer4", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.resnet.ResNetBackbone.forward": [[31, 46], ["resnet.ResNetBackbone.conv1", "resnet.ResNetBackbone.bn1", "resnet.ResNetBackbone.relu", "resnet.ResNetBackbone.maxpool", "resnet.ResNetBackbone.layer1", "resnet.ResNetBackbone.layer2", "resnet.ResNetBackbone.layer3", "resnet.ResNetBackbone.layer4", "torch.nn.functional.pad", "resnet.ResNetBackbone.size", "additional_features.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "additional_features", "=", "None", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x", "=", "self", ".", "bn1", "(", "x", ")", "\n", "x", "=", "self", ".", "relu", "(", "x", ")", "\n", "if", "additional_features", "is", "not", "None", ":", "\n", "            ", "x", "=", "x", "+", "torch", ".", "nn", ".", "functional", ".", "pad", "(", "additional_features", ",", "\n", "[", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "x", ".", "size", "(", "1", ")", "-", "additional_features", ".", "size", "(", "1", ")", "]", ",", "\n", "mode", "=", "'constant'", ",", "value", "=", "0", ")", "\n", "", "x", "=", "self", ".", "maxpool", "(", "x", ")", "\n", "c1", "=", "self", ".", "layer1", "(", "x", ")", "\n", "c2", "=", "self", ".", "layer2", "(", "c1", ")", "\n", "c3", "=", "self", ".", "layer3", "(", "c2", ")", "\n", "c4", "=", "self", ".", "layer4", "(", "c3", ")", "\n", "\n", "return", "c1", ",", "c2", ",", "c3", ",", "c4", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.ocr.SpatialGather_Module.__init__": [[14, 18], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "cls_num", "=", "0", ",", "scale", "=", "1", ")", ":", "\n", "        ", "super", "(", "SpatialGather_Module", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "cls_num", "=", "cls_num", "\n", "self", ".", "scale", "=", "scale", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.ocr.SpatialGather_Module.forward": [[19, 28], ["torch.softmax.view", "feats.permute.permute.view", "feats.permute.permute.permute", "torch.softmax", "torch.softmax", "torch.softmax", "torch.softmax", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.matmul().permute().unsqueeze", "torch.softmax.size", "torch.softmax.size", "torch.softmax.size", "torch.softmax.size", "feats.permute.permute.size", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul().permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "feats", ",", "probs", ")", ":", "\n", "        ", "batch_size", ",", "c", ",", "h", ",", "w", "=", "probs", ".", "size", "(", "0", ")", ",", "probs", ".", "size", "(", "1", ")", ",", "probs", ".", "size", "(", "2", ")", ",", "probs", ".", "size", "(", "3", ")", "\n", "probs", "=", "probs", ".", "view", "(", "batch_size", ",", "c", ",", "-", "1", ")", "\n", "feats", "=", "feats", ".", "view", "(", "batch_size", ",", "feats", ".", "size", "(", "1", ")", ",", "-", "1", ")", "\n", "feats", "=", "feats", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "# batch x hw x c", "\n", "probs", "=", "F", ".", "softmax", "(", "self", ".", "scale", "*", "probs", ",", "dim", "=", "2", ")", "# batch x k x hw", "\n", "ocr_context", "=", "torch", ".", "matmul", "(", "probs", ",", "feats", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "unsqueeze", "(", "3", ")", "# batch x k x c", "\n", "return", "ocr_context", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.ocr.SpatialOCR_Module.__init__": [[36, 53], ["torch.Module.__init__", "ocr.ObjectAttentionBlock2D", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Dropout2d", "torch.Dropout2d", "torch.Dropout2d", "torch.Dropout2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "\n", "in_channels", ",", "\n", "key_channels", ",", "\n", "out_channels", ",", "\n", "scale", "=", "1", ",", "\n", "dropout", "=", "0.1", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "\n", "align_corners", "=", "True", ")", ":", "\n", "        ", "super", "(", "SpatialOCR_Module", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "object_context_block", "=", "ObjectAttentionBlock2D", "(", "in_channels", ",", "key_channels", ",", "scale", ",", "\n", "norm_layer", ",", "align_corners", ")", "\n", "_in_channels", "=", "2", "*", "in_channels", "\n", "\n", "self", ".", "conv_bn_dropout", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "_in_channels", ",", "out_channels", ",", "kernel_size", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sequential", "(", "norm_layer", "(", "out_channels", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", ",", "\n", "nn", ".", "Dropout2d", "(", "dropout", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.ocr.SpatialOCR_Module.forward": [[55, 61], ["ocr.SpatialOCR_Module.object_context_block", "ocr.SpatialOCR_Module.conv_bn_dropout", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "feats", ",", "proxy_feats", ")", ":", "\n", "        ", "context", "=", "self", ".", "object_context_block", "(", "feats", ",", "proxy_feats", ")", "\n", "\n", "output", "=", "self", ".", "conv_bn_dropout", "(", "torch", ".", "cat", "(", "[", "context", ",", "feats", "]", ",", "1", ")", ")", "\n", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.ocr.ObjectAttentionBlock2D.__init__": [[77, 115], ["torch.Module.__init__", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "\n", "in_channels", ",", "\n", "key_channels", ",", "\n", "scale", "=", "1", ",", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "\n", "align_corners", "=", "True", ")", ":", "\n", "        ", "super", "(", "ObjectAttentionBlock2D", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "scale", "=", "scale", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "key_channels", "=", "key_channels", "\n", "self", ".", "align_corners", "=", "align_corners", "\n", "\n", "self", ".", "pool", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "(", "scale", ",", "scale", ")", ")", "\n", "self", ".", "f_pixel", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "key_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sequential", "(", "norm_layer", "(", "self", ".", "key_channels", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "key_channels", ",", "out_channels", "=", "self", ".", "key_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sequential", "(", "norm_layer", "(", "self", ".", "key_channels", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", ")", "\n", "self", ".", "f_object", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "key_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sequential", "(", "norm_layer", "(", "self", ".", "key_channels", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "key_channels", ",", "out_channels", "=", "self", ".", "key_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sequential", "(", "norm_layer", "(", "self", ".", "key_channels", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", ")", "\n", "self", ".", "f_down", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "key_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sequential", "(", "norm_layer", "(", "self", ".", "key_channels", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", ")", "\n", "self", ".", "f_up", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "key_channels", ",", "out_channels", "=", "self", ".", "in_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sequential", "(", "norm_layer", "(", "self", ".", "in_channels", ")", ",", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.ocr.ObjectAttentionBlock2D.forward": [[117, 142], ["ocr.ObjectAttentionBlock2D.f_pixel().view", "query.permute.permute.permute", "ocr.ObjectAttentionBlock2D.f_object().view", "ocr.ObjectAttentionBlock2D.f_down().view", "value.permute.permute.permute", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.softmax", "torch.softmax", "torch.softmax", "torch.softmax", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.interpolate.permute().contiguous", "torch.interpolate.view", "ocr.ObjectAttentionBlock2D.f_up", "ocr.ObjectAttentionBlock2D.size", "ocr.ObjectAttentionBlock2D.size", "ocr.ObjectAttentionBlock2D.size", "ocr.ObjectAttentionBlock2D.pool", "torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "ocr.ObjectAttentionBlock2D.f_pixel", "ocr.ObjectAttentionBlock2D.f_object", "ocr.ObjectAttentionBlock2D.f_down", "torch.interpolate.permute", "ocr.ObjectAttentionBlock2D.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "proxy", ")", ":", "\n", "        ", "batch_size", ",", "h", ",", "w", "=", "x", ".", "size", "(", "0", ")", ",", "x", ".", "size", "(", "2", ")", ",", "x", ".", "size", "(", "3", ")", "\n", "if", "self", ".", "scale", ">", "1", ":", "\n", "            ", "x", "=", "self", ".", "pool", "(", "x", ")", "\n", "\n", "", "query", "=", "self", ".", "f_pixel", "(", "x", ")", ".", "view", "(", "batch_size", ",", "self", ".", "key_channels", ",", "-", "1", ")", "\n", "query", "=", "query", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "key", "=", "self", ".", "f_object", "(", "proxy", ")", ".", "view", "(", "batch_size", ",", "self", ".", "key_channels", ",", "-", "1", ")", "\n", "value", "=", "self", ".", "f_down", "(", "proxy", ")", ".", "view", "(", "batch_size", ",", "self", ".", "key_channels", ",", "-", "1", ")", "\n", "value", "=", "value", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "\n", "sim_map", "=", "torch", ".", "matmul", "(", "query", ",", "key", ")", "\n", "sim_map", "=", "(", "self", ".", "key_channels", "**", "-", ".5", ")", "*", "sim_map", "\n", "sim_map", "=", "F", ".", "softmax", "(", "sim_map", ",", "dim", "=", "-", "1", ")", "\n", "\n", "# add bg context ...", "\n", "context", "=", "torch", ".", "matmul", "(", "sim_map", ",", "value", ")", "\n", "context", "=", "context", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "contiguous", "(", ")", "\n", "context", "=", "context", ".", "view", "(", "batch_size", ",", "self", ".", "key_channels", ",", "*", "x", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "context", "=", "self", ".", "f_up", "(", "context", ")", "\n", "if", "self", ".", "scale", ">", "1", ":", "\n", "            ", "context", "=", "F", ".", "interpolate", "(", "input", "=", "context", ",", "size", "=", "(", "h", ",", "w", ")", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "self", ".", "align_corners", ")", "\n", "\n", "", "return", "context", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.segmentator.LRASPP.__init__": [[14, 25], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "LRASPP", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "b0", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", "True", ")", "\n", ")", "\n", "self", ".", "b1", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "(", "2", ",", "2", ")", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.segmentator.LRASPP.forward": [[27, 34], ["segmentator.LRASPP.b0", "segmentator.LRASPP.b1", "torch.interpolate", "torch.interpolate", "torch.interpolate", "x.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "size", "=", "x", ".", "size", "(", ")", "[", "2", ":", "]", "\n", "feat1", "=", "self", ".", "b0", "(", "x", ")", "\n", "feat2", "=", "self", ".", "b1", "(", "x", ")", "\n", "feat2", "=", "F", ".", "interpolate", "(", "feat2", ",", "size", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x", "=", "feat1", "*", "feat2", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.segmentator.EfficientSeg.__init__": [[38, 46], ["torch.Module.__init__", "isegm.model.modeling.efficientnet.backbone.efficientnet_b0", "segmentator.LRASPP", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b0"], ["    ", "def", "__init__", "(", "self", ",", "nclass", "=", "1", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "EfficientSeg", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "backbone", "=", "efficientnet_b0", "(", ")", "\n", "self", ".", "lraspp", "=", "LRASPP", "(", "320", ",", "128", ")", "\n", "self", ".", "fusion_conv1", "=", "nn", ".", "Conv2d", "(", "128", ",", "16", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "fusion_conv2", "=", "nn", ".", "Conv2d", "(", "24", ",", "16", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "head", "=", "nn", ".", "Conv2d", "(", "16", ",", "nclass", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "aux_head", "=", "nn", ".", "Conv2d", "(", "16", ",", "nclass", ",", "1", ",", "1", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.segmentator.EfficientSeg.forward": [[47, 58], ["segmentator.EfficientSeg.backbone", "segmentator.EfficientSeg.lraspp", "torch.interpolate", "torch.interpolate", "torch.interpolate", "segmentator.EfficientSeg.fusion_conv1", "segmentator.EfficientSeg.aux_head", "segmentator.EfficientSeg.fusion_conv2", "segmentator.EfficientSeg.head", "segmentator.EfficientSeg.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "side_feature", ")", ":", "\n", "        ", "x4", ",", "_", ",", "_", ",", "x8", "=", "self", ".", "backbone", "(", "x", ",", "side_feature", ")", "\n", "x8", "=", "self", ".", "lraspp", "(", "x8", ")", "\n", "x8", "=", "F", ".", "interpolate", "(", "x8", ",", "x4", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x8", "=", "self", ".", "fusion_conv1", "(", "x8", ")", "\n", "pred_aux", "=", "self", ".", "aux_head", "(", "x8", ")", "\n", "\n", "x4", "=", "self", ".", "fusion_conv2", "(", "x4", ")", "\n", "x", "=", "x4", "+", "x8", "\n", "pred", "=", "self", ".", "head", "(", "x", ")", "\n", "return", "pred", ",", "pred_aux", ",", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.segmentator.EfficientSeg.load_pretrained_weights": [[59, 71], ["segmentator.EfficientSeg.backbone.state_dict", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "set", "set", "print", "print", "print", "segmentator.EfficientSeg.update", "segmentator.EfficientSeg.backbone.load_state_dict", "torch.load.keys", "torch.load.keys", "torch.load.keys", "segmentator.EfficientSeg.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_pretrained_weights", "(", "self", ",", "path_to_weights", "=", "' '", ")", ":", "\n", "        ", "backbone_state_dict", "=", "self", ".", "backbone", ".", "state_dict", "(", ")", "\n", "pretrained_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "\n", "ckpt_keys", "=", "set", "(", "pretrained_state_dict", ".", "keys", "(", ")", ")", "\n", "own_keys", "=", "set", "(", "backbone_state_dict", ".", "keys", "(", ")", ")", "\n", "missing_keys", "=", "own_keys", "-", "ckpt_keys", "\n", "unexpected_keys", "=", "ckpt_keys", "-", "own_keys", "\n", "print", "(", "'Loading Efficientnet'", ")", "\n", "print", "(", "'Missing Keys: '", ",", "missing_keys", ")", "\n", "print", "(", "'Unexpected Keys: '", ",", "unexpected_keys", ")", "\n", "backbone_state_dict", ".", "update", "(", "pretrained_state_dict", ")", "\n", "self", ".", "backbone", ".", "load_state_dict", "(", "backbone_state_dict", ",", "strict", "=", "False", ")", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone._Swish.__init__": [[13, 16], ["torch.Module.__init__", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "_Swish", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "sigmoid", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone._Swish.forward": [[17, 19], ["backbone._Swish.sigmoid"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "*", "self", ".", "sigmoid", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone._Hswish.__init__": [[21, 24], ["torch.Module.__init__", "torch.ReLU6"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "inplace", "=", "True", ")", ":", "\n", "        ", "super", "(", "_Hswish", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "relu6", "=", "nn", ".", "ReLU6", "(", "inplace", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone._Hswish.forward": [[25, 27], ["backbone._Hswish.relu6"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "*", "self", ".", "relu6", "(", "x", "+", "3.", ")", "/", "6.", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.SEModuleV2.__init__": [[30, 39], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "max", "torch.Sequential", "int", "torch.Conv2d", "backbone._Swish", "torch.Conv2d", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "se_ratio", "=", "0.25", ")", ":", "\n", "        ", "super", "(", "SEModuleV2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "se_channels", "=", "max", "(", "1", ",", "int", "(", "in_channels", "*", "se_ratio", ")", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "se_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "_Swish", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "se_channels", ",", "in_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.SEModuleV2.forward": [[41, 46], ["x.size", "backbone.SEModuleV2.avg_pool", "backbone.SEModuleV2.fc", "backbone.SEModuleV2.expand_as"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "n", ",", "c", ",", "_", ",", "_", "=", "x", ".", "size", "(", ")", "\n", "out", "=", "self", ".", "avg_pool", "(", "x", ")", "\n", "out", "=", "self", ".", "fc", "(", "out", ")", "\n", "return", "x", "*", "out", ".", "expand_as", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.MBConvBlock.__init__": [[49, 78], ["torch.Module.__init__", "list", "int", "list.extend", "torch.Sequential", "round", "list.append", "torch.Dropout2d", "backbone._ConvBNHswish", "backbone._ConvBNHswish", "SELayer", "torch.Conv2d", "norm_layer"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "expand_ratio", ",", "\n", "dilation", "=", "1", ",", "se_ratio", "=", "0.25", ",", "drop_connect_rate", "=", "0.2", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "MBConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "assert", "stride", "in", "[", "1", ",", "2", "]", "\n", "self", ".", "use_res_connect", "=", "stride", "==", "1", "and", "in_channels", "==", "out_channels", "\n", "self", ".", "drop_connect_rate", "=", "drop_connect_rate", "\n", "use_se", "=", "(", "se_ratio", "is", "not", "None", ")", "and", "(", "0", "<", "se_ratio", "<=", "1.", ")", "\n", "if", "use_se", ":", "\n", "            ", "SELayer", "=", "SEModuleV2", "\n", "", "else", ":", "\n", "            ", "SELayer", "=", "Identity", "\n", "\n", "", "layers", "=", "list", "(", ")", "\n", "inter_channels", "=", "int", "(", "round", "(", "in_channels", "*", "expand_ratio", ")", ")", "\n", "if", "expand_ratio", "!=", "1", ":", "\n", "            ", "layers", ".", "append", "(", "_ConvBNHswish", "(", "in_channels", ",", "inter_channels", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "", "layers", ".", "extend", "(", "[", "\n", "# dw", "\n", "_ConvBNHswish", "(", "inter_channels", ",", "inter_channels", ",", "kernel_size", ",", "stride", ",", "kernel_size", "//", "2", "*", "dilation", ",", "dilation", ",", "\n", "groups", "=", "inter_channels", ",", "norm_layer", "=", "norm_layer", ")", ",", "# check act function", "\n", "SELayer", "(", "inter_channels", ",", "se_ratio", ")", ",", "\n", "# pw-linear", "\n", "nn", ".", "Conv2d", "(", "inter_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", "\n", "]", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n", "if", "drop_connect_rate", ":", "\n", "            ", "self", ".", "dropout", "=", "nn", ".", "Dropout2d", "(", "drop_connect_rate", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.MBConvBlock.forward": [[79, 86], ["backbone.MBConvBlock.conv", "backbone.MBConvBlock.dropout"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv", "(", "x", ")", "\n", "if", "self", ".", "use_res_connect", ":", "\n", "            ", "if", "self", ".", "drop_connect_rate", ":", "\n", "                ", "out", "=", "self", ".", "dropout", "(", "out", ")", "\n", "", "out", "=", "x", "+", "out", "\n", "", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone._ConvBNHswish.__init__": [[88, 94], ["torch.Module.__init__", "torch.Conv2d", "norm_layer", "backbone._Hswish"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "\n", "dilation", "=", "1", ",", "groups", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "_ConvBNHswish", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "padding", ",", "dilation", ",", "groups", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "norm_layer", "(", "out_channels", ")", "\n", "self", ".", "act", "=", "_Hswish", "(", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone._ConvBNHswish.forward": [[95, 100], ["backbone._ConvBNHswish.conv", "backbone._ConvBNHswish.bn", "backbone._ConvBNHswish.act"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv", "(", "x", ")", "\n", "x", "=", "self", ".", "bn", "(", "x", ")", "\n", "x", "=", "self", ".", "act", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.EfficientNet.__init__": [[103, 154], ["torch.Module.__init__", "backbone.EfficientNet.round_filter", "backbone._ConvBNHswish", "backbone.EfficientNet._make_layer", "backbone.EfficientNet._make_layer", "backbone.EfficientNet._make_layer", "backbone.EfficientNet._make_layer", "backbone.EfficientNet._make_layer", "backbone.EfficientNet._make_layer", "backbone.EfficientNet._make_layer", "backbone.EfficientNet._make_layer"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.EfficientNet.round_filter", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "width_coe", ",", "depth_coe", ",", "depth_divisor", "=", "8", ",", "min_depth", "=", "None", ",", "dropout_rate", "=", "0.2", ",", "\n", "drop_connect_rate", "=", "0.2", ",", "num_classes", "=", "1000", ",", "dilated", "=", "True", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "EfficientNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "width_coe", "=", "width_coe", "\n", "self", ".", "depth_coe", "=", "depth_coe", "\n", "self", ".", "depth_divisor", "=", "depth_divisor", "\n", "self", ".", "min_depth", "=", "min_depth", "\n", "self", ".", "dropout_rate", "=", "dropout_rate", "\n", "self", ".", "drop_connect_rate", "=", "drop_connect_rate", "# not use", "\n", "\n", "layer1_setting", "=", "[", "\n", "# k, c, n, s, t", "\n", "[", "3", ",", "16", ",", "1", ",", "1", ",", "1", "]", "]", "\n", "layer2_setting", "=", "[", "\n", "[", "3", ",", "24", ",", "2", ",", "2", ",", "6", "]", "]", "#4", "\n", "layer3_setting", "=", "[", "\n", "[", "5", ",", "40", ",", "2", ",", "2", ",", "6", "]", ",", "\n", "[", "3", ",", "80", ",", "3", ",", "1", ",", "6", "]", "]", "#8", "\n", "layer4_setting", "=", "[", "\n", "[", "5", ",", "112", ",", "3", ",", "2", ",", "6", "]", "]", "\n", "layer5_setting", "=", "[", "\n", "[", "5", ",", "192", ",", "4", ",", "2", ",", "6", "]", "]", "\n", "layer6_setting", "=", "[", "\n", "[", "3", ",", "320", ",", "1", ",", "1", ",", "6", "]", "]", "\n", "\n", "# building first layer", "\n", "self", ".", "in_channels", "=", "self", ".", "round_filter", "(", "32", ",", "width_coe", ",", "depth_divisor", ",", "min_depth", ")", "\n", "self", ".", "conv1", "=", "_ConvBNHswish", "(", "3", ",", "self", ".", "in_channels", ",", "3", ",", "2", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", "# diff from origin", "\n", "\n", "# building MBConvBlocks", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer1_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer2", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer2_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer3_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "if", "dilated", ":", "\n", "            ", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer4_setting", ",", "2", ",", "norm_layer", ")", "\n", "self", ".", "layer5", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer5_setting", ",", "2", ",", "norm_layer", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer4_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer5", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer5_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "", "self", ".", "layer6", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer6_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "\n", "'''\n        # building last several layers\n        last_channels = self.round_filter(1280, width_coe, depth_divisor, min_depth)\n        \n        self.classifier = nn.Sequential(\n            _ConvBNHswish(self.in_channels, last_channels, 1, norm_layer=norm_layer),\n            nn.AdaptiveAvgPool2d(1),\n            nn.Dropout2d(self.dropout_rate),\n            nn.Conv2d(last_channels, num_classes, 1))\n        '''", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.EfficientNet._make_layer": [[155, 167], ["list", "torch.Sequential", "backbone.EfficientNet.round_filter", "list.append", "range", "block", "list.append", "block"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.EfficientNet.round_filter"], ["", "def", "_make_layer", "(", "self", ",", "block", ",", "block_setting", ",", "dilation", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "layers", "=", "list", "(", ")", "\n", "\n", "for", "k", ",", "c", ",", "n", ",", "s", ",", "t", "in", "block_setting", ":", "\n", "            ", "out_channels", "=", "self", ".", "round_filter", "(", "c", ",", "self", ".", "width_coe", ",", "self", ".", "depth_divisor", ",", "self", ".", "min_depth", ")", "\n", "stride", "=", "s", "if", "dilation", "==", "1", "else", "1", "\n", "layers", ".", "append", "(", "block", "(", "self", ".", "in_channels", ",", "out_channels", ",", "k", ",", "stride", ",", "t", ",", "dilation", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "self", ".", "in_channels", "=", "out_channels", "\n", "for", "i", "in", "range", "(", "n", "-", "1", ")", ":", "\n", "                ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_channels", ",", "out_channels", ",", "k", ",", "1", ",", "t", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "self", ".", "in_channels", "=", "out_channels", "\n", "", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.EfficientNet.round_filter": [[168, 178], ["max", "int", "int"], "methods", ["None"], ["", "@", "classmethod", "\n", "def", "round_filter", "(", "cls", ",", "filters", ",", "width_coe", ",", "depth_divisor", ",", "min_depth", ")", ":", "\n", "        ", "if", "not", "width_coe", ":", "\n", "            ", "return", "filters", "\n", "", "filters", "*=", "width_coe", "\n", "min_depth", "=", "min_depth", "or", "depth_divisor", "\n", "new_filter", "=", "max", "(", "min_depth", ",", "int", "(", "filters", "+", "depth_divisor", "/", "2", ")", "//", "depth_divisor", "*", "depth_divisor", ")", "\n", "if", "new_filter", "<", "0.9", "*", "filters", ":", "# prevent rounding by more than 10%", "\n", "            ", "new_filter", "+=", "depth_divisor", "\n", "", "return", "int", "(", "new_filter", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.EfficientNet.forward": [[179, 191], ["backbone.EfficientNet.conv1", "backbone.EfficientNet.layer1", "backbone.EfficientNet.layer2", "backbone.EfficientNet.layer3", "backbone.EfficientNet.layer4", "backbone.EfficientNet.layer5", "backbone.EfficientNet.layer6"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "side_feature", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x", "=", "x", "+", "side_feature", "\n", "x", "=", "self", ".", "layer1", "(", "x", ")", "\n", "x", "=", "self", ".", "layer2", "(", "x", ")", "\n", "x4", "=", "x", "\n", "x", "=", "self", ".", "layer3", "(", "x", ")", "\n", "x", "=", "self", ".", "layer4", "(", "x", ")", "\n", "x", "=", "self", ".", "layer5", "(", "x", ")", "\n", "x", "=", "self", ".", "layer6", "(", "x", ")", "\n", "x8", "=", "x", "\n", "return", "x4", ",", "x8", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet": [[193, 199], ["backbone.EfficientNet", "ValueError"], "function", ["None"], ["", "", "def", "get_efficientnet", "(", "params", ",", "pretrained", "=", "False", ",", "root", "=", "'~/,torch/models'", ",", "**", "kwargs", ")", ":", "\n", "    ", "w", ",", "d", ",", "_", ",", "p", "=", "params", "\n", "model", "=", "EfficientNet", "(", "w", ",", "d", ",", "dropout_rate", "=", "p", ",", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "raise", "ValueError", "(", "\"Not support pretrained\"", ")", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b0": [[201, 203], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b0", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.0", ",", "1.0", ",", "224", ",", "0.2", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b1": [[205, 207], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b1", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.0", ",", "1.1", ",", "240", ",", "0.2", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b2": [[209, 211], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b2", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.1", ",", "1.2", ",", "260", ",", "0.3", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b3": [[213, 215], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b3", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.2", ",", "1.4", ",", "300", ",", "0.3", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b4": [[217, 219], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b4", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.4", ",", "1.8", ",", "380", ",", "0.4", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b5": [[221, 223], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b5", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.6", ",", "2.2", ",", "456", ",", "0.4", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b6": [[225, 227], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b6", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.8", ",", "2.6", ",", "528", ",", "0.5", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.efficientnet_b7": [[229, 231], ["backbone.get_efficientnet"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.efficientnet.backbone.get_efficientnet"], ["", "def", "efficientnet_b7", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "2.0", ",", "3.1", ",", "600", ",", "0.5", "]", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Mlp.__init__": [[20, 31], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear", "mix_transformer.DWConv", "act_layer", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Dropout", "torch.Dropout", "torch.Dropout", "mix_transformer.Mlp.apply"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "def", "__init__", "(", "self", ",", "in_features", ",", "hidden_features", "=", "None", ",", "out_features", "=", "None", ",", "act_layer", "=", "nn", ".", "GELU", ",", "drop", "=", "0.", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "out_features", "=", "out_features", "or", "in_features", "\n", "hidden_features", "=", "hidden_features", "or", "in_features", "\n", "self", ".", "fc1", "=", "nn", ".", "Linear", "(", "in_features", ",", "hidden_features", ")", "\n", "self", ".", "dwconv", "=", "DWConv", "(", "hidden_features", ")", "\n", "self", ".", "act", "=", "act_layer", "(", ")", "\n", "self", ".", "fc2", "=", "nn", ".", "Linear", "(", "hidden_features", ",", "out_features", ")", "\n", "self", ".", "drop", "=", "nn", ".", "Dropout", "(", "drop", ")", "\n", "\n", "self", ".", "apply", "(", "self", ".", "_init_weights", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Mlp._init_weights": [[32, 46], ["isinstance", "timm.models.layers.trunc_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "m.weight.data.normal_", "math.sqrt", "m.bias.data.zero_"], "methods", ["None"], ["", "def", "_init_weights", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "trunc_normal_", "(", "m", ".", "weight", ",", "std", "=", ".02", ")", "\n", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", "and", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "LayerNorm", ")", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1.0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "fan_out", "=", "m", ".", "kernel_size", "[", "0", "]", "*", "m", ".", "kernel_size", "[", "1", "]", "*", "m", ".", "out_channels", "\n", "fan_out", "//=", "m", ".", "groups", "\n", "m", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "math", ".", "sqrt", "(", "2.0", "/", "fan_out", ")", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Mlp.forward": [[47, 55], ["mix_transformer.Mlp.fc1", "mix_transformer.Mlp.dwconv", "mix_transformer.Mlp.act", "mix_transformer.Mlp.drop", "mix_transformer.Mlp.fc2", "mix_transformer.Mlp.drop"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ",", "H", ",", "W", ")", ":", "\n", "        ", "x", "=", "self", ".", "fc1", "(", "x", ")", "\n", "x", "=", "self", ".", "dwconv", "(", "x", ",", "H", ",", "W", ")", "\n", "x", "=", "self", ".", "act", "(", "x", ")", "\n", "x", "=", "self", ".", "drop", "(", "x", ")", "\n", "x", "=", "self", ".", "fc2", "(", "x", ")", "\n", "x", "=", "self", ".", "drop", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Attention.__init__": [[58, 79], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Dropout", "torch.Dropout", "torch.Dropout", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Dropout", "torch.Dropout", "torch.Dropout", "mix_transformer.Attention.apply", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LayerNorm", "torch.LayerNorm", "torch.LayerNorm"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "num_heads", "=", "8", ",", "qkv_bias", "=", "False", ",", "qk_scale", "=", "None", ",", "attn_drop", "=", "0.", ",", "proj_drop", "=", "0.", ",", "sr_ratio", "=", "1", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "assert", "dim", "%", "num_heads", "==", "0", ",", "f\"dim {dim} should be divided by num_heads {num_heads}.\"", "\n", "\n", "self", ".", "dim", "=", "dim", "\n", "self", ".", "num_heads", "=", "num_heads", "\n", "head_dim", "=", "dim", "//", "num_heads", "\n", "self", ".", "scale", "=", "qk_scale", "or", "head_dim", "**", "-", "0.5", "\n", "\n", "self", ".", "q", "=", "nn", ".", "Linear", "(", "dim", ",", "dim", ",", "bias", "=", "qkv_bias", ")", "\n", "self", ".", "kv", "=", "nn", ".", "Linear", "(", "dim", ",", "dim", "*", "2", ",", "bias", "=", "qkv_bias", ")", "\n", "self", ".", "attn_drop", "=", "nn", ".", "Dropout", "(", "attn_drop", ")", "\n", "self", ".", "proj", "=", "nn", ".", "Linear", "(", "dim", ",", "dim", ")", "\n", "self", ".", "proj_drop", "=", "nn", ".", "Dropout", "(", "proj_drop", ")", "\n", "\n", "self", ".", "sr_ratio", "=", "sr_ratio", "\n", "if", "sr_ratio", ">", "1", ":", "\n", "            ", "self", ".", "sr", "=", "nn", ".", "Conv2d", "(", "dim", ",", "dim", ",", "kernel_size", "=", "sr_ratio", ",", "stride", "=", "sr_ratio", ")", "\n", "self", ".", "norm", "=", "nn", ".", "LayerNorm", "(", "dim", ")", "\n", "\n", "", "self", ".", "apply", "(", "self", ".", "_init_weights", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Attention._init_weights": [[80, 94], ["isinstance", "timm.models.layers.trunc_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "m.weight.data.normal_", "math.sqrt", "m.bias.data.zero_"], "methods", ["None"], ["", "def", "_init_weights", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "trunc_normal_", "(", "m", ".", "weight", ",", "std", "=", ".02", ")", "\n", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", "and", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "LayerNorm", ")", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1.0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "fan_out", "=", "m", ".", "kernel_size", "[", "0", "]", "*", "m", ".", "kernel_size", "[", "1", "]", "*", "m", ".", "out_channels", "\n", "fan_out", "//=", "m", ".", "groups", "\n", "m", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "math", ".", "sqrt", "(", "2.0", "/", "fan_out", ")", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Attention.forward": [[95, 117], ["mix_transformer.Attention.q().reshape().permute", "mix_transformer.Attention.softmax", "mix_transformer.Attention.attn_drop", "mix_transformer.Attention.proj", "mix_transformer.Attention.proj_drop", "mix_transformer.Attention.permute().reshape", "mix_transformer.Attention.sr().reshape().permute", "mix_transformer.Attention.norm", "mix_transformer.Attention.kv().reshape().permute", "mix_transformer.Attention.kv().reshape().permute", "mix_transformer.Attention.q().reshape", "k.transpose", "mix_transformer.Attention.permute", "mix_transformer.Attention.sr().reshape", "mix_transformer.Attention.kv().reshape", "mix_transformer.Attention.kv().reshape", "mix_transformer.Attention.q", "mix_transformer.Attention.sr", "mix_transformer.Attention.kv", "mix_transformer.Attention.kv"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ",", "H", ",", "W", ")", ":", "\n", "        ", "B", ",", "N", ",", "C", "=", "x", ".", "shape", "\n", "q", "=", "self", ".", "q", "(", "x", ")", ".", "reshape", "(", "B", ",", "N", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ",", "3", ")", "\n", "\n", "if", "self", ".", "sr_ratio", ">", "1", ":", "\n", "            ", "x_", "=", "x", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "reshape", "(", "B", ",", "C", ",", "H", ",", "W", ")", "\n", "x_", "=", "self", ".", "sr", "(", "x_", ")", ".", "reshape", "(", "B", ",", "C", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_", "=", "self", ".", "norm", "(", "x_", ")", "\n", "kv", "=", "self", ".", "kv", "(", "x_", ")", ".", "reshape", "(", "B", ",", "-", "1", ",", "2", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "2", ",", "0", ",", "3", ",", "1", ",", "4", ")", "\n", "", "else", ":", "\n", "            ", "kv", "=", "self", ".", "kv", "(", "x", ")", ".", "reshape", "(", "B", ",", "-", "1", ",", "2", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "2", ",", "0", ",", "3", ",", "1", ",", "4", ")", "\n", "", "k", ",", "v", "=", "kv", "[", "0", "]", ",", "kv", "[", "1", "]", "\n", "\n", "attn", "=", "(", "q", "@", "k", ".", "transpose", "(", "-", "2", ",", "-", "1", ")", ")", "*", "self", ".", "scale", "\n", "attn", "=", "attn", ".", "softmax", "(", "dim", "=", "-", "1", ")", "\n", "attn", "=", "self", ".", "attn_drop", "(", "attn", ")", "\n", "\n", "x", "=", "(", "attn", "@", "v", ")", ".", "transpose", "(", "1", ",", "2", ")", ".", "reshape", "(", "B", ",", "N", ",", "C", ")", "\n", "x", "=", "self", ".", "proj", "(", "x", ")", "\n", "x", "=", "self", ".", "proj_drop", "(", "x", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.CrossAttention.__init__": [[121, 143], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Dropout", "torch.Dropout", "torch.Dropout", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Dropout", "torch.Dropout", "torch.Dropout", "mix_transformer.CrossAttention.apply", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LayerNorm", "torch.LayerNorm", "torch.LayerNorm"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "num_heads", "=", "8", ",", "qkv_bias", "=", "False", ",", "qk_scale", "=", "None", ",", "attn_drop", "=", "0.", ",", "proj_drop", "=", "0.", ",", "sr_ratio", "=", "1", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "assert", "dim", "%", "num_heads", "==", "0", ",", "f\"dim {dim} should be divided by num_heads {num_heads}.\"", "\n", "\n", "self", ".", "dim", "=", "dim", "\n", "self", ".", "num_heads", "=", "num_heads", "\n", "head_dim", "=", "dim", "//", "num_heads", "\n", "self", ".", "scale", "=", "qk_scale", "or", "head_dim", "**", "-", "0.5", "\n", "\n", "self", ".", "q", "=", "nn", ".", "Linear", "(", "dim", ",", "dim", ",", "bias", "=", "qkv_bias", ")", "\n", "self", ".", "k", "=", "nn", ".", "Linear", "(", "dim", ",", "dim", ",", "bias", "=", "qkv_bias", ")", "\n", "self", ".", "v", "=", "nn", ".", "Linear", "(", "dim", ",", "dim", ",", "bias", "=", "qkv_bias", ")", "\n", "self", ".", "attn_drop", "=", "nn", ".", "Dropout", "(", "attn_drop", ")", "\n", "self", ".", "proj", "=", "nn", ".", "Linear", "(", "dim", ",", "dim", ")", "\n", "self", ".", "proj_drop", "=", "nn", ".", "Dropout", "(", "proj_drop", ")", "\n", "\n", "self", ".", "sr_ratio", "=", "sr_ratio", "\n", "if", "sr_ratio", ">", "1", ":", "\n", "            ", "self", ".", "sr", "=", "nn", ".", "Conv2d", "(", "dim", ",", "dim", ",", "kernel_size", "=", "sr_ratio", ",", "stride", "=", "sr_ratio", ")", "\n", "self", ".", "norm", "=", "nn", ".", "LayerNorm", "(", "dim", ")", "\n", "\n", "", "self", ".", "apply", "(", "self", ".", "_init_weights", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.CrossAttention._init_weights": [[144, 158], ["isinstance", "timm.models.layers.trunc_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "m.weight.data.normal_", "math.sqrt", "m.bias.data.zero_"], "methods", ["None"], ["", "def", "_init_weights", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "trunc_normal_", "(", "m", ".", "weight", ",", "std", "=", ".02", ")", "\n", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", "and", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "LayerNorm", ")", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1.0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "fan_out", "=", "m", ".", "kernel_size", "[", "0", "]", "*", "m", ".", "kernel_size", "[", "1", "]", "*", "m", ".", "out_channels", "\n", "fan_out", "//=", "m", ".", "groups", "\n", "m", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "math", ".", "sqrt", "(", "2.0", "/", "fan_out", ")", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.CrossAttention.forward": [[159, 186], ["mix_transformer.CrossAttention.q().reshape().permute", "mix_transformer.CrossAttention.softmax", "mix_transformer.CrossAttention.attn_drop", "mix_transformer.CrossAttention.proj", "mix_transformer.CrossAttention.proj_drop", "x_kq.permute().reshape", "mix_transformer.CrossAttention.sr().reshape().permute", "mix_transformer.CrossAttention.norm", "mix_transformer.CrossAttention.k().reshape().permute", "mix_transformer.CrossAttention.permute().reshape", "mix_transformer.CrossAttention.sr().reshape().permute", "mix_transformer.CrossAttention.norm", "mix_transformer.CrossAttention.v().reshape().permute", "mix_transformer.CrossAttention.k().reshape().permute", "mix_transformer.CrossAttention.v().reshape().permute", "mix_transformer.CrossAttention.q().reshape", "mix_transformer.CrossAttention.transpose", "x_kq.permute", "mix_transformer.CrossAttention.sr().reshape", "mix_transformer.CrossAttention.k().reshape", "mix_transformer.CrossAttention.permute", "mix_transformer.CrossAttention.sr().reshape", "mix_transformer.CrossAttention.v().reshape", "mix_transformer.CrossAttention.k().reshape", "mix_transformer.CrossAttention.v().reshape", "mix_transformer.CrossAttention.q", "mix_transformer.CrossAttention.sr", "mix_transformer.CrossAttention.k", "mix_transformer.CrossAttention.sr", "mix_transformer.CrossAttention.v", "mix_transformer.CrossAttention.k", "mix_transformer.CrossAttention.v"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x_kq", ",", "x_v", ",", "H", ",", "W", ")", ":", "\n", "        ", "B", ",", "N", ",", "C", "=", "x_kq", ".", "shape", "\n", "q", "=", "self", ".", "q", "(", "x_kq", ")", ".", "reshape", "(", "B", ",", "N", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ",", "3", ")", "\n", "\n", "if", "self", ".", "sr_ratio", ">", "1", ":", "\n", "            ", "x_k", "=", "x_kq", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "reshape", "(", "B", ",", "C", ",", "H", ",", "W", ")", "\n", "x_k", "=", "self", ".", "sr", "(", "x_k", ")", ".", "reshape", "(", "B", ",", "C", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_k", "=", "self", ".", "norm", "(", "x_k", ")", "\n", "k", "=", "self", ".", "k", "(", "x_k", ")", ".", "reshape", "(", "B", ",", "-", "1", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ",", "3", ")", "\n", "\n", "x_v", "=", "x_v", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "reshape", "(", "B", ",", "C", ",", "H", ",", "W", ")", "\n", "x_v", "=", "self", ".", "sr", "(", "x_v", ")", ".", "reshape", "(", "B", ",", "C", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_v", "=", "self", ".", "norm", "(", "x_v", ")", "\n", "v", "=", "self", ".", "v", "(", "x_v", ")", ".", "reshape", "(", "B", ",", "-", "1", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ",", "3", ")", "\n", "", "else", ":", "\n", "            ", "k", "=", "self", ".", "k", "(", "x_kq", ")", ".", "reshape", "(", "B", ",", "-", "1", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ",", "3", ")", "\n", "v", "=", "self", ".", "v", "(", "x_v", ")", ".", "reshape", "(", "B", ",", "-", "1", ",", "self", ".", "num_heads", ",", "C", "//", "self", ".", "num_heads", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ",", "3", ")", "\n", "\n", "", "attn", "=", "(", "q", "@", "k", ".", "transpose", "(", "-", "2", ",", "-", "1", ")", ")", "*", "self", ".", "scale", "\n", "attn", "=", "attn", ".", "softmax", "(", "dim", "=", "-", "1", ")", "\n", "attn", "=", "self", ".", "attn_drop", "(", "attn", ")", "\n", "\n", "x", "=", "(", "attn", "@", "v", ")", ".", "transpose", "(", "1", ",", "2", ")", ".", "reshape", "(", "B", ",", "N", ",", "C", ")", "\n", "x", "=", "self", ".", "proj", "(", "x", ")", "\n", "x", "=", "self", ".", "proj_drop", "(", "x", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Block.__init__": [[190, 204], ["torch.Module.__init__", "norm_layer", "mix_transformer.Attention", "norm_layer", "int", "mix_transformer.Mlp", "mix_transformer.Block.apply", "timm.models.layers.DropPath", "torch.Identity", "torch.Identity", "torch.Identity"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "num_heads", ",", "mlp_ratio", "=", "4.", ",", "qkv_bias", "=", "False", ",", "qk_scale", "=", "None", ",", "drop", "=", "0.", ",", "attn_drop", "=", "0.", ",", "\n", "drop_path", "=", "0.", ",", "act_layer", "=", "nn", ".", "GELU", ",", "norm_layer", "=", "nn", ".", "LayerNorm", ",", "sr_ratio", "=", "1", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "norm1", "=", "norm_layer", "(", "dim", ")", "\n", "self", ".", "attn", "=", "Attention", "(", "\n", "dim", ",", "\n", "num_heads", "=", "num_heads", ",", "qkv_bias", "=", "qkv_bias", ",", "qk_scale", "=", "qk_scale", ",", "\n", "attn_drop", "=", "attn_drop", ",", "proj_drop", "=", "drop", ",", "sr_ratio", "=", "sr_ratio", ")", "\n", "# NOTE: drop path for stochastic depth, we shall see if this is better than dropout here", "\n", "self", ".", "drop_path", "=", "DropPath", "(", "drop_path", ")", "if", "drop_path", ">", "0.", "else", "nn", ".", "Identity", "(", ")", "\n", "self", ".", "norm2", "=", "norm_layer", "(", "dim", ")", "\n", "mlp_hidden_dim", "=", "int", "(", "dim", "*", "mlp_ratio", ")", "\n", "self", ".", "mlp", "=", "Mlp", "(", "in_features", "=", "dim", ",", "hidden_features", "=", "mlp_hidden_dim", ",", "act_layer", "=", "act_layer", ",", "drop", "=", "drop", ")", "\n", "self", ".", "apply", "(", "self", ".", "_init_weights", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Block._init_weights": [[205, 219], ["isinstance", "timm.models.layers.trunc_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "m.weight.data.normal_", "math.sqrt", "m.bias.data.zero_"], "methods", ["None"], ["", "def", "_init_weights", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "trunc_normal_", "(", "m", ".", "weight", ",", "std", "=", ".02", ")", "\n", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", "and", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "LayerNorm", ")", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1.0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "fan_out", "=", "m", ".", "kernel_size", "[", "0", "]", "*", "m", ".", "kernel_size", "[", "1", "]", "*", "m", ".", "out_channels", "\n", "fan_out", "//=", "m", ".", "groups", "\n", "m", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "math", ".", "sqrt", "(", "2.0", "/", "fan_out", ")", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Block.forward": [[220, 225], ["mix_transformer.Block.drop_path", "mix_transformer.Block.drop_path", "mix_transformer.Block.attn", "mix_transformer.Block.mlp", "mix_transformer.Block.norm1", "mix_transformer.Block.norm2"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ",", "H", ",", "W", ")", ":", "\n", "        ", "x", "=", "x", "+", "self", ".", "drop_path", "(", "self", ".", "attn", "(", "self", ".", "norm1", "(", "x", ")", ",", "H", ",", "W", ")", ")", "\n", "x", "=", "x", "+", "self", ".", "drop_path", "(", "self", ".", "mlp", "(", "self", ".", "norm2", "(", "x", ")", ",", "H", ",", "W", ")", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Block_Side.__init__": [[228, 243], ["torch.Module.__init__", "norm_layer", "norm_layer", "mix_transformer.CrossAttention", "norm_layer", "int", "mix_transformer.Mlp", "mix_transformer.Block_Side.apply", "timm.models.layers.DropPath", "torch.Identity", "torch.Identity", "torch.Identity"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "num_heads", ",", "mlp_ratio", "=", "4.", ",", "qkv_bias", "=", "False", ",", "qk_scale", "=", "None", ",", "drop", "=", "0.", ",", "attn_drop", "=", "0.", ",", "\n", "drop_path", "=", "0.", ",", "act_layer", "=", "nn", ".", "GELU", ",", "norm_layer", "=", "nn", ".", "LayerNorm", ",", "sr_ratio", "=", "1", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "norm1", "=", "norm_layer", "(", "dim", ")", "\n", "self", ".", "norm_side", "=", "norm_layer", "(", "dim", ")", "\n", "self", ".", "attn", "=", "CrossAttention", "(", "\n", "dim", ",", "\n", "num_heads", "=", "num_heads", ",", "qkv_bias", "=", "qkv_bias", ",", "qk_scale", "=", "qk_scale", ",", "\n", "attn_drop", "=", "attn_drop", ",", "proj_drop", "=", "drop", ",", "sr_ratio", "=", "sr_ratio", ")", "\n", "# NOTE: drop path for stochastic depth, we shall see if this is better than dropout here", "\n", "self", ".", "drop_path", "=", "DropPath", "(", "drop_path", ")", "if", "drop_path", ">", "0.", "else", "nn", ".", "Identity", "(", ")", "\n", "self", ".", "norm2", "=", "norm_layer", "(", "dim", ")", "\n", "mlp_hidden_dim", "=", "int", "(", "dim", "*", "mlp_ratio", ")", "\n", "self", ".", "mlp", "=", "Mlp", "(", "in_features", "=", "dim", ",", "hidden_features", "=", "mlp_hidden_dim", ",", "act_layer", "=", "act_layer", ",", "drop", "=", "drop", ")", "\n", "self", ".", "apply", "(", "self", ".", "_init_weights", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Block_Side._init_weights": [[244, 258], ["isinstance", "timm.models.layers.trunc_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "m.weight.data.normal_", "math.sqrt", "m.bias.data.zero_"], "methods", ["None"], ["", "def", "_init_weights", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "trunc_normal_", "(", "m", ".", "weight", ",", "std", "=", ".02", ")", "\n", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", "and", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "LayerNorm", ")", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1.0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "fan_out", "=", "m", ".", "kernel_size", "[", "0", "]", "*", "m", ".", "kernel_size", "[", "1", "]", "*", "m", ".", "out_channels", "\n", "fan_out", "//=", "m", ".", "groups", "\n", "m", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "math", ".", "sqrt", "(", "2.0", "/", "fan_out", ")", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.Block_Side.forward": [[259, 264], ["x.flatten().transpose", "mix_transformer.Block_Side.drop_path", "mix_transformer.Block_Side.drop_path", "x.flatten", "mix_transformer.Block_Side.attn", "mix_transformer.Block_Side.mlp", "mix_transformer.Block_Side.norm1", "mix_transformer.Block_Side.norm_side", "mix_transformer.Block_Side.norm2"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ",", "x_side", ",", "H", ",", "W", ")", ":", "\n", "        ", "x_flatte", "=", "x", ".", "flatten", "(", "2", ")", ".", "transpose", "(", "1", ",", "2", ")", "\n", "x", "=", "x_side", "+", "self", ".", "drop_path", "(", "self", ".", "attn", "(", "self", ".", "norm1", "(", "x_flatte", ")", ",", "self", ".", "norm_side", "(", "x_side", ")", ",", "H", ",", "W", ")", ")", "\n", "x", "=", "x", "+", "self", ".", "drop_path", "(", "self", ".", "mlp", "(", "self", ".", "norm2", "(", "x", ")", ",", "H", ",", "W", ")", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.OverlapPatchEmbed.__init__": [[270, 284], ["torch.Module.__init__", "timm.models.layers.to_2tuple", "timm.models.layers.to_2tuple", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LayerNorm", "torch.LayerNorm", "torch.LayerNorm", "mix_transformer.OverlapPatchEmbed.apply"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["def", "__init__", "(", "self", ",", "img_size", "=", "224", ",", "patch_size", "=", "7", ",", "stride", "=", "4", ",", "in_chans", "=", "3", ",", "embed_dim", "=", "768", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "img_size", "=", "to_2tuple", "(", "img_size", ")", "\n", "patch_size", "=", "to_2tuple", "(", "patch_size", ")", "\n", "\n", "self", ".", "img_size", "=", "img_size", "\n", "self", ".", "patch_size", "=", "patch_size", "\n", "self", ".", "H", ",", "self", ".", "W", "=", "img_size", "[", "0", "]", "//", "patch_size", "[", "0", "]", ",", "img_size", "[", "1", "]", "//", "patch_size", "[", "1", "]", "\n", "self", ".", "num_patches", "=", "self", ".", "H", "*", "self", ".", "W", "\n", "self", ".", "proj", "=", "nn", ".", "Conv2d", "(", "in_chans", ",", "embed_dim", ",", "kernel_size", "=", "patch_size", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "(", "patch_size", "[", "0", "]", "//", "2", ",", "patch_size", "[", "1", "]", "//", "2", ")", ")", "\n", "self", ".", "norm", "=", "nn", ".", "LayerNorm", "(", "embed_dim", ")", "\n", "\n", "self", ".", "apply", "(", "self", ".", "_init_weights", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.OverlapPatchEmbed._init_weights": [[285, 299], ["isinstance", "timm.models.layers.trunc_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "m.weight.data.normal_", "math.sqrt", "m.bias.data.zero_"], "methods", ["None"], ["", "def", "_init_weights", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "trunc_normal_", "(", "m", ".", "weight", ",", "std", "=", ".02", ")", "\n", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", "and", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "LayerNorm", ")", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1.0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "fan_out", "=", "m", ".", "kernel_size", "[", "0", "]", "*", "m", ".", "kernel_size", "[", "1", "]", "*", "m", ".", "out_channels", "\n", "fan_out", "//=", "m", ".", "groups", "\n", "m", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "math", ".", "sqrt", "(", "2.0", "/", "fan_out", ")", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.OverlapPatchEmbed.forward": [[300, 306], ["mix_transformer.OverlapPatchEmbed.proj", "mix_transformer.OverlapPatchEmbed.flatten().transpose", "mix_transformer.OverlapPatchEmbed.norm", "mix_transformer.OverlapPatchEmbed.flatten"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "proj", "(", "x", ")", "\n", "_", ",", "_", ",", "H", ",", "W", "=", "x", ".", "shape", "\n", "x", "=", "x", ".", "flatten", "(", "2", ")", ".", "transpose", "(", "1", ",", "2", ")", "\n", "x", "=", "self", ".", "norm", "(", "x", ")", "\n", "return", "x", ",", "H", ",", "W", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.__init__": [[309, 380], ["torch.Module.__init__", "mix_transformer.OverlapPatchEmbed", "mix_transformer.OverlapPatchEmbed", "mix_transformer.OverlapPatchEmbed", "mix_transformer.OverlapPatchEmbed", "mix_transformer.OverlapPatchEmbed", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "norm_layer", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "norm_layer", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "norm_layer", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "norm_layer", "mix_transformer.MixVisionTransformer.apply", "x.item", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "mix_transformer.Block", "mix_transformer.Block", "mix_transformer.Block", "mix_transformer.Block", "sum", "range", "range", "range", "range"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply"], ["    ", "def", "__init__", "(", "self", ",", "img_size", "=", "224", ",", "patch_size", "=", "16", ",", "in_chans", "=", "3", ",", "num_classes", "=", "1000", ",", "embed_dims", "=", "[", "64", ",", "128", ",", "256", ",", "512", "]", ",", "\n", "num_heads", "=", "[", "1", ",", "2", ",", "4", ",", "8", "]", ",", "mlp_ratios", "=", "[", "4", ",", "4", ",", "4", ",", "4", "]", ",", "qkv_bias", "=", "False", ",", "qk_scale", "=", "None", ",", "drop_rate", "=", "0.", ",", "\n", "attn_drop_rate", "=", "0.", ",", "drop_path_rate", "=", "0.", ",", "norm_layer", "=", "nn", ".", "LayerNorm", ",", "\n", "depths", "=", "[", "3", ",", "4", ",", "6", ",", "3", "]", ",", "sr_ratios", "=", "[", "8", ",", "4", ",", "2", ",", "1", "]", ",", "side_dims", "=", "3", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "num_classes", "=", "num_classes", "\n", "self", ".", "depths", "=", "depths", "\n", "\n", "# patch_embed", "\n", "self", ".", "patch_embed1", "=", "OverlapPatchEmbed", "(", "img_size", "=", "img_size", ",", "patch_size", "=", "7", ",", "stride", "=", "4", ",", "in_chans", "=", "in_chans", ",", "\n", "embed_dim", "=", "embed_dims", "[", "0", "]", ")", "\n", "self", ".", "patch_embed2", "=", "OverlapPatchEmbed", "(", "img_size", "=", "img_size", "//", "4", ",", "patch_size", "=", "3", ",", "stride", "=", "2", ",", "in_chans", "=", "embed_dims", "[", "0", "]", ",", "\n", "embed_dim", "=", "embed_dims", "[", "1", "]", ")", "\n", "self", ".", "patch_embed3", "=", "OverlapPatchEmbed", "(", "img_size", "=", "img_size", "//", "8", ",", "patch_size", "=", "3", ",", "stride", "=", "2", ",", "in_chans", "=", "embed_dims", "[", "1", "]", ",", "\n", "embed_dim", "=", "embed_dims", "[", "2", "]", ")", "\n", "self", ".", "patch_embed4", "=", "OverlapPatchEmbed", "(", "img_size", "=", "img_size", "//", "16", ",", "patch_size", "=", "3", ",", "stride", "=", "2", ",", "in_chans", "=", "embed_dims", "[", "2", "]", ",", "\n", "embed_dim", "=", "embed_dims", "[", "3", "]", ")", "\n", "self", ".", "patch_embed_side1", "=", "OverlapPatchEmbed", "(", "img_size", "=", "img_size", ",", "patch_size", "=", "7", ",", "stride", "=", "4", ",", "in_chans", "=", "side_dims", ",", "\n", "embed_dim", "=", "embed_dims", "[", "0", "]", ")", "\n", "#self.patch_embed_side2 = OverlapPatchEmbed(img_size=img_size // 4, patch_size=3, stride=2, in_chans=embed_dims[0],", "\n", "#                                      embed_dim=embed_dims[1])", "\n", "#self.patch_embed_side3 = OverlapPatchEmbed(img_size=img_size // 8, patch_size=3, stride=2, in_chans=embed_dims[1],", "\n", "#                                      embed_dim=embed_dims[2])", "\n", "#self.patch_embed_side4 = OverlapPatchEmbed(img_size=img_size // 16, patch_size=3, stride=2, in_chans=embed_dims[2],", "\n", "#                                      embed_dim=embed_dims[3])", "\n", "\n", "\n", "# transformer encoder", "\n", "dpr", "=", "[", "x", ".", "item", "(", ")", "for", "x", "in", "torch", ".", "linspace", "(", "0", ",", "drop_path_rate", ",", "sum", "(", "depths", ")", ")", "]", "# stochastic depth decay rule", "\n", "cur", "=", "0", "\n", "self", ".", "block1", "=", "nn", ".", "ModuleList", "(", "[", "Block", "(", "\n", "dim", "=", "embed_dims", "[", "0", "]", ",", "num_heads", "=", "num_heads", "[", "0", "]", ",", "mlp_ratio", "=", "mlp_ratios", "[", "0", "]", ",", "qkv_bias", "=", "qkv_bias", ",", "qk_scale", "=", "qk_scale", ",", "\n", "drop", "=", "drop_rate", ",", "attn_drop", "=", "attn_drop_rate", ",", "drop_path", "=", "dpr", "[", "cur", "+", "i", "]", ",", "norm_layer", "=", "norm_layer", ",", "\n", "sr_ratio", "=", "sr_ratios", "[", "0", "]", ")", "\n", "for", "i", "in", "range", "(", "depths", "[", "0", "]", ")", "]", ")", "\n", "self", ".", "norm1", "=", "norm_layer", "(", "embed_dims", "[", "0", "]", ")", "\n", "\n", "#self.block_side = Block_Side(dim=embed_dims[0], num_heads=num_heads[0], mlp_ratio=mlp_ratios[0], qkv_bias=qkv_bias, qk_scale=qk_scale,", "\n", "#    drop=drop_rate, attn_drop=attn_drop_rate, drop_path=dpr[cur], norm_layer=norm_layer,", "\n", "#    sr_ratio=sr_ratios[0])", "\n", "#self.norm_side = norm_layer(embed_dims[0])", "\n", "\n", "\n", "cur", "+=", "depths", "[", "0", "]", "\n", "self", ".", "block2", "=", "nn", ".", "ModuleList", "(", "[", "Block", "(", "\n", "dim", "=", "embed_dims", "[", "1", "]", ",", "num_heads", "=", "num_heads", "[", "1", "]", ",", "mlp_ratio", "=", "mlp_ratios", "[", "1", "]", ",", "qkv_bias", "=", "qkv_bias", ",", "qk_scale", "=", "qk_scale", ",", "\n", "drop", "=", "drop_rate", ",", "attn_drop", "=", "attn_drop_rate", ",", "drop_path", "=", "dpr", "[", "cur", "+", "i", "]", ",", "norm_layer", "=", "norm_layer", ",", "\n", "sr_ratio", "=", "sr_ratios", "[", "1", "]", ")", "\n", "for", "i", "in", "range", "(", "depths", "[", "1", "]", ")", "]", ")", "\n", "self", ".", "norm2", "=", "norm_layer", "(", "embed_dims", "[", "1", "]", ")", "\n", "\n", "cur", "+=", "depths", "[", "1", "]", "\n", "self", ".", "block3", "=", "nn", ".", "ModuleList", "(", "[", "Block", "(", "\n", "dim", "=", "embed_dims", "[", "2", "]", ",", "num_heads", "=", "num_heads", "[", "2", "]", ",", "mlp_ratio", "=", "mlp_ratios", "[", "2", "]", ",", "qkv_bias", "=", "qkv_bias", ",", "qk_scale", "=", "qk_scale", ",", "\n", "drop", "=", "drop_rate", ",", "attn_drop", "=", "attn_drop_rate", ",", "drop_path", "=", "dpr", "[", "cur", "+", "i", "]", ",", "norm_layer", "=", "norm_layer", ",", "\n", "sr_ratio", "=", "sr_ratios", "[", "2", "]", ")", "\n", "for", "i", "in", "range", "(", "depths", "[", "2", "]", ")", "]", ")", "\n", "self", ".", "norm3", "=", "norm_layer", "(", "embed_dims", "[", "2", "]", ")", "\n", "\n", "cur", "+=", "depths", "[", "2", "]", "\n", "self", ".", "block4", "=", "nn", ".", "ModuleList", "(", "[", "Block", "(", "\n", "dim", "=", "embed_dims", "[", "3", "]", ",", "num_heads", "=", "num_heads", "[", "3", "]", ",", "mlp_ratio", "=", "mlp_ratios", "[", "3", "]", ",", "qkv_bias", "=", "qkv_bias", ",", "qk_scale", "=", "qk_scale", ",", "\n", "drop", "=", "drop_rate", ",", "attn_drop", "=", "attn_drop_rate", ",", "drop_path", "=", "dpr", "[", "cur", "+", "i", "]", ",", "norm_layer", "=", "norm_layer", ",", "\n", "sr_ratio", "=", "sr_ratios", "[", "3", "]", ")", "\n", "for", "i", "in", "range", "(", "depths", "[", "3", "]", ")", "]", ")", "\n", "self", ".", "norm4", "=", "norm_layer", "(", "embed_dims", "[", "3", "]", ")", "\n", "\n", "# classification head", "\n", "# self.head = nn.Linear(embed_dims[3], num_classes) if num_classes > 0 else nn.Identity()", "\n", "\n", "self", ".", "apply", "(", "self", ".", "_init_weights", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer._init_weights": [[381, 395], ["isinstance", "timm.models.layers.trunc_normal_", "isinstance", "isinstance", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "torch.init.constant_", "isinstance", "m.weight.data.normal_", "math.sqrt", "m.bias.data.zero_"], "methods", ["None"], ["", "def", "_init_weights", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "trunc_normal_", "(", "m", ".", "weight", ",", "std", "=", ".02", ")", "\n", "if", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", "and", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "LayerNorm", ")", ":", "\n", "            ", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "weight", ",", "1.0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "fan_out", "=", "m", ".", "kernel_size", "[", "0", "]", "*", "m", ".", "kernel_size", "[", "1", "]", "*", "m", ".", "out_channels", "\n", "fan_out", "//=", "m", ".", "groups", "\n", "m", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "math", ".", "sqrt", "(", "2.0", "/", "fan_out", ")", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.init_weights": [[396, 401], ["isinstance"], "methods", ["None"], ["", "", "", "def", "init_weights", "(", "self", ",", "pretrained", "=", "None", ")", ":", "\n", "        ", "if", "isinstance", "(", "pretrained", ",", "str", ")", ":", "\n", "#logger = get_root_logger()", "\n", "#todo", "\n", "            ", "pass", "\n", "#load_checkpoint(self, pretrained, map_location='cpu', strict=False, logger=logger)", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.reset_drop_path": [[403, 420], ["range", "range", "range", "range", "x.item", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "torch.linspace", "sum"], "methods", ["None"], ["", "", "def", "reset_drop_path", "(", "self", ",", "drop_path_rate", ")", ":", "\n", "        ", "dpr", "=", "[", "x", ".", "item", "(", ")", "for", "x", "in", "torch", ".", "linspace", "(", "0", ",", "drop_path_rate", ",", "sum", "(", "self", ".", "depths", ")", ")", "]", "\n", "cur", "=", "0", "\n", "for", "i", "in", "range", "(", "self", ".", "depths", "[", "0", "]", ")", ":", "\n", "            ", "self", ".", "block1", "[", "i", "]", ".", "drop_path", ".", "drop_prob", "=", "dpr", "[", "cur", "+", "i", "]", "\n", "\n", "", "cur", "+=", "self", ".", "depths", "[", "0", "]", "\n", "for", "i", "in", "range", "(", "self", ".", "depths", "[", "1", "]", ")", ":", "\n", "            ", "self", ".", "block2", "[", "i", "]", ".", "drop_path", ".", "drop_prob", "=", "dpr", "[", "cur", "+", "i", "]", "\n", "\n", "", "cur", "+=", "self", ".", "depths", "[", "1", "]", "\n", "for", "i", "in", "range", "(", "self", ".", "depths", "[", "2", "]", ")", ":", "\n", "            ", "self", ".", "block3", "[", "i", "]", ".", "drop_path", ".", "drop_prob", "=", "dpr", "[", "cur", "+", "i", "]", "\n", "\n", "", "cur", "+=", "self", ".", "depths", "[", "2", "]", "\n", "for", "i", "in", "range", "(", "self", ".", "depths", "[", "3", "]", ")", ":", "\n", "            ", "self", ".", "block4", "[", "i", "]", ".", "drop_path", ".", "drop_prob", "=", "dpr", "[", "cur", "+", "i", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.freeze_patch_emb": [[421, 423], ["None"], "methods", ["None"], ["", "", "def", "freeze_patch_emb", "(", "self", ")", ":", "\n", "        ", "self", ".", "patch_embed1", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.no_weight_decay": [[424, 427], ["None"], "methods", ["None"], ["", "@", "torch", ".", "jit", ".", "ignore", "\n", "def", "no_weight_decay", "(", "self", ")", ":", "\n", "        ", "return", "{", "'pos_embed1'", ",", "'pos_embed2'", ",", "'pos_embed3'", ",", "'pos_embed4'", ",", "'cls_token'", "}", "# has pos_embed may be better", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.get_classifier": [[428, 430], ["None"], "methods", ["None"], ["", "def", "get_classifier", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "head", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.reset_classifier": [[431, 434], ["torch.Linear", "torch.Linear", "torch.Linear", "torch.Identity", "torch.Identity", "torch.Identity"], "methods", ["None"], ["", "def", "reset_classifier", "(", "self", ",", "num_classes", ",", "global_pool", "=", "''", ")", ":", "\n", "        ", "self", ".", "num_classes", "=", "num_classes", "\n", "self", ".", "head", "=", "nn", ".", "Linear", "(", "self", ".", "embed_dim", ",", "num_classes", ")", "if", "num_classes", ">", "0", "else", "nn", ".", "Identity", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.forward_features": [[435, 501], ["mix_transformer.MixVisionTransformer.patch_embed1", "enumerate", "mix_transformer.MixVisionTransformer.norm1", "blk.reshape().permute().contiguous", "outs.append", "mix_transformer.MixVisionTransformer.patch_embed2", "enumerate", "mix_transformer.MixVisionTransformer.norm2", "blk.reshape().permute().contiguous", "outs.append", "mix_transformer.MixVisionTransformer.patch_embed3", "enumerate", "mix_transformer.MixVisionTransformer.norm3", "blk.reshape().permute().contiguous", "outs.append", "mix_transformer.MixVisionTransformer.patch_embed4", "enumerate", "mix_transformer.MixVisionTransformer.norm4", "blk.reshape().permute().contiguous", "outs.append", "mix_transformer.MixVisionTransformer.patch_embed_side1", "af.reshape().permute().contiguous.reshape().permute().contiguous.reshape().permute().contiguous", "embeds.append", "blk", "blk", "blk", "blk", "blk.reshape().permute", "blk.reshape().permute", "blk.reshape().permute", "blk.reshape().permute", "af.reshape().permute().contiguous.reshape().permute().contiguous.reshape().permute", "blk.reshape", "blk.reshape", "blk.reshape", "blk.reshape", "af.reshape().permute().contiguous.reshape().permute().contiguous.reshape"], "methods", ["None"], ["", "def", "forward_features", "(", "self", ",", "x", ",", "additional_feature", "=", "None", ")", ":", "\n", "\n", "        ", "B", "=", "x", ".", "shape", "[", "0", "]", "\n", "outs", "=", "[", "]", "\n", "embeds", "=", "[", "]", "\n", "\n", "if", "additional_feature", "is", "not", "None", ":", "\n", "            ", "af", ",", "H", ",", "W", "=", "self", ".", "patch_embed_side1", "(", "additional_feature", ")", "\n", "af", "=", "af", ".", "reshape", "(", "B", ",", "H", ",", "W", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", ".", "contiguous", "(", ")", "\n", "embeds", ".", "append", "(", "af", ")", "#1/4", "\n", "\n", "#af, H, W = self.patch_embed_side2(af)", "\n", "#af = af.reshape(B, H, W, -1).permute(0, 3, 1, 2).contiguous()", "\n", "#embeds.append(af) #1/8", "\n", "\n", "#af, H, W = self.patch_embed_side3(af)", "\n", "#af = af.reshape(B, H, W, -1).permute(0, 3, 1, 2).contiguous()", "\n", "#embeds.append(af) #1/16", "\n", "\n", "#af, H, W = self.patch_embed_side4(af)", "\n", "#af = af.reshape(B, H, W, -1).permute(0, 3, 1, 2).contiguous()", "\n", "#embeds.append(af) #1/32", "\n", "\n", "# stage 1", "\n", "", "x", ",", "H", ",", "W", "=", "self", ".", "patch_embed1", "(", "x", ")", "\n", "for", "i", ",", "blk", "in", "enumerate", "(", "self", ".", "block1", ")", ":", "\n", "            ", "x", "=", "blk", "(", "x", ",", "H", ",", "W", ")", "\n", "", "x", "=", "self", ".", "norm1", "(", "x", ")", "\n", "x", "=", "x", ".", "reshape", "(", "B", ",", "H", ",", "W", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", ".", "contiguous", "(", ")", "\n", "outs", ".", "append", "(", "x", ")", "\n", "if", "additional_feature", "is", "not", "None", ":", "\n", "            ", "x", "=", "x", "+", "embeds", "[", "0", "]", "\n", "\n", "\n", "# stage 2", "\n", "", "x", ",", "H", ",", "W", "=", "self", ".", "patch_embed2", "(", "x", ")", "\n", "for", "i", ",", "blk", "in", "enumerate", "(", "self", ".", "block2", ")", ":", "\n", "            ", "x", "=", "blk", "(", "x", ",", "H", ",", "W", ")", "\n", "", "x", "=", "self", ".", "norm2", "(", "x", ")", "\n", "x", "=", "x", ".", "reshape", "(", "B", ",", "H", ",", "W", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", ".", "contiguous", "(", ")", "\n", "outs", ".", "append", "(", "x", ")", "\n", "#if additional_feature is not None:", "\n", "#    x = x + embeds[1]", "\n", "\n", "# stage 3", "\n", "x", ",", "H", ",", "W", "=", "self", ".", "patch_embed3", "(", "x", ")", "\n", "for", "i", ",", "blk", "in", "enumerate", "(", "self", ".", "block3", ")", ":", "\n", "            ", "x", "=", "blk", "(", "x", ",", "H", ",", "W", ")", "\n", "", "x", "=", "self", ".", "norm3", "(", "x", ")", "\n", "x", "=", "x", ".", "reshape", "(", "B", ",", "H", ",", "W", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", ".", "contiguous", "(", ")", "\n", "outs", ".", "append", "(", "x", ")", "\n", "#if additional_feature is not None:", "\n", "#    x = x + embeds[2]", "\n", "\n", "# stage 4", "\n", "x", ",", "H", ",", "W", "=", "self", ".", "patch_embed4", "(", "x", ")", "\n", "for", "i", ",", "blk", "in", "enumerate", "(", "self", ".", "block4", ")", ":", "\n", "            ", "x", "=", "blk", "(", "x", ",", "H", ",", "W", ")", "\n", "", "x", "=", "self", ".", "norm4", "(", "x", ")", "\n", "x", "=", "x", ".", "reshape", "(", "B", ",", "H", ",", "W", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", ".", "contiguous", "(", ")", "\n", "\n", "#if additional_feature is not None:", "\n", "#    x = x + embeds[3]", "\n", "outs", ".", "append", "(", "x", ")", "\n", "\n", "return", "outs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.forward": [[502, 507], ["mix_transformer.MixVisionTransformer.forward_features"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.MixVisionTransformer.forward_features"], ["", "def", "forward", "(", "self", ",", "x", ",", "additional_feature", "=", "None", ")", ":", "\n", "        ", "x", "=", "self", ".", "forward_features", "(", "x", ",", "additional_feature", ")", "\n", "# x = self.head(x)", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.DWConv.__init__": [[510, 513], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dim", "=", "768", ")", ":", "\n", "        ", "super", "(", "DWConv", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "dwconv", "=", "nn", ".", "Conv2d", "(", "dim", ",", "dim", ",", "3", ",", "1", ",", "1", ",", "bias", "=", "True", ",", "groups", "=", "dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.DWConv.forward": [[514, 521], ["x.flatten().transpose.flatten().transpose.transpose().view", "mix_transformer.DWConv.dwconv", "x.flatten().transpose.flatten().transpose.flatten().transpose", "x.flatten().transpose.flatten().transpose.transpose", "x.flatten().transpose.flatten().transpose.flatten"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "H", ",", "W", ")", ":", "\n", "        ", "B", ",", "N", ",", "C", "=", "x", ".", "shape", "\n", "x", "=", "x", ".", "transpose", "(", "1", ",", "2", ")", ".", "view", "(", "B", ",", "C", ",", "H", ",", "W", ")", "\n", "x", "=", "self", ".", "dwconv", "(", "x", ")", "\n", "x", "=", "x", ".", "flatten", "(", "2", ")", ".", "transpose", "(", "1", ",", "2", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.mit_b0.__init__": [[526, 531], ["mix_transformer.MixVisionTransformer.__init__", "functools.partial"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "mit_b0", ",", "self", ")", ".", "__init__", "(", "\n", "patch_size", "=", "4", ",", "embed_dims", "=", "[", "32", ",", "64", ",", "160", ",", "256", "]", ",", "num_heads", "=", "[", "1", ",", "2", ",", "5", ",", "8", "]", ",", "mlp_ratios", "=", "[", "4", ",", "4", ",", "4", ",", "4", "]", ",", "\n", "qkv_bias", "=", "True", ",", "norm_layer", "=", "partial", "(", "nn", ".", "LayerNorm", ",", "eps", "=", "1e-6", ")", ",", "depths", "=", "[", "2", ",", "2", ",", "2", ",", "2", "]", ",", "sr_ratios", "=", "[", "8", ",", "4", ",", "2", ",", "1", "]", ",", "\n", "drop_rate", "=", "0.0", ",", "drop_path_rate", "=", "0.1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.mit_b1.__init__": [[535, 540], ["mix_transformer.MixVisionTransformer.__init__", "functools.partial"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "mit_b1", ",", "self", ")", ".", "__init__", "(", "\n", "patch_size", "=", "4", ",", "embed_dims", "=", "[", "64", ",", "128", ",", "320", ",", "512", "]", ",", "num_heads", "=", "[", "1", ",", "2", ",", "5", ",", "8", "]", ",", "mlp_ratios", "=", "[", "4", ",", "4", ",", "4", ",", "4", "]", ",", "\n", "qkv_bias", "=", "True", ",", "norm_layer", "=", "partial", "(", "nn", ".", "LayerNorm", ",", "eps", "=", "1e-6", ")", ",", "depths", "=", "[", "2", ",", "2", ",", "2", ",", "2", "]", ",", "sr_ratios", "=", "[", "8", ",", "4", ",", "2", ",", "1", "]", ",", "\n", "drop_rate", "=", "0.0", ",", "drop_path_rate", "=", "0.1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.mit_b2.__init__": [[544, 549], ["mix_transformer.MixVisionTransformer.__init__", "functools.partial"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "mit_b2", ",", "self", ")", ".", "__init__", "(", "\n", "patch_size", "=", "4", ",", "embed_dims", "=", "[", "64", ",", "128", ",", "320", ",", "512", "]", ",", "num_heads", "=", "[", "1", ",", "2", ",", "5", ",", "8", "]", ",", "mlp_ratios", "=", "[", "4", ",", "4", ",", "4", ",", "4", "]", ",", "\n", "qkv_bias", "=", "True", ",", "norm_layer", "=", "partial", "(", "nn", ".", "LayerNorm", ",", "eps", "=", "1e-6", ")", ",", "depths", "=", "[", "3", ",", "4", ",", "6", ",", "3", "]", ",", "sr_ratios", "=", "[", "8", ",", "4", ",", "2", ",", "1", "]", ",", "\n", "drop_rate", "=", "0.0", ",", "drop_path_rate", "=", "0.1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.mit_b3.__init__": [[553, 558], ["mix_transformer.MixVisionTransformer.__init__", "functools.partial"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "mit_b3", ",", "self", ")", ".", "__init__", "(", "\n", "patch_size", "=", "4", ",", "embed_dims", "=", "[", "64", ",", "128", ",", "320", ",", "512", "]", ",", "num_heads", "=", "[", "1", ",", "2", ",", "5", ",", "8", "]", ",", "mlp_ratios", "=", "[", "4", ",", "4", ",", "4", ",", "4", "]", ",", "\n", "qkv_bias", "=", "True", ",", "norm_layer", "=", "partial", "(", "nn", ".", "LayerNorm", ",", "eps", "=", "1e-6", ")", ",", "depths", "=", "[", "3", ",", "4", ",", "18", ",", "3", "]", ",", "sr_ratios", "=", "[", "8", ",", "4", ",", "2", ",", "1", "]", ",", "\n", "drop_rate", "=", "0.0", ",", "drop_path_rate", "=", "0.1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.mit_b4.__init__": [[562, 567], ["mix_transformer.MixVisionTransformer.__init__", "functools.partial"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "mit_b4", ",", "self", ")", ".", "__init__", "(", "\n", "patch_size", "=", "4", ",", "embed_dims", "=", "[", "64", ",", "128", ",", "320", ",", "512", "]", ",", "num_heads", "=", "[", "1", ",", "2", ",", "5", ",", "8", "]", ",", "mlp_ratios", "=", "[", "4", ",", "4", ",", "4", ",", "4", "]", ",", "\n", "qkv_bias", "=", "True", ",", "norm_layer", "=", "partial", "(", "nn", ".", "LayerNorm", ",", "eps", "=", "1e-6", ")", ",", "depths", "=", "[", "3", ",", "8", ",", "27", ",", "3", "]", ",", "sr_ratios", "=", "[", "8", ",", "4", ",", "2", ",", "1", "]", ",", "\n", "drop_rate", "=", "0.0", ",", "drop_path_rate", "=", "0.1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.mix_transformer.mit_b5.__init__": [[571, 576], ["mix_transformer.MixVisionTransformer.__init__", "functools.partial"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "mit_b5", ",", "self", ")", ".", "__init__", "(", "\n", "patch_size", "=", "4", ",", "embed_dims", "=", "[", "64", ",", "128", ",", "320", ",", "512", "]", ",", "num_heads", "=", "[", "1", ",", "2", ",", "5", ",", "8", "]", ",", "mlp_ratios", "=", "[", "4", ",", "4", ",", "4", ",", "4", "]", ",", "\n", "qkv_bias", "=", "True", ",", "norm_layer", "=", "partial", "(", "nn", ".", "LayerNorm", ",", "eps", "=", "1e-6", ")", ",", "depths", "=", "[", "3", ",", "6", ",", "40", ",", "3", "]", ",", "sr_ratios", "=", "[", "8", ",", "4", ",", "2", ",", "1", "]", ",", "\n", "drop_rate", "=", "0.0", ",", "drop_path_rate", "=", "0.1", ")", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.MLP.__init__": [[25, 28], ["torch.Module.__init__", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "input_dim", "=", "2048", ",", "embed_dim", "=", "768", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "proj", "=", "nn", ".", "Linear", "(", "input_dim", ",", "embed_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.MLP.forward": [[29, 33], ["segformer_head.MLP.flatten().transpose", "segformer_head.MLP.proj", "segformer_head.MLP.flatten"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "x", ".", "flatten", "(", "2", ")", ".", "transpose", "(", "1", ",", "2", ")", "\n", "x", "=", "self", ".", "proj", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.SegFormerHead.__init__": [[40, 74], ["torch.Module.__init__", "segformer_head.MLP", "segformer_head.MLP", "segformer_head.MLP", "segformer_head.MLP", "mmcv.cnn.ConvModule", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "len", "len", "min", "torch.Dropout2d", "torch.Dropout2d", "torch.Dropout2d", "dict"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "feature_strides", ",", "in_channels", ",", "num_classes", ",", "in_index", ",", "dropout_ratio", ",", "\n", "input_transform", "=", "'multiple_select'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "SegFormerHead", ",", "self", ")", ".", "__init__", "(", ")", "\n", "assert", "len", "(", "feature_strides", ")", "==", "len", "(", "in_channels", ")", "\n", "assert", "min", "(", "feature_strides", ")", "==", "feature_strides", "[", "0", "]", "\n", "self", ".", "feature_strides", "=", "feature_strides", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "in_index", "=", "in_index", "\n", "self", ".", "num_classes", "=", "num_classes", "\n", "\n", "c1_in_channels", ",", "c2_in_channels", ",", "c3_in_channels", ",", "c4_in_channels", "=", "self", ".", "in_channels", "\n", "\n", "decoder_params", "=", "kwargs", "[", "'decoder_params'", "]", "\n", "embedding_dim", "=", "decoder_params", "[", "'embed_dim'", "]", "\n", "\n", "self", ".", "linear_c4", "=", "MLP", "(", "input_dim", "=", "c4_in_channels", ",", "embed_dim", "=", "embedding_dim", ")", "\n", "self", ".", "linear_c3", "=", "MLP", "(", "input_dim", "=", "c3_in_channels", ",", "embed_dim", "=", "embedding_dim", ")", "\n", "self", ".", "linear_c2", "=", "MLP", "(", "input_dim", "=", "c2_in_channels", ",", "embed_dim", "=", "embedding_dim", ")", "\n", "self", ".", "linear_c1", "=", "MLP", "(", "input_dim", "=", "c1_in_channels", ",", "embed_dim", "=", "embedding_dim", ")", "\n", "\n", "self", ".", "linear_fuse", "=", "ConvModule", "(", "\n", "in_channels", "=", "embedding_dim", "*", "4", ",", "\n", "out_channels", "=", "embedding_dim", ",", "\n", "kernel_size", "=", "1", ",", "\n", "#norm_cfg=dict(type='SyncBN', requires_grad=True)", "\n", "norm_cfg", "=", "dict", "(", "type", "=", "'BN'", ",", "requires_grad", "=", "True", ")", "\n", ")", "\n", "\n", "self", ".", "linear_pred", "=", "nn", ".", "Conv2d", "(", "embedding_dim", ",", "self", ".", "num_classes", ",", "kernel_size", "=", "1", ")", "\n", "\n", "if", "dropout_ratio", ">", "0", ":", "\n", "            ", "self", ".", "dropout", "=", "nn", ".", "Dropout2d", "(", "dropout_ratio", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "dropout", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.SegFormerHead.forward": [[75, 100], ["segformer_head.SegFormerHead.linear_c4().permute().reshape", "segformer_head.resize", "segformer_head.SegFormerHead.linear_c3().permute().reshape", "segformer_head.resize", "segformer_head.SegFormerHead.linear_c2().permute().reshape", "segformer_head.resize", "segformer_head.SegFormerHead.linear_c1().permute().reshape", "segformer_head.SegFormerHead.linear_fuse", "segformer_head.SegFormerHead.dropout", "segformer_head.SegFormerHead.linear_pred", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "segformer_head.SegFormerHead.linear_c4().permute", "segformer_head.SegFormerHead.linear_c3().permute", "segformer_head.SegFormerHead.linear_c2().permute", "segformer_head.SegFormerHead.linear_c1().permute", "c1.size", "c1.size", "c1.size", "segformer_head.SegFormerHead.linear_c4", "segformer_head.SegFormerHead.linear_c3", "segformer_head.SegFormerHead.linear_c2", "segformer_head.SegFormerHead.linear_c1"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "#x = self._transform_inputs(inputs)  # len=4, 1/4,1/8,1/16,1/32", "\n", "        ", "x", "=", "[", "inputs", "[", "i", "]", "for", "i", "in", "self", ".", "in_index", "]", "\n", "c1", ",", "c2", ",", "c3", ",", "c4", "=", "x", "\n", "\n", "############## MLP decoder on C1-C4 ###########", "\n", "n", ",", "_", ",", "h", ",", "w", "=", "c4", ".", "shape", "\n", "\n", "_c4", "=", "self", ".", "linear_c4", "(", "c4", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "reshape", "(", "n", ",", "-", "1", ",", "c4", ".", "shape", "[", "2", "]", ",", "c4", ".", "shape", "[", "3", "]", ")", "\n", "_c4", "=", "resize", "(", "_c4", ",", "size", "=", "c1", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", "\n", "\n", "_c3", "=", "self", ".", "linear_c3", "(", "c3", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "reshape", "(", "n", ",", "-", "1", ",", "c3", ".", "shape", "[", "2", "]", ",", "c3", ".", "shape", "[", "3", "]", ")", "\n", "_c3", "=", "resize", "(", "_c3", ",", "size", "=", "c1", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", "\n", "\n", "_c2", "=", "self", ".", "linear_c2", "(", "c2", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "reshape", "(", "n", ",", "-", "1", ",", "c2", ".", "shape", "[", "2", "]", ",", "c2", ".", "shape", "[", "3", "]", ")", "\n", "_c2", "=", "resize", "(", "_c2", ",", "size", "=", "c1", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", "\n", "\n", "_c1", "=", "self", ".", "linear_c1", "(", "c1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ".", "reshape", "(", "n", ",", "-", "1", ",", "c1", ".", "shape", "[", "2", "]", ",", "c1", ".", "shape", "[", "3", "]", ")", "\n", "\n", "_c", "=", "self", ".", "linear_fuse", "(", "torch", ".", "cat", "(", "[", "_c4", ",", "_c3", ",", "_c2", ",", "_c1", "]", ",", "dim", "=", "1", ")", ")", "\n", "\n", "x", "=", "self", ".", "dropout", "(", "_c", ")", "\n", "feature", "=", "x", "\n", "x", "=", "self", ".", "linear_pred", "(", "x", ")", "\n", "return", "x", ",", "feature", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize": [[102, 111], ["isinstance", "torch.interpolate", "tuple", "int"], "function", ["None"], ["", "", "def", "resize", "(", "input", ",", "\n", "size", "=", "None", ",", "\n", "scale_factor", "=", "None", ",", "\n", "mode", "=", "'nearest'", ",", "\n", "align_corners", "=", "None", ",", "\n", ")", ":", "\n", "    ", "if", "isinstance", "(", "size", ",", "torch", ".", "Size", ")", ":", "\n", "        ", "size", "=", "tuple", "(", "int", "(", "x", ")", "for", "x", "in", "size", ")", "\n", "", "return", "F", ".", "interpolate", "(", "input", ",", "size", ",", "scale_factor", ",", "mode", ",", "align_corners", ")", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_model.SegFormer.__init__": [[11, 59], ["torch.Module.__init__", "dict", "isegm.model.modeling.segformer.mix_transformer.mit_b0", "isegm.model.modeling.segformer.segformer_head.SegFormerHead", "segformer_model.SegFormer.set_prediction_mode", "dict", "isegm.model.modeling.segformer.mix_transformer.mit_b3", "isegm.model.modeling.segformer.segformer_head.SegFormerHead", "dict", "isegm.model.modeling.segformer.mix_transformer.mit_b5", "isegm.model.modeling.segformer.segformer_head.SegFormerHead"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_model.SegFormer.set_prediction_mode"], ["    ", "def", "__init__", "(", "self", ",", "backbone", "=", "'b0'", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "\n", "inference_mode", "=", "False", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "SegFormer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "backbone_name", "=", "backbone", "\n", "\n", "\n", "self", ".", "_kwargs", "=", "kwargs", "\n", "if", "backbone", "==", "'b0'", ":", "\n", "            ", "in_channels", "=", "[", "32", ",", "64", ",", "160", ",", "256", "]", "\n", "in_index", "=", "[", "0", ",", "1", ",", "2", ",", "3", "]", "\n", "feature_strides", "=", "[", "4", ",", "8", ",", "16", ",", "32", "]", "\n", "#channels=128", "\n", "dropout_ratio", "=", "0.1", "\n", "num_classes", "=", "1", "\n", "decoder_params", "=", "dict", "(", "embed_dim", "=", "256", ")", "\n", "self", ".", "backbone", "=", "mit_b0", "(", ")", "\n", "self", ".", "decode_head", "=", "SegFormerHead", "(", "feature_strides", "=", "feature_strides", ",", "in_channels", "=", "in_channels", ",", "\n", "num_classes", "=", "num_classes", ",", "in_index", "=", "in_index", ",", "dropout_ratio", "=", "dropout_ratio", ",", "\n", "decoder_params", "=", "decoder_params", ")", "\n", "", "elif", "backbone", "==", "'b3'", ":", "\n", "            ", "in_channels", "=", "[", "64", ",", "128", ",", "320", ",", "512", "]", "\n", "in_index", "=", "[", "0", ",", "1", ",", "2", ",", "3", "]", "\n", "feature_strides", "=", "[", "4", ",", "8", ",", "16", ",", "32", "]", "\n", "dropout_ratio", "=", "0.1", "\n", "num_classes", "=", "1", "\n", "decoder_params", "=", "dict", "(", "embed_dim", "=", "512", ")", "\n", "self", ".", "backbone", "=", "mit_b3", "(", ")", "\n", "self", ".", "decode_head", "=", "SegFormerHead", "(", "feature_strides", "=", "feature_strides", ",", "in_channels", "=", "in_channels", ",", "\n", "num_classes", "=", "num_classes", ",", "in_index", "=", "in_index", ",", "dropout_ratio", "=", "dropout_ratio", ",", "\n", "decoder_params", "=", "decoder_params", ")", "\n", "\n", "", "elif", "backbone", "==", "'b5'", ":", "\n", "            ", "in_channels", "=", "[", "64", ",", "128", ",", "320", ",", "512", "]", "\n", "in_index", "=", "[", "0", ",", "1", ",", "2", ",", "3", "]", "\n", "feature_strides", "=", "[", "4", ",", "8", ",", "16", ",", "32", "]", "\n", "#channels=128", "\n", "dropout_ratio", "=", "0.1", "\n", "num_classes", "=", "1", "\n", "decoder_params", "=", "dict", "(", "embed_dim", "=", "512", ")", "\n", "self", ".", "backbone", "=", "mit_b5", "(", ")", "\n", "self", ".", "decode_head", "=", "SegFormerHead", "(", "feature_strides", "=", "feature_strides", ",", "in_channels", "=", "in_channels", ",", "\n", "num_classes", "=", "num_classes", ",", "in_index", "=", "in_index", ",", "dropout_ratio", "=", "dropout_ratio", ",", "\n", "decoder_params", "=", "decoder_params", ")", "\n", "\n", "", "self", ".", "inference_mode", "=", "inference_mode", "\n", "if", "inference_mode", ":", "\n", "            ", "self", ".", "set_prediction_mode", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_model.SegFormer.load_pretrained_weights": [[60, 75], ["segformer_model.SegFormer.backbone.state_dict", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "set", "set", "print", "print", "segformer_model.SegFormer.update", "segformer_model.SegFormer.backbone.load_state_dict", "torch.load.keys", "torch.load.keys", "torch.load.keys", "segformer_model.SegFormer.keys", "segformer_model.SegFormer.backbone.parameters"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "", "def", "load_pretrained_weights", "(", "self", ",", "path_to_weights", "=", "' '", ")", ":", "\n", "        ", "backbone_state_dict", "=", "self", ".", "backbone", ".", "state_dict", "(", ")", "\n", "pretrained_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "\n", "ckpt_keys", "=", "set", "(", "pretrained_state_dict", ".", "keys", "(", ")", ")", "\n", "own_keys", "=", "set", "(", "backbone_state_dict", ".", "keys", "(", ")", ")", "\n", "missing_keys", "=", "own_keys", "-", "ckpt_keys", "\n", "unexpected_keys", "=", "ckpt_keys", "-", "own_keys", "\n", "print", "(", "'Missing Keys: '", ",", "missing_keys", ")", "\n", "print", "(", "'Unexpected Keys: '", ",", "unexpected_keys", ")", "\n", "backbone_state_dict", ".", "update", "(", "pretrained_state_dict", ")", "\n", "self", ".", "backbone", ".", "load_state_dict", "(", "backbone_state_dict", ",", "strict", "=", "False", ")", "\n", "\n", "if", "self", ".", "inference_mode", ":", "\n", "            ", "for", "param", "in", "self", ".", "backbone", ".", "parameters", "(", ")", ":", "\n", "                ", "param", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_model.SegFormer.set_prediction_mode": [[76, 79], ["segformer_model.SegFormer.eval"], "methods", ["None"], ["", "", "", "def", "set_prediction_mode", "(", "self", ")", ":", "\n", "        ", "self", ".", "inference_mode", "=", "True", "\n", "self", ".", "eval", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_model.SegFormer.forward": [[80, 88], ["contextlib.ExitStack", "segformer_model.SegFormer.backbone", "segformer_model.SegFormer.decode_head", "stack.enter_context", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "additional_features", "=", "None", ")", ":", "\n", "        ", "with", "ExitStack", "(", ")", "as", "stack", ":", "\n", "            ", "if", "self", ".", "inference_mode", ":", "\n", "                ", "stack", ".", "enter_context", "(", "torch", ".", "no_grad", "(", ")", ")", "\n", "\n", "", "features", "=", "self", ".", "backbone", "(", "x", ",", "additional_features", ")", "\n", "pred", ",", "feature", "=", "self", ".", "decode_head", "(", "features", ")", "\n", "", "return", "pred", ",", "feature", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalAffinity.__init__": [[12, 25], ["torch.Module.__init__", "PDM.LocalAffinity._init_aff", "PDM.LocalAffinity.register_buffer", "range", "decay_list.append", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalStDev._init_aff"], ["    ", "def", "__init__", "(", "self", ",", "dilations", "=", "[", "1", "]", ")", ":", "\n", "        ", "super", "(", "LocalAffinity", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "dilations", "=", "dilations", "\n", "weight", "=", "self", ".", "_init_aff", "(", ")", "\n", "self", ".", "register_buffer", "(", "'kernel'", ",", "weight", ")", "\n", "self", ".", "distance_decay", "=", "1.5", "\n", "\n", "decay_list", "=", "[", "1", "]", "\n", "decay_weight", "=", "1", "\n", "for", "i", "in", "range", "(", "len", "(", "self", ".", "dilations", ")", "-", "1", ")", ":", "\n", "            ", "decay_weight", "=", "decay_weight", "*", "self", ".", "distance_decay", "\n", "decay_list", ".", "append", "(", "decay_weight", ")", "\n", "", "self", ".", "deccay_list", "=", "decay_list", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalAffinity._init_aff": [[27, 48], ["torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "range", "torch.zeros.clone", "torch.zeros.clone", "torch.zeros.clone", "torch.zeros.size", "torch.zeros.size", "torch.zeros.size"], "methods", ["None"], ["", "def", "_init_aff", "(", "self", ")", ":", "\n", "# initialising the shift kernel", "\n", "        ", "weight", "=", "torch", ".", "zeros", "(", "8", ",", "1", ",", "3", ",", "3", ")", "\n", "\n", "for", "i", "in", "range", "(", "weight", ".", "size", "(", "0", ")", ")", ":", "\n", "            ", "weight", "[", "i", ",", "0", ",", "1", ",", "1", "]", "=", "1", "\n", "\n", "", "weight", "[", "0", ",", "0", ",", "0", ",", "0", "]", "=", "-", "1", "\n", "weight", "[", "1", ",", "0", ",", "0", ",", "1", "]", "=", "-", "1", "\n", "weight", "[", "2", ",", "0", ",", "0", ",", "2", "]", "=", "-", "1", "\n", "\n", "weight", "[", "3", ",", "0", ",", "1", ",", "0", "]", "=", "-", "1", "\n", "weight", "[", "4", ",", "0", ",", "1", ",", "2", "]", "=", "-", "1", "\n", "\n", "weight", "[", "5", ",", "0", ",", "2", ",", "0", "]", "=", "-", "1", "\n", "weight", "[", "6", ",", "0", ",", "2", ",", "1", "]", "=", "-", "1", "\n", "weight", "[", "7", ",", "0", ",", "2", ",", "2", "]", "=", "-", "1", "\n", "\n", "self", ".", "weight_check", "=", "weight", ".", "clone", "(", ")", "\n", "\n", "return", "weight", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalAffinity.forward": [[49, 65], ["PDM.LocalAffinity.weight_check.type_as", "torch.all", "torch.all", "torch.all", "torch.all", "torch.all", "torch.all", "torch.all", "torch.all", "torch.all", "x.view.view.size", "x.view.view.view", "range", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.conv2d.view", "PDM.LocalAffinity.weight_check.eq", "len", "torch.pad", "torch.pad", "torch.pad", "torch.conv2d", "torch.conv2d", "torch.conv2d", "x_affs.append"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "self", ".", "weight_check", "=", "self", ".", "weight_check", ".", "type_as", "(", "x", ")", "\n", "assert", "torch", ".", "all", "(", "self", ".", "weight_check", ".", "eq", "(", "self", ".", "kernel", ")", ")", "\n", "\n", "B", ",", "K", ",", "H", ",", "W", "=", "x", ".", "size", "(", ")", "\n", "x", "=", "x", ".", "view", "(", "B", "*", "K", ",", "1", ",", "H", ",", "W", ")", "\n", "\n", "x_affs", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "self", ".", "dilations", ")", ")", ":", "\n", "            ", "d", "=", "self", ".", "dilations", "[", "i", "]", "\n", "x_pad", "=", "F", ".", "pad", "(", "x", ",", "[", "d", "]", "*", "4", ",", "mode", "=", "'replicate'", ")", "\n", "x_aff", "=", "F", ".", "conv2d", "(", "x_pad", ",", "self", ".", "kernel", ",", "dilation", "=", "d", ")", "#* self.deccay_list[i]", "\n", "x_affs", ".", "append", "(", "x_aff", ")", "\n", "\n", "", "x_aff", "=", "torch", ".", "cat", "(", "x_affs", ",", "1", ")", "\n", "return", "x_aff", ".", "view", "(", "B", ",", "K", ",", "-", "1", ",", "H", ",", "W", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalAffinityCopy._init_aff": [[68, 85], ["torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros.clone", "torch.zeros.clone", "torch.zeros.clone"], "methods", ["None"], ["    ", "def", "_init_aff", "(", "self", ")", ":", "\n", "# initialising the shift kernel", "\n", "        ", "weight", "=", "torch", ".", "zeros", "(", "8", ",", "1", ",", "3", ",", "3", ")", "\n", "\n", "weight", "[", "0", ",", "0", ",", "0", ",", "0", "]", "=", "1", "\n", "weight", "[", "1", ",", "0", ",", "0", ",", "1", "]", "=", "1", "\n", "weight", "[", "2", ",", "0", ",", "0", ",", "2", "]", "=", "1", "\n", "\n", "weight", "[", "3", ",", "0", ",", "1", ",", "0", "]", "=", "1", "\n", "weight", "[", "4", ",", "0", ",", "1", ",", "2", "]", "=", "1", "\n", "\n", "weight", "[", "5", ",", "0", ",", "2", ",", "0", "]", "=", "1", "\n", "weight", "[", "6", ",", "0", ",", "2", ",", "1", "]", "=", "1", "\n", "weight", "[", "7", ",", "0", ",", "2", ",", "2", "]", "=", "1", "\n", "\n", "self", ".", "weight_check", "=", "weight", ".", "clone", "(", ")", "\n", "return", "weight", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalStDev._init_aff": [[88, 106], ["torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros.zero_", "torch.zeros.zero_", "torch.zeros.zero_", "torch.zeros.clone", "torch.zeros.clone", "torch.zeros.clone"], "methods", ["None"], ["    ", "def", "_init_aff", "(", "self", ")", ":", "\n", "        ", "weight", "=", "torch", ".", "zeros", "(", "9", ",", "1", ",", "3", ",", "3", ")", "\n", "weight", ".", "zero_", "(", ")", "\n", "\n", "weight", "[", "0", ",", "0", ",", "0", ",", "0", "]", "=", "1", "\n", "weight", "[", "1", ",", "0", ",", "0", ",", "1", "]", "=", "1", "\n", "weight", "[", "2", ",", "0", ",", "0", ",", "2", "]", "=", "1", "\n", "\n", "weight", "[", "3", ",", "0", ",", "1", ",", "0", "]", "=", "1", "\n", "weight", "[", "4", ",", "0", ",", "1", ",", "1", "]", "=", "1", "\n", "weight", "[", "5", ",", "0", ",", "1", ",", "2", "]", "=", "1", "\n", "\n", "weight", "[", "6", ",", "0", ",", "2", ",", "0", "]", "=", "1", "\n", "weight", "[", "7", ",", "0", ",", "2", ",", "1", "]", "=", "1", "\n", "weight", "[", "8", ",", "0", ",", "2", ",", "2", "]", "=", "1", "\n", "\n", "self", ".", "weight_check", "=", "weight", ".", "clone", "(", ")", "\n", "return", "weight", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalStDev.forward": [[107, 113], ["PDM.LocalAffinity.forward", "super().forward.std"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_losses.OracleMaskLoss.forward"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "# returns (B,K,P,H,W), where P is the number", "\n", "# of locations", "\n", "        ", "x", "=", "super", "(", "LocalStDev", ",", "self", ")", ".", "forward", "(", "x", ")", "\n", "#print(x.shape) #1,3,36,480,854", "\n", "return", "x", ".", "std", "(", "2", ",", "keepdim", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.LocalAffinityAbs.forward": [[115, 119], ["PDM.LocalAffinity.forward", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_losses.OracleMaskLoss.forward"], ["    ", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "super", "(", "LocalAffinityAbs", ",", "self", ")", ".", "forward", "(", "x", ")", "\n", "#return torch.pow(x,2)", "\n", "return", "torch", ".", "abs", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.PDM.__init__": [[124, 131], ["torch.Module.__init__", "PDM.LocalAffinityAbs", "PDM.LocalAffinityCopy", "PDM.LocalStDev"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_iter", "=", "5", ",", "dilations", "=", "[", "1", ",", "2", ",", "4", ",", "8", "]", ")", ":", "\n", "        ", "super", "(", "PDM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "num_iter", "=", "num_iter", "\n", "self", ".", "aff_x", "=", "LocalAffinityAbs", "(", "dilations", ")", "\n", "self", ".", "aff_m", "=", "LocalAffinityCopy", "(", "dilations", ")", "\n", "self", ".", "aff_std", "=", "LocalStDev", "(", "dilations", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.PDM.PDM.forward": [[132, 166], ["torch.interpolate", "torch.interpolate", "torch.interpolate", "torch.softmax.size", "torch.interpolate.size", "PDM.PDM.aff_std", "torch.softmax.mean", "torch.softmax.mean", "torch.softmax", "torch.softmax", "torch.softmax", "range", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "torch.abs", "[].unsqueeze", "PDM.PDM.aff_m", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "PDM.PDM.aff_x", "torch.softmax.size", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max", "torch.max"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "image", ",", "mask", ",", "gaussian_maps", "=", "None", ")", ":", "\n", "        ", "x", "=", "image", "\n", "mask", "=", "F", ".", "interpolate", "(", "mask", ",", "size", "=", "x", ".", "size", "(", ")", "[", "-", "2", ":", "]", ",", "mode", "=", "\"bilinear\"", ",", "align_corners", "=", "True", ")", "\n", "mask", "=", "(", "torch", ".", "sigmoid", "(", "mask", ")", "-", "0.5", ")", "*", "2", "\n", "mask_residual", "=", "mask", "\n", "\n", "fil", "=", "torch", ".", "abs", "(", "mask", ")", ">", "0.25", "\n", "mask", "=", "mask", "*", "fil", "\n", "# x: [BxKxHxW]", "\n", "# mask: [BxCxHxW]", "\n", "B", ",", "K", ",", "H", ",", "W", "=", "x", ".", "size", "(", ")", "\n", "_", ",", "C", ",", "_", ",", "_", "=", "mask", ".", "size", "(", ")", "\n", "\n", "x_std", "=", "self", ".", "aff_std", "(", "x", ")", "\n", "x", "=", "-", "self", ".", "aff_x", "(", "x", ")", "/", "(", "1e-8", "+", "0.1", "*", "x_std", ")", "\n", "x", "=", "x", ".", "mean", "(", "1", ",", "keepdim", "=", "True", ")", "\n", "thresh", "=", "x", ".", "mean", "(", ")", "\n", "fil", "=", "x", ">", "thresh", "\n", "x", "=", "F", ".", "softmax", "(", "x", ",", "2", ")", "\n", "\n", "if", "gaussian_maps", "!=", "None", ":", "\n", "            ", "pos_map", "=", "gaussian_maps", "[", ":", ",", "0", ",", ":", ",", ":", "]", "\n", "neg_map", "=", "gaussian_maps", "[", ":", ",", "1", ",", ":", ",", ":", "]", "\n", "gaussian_maps", "=", "torch", ".", "max", "(", "gaussian_maps", ",", "1", ")", "[", "0", "]", ".", "unsqueeze", "(", "1", ")", "#1,1,480,854", "\n", "\n", "", "amp", "=", "10", "\n", "mask", "=", "mask", "+", "pos_map", "*", "amp", "-", "neg_map", "*", "amp", "\n", "for", "_", "in", "range", "(", "self", ".", "num_iter", ")", ":", "\n", "            ", "m", "=", "self", ".", "aff_m", "(", "mask", ")", "# [BxCxPxHxW]", "\n", "mask", "=", "(", "m", "*", "x", ")", ".", "sum", "(", "2", ")", "\n", "", "mask", "=", "mask", "+", "mask_residual", "\n", "# xvals: [BxCxHxW]", "\n", "#print(mask.max(), mask.min())", "\n", "return", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.SpatialNL.__init__": [[12, 22], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Softmax", "torch.Softmax", "torch.Softmax", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "use_scale", "=", "False", ")", ":", "\n", "        ", "self", ".", "use_scale", "=", "use_scale", "\n", "\n", "super", "(", "SpatialNL", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "t", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "p", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "g", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "2", ")", "\n", "self", ".", "z", "=", "nn", ".", "Conv2d", "(", "planes", ",", "inplanes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.SpatialNL.forward": [[23, 52], ["FDM.SpatialNL.t", "FDM.SpatialNL.p", "FDM.SpatialNL.g", "t.view().permute.view().permute.size", "t.view().permute.view().permute.view().permute", "p.view.view.view", "g.view().permute.view().permute.view().permute", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.SpatialNL.softmax", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.SpatialNL.permute", "FDM.SpatialNL.contiguous", "FDM.SpatialNL.view", "FDM.SpatialNL.z", "att.div.div.div", "FDM.SpatialNL.bn", "t.view().permute.view().permute.view", "g.view().permute.view().permute.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "residual", "=", "x", "\n", "\n", "t", "=", "self", ".", "t", "(", "x", ")", "\n", "p", "=", "self", ".", "p", "(", "x", ")", "\n", "g", "=", "self", ".", "g", "(", "x", ")", "\n", "\n", "b", ",", "c", ",", "h", ",", "w", "=", "t", ".", "size", "(", ")", "\n", "\n", "t", "=", "t", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "p", "=", "p", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", "\n", "g", "=", "g", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "\n", "att", "=", "torch", ".", "bmm", "(", "t", ",", "p", ")", "\n", "\n", "if", "self", ".", "use_scale", ":", "\n", "            ", "att", "=", "att", ".", "div", "(", "c", "**", "0.5", ")", "\n", "\n", "", "att", "=", "self", ".", "softmax", "(", "att", ")", "\n", "x", "=", "torch", ".", "bmm", "(", "att", ",", "g", ")", "\n", "\n", "x", "=", "x", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x", "=", "x", ".", "contiguous", "(", ")", "\n", "x", "=", "x", ".", "view", "(", "b", ",", "c", ",", "h", ",", "w", ")", "\n", "\n", "x", "=", "self", ".", "z", "(", "x", ")", "\n", "x", "=", "self", ".", "bn", "(", "x", ")", "+", "residual", "\n", "\n", "return", "[", "x", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.FDM.__init__": [[56, 71], ["torch.Module.__init__", "isegm.model.modeling.basic_blocks.SepConvHead", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Softmax", "torch.Softmax", "torch.Softmax", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "use_scale", "=", "False", ",", "sigma", "=", "2", ",", "norm", "=", "False", ")", ":", "\n", "        ", "self", ".", "use_scale", "=", "use_scale", "\n", "super", "(", "FDM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gate_head_pos", "=", "SepConvHead", "(", "1", ",", "inplanes", ",", "inplanes", ")", "\n", "#self.gate_head_neg = SepConvHead(1,inplanes,inplanes)", "\n", "self", ".", "t", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "p", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "g", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "2", ")", "\n", "self", ".", "z", "=", "nn", ".", "Conv2d", "(", "planes", ",", "inplanes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "norm", "=", "norm", "\n", "self", ".", "z2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "inplanes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.FDM.forward": [[72, 123], ["FDM.FDM.t", "FDM.FDM.p", "FDM.FDM.g", "t.view().permute.view().permute.size", "t.view().permute.view().permute.view().permute", "p.view.view.view", "g.view().permute.view().permute.view().permute", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "weight_map_pos.clone().detach.clone().detach.clone().detach", "weight_map_neg.clone().detach.clone().detach.clone().detach", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "att.view.view.view", "att_pos.view.view.view", "FDM.FDM.softmax", "att_pos.view.view.view", "att_pos.view.view.view", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.FDM.permute", "FDM.FDM.contiguous", "FDM.FDM.view", "FDM.FDM.z", "att_neg.view.view.view", "FDM.FDM.softmax", "att_neg.view.view.view", "att_neg.view.view.view", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.FDM.permute", "FDM.FDM.contiguous", "FDM.FDM.view", "FDM.FDM.z2", "FDM.FDM.gate_head_pos", "gate_map_pos.permute", "gate_map_neg.permute", "FDM.FDM.bn2", "t.view().permute.view().permute.view", "g.view().permute.view().permute.view", "torch.sigmoid.clone().detach", "gate_map_neg_ori.clone().detach", "click_maps[].unsqueeze", "click_maps[].unsqueeze", "weight_map_pos.clone().detach.clone().detach.clone", "weight_map_neg.clone().detach.clone().detach.clone", "FDM.FDM.bn", "torch.sigmoid.clone", "gate_map_neg_ori.clone"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "click_maps", ")", ":", "\n", "#print(x.device, weight_map.device, weight_map.shape)", "\n", "        ", "residual", "=", "x", "\n", "t", "=", "self", ".", "t", "(", "x", ")", "\n", "p", "=", "self", ".", "p", "(", "x", ")", "\n", "g", "=", "self", ".", "g", "(", "x", ")", "\n", "b", ",", "c", ",", "h", ",", "w", "=", "t", ".", "size", "(", ")", "\n", "t", "=", "t", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "# b, hw, c", "\n", "p", "=", "p", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", "# b, c, hw", "\n", "g", "=", "g", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "# b, hw, c", "\n", "\n", "gate_map_pos_ori", "=", "F", ".", "sigmoid", "(", "self", ".", "gate_head_pos", "(", "x", ")", ")", "\n", "gate_map_neg_ori", "=", "1", "-", "gate_map_pos_ori", "\n", "\n", "gate_map_pos", "=", "gate_map_pos_ori", ".", "clone", "(", ")", ".", "detach", "(", ")", "*", "0.9", "+", "0.1", "\n", "gate_map_neg", "=", "gate_map_neg_ori", ".", "clone", "(", ")", ".", "detach", "(", ")", "*", "0.9", "+", "0.1", "\n", "\n", "weight_map_pos", "=", "click_maps", "[", ":", ",", "0", ",", ":", ",", ":", "]", ".", "unsqueeze", "(", "1", ")", "*", "0.9", "+", "0.1", "#b,1,h,w", "\n", "weight_map_neg", "=", "click_maps", "[", ":", ",", "1", ",", ":", ",", ":", "]", ".", "unsqueeze", "(", "1", ")", "*", "0.9", "+", "0.1", "\n", "weight_map_pos", "=", "weight_map_pos", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "weight_map_neg", "=", "weight_map_neg", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "\n", "att", "=", "torch", ".", "bmm", "(", "t", ",", "p", ")", "#b, hw, hw", "\n", "att", "=", "att", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", ",", "w", ")", "#b,hw,h,w", "\n", "\n", "att_pos", "=", "att", "*", "weight_map_pos", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", "*", "w", ")", "\n", "att_pos", "=", "self", ".", "softmax", "(", "att_pos", ")", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "h", ",", "w", ",", "h", "*", "w", ")", "\n", "att_pos", "=", "att_pos", "*", "gate_map_pos", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "w", "*", "h", ",", "w", "*", "h", ")", "\n", "x_pos", "=", "torch", ".", "bmm", "(", "att_pos", ",", "g", ")", "\n", "x_pos", "=", "x_pos", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_pos", "=", "x_pos", ".", "contiguous", "(", ")", "\n", "x_pos", "=", "x_pos", ".", "view", "(", "b", ",", "c", ",", "h", ",", "w", ")", "\n", "x_pos", "=", "self", ".", "z", "(", "x_pos", ")", "\n", "\n", "att_neg", "=", "att", "*", "weight_map_neg", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", "*", "w", ")", "\n", "att_neg", "=", "self", ".", "softmax", "(", "att_neg", ")", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "h", ",", "w", ",", "h", "*", "w", ")", "\n", "att_neg", "=", "att_neg", "*", "gate_map_neg", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "w", "*", "h", ",", "w", "*", "h", ")", "\n", "x_neg", "=", "torch", ".", "bmm", "(", "att_neg", ",", "g", ")", "\n", "x_neg", "=", "x_neg", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_neg", "=", "x_neg", ".", "contiguous", "(", ")", "\n", "x_neg", "=", "x_neg", ".", "view", "(", "b", ",", "c", ",", "h", ",", "w", ")", "\n", "x_neg", "=", "self", ".", "z2", "(", "x_neg", ")", "\n", "\n", "x", "=", "self", ".", "bn", "(", "x_pos", ")", "+", "residual", "+", "self", ".", "bn2", "(", "x_neg", ")", "\n", "return", "[", "x", ",", "gate_map_pos_ori", ",", "gate_map_neg_ori", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.FDM_v2.__init__": [[127, 142], ["torch.Module.__init__", "isegm.model.modeling.basic_blocks.SepConvHead", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Softmax", "torch.Softmax", "torch.Softmax", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "use_scale", "=", "False", ",", "sigma", "=", "2", ",", "norm", "=", "False", ")", ":", "\n", "        ", "self", ".", "use_scale", "=", "use_scale", "\n", "super", "(", "FDM_v2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gate_head_pos", "=", "SepConvHead", "(", "1", ",", "inplanes", ",", "inplanes", ")", "\n", "#self.gate_head_neg = SepConvHead(1,inplanes,inplanes)", "\n", "self", ".", "t", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "p", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "g", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "2", ")", "\n", "self", ".", "z", "=", "nn", ".", "Conv2d", "(", "planes", ",", "inplanes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "norm", "=", "norm", "\n", "self", ".", "z2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "inplanes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.FDM_v2.forward": [[143, 195], ["FDM.FDM_v2.t", "FDM.FDM_v2.p", "FDM.FDM_v2.g", "t.view().permute.view().permute.size", "t.view().permute.view().permute.view().permute", "p.view.view.view", "g.view().permute.view().permute.view().permute", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid.clone().detach", "gate_map_neg_ori.clone().detach", "click_maps[].unsqueeze", "weight_map_pos.clone().detach.clone().detach.clone().detach", "weight_map_neg.clone().detach.clone().detach.clone().detach", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "att.view.view.view", "att_pos.view.view.view", "FDM.FDM_v2.softmax", "att_pos.view.view.view", "att_pos.view.view.view", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.FDM_v2.permute", "FDM.FDM_v2.contiguous", "FDM.FDM_v2.view", "FDM.FDM_v2.z", "att_neg.view.view.view", "FDM.FDM_v2.softmax", "att_neg.view.view.view", "att_neg.view.view.view", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.FDM_v2.permute", "FDM.FDM_v2.contiguous", "FDM.FDM_v2.view", "FDM.FDM_v2.z2", "FDM.FDM_v2.gate_head_pos", "F.sigmoid.clone().detach.permute", "gate_map_neg_ori.clone().detach.permute", "FDM.FDM_v2.bn2", "t.view().permute.view().permute.view", "g.view().permute.view().permute.view", "torch.sigmoid.clone", "gate_map_neg_ori.clone", "click_maps[].unsqueeze", "weight_map_pos.clone().detach.clone().detach.clone", "weight_map_neg.clone().detach.clone().detach.clone", "FDM.FDM_v2.bn"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "click_maps", ")", ":", "\n", "#print(x.device, weight_map.device, weight_map.shape)", "\n", "        ", "residual", "=", "x", "\n", "t", "=", "self", ".", "t", "(", "x", ")", "\n", "p", "=", "self", ".", "p", "(", "x", ")", "\n", "g", "=", "self", ".", "g", "(", "x", ")", "\n", "b", ",", "c", ",", "h", ",", "w", "=", "t", ".", "size", "(", ")", "\n", "t", "=", "t", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "# b, hw, c", "\n", "p", "=", "p", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", "# b, c, hw", "\n", "g", "=", "g", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "# b, hw, c", "\n", "\n", "gate_map_pos_ori", "=", "F", ".", "sigmoid", "(", "self", ".", "gate_head_pos", "(", "x", ")", ")", "\n", "gate_map_neg_ori", "=", "1", "-", "gate_map_pos_ori", "\n", "\n", "gate_map_pos", "=", "gate_map_pos_ori", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "gate_map_neg", "=", "gate_map_neg_ori", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "\n", "weight_map_pos", "=", "click_maps", "[", ":", ",", "0", ",", ":", ",", ":", "]", ".", "unsqueeze", "(", "1", ")", "\n", "weight_map_neg", "=", "click_maps", "[", ":", ",", "1", ",", ":", ",", ":", "]", ".", "unsqueeze", "(", "1", ")", "*", "0.5", "+", "gate_map_neg", "*", "0.5", "\n", "\n", "weight_map_pos", "=", "weight_map_pos", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "weight_map_neg", "=", "weight_map_neg", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "\n", "att", "=", "torch", ".", "bmm", "(", "t", ",", "p", ")", "#b, hw, hw", "\n", "att", "=", "att", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", ",", "w", ")", "#b,hw,h,w", "\n", "\n", "att_pos", "=", "att", "*", "weight_map_pos", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", "*", "w", ")", "\n", "att_pos", "=", "self", ".", "softmax", "(", "att_pos", ")", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "h", ",", "w", ",", "h", "*", "w", ")", "\n", "att_pos", "=", "att_pos", "*", "gate_map_pos", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "w", "*", "h", ",", "w", "*", "h", ")", "\n", "x_pos", "=", "torch", ".", "bmm", "(", "att_pos", ",", "g", ")", "\n", "x_pos", "=", "x_pos", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_pos", "=", "x_pos", ".", "contiguous", "(", ")", "\n", "x_pos", "=", "x_pos", ".", "view", "(", "b", ",", "c", ",", "h", ",", "w", ")", "\n", "x_pos", "=", "self", ".", "z", "(", "x_pos", ")", "\n", "\n", "att_neg", "=", "att", "*", "weight_map_neg", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", "*", "w", ")", "\n", "att_neg", "=", "self", ".", "softmax", "(", "att_neg", ")", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "h", ",", "w", ",", "h", "*", "w", ")", "\n", "att_neg", "=", "att_neg", "*", "gate_map_neg", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "w", "*", "h", ",", "w", "*", "h", ")", "\n", "x_neg", "=", "torch", ".", "bmm", "(", "att_neg", ",", "g", ")", "\n", "x_neg", "=", "x_neg", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_neg", "=", "x_neg", ".", "contiguous", "(", ")", "\n", "x_neg", "=", "x_neg", ".", "view", "(", "b", ",", "c", ",", "h", ",", "w", ")", "\n", "x_neg", "=", "self", ".", "z2", "(", "x_neg", ")", "\n", "\n", "x", "=", "self", ".", "bn", "(", "x_pos", ")", "+", "residual", "+", "self", ".", "bn2", "(", "x_neg", ")", "\n", "return", "[", "x", ",", "gate_map_pos_ori", ",", "gate_map_neg_ori", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.FDM_v3.__init__": [[200, 215], ["torch.Module.__init__", "isegm.model.modeling.basic_blocks.SepConvHead", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Softmax", "torch.Softmax", "torch.Softmax", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "inplanes", ",", "planes", ",", "use_scale", "=", "False", ",", "sigma", "=", "2", ",", "norm", "=", "False", ")", ":", "\n", "        ", "self", ".", "use_scale", "=", "use_scale", "\n", "super", "(", "FDM_v3", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gate_head_pos", "=", "SepConvHead", "(", "1", ",", "inplanes", ",", "inplanes", ")", "\n", "#self.gate_head_neg = SepConvHead(1,inplanes,inplanes)", "\n", "self", ".", "t", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "p", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "g", "=", "nn", ".", "Conv2d", "(", "inplanes", ",", "planes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "2", ")", "\n", "self", ".", "z", "=", "nn", ".", "Conv2d", "(", "planes", ",", "inplanes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "self", ".", "sigma", "=", "sigma", "\n", "self", ".", "norm", "=", "norm", "\n", "self", ".", "z2", "=", "nn", ".", "Conv2d", "(", "planes", ",", "inplanes", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn2", "=", "nn", ".", "BatchNorm2d", "(", "inplanes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.FDM.FDM_v3.forward": [[216, 268], ["FDM.FDM_v3.t", "FDM.FDM_v3.p", "FDM.FDM_v3.g", "t.view().permute.view().permute.size", "t.view().permute.view().permute.view().permute", "p.view.view.view", "g.view().permute.view().permute.view().permute", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid.clone().detach", "gate_map_neg_ori.clone().detach", "weight_map_pos.clone().detach.clone().detach.clone().detach", "weight_map_neg.clone().detach.clone().detach.clone().detach", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "att.view.view.view", "att_pos.view.view.view", "FDM.FDM_v3.softmax", "att_pos.view.view.view", "att_pos.view.view.view", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.FDM_v3.permute", "FDM.FDM_v3.contiguous", "FDM.FDM_v3.view", "FDM.FDM_v3.z", "att_neg.view.view.view", "FDM.FDM_v3.softmax", "att_neg.view.view.view", "att_neg.view.view.view", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "torch.bmm", "FDM.FDM_v3.permute", "FDM.FDM_v3.contiguous", "FDM.FDM_v3.view", "FDM.FDM_v3.z2", "FDM.FDM_v3.gate_head_pos", "click_maps[].unsqueeze", "click_maps[].unsqueeze", "F.sigmoid.clone().detach.permute", "gate_map_neg_ori.clone().detach.permute", "FDM.FDM_v3.bn2", "t.view().permute.view().permute.view", "g.view().permute.view().permute.view", "torch.sigmoid.clone", "gate_map_neg_ori.clone", "weight_map_pos.clone().detach.clone().detach.clone", "weight_map_neg.clone().detach.clone().detach.clone", "FDM.FDM_v3.bn"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "click_maps", ")", ":", "\n", "#print(x.device, weight_map.device, weight_map.shape)", "\n", "        ", "residual", "=", "x", "\n", "t", "=", "self", ".", "t", "(", "x", ")", "\n", "p", "=", "self", ".", "p", "(", "x", ")", "\n", "g", "=", "self", ".", "g", "(", "x", ")", "\n", "b", ",", "c", ",", "h", ",", "w", "=", "t", ".", "size", "(", ")", "\n", "t", "=", "t", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "# b, hw, c", "\n", "p", "=", "p", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", "# b, c, hw", "\n", "g", "=", "g", ".", "view", "(", "b", ",", "c", ",", "-", "1", ")", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "# b, hw, c", "\n", "\n", "gate_map_pos_ori", "=", "F", ".", "sigmoid", "(", "self", ".", "gate_head_pos", "(", "x", ")", ")", "\n", "gate_map_neg_ori", "=", "1", "-", "gate_map_pos_ori", "\n", "\n", "gate_map_pos", "=", "gate_map_pos_ori", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "gate_map_neg", "=", "gate_map_neg_ori", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "\n", "weight_map_pos", "=", "click_maps", "[", ":", ",", "0", ",", ":", ",", ":", "]", ".", "unsqueeze", "(", "1", ")", "+", "(", "gate_map_pos", ">", "0.8", ")", "*", "1.0", "\n", "weight_map_neg", "=", "click_maps", "[", ":", ",", "1", ",", ":", ",", ":", "]", ".", "unsqueeze", "(", "1", ")", "+", "(", "gate_map_neg", ">", "0.8", ")", "*", "1.0", "\n", "\n", "weight_map_pos", "=", "weight_map_pos", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "weight_map_neg", "=", "weight_map_neg", ".", "clone", "(", ")", ".", "detach", "(", ")", "\n", "\n", "att", "=", "torch", ".", "bmm", "(", "t", ",", "p", ")", "#b, hw, hw", "\n", "att", "=", "att", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", ",", "w", ")", "#b,hw,h,w", "\n", "\n", "att_pos", "=", "att", "*", "weight_map_pos", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", "*", "w", ")", "\n", "att_pos", "=", "self", ".", "softmax", "(", "att_pos", ")", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "h", ",", "w", ",", "h", "*", "w", ")", "\n", "att_pos", "=", "att_pos", "*", "gate_map_pos", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "att_pos", "=", "att_pos", ".", "view", "(", "b", ",", "w", "*", "h", ",", "w", "*", "h", ")", "\n", "x_pos", "=", "torch", ".", "bmm", "(", "att_pos", ",", "g", ")", "\n", "x_pos", "=", "x_pos", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_pos", "=", "x_pos", ".", "contiguous", "(", ")", "\n", "x_pos", "=", "x_pos", ".", "view", "(", "b", ",", "c", ",", "h", ",", "w", ")", "\n", "x_pos", "=", "self", ".", "z", "(", "x_pos", ")", "\n", "\n", "att_neg", "=", "att", "*", "weight_map_neg", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "h", "*", "w", ",", "h", "*", "w", ")", "\n", "att_neg", "=", "self", ".", "softmax", "(", "att_neg", ")", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "h", ",", "w", ",", "h", "*", "w", ")", "\n", "att_neg", "=", "att_neg", "*", "gate_map_neg", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "att_neg", "=", "att_neg", ".", "view", "(", "b", ",", "w", "*", "h", ",", "w", "*", "h", ")", "\n", "x_neg", "=", "torch", ".", "bmm", "(", "att_neg", ",", "g", ")", "\n", "x_neg", "=", "x_neg", ".", "permute", "(", "0", ",", "2", ",", "1", ")", "\n", "x_neg", "=", "x_neg", ".", "contiguous", "(", ")", "\n", "x_neg", "=", "x_neg", ".", "view", "(", "b", ",", "c", ",", "h", ",", "w", ")", "\n", "x_neg", "=", "self", ".", "z2", "(", "x_neg", ")", "\n", "\n", "x", "=", "self", ".", "bn", "(", "x_pos", ")", "+", "residual", "+", "self", ".", "bn2", "(", "x_neg", ")", "\n", "return", "[", "x", ",", "gate_map_pos_ori", ",", "gate_map_neg_ori", "]", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.cdnet_res34_sbd.main": [[10, 13], ["cdnet_res34_sbd.init_model", "cdnet_res34_sbd.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.cdnet_res34_sbd.init_model": [[15, 25], ["edict", "DeeplabModel", "DeeplabModel.to", "DeeplabModel.apply", "DeeplabModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "384", ",", "384", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "DeeplabModel", "(", "backbone", "=", "'resnet34'", ",", "deeplab_ch", "=", "128", ",", "aspp_dropout", "=", "0.20", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "with_prev_mask", "=", "False", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.cdnet_res34_sbd.train": [[27, 100], ["edict", "NormalizedFocalLossSigmoid", "NormalizedFocalLossSigmoid", "DiversityLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "SBDDataset", "CocoLvisDataset", "partial", "isegm.engine.cdnet_trainer.ISTrainer", "isegm.engine.cdnet_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1", "\n", "loss_cfg", ".", "fdm_instances_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "from_sigmoid", "=", "True", ")", "#SigmoidBinaryCrossEntropyLoss(from_sigmoid=True)", "\n", "loss_cfg", ".", "fdm_instances_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "diversity_loss", "=", "DiversityLoss", "(", ")", "\n", "loss_cfg", ".", "diversity_loss_weight", "=", "1", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "color_augmentator", "\n", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset", "=", "SBDDataset", "(", "\n", "cfg", ".", "SBD_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "80", ",", "\n", "keep_background_prob", "=", "0.0", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "samples_scores_path", "=", "'./assets/sbd_samples_weights.pkl'", ",", "\n", "samples_scores_gamma", "=", "1.25", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", ",", "\n", "with_refiner", "=", "False", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "80", ",", "105", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "100", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "0", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "120", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.cdnet_res34_cclvs.main": [[10, 13], ["cdnet_res34_cclvs.init_model", "cdnet_res34_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.cdnet_res34_cclvs.init_model": [[15, 25], ["edict", "DeeplabModel", "DeeplabModel.to", "DeeplabModel.apply", "DeeplabModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "384", ",", "384", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "DeeplabModel", "(", "backbone", "=", "'resnet34'", ",", "deeplab_ch", "=", "128", ",", "aspp_dropout", "=", "0.20", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "with_prev_mask", "=", "False", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.cdnet.cdnet_res34_cclvs.train": [[27, 94], ["edict", "NormalizedFocalLossSigmoid", "NormalizedFocalLossSigmoid", "DiversityLoss", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.cdnet_trainer.ISTrainer", "isegm.engine.cdnet_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1", "\n", "loss_cfg", ".", "fdm_instances_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "from_sigmoid", "=", "True", ")", "#SigmoidBinaryCrossEntropyLoss(from_sigmoid=True)", "\n", "loss_cfg", ".", "fdm_instances_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "diversity_loss", "=", "DiversityLoss", "(", ")", "\n", "loss_cfg", ".", "diversity_loss_weight", "=", "1", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.20", ",", "\n", "with_refiner", "=", "False", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", ",", "\n", "with_refiner", "=", "False", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "80", ",", "105", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "100", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "0", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "120", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.segmentator.LRASPP.__init__": [[14, 25], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "LRASPP", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "b0", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", "True", ")", "\n", ")", "\n", "self", ".", "b1", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "(", "2", ",", "2", ")", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.segmentator.LRASPP.forward": [[27, 34], ["segmentator.LRASPP.b0", "segmentator.LRASPP.b1", "torch.interpolate", "torch.interpolate", "torch.interpolate", "x.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "size", "=", "x", ".", "size", "(", ")", "[", "2", ":", "]", "\n", "feat1", "=", "self", ".", "b0", "(", "x", ")", "\n", "feat2", "=", "self", ".", "b1", "(", "x", ")", "\n", "feat2", "=", "F", ".", "interpolate", "(", "feat2", ",", "size", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x", "=", "feat1", "*", "feat2", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.segmentator.PPLCSeg.__init__": [[38, 46], ["torch.Module.__init__", "isegm.model.modeling.ppclnet.backbone.PPLCNet_x1_0", "segmentator.LRASPP", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x1_0"], ["    ", "def", "__init__", "(", "self", ",", "nclass", "=", "1", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "EfficientSeg", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "backbone", "=", "efficientnet_b0", "(", ")", "\n", "self", ".", "lraspp", "=", "LRASPP", "(", "320", ",", "128", ")", "\n", "self", ".", "fusion_conv1", "=", "nn", ".", "Conv2d", "(", "128", ",", "16", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "fusion_conv2", "=", "nn", ".", "Conv2d", "(", "24", ",", "16", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "head", "=", "nn", ".", "Conv2d", "(", "16", ",", "nclass", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "aux_head", "=", "nn", ".", "Conv2d", "(", "16", ",", "nclass", ",", "1", ",", "1", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.segmentator.PPLCSeg.forward": [[48, 59], ["segmentator.PPLCSeg.backbone", "segmentator.PPLCSeg.lraspp", "torch.interpolate", "torch.interpolate", "torch.interpolate", "segmentator.PPLCSeg.fusion_conv1", "segmentator.PPLCSeg.aux_head", "segmentator.PPLCSeg.fusion_conv2", "segmentator.PPLCSeg.head", "segmentator.PPLCSeg.size"], "methods", ["None"], ["        ", "x4", ",", "_", ",", "_", ",", "x8", "=", "self", ".", "backbone", "(", "x", ",", "side_feature", ")", "\n", "x8", "=", "self", ".", "lraspp", "(", "x8", ")", "\n", "x8", "=", "F", ".", "interpolate", "(", "x8", ",", "x4", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x8", "=", "self", ".", "fusion_conv1", "(", "x8", ")", "\n", "pred_aux", "=", "self", ".", "aux_head", "(", "x8", ")", "\n", "\n", "x4", "=", "self", ".", "fusion_conv2", "(", "x4", ")", "\n", "x", "=", "x4", "+", "x8", "\n", "pred", "=", "self", ".", "head", "(", "x", ")", "\n", "return", "pred", ",", "pred_aux", ",", "x", "\n", "\n", "", "def", "load_pretrained_weights", "(", "self", ",", "path_to_weights", "=", "' '", ")", ":", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.segmentator.PPLCSeg.load_pretrained_weights": [[60, 72], ["segmentator.PPLCSeg.backbone.state_dict", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "set", "set", "print", "print", "print", "segmentator.PPLCSeg.update", "segmentator.PPLCSeg.backbone.load_state_dict", "torch.load.keys", "torch.load.keys", "torch.load.keys", "segmentator.PPLCSeg.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["        ", "backbone_state_dict", "=", "self", ".", "backbone", ".", "state_dict", "(", ")", "\n", "pretrained_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "\n", "ckpt_keys", "=", "set", "(", "pretrained_state_dict", ".", "keys", "(", ")", ")", "\n", "own_keys", "=", "set", "(", "backbone_state_dict", ".", "keys", "(", ")", ")", "\n", "missing_keys", "=", "own_keys", "-", "ckpt_keys", "\n", "unexpected_keys", "=", "ckpt_keys", "-", "own_keys", "\n", "print", "(", "'Loading Efficientnet'", ")", "\n", "print", "(", "'Missing Keys: '", ",", "missing_keys", ")", "\n", "print", "(", "'Unexpected Keys: '", ",", "unexpected_keys", ")", "\n", "backbone_state_dict", ".", "update", "(", "pretrained_state_dict", ")", "\n", "self", ".", "backbone", ".", "load_state_dict", "(", "backbone_state_dict", ",", "strict", "=", "False", ")", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.Hardswish.__init__": [[51, 54], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["        ", "super", "(", "MBConvBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "assert", "stride", "in", "[", "1", ",", "2", "]", "\n", "self", ".", "use_res_connect", "=", "stride", "==", "1", "and", "in_channels", "==", "out_channels", "\n", "self", ".", "drop_connect_rate", "=", "drop_connect_rate", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.Hardswish.forward": [[55, 57], ["torch.relu6", "torch.relu6", "torch.relu6"], "methods", ["None"], ["use_se", "=", "(", "se_ratio", "is", "not", "None", ")", "and", "(", "0", "<", "se_ratio", "<=", "1.", ")", "\n", "if", "use_se", ":", "\n", "            ", "SELayer", "=", "SEModuleV2", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.Hardsigmoid.__init__": [[59, 62], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["            ", "SELayer", "=", "Identity", "\n", "\n", "", "layers", "=", "list", "(", ")", "\n", "inter_channels", "=", "int", "(", "round", "(", "in_channels", "*", "expand_ratio", ")", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.Hardsigmoid.forward": [[63, 65], ["torch.relu6", "torch.relu6", "torch.relu6"], "methods", ["None"], ["if", "expand_ratio", "!=", "1", ":", "\n", "            ", "layers", ".", "append", "(", "_ConvBNHswish", "(", "in_channels", ",", "inter_channels", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "", "layers", ".", "extend", "(", "[", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.ConvBNLayer.__init__": [[67, 88], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "backbone.Hardswish"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["_ConvBNHswish", "(", "inter_channels", ",", "inter_channels", ",", "kernel_size", ",", "stride", ",", "kernel_size", "//", "2", "*", "dilation", ",", "dilation", ",", "\n", "groups", "=", "inter_channels", ",", "norm_layer", "=", "norm_layer", ")", ",", "# check act function", "\n", "SELayer", "(", "inter_channels", ",", "se_ratio", ")", ",", "\n", "# pw-linear", "\n", "nn", ".", "Conv2d", "(", "inter_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", "\n", "]", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n", "if", "drop_connect_rate", ":", "\n", "            ", "self", ".", "dropout", "=", "nn", ".", "Dropout2d", "(", "drop_connect_rate", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv", "(", "x", ")", "\n", "if", "self", ".", "use_res_connect", ":", "\n", "            ", "if", "self", ".", "drop_connect_rate", ":", "\n", "                ", "out", "=", "self", ".", "dropout", "(", "out", ")", "\n", "", "out", "=", "x", "+", "out", "\n", "", "return", "out", "\n", "\n", "", "", "class", "_ConvBNHswish", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.ConvBNLayer.forward": [[89, 94], ["backbone.ConvBNLayer.conv", "backbone.ConvBNLayer.bn", "backbone.ConvBNLayer.hardswish"], "methods", ["None"], ["dilation", "=", "1", ",", "groups", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "_ConvBNHswish", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "padding", ",", "dilation", ",", "groups", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "norm_layer", "(", "out_channels", ")", "\n", "self", ".", "act", "=", "_Hswish", "(", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.DepthwiseSeparable.__init__": [[97, 118], ["torch.Module.__init__", "backbone.ConvBNLayer", "backbone.ConvBNLayer", "backbone.SEModule"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["x", "=", "self", ".", "bn", "(", "x", ")", "\n", "x", "=", "self", ".", "act", "(", "x", ")", "\n", "return", "x", "\n", "\n", "\n", "", "", "class", "EfficientNet", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "width_coe", ",", "depth_coe", ",", "depth_divisor", "=", "8", ",", "min_depth", "=", "None", ",", "dropout_rate", "=", "0.2", ",", "\n", "drop_connect_rate", "=", "0.2", ",", "num_classes", "=", "1000", ",", "dilated", "=", "True", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "EfficientNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "width_coe", "=", "width_coe", "\n", "self", ".", "depth_coe", "=", "depth_coe", "\n", "self", ".", "depth_divisor", "=", "depth_divisor", "\n", "self", ".", "min_depth", "=", "min_depth", "\n", "self", ".", "dropout_rate", "=", "dropout_rate", "\n", "self", ".", "drop_connect_rate", "=", "drop_connect_rate", "# not use", "\n", "\n", "layer1_setting", "=", "[", "\n", "# k, c, n, s, t", "\n", "[", "3", ",", "16", ",", "1", ",", "1", ",", "1", "]", "]", "\n", "layer2_setting", "=", "[", "\n", "[", "3", ",", "24", ",", "2", ",", "2", ",", "6", "]", "]", "#4", "\n", "layer3_setting", "=", "[", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.DepthwiseSeparable.forward": [[119, 125], ["backbone.DepthwiseSeparable.dw_conv", "backbone.DepthwiseSeparable.pw_conv", "backbone.DepthwiseSeparable.se"], "methods", ["None"], ["[", "5", ",", "40", ",", "2", ",", "2", ",", "6", "]", ",", "\n", "[", "3", ",", "80", ",", "3", ",", "1", ",", "6", "]", "]", "#8", "\n", "layer4_setting", "=", "[", "\n", "[", "5", ",", "112", ",", "3", ",", "2", ",", "6", "]", "]", "\n", "layer5_setting", "=", "[", "\n", "[", "5", ",", "192", ",", "4", ",", "2", ",", "6", "]", "]", "\n", "layer6_setting", "=", "[", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.SEModule.__init__": [[128, 145], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "backbone.Hardsigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["# building first layer", "\n", "self", ".", "in_channels", "=", "self", ".", "round_filter", "(", "32", ",", "width_coe", ",", "depth_divisor", ",", "min_depth", ")", "\n", "self", ".", "conv1", "=", "_ConvBNHswish", "(", "3", ",", "self", ".", "in_channels", ",", "3", ",", "2", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", "# diff from origin", "\n", "\n", "# building MBConvBlocks", "\n", "self", ".", "layer1", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer1_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer2", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer2_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer3", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer3_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "if", "dilated", ":", "\n", "            ", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer4_setting", ",", "2", ",", "norm_layer", ")", "\n", "self", ".", "layer5", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer5_setting", ",", "2", ",", "norm_layer", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "layer4", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer4_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "layer5", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer5_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "", "self", ".", "layer6", "=", "self", ".", "_make_layer", "(", "MBConvBlock", ",", "layer6_setting", ",", "norm_layer", "=", "norm_layer", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.SEModule.forward": [[146, 155], ["backbone.SEModule.avg_pool", "backbone.SEModule.conv1", "backbone.SEModule.relu", "backbone.SEModule.conv2", "backbone.SEModule.hardsigmoid", "torch.mul", "torch.mul", "torch.mul", "torch.mul", "torch.mul", "torch.mul", "torch.mul", "torch.mul", "torch.mul"], "methods", ["None"], ["\n", "\n", "", "def", "_make_layer", "(", "self", ",", "block", ",", "block_setting", ",", "dilation", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet.__init__": [[158, 238], ["torch.Module.__init__", "backbone.ConvBNLayer", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "backbone.Hardswish", "torch.Dropout", "torch.Dropout", "torch.Dropout", "torch.Flatten", "torch.Flatten", "torch.Flatten", "torch.Linear", "torch.Linear", "torch.Linear", "backbone.make_divisible", "backbone.make_divisible", "backbone.DepthwiseSeparable", "backbone.DepthwiseSeparable", "backbone.DepthwiseSeparable", "backbone.DepthwiseSeparable", "backbone.DepthwiseSeparable", "enumerate", "enumerate", "enumerate", "enumerate", "enumerate", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible", "backbone.make_divisible"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible"], ["for", "k", ",", "c", ",", "n", ",", "s", ",", "t", "in", "block_setting", ":", "\n", "            ", "out_channels", "=", "self", ".", "round_filter", "(", "c", ",", "self", ".", "width_coe", ",", "self", ".", "depth_divisor", ",", "self", ".", "min_depth", ")", "\n", "stride", "=", "s", "if", "dilation", "==", "1", "else", "1", "\n", "layers", ".", "append", "(", "block", "(", "self", ".", "in_channels", ",", "out_channels", ",", "k", ",", "stride", ",", "t", ",", "dilation", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "self", ".", "in_channels", "=", "out_channels", "\n", "for", "i", "in", "range", "(", "n", "-", "1", ")", ":", "\n", "                ", "layers", ".", "append", "(", "block", "(", "self", ".", "in_channels", ",", "out_channels", ",", "k", ",", "1", ",", "t", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "self", ".", "in_channels", "=", "out_channels", "\n", "", "", "return", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n", "", "@", "classmethod", "\n", "def", "round_filter", "(", "cls", ",", "filters", ",", "width_coe", ",", "depth_divisor", ",", "min_depth", ")", ":", "\n", "        ", "if", "not", "width_coe", ":", "\n", "            ", "return", "filters", "\n", "", "filters", "*=", "width_coe", "\n", "min_depth", "=", "min_depth", "or", "depth_divisor", "\n", "new_filter", "=", "max", "(", "min_depth", ",", "int", "(", "filters", "+", "depth_divisor", "/", "2", ")", "//", "depth_divisor", "*", "depth_divisor", ")", "\n", "if", "new_filter", "<", "0.9", "*", "filters", ":", "# prevent rounding by more than 10%", "\n", "            ", "new_filter", "+=", "depth_divisor", "\n", "", "return", "int", "(", "new_filter", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "x", ",", "side_feature", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x", "=", "x", "+", "side_feature", "\n", "x", "=", "self", ".", "layer1", "(", "x", ")", "\n", "x", "=", "self", ".", "layer2", "(", "x", ")", "\n", "x4", "=", "x", "\n", "x", "=", "self", ".", "layer3", "(", "x", ")", "\n", "x", "=", "self", ".", "layer4", "(", "x", ")", "\n", "x", "=", "self", ".", "layer5", "(", "x", ")", "\n", "x", "=", "self", ".", "layer6", "(", "x", ")", "\n", "x8", "=", "x", "\n", "return", "x4", ",", "x8", "\n", "\n", "\n", "", "", "def", "get_efficientnet", "(", "params", ",", "pretrained", "=", "False", ",", "root", "=", "'~/,torch/models'", ",", "**", "kwargs", ")", ":", "\n", "    ", "w", ",", "d", ",", "_", ",", "p", "=", "params", "\n", "model", "=", "EfficientNet", "(", "w", ",", "d", ",", "dropout_rate", "=", "p", ",", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "raise", "ValueError", "(", "\"Not support pretrained\"", ")", "\n", "", "return", "model", "\n", "\n", "\n", "", "def", "efficientnet_b0", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.0", ",", "1.0", ",", "224", ",", "0.2", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "def", "efficientnet_b1", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.0", ",", "1.1", ",", "240", ",", "0.2", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "def", "efficientnet_b2", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.1", ",", "1.2", ",", "260", ",", "0.3", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "def", "efficientnet_b3", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.2", ",", "1.4", ",", "300", ",", "0.3", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "def", "efficientnet_b4", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.4", ",", "1.8", ",", "380", ",", "0.4", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "def", "efficientnet_b5", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.6", ",", "2.2", ",", "456", ",", "0.4", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "def", "efficientnet_b6", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "1.8", ",", "2.6", ",", "528", ",", "0.5", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "def", "efficientnet_b7", "(", "**", "kwargs", ")", ":", "\n", "    ", "return", "get_efficientnet", "(", "[", "2.0", ",", "3.1", ",", "600", ",", "0.5", "]", ",", "**", "kwargs", ")", "\n", "\n", "\n", "", "if", "__name__", "==", "'__main__'", ":", "\n", "    ", "model", "=", "efficientnet_b7", "(", ")", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet.forward": [[239, 259], ["backbone.PPLCNet.conv1", "backbone.PPLCNet.blocks2", "backbone.PPLCNet.blocks3", "backbone.PPLCNet.blocks4", "backbone.PPLCNet.blocks5", "backbone.PPLCNet.blocks6"], "methods", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.make_divisible": [[42, 49], ["max", "int"], "function", ["None"], ["        ", "n", ",", "c", ",", "_", ",", "_", "=", "x", ".", "size", "(", ")", "\n", "out", "=", "self", ".", "avg_pool", "(", "x", ")", "\n", "out", "=", "self", ".", "fc", "(", "out", ")", "\n", "return", "x", "*", "out", ".", "expand_as", "(", "x", ")", "\n", "\n", "\n", "", "", "class", "MBConvBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "expand_ratio", ",", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x0_25": [[261, 268], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x0_35": [[270, 277], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x0_5": [[279, 286], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x0_75": [[288, 295], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x1_0": [[297, 304], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x1_5": [[306, 313], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x2_0": [[315, 322], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.ppclnet.backbone.PPLCNet_x2_5": [[324, 331], ["backbone.PPLCNet"], "function", ["None"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone._ConvBNReLU.__init__": [[14, 20], ["torch.Module.__init__", "torch.Conv2d", "norm_layer", "torch.ReLU6", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "\n", "dilation", "=", "1", ",", "groups", "=", "1", ",", "relu6", "=", "False", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "_ConvBNReLU", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "padding", ",", "dilation", ",", "groups", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "norm_layer", "(", "out_channels", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU6", "(", "True", ")", "if", "relu6", "else", "nn", ".", "ReLU", "(", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone._ConvBNReLU.forward": [[21, 26], ["mobilenetv2_backbone._ConvBNReLU.conv", "mobilenetv2_backbone._ConvBNReLU.bn", "mobilenetv2_backbone._ConvBNReLU.relu"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv", "(", "x", ")", "\n", "x", "=", "self", ".", "bn", "(", "x", ")", "\n", "x", "=", "self", ".", "relu", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone._DepthwiseConv.__init__": [[30, 35], ["torch.Module.__init__", "torch.Sequential", "mobilenetv2_backbone._ConvBNReLU", "mobilenetv2_backbone._ConvBNReLU"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "stride", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "_DepthwiseConv", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Sequential", "(", "\n", "_ConvBNReLU", "(", "in_channels", ",", "in_channels", ",", "3", ",", "stride", ",", "1", ",", "groups", "=", "in_channels", ",", "norm_layer", "=", "norm_layer", ")", ",", "\n", "_ConvBNReLU", "(", "in_channels", ",", "out_channels", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone._DepthwiseConv.forward": [[36, 38], ["mobilenetv2_backbone._DepthwiseConv.conv"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "conv", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.InvertedResidual.__init__": [[41, 59], ["torch.Module.__init__", "list", "int", "list.extend", "torch.Sequential", "round", "list.append", "mobilenetv2_backbone._ConvBNReLU", "mobilenetv2_backbone._ConvBNReLU", "torch.Conv2d", "norm_layer"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "stride", ",", "expand_ratio", ",", "dilation", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "InvertedResidual", ",", "self", ")", ".", "__init__", "(", ")", "\n", "assert", "stride", "in", "[", "1", ",", "2", "]", "\n", "self", ".", "use_res_connect", "=", "stride", "==", "1", "and", "in_channels", "==", "out_channels", "\n", "\n", "layers", "=", "list", "(", ")", "\n", "inter_channels", "=", "int", "(", "round", "(", "in_channels", "*", "expand_ratio", ")", ")", "\n", "if", "expand_ratio", "!=", "1", ":", "\n", "# pw", "\n", "            ", "layers", ".", "append", "(", "_ConvBNReLU", "(", "in_channels", ",", "inter_channels", ",", "1", ",", "relu6", "=", "True", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "", "layers", ".", "extend", "(", "[", "\n", "# dw", "\n", "_ConvBNReLU", "(", "inter_channels", ",", "inter_channels", ",", "3", ",", "stride", ",", "dilation", ",", "dilation", ",", "\n", "groups", "=", "inter_channels", ",", "relu6", "=", "True", ",", "norm_layer", "=", "norm_layer", ")", ",", "\n", "# pw-linear", "\n", "nn", ".", "Conv2d", "(", "inter_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", "]", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.InvertedResidual.forward": [[60, 65], ["mobilenetv2_backbone.InvertedResidual.conv", "mobilenetv2_backbone.InvertedResidual.conv"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "if", "self", ".", "use_res_connect", ":", "\n", "            ", "return", "x", "+", "self", ".", "conv", "(", "x", ")", "\n", "", "else", ":", "\n", "            ", "return", "self", ".", "conv", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNet.__init__": [[69, 105], ["torch.Module.__init__", "int", "features.append", "torch.Sequential", "torch.Linear", "mobilenetv2_backbone.MobileNet.modules", "int", "mobilenetv2_backbone._ConvBNReLU", "int", "range", "torch.AdaptiveAvgPool2d", "int", "isinstance", "features.append", "torch.init.kaiming_normal_", "isinstance", "mobilenetv2_backbone._DepthwiseConv", "torch.init.zeros_", "torch.init.ones_", "torch.init.zeros_", "isinstance", "torch.init.normal_", "torch.init.zeros_"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_classes", "=", "1000", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "MobileNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "multiplier", "=", "1", "\n", "conv_dw_setting", "=", "[", "\n", "[", "64", ",", "1", ",", "1", "]", ",", "\n", "[", "128", ",", "2", ",", "2", "]", ",", "\n", "[", "256", ",", "2", ",", "2", "]", ",", "\n", "[", "512", ",", "6", ",", "2", "]", ",", "\n", "[", "1024", ",", "2", ",", "2", "]", "]", "\n", "input_channels", "=", "int", "(", "32", "*", "multiplier", ")", "if", "multiplier", ">", "1.0", "else", "32", "\n", "features", "=", "[", "_ConvBNReLU", "(", "3", ",", "input_channels", ",", "3", ",", "2", ",", "1", ",", "norm_layer", "=", "norm_layer", ")", "]", "\n", "\n", "for", "c", ",", "n", ",", "s", "in", "conv_dw_setting", ":", "\n", "            ", "out_channels", "=", "int", "(", "c", "*", "multiplier", ")", "\n", "for", "i", "in", "range", "(", "n", ")", ":", "\n", "                ", "stride", "=", "s", "if", "i", "==", "0", "else", "1", "\n", "features", ".", "append", "(", "_DepthwiseConv", "(", "input_channels", ",", "out_channels", ",", "stride", ",", "norm_layer", ")", ")", "\n", "input_channels", "=", "out_channels", "\n", "", "", "self", ".", "last_inp_channels", "=", "int", "(", "1024", "*", "multiplier", ")", "\n", "features", ".", "append", "(", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ")", "\n", "self", ".", "features", "=", "nn", ".", "Sequential", "(", "*", "features", ")", "\n", "\n", "self", ".", "classifier", "=", "nn", ".", "Linear", "(", "int", "(", "1024", "*", "multiplier", ")", ",", "num_classes", ")", "\n", "\n", "# weight initialization", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "kaiming_normal_", "(", "m", ".", "weight", ",", "mode", "=", "'fan_out'", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "ones_", "(", "m", ".", "weight", ")", "\n", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "                ", "nn", ".", "init", ".", "normal_", "(", "m", ".", "weight", ",", "0", ",", "0.01", ")", "\n", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNet.forward": [[106, 110], ["mobilenetv2_backbone.MobileNet.features", "mobilenetv2_backbone.MobileNet.classifier", "mobilenetv2_backbone.MobileNet.view", "mobilenetv2_backbone.MobileNet.size", "mobilenetv2_backbone.MobileNet.size"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "features", "(", "x", ")", "\n", "x", "=", "self", ".", "classifier", "(", "x", ".", "view", "(", "x", ".", "size", "(", "0", ")", ",", "x", ".", "size", "(", "1", ")", ")", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2.__init__": [[113, 176], ["torch.Module.__init__", "mobilenetv2_backbone._ConvBNReLU", "mobilenetv2_backbone.MobileNetV2._make_layer", "mobilenetv2_backbone.MobileNetV2._make_layer", "mobilenetv2_backbone.MobileNetV2._make_layer", "mobilenetv2_backbone.MobileNetV2._make_layer", "mobilenetv2_backbone.MobileNetV2._make_layer", "mobilenetv2_backbone.MobileNetV2.modules", "int", "isinstance", "torch.init.kaiming_normal_", "isinstance", "torch.init.zeros_", "torch.init.ones_", "torch.init.zeros_", "isinstance", "torch.init.normal_", "torch.init.zeros_"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer"], ["    ", "def", "__init__", "(", "self", ",", "num_classes", "=", "1000", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "super", "(", "MobileNetV2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "output_stride", "=", "8", "\n", "self", ".", "multiplier", "=", "1", "\n", "if", "output_stride", "==", "32", ":", "\n", "            ", "dilations", "=", "[", "1", ",", "1", "]", "\n", "", "elif", "output_stride", "==", "16", ":", "\n", "            ", "dilations", "=", "[", "1", ",", "2", "]", "\n", "", "elif", "output_stride", "==", "8", ":", "\n", "            ", "dilations", "=", "[", "2", ",", "4", "]", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "\n", "", "inverted_residual_setting", "=", "[", "\n", "# t, c, n, s", "\n", "[", "1", ",", "16", ",", "1", ",", "1", "]", ",", "\n", "[", "6", ",", "24", ",", "2", ",", "2", "]", ",", "\n", "[", "6", ",", "32", ",", "3", ",", "2", "]", ",", "\n", "[", "6", ",", "64", ",", "4", ",", "2", "]", ",", "\n", "[", "6", ",", "96", ",", "3", ",", "1", "]", ",", "\n", "[", "6", ",", "160", ",", "3", ",", "2", "]", ",", "\n", "[", "6", ",", "320", ",", "1", ",", "1", "]", "]", "\n", "# building first layer", "\n", "input_channels", "=", "int", "(", "32", "*", "self", ".", "multiplier", ")", "if", "self", ".", "multiplier", ">", "1.0", "else", "32", "\n", "# last_channels = int(1280 * multiplier) if multiplier > 1.0 else 1280", "\n", "self", ".", "conv1", "=", "_ConvBNReLU", "(", "3", ",", "input_channels", ",", "3", ",", "2", ",", "1", ",", "relu6", "=", "True", ",", "norm_layer", "=", "norm_layer", ")", "\n", "\n", "# building inverted residual blocks", "\n", "self", ".", "planes", "=", "input_channels", "\n", "self", ".", "block1", "=", "self", ".", "_make_layer", "(", "InvertedResidual", ",", "self", ".", "planes", ",", "inverted_residual_setting", "[", "0", ":", "1", "]", ",", "\n", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "block2", "=", "self", ".", "_make_layer", "(", "InvertedResidual", ",", "self", ".", "planes", ",", "inverted_residual_setting", "[", "1", ":", "2", "]", ",", "\n", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "block3", "=", "self", ".", "_make_layer", "(", "InvertedResidual", ",", "self", ".", "planes", ",", "inverted_residual_setting", "[", "2", ":", "3", "]", ",", "\n", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "block4", "=", "self", ".", "_make_layer", "(", "InvertedResidual", ",", "self", ".", "planes", ",", "inverted_residual_setting", "[", "3", ":", "5", "]", ",", "\n", "dilations", "[", "0", "]", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "block5", "=", "self", ".", "_make_layer", "(", "InvertedResidual", ",", "self", ".", "planes", ",", "inverted_residual_setting", "[", "5", ":", "]", ",", "\n", "dilations", "[", "1", "]", ",", "norm_layer", "=", "norm_layer", ")", "\n", "self", ".", "last_inp_channels", "=", "self", ".", "planes", "\n", "\n", "# building last several layers", "\n", "# features = list()", "\n", "# features.append(_ConvBNReLU(input_channels, last_channels, 1, relu6=True, norm_layer=norm_layer))", "\n", "# features.append(nn.AdaptiveAvgPool2d(1))", "\n", "# self.features = nn.Sequential(*features)", "\n", "#", "\n", "# self.classifier = nn.Sequential(", "\n", "#     nn.Dropout2d(0.2),", "\n", "#     nn.Linear(last_channels, num_classes))", "\n", "\n", "# weight initialization", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "kaiming_normal_", "(", "m", ".", "weight", ",", "mode", "=", "'fan_out'", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "ones_", "(", "m", ".", "weight", ")", "\n", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "                ", "nn", ".", "init", ".", "normal_", "(", "m", ".", "weight", ",", "0", ",", "0.01", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2._make_layer": [[177, 189], ["list", "torch.Sequential", "int", "list.append", "range", "block", "list.append", "block"], "methods", ["None"], ["", "", "", "", "def", "_make_layer", "(", "self", ",", "block", ",", "planes", ",", "inverted_residual_setting", ",", "dilation", "=", "1", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "        ", "features", "=", "list", "(", ")", "\n", "for", "t", ",", "c", ",", "n", ",", "s", "in", "inverted_residual_setting", ":", "\n", "            ", "out_channels", "=", "int", "(", "c", "*", "self", ".", "multiplier", ")", "\n", "stride", "=", "s", "if", "dilation", "==", "1", "else", "1", "\n", "features", ".", "append", "(", "block", "(", "planes", ",", "out_channels", ",", "stride", ",", "t", ",", "dilation", ",", "norm_layer", ")", ")", "\n", "planes", "=", "out_channels", "\n", "for", "i", "in", "range", "(", "n", "-", "1", ")", ":", "\n", "                ", "features", ".", "append", "(", "block", "(", "planes", ",", "out_channels", ",", "1", ",", "t", ",", "norm_layer", "=", "norm_layer", ")", ")", "\n", "planes", "=", "out_channels", "\n", "", "", "self", ".", "planes", "=", "planes", "\n", "return", "nn", ".", "Sequential", "(", "*", "features", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.MobileNetV2.forward": [[190, 202], ["mobilenetv2_backbone.MobileNetV2.conv1", "mobilenetv2_backbone.MobileNetV2.block1", "mobilenetv2_backbone.MobileNetV2.block2", "mobilenetv2_backbone.MobileNetV2.block3", "mobilenetv2_backbone.MobileNetV2.block4", "mobilenetv2_backbone.MobileNetV2.block5"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "side_feature", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv1", "(", "x", ")", "\n", "x", "=", "x", "+", "side_feature", "\n", "x", "=", "self", ".", "block1", "(", "x", ")", "\n", "c1", "=", "self", ".", "block2", "(", "x", ")", "\n", "c2", "=", "self", ".", "block3", "(", "c1", ")", "\n", "c3", "=", "self", ".", "block4", "(", "c2", ")", "\n", "c4", "=", "self", ".", "block5", "(", "c3", ")", "\n", "\n", "# x = self.features(x)", "\n", "# x = self.classifier(x.view(x.size(0), x.size(1)))", "\n", "return", "c1", ",", "c2", ",", "c3", ",", "c4", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.mobilenet_v1": [[205, 207], ["mobilenetv2_backbone.MobileNet"], "function", ["None"], ["", "", "def", "mobilenet_v1", "(", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "    ", "return", "MobileNet", "(", "norm_layer", "=", "norm_layer", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.mobilenet_v2": [[210, 212], ["mobilenetv2_backbone.MobileNetV2"], "function", ["None"], ["", "def", "mobilenet_v2", "(", "norm_layer", "=", "nn", ".", "BatchNorm2d", ")", ":", "\n", "    ", "return", "MobileNetV2", "(", "norm_layer", "=", "norm_layer", ")", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.LRASPP.__init__": [[14, 25], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "norm_layer", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "LRASPP", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "b0", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "out_channels", ")", ",", "\n", "nn", ".", "ReLU", "(", "True", ")", "\n", ")", "\n", "self", ".", "b1", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "(", "2", ",", "2", ")", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", ",", "out_channels", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.LRASPP.forward": [[27, 34], ["segmentator.LRASPP.b0", "segmentator.LRASPP.b1", "torch.interpolate", "torch.interpolate", "torch.interpolate", "x.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "size", "=", "x", ".", "size", "(", ")", "[", "2", ":", "]", "\n", "feat1", "=", "self", ".", "b0", "(", "x", ")", "\n", "feat2", "=", "self", ".", "b1", "(", "x", ")", "\n", "feat2", "=", "F", ".", "interpolate", "(", "feat2", ",", "size", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x", "=", "feat1", "*", "feat2", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.__init__": [[38, 46], ["torch.Module.__init__", "isegm.model.modeling.mobilenet.mobilenetv2_backbone.mobilenet_v2", "segmentator.LRASPP", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv2_backbone.mobilenet_v2"], ["    ", "def", "__init__", "(", "self", ",", "nclass", "=", "1", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "EfficientSeg", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "backbone", "=", "efficientnet_b0", "(", ")", "\n", "self", ".", "lraspp", "=", "LRASPP", "(", "320", ",", "128", ")", "\n", "self", ".", "fusion_conv1", "=", "nn", ".", "Conv2d", "(", "128", ",", "16", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "fusion_conv2", "=", "nn", ".", "Conv2d", "(", "24", ",", "16", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "head", "=", "nn", ".", "Conv2d", "(", "16", ",", "nclass", ",", "1", ",", "1", ",", "0", ")", "\n", "self", ".", "aux_head", "=", "nn", ".", "Conv2d", "(", "16", ",", "nclass", ",", "1", ",", "1", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.forward": [[47, 58], ["segmentator.MobileSeg.backbone", "segmentator.MobileSeg.lraspp", "torch.interpolate", "torch.interpolate", "torch.interpolate", "segmentator.MobileSeg.fusion_conv1", "segmentator.MobileSeg.aux_head", "segmentator.MobileSeg.fusion_conv2", "segmentator.MobileSeg.head", "segmentator.MobileSeg.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "side_feature", ")", ":", "\n", "        ", "x4", ",", "_", ",", "_", ",", "x8", "=", "self", ".", "backbone", "(", "x", ",", "side_feature", ")", "\n", "x8", "=", "self", ".", "lraspp", "(", "x8", ")", "\n", "x8", "=", "F", ".", "interpolate", "(", "x8", ",", "x4", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x8", "=", "self", ".", "fusion_conv1", "(", "x8", ")", "\n", "pred_aux", "=", "self", ".", "aux_head", "(", "x8", ")", "\n", "\n", "x4", "=", "self", ".", "fusion_conv2", "(", "x4", ")", "\n", "x", "=", "x4", "+", "x8", "\n", "pred", "=", "self", ".", "head", "(", "x", ")", "\n", "return", "pred", ",", "pred_aux", ",", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights": [[59, 71], ["segmentator.MobileSeg.backbone.state_dict", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "set", "set", "print", "print", "print", "segmentator.MobileSeg.update", "segmentator.MobileSeg.backbone.load_state_dict", "torch.load.keys", "torch.load.keys", "torch.load.keys", "segmentator.MobileSeg.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_pretrained_weights", "(", "self", ",", "path_to_weights", "=", "' '", ")", ":", "\n", "        ", "backbone_state_dict", "=", "self", ".", "backbone", ".", "state_dict", "(", ")", "\n", "pretrained_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "\n", "ckpt_keys", "=", "set", "(", "pretrained_state_dict", ".", "keys", "(", ")", ")", "\n", "own_keys", "=", "set", "(", "backbone_state_dict", ".", "keys", "(", ")", ")", "\n", "missing_keys", "=", "own_keys", "-", "ckpt_keys", "\n", "unexpected_keys", "=", "ckpt_keys", "-", "own_keys", "\n", "print", "(", "'Loading Efficientnet'", ")", "\n", "print", "(", "'Missing Keys: '", ",", "missing_keys", ")", "\n", "print", "(", "'Unexpected Keys: '", ",", "unexpected_keys", ")", "\n", "backbone_state_dict", ".", "update", "(", "pretrained_state_dict", ")", "\n", "self", ".", "backbone", ".", "load_state_dict", "(", "backbone_state_dict", ",", "strict", "=", "False", ")", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.Hswish.__init__": [[29, 32], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "inplace", "=", "True", ")", ":", "\n", "        ", "super", "(", "Hswish", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "inplace", "=", "inplace", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.Hswish.forward": [[33, 35], ["torch.relu6", "torch.relu6", "torch.relu6"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "*", "F", ".", "relu6", "(", "x", "+", "3.", ",", "inplace", "=", "self", ".", "inplace", ")", "/", "6.", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.Hsigmoid.__init__": [[38, 41], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "inplace", "=", "True", ")", ":", "\n", "        ", "super", "(", "Hsigmoid", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "inplace", "=", "inplace", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.Hsigmoid.forward": [[42, 44], ["torch.relu6", "torch.relu6", "torch.relu6"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "F", ".", "relu6", "(", "x", "+", "3.", ",", "inplace", "=", "self", ".", "inplace", ")", "/", "6.", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.SEModule.__init__": [[47, 55], ["torch.Module.__init__", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Linear", "torch.Linear", "torch.Linear", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Linear", "torch.Linear", "torch.Linear", "mobilenetv3_backbone.Hsigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "4", ")", ":", "\n", "        ", "super", "(", "SEModule", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Linear", "(", "channel", ",", "channel", "//", "reduction", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Linear", "(", "channel", "//", "reduction", ",", "channel", ",", "bias", "=", "False", ")", ",", "\n", "Hsigmoid", "(", ")", "\n", "# nn.Sigmoid()", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.SEModule.forward": [[58, 63], ["x.size", "mobilenetv3_backbone.SEModule.avg_pool().view", "mobilenetv3_backbone.SEModule.fc().view", "mobilenetv3_backbone.SEModule.expand_as", "mobilenetv3_backbone.SEModule.avg_pool", "mobilenetv3_backbone.SEModule.fc"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "b", ",", "c", ",", "_", ",", "_", "=", "x", ".", "size", "(", ")", "\n", "y", "=", "self", ".", "avg_pool", "(", "x", ")", ".", "view", "(", "b", ",", "c", ")", "\n", "y", "=", "self", ".", "fc", "(", "y", ")", ".", "view", "(", "b", ",", "c", ",", "1", ",", "1", ")", "\n", "return", "x", "*", "y", ".", "expand_as", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.Identity.__init__": [[66, 68], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ")", ":", "\n", "        ", "super", "(", "Identity", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.Identity.forward": [[69, 71], ["None"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.MobileBottleneck.__init__": [[79, 112], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "conv_layer", "norm_layer", "nlin_layer", "conv_layer", "norm_layer", "SELayer", "nlin_layer", "conv_layer", "norm_layer"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "inp", ",", "oup", ",", "kernel", ",", "stride", ",", "exp", ",", "se", "=", "False", ",", "nl", "=", "'RE'", ")", ":", "\n", "        ", "super", "(", "MobileBottleneck", ",", "self", ")", ".", "__init__", "(", ")", "\n", "assert", "stride", "in", "[", "1", ",", "2", "]", "\n", "assert", "kernel", "in", "[", "3", ",", "5", "]", "\n", "padding", "=", "(", "kernel", "-", "1", ")", "//", "2", "\n", "self", ".", "use_res_connect", "=", "stride", "==", "1", "and", "inp", "==", "oup", "\n", "\n", "conv_layer", "=", "nn", ".", "Conv2d", "\n", "norm_layer", "=", "nn", ".", "BatchNorm2d", "\n", "if", "nl", "==", "'RE'", ":", "\n", "            ", "nlin_layer", "=", "nn", ".", "ReLU", "# or ReLU6", "\n", "", "elif", "nl", "==", "'HS'", ":", "\n", "            ", "nlin_layer", "=", "Hswish", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "\n", "", "if", "se", ":", "\n", "            ", "SELayer", "=", "SEModule", "\n", "", "else", ":", "\n", "            ", "SELayer", "=", "Identity", "\n", "\n", "", "self", ".", "conv", "=", "nn", ".", "Sequential", "(", "\n", "# pw", "\n", "conv_layer", "(", "inp", ",", "exp", ",", "1", ",", "1", ",", "0", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "exp", ")", ",", "\n", "nlin_layer", "(", "inplace", "=", "True", ")", ",", "\n", "# dw", "\n", "conv_layer", "(", "exp", ",", "exp", ",", "kernel", ",", "stride", ",", "padding", ",", "groups", "=", "exp", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "exp", ")", ",", "\n", "SELayer", "(", "exp", ")", ",", "\n", "nlin_layer", "(", "inplace", "=", "True", ")", ",", "\n", "# pw-linear", "\n", "conv_layer", "(", "exp", ",", "oup", ",", "1", ",", "1", ",", "0", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "oup", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.MobileBottleneck.forward": [[114, 119], ["mobilenetv3_backbone.MobileBottleneck.conv", "mobilenetv3_backbone.MobileBottleneck.conv"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "if", "self", ".", "use_res_connect", ":", "\n", "            ", "return", "x", "+", "self", ".", "conv", "(", "x", ")", "\n", "", "else", ":", "\n", "            ", "return", "self", ".", "conv", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.MobileNetV3.__init__": [[122, 205], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "mobilenetv3_backbone.MobileNetV3._initialize_weights", "mobilenetv3_backbone.make_divisible", "mobilenetv3_backbone.conv_bn", "mobilenetv3_backbone.make_divisible", "mobilenetv3_backbone.make_divisible", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.make_divisible", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.MobileNetV3.features.append", "torch.Dropout", "torch.Dropout", "torch.Dropout", "torch.Linear", "torch.Linear", "torch.Linear", "mobilenetv3_backbone.MobileBottleneck", "mobilenetv3_backbone.conv_1x1_bn", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "mobilenetv3_backbone.Hswish", "mobilenetv3_backbone.make_divisible", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.MobileNetV3.features.append", "mobilenetv3_backbone.conv_1x1_bn", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "mobilenetv3_backbone.Hswish"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.MobileNetV3._initialize_weights", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.conv_bn", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.conv_1x1_bn", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.conv_1x1_bn"], ["    ", "def", "__init__", "(", "self", ",", "n_class", "=", "1000", ",", "input_size", "=", "224", ",", "dropout", "=", "0.8", ",", "mode", "=", "'small'", ",", "width_mult", "=", "1.0", ")", ":", "\n", "        ", "super", "(", "MobileNetV3", ",", "self", ")", ".", "__init__", "(", ")", "\n", "input_channel", "=", "16", "\n", "last_channel", "=", "1280", "\n", "if", "mode", "==", "'large'", ":", "\n", "# refer to Table 1 in paper", "\n", "            ", "mobile_setting", "=", "[", "\n", "# k, exp, c,  se,     nl,  s,", "\n", "[", "3", ",", "16", ",", "16", ",", "False", ",", "'RE'", ",", "1", "]", ",", "\n", "[", "3", ",", "64", ",", "24", ",", "False", ",", "'RE'", ",", "2", "]", ",", "\n", "[", "3", ",", "72", ",", "24", ",", "False", ",", "'RE'", ",", "1", "]", ",", "\n", "[", "5", ",", "72", ",", "40", ",", "True", ",", "'RE'", ",", "2", "]", ",", "\n", "[", "5", ",", "120", ",", "40", ",", "True", ",", "'RE'", ",", "1", "]", ",", "\n", "[", "5", ",", "120", ",", "40", ",", "True", ",", "'RE'", ",", "1", "]", ",", "\n", "[", "3", ",", "240", ",", "80", ",", "False", ",", "'HS'", ",", "2", "]", ",", "\n", "[", "3", ",", "200", ",", "80", ",", "False", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "3", ",", "184", ",", "80", ",", "False", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "3", ",", "184", ",", "80", ",", "False", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "3", ",", "480", ",", "112", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "3", ",", "672", ",", "112", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "5", ",", "672", ",", "160", ",", "True", ",", "'HS'", ",", "2", "]", ",", "\n", "[", "5", ",", "960", ",", "160", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "5", ",", "960", ",", "160", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "]", "\n", "", "elif", "mode", "==", "'small'", ":", "\n", "# refer to Table 2 in paper", "\n", "            ", "mobile_setting", "=", "[", "\n", "# k, exp, c,  se,     nl,  s,", "\n", "[", "3", ",", "16", ",", "16", ",", "True", ",", "'RE'", ",", "2", "]", ",", "\n", "[", "3", ",", "72", ",", "24", ",", "False", ",", "'RE'", ",", "2", "]", ",", "\n", "[", "3", ",", "88", ",", "24", ",", "False", ",", "'RE'", ",", "1", "]", ",", "\n", "[", "5", ",", "96", ",", "40", ",", "True", ",", "'HS'", ",", "2", "]", ",", "\n", "[", "5", ",", "240", ",", "40", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "5", ",", "240", ",", "40", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "5", ",", "120", ",", "48", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "5", ",", "144", ",", "48", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "5", ",", "288", ",", "96", ",", "True", ",", "'HS'", ",", "2", "]", ",", "\n", "[", "5", ",", "576", ",", "96", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "[", "5", ",", "576", ",", "96", ",", "True", ",", "'HS'", ",", "1", "]", ",", "\n", "]", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "\n", "\n", "# building first layer", "\n", "", "assert", "input_size", "%", "32", "==", "0", "\n", "last_channel", "=", "make_divisible", "(", "last_channel", "*", "width_mult", ")", "if", "width_mult", ">", "1.0", "else", "last_channel", "\n", "self", ".", "features", "=", "[", "conv_bn", "(", "3", ",", "input_channel", ",", "2", ",", "nlin_layer", "=", "Hswish", ")", "]", "\n", "self", ".", "classifier", "=", "[", "]", "\n", "\n", "# building mobile blocks", "\n", "for", "k", ",", "exp", ",", "c", ",", "se", ",", "nl", ",", "s", "in", "mobile_setting", ":", "\n", "            ", "output_channel", "=", "make_divisible", "(", "c", "*", "width_mult", ")", "\n", "exp_channel", "=", "make_divisible", "(", "exp", "*", "width_mult", ")", "\n", "self", ".", "features", ".", "append", "(", "MobileBottleneck", "(", "input_channel", ",", "output_channel", ",", "k", ",", "s", ",", "exp_channel", ",", "se", ",", "nl", ")", ")", "\n", "input_channel", "=", "output_channel", "\n", "\n", "# building last several layers", "\n", "", "if", "mode", "==", "'large'", ":", "\n", "            ", "last_conv", "=", "make_divisible", "(", "960", "*", "width_mult", ")", "\n", "self", ".", "features", ".", "append", "(", "conv_1x1_bn", "(", "input_channel", ",", "last_conv", ",", "nlin_layer", "=", "Hswish", ")", ")", "\n", "self", ".", "features", ".", "append", "(", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ")", "\n", "self", ".", "features", ".", "append", "(", "nn", ".", "Conv2d", "(", "last_conv", ",", "last_channel", ",", "1", ",", "1", ",", "0", ")", ")", "\n", "self", ".", "features", ".", "append", "(", "Hswish", "(", "inplace", "=", "True", ")", ")", "\n", "", "elif", "mode", "==", "'small'", ":", "\n", "            ", "last_conv", "=", "make_divisible", "(", "576", "*", "width_mult", ")", "\n", "self", ".", "features", ".", "append", "(", "conv_1x1_bn", "(", "input_channel", ",", "last_conv", ",", "nlin_layer", "=", "Hswish", ")", ")", "\n", "# self.features.append(SEModule(last_conv))  # refer to paper Table2, but I think this is a mistake", "\n", "self", ".", "features", ".", "append", "(", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ")", "\n", "self", ".", "features", ".", "append", "(", "nn", ".", "Conv2d", "(", "last_conv", ",", "last_channel", ",", "1", ",", "1", ",", "0", ")", ")", "\n", "self", ".", "features", ".", "append", "(", "Hswish", "(", "inplace", "=", "True", ")", ")", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "\n", "\n", "# make it nn.Sequential", "\n", "", "self", ".", "features", "=", "nn", ".", "Sequential", "(", "*", "self", ".", "features", ")", "\n", "\n", "# building classifier", "\n", "self", ".", "classifier", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Dropout", "(", "p", "=", "dropout", ")", ",", "# refer to paper section 6", "\n", "nn", ".", "Linear", "(", "last_channel", ",", "n_class", ")", ",", "\n", ")", "\n", "\n", "self", ".", "_initialize_weights", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.MobileNetV3.forward": [[206, 211], ["mobilenetv3_backbone.MobileNetV3.features", "mobilenetv3_backbone.MobileNetV3.mean().mean", "mobilenetv3_backbone.MobileNetV3.classifier", "mobilenetv3_backbone.MobileNetV3.mean"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "features", "(", "x", ")", "\n", "x", "=", "x", ".", "mean", "(", "3", ")", ".", "mean", "(", "2", ")", "\n", "x", "=", "self", ".", "classifier", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.MobileNetV3._initialize_weights": [[212, 226], ["mobilenetv3_backbone.MobileNetV3.modules", "isinstance", "torch.init.kaiming_normal_", "torch.init.kaiming_normal_", "torch.init.kaiming_normal_", "isinstance", "torch.init.zeros_", "torch.init.zeros_", "torch.init.zeros_", "torch.init.ones_", "torch.init.ones_", "torch.init.ones_", "torch.init.zeros_", "torch.init.zeros_", "torch.init.zeros_", "isinstance", "torch.init.normal_", "torch.init.normal_", "torch.init.normal_", "torch.init.zeros_", "torch.init.zeros_", "torch.init.zeros_"], "methods", ["None"], ["", "def", "_initialize_weights", "(", "self", ")", ":", "\n", "# weight initialization", "\n", "        ", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "kaiming_normal_", "(", "m", ".", "weight", ",", "mode", "=", "'fan_out'", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "ones_", "(", "m", ".", "weight", ")", "\n", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "                ", "nn", ".", "init", ".", "normal_", "(", "m", ".", "weight", ",", "0", ",", "0.01", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "nn", ".", "init", ".", "zeros_", "(", "m", ".", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.conv_bn": [[12, 17], ["torch.Sequential", "conv_layer", "norm_layer", "nlin_layer"], "function", ["None"], ["def", "conv_bn", "(", "inp", ",", "oup", ",", "stride", ",", "conv_layer", "=", "nn", ".", "Conv2d", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "nlin_layer", "=", "nn", ".", "ReLU", ")", ":", "\n", "    ", "return", "nn", ".", "Sequential", "(", "\n", "conv_layer", "(", "inp", ",", "oup", ",", "3", ",", "stride", ",", "1", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "oup", ")", ",", "\n", "nlin_layer", "(", "inplace", "=", "True", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.conv_1x1_bn": [[20, 25], ["torch.Sequential", "conv_layer", "norm_layer", "nlin_layer"], "function", ["None"], ["", "def", "conv_1x1_bn", "(", "inp", ",", "oup", ",", "conv_layer", "=", "nn", ".", "Conv2d", ",", "norm_layer", "=", "nn", ".", "BatchNorm2d", ",", "nlin_layer", "=", "nn", ".", "ReLU", ")", ":", "\n", "    ", "return", "nn", ".", "Sequential", "(", "\n", "conv_layer", "(", "inp", ",", "oup", ",", "1", ",", "1", ",", "0", ",", "bias", "=", "False", ")", ",", "\n", "norm_layer", "(", "oup", ")", ",", "\n", "nlin_layer", "(", "inplace", "=", "True", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.make_divisible": [[73, 76], ["int", "np.ceil"], "function", ["None"], ["", "", "def", "make_divisible", "(", "x", ",", "divisible_by", "=", "8", ")", ":", "\n", "    ", "import", "numpy", "as", "np", "\n", "return", "int", "(", "np", ".", "ceil", "(", "x", "*", "1.", "/", "divisible_by", ")", "*", "divisible_by", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.mobilenetv3_backbone.mobilenetv3": [[228, 235], ["mobilenetv3_backbone.MobileNetV3", "torch.load", "torch.load", "torch.load", "MobileNetV3.load_state_dict"], "function", ["None"], ["", "", "", "", "", "def", "mobilenetv3", "(", "pretrained", "=", "False", ",", "**", "kwargs", ")", ":", "\n", "    ", "model", "=", "MobileNetV3", "(", "**", "kwargs", ")", "\n", "if", "pretrained", ":", "\n", "        ", "state_dict", "=", "torch", ".", "load", "(", "'mobilenetv3_small_67.4.pth.tar'", ")", "\n", "model", ".", "load_state_dict", "(", "state_dict", ",", "strict", "=", "True", ")", "\n", "# raise NotImplementedError", "\n", "", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.__init__": [[23, 116], ["copy.deepcopy", "copy.deepcopy", "isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "optimizer.get_optimizer", "focalclick_trainer.ISTrainer._load_weights", "focalclick_trainer.ISTrainer.to", "isegm.utils.log.TqdmToLogger", "focalclick_trainer.ISTrainer.val_metrics.extend", "isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "lr_scheduler", "isegm.utils.distributed.get_sampler", "isegm.utils.distributed.get_sampler", "isegm.utils.distributed.get_dp_wrapper", "isegm.utils.serialization.get_config_repr", "range", "click_model.parameters", "click_model.to", "click_model.eval", "trainset.get_samples_number", "valset.get_samples_number", "focalclick_trainer.ISTrainer.lr_scheduler.step"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.optimizer.get_optimizer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer._load_weights", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_sampler", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_sampler", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_dp_wrapper", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_config_repr", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "None", ",", "\n", "image_dump_interval", "=", "200", ",", "\n", "checkpoint_interval", "=", "10", ",", "\n", "tb_dump_period", "=", "25", ",", "\n", "max_interactive_points", "=", "0", ",", "\n", "lr_scheduler", "=", "None", ",", "\n", "metrics", "=", "None", ",", "\n", "additional_val_metrics", "=", "None", ",", "\n", "net_inputs", "=", "(", "'images'", ",", "'points'", ")", ",", "\n", "max_num_next_clicks", "=", "0", ",", "\n", "click_models", "=", "None", ",", "\n", "prev_mask_drop_prob", "=", "0.0", ",", "\n", ")", ":", "\n", "        ", "self", ".", "cfg", "=", "cfg", "\n", "self", ".", "model_cfg", "=", "model_cfg", "\n", "self", ".", "max_interactive_points", "=", "max_interactive_points", "\n", "self", ".", "loss_cfg", "=", "loss_cfg", "\n", "self", ".", "val_loss_cfg", "=", "deepcopy", "(", "loss_cfg", ")", "\n", "self", ".", "tb_dump_period", "=", "tb_dump_period", "\n", "self", ".", "net_inputs", "=", "net_inputs", "\n", "self", ".", "max_num_next_clicks", "=", "max_num_next_clicks", "\n", "\n", "self", ".", "click_models", "=", "click_models", "\n", "self", ".", "prev_mask_drop_prob", "=", "prev_mask_drop_prob", "\n", "\n", "if", "cfg", ".", "distributed", ":", "\n", "            ", "cfg", ".", "batch_size", "//=", "cfg", ".", "ngpus", "\n", "cfg", ".", "val_batch_size", "//=", "cfg", ".", "ngpus", "\n", "\n", "", "if", "metrics", "is", "None", ":", "\n", "            ", "metrics", "=", "[", "]", "\n", "", "self", ".", "train_metrics", "=", "metrics", "\n", "self", ".", "val_metrics", "=", "deepcopy", "(", "metrics", ")", "\n", "if", "additional_val_metrics", "is", "not", "None", ":", "\n", "            ", "self", ".", "val_metrics", ".", "extend", "(", "additional_val_metrics", ")", "\n", "\n", "", "self", ".", "checkpoint_interval", "=", "checkpoint_interval", "\n", "self", ".", "image_dump_interval", "=", "image_dump_interval", "\n", "self", ".", "task_prefix", "=", "''", "\n", "self", ".", "sw", "=", "None", "\n", "\n", "self", ".", "trainset", "=", "trainset", "\n", "self", ".", "valset", "=", "valset", "\n", "\n", "logger", ".", "info", "(", "f'Dataset of {trainset.get_samples_number()} samples was loaded for training.'", ")", "\n", "logger", ".", "info", "(", "f'Dataset of {valset.get_samples_number()} samples was loaded for validation.'", ")", "\n", "\n", "self", ".", "train_data", "=", "DataLoader", "(", "\n", "trainset", ",", "cfg", ".", "batch_size", ",", "\n", "sampler", "=", "get_sampler", "(", "trainset", ",", "shuffle", "=", "True", ",", "distributed", "=", "cfg", ".", "distributed", ")", ",", "\n", "drop_last", "=", "True", ",", "pin_memory", "=", "True", ",", "\n", "num_workers", "=", "cfg", ".", "workers", "\n", ")", "\n", "\n", "self", ".", "val_data", "=", "DataLoader", "(", "\n", "valset", ",", "cfg", ".", "val_batch_size", ",", "\n", "sampler", "=", "get_sampler", "(", "valset", ",", "shuffle", "=", "False", ",", "distributed", "=", "cfg", ".", "distributed", ")", ",", "\n", "drop_last", "=", "True", ",", "pin_memory", "=", "True", ",", "\n", "num_workers", "=", "cfg", ".", "workers", "\n", ")", "\n", "\n", "self", ".", "optim", "=", "get_optimizer", "(", "model", ",", "optimizer", ",", "optimizer_params", ")", "\n", "model", "=", "self", ".", "_load_weights", "(", "model", ")", "\n", "\n", "if", "cfg", ".", "multi_gpu", ":", "\n", "            ", "model", "=", "get_dp_wrapper", "(", "cfg", ".", "distributed", ")", "(", "model", ",", "device_ids", "=", "cfg", ".", "gpu_ids", ",", "\n", "output_device", "=", "cfg", ".", "gpu_ids", "[", "0", "]", ")", "\n", "\n", "", "if", "self", ".", "is_master", ":", "\n", "            ", "logger", ".", "info", "(", "model", ")", "\n", "logger", ".", "info", "(", "get_config_repr", "(", "model", ".", "_config", ")", ")", "\n", "\n", "", "self", ".", "device", "=", "cfg", ".", "device", "\n", "self", ".", "net", "=", "model", ".", "to", "(", "self", ".", "device", ")", "\n", "self", ".", "lr", "=", "optimizer_params", "[", "'lr'", "]", "\n", "\n", "if", "lr_scheduler", "is", "not", "None", ":", "\n", "            ", "self", ".", "lr_scheduler", "=", "lr_scheduler", "(", "optimizer", "=", "self", ".", "optim", ")", "\n", "if", "cfg", ".", "start_epoch", ">", "0", ":", "\n", "                ", "for", "_", "in", "range", "(", "cfg", ".", "start_epoch", ")", ":", "\n", "                    ", "self", ".", "lr_scheduler", ".", "step", "(", ")", "\n", "\n", "", "", "", "self", ".", "tqdm_out", "=", "TqdmToLogger", "(", "logger", ",", "level", "=", "logging", ".", "INFO", ")", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "for", "click_model", "in", "self", ".", "click_models", ":", "\n", "                ", "for", "param", "in", "click_model", ".", "parameters", "(", ")", ":", "\n", "                    ", "param", ".", "requires_grad", "=", "False", "\n", "", "click_model", ".", "to", "(", "self", ".", "device", ")", "\n", "click_model", ".", "eval", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.run": [[117, 125], ["isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "range", "focalclick_trainer.ISTrainer.training"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.training"], ["", "", "", "def", "run", "(", "self", ",", "num_epochs", ",", "start_epoch", "=", "None", ",", "validation", "=", "True", ")", ":", "\n", "        ", "if", "start_epoch", "is", "None", ":", "\n", "            ", "start_epoch", "=", "self", ".", "cfg", ".", "start_epoch", "\n", "\n", "", "logger", ".", "info", "(", "f'Starting Epoch: {start_epoch}'", ")", "\n", "logger", ".", "info", "(", "f'Total Epochs: {num_epochs}'", ")", "\n", "for", "epoch", "in", "range", "(", "start_epoch", ",", "num_epochs", ")", ":", "\n", "            ", "self", ".", "training", "(", "epoch", ")", "\n", "#if validation:", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.training": [[128, 210], ["focalclick_trainer.ISTrainer.net.train", "enumerate", "hasattr", "isegm.utils.log.SummaryWriterAvg", "focalclick_trainer.ISTrainer.train_data.sampler.set_epoch", "focalclick_trainer.ISTrainer.task_prefix.capitalize", "tqdm.tqdm.tqdm", "metric.reset_epoch_stats", "isegm.utils.distributed.reduce_loss_dict", "losses_logging[].item", "isegm.utils.misc.save_checkpoint", "isinstance", "focalclick_trainer.ISTrainer.lr_scheduler.step", "focalclick_trainer.ISTrainer.optim.zero_grad", "scaler.scale().backward", "scaler.step", "scaler.update", "focalclick_trainer.ISTrainer.batch_forward", "focalclick_trainer.ISTrainer.optim.zero_grad", "loss.backward", "focalclick_trainer.ISTrainer.optim.step", "losses_logging.items", "focalclick_trainer.ISTrainer.loss_cfg.items", "focalclick_trainer.ISTrainer.sw.add_scalar", "tbar.set_description", "focalclick_trainer.ISTrainer.sw.add_scalar", "isegm.utils.misc.save_checkpoint", "str", "len", "torch.cuda.amp.autocast", "focalclick_trainer.ISTrainer.batch_forward", "focalclick_trainer.ISTrainer.sw.add_scalar", "focalclick_trainer.ISTrainer.save_visualization", "metric.log_states", "scaler.scale", "hasattr", "v.log_states", "metric.get_epoch_value", "loss_value.item", "focalclick_trainer.ISTrainer.loss_cfg.get", "hasattr", "focalclick_trainer.ISTrainer.lr_scheduler.get_lr"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.reset_epoch_stats", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.save_checkpoint", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.save_checkpoint", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.save_visualization", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.get_epoch_value"], ["", "", "def", "training", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "if", "self", ".", "sw", "is", "None", "and", "self", ".", "is_master", ":", "\n", "            ", "self", ".", "sw", "=", "SummaryWriterAvg", "(", "log_dir", "=", "str", "(", "self", ".", "cfg", ".", "LOGS_PATH", ")", ",", "\n", "flush_secs", "=", "10", ",", "dump_period", "=", "self", ".", "tb_dump_period", ")", "\n", "\n", "", "if", "self", ".", "cfg", ".", "distributed", ":", "\n", "            ", "self", ".", "train_data", ".", "sampler", ".", "set_epoch", "(", "epoch", ")", "\n", "\n", "", "log_prefix", "=", "'Train'", "+", "self", ".", "task_prefix", ".", "capitalize", "(", ")", "\n", "tbar", "=", "tqdm", "(", "self", ".", "train_data", ",", "file", "=", "self", ".", "tqdm_out", ",", "ncols", "=", "100", ")", "if", "self", ".", "is_master", "else", "self", ".", "train_data", "\n", "\n", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "            ", "metric", ".", "reset_epoch_stats", "(", ")", "\n", "\n", "", "self", ".", "net", ".", "train", "(", ")", "\n", "#for m in self.net.feature_extractor.modules():", "\n", "#        m.eval()", "\n", "\n", "train_loss", "=", "0.0", "\n", "for", "i", ",", "batch_data", "in", "enumerate", "(", "tbar", ")", ":", "\n", "            ", "global_step", "=", "epoch", "*", "len", "(", "self", ".", "train_data", ")", "+", "i", "\n", "use_fp16", "=", "False", "\n", "if", "use_fp16", ":", "\n", "                ", "self", ".", "optim", ".", "zero_grad", "(", ")", "\n", "with", "autocast", "(", ")", ":", "\n", "                    ", "loss", ",", "losses_logging", ",", "splitted_batch_data", ",", "outputs", ",", "refine_output", "=", "self", ".", "batch_forward", "(", "batch_data", ")", "\n", "", "scaler", ".", "scale", "(", "loss", ")", ".", "backward", "(", ")", "\n", "scaler", ".", "step", "(", "self", ".", "optim", ")", "\n", "scaler", ".", "update", "(", ")", "\n", "", "else", ":", "\n", "                ", "loss", ",", "losses_logging", ",", "splitted_batch_data", ",", "outputs", ",", "refine_output", "=", "self", ".", "batch_forward", "(", "batch_data", ")", "\n", "self", ".", "optim", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optim", ".", "step", "(", ")", "\n", "\n", "", "losses_logging", "[", "'overall'", "]", "=", "loss", "\n", "reduce_loss_dict", "(", "losses_logging", ")", "\n", "\n", "train_loss", "+=", "losses_logging", "[", "'overall'", "]", ".", "item", "(", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "for", "loss_name", ",", "loss_value", "in", "losses_logging", ".", "items", "(", ")", ":", "\n", "                    ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Losses/{loss_name}'", ",", "\n", "value", "=", "loss_value", ".", "item", "(", ")", ",", "\n", "global_step", "=", "global_step", ")", "\n", "\n", "", "for", "k", ",", "v", "in", "self", ".", "loss_cfg", ".", "items", "(", ")", ":", "\n", "                    ", "if", "'_loss'", "in", "k", "and", "hasattr", "(", "v", ",", "'log_states'", ")", "and", "self", ".", "loss_cfg", ".", "get", "(", "k", "+", "'_weight'", ",", "0.0", ")", ">", "0", ":", "\n", "                        ", "v", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Losses/{k}'", ",", "global_step", ")", "\n", "\n", "", "", "if", "self", ".", "image_dump_interval", ">", "0", "and", "global_step", "%", "self", ".", "image_dump_interval", "==", "0", ":", "\n", "                    ", "self", ".", "save_visualization", "(", "splitted_batch_data", ",", "outputs", ",", "refine_output", ",", "global_step", ",", "prefix", "=", "'train'", ")", "\n", "\n", "", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}States/learning_rate'", ",", "\n", "value", "=", "self", ".", "lr", "if", "not", "hasattr", "(", "self", ",", "'lr_scheduler'", ")", "else", "self", ".", "lr_scheduler", ".", "get_lr", "(", ")", "[", "-", "1", "]", ",", "\n", "global_step", "=", "global_step", ")", "\n", "\n", "tbar", ".", "set_description", "(", "f'Epoch {epoch}, training loss {train_loss/(i+1):.4f}'", ")", "\n", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "                    ", "metric", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Metrics/{metric.name}'", ",", "global_step", ")", "\n", "\n", "", "", "", "if", "self", ".", "is_master", ":", "\n", "            ", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Metrics/{metric.name}'", ",", "\n", "value", "=", "metric", ".", "get_epoch_value", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n", "", "save_checkpoint", "(", "self", ".", "net", ",", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ",", "prefix", "=", "self", ".", "task_prefix", ",", "\n", "epoch", "=", "None", ",", "multi_gpu", "=", "self", ".", "cfg", ".", "multi_gpu", ")", "\n", "\n", "if", "isinstance", "(", "self", ".", "checkpoint_interval", ",", "(", "list", ",", "tuple", ")", ")", ":", "\n", "                ", "checkpoint_interval", "=", "[", "x", "for", "x", "in", "self", ".", "checkpoint_interval", "if", "x", "[", "0", "]", "<=", "epoch", "]", "[", "-", "1", "]", "[", "1", "]", "\n", "", "else", ":", "\n", "                ", "checkpoint_interval", "=", "self", ".", "checkpoint_interval", "\n", "\n", "", "if", "epoch", "%", "checkpoint_interval", "==", "0", ":", "\n", "                ", "save_checkpoint", "(", "self", ".", "net", ",", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ",", "prefix", "=", "self", ".", "task_prefix", ",", "\n", "epoch", "=", "epoch", ",", "multi_gpu", "=", "self", ".", "cfg", ".", "multi_gpu", ")", "\n", "\n", "", "", "if", "hasattr", "(", "self", ",", "'lr_scheduler'", ")", ":", "\n", "            ", "self", ".", "lr_scheduler", ".", "step", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.validation": [[211, 251], ["collections.defaultdict", "focalclick_trainer.ISTrainer.net.eval", "enumerate", "isegm.utils.log.SummaryWriterAvg", "focalclick_trainer.ISTrainer.task_prefix.capitalize", "tqdm.tqdm.tqdm", "metric.reset_epoch_stats", "focalclick_trainer.ISTrainer.batch_forward", "isegm.utils.distributed.reduce_loss_dict", "batch_losses_logging.items", "batch_losses_logging[].item", "collections.defaultdict.items", "losses_logging[].append", "tbar.set_description", "focalclick_trainer.ISTrainer.sw.add_scalar", "focalclick_trainer.ISTrainer.sw.add_scalar", "str", "len", "loss_value.item", "metric.log_states", "numpy.array().mean", "metric.get_epoch_value", "numpy.array"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.reset_epoch_stats", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.get_epoch_value"], ["", "", "def", "validation", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "if", "self", ".", "sw", "is", "None", "and", "self", ".", "is_master", ":", "\n", "            ", "self", ".", "sw", "=", "SummaryWriterAvg", "(", "log_dir", "=", "str", "(", "self", ".", "cfg", ".", "LOGS_PATH", ")", ",", "\n", "flush_secs", "=", "10", ",", "dump_period", "=", "self", ".", "tb_dump_period", ")", "\n", "\n", "", "log_prefix", "=", "'Val'", "+", "self", ".", "task_prefix", ".", "capitalize", "(", ")", "\n", "tbar", "=", "tqdm", "(", "self", ".", "val_data", ",", "file", "=", "self", ".", "tqdm_out", ",", "ncols", "=", "100", ")", "if", "self", ".", "is_master", "else", "self", ".", "val_data", "\n", "\n", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "            ", "metric", ".", "reset_epoch_stats", "(", ")", "\n", "\n", "", "val_loss", "=", "0", "\n", "losses_logging", "=", "defaultdict", "(", "list", ")", "\n", "\n", "self", ".", "net", ".", "eval", "(", ")", "\n", "for", "i", ",", "batch_data", "in", "enumerate", "(", "tbar", ")", ":", "\n", "            ", "global_step", "=", "epoch", "*", "len", "(", "self", ".", "val_data", ")", "+", "i", "\n", "loss", ",", "batch_losses_logging", ",", "splitted_batch_data", ",", "outputs", "=", "self", ".", "batch_forward", "(", "batch_data", ",", "validation", "=", "True", ")", "\n", "\n", "batch_losses_logging", "[", "'overall'", "]", "=", "loss", "\n", "reduce_loss_dict", "(", "batch_losses_logging", ")", "\n", "for", "loss_name", ",", "loss_value", "in", "batch_losses_logging", ".", "items", "(", ")", ":", "\n", "                ", "losses_logging", "[", "loss_name", "]", ".", "append", "(", "loss_value", ".", "item", "(", ")", ")", "\n", "\n", "", "val_loss", "+=", "batch_losses_logging", "[", "'overall'", "]", ".", "item", "(", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "tbar", ".", "set_description", "(", "f'Epoch {epoch}, validation loss: {val_loss/(i + 1):.4f}'", ")", "\n", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "                    ", "metric", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Metrics/{metric.name}'", ",", "global_step", ")", "\n", "\n", "", "", "", "if", "self", ".", "is_master", ":", "\n", "            ", "for", "loss_name", ",", "loss_values", "in", "losses_logging", ".", "items", "(", ")", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Losses/{loss_name}'", ",", "value", "=", "np", ".", "array", "(", "loss_values", ")", ".", "mean", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n", "", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Metrics/{metric.name}'", ",", "value", "=", "metric", ".", "get_epoch_value", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.batch_forward": [[252, 332], ["dict", "torch.set_grad_enabled", "focalclick_trainer.ISTrainer.net", "torch.chunk", "focalclick_trainer.ISTrainer.net.refine", "focalclick_trainer.ISTrainer.add_loss", "focalclick_trainer.ISTrainer.add_loss", "focalclick_trainer.ISTrainer.add_loss", "focalclick_trainer.ISTrainer.add_loss", "focalclick_trainer.ISTrainer.add_loss", "v.to", "image.clone", "gt_mask.clone", "points.clone", "torch.zeros_like", "torch.no_grad", "random.randint", "range", "torch.cat", "batch_data.items", "torch.sigmoid", "focalclick_trainer.get_next_points_removeall", "torch.zeros_like", "torch.no_grad", "focalclick_trainer.ISTrainer.net.eval", "torch.cat", "focalclick_trainer.ISTrainer.net.train", "numpy.random.random", "m.update", "len", "eval_model", "torch.sigmoid.size", "focalclick_trainer.ISTrainer.get"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.refine", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.get_next_points_removeall", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "", "", "def", "batch_forward", "(", "self", ",", "batch_data", ",", "validation", "=", "False", ")", ":", "\n", "        ", "metrics", "=", "self", ".", "val_metrics", "if", "validation", "else", "self", ".", "train_metrics", "\n", "losses_logging", "=", "dict", "(", ")", "\n", "\n", "with", "torch", ".", "set_grad_enabled", "(", "not", "validation", ")", ":", "\n", "            ", "batch_data", "=", "{", "k", ":", "v", ".", "to", "(", "self", ".", "device", ")", "for", "k", ",", "v", "in", "batch_data", ".", "items", "(", ")", "}", "\n", "image", ",", "gt_mask", ",", "points", "=", "batch_data", "[", "'images'", "]", ",", "batch_data", "[", "'instances'", "]", ",", "batch_data", "[", "'points'", "]", "\n", "points_focus", "=", "batch_data", "[", "'points_focus'", "]", "\n", "rois", "=", "batch_data", "[", "'rois'", "]", "\n", "orig_image", ",", "orig_gt_mask", ",", "orig_points", "=", "image", ".", "clone", "(", ")", ",", "gt_mask", ".", "clone", "(", ")", ",", "points", ".", "clone", "(", ")", "\n", "\n", "prev_output", "=", "torch", ".", "zeros_like", "(", "image", ",", "dtype", "=", "torch", ".", "float32", ")", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", "\n", "\n", "last_click_indx", "=", "None", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "num_iters", "=", "random", ".", "randint", "(", "0", ",", "self", ".", "max_num_next_clicks", ")", "\n", "\n", "for", "click_indx", "in", "range", "(", "num_iters", ")", ":", "\n", "                    ", "last_click_indx", "=", "click_indx", "\n", "\n", "if", "not", "validation", ":", "\n", "                        ", "self", ".", "net", ".", "eval", "(", ")", "\n", "\n", "", "if", "self", ".", "click_models", "is", "None", "or", "click_indx", ">=", "len", "(", "self", ".", "click_models", ")", ":", "\n", "                        ", "eval_model", "=", "self", ".", "net", "\n", "", "else", ":", "\n", "                        ", "eval_model", "=", "self", ".", "click_models", "[", "click_indx", "]", "\n", "\n", "\n", "", "net_input", "=", "torch", ".", "cat", "(", "(", "image", ",", "prev_output", ")", ",", "dim", "=", "1", ")", "if", "self", ".", "net", ".", "with_prev_mask", "else", "image", "\n", "prev_output", "=", "torch", ".", "sigmoid", "(", "eval_model", "(", "net_input", ",", "points", ")", "[", "'instances'", "]", ")", "\n", "\n", "points", ",", "points_focus", "=", "get_next_points_removeall", "(", "prev_output", ",", "orig_gt_mask", ",", "points", ",", "points_focus", ",", "rois", ",", "click_indx", "+", "1", ")", "\n", "\n", "if", "not", "validation", ":", "\n", "                        ", "self", ".", "net", ".", "train", "(", ")", "\n", "#for m in self.net.feature_extractor.modules():", "\n", "#        m.eval()", "\n", "\n", "", "", "if", "self", ".", "net", ".", "with_prev_mask", "and", "self", ".", "prev_mask_drop_prob", ">", "0", "and", "last_click_indx", "is", "not", "None", ":", "\n", "                    ", "zero_mask", "=", "np", ".", "random", ".", "random", "(", "size", "=", "prev_output", ".", "size", "(", "0", ")", ")", "<", "self", ".", "prev_mask_drop_prob", "\n", "prev_output", "[", "zero_mask", "]", "=", "torch", ".", "zeros_like", "(", "prev_output", "[", "zero_mask", "]", ")", "\n", "\n", "", "", "batch_data", "[", "'points'", "]", "=", "points", "\n", "batch_data", "[", "'prev_mask'", "]", "=", "prev_output", "\n", "batch_data", "[", "'points_focus'", "]", "=", "points_focus", "\n", "\n", "net_input", "=", "torch", ".", "cat", "(", "(", "image", ",", "prev_output", ")", ",", "dim", "=", "1", ")", "if", "self", ".", "net", ".", "with_prev_mask", "else", "image", "\n", "output", "=", "self", ".", "net", "(", "net_input", ",", "points", ")", "\n", "\n", "# ====== refine =====", "\n", "images_focus", ",", "points_focus", ",", "rois", "=", "batch_data", "[", "'images_focus'", "]", ",", "batch_data", "[", "'points_focus'", "]", ",", "batch_data", "[", "'rois'", "]", "\n", "full_feature", ",", "full_logits", "=", "output", "[", "'feature'", "]", ",", "output", "[", "'instances'", "]", "\n", "bboxes", "=", "torch", ".", "chunk", "(", "rois", ",", "rois", ".", "shape", "[", "0", "]", ",", "dim", "=", "0", ")", "\n", "#print( len(bboxes), bboxes[0].shape, rois.shape  )", "\n", "refine_output", "=", "self", ".", "net", ".", "refine", "(", "images_focus", ",", "points_focus", ",", "full_feature", ",", "full_logits", ",", "bboxes", ")", "\n", "\n", "loss", "=", "0.0", "\n", "loss", "=", "self", ".", "add_loss", "(", "'instance_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'instances'", "]", ",", "batch_data", "[", "'instances'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'instance_click_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'instances'", "]", ",", "batch_data", "[", "'instances'", "]", ",", "output", "[", "'click_map'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'instance_aux_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'instances_aux'", "]", ",", "batch_data", "[", "'instances'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'trimap_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "refine_output", "[", "'trimap'", "]", ",", "batch_data", "[", "'trimap_focus'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'instance_refine_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "refine_output", "[", "'instances_refined'", "]", ",", "batch_data", "[", "'instances_focus'", "]", ",", "batch_data", "[", "'trimap_focus'", "]", ")", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                    ", "for", "m", "in", "metrics", ":", "\n", "                        ", "m", ".", "update", "(", "*", "(", "output", ".", "get", "(", "x", ")", "for", "x", "in", "m", ".", "pred_outputs", ")", ",", "\n", "*", "(", "batch_data", "[", "x", "]", "for", "x", "in", "m", ".", "gt_outputs", ")", ")", "\n", "", "", "", "", "return", "loss", ",", "losses_logging", ",", "batch_data", ",", "output", ",", "refine_output", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.add_loss": [[333, 345], ["loss_cfg.get", "loss_cfg.get", "loss_cfg.get.", "torch.mean", "lambda_loss_inputs"], "methods", ["None"], ["", "def", "add_loss", "(", "self", ",", "loss_name", ",", "total_loss", ",", "losses_logging", ",", "validation", ",", "lambda_loss_inputs", ")", ":", "\n", "        ", "loss_cfg", "=", "self", ".", "loss_cfg", "if", "not", "validation", "else", "self", ".", "val_loss_cfg", "\n", "loss_weight", "=", "loss_cfg", ".", "get", "(", "loss_name", "+", "'_weight'", ",", "0.0", ")", "\n", "if", "loss_weight", ">", "0.0", ":", "\n", "            ", "loss_criterion", "=", "loss_cfg", ".", "get", "(", "loss_name", ")", "\n", "loss", "=", "loss_criterion", "(", "*", "lambda_loss_inputs", "(", ")", ")", "\n", "loss", "=", "torch", ".", "mean", "(", "loss", ")", "\n", "losses_logging", "[", "loss_name", "]", "=", "loss", "\n", "loss", "=", "loss_weight", "*", "loss", "\n", "total_loss", "=", "total_loss", "+", "loss", "\n", "\n", "", "return", "total_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.save_visualization": [[346, 421], ["[].detach().cpu().numpy", "[].detach().cpu().numpy", "isegm.utils.vis.draw_points", "isegm.utils.vis.draw_points", "[].detach().cpu().numpy", "numpy.zeros_like", "isegm.utils.vis.draw_points", "isegm.utils.vis.draw_points", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "numpy.zeros_like", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "numpy.zeros_like", "isegm.utils.vis.draw_probmap", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "numpy.hstack().astype", "numpy.hstack().astype", "numpy.vstack", "focalclick_trainer.ISTrainer.save_visualization._save_image"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag"], ["", "def", "save_visualization", "(", "self", ",", "splitted_batch_data", ",", "outputs", ",", "refine_output", ",", "global_step", ",", "prefix", ")", ":", "\n", "        ", "output_images_path", "=", "self", ".", "cfg", ".", "VIS_PATH", "/", "prefix", "\n", "if", "self", ".", "task_prefix", ":", "\n", "            ", "output_images_path", "/=", "self", ".", "task_prefix", "\n", "\n", "", "if", "not", "output_images_path", ".", "exists", "(", ")", ":", "\n", "            ", "output_images_path", ".", "mkdir", "(", "parents", "=", "True", ")", "\n", "", "image_name_prefix", "=", "f'{global_step:06d}'", "\n", "\n", "def", "_save_image", "(", "suffix", ",", "image", ")", ":", "\n", "            ", "cv2", ".", "imwrite", "(", "str", "(", "output_images_path", "/", "f'{image_name_prefix}_{suffix}.jpg'", ")", ",", "\n", "image", ",", "[", "cv2", ".", "IMWRITE_JPEG_QUALITY", ",", "85", "]", ")", "\n", "\n", "", "points", "=", "splitted_batch_data", "[", "'points'", "]", "[", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "points_focus", "=", "splitted_batch_data", "[", "'points_focus'", "]", "[", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "\n", "images", "=", "splitted_batch_data", "[", "'images'", "]", "[", "0", "]", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "transpose", "(", "(", "1", ",", "2", ",", "0", ")", ")", "*", "255", "\n", "image_with_points", "=", "draw_points", "(", "images", ",", "points", "[", ":", "self", ".", "max_interactive_points", "]", ",", "(", "0", ",", "255", ",", "0", ")", ")", "\n", "image_with_points", "=", "draw_points", "(", "image_with_points", ",", "points", "[", "self", ".", "max_interactive_points", ":", "]", ",", "(", "0", ",", "0", ",", "255", ")", ")", "\n", "\n", "\n", "images_focus", "=", "splitted_batch_data", "[", "'images_focus'", "]", "[", "0", "]", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "transpose", "(", "(", "1", ",", "2", ",", "0", ")", ")", "*", "255", "\n", "\n", "instance_masks_focus", "=", "splitted_batch_data", "[", "'instances_focus'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "#gt_mask_focus = draw_probmap(instance_masks_focus)", "\n", "focus_color_mask", "=", "np", ".", "zeros_like", "(", "images_focus", ")", "\n", "focus_color_mask", "[", ":", ",", ":", ",", "0", "]", "=", "instance_masks_focus", "*", "255", "\n", "gt_masked_focus", "=", "0.5", "*", "images_focus", "+", "0.5", "*", "focus_color_mask", "\n", "\n", "images_focus_with_points", "=", "draw_points", "(", "gt_masked_focus", ",", "points_focus", "[", ":", "self", ".", "max_interactive_points", "]", ",", "(", "0", ",", "255", ",", "0", ")", ")", "\n", "images_focus_with_points", "=", "draw_points", "(", "images_focus_with_points", ",", "points_focus", "[", "self", ".", "max_interactive_points", ":", "]", ",", "(", "0", ",", "0", ",", "255", ")", ")", "\n", "\n", "\n", "instance_masks", "=", "splitted_batch_data", "[", "'instances'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "gt_mask", "=", "draw_probmap", "(", "instance_masks", ")", "\n", "gt_color_mask", "=", "np", ".", "zeros_like", "(", "images", ")", "\n", "gt_color_mask", "[", ":", ",", ":", ",", "0", "]", "=", "(", "instance_masks", ">", "0.5", ")", "*", "255", "\n", "gt_masked_full", "=", "0.5", "*", "images", "+", "0.5", "*", "gt_color_mask", "\n", "\n", "\n", "\n", "trimap_focus", "=", "splitted_batch_data", "[", "'trimap_focus'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "trimap_focus", "=", "draw_probmap", "(", "trimap_focus", ")", "\n", "\n", "prev_masks", "=", "splitted_batch_data", "[", "'prev_mask'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "prev_masks", "=", "draw_probmap", "(", "prev_masks", ")", "\n", "\n", "\n", "predicted_instance_masks", "=", "torch", ".", "sigmoid", "(", "outputs", "[", "'instances'", "]", ")", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "predicted_instance_masks", "=", "draw_probmap", "(", "predicted_instance_masks", ")", "\n", "\n", "predicted_trimap_focus", "=", "torch", ".", "sigmoid", "(", "refine_output", "[", "'trimap'", "]", ")", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "predicted_trimap_focus", "=", "draw_probmap", "(", "predicted_trimap_focus", ")", "\n", "\n", "predicted_mask_focus", "=", "torch", ".", "sigmoid", "(", "refine_output", "[", "'instances_refined'", "]", ")", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "pred_color_mask", "=", "np", ".", "zeros_like", "(", "images_focus", ")", "\n", "pred_color_mask", "[", ":", ",", ":", ",", "0", "]", "=", "(", "predicted_mask_focus", ">", "0.5", ")", "*", "255", "\n", "pred_masked_image", "=", "0.5", "*", "images_focus", "+", "0.5", "*", "pred_color_mask", "\n", "predicted_mask_focus", "=", "draw_probmap", "(", "predicted_mask_focus", ")", "\n", "\n", "image_with_points", "=", "add_tag", "(", "image_with_points", ",", "'Full Image'", ")", "\n", "gt_masked_full", "=", "add_tag", "(", "gt_masked_full", ",", "'Full GT'", ")", "\n", "predicted_instance_masks", "=", "add_tag", "(", "predicted_instance_masks", ",", "'Full Pred'", ")", "\n", "prev_masks", "=", "add_tag", "(", "prev_masks", ",", "'Prev Full Pred'", ")", "\n", "\n", "images_focus_with_points", "=", "add_tag", "(", "images_focus_with_points", ",", "'Refine Image'", ")", "\n", "predicted_mask_focus", "=", "add_tag", "(", "predicted_mask_focus", ",", "'Refine Pred'", ")", "\n", "pred_masked_image", "=", "add_tag", "(", "pred_masked_image", ",", "'Refine Pred'", ")", "\n", "predicted_trimap_focus", "=", "add_tag", "(", "predicted_trimap_focus", ",", "'Trimap Pred'", ")", "\n", "\n", "viz_image_full", "=", "np", ".", "hstack", "(", "(", "image_with_points", ",", "gt_masked_full", ",", "predicted_instance_masks", ",", "prev_masks", ")", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "viz_image_focus", "=", "np", ".", "hstack", "(", "(", "images_focus_with_points", ",", "predicted_mask_focus", ",", "pred_masked_image", ",", "predicted_trimap_focus", ")", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "viz_image", "=", "np", ".", "vstack", "(", "[", "viz_image_full", ",", "viz_image_focus", "]", ")", "\n", "\n", "_save_image", "(", "'focalclick_vis'", ",", "viz_image", "[", ":", ",", ":", ",", ":", ":", "-", "1", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer._load_weights": [[422, 437], ["os.path.isfile", "focalclick_trainer.load_weights", "RuntimeError", "list", "isegm.utils.log.logger.info", "focalclick_trainer.load_weights", "focalclick_trainer.ISTrainer.cfg.CHECKPOINTS_PATH.glob", "len", "str"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.load_weights", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.load_weights"], ["", "def", "_load_weights", "(", "self", ",", "net", ")", ":", "\n", "        ", "if", "self", ".", "cfg", ".", "weights", "is", "not", "None", ":", "\n", "            ", "if", "os", ".", "path", ".", "isfile", "(", "self", ".", "cfg", ".", "weights", ")", ":", "\n", "                ", "load_weights", "(", "net", ",", "self", ".", "cfg", ".", "weights", ")", "\n", "self", ".", "cfg", ".", "weights", "=", "None", "\n", "", "else", ":", "\n", "                ", "raise", "RuntimeError", "(", "f\"=> no checkpoint found at '{self.cfg.weights}'\"", ")", "\n", "", "", "elif", "self", ".", "cfg", ".", "resume_exp", "is", "not", "None", ":", "\n", "            ", "checkpoints", "=", "list", "(", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ".", "glob", "(", "f'{self.cfg.resume_prefix}*.pth'", ")", ")", "\n", "assert", "len", "(", "checkpoints", ")", "==", "1", "\n", "\n", "checkpoint_path", "=", "checkpoints", "[", "0", "]", "\n", "logger", ".", "info", "(", "f'Load checkpoint from path: {checkpoint_path}'", ")", "\n", "load_weights", "(", "net", ",", "str", "(", "checkpoint_path", ")", ")", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.ISTrainer.is_master": [[438, 441], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "is_master", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "cfg", ".", "local_rank", "==", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.get_next_points_removeall": [[446, 493], ["rois.cpu().numpy.cpu().numpy", "numpy.logical_and", "numpy.logical_and", "numpy.pad().astype", "numpy.pad().astype", "points.clone.clone", "range", "pred.cpu().numpy", "numpy.logical_not", "points.clone.size", "numpy.max", "numpy.max", "numpy.argwhere", "torch.tensor().to", "torch.tensor().to", "gt.cpu().numpy", "rois.cpu().numpy.cpu", "numpy.pad", "numpy.pad", "cv2.distanceTransform", "cv2.distanceTransform", "len", "pred.cpu", "max", "numpy.random.rand", "float", "float", "float", "float", "float", "float", "torch.tensor", "torch.tensor", "gt.cpu", "numpy.random.randint", "len"], "function", ["None"], ["", "", "def", "get_next_points_removeall", "(", "pred", ",", "gt", ",", "points", ",", "points_focus", ",", "rois", ",", "click_indx", ",", "pred_thresh", "=", "0.49", ",", "remove_prob", "=", "0.0", ")", ":", "\n", "    ", "assert", "click_indx", ">", "0", "\n", "pred", "=", "pred", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", ":", ",", "0", ",", ":", ",", ":", "]", "\n", "gt", "=", "gt", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", ":", ",", "0", ",", ":", ",", ":", "]", ">", "0.5", "\n", "rois", "=", "rois", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "h", ",", "w", "=", "gt", ".", "shape", "[", "-", "2", "]", ",", "gt", ".", "shape", "[", "-", "1", "]", "\n", "\n", "fn_mask", "=", "np", ".", "logical_and", "(", "gt", ",", "pred", "<", "pred_thresh", ")", "\n", "fp_mask", "=", "np", ".", "logical_and", "(", "np", ".", "logical_not", "(", "gt", ")", ",", "pred", ">", "pred_thresh", ")", "\n", "\n", "fn_mask", "=", "np", ".", "pad", "(", "fn_mask", ",", "(", "(", "0", ",", "0", ")", ",", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "fp_mask", "=", "np", ".", "pad", "(", "fp_mask", ",", "(", "(", "0", ",", "0", ")", ",", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "num_points", "=", "points", ".", "size", "(", "1", ")", "//", "2", "\n", "points", "=", "points", ".", "clone", "(", ")", "\n", "\n", "for", "bindx", "in", "range", "(", "fn_mask", ".", "shape", "[", "0", "]", ")", ":", "\n", "        ", "fn_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fn_mask", "[", "bindx", "]", ",", "cv2", ".", "DIST_L2", ",", "5", ")", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "fp_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fp_mask", "[", "bindx", "]", ",", "cv2", ".", "DIST_L2", ",", "5", ")", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "\n", "fn_max_dist", "=", "np", ".", "max", "(", "fn_mask_dt", ")", "\n", "fp_max_dist", "=", "np", ".", "max", "(", "fp_mask_dt", ")", "\n", "\n", "is_positive", "=", "fn_max_dist", ">", "fp_max_dist", "\n", "dt", "=", "fn_mask_dt", "if", "is_positive", "else", "fp_mask_dt", "\n", "inner_mask", "=", "dt", ">", "max", "(", "fn_max_dist", ",", "fp_max_dist", ")", "/", "2.0", "\n", "indices", "=", "np", ".", "argwhere", "(", "inner_mask", ")", "\n", "if", "len", "(", "indices", ")", ">", "0", ":", "\n", "            ", "coords", "=", "indices", "[", "np", ".", "random", ".", "randint", "(", "0", ",", "len", "(", "indices", ")", ")", "]", "\n", "if", "np", ".", "random", ".", "rand", "(", ")", "<", "remove_prob", ":", "\n", "                ", "points", "[", "bindx", "]", "=", "points", "[", "bindx", "]", "*", "0.0", "-", "1.0", "\n", "", "if", "is_positive", ":", "\n", "                ", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "0", "]", "=", "float", "(", "coords", "[", "0", "]", ")", "\n", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "1", "]", "=", "float", "(", "coords", "[", "1", "]", ")", "\n", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "2", "]", "=", "float", "(", "click_indx", ")", "\n", "", "else", ":", "\n", "                ", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "0", "]", "=", "float", "(", "coords", "[", "0", "]", ")", "\n", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "1", "]", "=", "float", "(", "coords", "[", "1", "]", ")", "\n", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "2", "]", "=", "float", "(", "click_indx", ")", "\n", "\n", "", "", "x1", ",", "y1", ",", "x2", ",", "y2", "=", "rois", "[", "bindx", "]", "\n", "point_focus", "=", "points", "[", "bindx", "]", "\n", "hc", ",", "wc", "=", "y2", "-", "y1", ",", "x2", "-", "x1", "\n", "ry", ",", "rx", "=", "h", "/", "hc", ",", "w", "/", "wc", "\n", "bias", "=", "torch", ".", "tensor", "(", "[", "y1", ",", "x1", ",", "0", "]", ")", ".", "to", "(", "points", ".", "device", ")", "\n", "ratio", "=", "torch", ".", "tensor", "(", "[", "ry", ",", "rx", ",", "1", "]", ")", ".", "to", "(", "points", ".", "device", ")", "\n", "points_focus", "[", "bindx", "]", "=", "(", "point_focus", "-", "bias", ")", "*", "ratio", "\n", "", "return", "points", ",", "points_focus", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.focalclick_trainer.load_weights": [[495, 507], ["model.state_dict", "set", "set", "print", "print", "print", "print", "model.state_dict.update", "model.load_state_dict", "torch.load", "new_state_dict.keys", "model.state_dict.keys"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_weights", "(", "model", ",", "path_to_weights", ")", ":", "\n", "    ", "current_state_dict", "=", "model", ".", "state_dict", "(", ")", "\n", "new_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "[", "'state_dict'", "]", "\n", "\n", "new_keys", "=", "set", "(", "new_state_dict", ".", "keys", "(", ")", ")", "\n", "old_keys", "=", "set", "(", "current_state_dict", ".", "keys", "(", ")", ")", "\n", "print", "(", "'='", "*", "10", ")", "\n", "print", "(", "' unexpected: '", ",", "new_keys", "-", "old_keys", ")", "\n", "print", "(", "' lacked: '", ",", "old_keys", "-", "new_keys", ")", "\n", "print", "(", "'='", "*", "10", ")", "\n", "current_state_dict", ".", "update", "(", "new_state_dict", ")", "\n", "model", ".", "load_state_dict", "(", "current_state_dict", ",", "strict", "=", "False", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.__init__": [[23, 116], ["copy.deepcopy", "copy.deepcopy", "isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "optimizer.get_optimizer", "baseline_trainer.ISTrainer._load_weights", "baseline_trainer.ISTrainer.to", "isegm.utils.log.TqdmToLogger", "baseline_trainer.ISTrainer.val_metrics.extend", "isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "lr_scheduler", "isegm.utils.distributed.get_sampler", "isegm.utils.distributed.get_sampler", "isegm.utils.distributed.get_dp_wrapper", "isegm.utils.serialization.get_config_repr", "range", "click_model.parameters", "click_model.to", "click_model.eval", "trainset.get_samples_number", "valset.get_samples_number", "baseline_trainer.ISTrainer.lr_scheduler.step"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.optimizer.get_optimizer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer._load_weights", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_sampler", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_sampler", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_dp_wrapper", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_config_repr", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "None", ",", "\n", "image_dump_interval", "=", "200", ",", "\n", "checkpoint_interval", "=", "10", ",", "\n", "tb_dump_period", "=", "25", ",", "\n", "max_interactive_points", "=", "0", ",", "\n", "lr_scheduler", "=", "None", ",", "\n", "metrics", "=", "None", ",", "\n", "additional_val_metrics", "=", "None", ",", "\n", "net_inputs", "=", "(", "'images'", ",", "'points'", ")", ",", "\n", "max_num_next_clicks", "=", "0", ",", "\n", "click_models", "=", "None", ",", "\n", "prev_mask_drop_prob", "=", "0.0", ",", "\n", ")", ":", "\n", "        ", "self", ".", "cfg", "=", "cfg", "\n", "self", ".", "model_cfg", "=", "model_cfg", "\n", "self", ".", "max_interactive_points", "=", "max_interactive_points", "\n", "self", ".", "loss_cfg", "=", "loss_cfg", "\n", "self", ".", "val_loss_cfg", "=", "deepcopy", "(", "loss_cfg", ")", "\n", "self", ".", "tb_dump_period", "=", "tb_dump_period", "\n", "self", ".", "net_inputs", "=", "net_inputs", "\n", "self", ".", "max_num_next_clicks", "=", "max_num_next_clicks", "\n", "\n", "self", ".", "click_models", "=", "click_models", "\n", "self", ".", "prev_mask_drop_prob", "=", "prev_mask_drop_prob", "\n", "\n", "if", "cfg", ".", "distributed", ":", "\n", "            ", "cfg", ".", "batch_size", "//=", "cfg", ".", "ngpus", "\n", "cfg", ".", "val_batch_size", "//=", "cfg", ".", "ngpus", "\n", "\n", "", "if", "metrics", "is", "None", ":", "\n", "            ", "metrics", "=", "[", "]", "\n", "", "self", ".", "train_metrics", "=", "metrics", "\n", "self", ".", "val_metrics", "=", "deepcopy", "(", "metrics", ")", "\n", "if", "additional_val_metrics", "is", "not", "None", ":", "\n", "            ", "self", ".", "val_metrics", ".", "extend", "(", "additional_val_metrics", ")", "\n", "\n", "", "self", ".", "checkpoint_interval", "=", "checkpoint_interval", "\n", "self", ".", "image_dump_interval", "=", "image_dump_interval", "\n", "self", ".", "task_prefix", "=", "''", "\n", "self", ".", "sw", "=", "None", "\n", "\n", "self", ".", "trainset", "=", "trainset", "\n", "self", ".", "valset", "=", "valset", "\n", "\n", "logger", ".", "info", "(", "f'Dataset of {trainset.get_samples_number()} samples was loaded for training.'", ")", "\n", "logger", ".", "info", "(", "f'Dataset of {valset.get_samples_number()} samples was loaded for validation.'", ")", "\n", "\n", "self", ".", "train_data", "=", "DataLoader", "(", "\n", "trainset", ",", "cfg", ".", "batch_size", ",", "\n", "sampler", "=", "get_sampler", "(", "trainset", ",", "shuffle", "=", "True", ",", "distributed", "=", "cfg", ".", "distributed", ")", ",", "\n", "drop_last", "=", "True", ",", "pin_memory", "=", "True", ",", "\n", "num_workers", "=", "cfg", ".", "workers", "\n", ")", "\n", "\n", "self", ".", "val_data", "=", "DataLoader", "(", "\n", "valset", ",", "cfg", ".", "val_batch_size", ",", "\n", "sampler", "=", "get_sampler", "(", "valset", ",", "shuffle", "=", "False", ",", "distributed", "=", "cfg", ".", "distributed", ")", ",", "\n", "drop_last", "=", "True", ",", "pin_memory", "=", "True", ",", "\n", "num_workers", "=", "cfg", ".", "workers", "\n", ")", "\n", "\n", "self", ".", "optim", "=", "get_optimizer", "(", "model", ",", "optimizer", ",", "optimizer_params", ")", "\n", "model", "=", "self", ".", "_load_weights", "(", "model", ")", "\n", "\n", "if", "cfg", ".", "multi_gpu", ":", "\n", "            ", "model", "=", "get_dp_wrapper", "(", "cfg", ".", "distributed", ")", "(", "model", ",", "device_ids", "=", "cfg", ".", "gpu_ids", ",", "\n", "output_device", "=", "cfg", ".", "gpu_ids", "[", "0", "]", ")", "\n", "\n", "", "if", "self", ".", "is_master", ":", "\n", "            ", "logger", ".", "info", "(", "model", ")", "\n", "logger", ".", "info", "(", "get_config_repr", "(", "model", ".", "_config", ")", ")", "\n", "\n", "", "self", ".", "device", "=", "cfg", ".", "device", "\n", "self", ".", "net", "=", "model", ".", "to", "(", "self", ".", "device", ")", "\n", "self", ".", "lr", "=", "optimizer_params", "[", "'lr'", "]", "\n", "\n", "if", "lr_scheduler", "is", "not", "None", ":", "\n", "            ", "self", ".", "lr_scheduler", "=", "lr_scheduler", "(", "optimizer", "=", "self", ".", "optim", ")", "\n", "if", "cfg", ".", "start_epoch", ">", "0", ":", "\n", "                ", "for", "_", "in", "range", "(", "cfg", ".", "start_epoch", ")", ":", "\n", "                    ", "self", ".", "lr_scheduler", ".", "step", "(", ")", "\n", "\n", "", "", "", "self", ".", "tqdm_out", "=", "TqdmToLogger", "(", "logger", ",", "level", "=", "logging", ".", "INFO", ")", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "for", "click_model", "in", "self", ".", "click_models", ":", "\n", "                ", "for", "param", "in", "click_model", ".", "parameters", "(", ")", ":", "\n", "                    ", "param", ".", "requires_grad", "=", "False", "\n", "", "click_model", ".", "to", "(", "self", ".", "device", ")", "\n", "click_model", ".", "eval", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.run": [[117, 125], ["isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "range", "baseline_trainer.ISTrainer.training"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.training"], ["", "", "", "def", "run", "(", "self", ",", "num_epochs", ",", "start_epoch", "=", "None", ",", "validation", "=", "True", ")", ":", "\n", "        ", "if", "start_epoch", "is", "None", ":", "\n", "            ", "start_epoch", "=", "self", ".", "cfg", ".", "start_epoch", "\n", "\n", "", "logger", ".", "info", "(", "f'Starting Epoch: {start_epoch}'", ")", "\n", "logger", ".", "info", "(", "f'Total Epochs: {num_epochs}'", ")", "\n", "for", "epoch", "in", "range", "(", "start_epoch", ",", "num_epochs", ")", ":", "\n", "            ", "self", ".", "training", "(", "epoch", ")", "\n", "#if validation:", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.training": [[128, 210], ["baseline_trainer.ISTrainer.net.train", "enumerate", "hasattr", "isegm.utils.log.SummaryWriterAvg", "baseline_trainer.ISTrainer.train_data.sampler.set_epoch", "baseline_trainer.ISTrainer.task_prefix.capitalize", "tqdm.tqdm.tqdm", "metric.reset_epoch_stats", "isegm.utils.distributed.reduce_loss_dict", "losses_logging[].item", "isegm.utils.misc.save_checkpoint", "isinstance", "baseline_trainer.ISTrainer.lr_scheduler.step", "baseline_trainer.ISTrainer.optim.zero_grad", "scaler.scale().backward", "scaler.step", "scaler.update", "baseline_trainer.ISTrainer.batch_forward", "baseline_trainer.ISTrainer.optim.zero_grad", "loss.backward", "baseline_trainer.ISTrainer.optim.step", "losses_logging.items", "baseline_trainer.ISTrainer.loss_cfg.items", "baseline_trainer.ISTrainer.sw.add_scalar", "tbar.set_description", "baseline_trainer.ISTrainer.sw.add_scalar", "isegm.utils.misc.save_checkpoint", "str", "len", "torch.cuda.amp.autocast", "baseline_trainer.ISTrainer.batch_forward", "baseline_trainer.ISTrainer.sw.add_scalar", "baseline_trainer.ISTrainer.save_visualization", "metric.log_states", "scaler.scale", "hasattr", "v.log_states", "metric.get_epoch_value", "loss_value.item", "baseline_trainer.ISTrainer.loss_cfg.get", "hasattr", "baseline_trainer.ISTrainer.lr_scheduler.get_lr"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.reset_epoch_stats", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.save_checkpoint", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.save_checkpoint", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.save_visualization", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.get_epoch_value"], ["", "", "def", "training", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "if", "self", ".", "sw", "is", "None", "and", "self", ".", "is_master", ":", "\n", "            ", "self", ".", "sw", "=", "SummaryWriterAvg", "(", "log_dir", "=", "str", "(", "self", ".", "cfg", ".", "LOGS_PATH", ")", ",", "\n", "flush_secs", "=", "10", ",", "dump_period", "=", "self", ".", "tb_dump_period", ")", "\n", "\n", "", "if", "self", ".", "cfg", ".", "distributed", ":", "\n", "            ", "self", ".", "train_data", ".", "sampler", ".", "set_epoch", "(", "epoch", ")", "\n", "\n", "", "log_prefix", "=", "'Train'", "+", "self", ".", "task_prefix", ".", "capitalize", "(", ")", "\n", "tbar", "=", "tqdm", "(", "self", ".", "train_data", ",", "file", "=", "self", ".", "tqdm_out", ",", "ncols", "=", "100", ")", "if", "self", ".", "is_master", "else", "self", ".", "train_data", "\n", "\n", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "            ", "metric", ".", "reset_epoch_stats", "(", ")", "\n", "\n", "", "self", ".", "net", ".", "train", "(", ")", "\n", "#for m in self.net.feature_extractor.modules():", "\n", "#        m.eval()", "\n", "\n", "train_loss", "=", "0.0", "\n", "for", "i", ",", "batch_data", "in", "enumerate", "(", "tbar", ")", ":", "\n", "            ", "global_step", "=", "epoch", "*", "len", "(", "self", ".", "train_data", ")", "+", "i", "\n", "use_fp16", "=", "False", "\n", "if", "use_fp16", ":", "\n", "                ", "self", ".", "optim", ".", "zero_grad", "(", ")", "\n", "with", "autocast", "(", ")", ":", "\n", "                    ", "loss", ",", "losses_logging", ",", "splitted_batch_data", ",", "outputs", "=", "self", ".", "batch_forward", "(", "batch_data", ")", "\n", "", "scaler", ".", "scale", "(", "loss", ")", ".", "backward", "(", ")", "\n", "scaler", ".", "step", "(", "self", ".", "optim", ")", "\n", "scaler", ".", "update", "(", ")", "\n", "", "else", ":", "\n", "                ", "loss", ",", "losses_logging", ",", "splitted_batch_data", ",", "outputs", "=", "self", ".", "batch_forward", "(", "batch_data", ")", "\n", "self", ".", "optim", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optim", ".", "step", "(", ")", "\n", "\n", "", "losses_logging", "[", "'overall'", "]", "=", "loss", "\n", "reduce_loss_dict", "(", "losses_logging", ")", "\n", "\n", "train_loss", "+=", "losses_logging", "[", "'overall'", "]", ".", "item", "(", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "for", "loss_name", ",", "loss_value", "in", "losses_logging", ".", "items", "(", ")", ":", "\n", "                    ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Losses/{loss_name}'", ",", "\n", "value", "=", "loss_value", ".", "item", "(", ")", ",", "\n", "global_step", "=", "global_step", ")", "\n", "\n", "", "for", "k", ",", "v", "in", "self", ".", "loss_cfg", ".", "items", "(", ")", ":", "\n", "                    ", "if", "'_loss'", "in", "k", "and", "hasattr", "(", "v", ",", "'log_states'", ")", "and", "self", ".", "loss_cfg", ".", "get", "(", "k", "+", "'_weight'", ",", "0.0", ")", ">", "0", ":", "\n", "                        ", "v", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Losses/{k}'", ",", "global_step", ")", "\n", "\n", "", "", "if", "self", ".", "image_dump_interval", ">", "0", "and", "global_step", "%", "self", ".", "image_dump_interval", "==", "0", ":", "\n", "                    ", "self", ".", "save_visualization", "(", "splitted_batch_data", ",", "outputs", ",", "global_step", ",", "prefix", "=", "'train'", ")", "\n", "\n", "", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}States/learning_rate'", ",", "\n", "value", "=", "self", ".", "lr", "if", "not", "hasattr", "(", "self", ",", "'lr_scheduler'", ")", "else", "self", ".", "lr_scheduler", ".", "get_lr", "(", ")", "[", "-", "1", "]", ",", "\n", "global_step", "=", "global_step", ")", "\n", "\n", "tbar", ".", "set_description", "(", "f'Epoch {epoch}, training loss {train_loss/(i+1):.4f}'", ")", "\n", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "                    ", "metric", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Metrics/{metric.name}'", ",", "global_step", ")", "\n", "\n", "", "", "", "if", "self", ".", "is_master", ":", "\n", "            ", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Metrics/{metric.name}'", ",", "\n", "value", "=", "metric", ".", "get_epoch_value", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n", "", "save_checkpoint", "(", "self", ".", "net", ",", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ",", "prefix", "=", "self", ".", "task_prefix", ",", "\n", "epoch", "=", "None", ",", "multi_gpu", "=", "self", ".", "cfg", ".", "multi_gpu", ")", "\n", "\n", "if", "isinstance", "(", "self", ".", "checkpoint_interval", ",", "(", "list", ",", "tuple", ")", ")", ":", "\n", "                ", "checkpoint_interval", "=", "[", "x", "for", "x", "in", "self", ".", "checkpoint_interval", "if", "x", "[", "0", "]", "<=", "epoch", "]", "[", "-", "1", "]", "[", "1", "]", "\n", "", "else", ":", "\n", "                ", "checkpoint_interval", "=", "self", ".", "checkpoint_interval", "\n", "\n", "", "if", "epoch", "%", "checkpoint_interval", "==", "0", ":", "\n", "                ", "save_checkpoint", "(", "self", ".", "net", ",", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ",", "prefix", "=", "self", ".", "task_prefix", ",", "\n", "epoch", "=", "epoch", ",", "multi_gpu", "=", "self", ".", "cfg", ".", "multi_gpu", ")", "\n", "\n", "", "", "if", "hasattr", "(", "self", ",", "'lr_scheduler'", ")", ":", "\n", "            ", "self", ".", "lr_scheduler", ".", "step", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.validation": [[211, 251], ["collections.defaultdict", "baseline_trainer.ISTrainer.net.eval", "enumerate", "isegm.utils.log.SummaryWriterAvg", "baseline_trainer.ISTrainer.task_prefix.capitalize", "tqdm.tqdm.tqdm", "metric.reset_epoch_stats", "baseline_trainer.ISTrainer.batch_forward", "isegm.utils.distributed.reduce_loss_dict", "batch_losses_logging.items", "batch_losses_logging[].item", "collections.defaultdict.items", "losses_logging[].append", "tbar.set_description", "baseline_trainer.ISTrainer.sw.add_scalar", "baseline_trainer.ISTrainer.sw.add_scalar", "str", "len", "loss_value.item", "metric.log_states", "numpy.array().mean", "metric.get_epoch_value", "numpy.array"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.reset_epoch_stats", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.get_epoch_value"], ["", "", "def", "validation", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "if", "self", ".", "sw", "is", "None", "and", "self", ".", "is_master", ":", "\n", "            ", "self", ".", "sw", "=", "SummaryWriterAvg", "(", "log_dir", "=", "str", "(", "self", ".", "cfg", ".", "LOGS_PATH", ")", ",", "\n", "flush_secs", "=", "10", ",", "dump_period", "=", "self", ".", "tb_dump_period", ")", "\n", "\n", "", "log_prefix", "=", "'Val'", "+", "self", ".", "task_prefix", ".", "capitalize", "(", ")", "\n", "tbar", "=", "tqdm", "(", "self", ".", "val_data", ",", "file", "=", "self", ".", "tqdm_out", ",", "ncols", "=", "100", ")", "if", "self", ".", "is_master", "else", "self", ".", "val_data", "\n", "\n", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "            ", "metric", ".", "reset_epoch_stats", "(", ")", "\n", "\n", "", "val_loss", "=", "0", "\n", "losses_logging", "=", "defaultdict", "(", "list", ")", "\n", "\n", "self", ".", "net", ".", "eval", "(", ")", "\n", "for", "i", ",", "batch_data", "in", "enumerate", "(", "tbar", ")", ":", "\n", "            ", "global_step", "=", "epoch", "*", "len", "(", "self", ".", "val_data", ")", "+", "i", "\n", "loss", ",", "batch_losses_logging", ",", "splitted_batch_data", ",", "outputs", "=", "self", ".", "batch_forward", "(", "batch_data", ",", "validation", "=", "True", ")", "\n", "\n", "batch_losses_logging", "[", "'overall'", "]", "=", "loss", "\n", "reduce_loss_dict", "(", "batch_losses_logging", ")", "\n", "for", "loss_name", ",", "loss_value", "in", "batch_losses_logging", ".", "items", "(", ")", ":", "\n", "                ", "losses_logging", "[", "loss_name", "]", ".", "append", "(", "loss_value", ".", "item", "(", ")", ")", "\n", "\n", "", "val_loss", "+=", "batch_losses_logging", "[", "'overall'", "]", ".", "item", "(", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "tbar", ".", "set_description", "(", "f'Epoch {epoch}, validation loss: {val_loss/(i + 1):.4f}'", ")", "\n", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "                    ", "metric", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Metrics/{metric.name}'", ",", "global_step", ")", "\n", "\n", "", "", "", "if", "self", ".", "is_master", ":", "\n", "            ", "for", "loss_name", ",", "loss_values", "in", "losses_logging", ".", "items", "(", ")", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Losses/{loss_name}'", ",", "value", "=", "np", ".", "array", "(", "loss_values", ")", ".", "mean", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n", "", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Metrics/{metric.name}'", ",", "value", "=", "metric", ".", "get_epoch_value", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.batch_forward": [[252, 312], ["dict", "torch.set_grad_enabled", "baseline_trainer.ISTrainer.net", "baseline_trainer.ISTrainer.add_loss", "baseline_trainer.ISTrainer.add_loss", "baseline_trainer.ISTrainer.add_loss", "v.to", "image.clone", "gt_mask.clone", "get_next_points.clone", "torch.zeros_like", "torch.no_grad", "random.randint", "range", "torch.cat", "batch_data.items", "torch.sigmoid", "baseline_trainer.get_next_points", "torch.zeros_like", "torch.no_grad", "baseline_trainer.ISTrainer.net.eval", "torch.cat", "baseline_trainer.ISTrainer.net.train", "numpy.random.random", "m.update", "len", "eval_model", "torch.sigmoid.size", "baseline_trainer.ISTrainer.get"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.get_next_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "", "", "def", "batch_forward", "(", "self", ",", "batch_data", ",", "validation", "=", "False", ")", ":", "\n", "        ", "metrics", "=", "self", ".", "val_metrics", "if", "validation", "else", "self", ".", "train_metrics", "\n", "losses_logging", "=", "dict", "(", ")", "\n", "\n", "with", "torch", ".", "set_grad_enabled", "(", "not", "validation", ")", ":", "\n", "            ", "batch_data", "=", "{", "k", ":", "v", ".", "to", "(", "self", ".", "device", ")", "for", "k", ",", "v", "in", "batch_data", ".", "items", "(", ")", "}", "\n", "image", ",", "gt_mask", ",", "points", "=", "batch_data", "[", "'images'", "]", ",", "batch_data", "[", "'instances'", "]", ",", "batch_data", "[", "'points'", "]", "\n", "orig_image", ",", "orig_gt_mask", ",", "orig_points", "=", "image", ".", "clone", "(", ")", ",", "gt_mask", ".", "clone", "(", ")", ",", "points", ".", "clone", "(", ")", "\n", "prev_output", "=", "torch", ".", "zeros_like", "(", "image", ",", "dtype", "=", "torch", ".", "float32", ")", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", "\n", "last_click_indx", "=", "None", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "num_iters", "=", "random", ".", "randint", "(", "0", ",", "self", ".", "max_num_next_clicks", ")", "\n", "\n", "for", "click_indx", "in", "range", "(", "num_iters", ")", ":", "\n", "                    ", "last_click_indx", "=", "click_indx", "\n", "\n", "if", "not", "validation", ":", "\n", "                        ", "self", ".", "net", ".", "eval", "(", ")", "\n", "\n", "", "if", "self", ".", "click_models", "is", "None", "or", "click_indx", ">=", "len", "(", "self", ".", "click_models", ")", ":", "\n", "                        ", "eval_model", "=", "self", ".", "net", "\n", "", "else", ":", "\n", "                        ", "eval_model", "=", "self", ".", "click_models", "[", "click_indx", "]", "\n", "\n", "\n", "", "net_input", "=", "torch", ".", "cat", "(", "(", "image", ",", "prev_output", ")", ",", "dim", "=", "1", ")", "if", "self", ".", "net", ".", "with_prev_mask", "else", "image", "\n", "prev_output", "=", "torch", ".", "sigmoid", "(", "eval_model", "(", "net_input", ",", "points", ")", "[", "'instances'", "]", ")", "\n", "points", "=", "get_next_points", "(", "prev_output", ",", "orig_gt_mask", ",", "points", ",", "click_indx", "+", "1", ")", "\n", "\n", "if", "not", "validation", ":", "\n", "                        ", "self", ".", "net", ".", "train", "(", ")", "\n", "\n", "", "", "if", "self", ".", "net", ".", "with_prev_mask", "and", "self", ".", "prev_mask_drop_prob", ">", "0", "and", "last_click_indx", "is", "not", "None", ":", "\n", "                    ", "zero_mask", "=", "np", ".", "random", ".", "random", "(", "size", "=", "prev_output", ".", "size", "(", "0", ")", ")", "<", "self", ".", "prev_mask_drop_prob", "\n", "prev_output", "[", "zero_mask", "]", "=", "torch", ".", "zeros_like", "(", "prev_output", "[", "zero_mask", "]", ")", "\n", "\n", "", "", "batch_data", "[", "'points'", "]", "=", "points", "\n", "batch_data", "[", "'prev_mask'", "]", "=", "prev_output", "\n", "\n", "net_input", "=", "torch", ".", "cat", "(", "(", "image", ",", "prev_output", ")", ",", "dim", "=", "1", ")", "if", "self", ".", "net", ".", "with_prev_mask", "else", "image", "\n", "output", "=", "self", ".", "net", "(", "net_input", ",", "points", ")", "\n", "\n", "\n", "loss", "=", "0.0", "\n", "loss", "=", "self", ".", "add_loss", "(", "'instance_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'instances'", "]", ",", "batch_data", "[", "'instances'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'click_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'instances'", "]", ",", "batch_data", "[", "'instances'", "]", ",", "output", "[", "'click_map'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'instance_aux_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'instances_aux'", "]", ",", "batch_data", "[", "'instances'", "]", ")", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                    ", "for", "m", "in", "metrics", ":", "\n", "                        ", "m", ".", "update", "(", "*", "(", "output", ".", "get", "(", "x", ")", "for", "x", "in", "m", ".", "pred_outputs", ")", ",", "\n", "*", "(", "batch_data", "[", "x", "]", "for", "x", "in", "m", ".", "gt_outputs", ")", ")", "\n", "", "", "", "", "return", "loss", ",", "losses_logging", ",", "batch_data", ",", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.add_loss": [[313, 325], ["loss_cfg.get", "loss_cfg.get", "loss_cfg.get.", "torch.mean", "lambda_loss_inputs"], "methods", ["None"], ["", "def", "add_loss", "(", "self", ",", "loss_name", ",", "total_loss", ",", "losses_logging", ",", "validation", ",", "lambda_loss_inputs", ")", ":", "\n", "        ", "loss_cfg", "=", "self", ".", "loss_cfg", "if", "not", "validation", "else", "self", ".", "val_loss_cfg", "\n", "loss_weight", "=", "loss_cfg", ".", "get", "(", "loss_name", "+", "'_weight'", ",", "0.0", ")", "\n", "if", "loss_weight", ">", "0.0", ":", "\n", "            ", "loss_criterion", "=", "loss_cfg", ".", "get", "(", "loss_name", ")", "\n", "loss", "=", "loss_criterion", "(", "*", "lambda_loss_inputs", "(", ")", ")", "\n", "loss", "=", "torch", ".", "mean", "(", "loss", ")", "\n", "losses_logging", "[", "loss_name", "]", "=", "loss", "\n", "loss", "=", "loss_weight", "*", "loss", "\n", "total_loss", "=", "total_loss", "+", "loss", "\n", "\n", "", "return", "total_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.save_visualization": [[326, 377], ["[].detach().cpu().numpy", "isegm.utils.vis.draw_points", "isegm.utils.vis.draw_points", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "numpy.zeros_like", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "numpy.zeros_like", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "numpy.zeros_like", "isegm.utils.vis.draw_probmap", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "numpy.hstack().astype", "baseline_trainer.ISTrainer.save_visualization._save_image"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag"], ["", "def", "save_visualization", "(", "self", ",", "splitted_batch_data", ",", "outputs", ",", "global_step", ",", "prefix", ")", ":", "\n", "        ", "output_images_path", "=", "self", ".", "cfg", ".", "VIS_PATH", "/", "prefix", "\n", "if", "self", ".", "task_prefix", ":", "\n", "            ", "output_images_path", "/=", "self", ".", "task_prefix", "\n", "\n", "", "if", "not", "output_images_path", ".", "exists", "(", ")", ":", "\n", "            ", "output_images_path", ".", "mkdir", "(", "parents", "=", "True", ")", "\n", "", "image_name_prefix", "=", "f'{global_step:06d}'", "\n", "\n", "def", "_save_image", "(", "suffix", ",", "image", ")", ":", "\n", "            ", "cv2", ".", "imwrite", "(", "str", "(", "output_images_path", "/", "f'{image_name_prefix}_{suffix}.jpg'", ")", ",", "\n", "image", ",", "[", "cv2", ".", "IMWRITE_JPEG_QUALITY", ",", "85", "]", ")", "\n", "\n", "", "points", "=", "splitted_batch_data", "[", "'points'", "]", "[", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "images", "=", "splitted_batch_data", "[", "'images'", "]", "[", "0", "]", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "transpose", "(", "(", "1", ",", "2", ",", "0", ")", ")", "*", "255", "\n", "image_with_points", "=", "draw_points", "(", "images", ",", "points", "[", ":", "self", ".", "max_interactive_points", "]", ",", "(", "0", ",", "255", ",", "0", ")", ")", "\n", "image_with_points", "=", "draw_points", "(", "image_with_points", ",", "points", "[", "self", ".", "max_interactive_points", ":", "]", ",", "(", "0", ",", "0", ",", "255", ")", ")", "\n", "\n", "instance_masks", "=", "splitted_batch_data", "[", "'instances'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "gt_mask", "=", "draw_probmap", "(", "instance_masks", ")", "\n", "gt_color_mask", "=", "np", ".", "zeros_like", "(", "images", ")", "\n", "gt_color_mask", "[", ":", ",", ":", ",", "0", "]", "=", "(", "instance_masks", ">", "0.5", ")", "*", "255", "\n", "gt_masked_image", "=", "0.5", "*", "images", "+", "0.5", "*", "gt_color_mask", "#vis", "\n", "\n", "prev_masks", "=", "splitted_batch_data", "[", "'prev_mask'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "prev_masks", "=", "draw_probmap", "(", "prev_masks", ")", "\n", "\n", "\n", "predicted_instance_masks", "=", "torch", ".", "sigmoid", "(", "outputs", "[", "'instances'", "]", ")", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "pred_color_mask", "=", "np", ".", "zeros_like", "(", "images", ")", "\n", "pred_color_mask", "[", ":", ",", ":", ",", "0", "]", "=", "(", "predicted_instance_masks", ">", "0.5", ")", "*", "255", "\n", "#pred_color_mask[:,:,0] = (predicted_instance_masks) * 255", "\n", "pred_masked_image", "=", "0.5", "*", "images", "+", "0.5", "*", "pred_color_mask", "\n", "predicted_instance_masks", "=", "draw_probmap", "(", "predicted_instance_masks", ")", "\n", "\n", "predicted_aux_masks", "=", "torch", ".", "sigmoid", "(", "outputs", "[", "'instances_aux'", "]", ")", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "pred_color_mask_aux", "=", "np", ".", "zeros_like", "(", "images", ")", "\n", "#pred_color_mask_fdm[:,:,0] = (predicted_fdm_masks > 0.5) * 255", "\n", "pred_color_mask_aux", "[", ":", ",", ":", ",", "0", "]", "=", "(", "predicted_aux_masks", ")", "*", "255", "\n", "pred_aux_image", "=", "0.5", "*", "images", "+", "0.5", "*", "pred_color_mask_aux", "\n", "predicted_aux_masks", "=", "draw_probmap", "(", "predicted_aux_masks", ")", "\n", "\n", "image_with_points", "=", "add_tag", "(", "image_with_points", ",", "'Image with Points'", ")", "\n", "gt_masked_image", "=", "add_tag", "(", "gt_masked_image", ",", "'Ground Truth Mask'", ")", "\n", "pred_masked_image", "=", "add_tag", "(", "pred_masked_image", ",", "'Prediction'", ")", "\n", "pred_aux_image", "=", "add_tag", "(", "pred_aux_image", ",", "'Aux Prediction'", ")", "\n", "\n", "viz_image_full", "=", "np", ".", "hstack", "(", "(", "image_with_points", ",", "gt_masked_image", ",", "pred_masked_image", ",", "pred_aux_image", ")", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "viz_image", "=", "viz_image_full", "\n", "\n", "_save_image", "(", "'iseg_baseline_vis'", ",", "viz_image", "[", ":", ",", ":", ",", ":", ":", "-", "1", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer._load_weights": [[378, 393], ["os.path.isfile", "baseline_trainer.load_weights", "RuntimeError", "list", "isegm.utils.log.logger.info", "baseline_trainer.load_weights", "baseline_trainer.ISTrainer.cfg.CHECKPOINTS_PATH.glob", "len", "str"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.load_weights", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.load_weights"], ["", "def", "_load_weights", "(", "self", ",", "net", ")", ":", "\n", "        ", "if", "self", ".", "cfg", ".", "weights", "is", "not", "None", ":", "\n", "            ", "if", "os", ".", "path", ".", "isfile", "(", "self", ".", "cfg", ".", "weights", ")", ":", "\n", "                ", "load_weights", "(", "net", ",", "self", ".", "cfg", ".", "weights", ")", "\n", "self", ".", "cfg", ".", "weights", "=", "None", "\n", "", "else", ":", "\n", "                ", "raise", "RuntimeError", "(", "f\"=> no checkpoint found at '{self.cfg.weights}'\"", ")", "\n", "", "", "elif", "self", ".", "cfg", ".", "resume_exp", "is", "not", "None", ":", "\n", "            ", "checkpoints", "=", "list", "(", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ".", "glob", "(", "f'{self.cfg.resume_prefix}*.pth'", ")", ")", "\n", "assert", "len", "(", "checkpoints", ")", "==", "1", "\n", "\n", "checkpoint_path", "=", "checkpoints", "[", "0", "]", "\n", "logger", ".", "info", "(", "f'Load checkpoint from path: {checkpoint_path}'", ")", "\n", "load_weights", "(", "net", ",", "str", "(", "checkpoint_path", ")", ")", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.ISTrainer.is_master": [[394, 397], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "is_master", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "cfg", ".", "local_rank", "==", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.get_next_points": [[401, 437], ["numpy.logical_and", "numpy.logical_and", "numpy.pad().astype", "numpy.pad().astype", "points.clone.clone", "range", "pred.cpu().numpy", "numpy.logical_not", "points.clone.size", "numpy.max", "numpy.max", "numpy.argwhere", "gt.cpu().numpy", "numpy.pad", "numpy.pad", "cv2.distanceTransform", "cv2.distanceTransform", "len", "pred.cpu", "max", "float", "float", "float", "float", "float", "float", "gt.cpu", "numpy.random.randint", "len"], "function", ["None"], ["", "", "def", "get_next_points", "(", "pred", ",", "gt", ",", "points", ",", "click_indx", ",", "pred_thresh", "=", "0.49", ")", ":", "\n", "    ", "assert", "click_indx", ">", "0", "\n", "pred", "=", "pred", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", ":", ",", "0", ",", ":", ",", ":", "]", "\n", "gt", "=", "gt", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", ":", ",", "0", ",", ":", ",", ":", "]", ">", "0.5", "\n", "\n", "fn_mask", "=", "np", ".", "logical_and", "(", "gt", ",", "pred", "<", "pred_thresh", ")", "\n", "fp_mask", "=", "np", ".", "logical_and", "(", "np", ".", "logical_not", "(", "gt", ")", ",", "pred", ">", "pred_thresh", ")", "\n", "\n", "fn_mask", "=", "np", ".", "pad", "(", "fn_mask", ",", "(", "(", "0", ",", "0", ")", ",", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "fp_mask", "=", "np", ".", "pad", "(", "fp_mask", ",", "(", "(", "0", ",", "0", ")", ",", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "num_points", "=", "points", ".", "size", "(", "1", ")", "//", "2", "\n", "points", "=", "points", ".", "clone", "(", ")", "\n", "\n", "for", "bindx", "in", "range", "(", "fn_mask", ".", "shape", "[", "0", "]", ")", ":", "\n", "        ", "fn_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fn_mask", "[", "bindx", "]", ",", "cv2", ".", "DIST_L2", ",", "5", ")", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "fp_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fp_mask", "[", "bindx", "]", ",", "cv2", ".", "DIST_L2", ",", "5", ")", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "\n", "fn_max_dist", "=", "np", ".", "max", "(", "fn_mask_dt", ")", "\n", "fp_max_dist", "=", "np", ".", "max", "(", "fp_mask_dt", ")", "\n", "\n", "is_positive", "=", "fn_max_dist", ">", "fp_max_dist", "\n", "dt", "=", "fn_mask_dt", "if", "is_positive", "else", "fp_mask_dt", "\n", "inner_mask", "=", "dt", ">", "max", "(", "fn_max_dist", ",", "fp_max_dist", ")", "/", "2.0", "\n", "indices", "=", "np", ".", "argwhere", "(", "inner_mask", ")", "\n", "if", "len", "(", "indices", ")", ">", "0", ":", "\n", "            ", "coords", "=", "indices", "[", "np", ".", "random", ".", "randint", "(", "0", ",", "len", "(", "indices", ")", ")", "]", "\n", "if", "is_positive", ":", "\n", "                ", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "0", "]", "=", "float", "(", "coords", "[", "0", "]", ")", "\n", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "1", "]", "=", "float", "(", "coords", "[", "1", "]", ")", "\n", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "2", "]", "=", "float", "(", "click_indx", ")", "\n", "", "else", ":", "\n", "                ", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "0", "]", "=", "float", "(", "coords", "[", "0", "]", ")", "\n", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "1", "]", "=", "float", "(", "coords", "[", "1", "]", ")", "\n", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "2", "]", "=", "float", "(", "click_indx", ")", "\n", "\n", "", "", "", "return", "points", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.load_weights": [[440, 452], ["model.state_dict", "set", "set", "print", "print", "print", "print", "model.state_dict.update", "model.load_state_dict", "torch.load", "new_state_dict.keys", "model.state_dict.keys"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_weights", "(", "model", ",", "path_to_weights", ")", ":", "\n", "    ", "current_state_dict", "=", "model", ".", "state_dict", "(", ")", "\n", "new_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "[", "'state_dict'", "]", "\n", "\n", "new_keys", "=", "set", "(", "new_state_dict", ".", "keys", "(", ")", ")", "\n", "old_keys", "=", "set", "(", "current_state_dict", ".", "keys", "(", ")", ")", "\n", "print", "(", "'='", "*", "10", ")", "\n", "print", "(", "' unexpected: '", ",", "new_keys", "-", "old_keys", ")", "\n", "print", "(", "' lacked: '", ",", "old_keys", "-", "new_keys", ")", "\n", "print", "(", "'='", "*", "10", ")", "\n", "current_state_dict", ".", "update", "(", "new_state_dict", ")", "\n", "model", ".", "load_state_dict", "(", "current_state_dict", ",", "strict", "=", "False", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.__init__": [[23, 116], ["copy.deepcopy", "copy.deepcopy", "isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "optimizer.get_optimizer", "cdnet_trainer.ISTrainer._load_weights", "cdnet_trainer.ISTrainer.to", "isegm.utils.log.TqdmToLogger", "cdnet_trainer.ISTrainer.val_metrics.extend", "isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "lr_scheduler", "isegm.utils.distributed.get_sampler", "isegm.utils.distributed.get_sampler", "isegm.utils.distributed.get_dp_wrapper", "isegm.utils.serialization.get_config_repr", "range", "click_model.parameters", "click_model.to", "click_model.eval", "trainset.get_samples_number", "valset.get_samples_number", "cdnet_trainer.ISTrainer.lr_scheduler.step"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.optimizer.get_optimizer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer._load_weights", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_sampler", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_sampler", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.get_dp_wrapper", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.get_config_repr", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "None", ",", "\n", "image_dump_interval", "=", "200", ",", "\n", "checkpoint_interval", "=", "10", ",", "\n", "tb_dump_period", "=", "25", ",", "\n", "max_interactive_points", "=", "0", ",", "\n", "lr_scheduler", "=", "None", ",", "\n", "metrics", "=", "None", ",", "\n", "additional_val_metrics", "=", "None", ",", "\n", "net_inputs", "=", "(", "'images'", ",", "'points'", ")", ",", "\n", "max_num_next_clicks", "=", "0", ",", "\n", "click_models", "=", "None", ",", "\n", "prev_mask_drop_prob", "=", "0.0", ",", "\n", ")", ":", "\n", "        ", "self", ".", "cfg", "=", "cfg", "\n", "self", ".", "model_cfg", "=", "model_cfg", "\n", "self", ".", "max_interactive_points", "=", "max_interactive_points", "\n", "self", ".", "loss_cfg", "=", "loss_cfg", "\n", "self", ".", "val_loss_cfg", "=", "deepcopy", "(", "loss_cfg", ")", "\n", "self", ".", "tb_dump_period", "=", "tb_dump_period", "\n", "self", ".", "net_inputs", "=", "net_inputs", "\n", "self", ".", "max_num_next_clicks", "=", "max_num_next_clicks", "\n", "\n", "self", ".", "click_models", "=", "click_models", "\n", "self", ".", "prev_mask_drop_prob", "=", "prev_mask_drop_prob", "\n", "\n", "if", "cfg", ".", "distributed", ":", "\n", "            ", "cfg", ".", "batch_size", "//=", "cfg", ".", "ngpus", "\n", "cfg", ".", "val_batch_size", "//=", "cfg", ".", "ngpus", "\n", "\n", "", "if", "metrics", "is", "None", ":", "\n", "            ", "metrics", "=", "[", "]", "\n", "", "self", ".", "train_metrics", "=", "metrics", "\n", "self", ".", "val_metrics", "=", "deepcopy", "(", "metrics", ")", "\n", "if", "additional_val_metrics", "is", "not", "None", ":", "\n", "            ", "self", ".", "val_metrics", ".", "extend", "(", "additional_val_metrics", ")", "\n", "\n", "", "self", ".", "checkpoint_interval", "=", "checkpoint_interval", "\n", "self", ".", "image_dump_interval", "=", "image_dump_interval", "\n", "self", ".", "task_prefix", "=", "''", "\n", "self", ".", "sw", "=", "None", "\n", "\n", "self", ".", "trainset", "=", "trainset", "\n", "self", ".", "valset", "=", "valset", "\n", "\n", "logger", ".", "info", "(", "f'Dataset of {trainset.get_samples_number()} samples was loaded for training.'", ")", "\n", "logger", ".", "info", "(", "f'Dataset of {valset.get_samples_number()} samples was loaded for validation.'", ")", "\n", "\n", "self", ".", "train_data", "=", "DataLoader", "(", "\n", "trainset", ",", "cfg", ".", "batch_size", ",", "\n", "sampler", "=", "get_sampler", "(", "trainset", ",", "shuffle", "=", "True", ",", "distributed", "=", "cfg", ".", "distributed", ")", ",", "\n", "drop_last", "=", "True", ",", "pin_memory", "=", "True", ",", "\n", "num_workers", "=", "cfg", ".", "workers", "\n", ")", "\n", "\n", "self", ".", "val_data", "=", "DataLoader", "(", "\n", "valset", ",", "cfg", ".", "val_batch_size", ",", "\n", "sampler", "=", "get_sampler", "(", "valset", ",", "shuffle", "=", "False", ",", "distributed", "=", "cfg", ".", "distributed", ")", ",", "\n", "drop_last", "=", "True", ",", "pin_memory", "=", "True", ",", "\n", "num_workers", "=", "cfg", ".", "workers", "\n", ")", "\n", "\n", "self", ".", "optim", "=", "get_optimizer", "(", "model", ",", "optimizer", ",", "optimizer_params", ")", "\n", "model", "=", "self", ".", "_load_weights", "(", "model", ")", "\n", "\n", "if", "cfg", ".", "multi_gpu", ":", "\n", "            ", "model", "=", "get_dp_wrapper", "(", "cfg", ".", "distributed", ")", "(", "model", ",", "device_ids", "=", "cfg", ".", "gpu_ids", ",", "\n", "output_device", "=", "cfg", ".", "gpu_ids", "[", "0", "]", ")", "\n", "\n", "", "if", "self", ".", "is_master", ":", "\n", "            ", "logger", ".", "info", "(", "model", ")", "\n", "logger", ".", "info", "(", "get_config_repr", "(", "model", ".", "_config", ")", ")", "\n", "\n", "", "self", ".", "device", "=", "cfg", ".", "device", "\n", "self", ".", "net", "=", "model", ".", "to", "(", "self", ".", "device", ")", "\n", "self", ".", "lr", "=", "optimizer_params", "[", "'lr'", "]", "\n", "\n", "if", "lr_scheduler", "is", "not", "None", ":", "\n", "            ", "self", ".", "lr_scheduler", "=", "lr_scheduler", "(", "optimizer", "=", "self", ".", "optim", ")", "\n", "if", "cfg", ".", "start_epoch", ">", "0", ":", "\n", "                ", "for", "_", "in", "range", "(", "cfg", ".", "start_epoch", ")", ":", "\n", "                    ", "self", ".", "lr_scheduler", ".", "step", "(", ")", "\n", "\n", "", "", "", "self", ".", "tqdm_out", "=", "TqdmToLogger", "(", "logger", ",", "level", "=", "logging", ".", "INFO", ")", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "for", "click_model", "in", "self", ".", "click_models", ":", "\n", "                ", "for", "param", "in", "click_model", ".", "parameters", "(", ")", ":", "\n", "                    ", "param", ".", "requires_grad", "=", "False", "\n", "", "click_model", ".", "to", "(", "self", ".", "device", ")", "\n", "click_model", ".", "eval", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run": [[117, 125], ["isegm.utils.log.logger.info", "isegm.utils.log.logger.info", "range", "cdnet_trainer.ISTrainer.training"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.training"], ["", "", "", "def", "run", "(", "self", ",", "num_epochs", ",", "start_epoch", "=", "None", ",", "validation", "=", "True", ")", ":", "\n", "        ", "if", "start_epoch", "is", "None", ":", "\n", "            ", "start_epoch", "=", "self", ".", "cfg", ".", "start_epoch", "\n", "\n", "", "logger", ".", "info", "(", "f'Starting Epoch: {start_epoch}'", ")", "\n", "logger", ".", "info", "(", "f'Total Epochs: {num_epochs}'", ")", "\n", "for", "epoch", "in", "range", "(", "start_epoch", ",", "num_epochs", ")", ":", "\n", "            ", "self", ".", "training", "(", "epoch", ")", "\n", "#if validation:", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.training": [[128, 210], ["cdnet_trainer.ISTrainer.net.train", "enumerate", "hasattr", "isegm.utils.log.SummaryWriterAvg", "cdnet_trainer.ISTrainer.train_data.sampler.set_epoch", "cdnet_trainer.ISTrainer.task_prefix.capitalize", "tqdm.tqdm.tqdm", "metric.reset_epoch_stats", "isegm.utils.distributed.reduce_loss_dict", "losses_logging[].item", "isegm.utils.misc.save_checkpoint", "isinstance", "cdnet_trainer.ISTrainer.lr_scheduler.step", "cdnet_trainer.ISTrainer.optim.zero_grad", "scaler.scale().backward", "scaler.step", "scaler.update", "cdnet_trainer.ISTrainer.batch_forward", "cdnet_trainer.ISTrainer.optim.zero_grad", "loss.backward", "cdnet_trainer.ISTrainer.optim.step", "losses_logging.items", "cdnet_trainer.ISTrainer.loss_cfg.items", "cdnet_trainer.ISTrainer.sw.add_scalar", "tbar.set_description", "cdnet_trainer.ISTrainer.sw.add_scalar", "isegm.utils.misc.save_checkpoint", "str", "len", "torch.cuda.amp.autocast", "cdnet_trainer.ISTrainer.batch_forward", "cdnet_trainer.ISTrainer.sw.add_scalar", "cdnet_trainer.ISTrainer.save_visualization", "metric.log_states", "scaler.scale", "hasattr", "v.log_states", "metric.get_epoch_value", "loss_value.item", "cdnet_trainer.ISTrainer.loss_cfg.get", "hasattr", "cdnet_trainer.ISTrainer.lr_scheduler.get_lr"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.reset_epoch_stats", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.save_checkpoint", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.save_checkpoint", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.save_visualization", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.get_epoch_value"], ["", "", "def", "training", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "if", "self", ".", "sw", "is", "None", "and", "self", ".", "is_master", ":", "\n", "            ", "self", ".", "sw", "=", "SummaryWriterAvg", "(", "log_dir", "=", "str", "(", "self", ".", "cfg", ".", "LOGS_PATH", ")", ",", "\n", "flush_secs", "=", "10", ",", "dump_period", "=", "self", ".", "tb_dump_period", ")", "\n", "\n", "", "if", "self", ".", "cfg", ".", "distributed", ":", "\n", "            ", "self", ".", "train_data", ".", "sampler", ".", "set_epoch", "(", "epoch", ")", "\n", "\n", "", "log_prefix", "=", "'Train'", "+", "self", ".", "task_prefix", ".", "capitalize", "(", ")", "\n", "tbar", "=", "tqdm", "(", "self", ".", "train_data", ",", "file", "=", "self", ".", "tqdm_out", ",", "ncols", "=", "100", ")", "if", "self", ".", "is_master", "else", "self", ".", "train_data", "\n", "\n", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "            ", "metric", ".", "reset_epoch_stats", "(", ")", "\n", "\n", "", "self", ".", "net", ".", "train", "(", ")", "\n", "#for m in self.net.feature_extractor.modules():", "\n", "#        m.eval()", "\n", "\n", "train_loss", "=", "0.0", "\n", "for", "i", ",", "batch_data", "in", "enumerate", "(", "tbar", ")", ":", "\n", "            ", "global_step", "=", "epoch", "*", "len", "(", "self", ".", "train_data", ")", "+", "i", "\n", "use_fp16", "=", "False", "\n", "if", "use_fp16", ":", "\n", "                ", "self", ".", "optim", ".", "zero_grad", "(", ")", "\n", "with", "autocast", "(", ")", ":", "\n", "                    ", "loss", ",", "losses_logging", ",", "splitted_batch_data", ",", "outputs", "=", "self", ".", "batch_forward", "(", "batch_data", ")", "\n", "", "scaler", ".", "scale", "(", "loss", ")", ".", "backward", "(", ")", "\n", "scaler", ".", "step", "(", "self", ".", "optim", ")", "\n", "scaler", ".", "update", "(", ")", "\n", "", "else", ":", "\n", "                ", "loss", ",", "losses_logging", ",", "splitted_batch_data", ",", "outputs", "=", "self", ".", "batch_forward", "(", "batch_data", ")", "\n", "self", ".", "optim", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optim", ".", "step", "(", ")", "\n", "\n", "", "losses_logging", "[", "'overall'", "]", "=", "loss", "\n", "reduce_loss_dict", "(", "losses_logging", ")", "\n", "\n", "train_loss", "+=", "losses_logging", "[", "'overall'", "]", ".", "item", "(", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "for", "loss_name", ",", "loss_value", "in", "losses_logging", ".", "items", "(", ")", ":", "\n", "                    ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Losses/{loss_name}'", ",", "\n", "value", "=", "loss_value", ".", "item", "(", ")", ",", "\n", "global_step", "=", "global_step", ")", "\n", "\n", "", "for", "k", ",", "v", "in", "self", ".", "loss_cfg", ".", "items", "(", ")", ":", "\n", "                    ", "if", "'_loss'", "in", "k", "and", "hasattr", "(", "v", ",", "'log_states'", ")", "and", "self", ".", "loss_cfg", ".", "get", "(", "k", "+", "'_weight'", ",", "0.0", ")", ">", "0", ":", "\n", "                        ", "v", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Losses/{k}'", ",", "global_step", ")", "\n", "\n", "", "", "if", "self", ".", "image_dump_interval", ">", "0", "and", "global_step", "%", "self", ".", "image_dump_interval", "==", "0", ":", "\n", "                    ", "self", ".", "save_visualization", "(", "splitted_batch_data", ",", "outputs", ",", "global_step", ",", "prefix", "=", "'train'", ")", "\n", "\n", "", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}States/learning_rate'", ",", "\n", "value", "=", "self", ".", "lr", "if", "not", "hasattr", "(", "self", ",", "'lr_scheduler'", ")", "else", "self", ".", "lr_scheduler", ".", "get_lr", "(", ")", "[", "-", "1", "]", ",", "\n", "global_step", "=", "global_step", ")", "\n", "\n", "tbar", ".", "set_description", "(", "f'Epoch {epoch}, training loss {train_loss/(i+1):.4f}'", ")", "\n", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "                    ", "metric", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Metrics/{metric.name}'", ",", "global_step", ")", "\n", "\n", "", "", "", "if", "self", ".", "is_master", ":", "\n", "            ", "for", "metric", "in", "self", ".", "train_metrics", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Metrics/{metric.name}'", ",", "\n", "value", "=", "metric", ".", "get_epoch_value", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n", "", "save_checkpoint", "(", "self", ".", "net", ",", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ",", "prefix", "=", "self", ".", "task_prefix", ",", "\n", "epoch", "=", "None", ",", "multi_gpu", "=", "self", ".", "cfg", ".", "multi_gpu", ")", "\n", "\n", "if", "isinstance", "(", "self", ".", "checkpoint_interval", ",", "(", "list", ",", "tuple", ")", ")", ":", "\n", "                ", "checkpoint_interval", "=", "[", "x", "for", "x", "in", "self", ".", "checkpoint_interval", "if", "x", "[", "0", "]", "<=", "epoch", "]", "[", "-", "1", "]", "[", "1", "]", "\n", "", "else", ":", "\n", "                ", "checkpoint_interval", "=", "self", ".", "checkpoint_interval", "\n", "\n", "", "if", "epoch", "%", "checkpoint_interval", "==", "0", ":", "\n", "                ", "save_checkpoint", "(", "self", ".", "net", ",", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ",", "prefix", "=", "self", ".", "task_prefix", ",", "\n", "epoch", "=", "epoch", ",", "multi_gpu", "=", "self", ".", "cfg", ".", "multi_gpu", ")", "\n", "\n", "", "", "if", "hasattr", "(", "self", ",", "'lr_scheduler'", ")", ":", "\n", "            ", "self", ".", "lr_scheduler", ".", "step", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.validation": [[211, 251], ["collections.defaultdict", "cdnet_trainer.ISTrainer.net.eval", "enumerate", "isegm.utils.log.SummaryWriterAvg", "cdnet_trainer.ISTrainer.task_prefix.capitalize", "tqdm.tqdm.tqdm", "metric.reset_epoch_stats", "cdnet_trainer.ISTrainer.batch_forward", "isegm.utils.distributed.reduce_loss_dict", "batch_losses_logging.items", "batch_losses_logging[].item", "collections.defaultdict.items", "losses_logging[].append", "tbar.set_description", "cdnet_trainer.ISTrainer.sw.add_scalar", "cdnet_trainer.ISTrainer.sw.add_scalar", "str", "len", "loss_value.item", "metric.log_states", "numpy.array().mean", "metric.get_epoch_value", "numpy.array"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.reset_epoch_stats", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.SummaryWriterAvg.add_scalar", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.losses.WFNL.log_states", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.get_epoch_value"], ["", "", "def", "validation", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "if", "self", ".", "sw", "is", "None", "and", "self", ".", "is_master", ":", "\n", "            ", "self", ".", "sw", "=", "SummaryWriterAvg", "(", "log_dir", "=", "str", "(", "self", ".", "cfg", ".", "LOGS_PATH", ")", ",", "\n", "flush_secs", "=", "10", ",", "dump_period", "=", "self", ".", "tb_dump_period", ")", "\n", "\n", "", "log_prefix", "=", "'Val'", "+", "self", ".", "task_prefix", ".", "capitalize", "(", ")", "\n", "tbar", "=", "tqdm", "(", "self", ".", "val_data", ",", "file", "=", "self", ".", "tqdm_out", ",", "ncols", "=", "100", ")", "if", "self", ".", "is_master", "else", "self", ".", "val_data", "\n", "\n", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "            ", "metric", ".", "reset_epoch_stats", "(", ")", "\n", "\n", "", "val_loss", "=", "0", "\n", "losses_logging", "=", "defaultdict", "(", "list", ")", "\n", "\n", "self", ".", "net", ".", "eval", "(", ")", "\n", "for", "i", ",", "batch_data", "in", "enumerate", "(", "tbar", ")", ":", "\n", "            ", "global_step", "=", "epoch", "*", "len", "(", "self", ".", "val_data", ")", "+", "i", "\n", "loss", ",", "batch_losses_logging", ",", "splitted_batch_data", ",", "outputs", "=", "self", ".", "batch_forward", "(", "batch_data", ",", "validation", "=", "True", ")", "\n", "\n", "batch_losses_logging", "[", "'overall'", "]", "=", "loss", "\n", "reduce_loss_dict", "(", "batch_losses_logging", ")", "\n", "for", "loss_name", ",", "loss_value", "in", "batch_losses_logging", ".", "items", "(", ")", ":", "\n", "                ", "losses_logging", "[", "loss_name", "]", ".", "append", "(", "loss_value", ".", "item", "(", ")", ")", "\n", "\n", "", "val_loss", "+=", "batch_losses_logging", "[", "'overall'", "]", ".", "item", "(", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "tbar", ".", "set_description", "(", "f'Epoch {epoch}, validation loss: {val_loss/(i + 1):.4f}'", ")", "\n", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "                    ", "metric", ".", "log_states", "(", "self", ".", "sw", ",", "f'{log_prefix}Metrics/{metric.name}'", ",", "global_step", ")", "\n", "\n", "", "", "", "if", "self", ".", "is_master", ":", "\n", "            ", "for", "loss_name", ",", "loss_values", "in", "losses_logging", ".", "items", "(", ")", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Losses/{loss_name}'", ",", "value", "=", "np", ".", "array", "(", "loss_values", ")", ".", "mean", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n", "", "for", "metric", "in", "self", ".", "val_metrics", ":", "\n", "                ", "self", ".", "sw", ".", "add_scalar", "(", "tag", "=", "f'{log_prefix}Metrics/{metric.name}'", ",", "value", "=", "metric", ".", "get_epoch_value", "(", ")", ",", "\n", "global_step", "=", "epoch", ",", "disable_avg", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.batch_forward": [[252, 313], ["dict", "torch.set_grad_enabled", "cdnet_trainer.ISTrainer.net", "cdnet_trainer.ISTrainer.add_loss", "cdnet_trainer.ISTrainer.add_loss", "cdnet_trainer.ISTrainer.add_loss", "v.to", "image.clone", "gt_mask.clone", "get_next_points.clone", "torch.zeros_like", "torch.no_grad", "random.randint", "range", "torch.cat", "batch_data.items", "torch.sigmoid", "get_next_points", "torch.zeros_like", "torch.no_grad", "cdnet_trainer.ISTrainer.net.eval", "torch.cat", "cdnet_trainer.ISTrainer.net.train", "numpy.random.random", "m.update", "len", "eval_model", "torch.sigmoid.size", "cdnet_trainer.ISTrainer.get"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.baseline_trainer.get_next_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "", "", "def", "batch_forward", "(", "self", ",", "batch_data", ",", "validation", "=", "False", ")", ":", "\n", "        ", "metrics", "=", "self", ".", "val_metrics", "if", "validation", "else", "self", ".", "train_metrics", "\n", "losses_logging", "=", "dict", "(", ")", "\n", "\n", "with", "torch", ".", "set_grad_enabled", "(", "not", "validation", ")", ":", "\n", "            ", "batch_data", "=", "{", "k", ":", "v", ".", "to", "(", "self", ".", "device", ")", "for", "k", ",", "v", "in", "batch_data", ".", "items", "(", ")", "}", "\n", "image", ",", "gt_mask", ",", "points", "=", "batch_data", "[", "'images'", "]", ",", "batch_data", "[", "'instances'", "]", ",", "batch_data", "[", "'points'", "]", "\n", "orig_image", ",", "orig_gt_mask", ",", "orig_points", "=", "image", ".", "clone", "(", ")", ",", "gt_mask", ".", "clone", "(", ")", ",", "points", ".", "clone", "(", ")", "\n", "prev_output", "=", "torch", ".", "zeros_like", "(", "image", ",", "dtype", "=", "torch", ".", "float32", ")", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", "\n", "last_click_indx", "=", "None", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "num_iters", "=", "random", ".", "randint", "(", "0", ",", "self", ".", "max_num_next_clicks", ")", "\n", "\n", "for", "click_indx", "in", "range", "(", "num_iters", ")", ":", "\n", "                    ", "last_click_indx", "=", "click_indx", "\n", "\n", "if", "not", "validation", ":", "\n", "                        ", "self", ".", "net", ".", "eval", "(", ")", "\n", "\n", "", "if", "self", ".", "click_models", "is", "None", "or", "click_indx", ">=", "len", "(", "self", ".", "click_models", ")", ":", "\n", "                        ", "eval_model", "=", "self", ".", "net", "\n", "", "else", ":", "\n", "                        ", "eval_model", "=", "self", ".", "click_models", "[", "click_indx", "]", "\n", "\n", "\n", "", "net_input", "=", "torch", ".", "cat", "(", "(", "image", ",", "prev_output", ")", ",", "dim", "=", "1", ")", "if", "self", ".", "net", ".", "with_prev_mask", "else", "image", "\n", "prev_output", "=", "torch", ".", "sigmoid", "(", "eval_model", "(", "net_input", ",", "points", ")", "[", "'instances'", "]", ")", "\n", "points", "=", "get_next_points", "(", "prev_output", ",", "orig_gt_mask", ",", "points", ",", "click_indx", "+", "1", ")", "\n", "\n", "\n", "if", "not", "validation", ":", "\n", "                        ", "self", ".", "net", ".", "train", "(", ")", "\n", "\n", "", "", "if", "self", ".", "net", ".", "with_prev_mask", "and", "self", ".", "prev_mask_drop_prob", ">", "0", "and", "last_click_indx", "is", "not", "None", ":", "\n", "                    ", "zero_mask", "=", "np", ".", "random", ".", "random", "(", "size", "=", "prev_output", ".", "size", "(", "0", ")", ")", "<", "self", ".", "prev_mask_drop_prob", "\n", "prev_output", "[", "zero_mask", "]", "=", "torch", ".", "zeros_like", "(", "prev_output", "[", "zero_mask", "]", ")", "\n", "\n", "", "", "batch_data", "[", "'points'", "]", "=", "points", "\n", "batch_data", "[", "'prev_mask'", "]", "=", "prev_output", "\n", "\n", "net_input", "=", "torch", ".", "cat", "(", "(", "image", ",", "prev_output", ")", ",", "dim", "=", "1", ")", "if", "self", ".", "net", ".", "with_prev_mask", "else", "image", "\n", "output", "=", "self", ".", "net", "(", "net_input", ",", "points", ")", "\n", "\n", "\n", "loss", "=", "0.0", "\n", "loss", "=", "self", ".", "add_loss", "(", "'instance_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'instances'", "]", ",", "batch_data", "[", "'instances'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'fdm_instances_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'fdm_instances'", "]", ",", "batch_data", "[", "'instances'", "]", ")", ")", "\n", "\n", "loss", "=", "self", ".", "add_loss", "(", "'diversity_loss'", ",", "loss", ",", "losses_logging", ",", "validation", ",", "\n", "lambda", ":", "(", "output", "[", "'latent_instances'", "]", ",", "batch_data", "[", "'instances'", "]", ",", "output", "[", "'click_map'", "]", ")", ")", "\n", "\n", "if", "self", ".", "is_master", ":", "\n", "                ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                    ", "for", "m", "in", "metrics", ":", "\n", "                        ", "m", ".", "update", "(", "*", "(", "output", ".", "get", "(", "x", ")", "for", "x", "in", "m", ".", "pred_outputs", ")", ",", "\n", "*", "(", "batch_data", "[", "x", "]", "for", "x", "in", "m", ".", "gt_outputs", ")", ")", "\n", "", "", "", "", "return", "loss", ",", "losses_logging", ",", "batch_data", ",", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.add_loss": [[314, 326], ["loss_cfg.get", "loss_cfg.get", "loss_cfg.get.", "torch.mean", "lambda_loss_inputs"], "methods", ["None"], ["", "def", "add_loss", "(", "self", ",", "loss_name", ",", "total_loss", ",", "losses_logging", ",", "validation", ",", "lambda_loss_inputs", ")", ":", "\n", "        ", "loss_cfg", "=", "self", ".", "loss_cfg", "if", "not", "validation", "else", "self", ".", "val_loss_cfg", "\n", "loss_weight", "=", "loss_cfg", ".", "get", "(", "loss_name", "+", "'_weight'", ",", "0.0", ")", "\n", "if", "loss_weight", ">", "0.0", ":", "\n", "            ", "loss_criterion", "=", "loss_cfg", ".", "get", "(", "loss_name", ")", "\n", "loss", "=", "loss_criterion", "(", "*", "lambda_loss_inputs", "(", ")", ")", "\n", "loss", "=", "torch", ".", "mean", "(", "loss", ")", "\n", "losses_logging", "[", "loss_name", "]", "=", "loss", "\n", "loss", "=", "loss_weight", "*", "loss", "\n", "total_loss", "=", "total_loss", "+", "loss", "\n", "\n", "", "return", "total_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.save_visualization": [[327, 387], ["[].detach().cpu().numpy", "isegm.utils.vis.draw_points", "isegm.utils.vis.draw_points", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "numpy.zeros_like", "[].detach().cpu().numpy", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "numpy.zeros_like", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "numpy.zeros_like", "isegm.utils.vis.draw_probmap", "[].detach().cpu().numpy", "range", "numpy.hstack().astype", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "numpy.hstack().astype", "numpy.vstack", "cdnet_trainer.ISTrainer.save_visualization._save_image"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag"], ["", "def", "save_visualization", "(", "self", ",", "splitted_batch_data", ",", "outputs", ",", "global_step", ",", "prefix", ")", ":", "\n", "        ", "output_images_path", "=", "self", ".", "cfg", ".", "VIS_PATH", "/", "prefix", "\n", "if", "self", ".", "task_prefix", ":", "\n", "            ", "output_images_path", "/=", "self", ".", "task_prefix", "\n", "\n", "", "if", "not", "output_images_path", ".", "exists", "(", ")", ":", "\n", "            ", "output_images_path", ".", "mkdir", "(", "parents", "=", "True", ")", "\n", "", "image_name_prefix", "=", "f'{global_step:06d}'", "\n", "\n", "def", "_save_image", "(", "suffix", ",", "image", ")", ":", "\n", "            ", "cv2", ".", "imwrite", "(", "str", "(", "output_images_path", "/", "f'{image_name_prefix}_{suffix}.jpg'", ")", ",", "\n", "image", ",", "[", "cv2", ".", "IMWRITE_JPEG_QUALITY", ",", "85", "]", ")", "\n", "\n", "", "points", "=", "splitted_batch_data", "[", "'points'", "]", "[", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "images", "=", "splitted_batch_data", "[", "'images'", "]", "[", "0", "]", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "transpose", "(", "(", "1", ",", "2", ",", "0", ")", ")", "*", "255", "\n", "image_with_points", "=", "draw_points", "(", "images", ",", "points", "[", ":", "self", ".", "max_interactive_points", "]", ",", "(", "0", ",", "255", ",", "0", ")", ")", "\n", "image_with_points", "=", "draw_points", "(", "image_with_points", ",", "points", "[", "self", ".", "max_interactive_points", ":", "]", ",", "(", "0", ",", "0", ",", "255", ")", ")", "\n", "\n", "instance_masks", "=", "splitted_batch_data", "[", "'instances'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "gt_mask", "=", "draw_probmap", "(", "instance_masks", ")", "\n", "gt_color_mask", "=", "np", ".", "zeros_like", "(", "images", ")", "\n", "gt_color_mask", "[", ":", ",", ":", ",", "0", "]", "=", "(", "instance_masks", ">", "0.5", ")", "*", "255", "\n", "gt_masked_image", "=", "0.5", "*", "images", "+", "0.5", "*", "gt_color_mask", "#vis", "\n", "\n", "prev_masks", "=", "splitted_batch_data", "[", "'prev_mask'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "prev_masks", "=", "draw_probmap", "(", "prev_masks", ")", "\n", "\n", "\n", "predicted_instance_masks", "=", "torch", ".", "sigmoid", "(", "outputs", "[", "'instances'", "]", ")", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "pred_color_mask", "=", "np", ".", "zeros_like", "(", "images", ")", "\n", "pred_color_mask", "[", ":", ",", ":", ",", "0", "]", "=", "(", "predicted_instance_masks", ">", "0.5", ")", "*", "255", "\n", "pred_masked_image", "=", "0.5", "*", "images", "+", "0.5", "*", "pred_color_mask", "\n", "predicted_instance_masks", "=", "draw_probmap", "(", "predicted_instance_masks", ")", "\n", "\n", "predicted_fdm_masks", "=", "outputs", "[", "'fdm_instances'", "]", "[", "0", ",", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "pred_color_mask_fdm", "=", "np", ".", "zeros_like", "(", "images", ")", "\n", "pred_color_mask_fdm", "[", ":", ",", ":", ",", "0", "]", "=", "(", "predicted_fdm_masks", ")", "*", "255", "\n", "pred_fdm_image", "=", "0.5", "*", "images", "+", "0.5", "*", "pred_color_mask_fdm", "\n", "predicted_fdm_masks", "=", "draw_probmap", "(", "predicted_fdm_masks", ")", "\n", "\n", "\n", "latent_list", "=", "[", "]", "\n", "latent_preds", "=", "torch", ".", "sigmoid", "(", "outputs", "[", "'latent_instances'", "]", ")", "[", "0", "]", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "for", "i", "in", "range", "(", "latent_preds", ".", "shape", "[", "0", "]", ")", ":", "\n", "            ", "pred", "=", "latent_preds", "[", "i", "]", "\n", "pred", "=", "draw_probmap", "(", "pred", ")", "\n", "pred", "=", "add_tag", "(", "pred", ",", "'Latent Pred: '", "+", "str", "(", "i", "+", "1", ")", ")", "\n", "latent_list", ".", "append", "(", "pred", ")", "\n", "", "vis_latent", "=", "np", ".", "hstack", "(", "latent_list", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "#print(vis_latent.shape, pred.shape )", "\n", "\n", "image_with_points", "=", "add_tag", "(", "image_with_points", ",", "'Image with Points'", ")", "\n", "gt_masked_image", "=", "add_tag", "(", "gt_masked_image", ",", "'Ground Truth Mask'", ")", "\n", "pred_masked_image", "=", "add_tag", "(", "pred_masked_image", ",", "'Prediction'", ")", "\n", "pred_fdm_image", "=", "add_tag", "(", "pred_fdm_image", ",", "'FDM Destination Constrain'", ")", "\n", "\n", "vis_image_full", "=", "np", ".", "hstack", "(", "(", "image_with_points", ",", "gt_masked_image", ",", "pred_masked_image", ",", "pred_fdm_image", ")", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "vis_image_full", "=", "np", ".", "vstack", "(", "(", "vis_image_full", ",", "vis_latent", ")", ")", "\n", "vis_image", "=", "vis_image_full", "\n", "_save_image", "(", "'cdnet_vis'", ",", "vis_image", "[", ":", ",", ":", ",", ":", ":", "-", "1", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer._load_weights": [[388, 403], ["os.path.isfile", "cdnet_trainer.load_weights", "RuntimeError", "list", "isegm.utils.log.logger.info", "cdnet_trainer.load_weights", "cdnet_trainer.ISTrainer.cfg.CHECKPOINTS_PATH.glob", "len", "str"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.load_weights", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.load_weights"], ["", "def", "_load_weights", "(", "self", ",", "net", ")", ":", "\n", "        ", "if", "self", ".", "cfg", ".", "weights", "is", "not", "None", ":", "\n", "            ", "if", "os", ".", "path", ".", "isfile", "(", "self", ".", "cfg", ".", "weights", ")", ":", "\n", "                ", "load_weights", "(", "net", ",", "self", ".", "cfg", ".", "weights", ")", "\n", "self", ".", "cfg", ".", "weights", "=", "None", "\n", "", "else", ":", "\n", "                ", "raise", "RuntimeError", "(", "f\"=> no checkpoint found at '{self.cfg.weights}'\"", ")", "\n", "", "", "elif", "self", ".", "cfg", ".", "resume_exp", "is", "not", "None", ":", "\n", "            ", "checkpoints", "=", "list", "(", "self", ".", "cfg", ".", "CHECKPOINTS_PATH", ".", "glob", "(", "f'{self.cfg.resume_prefix}*.pth'", ")", ")", "\n", "assert", "len", "(", "checkpoints", ")", "==", "1", "\n", "\n", "checkpoint_path", "=", "checkpoints", "[", "0", "]", "\n", "logger", ".", "info", "(", "f'Load checkpoint from path: {checkpoint_path}'", ")", "\n", "load_weights", "(", "net", ",", "str", "(", "checkpoint_path", ")", ")", "\n", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.is_master": [[404, 407], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "is_master", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "cfg", ".", "local_rank", "==", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.get_next_points_removeall": [[412, 460], ["rois.cpu().numpy.cpu().numpy", "numpy.logical_and", "numpy.logical_and", "numpy.pad().astype", "numpy.pad().astype", "points.clone.clone", "range", "pred.cpu().numpy", "numpy.logical_not", "points.clone.size", "numpy.max", "numpy.max", "numpy.argwhere", "torch.tensor().to", "torch.tensor().to", "gt.cpu().numpy", "rois.cpu().numpy.cpu", "numpy.pad", "numpy.pad", "cv2.distanceTransform", "cv2.distanceTransform", "len", "pred.cpu", "max", "numpy.random.rand", "float", "float", "float", "float", "float", "float", "torch.tensor", "torch.tensor", "gt.cpu", "numpy.random.randint", "len"], "function", ["None"], ["", "", "def", "get_next_points_removeall", "(", "pred", ",", "gt", ",", "points", ",", "points_focus", ",", "rois", ",", "click_indx", ",", "pred_thresh", "=", "0.49", ",", "remove_prob", "=", "0.1", ")", ":", "\n", "    ", "assert", "click_indx", ">", "0", "\n", "pred", "=", "pred", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", ":", ",", "0", ",", ":", ",", ":", "]", "\n", "gt", "=", "gt", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", ":", ",", "0", ",", ":", ",", ":", "]", ">", "0.5", "\n", "rois", "=", "rois", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "h", ",", "w", "=", "gt", ".", "shape", "[", "-", "2", "]", ",", "gt", ".", "shape", "[", "-", "1", "]", "\n", "\n", "fn_mask", "=", "np", ".", "logical_and", "(", "gt", ",", "pred", "<", "pred_thresh", ")", "\n", "fp_mask", "=", "np", ".", "logical_and", "(", "np", ".", "logical_not", "(", "gt", ")", ",", "pred", ">", "pred_thresh", ")", "\n", "\n", "fn_mask", "=", "np", ".", "pad", "(", "fn_mask", ",", "(", "(", "0", ",", "0", ")", ",", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "fp_mask", "=", "np", ".", "pad", "(", "fp_mask", ",", "(", "(", "0", ",", "0", ")", ",", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "num_points", "=", "points", ".", "size", "(", "1", ")", "//", "2", "\n", "points", "=", "points", ".", "clone", "(", ")", "\n", "#print(points.shape, points[0]) # [batch, 48, 3]", "\n", "\n", "for", "bindx", "in", "range", "(", "fn_mask", ".", "shape", "[", "0", "]", ")", ":", "\n", "        ", "fn_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fn_mask", "[", "bindx", "]", ",", "cv2", ".", "DIST_L2", ",", "5", ")", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "fp_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fp_mask", "[", "bindx", "]", ",", "cv2", ".", "DIST_L2", ",", "5", ")", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "\n", "fn_max_dist", "=", "np", ".", "max", "(", "fn_mask_dt", ")", "\n", "fp_max_dist", "=", "np", ".", "max", "(", "fp_mask_dt", ")", "\n", "\n", "is_positive", "=", "fn_max_dist", ">", "fp_max_dist", "\n", "dt", "=", "fn_mask_dt", "if", "is_positive", "else", "fp_mask_dt", "\n", "inner_mask", "=", "dt", ">", "max", "(", "fn_max_dist", ",", "fp_max_dist", ")", "/", "2.0", "\n", "indices", "=", "np", ".", "argwhere", "(", "inner_mask", ")", "\n", "if", "len", "(", "indices", ")", ">", "0", ":", "\n", "            ", "coords", "=", "indices", "[", "np", ".", "random", ".", "randint", "(", "0", ",", "len", "(", "indices", ")", ")", "]", "\n", "if", "np", ".", "random", ".", "rand", "(", ")", "<", "remove_prob", ":", "\n", "                ", "points", "[", "bindx", "]", "=", "points", "[", "bindx", "]", "*", "0.0", "-", "1.0", "\n", "", "if", "is_positive", ":", "\n", "                ", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "0", "]", "=", "float", "(", "coords", "[", "0", "]", ")", "\n", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "1", "]", "=", "float", "(", "coords", "[", "1", "]", ")", "\n", "points", "[", "bindx", ",", "num_points", "-", "click_indx", ",", "2", "]", "=", "float", "(", "click_indx", ")", "\n", "", "else", ":", "\n", "                ", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "0", "]", "=", "float", "(", "coords", "[", "0", "]", ")", "\n", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "1", "]", "=", "float", "(", "coords", "[", "1", "]", ")", "\n", "points", "[", "bindx", ",", "2", "*", "num_points", "-", "click_indx", ",", "2", "]", "=", "float", "(", "click_indx", ")", "\n", "\n", "", "", "x1", ",", "y1", ",", "x2", ",", "y2", "=", "rois", "[", "bindx", "]", "\n", "point_focus", "=", "points", "[", "bindx", "]", "\n", "hc", ",", "wc", "=", "y2", "-", "y1", ",", "x2", "-", "x1", "\n", "ry", ",", "rx", "=", "h", "/", "hc", ",", "w", "/", "wc", "\n", "bias", "=", "torch", ".", "tensor", "(", "[", "y1", ",", "x1", ",", "0", "]", ")", ".", "to", "(", "points", ".", "device", ")", "\n", "ratio", "=", "torch", ".", "tensor", "(", "[", "ry", ",", "rx", ",", "1", "]", ")", ".", "to", "(", "points", ".", "device", ")", "\n", "points_focus", "[", "bindx", "]", "=", "(", "point_focus", "-", "bias", ")", "*", "ratio", "\n", "", "return", "points", ",", "points_focus", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.load_weights": [[462, 474], ["model.state_dict", "set", "set", "print", "print", "print", "print", "model.state_dict.update", "model.load_state_dict", "torch.load", "new_state_dict.keys", "model.state_dict.keys"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], ["", "def", "load_weights", "(", "model", ",", "path_to_weights", ")", ":", "\n", "    ", "current_state_dict", "=", "model", ".", "state_dict", "(", ")", "\n", "new_state_dict", "=", "torch", ".", "load", "(", "path_to_weights", ",", "map_location", "=", "'cpu'", ")", "[", "'state_dict'", "]", "\n", "\n", "new_keys", "=", "set", "(", "new_state_dict", ".", "keys", "(", ")", ")", "\n", "old_keys", "=", "set", "(", "current_state_dict", ".", "keys", "(", ")", ")", "\n", "print", "(", "'='", "*", "10", ")", "\n", "print", "(", "' unexpected: '", ",", "new_keys", "-", "old_keys", ")", "\n", "print", "(", "' lacked: '", ",", "old_keys", "-", "new_keys", ")", "\n", "print", "(", "'='", "*", "10", ")", "\n", "current_state_dict", ".", "update", "(", "new_state_dict", ")", "\n", "model", ".", "load_state_dict", "(", "current_state_dict", ",", "strict", "=", "False", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.optimizer.get_optimizer": [[6, 28], ["model.named_parameters", "params.append", "params.append", "math.isclose", "isegm.utils.log.logger.info", "getattr", "param_group.get", "opt_name.lower"], "function", ["None"], ["def", "get_optimizer", "(", "model", ",", "opt_name", ",", "opt_kwargs", ")", ":", "\n", "    ", "params", "=", "[", "]", "\n", "base_lr", "=", "opt_kwargs", "[", "'lr'", "]", "\n", "for", "name", ",", "param", "in", "model", ".", "named_parameters", "(", ")", ":", "\n", "        ", "param_group", "=", "{", "'params'", ":", "[", "param", "]", "}", "\n", "if", "not", "param", ".", "requires_grad", ":", "\n", "            ", "params", ".", "append", "(", "param_group", ")", "\n", "continue", "\n", "\n", "", "if", "not", "math", ".", "isclose", "(", "getattr", "(", "param", ",", "'lr_mult'", ",", "1.0", ")", ",", "1.0", ")", ":", "\n", "            ", "logger", ".", "info", "(", "f'Applied lr_mult={param.lr_mult} to \"{name}\" parameter.'", ")", "\n", "param_group", "[", "'lr'", "]", "=", "param_group", ".", "get", "(", "'lr'", ",", "base_lr", ")", "*", "param", ".", "lr_mult", "\n", "\n", "", "params", ".", "append", "(", "param_group", ")", "\n", "\n", "", "optimizer", "=", "{", "\n", "'sgd'", ":", "torch", ".", "optim", ".", "SGD", ",", "\n", "'adam'", ":", "torch", ".", "optim", ".", "Adam", ",", "\n", "'adamw'", ":", "torch", ".", "optim", ".", "AdamW", "\n", "}", "[", "opt_name", ".", "lower", "(", ")", "]", "(", "params", ",", "**", "opt_kwargs", ")", "\n", "\n", "return", "optimizer", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.__init__": [[7, 20], ["clicker.Clicker.reset_clicks", "clicker.Clicker.add_click"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.reset_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.add_click"], ["    ", "def", "__init__", "(", "self", ",", "gt_mask", "=", "None", ",", "init_clicks", "=", "None", ",", "ignore_label", "=", "-", "1", ",", "click_indx_offset", "=", "0", ")", ":", "\n", "        ", "self", ".", "click_indx_offset", "=", "click_indx_offset", "\n", "if", "gt_mask", "is", "not", "None", ":", "\n", "            ", "self", ".", "gt_mask", "=", "gt_mask", "==", "1", "\n", "self", ".", "not_ignore_mask", "=", "gt_mask", "!=", "ignore_label", "\n", "", "else", ":", "\n", "            ", "self", ".", "gt_mask", "=", "None", "\n", "\n", "", "self", ".", "reset_clicks", "(", ")", "\n", "\n", "if", "init_clicks", "is", "not", "None", ":", "\n", "            ", "for", "click", "in", "init_clicks", ":", "\n", "                ", "self", ".", "add_click", "(", "click", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.make_next_click": [[21, 25], ["clicker.Clicker._get_next_click", "clicker.Clicker.add_click"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker._get_next_click", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.add_click"], ["", "", "", "def", "make_next_click", "(", "self", ",", "pred_mask", ")", ":", "\n", "        ", "assert", "self", ".", "gt_mask", "is", "not", "None", "\n", "click", "=", "self", ".", "_get_next_click", "(", "pred_mask", ")", "\n", "self", ".", "add_click", "(", "click", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks": [[26, 28], ["None"], "methods", ["None"], ["", "def", "get_clicks", "(", "self", ",", "clicks_limit", "=", "None", ")", ":", "\n", "        ", "return", "self", ".", "clicks_list", "[", ":", "clicks_limit", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker._get_next_click": [[29, 57], ["numpy.logical_and", "numpy.logical_and", "cv2.distanceTransform", "cv2.distanceTransform", "numpy.max", "numpy.max", "clicker.Click", "numpy.logical_and", "numpy.logical_and", "numpy.pad", "numpy.pad", "numpy.pad.astype", "numpy.pad.astype", "numpy.where", "numpy.where", "numpy.logical_not", "numpy.logical_not"], "methods", ["None"], ["", "def", "_get_next_click", "(", "self", ",", "pred_mask", ",", "padding", "=", "True", ")", ":", "\n", "        ", "fn_mask", "=", "np", ".", "logical_and", "(", "np", ".", "logical_and", "(", "self", ".", "gt_mask", ",", "np", ".", "logical_not", "(", "pred_mask", ")", ")", ",", "self", ".", "not_ignore_mask", ")", "\n", "fp_mask", "=", "np", ".", "logical_and", "(", "np", ".", "logical_and", "(", "np", ".", "logical_not", "(", "self", ".", "gt_mask", ")", ",", "pred_mask", ")", ",", "self", ".", "not_ignore_mask", ")", "\n", "\n", "if", "padding", ":", "\n", "            ", "fn_mask", "=", "np", ".", "pad", "(", "fn_mask", ",", "(", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", "\n", "fp_mask", "=", "np", ".", "pad", "(", "fp_mask", ",", "(", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", "\n", "\n", "", "fn_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fn_mask", ".", "astype", "(", "np", ".", "uint8", ")", ",", "cv2", ".", "DIST_L2", ",", "0", ")", "\n", "fp_mask_dt", "=", "cv2", ".", "distanceTransform", "(", "fp_mask", ".", "astype", "(", "np", ".", "uint8", ")", ",", "cv2", ".", "DIST_L2", ",", "0", ")", "\n", "\n", "if", "padding", ":", "\n", "            ", "fn_mask_dt", "=", "fn_mask_dt", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "fp_mask_dt", "=", "fp_mask_dt", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "\n", "", "fn_mask_dt", "=", "fn_mask_dt", "*", "self", ".", "not_clicked_map", "\n", "fp_mask_dt", "=", "fp_mask_dt", "*", "self", ".", "not_clicked_map", "\n", "\n", "fn_max_dist", "=", "np", ".", "max", "(", "fn_mask_dt", ")", "\n", "fp_max_dist", "=", "np", ".", "max", "(", "fp_mask_dt", ")", "\n", "\n", "is_positive", "=", "fn_max_dist", ">", "fp_max_dist", "\n", "if", "is_positive", ":", "\n", "            ", "coords_y", ",", "coords_x", "=", "np", ".", "where", "(", "fn_mask_dt", "==", "fn_max_dist", ")", "# coords is [y, x]", "\n", "", "else", ":", "\n", "            ", "coords_y", ",", "coords_x", "=", "np", ".", "where", "(", "fp_mask_dt", "==", "fp_max_dist", ")", "# coords is [y, x]", "\n", "\n", "", "return", "Click", "(", "is_positive", "=", "is_positive", ",", "coords", "=", "(", "coords_y", "[", "0", "]", ",", "coords_x", "[", "0", "]", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.add_click": [[58, 70], ["clicker.Clicker.clicks_list.append"], "methods", ["None"], ["", "def", "add_click", "(", "self", ",", "click", ")", ":", "\n", "        ", "coords", "=", "click", ".", "coords", "\n", "\n", "click", ".", "indx", "=", "self", ".", "click_indx_offset", "+", "self", ".", "num_pos_clicks", "+", "self", ".", "num_neg_clicks", "\n", "if", "click", ".", "is_positive", ":", "\n", "            ", "self", ".", "num_pos_clicks", "+=", "1", "\n", "", "else", ":", "\n", "            ", "self", ".", "num_neg_clicks", "+=", "1", "\n", "\n", "", "self", ".", "clicks_list", ".", "append", "(", "click", ")", "\n", "if", "self", ".", "gt_mask", "is", "not", "None", ":", "\n", "            ", "self", ".", "not_clicked_map", "[", "coords", "[", "0", "]", ",", "coords", "[", "1", "]", "]", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker._remove_last_click": [[71, 82], ["clicker.Clicker.clicks_list.pop"], "methods", ["None"], ["", "", "def", "_remove_last_click", "(", "self", ")", ":", "\n", "        ", "click", "=", "self", ".", "clicks_list", ".", "pop", "(", ")", "\n", "coords", "=", "click", ".", "coords", "\n", "\n", "if", "click", ".", "is_positive", ":", "\n", "            ", "self", ".", "num_pos_clicks", "-=", "1", "\n", "", "else", ":", "\n", "            ", "self", ".", "num_neg_clicks", "-=", "1", "\n", "\n", "", "if", "self", ".", "gt_mask", "is", "not", "None", ":", "\n", "            ", "self", ".", "not_clicked_map", "[", "coords", "[", "0", "]", ",", "coords", "[", "1", "]", "]", "=", "True", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.reset_clicks": [[83, 91], ["numpy.ones_like"], "methods", ["None"], ["", "", "def", "reset_clicks", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "gt_mask", "is", "not", "None", ":", "\n", "            ", "self", ".", "not_clicked_map", "=", "np", ".", "ones_like", "(", "self", ".", "gt_mask", ",", "dtype", "=", "np", ".", "bool", ")", "\n", "\n", "", "self", ".", "num_pos_clicks", "=", "0", "\n", "self", ".", "num_neg_clicks", "=", "0", "\n", "\n", "self", ".", "clicks_list", "=", "[", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_state": [[92, 94], ["copy.deepcopy"], "methods", ["None"], ["", "def", "get_state", "(", "self", ")", ":", "\n", "        ", "return", "deepcopy", "(", "self", ".", "clicks_list", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.set_state": [[95, 99], ["clicker.Clicker.reset_clicks", "clicker.Clicker.add_click"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.reset_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.add_click"], ["", "def", "set_state", "(", "self", ",", "state", ")", ":", "\n", "        ", "self", ".", "reset_clicks", "(", ")", "\n", "for", "click", "in", "state", ":", "\n", "            ", "self", ".", "add_click", "(", "click", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.__len__": [[100, 102], ["len"], "methods", ["None"], ["", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "clicks_list", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.__init__": [[105, 109], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "is_positive", ",", "coords", ",", "indx", "=", "None", ")", ":", "\n", "        ", "self", ".", "is_positive", "=", "is_positive", "\n", "self", ".", "coords", "=", "coords", "\n", "self", ".", "indx", "=", "indx", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.coords_and_indx": [[110, 113], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "coords_and_indx", "(", "self", ")", ":", "\n", "        ", "return", "(", "*", "self", ".", "coords", ",", "self", ".", "indx", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy": [[114, 119], ["copy.deepcopy", "kwargs.items", "setattr"], "methods", ["None"], ["", "def", "copy", "(", "self", ",", "**", "kwargs", ")", ":", "\n", "        ", "self_copy", "=", "deepcopy", "(", "self", ")", "\n", "for", "k", ",", "v", "in", "kwargs", ".", "items", "(", ")", ":", "\n", "            ", "setattr", "(", "self_copy", ",", "k", ",", "v", ")", "\n", "", "return", "self_copy", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.get_time_metrics": [[12, 20], ["len", "sum", "map"], "function", ["None"], ["def", "get_time_metrics", "(", "all_ious", ",", "elapsed_time", ")", ":", "\n", "    ", "n_images", "=", "len", "(", "all_ious", ")", "\n", "n_clicks", "=", "sum", "(", "map", "(", "len", ",", "all_ious", ")", ")", "\n", "\n", "mean_spc", "=", "elapsed_time", "/", "n_clicks", "\n", "mean_spi", "=", "elapsed_time", "/", "n_images", "\n", "\n", "return", "mean_spc", ",", "mean_spi", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.load_is_model": [[22, 35], ["isinstance", "isinstance", "torch.load", "utils.load_single_is_model", "utils.load_single_is_model", "utils.load_single_is_model"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.load_single_is_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.load_single_is_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.load_single_is_model"], ["", "def", "load_is_model", "(", "checkpoint", ",", "device", ",", "**", "kwargs", ")", ":", "\n", "    ", "if", "isinstance", "(", "checkpoint", ",", "(", "str", ",", "Path", ")", ")", ":", "\n", "        ", "state_dict", "=", "torch", ".", "load", "(", "checkpoint", ",", "map_location", "=", "'cpu'", ")", "\n", "", "else", ":", "\n", "        ", "state_dict", "=", "checkpoint", "\n", "\n", "", "if", "isinstance", "(", "state_dict", ",", "list", ")", ":", "\n", "        ", "model", "=", "load_single_is_model", "(", "state_dict", "[", "0", "]", ",", "device", ",", "**", "kwargs", ")", "\n", "models", "=", "[", "load_single_is_model", "(", "x", ",", "device", ",", "**", "kwargs", ")", "for", "x", "in", "state_dict", "]", "\n", "\n", "return", "model", ",", "models", "\n", "", "else", ":", "\n", "        ", "return", "load_single_is_model", "(", "state_dict", ",", "device", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.load_single_is_model": [[37, 48], ["isegm.utils.serialization.load_model", "isegm.utils.serialization.load_model.load_state_dict", "isegm.utils.serialization.load_model.parameters", "isegm.utils.serialization.load_model.to", "isegm.utils.serialization.load_model.eval"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.serialization.load_model"], ["", "", "def", "load_single_is_model", "(", "state_dict", ",", "device", ",", "**", "kwargs", ")", ":", "\n", "#print(state_dict['config'], **kwargs )", "\n", "    ", "model", "=", "load_model", "(", "state_dict", "[", "'config'", "]", ",", "**", "kwargs", ")", "\n", "model", ".", "load_state_dict", "(", "state_dict", "[", "'state_dict'", "]", ",", "strict", "=", "False", ")", "\n", "\n", "for", "param", "in", "model", ".", "parameters", "(", ")", ":", "\n", "        ", "param", ".", "requires_grad", "=", "False", "\n", "", "model", ".", "to", "(", "device", ")", "\n", "model", ".", "eval", "(", ")", "\n", "\n", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.get_dataset": [[50, 74], ["isegm.data.datasets.GrabCutDataset", "isegm.data.datasets.BerkeleyDataset", "isegm.data.datasets.DavisDataset", "isegm.data.datasets.SBDEvaluationDataset", "isegm.data.datasets.SBDEvaluationDataset", "isegm.data.datasets.PascalVocDataset", "isegm.data.datasets.COCOMValDataset", "isegm.data.datasets.Davis585Dataset", "isegm.data.datasets.Davis585Dataset", "isegm.data.datasets.Davis585Dataset"], "function", ["None"], ["", "def", "get_dataset", "(", "dataset_name", ",", "cfg", ")", ":", "\n", "    ", "if", "dataset_name", "==", "'GrabCut'", ":", "\n", "        ", "dataset", "=", "GrabCutDataset", "(", "cfg", ".", "GRABCUT_PATH", ")", "\n", "", "elif", "dataset_name", "==", "'Berkeley'", ":", "\n", "        ", "dataset", "=", "BerkeleyDataset", "(", "cfg", ".", "BERKELEY_PATH", ")", "\n", "", "elif", "dataset_name", "==", "'DAVIS'", ":", "\n", "        ", "dataset", "=", "DavisDataset", "(", "cfg", ".", "DAVIS_PATH", ")", "\n", "", "elif", "dataset_name", "==", "'SBD'", ":", "\n", "        ", "dataset", "=", "SBDEvaluationDataset", "(", "cfg", ".", "SBD_PATH", ")", "\n", "", "elif", "dataset_name", "==", "'SBD_Train'", ":", "\n", "        ", "dataset", "=", "SBDEvaluationDataset", "(", "cfg", ".", "SBD_PATH", ",", "split", "=", "'train'", ")", "\n", "", "elif", "dataset_name", "==", "'PascalVOC'", ":", "\n", "        ", "dataset", "=", "PascalVocDataset", "(", "cfg", ".", "PASCALVOC_PATH", ",", "split", "=", "'val'", ")", "\n", "", "elif", "dataset_name", "==", "'COCO_MVal'", ":", "\n", "        ", "dataset", "=", "COCOMValDataset", "(", "cfg", ".", "COCO_MVAL_PATH", ")", "\n", "", "elif", "dataset_name", "==", "'D585_SP'", ":", "\n", "        ", "dataset", "=", "Davis585Dataset", "(", "cfg", ".", "DAVIS585_PATH", ",", "init_mask_mode", "=", "'sp'", ")", "\n", "", "elif", "dataset_name", "==", "'D585_STM'", ":", "\n", "        ", "dataset", "=", "Davis585Dataset", "(", "cfg", ".", "DAVIS585_PATH", ",", "init_mask_mode", "=", "'stm'", ")", "\n", "", "elif", "dataset_name", "==", "'D585_ZERO'", ":", "\n", "        ", "dataset", "=", "Davis585Dataset", "(", "cfg", ".", "DAVIS585_PATH", ",", "init_mask_mode", "=", "'zero'", ")", "\n", "", "else", ":", "\n", "        ", "dataset", "=", "None", "\n", "", "return", "dataset", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.get_iou": [[76, 84], ["numpy.logical_and().sum", "numpy.logical_and().sum", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "numpy.logical_or"], "function", ["None"], ["", "def", "get_iou", "(", "gt_mask", ",", "pred_mask", ",", "ignore_label", "=", "-", "1", ")", ":", "\n", "    ", "ignore_gt_mask_inv", "=", "gt_mask", "!=", "ignore_label", "\n", "obj_gt_mask", "=", "gt_mask", "==", "1", "\n", "\n", "intersection", "=", "np", ".", "logical_and", "(", "np", ".", "logical_and", "(", "pred_mask", ",", "obj_gt_mask", ")", ",", "ignore_gt_mask_inv", ")", ".", "sum", "(", ")", "\n", "union", "=", "np", ".", "logical_and", "(", "np", ".", "logical_or", "(", "pred_mask", ",", "obj_gt_mask", ")", ",", "ignore_gt_mask_inv", ")", ".", "sum", "(", ")", "\n", "\n", "return", "intersection", "/", "union", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.compute_noc_metric": [[86, 104], ["numpy.array", "np.array.mean", "noc_list.append", "over_max_list.append", "numpy.any", "numpy.argmax", "utils.compute_noc_metric._get_noc"], "function", ["None"], ["", "def", "compute_noc_metric", "(", "all_ious", ",", "iou_thrs", ",", "max_clicks", "=", "20", ")", ":", "\n", "    ", "def", "_get_noc", "(", "iou_arr", ",", "iou_thr", ")", ":", "\n", "        ", "vals", "=", "iou_arr", ">=", "iou_thr", "\n", "return", "np", ".", "argmax", "(", "vals", ")", "+", "1", "if", "np", ".", "any", "(", "vals", ")", "else", "max_clicks", "\n", "\n", "", "noc_list", "=", "[", "]", "\n", "over_max_list", "=", "[", "]", "\n", "for", "iou_thr", "in", "iou_thrs", ":", "\n", "        ", "scores_arr", "=", "np", ".", "array", "(", "[", "_get_noc", "(", "iou_arr", ",", "iou_thr", ")", "\n", "for", "iou_arr", "in", "all_ious", "]", ",", "dtype", "=", "np", ".", "int", ")", "\n", "\n", "score", "=", "scores_arr", ".", "mean", "(", ")", "\n", "over_max", "=", "(", "scores_arr", "==", "max_clicks", ")", ".", "sum", "(", ")", "\n", "\n", "noc_list", ".", "append", "(", "score", ")", "\n", "over_max_list", ".", "append", "(", "over_max", ")", "\n", "\n", "", "return", "noc_list", ",", "over_max_list", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.find_checkpoint": [[106, 127], ["pathlib.Path", "checkpoint_name.endswith", "str", "checkpoint_name.split", "pathlib.Path().exists", "list", "len", "model_folder.rglob", "len", "pathlib.Path.glob", "x.is_dir", "pathlib.Path"], "function", ["None"], ["", "def", "find_checkpoint", "(", "weights_folder", ",", "checkpoint_name", ")", ":", "\n", "    ", "weights_folder", "=", "Path", "(", "weights_folder", ")", "\n", "if", "':'", "in", "checkpoint_name", ":", "\n", "        ", "model_name", ",", "checkpoint_name", "=", "checkpoint_name", ".", "split", "(", "':'", ")", "\n", "models_candidates", "=", "[", "x", "for", "x", "in", "weights_folder", ".", "glob", "(", "f'{model_name}*'", ")", "if", "x", ".", "is_dir", "(", ")", "]", "\n", "assert", "len", "(", "models_candidates", ")", "==", "1", "\n", "model_folder", "=", "models_candidates", "[", "0", "]", "\n", "", "else", ":", "\n", "        ", "model_folder", "=", "weights_folder", "\n", "\n", "", "if", "checkpoint_name", ".", "endswith", "(", "'.pth'", ")", ":", "\n", "        ", "if", "Path", "(", "checkpoint_name", ")", ".", "exists", "(", ")", ":", "\n", "            ", "checkpoint_path", "=", "checkpoint_name", "\n", "", "else", ":", "\n", "            ", "checkpoint_path", "=", "weights_folder", "/", "checkpoint_name", "\n", "", "", "else", ":", "\n", "        ", "model_checkpoints", "=", "list", "(", "model_folder", ".", "rglob", "(", "f'{checkpoint_name}*.pth'", ")", ")", "\n", "assert", "len", "(", "model_checkpoints", ")", "==", "1", "\n", "checkpoint_path", "=", "model_checkpoints", "[", "0", "]", "\n", "\n", "", "return", "str", "(", "checkpoint_path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.get_results_table": [[129, 151], ["len", "str", "datetime.timedelta", "len", "len", "len", "len", "int", "str", "str"], "function", ["None"], ["", "def", "get_results_table", "(", "noc_list", ",", "over_max_list", ",", "brs_type", ",", "dataset_name", ",", "mean_spc", ",", "elapsed_time", ",", "\n", "n_clicks", "=", "20", ",", "model_name", "=", "None", ")", ":", "\n", "    ", "table_header", "=", "(", "f'|{\"Pipeline\":^13}|{\"Dataset\":^11}|'", "\n", "f'{\"NoC@80%\":^9}|{\"NoC@85%\":^9}|{\"NoC@90%\":^9}|'", "\n", "f'{\">=\"+str(n_clicks)+\"@85%\":^9}|{\">=\"+str(n_clicks)+\"@90%\":^9}|'", "\n", "f'{\"SPC,s\":^7}|{\"Time\":^9}|'", ")", "\n", "row_width", "=", "len", "(", "table_header", ")", "\n", "\n", "header", "=", "f'Eval results for model: {model_name}\\n'", "if", "model_name", "is", "not", "None", "else", "''", "\n", "header", "+=", "'-'", "*", "row_width", "+", "'\\n'", "\n", "header", "+=", "table_header", "+", "'\\n'", "+", "'-'", "*", "row_width", "\n", "\n", "eval_time", "=", "str", "(", "timedelta", "(", "seconds", "=", "int", "(", "elapsed_time", ")", ")", ")", "\n", "table_row", "=", "f'|{brs_type:^13}|{dataset_name:^11}|'", "\n", "table_row", "+=", "f'{noc_list[0]:^9.2f}|'", "\n", "table_row", "+=", "f'{noc_list[1]:^9.2f}|'", "if", "len", "(", "noc_list", ")", ">", "1", "else", "f'{\"?\":^9}|'", "\n", "table_row", "+=", "f'{noc_list[2]:^9.2f}|'", "if", "len", "(", "noc_list", ")", ">", "2", "else", "f'{\"?\":^9}|'", "\n", "table_row", "+=", "f'{over_max_list[1]:^9}|'", "if", "len", "(", "noc_list", ")", ">", "1", "else", "f'{\"?\":^9}|'", "\n", "table_row", "+=", "f'{over_max_list[2]:^9}|'", "if", "len", "(", "noc_list", ")", ">", "2", "else", "f'{\"?\":^9}|'", "\n", "table_row", "+=", "f'{mean_spc:^7.3f}|{eval_time:^9}|'", "\n", "\n", "return", "header", ",", "table_row", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.evaluate_dataset": [[21, 44], ["time.time", "tqdm", "time.time", "os.path.exists", "os.makedirs", "range", "dataset.get_sample", "evaluation.evaluate_sample", "all_ious.append", "shutil.rmtree", "len"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_sample", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.evaluate_sample"], ["", "def", "evaluate_dataset", "(", "dataset", ",", "predictor", ",", "vis", "=", "True", ",", "vis_path", "=", "'./experiments/vis_val/'", ",", "**", "kwargs", ")", ":", "\n", "    ", "all_ious", "=", "[", "]", "\n", "if", "vis", ":", "\n", "        ", "save_dir", "=", "vis_path", "+", "dataset", ".", "name", "+", "'/'", "\n", "#save_dir = '/home/admin/workspace/project/data/logs/'+ dataset.name + '/'", "\n", "if", "os", ".", "path", ".", "exists", "(", "save_dir", ")", ":", "\n", "            ", "shutil", ".", "rmtree", "(", "save_dir", ")", "\n", "", "os", ".", "makedirs", "(", "save_dir", ")", "\n", "", "else", ":", "\n", "        ", "save_dir", "=", "None", "\n", "\n", "", "start_time", "=", "time", "(", ")", "\n", "for", "index", "in", "tqdm", "(", "range", "(", "len", "(", "dataset", ")", ")", ",", "leave", "=", "False", ")", ":", "\n", "        ", "sample", "=", "dataset", ".", "get_sample", "(", "index", ")", "\n", "\n", "_", ",", "sample_ious", ",", "_", "=", "evaluate_sample", "(", "sample", ".", "image", ",", "sample", ".", "gt_mask", ",", "sample", ".", "init_mask", ",", "predictor", ",", "\n", "sample_id", "=", "index", ",", "vis", "=", "vis", ",", "save_dir", "=", "save_dir", ",", "\n", "index", "=", "index", ",", "**", "kwargs", ")", "\n", "all_ious", ".", "append", "(", "sample_ious", ")", "\n", "", "end_time", "=", "time", "(", ")", "\n", "elapsed_time", "=", "end_time", "-", "start_time", "\n", "\n", "return", "all_ious", ",", "elapsed_time", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.Progressive_Merge": [[45, 55], ["numpy.logical_xor", "cv2.connectedComponents", "np.logical_xor.astype", "numpy.logical_and", "numpy.logical_or", "numpy.logical_not"], "function", ["None"], ["", "def", "Progressive_Merge", "(", "pred_mask", ",", "previous_mask", ",", "y", ",", "x", ")", ":", "\n", "    ", "diff_regions", "=", "np", ".", "logical_xor", "(", "previous_mask", ",", "pred_mask", ")", "\n", "num", ",", "labels", "=", "cv2", ".", "connectedComponents", "(", "diff_regions", ".", "astype", "(", "np", ".", "uint8", ")", ")", "\n", "label", "=", "labels", "[", "y", ",", "x", "]", "\n", "corr_mask", "=", "labels", "==", "label", "\n", "if", "previous_mask", "[", "y", ",", "x", "]", "==", "1", ":", "\n", "        ", "progressive_mask", "=", "np", ".", "logical_and", "(", "previous_mask", ",", "np", ".", "logical_not", "(", "corr_mask", ")", ")", "\n", "", "else", ":", "\n", "        ", "progressive_mask", "=", "np", ".", "logical_or", "(", "previous_mask", ",", "corr_mask", ")", "\n", "", "return", "progressive_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.evaluate_sample": [[57, 119], ["isegm.inference.clicker.Clicker", "numpy.zeros_like", "torch.no_grad", "predictor.set_input_image", "range", "predictor.set_prev_mask", "isegm.inference.clicker.Clicker.make_next_click", "predictor.get_prediction", "isegm.inference.utils.get_iou", "ious_list.append", "numpy.array", "isegm.inference.clicker.Clicker.get_clicks", "callback", "isegm.inference.clicker.Clicker.get_clicks", "evaluation.vis_result_refine", "cv2.imwrite", "cv2.imwrite", "isegm.inference.clicker.Clicker.get_clicks", "evaluation.vis_result_base", "cv2.imwrite", "len", "evaluation.Progressive_Merge", "numpy.expand_dims", "numpy.expand_dims", "str", "str", "str"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.set_input_image", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.set_prev_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.make_next_click", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_prediction", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_iou", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.vis_result_refine", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.vis_result_base", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.Progressive_Merge"], ["", "def", "evaluate_sample", "(", "image", ",", "gt_mask", ",", "init_mask", ",", "predictor", ",", "max_iou_thr", ",", "\n", "pred_thr", "=", "0.49", ",", "min_clicks", "=", "1", ",", "max_clicks", "=", "20", ",", "\n", "sample_id", "=", "None", ",", "vis", "=", "True", ",", "save_dir", "=", "None", ",", "index", "=", "0", ",", "callback", "=", "None", ",", "\n", "progressive_mode", "=", "True", ",", "\n", ")", ":", "\n", "    ", "clicker", "=", "Clicker", "(", "gt_mask", "=", "gt_mask", ")", "\n", "pred_mask", "=", "np", ".", "zeros_like", "(", "gt_mask", ")", "\n", "prev_mask", "=", "pred_mask", "\n", "ious_list", "=", "[", "]", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "predictor", ".", "set_input_image", "(", "image", ")", "\n", "if", "init_mask", "is", "not", "None", ":", "\n", "            ", "predictor", ".", "set_prev_mask", "(", "init_mask", ")", "\n", "pred_mask", "=", "init_mask", "\n", "prev_mask", "=", "init_mask", "\n", "num_pm", "=", "0", "\n", "", "else", ":", "\n", "            ", "num_pm", "=", "999", "\n", "\n", "", "for", "click_indx", "in", "range", "(", "max_clicks", ")", ":", "\n", "            ", "vis_pred", "=", "prev_mask", "\n", "clicker", ".", "make_next_click", "(", "pred_mask", ")", "\n", "pred_probs", "=", "predictor", ".", "get_prediction", "(", "clicker", ")", "\n", "pred_mask", "=", "pred_probs", ">", "pred_thr", "\n", "\n", "if", "progressive_mode", ":", "\n", "                ", "clicks", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "if", "len", "(", "clicks", ")", ">=", "num_pm", ":", "\n", "                    ", "last_click", "=", "clicks", "[", "-", "1", "]", "\n", "last_y", ",", "last_x", "=", "last_click", ".", "coords", "[", "0", "]", ",", "last_click", ".", "coords", "[", "1", "]", "\n", "pred_mask", "=", "Progressive_Merge", "(", "pred_mask", ",", "prev_mask", ",", "last_y", ",", "last_x", ")", "\n", "predictor", ".", "transforms", "[", "0", "]", ".", "_prev_probs", "=", "np", ".", "expand_dims", "(", "np", ".", "expand_dims", "(", "pred_mask", ",", "0", ")", ",", "0", ")", "\n", "", "", "if", "callback", "is", "not", "None", ":", "\n", "                ", "callback", "(", "image", ",", "gt_mask", ",", "pred_probs", ",", "sample_id", ",", "click_indx", ",", "clicker", ".", "clicks_list", ")", "\n", "\n", "", "iou", "=", "utils", ".", "get_iou", "(", "gt_mask", ",", "pred_mask", ")", "\n", "ious_list", ".", "append", "(", "iou", ")", "\n", "prev_mask", "=", "pred_mask", "\n", "\n", "if", "iou", ">=", "max_iou_thr", "and", "click_indx", "+", "1", ">=", "min_clicks", ":", "\n", "                ", "break", "\n", "\n", "", "", "if", "vis", ":", "\n", "            ", "if", "predictor", ".", "focus_roi", "is", "not", "None", ":", "\n", "                ", "focus_roi", "=", "predictor", ".", "focus_roi", "\n", "global_roi", "=", "predictor", ".", "global_roi", "\n", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "last_y", ",", "last_x", "=", "predictor", ".", "last_y", ",", "predictor", ".", "last_x", "\n", "focus_refined", "=", "predictor", ".", "focus_refined", "\n", "focus_coarse", "=", "predictor", ".", "focus_coarse", "\n", "\n", "out_image", ",", "focus_image", "=", "vis_result_refine", "(", "image", ",", "pred_mask", ",", "gt_mask", ",", "init_mask", ",", "iou", ",", "click_indx", "+", "1", ",", "clicks_list", ",", "focus_roi", ",", "global_roi", ",", "vis_pred", ",", "last_y", ",", "last_x", ",", "focus_refined", ",", "focus_coarse", ")", "\n", "cv2", ".", "imwrite", "(", "save_dir", "+", "str", "(", "index", ")", "+", "'.png'", ",", "out_image", ")", "\n", "cv2", ".", "imwrite", "(", "save_dir", "+", "str", "(", "index", ")", "+", "'_focus.png'", ",", "focus_image", ")", "\n", "\n", "", "else", ":", "\n", "                ", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "last_y", ",", "last_x", "=", "predictor", ".", "last_y", ",", "predictor", ".", "last_x", "\n", "out_image", "=", "vis_result_base", "(", "image", ",", "pred_mask", ",", "gt_mask", ",", "init_mask", ",", "iou", ",", "click_indx", "+", "1", ",", "clicks_list", ",", "vis_pred", ",", "last_y", ",", "last_x", ")", "\n", "cv2", ".", "imwrite", "(", "save_dir", "+", "str", "(", "index", ")", "+", "'.png'", ",", "out_image", ")", "\n", "", "", "return", "clicker", ".", "clicks_list", ",", "np", ".", "array", "(", "ious_list", ",", "dtype", "=", "np", ".", "float32", ")", ",", "pred_probs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.vis_result_base": [[124, 196], ["cv2.cvtColor", "pred_mask.astype.astype", "prev_prediction.astype", "instances_mask.astype.astype", "isegm.utils.vis.add_tag.astype", "numpy.repeat", "numpy.repeat", "numpy.repeat", "numpy.zeros_like", "numpy.zeros_like", "numpy.zeros_like", "numpy.zeros_like", "range", "cv2.circle", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "len", "cv2.circle", "cv2.hconcat", "cv2.hconcat", "str", "round", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "str"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag"], ["", "", "def", "vis_result_base", "(", "image", ",", "pred_mask", ",", "instances_mask", ",", "init_mask", ",", "iou", ",", "num_clicks", ",", "clicks_list", ",", "prev_prediction", ",", "last_y", ",", "last_x", ")", ":", "\n", "\n", "    ", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_RGB2BGR", ")", "\n", "\n", "pred_mask", "=", "pred_mask", ".", "astype", "(", "np", ".", "float32", ")", "\n", "prev_mask", "=", "prev_prediction", ".", "astype", "(", "np", ".", "float32", ")", "\n", "instances_mask", "=", "instances_mask", ".", "astype", "(", "np", ".", "float32", ")", "\n", "image", "=", "image", ".", "astype", "(", "np", ".", "float32", ")", "\n", "\n", "pred_mask_3", "=", "np", ".", "repeat", "(", "pred_mask", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "prev_mask_3", "=", "np", ".", "repeat", "(", "prev_mask", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "gt_mask_3", "=", "np", ".", "repeat", "(", "instances_mask", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "\n", "color_mask_gt", "=", "np", ".", "zeros_like", "(", "pred_mask_3", ")", "\n", "color_mask_gt", "[", ":", ",", ":", ",", "0", "]", "=", "instances_mask", "*", "255", "\n", "\n", "color_mask_pred", "=", "np", ".", "zeros_like", "(", "pred_mask_3", ")", "#+ 255", "\n", "color_mask_pred", "[", ":", ",", ":", ",", "0", "]", "=", "pred_mask", "*", "255", "\n", "\n", "color_mask_prev", "=", "np", ".", "zeros_like", "(", "prev_mask_3", ")", "#+ 255", "\n", "color_mask_prev", "[", ":", ",", ":", ",", "0", "]", "=", "prev_mask", "*", "255", "\n", "\n", "\n", "fusion_pred", "=", "image", "*", "0.4", "+", "color_mask_pred", "*", "0.6", "\n", "fusion_pred", "=", "image", "*", "(", "1", "-", "pred_mask_3", ")", "+", "fusion_pred", "*", "pred_mask_3", "\n", "\n", "fusion_prev", "=", "image", "*", "0.4", "+", "color_mask_prev", "*", "0.6", "\n", "fusion_prev", "=", "image", "*", "(", "1", "-", "prev_mask_3", ")", "+", "fusion_prev", "*", "prev_mask_3", "\n", "\n", "\n", "fusion_gt", "=", "image", "*", "0.4", "+", "color_mask_gt", "*", "0.6", "\n", "\n", "color_mask_init", "=", "np", ".", "zeros_like", "(", "pred_mask_3", ")", "\n", "if", "init_mask", "is", "not", "None", ":", "\n", "        ", "color_mask_init", "[", ":", ",", ":", ",", "0", "]", "=", "init_mask", "*", "255", "\n", "\n", "", "fusion_init", "=", "image", "*", "0.4", "+", "color_mask_init", "*", "0.6", "\n", "fusion_init", "=", "image", "*", "(", "1", "-", "color_mask_init", ")", "+", "fusion_init", "*", "color_mask_init", "\n", "\n", "\n", "#cv2.putText( image, 'click num: '+str(num_clicks)+ '  iou: '+ str(round(iou,3)), (50,50),", "\n", "#            cv2.FONT_HERSHEY_COMPLEX, 1, (255, 255, 255 ), 1   )", "\n", "\n", "for", "i", "in", "range", "(", "len", "(", "clicks_list", ")", ")", ":", "\n", "        ", "click_tuple", "=", "clicks_list", "[", "i", "]", "\n", "\n", "if", "click_tuple", ".", "is_positive", ":", "\n", "            ", "color", "=", "(", "0", ",", "0", ",", "255", ")", "\n", "", "else", ":", "\n", "            ", "color", "=", "(", "0", ",", "255", ",", "0", ")", "\n", "\n", "", "coord", "=", "click_tuple", ".", "coords", "\n", "x", ",", "y", "=", "coord", "[", "1", "]", ",", "coord", "[", "0", "]", "\n", "if", "x", "<", "0", "or", "y", "<", "0", ":", "\n", "            ", "continue", "\n", "", "cv2", ".", "circle", "(", "fusion_pred", ",", "(", "x", ",", "y", ")", ",", "4", ",", "color", ",", "-", "1", ")", "\n", "#cv2.putText(fusion_pred, str(i+1), (x-10, y-10),  cv2.FONT_HERSHEY_COMPLEX, 0.6 , color,1 )", "\n", "\n", "", "cv2", ".", "circle", "(", "fusion_pred", ",", "(", "last_x", ",", "last_y", ")", ",", "2", ",", "(", "255", ",", "255", ",", "255", ")", ",", "-", "1", ")", "\n", "image", "=", "add_tag", "(", "image", ",", "'nclicks:'", "+", "str", "(", "num_clicks", ")", "+", "'  iou:'", "+", "str", "(", "round", "(", "iou", ",", "3", ")", ")", ")", "\n", "fusion_init", "=", "add_tag", "(", "fusion_init", ",", "'init mask'", ")", "\n", "fusion_pred", "=", "add_tag", "(", "fusion_pred", ",", "'pred'", ")", "\n", "fusion_gt", "=", "add_tag", "(", "fusion_gt", ",", "'gt'", ")", "\n", "fusion_prev", "=", "add_tag", "(", "fusion_prev", ",", "'prev pred'", ")", "\n", "\n", "h", ",", "w", "=", "image", ".", "shape", "[", "0", "]", ",", "image", ".", "shape", "[", "1", "]", "\n", "if", "h", "<", "w", ":", "\n", "        ", "out_image", "=", "cv2", ".", "hconcat", "(", "[", "image", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_init", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_pred", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_gt", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_prev", ".", "astype", "(", "np", ".", "float32", ")", "]", ")", "\n", "", "else", ":", "\n", "        ", "out_image", "=", "cv2", ".", "hconcat", "(", "[", "image", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_init", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_pred", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_gt", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_prev", ".", "astype", "(", "np", ".", "float32", ")", "]", ")", "\n", "\n", "", "return", "out_image", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.vis_result_refine": [[198, 284], ["cv2.cvtColor", "pred_mask.astype.astype", "prev_prediction.astype", "instances_mask.astype.astype", "focus_refined.astype.astype", "focus_coarse.astype.astype", "isegm.utils.vis.add_tag.astype", "numpy.repeat", "numpy.repeat", "numpy.repeat", "numpy.repeat", "numpy.repeat", "numpy.zeros_like", "numpy.zeros_like", "numpy.zeros_like", "numpy.zeros_like", "range", "cv2.circle", "cv2.rectangle", "cv2.rectangle", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "isegm.utils.vis.add_tag", "cv2.hconcat", "len", "cv2.circle", "cv2.hconcat", "cv2.hconcat", "str", "round", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "isegm.utils.vis.add_tag.astype", "str"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.add_tag"], ["", "def", "vis_result_refine", "(", "image", ",", "pred_mask", ",", "instances_mask", ",", "init_mask", ",", "iou", ",", "num_clicks", ",", "clicks_list", ",", "focus_roi", ",", "global_roi", ",", "prev_prediction", ",", "last_y", ",", "last_x", ",", "focus_refined", ",", "focus_coarse", ")", ":", "\n", "\n", "    ", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_RGB2BGR", ")", "\n", "\n", "pred_mask", "=", "pred_mask", ".", "astype", "(", "np", ".", "float32", ")", "\n", "prev_mask", "=", "prev_prediction", ".", "astype", "(", "np", ".", "float32", ")", "\n", "instances_mask", "=", "instances_mask", ".", "astype", "(", "np", ".", "float32", ")", "\n", "focus_refined", "=", "focus_refined", ".", "astype", "(", "np", ".", "float32", ")", "\n", "focus_coarse", "=", "focus_coarse", ".", "astype", "(", "np", ".", "float32", ")", "\n", "image", "=", "image", ".", "astype", "(", "np", ".", "float32", ")", "\n", "\n", "pred_mask_3", "=", "np", ".", "repeat", "(", "pred_mask", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "prev_mask_3", "=", "np", ".", "repeat", "(", "prev_mask", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "gt_mask_3", "=", "np", ".", "repeat", "(", "instances_mask", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "focus_refined_3", "=", "np", ".", "repeat", "(", "focus_refined", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "focus_coarse_3", "=", "np", ".", "repeat", "(", "focus_coarse", "[", "...", ",", "np", ".", "newaxis", "]", ",", "3", ",", "2", ")", "\n", "\n", "color_mask_gt", "=", "np", ".", "zeros_like", "(", "pred_mask_3", ")", "\n", "color_mask_gt", "[", ":", ",", ":", ",", "0", "]", "=", "instances_mask", "*", "255", "\n", "\n", "color_mask_pred", "=", "np", ".", "zeros_like", "(", "pred_mask_3", ")", "#+ 255", "\n", "color_mask_pred", "[", ":", ",", ":", ",", "0", "]", "=", "pred_mask", "*", "255", "\n", "\n", "color_mask_prev", "=", "np", ".", "zeros_like", "(", "prev_mask_3", ")", "#+ 255", "\n", "color_mask_prev", "[", ":", ",", ":", ",", "0", "]", "=", "prev_mask", "*", "255", "\n", "\n", "\n", "fusion_pred", "=", "image", "*", "0.4", "+", "color_mask_pred", "*", "0.6", "\n", "fusion_pred", "=", "image", "*", "(", "1", "-", "pred_mask_3", ")", "+", "fusion_pred", "*", "pred_mask_3", "\n", "\n", "fusion_prev", "=", "image", "*", "0.4", "+", "color_mask_prev", "*", "0.6", "\n", "fusion_prev", "=", "image", "*", "(", "1", "-", "prev_mask_3", ")", "+", "fusion_prev", "*", "prev_mask_3", "\n", "\n", "\n", "fusion_gt", "=", "image", "*", "0.4", "+", "color_mask_gt", "*", "0.6", "\n", "\n", "color_mask_init", "=", "np", ".", "zeros_like", "(", "pred_mask_3", ")", "\n", "if", "init_mask", "is", "not", "None", ":", "\n", "        ", "color_mask_init", "[", ":", ",", ":", ",", "0", "]", "=", "init_mask", "*", "255", "\n", "\n", "", "fusion_init", "=", "image", "*", "0.4", "+", "color_mask_init", "*", "0.6", "\n", "fusion_init", "=", "image", "*", "(", "1", "-", "color_mask_init", ")", "+", "fusion_init", "*", "color_mask_init", "\n", "\n", "\n", "#cv2.putText( image, 'click num: '+str(num_clicks)+ '  iou: '+ str(round(iou,3)), (50,50),", "\n", "#            cv2.FONT_HERSHEY_COMPLEX, 1, (255, 255, 255 ), 1   )", "\n", "\n", "\n", "for", "i", "in", "range", "(", "len", "(", "clicks_list", ")", ")", ":", "\n", "        ", "click_tuple", "=", "clicks_list", "[", "i", "]", "\n", "\n", "if", "click_tuple", ".", "is_positive", ":", "\n", "            ", "color", "=", "(", "0", ",", "0", ",", "255", ")", "\n", "", "else", ":", "\n", "            ", "color", "=", "(", "0", ",", "255", ",", "0", ")", "\n", "\n", "", "coord", "=", "click_tuple", ".", "coords", "\n", "x", ",", "y", "=", "coord", "[", "1", "]", ",", "coord", "[", "0", "]", "\n", "if", "x", "<", "0", "or", "y", "<", "0", ":", "\n", "            ", "continue", "\n", "", "cv2", ".", "circle", "(", "fusion_pred", ",", "(", "x", ",", "y", ")", ",", "4", ",", "color", ",", "-", "1", ")", "\n", "#cv2.putText(fusion_pred, str(i+1), (x-10, y-10),  cv2.FONT_HERSHEY_COMPLEX, 0.6 , color,1 )", "\n", "\n", "", "cv2", ".", "circle", "(", "fusion_pred", ",", "(", "last_x", ",", "last_y", ")", ",", "2", ",", "(", "255", ",", "255", ",", "255", ")", ",", "-", "1", ")", "\n", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi", "\n", "cv2", ".", "rectangle", "(", "image", ",", "(", "x1", "+", "1", ",", "y1", "+", "1", ")", ",", "(", "x2", "-", "1", ",", "y2", "-", "1", ")", ",", "(", "0", ",", "255", ",", "0", ")", ",", "1", ")", "\n", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "global_roi", "\n", "cv2", ".", "rectangle", "(", "image", ",", "(", "x1", ",", "y1", ")", ",", "(", "x2", ",", "y2", ")", ",", "(", "0", ",", "0", ",", "255", ")", ",", "1", ")", "\n", "\n", "h", ",", "w", "=", "image", ".", "shape", "[", "0", "]", ",", "image", ".", "shape", "[", "1", "]", "\n", "image", "=", "add_tag", "(", "image", ",", "'nclicks:'", "+", "str", "(", "num_clicks", ")", "+", "'  iou:'", "+", "str", "(", "round", "(", "iou", ",", "3", ")", ")", ")", "\n", "fusion_init", "=", "add_tag", "(", "fusion_init", ",", "'init mask'", ")", "\n", "fusion_pred", "=", "add_tag", "(", "fusion_pred", ",", "'pred'", ")", "\n", "fusion_gt", "=", "add_tag", "(", "fusion_gt", ",", "'gt'", ")", "\n", "fusion_prev", "=", "add_tag", "(", "fusion_prev", ",", "'prev pred'", ")", "\n", "focus_coarse_3", "=", "add_tag", "(", "focus_coarse_3", ",", "'focus coarse'", ")", "\n", "focus_refined_3", "=", "add_tag", "(", "focus_refined_3", ",", "'focus refined'", ")", "\n", "if", "h", "<", "w", ":", "\n", "        ", "out_image", "=", "cv2", ".", "hconcat", "(", "[", "image", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_init", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_pred", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_gt", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_prev", ".", "astype", "(", "np", ".", "float32", ")", "]", ")", "\n", "", "else", ":", "\n", "        ", "out_image", "=", "cv2", ".", "hconcat", "(", "[", "image", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_init", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_pred", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_gt", ".", "astype", "(", "np", ".", "float32", ")", ",", "fusion_prev", ".", "astype", "(", "np", ".", "float32", ")", "]", ")", "\n", "\n", "", "focus_image", "=", "cv2", ".", "hconcat", "(", "[", "focus_coarse_3", ",", "focus_refined_3", "]", ")", "\n", "return", "out_image", ",", "focus_image", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.__init__": [[7, 42], ["isinstance", "torchvision.transforms.ToTensor", "base.BasePredictor.transforms.append", "base.BasePredictor.transforms.append", "base.BasePredictor.transforms.append", "isegm.inference.transforms.ResizeTrans", "isegm.inference.transforms.SigmoidForPred", "base.BasePredictor.transforms.append", "isegm.inference.transforms.LimitLongestSide", "isegm.inference.transforms.AddHorizontalFlip"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "\n", "net_clicks_limit", "=", "None", ",", "\n", "with_flip", "=", "False", ",", "\n", "zoom_in", "=", "None", ",", "\n", "max_size", "=", "None", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "with_flip", "=", "with_flip", "\n", "self", ".", "net_clicks_limit", "=", "net_clicks_limit", "\n", "self", ".", "original_image", "=", "None", "\n", "self", ".", "device", "=", "device", "\n", "self", ".", "zoom_in", "=", "zoom_in", "\n", "self", ".", "prev_prediction", "=", "None", "\n", "self", ".", "model_indx", "=", "0", "\n", "self", ".", "click_models", "=", "None", "\n", "self", ".", "net_state_dict", "=", "None", "\n", "\n", "if", "isinstance", "(", "model", ",", "tuple", ")", ":", "\n", "            ", "self", ".", "net", ",", "self", ".", "click_models", "=", "model", "\n", "", "else", ":", "\n", "            ", "self", ".", "net", "=", "model", "\n", "\n", "", "self", ".", "to_tensor", "=", "transforms", ".", "ToTensor", "(", ")", "\n", "\n", "self", ".", "transforms", "=", "[", "zoom_in", "]", "if", "zoom_in", "is", "not", "None", "else", "[", "]", "\n", "if", "max_size", "is", "not", "None", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "LimitLongestSide", "(", "max_size", "=", "max_size", ")", ")", "\n", "", "self", ".", "crop_l", "=", "256", "\n", "self", ".", "transforms", ".", "append", "(", "ResizeTrans", "(", "self", ".", "crop_l", ")", ")", "\n", "self", ".", "transforms", ".", "append", "(", "SigmoidForPred", "(", ")", ")", "\n", "self", ".", "focus_roi", "=", "(", "0", ",", "10", ",", "0", ",", "10", ")", "\n", "self", ".", "global_roi", "=", "(", "0", ",", "10", ",", "0", ",", "10", ")", "\n", "\n", "self", ".", "with_flip", "=", "True", "\n", "if", "self", ".", "with_flip", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "AddHorizontalFlip", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.set_input_image": [[43, 51], ["base.BasePredictor.to_tensor", "base.BasePredictor.to", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "transform.reset", "len", "base.BasePredictor.original_image.unsqueeze"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.reset"], ["", "", "def", "set_input_image", "(", "self", ",", "image", ")", ":", "\n", "        ", "image_nd", "=", "self", ".", "to_tensor", "(", "image", ")", "\n", "for", "transform", "in", "self", ".", "transforms", ":", "\n", "            ", "transform", ".", "reset", "(", ")", "\n", "", "self", ".", "original_image", "=", "image_nd", ".", "to", "(", "self", ".", "device", ")", "\n", "if", "len", "(", "self", ".", "original_image", ".", "shape", ")", "==", "3", ":", "\n", "            ", "self", ".", "original_image", "=", "self", ".", "original_image", ".", "unsqueeze", "(", "0", ")", "\n", "", "self", ".", "prev_prediction", "=", "torch", ".", "zeros_like", "(", "self", ".", "original_image", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.set_prev_mask": [[52, 54], ["torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["None"], ["", "def", "set_prev_mask", "(", "self", ",", "mask", ")", ":", "\n", "        ", "self", ".", "prev_prediction", "=", "torch", ".", "from_numpy", "(", "mask", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "to", "(", "self", ".", "device", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.get_prediction": [[55, 155], ["clicker.get_clicks", "base.BasePredictor.apply_transforms", "base.BasePredictor._get_prediction", "torch.interpolate", "torch.interpolate", "reversed", "torch.log", "torch.log", "torch.log", "torch.log", "clicker.get_clicks", "get_focus_bbox_v5", "base.BasePredictor.mapp_roi", "base.BasePredictor._get_refine", "torch.interpolate", "torch.interpolate", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.log.cpu().numpy", "torch.log.cpu().numpy", "hasattr", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "t.inv_transform", "torch.log.cpu().numpy", "torch.log.cpu().numpy", "prev_mask.cpu().numpy", "len", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log.cpu().numpy", "torch.log.cpu().numpy", "min", "torch.log.cpu", "torch.log.cpu", "len", "image_nd.size", "torch.log.cpu", "torch.log.cpu", "prev_mask.cpu", "torch.log.cpu", "torch.log.cpu", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.apply_transforms", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_prediction", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.mapp_roi", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_refine", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.inv_transform"], ["", "def", "get_prediction", "(", "self", ",", "clicker", ",", "prev_mask", "=", "None", ")", ":", "\n", "        ", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "click", "=", "clicks_list", "[", "-", "1", "]", "\n", "last_y", ",", "last_x", "=", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", "\n", "self", ".", "last_y", "=", "last_y", "\n", "self", ".", "last_x", "=", "last_x", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "model_indx", "=", "min", "(", "clicker", ".", "click_indx_offset", "+", "len", "(", "clicks_list", ")", ",", "len", "(", "self", ".", "click_models", ")", ")", "-", "1", "\n", "if", "model_indx", "!=", "self", ".", "model_indx", ":", "\n", "                ", "self", ".", "model_indx", "=", "model_indx", "\n", "self", ".", "net", "=", "self", ".", "click_models", "[", "model_indx", "]", "\n", "\n", "", "", "input_image", "=", "self", ".", "original_image", "\n", "if", "prev_mask", "is", "None", ":", "\n", "            ", "prev_mask", "=", "self", ".", "prev_prediction", "\n", "", "if", "hasattr", "(", "self", ".", "net", ",", "'with_prev_mask'", ")", "and", "self", ".", "net", ".", "with_prev_mask", ":", "\n", "            ", "input_image", "=", "torch", ".", "cat", "(", "(", "input_image", ",", "prev_mask", ")", ",", "dim", "=", "1", ")", "\n", "\n", "\n", "\n", "", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "=", "self", ".", "apply_transforms", "(", "\n", "input_image", ",", "[", "clicks_list", "]", "\n", ")", "\n", "\n", "try", ":", "\n", "            ", "roi", "=", "self", ".", "transforms", "[", "0", "]", ".", "_object_roi", "\n", "", "except", ":", "\n", "            ", "roi", "=", "None", "\n", "\n", "", "if", "roi", "is", "None", ":", "\n", "            ", "h", ",", "w", "=", "prev_mask", ".", "shape", "[", "-", "2", "]", ",", "prev_mask", ".", "shape", "[", "-", "1", "]", "\n", "global_roi", "=", "(", "0", ",", "h", ",", "0", ",", "w", ")", "\n", "\n", "", "else", ":", "\n", "            ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "roi", "\n", "global_roi", "=", "(", "y1", ",", "y2", "+", "1", ",", "x1", ",", "x2", "+", "1", ")", "\n", "\n", "", "self", ".", "global_roi", "=", "global_roi", "\n", "\n", "\n", "\n", "\n", "pred_logits", ",", "feature", "=", "self", ".", "_get_prediction", "(", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", "\n", "prediction", "=", "F", ".", "interpolate", "(", "pred_logits", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ",", "\n", "size", "=", "image_nd", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "\n", "\n", "for", "t", "in", "reversed", "(", "self", ".", "transforms", ")", ":", "\n", "#if not isinstance(t,SigmoidForPred):", "\n", "            ", "prediction", "=", "t", ".", "inv_transform", "(", "prediction", ")", "\n", "\n", "#if self.zoom_in is not None and self.zoom_in.check_possible_recalculation():", "\n", "#    return self.get_prediction(clicker)", "\n", "\n", "\n", "\n", "#self.prev_prediction = prediction", "\n", "#return prediction.cpu().numpy()[0, 0]", "\n", "\n", "\n", "", "prediction", "=", "torch", ".", "log", "(", "prediction", "/", "(", "1", "-", "prediction", ")", ")", "\n", "coarse_mask", "=", "prediction", "#.cpu().numpy()[0, 0] > 0.49", "\n", "prev_mask", "=", "prev_mask", "#.cpu().numpy()[0, 0] > 0.49", "\n", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "image_full", "=", "self", ".", "original_image", "\n", "#print(coarse_mask.max(),coarse_mask.min() )", "\n", "\n", "coarse_mask_np", "=", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "prev_mask_np", "=", "prev_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n", "\n", "if", "len", "(", "clicks_list", ")", ">", "10", ":", "\n", "            ", "progress_mode", "=", "True", "\n", "", "else", ":", "\n", "            ", "progress_mode", "=", "False", "\n", "\n", "#y1,y2,x1,x2 = get_focus_bbox_all(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x,1.4, progress_mode)", "\n", "#y1,y2,x1,x2 = get_focus_bbox_pp(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x, 1.4, 0)", "\n", "", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "get_focus_bbox_v5", "(", "coarse_mask_np", ",", "prev_mask_np", ",", "global_roi", ",", "last_y", ",", "last_x", ",", "1.4", ",", "0", ")", "\n", "\n", "if", "progress_mode", ":", "\n", "            ", "coarse_mask", "=", "self", ".", "prev_prediction", "\n", "coarse_mask", "=", "torch", ".", "log", "(", "coarse_mask", "/", "(", "1", "-", "coarse_mask", ")", ")", "\n", "\n", "", "focus_roi", "=", "(", "y1", ",", "y2", ",", "x1", ",", "x2", ")", "\n", "self", ".", "focus_roi", "=", "focus_roi", "\n", "focus_roi_in_global_roi", "=", "self", ".", "mapp_roi", "(", "focus_roi", ",", "global_roi", ")", "\n", "focus_pred", "=", "self", ".", "_get_refine", "(", "pred_logits", ",", "image_full", ",", "clicks_list", ",", "feature", ",", "focus_roi", ",", "focus_roi_in_global_roi", ")", "#.cpu().numpy()[0, 0]", "\n", "focus_pred", "=", "F", ".", "interpolate", "(", "focus_pred", ",", "(", "y2", "-", "y1", ",", "x2", "-", "x1", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", "#.cpu().numpy()[0, 0]", "\n", "\n", "coarse_mask", "[", ":", ",", ":", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "=", "focus_pred", "\n", "coarse_mask", "=", "torch", ".", "sigmoid", "(", "coarse_mask", ")", "\n", "\n", "\n", "self", ".", "prev_prediction", "=", "coarse_mask", "\n", "#print(111,self.transforms[0]._prev_probs.sum())", "\n", "self", ".", "transforms", "[", "0", "]", ".", "_prev_probs", "=", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "#print(222,self.transforms[0]._prev_probs.sum())", "\n", "return", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor._get_prediction": [[156, 160], ["base.BasePredictor.get_points_nd", "base.BasePredictor.net"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd"], ["", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "output", "=", "self", ".", "net", "(", "image_nd", ",", "points_nd", ")", "\n", "return", "output", "[", "'instances'", "]", ",", "output", "[", "'feature'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor._get_refine": [[161, 186], ["base.BasePredictor.get_points_nd_inbbox", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "base.BasePredictor.net.refine", "torch.interpolate", "torch.interpolate", "print", "print", "print", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd_inbbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.refine"], ["", "def", "_get_refine", "(", "self", ",", "coarse_mask", ",", "image", ",", "clicks", ",", "feature", ",", "focus_roi", ",", "focus_roi_in_global_roi", ")", ":", "\n", "        ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi", "\n", "image_focus", "=", "image", "[", ":", ",", ":", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "\n", "try", ":", "\n", "            ", "image_focus", "=", "F", ".", "interpolate", "(", "image_focus", ",", "(", "self", ".", "crop_l", ",", "self", ".", "crop_l", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "", "except", ":", "\n", "            ", "ly", ",", "lx", ",", "lin", "=", "clicks", "[", "-", "1", "]", ".", "coords_and_indx", "\n", "print", "(", "'last clicks: '", ",", "clicks", "[", "-", "1", "]", ".", "is_positive", ")", "\n", "print", "(", "self", ".", "prev_prediction", ".", "shape", ")", "\n", "print", "(", "ly", ",", "lx", ",", "self", ".", "prev_prediction", "[", "0", ",", "0", ",", "ly", ",", "lx", "]", ")", "\n", "\n", "", "mask_focus", "=", "coarse_mask", "\n", "#mask_focus = coarse_mask[:,:,y1:y2,x1:x2]", "\n", "#mask_focus = F.interpolate(mask_focus,(self.crop_l,self.crop_l),mode='bilinear',align_corners=True)", "\n", "\n", "points_nd", "=", "self", ".", "get_points_nd_inbbox", "(", "clicks", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi_in_global_roi", "\n", "roi", "=", "torch", ".", "tensor", "(", "[", "0", ",", "x1", ",", "y1", ",", "x2", ",", "y2", "]", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ".", "to", "(", "image_focus", ".", "device", ")", "\n", "\n", "\n", "pred", "=", "self", ".", "net", ".", "refine", "(", "image_focus", ",", "points_nd", ",", "feature", ",", "mask_focus", ",", "roi", ")", "#['instances_refined'] ", "\n", "focus_coarse", ",", "focus_refined", "=", "pred", "[", "'instances_coarse'", "]", ",", "pred", "[", "'instances_refined'", "]", "\n", "self", ".", "focus_coarse", "=", "torch", ".", "sigmoid", "(", "focus_coarse", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "self", ".", "focus_refined", "=", "torch", ".", "sigmoid", "(", "focus_refined", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "return", "focus_refined", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.mapp_roi": [[189, 204], ["max", "min", "max", "min"], "methods", ["None"], ["", "def", "mapp_roi", "(", "self", ",", "focus_roi", ",", "global_roi", ")", ":", "\n", "        ", "yg1", ",", "yg2", ",", "xg1", ",", "xg2", "=", "global_roi", "\n", "hg", ",", "wg", "=", "yg2", "-", "yg1", ",", "xg2", "-", "xg1", "\n", "yf1", ",", "yf2", ",", "xf1", ",", "xf2", "=", "focus_roi", "\n", "\n", "yf1_n", "=", "(", "yf1", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "yf2_n", "=", "(", "yf2", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "xf1_n", "=", "(", "xf1", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "xf2_n", "=", "(", "xf2", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "\n", "yf1_n", "=", "max", "(", "yf1_n", ",", "0", ")", "\n", "yf2_n", "=", "min", "(", "yf2_n", ",", "self", ".", "crop_l", ")", "\n", "xf1_n", "=", "max", "(", "xf1_n", ",", "0", ")", "\n", "xf2_n", "=", "min", "(", "xf2_n", ",", "self", ".", "crop_l", ")", "\n", "return", "(", "yf1_n", ",", "yf2_n", ",", "xf1_n", ",", "xf2_n", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor._get_transform_states": [[210, 212], ["x.get_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.get_state"], ["", "def", "_get_transform_states", "(", "self", ")", ":", "\n", "        ", "return", "[", "x", ".", "get_state", "(", ")", "for", "x", "in", "self", ".", "transforms", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor._set_transform_states": [[213, 218], ["zip", "print", "len", "len", "transform.set_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.set_state"], ["", "def", "_set_transform_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "assert", "len", "(", "states", ")", "==", "len", "(", "self", ".", "transforms", ")", "\n", "for", "state", ",", "transform", "in", "zip", "(", "states", ",", "self", ".", "transforms", ")", ":", "\n", "            ", "transform", ".", "set_state", "(", "state", ")", "\n", "", "print", "(", "'_set_transform_states'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.apply_transforms": [[219, 226], ["t.transform"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.transform"], ["", "def", "apply_transforms", "(", "self", ",", "image_nd", ",", "clicks_lists", ")", ":", "\n", "        ", "is_image_changed", "=", "False", "\n", "for", "t", "in", "self", ".", "transforms", ":", "\n", "            ", "image_nd", ",", "clicks_lists", "=", "t", ".", "transform", "(", "image_nd", ",", "clicks_lists", ")", "\n", "is_image_changed", "|=", "t", ".", "image_changed", "\n", "\n", "", "return", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.get_points_nd": [[227, 246], ["max", "max", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "sum", "min", "total_clicks.append", "len", "zip", "len", "len"], "methods", ["None"], ["", "def", "get_points_nd", "(", "self", ",", "clicks_lists", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos_clicks", "=", "[", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "for", "clicks_list", "in", "clicks_lists", "]", "\n", "num_neg_clicks", "=", "[", "len", "(", "clicks_list", ")", "-", "num_pos", "for", "clicks_list", ",", "num_pos", "in", "zip", "(", "clicks_lists", ",", "num_pos_clicks", ")", "]", "\n", "num_max_points", "=", "max", "(", "num_pos_clicks", "+", "num_neg_clicks", ")", "\n", "if", "self", ".", "net_clicks_limit", "is", "not", "None", ":", "\n", "            ", "num_max_points", "=", "min", "(", "self", ".", "net_clicks_limit", ",", "num_max_points", ")", "\n", "", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "\n", "for", "clicks_list", "in", "clicks_lists", ":", "\n", "            ", "clicks_list", "=", "clicks_list", "[", ":", "self", ".", "net_clicks_limit", "]", "\n", "pos_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "click", ".", "is_positive", "]", "\n", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "\n", "neg_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "not", "click", ".", "is_positive", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "\n", "", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.get_points_nd_inbbox": [[247, 266], ["sum", "max", "max", "total_clicks.append", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "len", "map_point_in_bbox", "pos_clicks.append", "neg_clicks.append", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.map_point_in_bbox"], ["", "def", "get_points_nd_inbbox", "(", "self", ",", "clicks_list", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos", "=", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "\n", "num_neg", "=", "len", "(", "clicks_list", ")", "-", "num_pos", "\n", "num_max_points", "=", "max", "(", "num_pos", ",", "num_neg", ")", "\n", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "pos_clicks", ",", "neg_clicks", "=", "[", "]", ",", "[", "]", "\n", "for", "click", "in", "clicks_list", ":", "\n", "            ", "flag", ",", "y", ",", "x", ",", "index", "=", "click", ".", "is_positive", ",", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", ",", "0", "\n", "y", ",", "x", "=", "map_point_in_bbox", "(", "y", ",", "x", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "self", ".", "crop_l", ")", "\n", "if", "flag", ":", "\n", "                ", "pos_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "", "else", ":", "\n", "                ", "neg_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "\n", "", "", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.get_states": [[270, 274], ["base.BasePredictor._get_transform_states", "base.BasePredictor.prev_prediction.clone"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_transform_states"], ["", "def", "get_states", "(", "self", ")", ":", "\n", "        ", "return", "{", "\n", "'transform_states'", ":", "self", ".", "_get_transform_states", "(", ")", ",", "\n", "'prev_prediction'", ":", "self", ".", "prev_prediction", ".", "clone", "(", ")", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.base.BasePredictor.set_states": [[276, 280], ["base.BasePredictor._set_transform_states", "print"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._set_transform_states"], ["", "def", "set_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "self", ".", "_set_transform_states", "(", "states", "[", "'transform_states'", "]", ")", "\n", "self", ".", "prev_prediction", "=", "states", "[", "'prev_prediction'", "]", "\n", "print", "(", "'set'", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_losses.BRSMaskLoss.__init__": [[7, 10], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "eps", "=", "1e-5", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_eps", "=", "eps", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_losses.BRSMaskLoss.forward": [[11, 27], ["torch.sum", "torch.sum", "torch.no_grad", "torch.max().item", "torch.max().item", "torch.sum", "torch.sum", "torch.max", "torch.max", "torch.abs", "torch.abs"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "result", ",", "pos_mask", ",", "neg_mask", ")", ":", "\n", "        ", "pos_diff", "=", "(", "1", "-", "result", ")", "*", "pos_mask", "\n", "pos_target", "=", "torch", ".", "sum", "(", "pos_diff", "**", "2", ")", "\n", "pos_target", "=", "pos_target", "/", "(", "torch", ".", "sum", "(", "pos_mask", ")", "+", "self", ".", "_eps", ")", "\n", "\n", "neg_diff", "=", "result", "*", "neg_mask", "\n", "neg_target", "=", "torch", ".", "sum", "(", "neg_diff", "**", "2", ")", "\n", "neg_target", "=", "neg_target", "/", "(", "torch", ".", "sum", "(", "neg_mask", ")", "+", "self", ".", "_eps", ")", "\n", "\n", "loss", "=", "pos_target", "+", "neg_target", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "f_max_pos", "=", "torch", ".", "max", "(", "torch", ".", "abs", "(", "pos_diff", ")", ")", ".", "item", "(", ")", "\n", "f_max_neg", "=", "torch", ".", "max", "(", "torch", ".", "abs", "(", "neg_diff", ")", ")", ".", "item", "(", ")", "\n", "\n", "", "return", "loss", ",", "f_max_pos", ",", "f_max_neg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_losses.OracleMaskLoss.__init__": [[30, 36], ["super().__init__", "isegm.model.losses.SigmoidBinaryCrossEntropyLoss"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gt_mask", "=", "None", "\n", "self", ".", "loss", "=", "SigmoidBinaryCrossEntropyLoss", "(", "from_sigmoid", "=", "True", ")", "\n", "self", ".", "predictor", "=", "None", "\n", "self", ".", "history", "=", "[", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_losses.OracleMaskLoss.set_gt_mask": [[37, 40], ["None"], "methods", ["None"], ["", "def", "set_gt_mask", "(", "self", ",", "gt_mask", ")", ":", "\n", "        ", "self", ".", "gt_mask", "=", "gt_mask", "\n", "self", ".", "history", "=", "[", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_losses.OracleMaskLoss.forward": [[41, 59], ["brs_losses.OracleMaskLoss.gt_mask.to", "brs_losses.OracleMaskLoss.loss", "brs_losses.OracleMaskLoss.history.append", "torch.nn.functional.interpolate", "torch.flip", "torch.cat", "brs_losses.OracleMaskLoss.detach().cpu().numpy", "len", "abs", "result.size", "brs_losses.OracleMaskLoss.detach().cpu", "brs_losses.OracleMaskLoss.detach"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "result", ",", "pos_mask", ",", "neg_mask", ")", ":", "\n", "        ", "gt_mask", "=", "self", ".", "gt_mask", ".", "to", "(", "result", ".", "device", ")", "\n", "if", "self", ".", "predictor", ".", "object_roi", "is", "not", "None", ":", "\n", "            ", "r1", ",", "r2", ",", "c1", ",", "c2", "=", "self", ".", "predictor", ".", "object_roi", "[", ":", "4", "]", "\n", "gt_mask", "=", "gt_mask", "[", ":", ",", ":", ",", "r1", ":", "r2", "+", "1", ",", "c1", ":", "c2", "+", "1", "]", "\n", "gt_mask", "=", "torch", ".", "nn", ".", "functional", ".", "interpolate", "(", "gt_mask", ",", "result", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "", "if", "result", ".", "shape", "[", "0", "]", "==", "2", ":", "\n", "            ", "gt_mask_flipped", "=", "torch", ".", "flip", "(", "gt_mask", ",", "dims", "=", "[", "3", "]", ")", "\n", "gt_mask", "=", "torch", ".", "cat", "(", "[", "gt_mask", ",", "gt_mask_flipped", "]", ",", "dim", "=", "0", ")", "\n", "\n", "", "loss", "=", "self", ".", "loss", "(", "result", ",", "gt_mask", ")", "\n", "self", ".", "history", ".", "append", "(", "loss", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", "]", ")", "\n", "\n", "if", "len", "(", "self", ".", "history", ")", ">", "5", "and", "abs", "(", "self", ".", "history", "[", "-", "5", "]", "-", "self", ".", "history", "[", "-", "1", "]", ")", "<", "1e-5", ":", "\n", "            ", "return", "0", ",", "0", ",", "0", "\n", "\n", "", "return", "loss", ",", "1.0", ",", "1.0", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor.__init__": [[10, 17], ["base.BasePredictor.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "opt_functor", ",", "optimize_after_n_clicks", "=", "1", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "model", ",", "device", ",", "**", "kwargs", ")", "\n", "self", ".", "optimize_after_n_clicks", "=", "optimize_after_n_clicks", "\n", "self", ".", "opt_functor", "=", "opt_functor", "\n", "\n", "self", ".", "opt_data", "=", "None", "\n", "self", ".", "input_data", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor.set_input_image": [[18, 22], ["super().set_input_image"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.set_input_image"], ["", "def", "set_input_image", "(", "self", ",", "image", ")", ":", "\n", "        ", "super", "(", ")", ".", "set_input_image", "(", "image", ")", "\n", "self", ".", "opt_data", "=", "None", "\n", "self", ".", "input_data", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor._get_clicks_maps_nd": [[23, 44], ["numpy.zeros", "numpy.zeros", "enumerate", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "len", "len", "int", "int", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "round", "round"], "methods", ["None"], ["", "def", "_get_clicks_maps_nd", "(", "self", ",", "clicks_lists", ",", "image_shape", ",", "radius", "=", "1", ")", ":", "\n", "        ", "pos_clicks_map", "=", "np", ".", "zeros", "(", "(", "len", "(", "clicks_lists", ")", ",", "1", ")", "+", "image_shape", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "neg_clicks_map", "=", "np", ".", "zeros", "(", "(", "len", "(", "clicks_lists", ")", ",", "1", ")", "+", "image_shape", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "\n", "for", "list_indx", ",", "clicks_list", "in", "enumerate", "(", "clicks_lists", ")", ":", "\n", "            ", "for", "click", "in", "clicks_list", ":", "\n", "                ", "y", ",", "x", "=", "click", ".", "coords", "\n", "y", ",", "x", "=", "int", "(", "round", "(", "y", ")", ")", ",", "int", "(", "round", "(", "x", ")", ")", "\n", "y1", ",", "x1", "=", "y", "-", "radius", ",", "x", "-", "radius", "\n", "y2", ",", "x2", "=", "y", "+", "radius", "+", "1", ",", "x", "+", "radius", "+", "1", "\n", "\n", "if", "click", ".", "is_positive", ":", "\n", "                    ", "pos_clicks_map", "[", "list_indx", ",", "0", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "=", "True", "\n", "", "else", ":", "\n", "                    ", "neg_clicks_map", "[", "list_indx", ",", "0", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "=", "True", "\n", "\n", "", "", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "pos_clicks_map", "=", "torch", ".", "from_numpy", "(", "pos_clicks_map", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "neg_clicks_map", "=", "torch", ".", "from_numpy", "(", "neg_clicks_map", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "\n", "", "return", "pos_clicks_map", ",", "neg_clicks_map", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor.get_states": [[45, 47], ["brs.BRSBasePredictor._get_transform_states"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_transform_states"], ["", "def", "get_states", "(", "self", ")", ":", "\n", "        ", "return", "{", "'transform_states'", ":", "self", ".", "_get_transform_states", "(", ")", ",", "'opt_data'", ":", "self", ".", "opt_data", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor.set_states": [[48, 51], ["brs.BRSBasePredictor._set_transform_states"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._set_transform_states"], ["", "def", "set_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "self", ".", "_set_transform_states", "(", "states", "[", "'transform_states'", "]", ")", "\n", "self", ".", "opt_data", "=", "states", "[", "'opt_data'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.FeatureBRSPredictor.__init__": [[54, 67], ["brs.BRSBasePredictor.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "opt_functor", ",", "insertion_mode", "=", "'after_deeplab'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "model", ",", "device", ",", "opt_functor", "=", "opt_functor", ",", "**", "kwargs", ")", "\n", "self", ".", "insertion_mode", "=", "insertion_mode", "\n", "self", ".", "_c1_features", "=", "None", "\n", "\n", "if", "self", ".", "insertion_mode", "==", "'after_deeplab'", ":", "\n", "            ", "self", ".", "num_channels", "=", "model", ".", "feature_extractor", ".", "ch", "\n", "", "elif", "self", ".", "insertion_mode", "==", "'after_c4'", ":", "\n", "            ", "self", ".", "num_channels", "=", "model", ".", "feature_extractor", ".", "aspp_in_channels", "\n", "", "elif", "self", ".", "insertion_mode", "==", "'after_aspp'", ":", "\n", "            ", "self", ".", "num_channels", "=", "model", ".", "feature_extractor", ".", "ch", "+", "32", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.FeatureBRSPredictor._get_prediction": [[68, 119], ["brs.FeatureBRSPredictor.get_points_nd", "brs.FeatureBRSPredictor._get_clicks_maps_nd", "len", "brs.FeatureBRSPredictor.opt_functor.init_click", "numpy.zeros", "brs.FeatureBRSPredictor._get_head_input", "scale.repeat.repeat.view", "bias.repeat.repeat.view", "brs.FeatureBRSPredictor.net.head", "torch.interpolate", "torch.interpolate", "scipy.optimize.fmin_l_bfgs_b", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "scale.repeat.repeat.repeat", "bias.repeat.repeat.repeat", "brs.FeatureBRSPredictor.net.feature_extractor.aspp", "torch.interpolate", "torch.interpolate", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "brs.FeatureBRSPredictor.net.feature_extractor.head", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "brs.FeatureBRSPredictor.opt_functor.unpack_opt_params", "brs.FeatureBRSPredictor._get_prediction.get_prediction_logits"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor._get_clicks_maps_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.BaseOptimizer.init_click", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.HRNetFeatureBRSPredictor._get_head_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.ScaleBiasOptimizer.unpack_opt_params"], ["", "", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "pos_mask", ",", "neg_mask", "=", "self", ".", "_get_clicks_maps_nd", "(", "clicks_lists", ",", "image_nd", ".", "shape", "[", "2", ":", "]", ")", "\n", "\n", "num_clicks", "=", "len", "(", "clicks_lists", "[", "0", "]", ")", "\n", "bs", "=", "image_nd", ".", "shape", "[", "0", "]", "//", "2", "if", "self", ".", "with_flip", "else", "image_nd", ".", "shape", "[", "0", "]", "\n", "\n", "if", "self", ".", "opt_data", "is", "None", "or", "self", ".", "opt_data", ".", "shape", "[", "0", "]", "//", "(", "2", "*", "self", ".", "num_channels", ")", "!=", "bs", ":", "\n", "            ", "self", ".", "opt_data", "=", "np", ".", "zeros", "(", "(", "bs", "*", "2", "*", "self", ".", "num_channels", ")", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "\n", "", "if", "num_clicks", "<=", "self", ".", "net_clicks_limit", "or", "is_image_changed", "or", "self", ".", "input_data", "is", "None", ":", "\n", "            ", "self", ".", "input_data", "=", "self", ".", "_get_head_input", "(", "image_nd", ",", "points_nd", ")", "\n", "\n", "", "def", "get_prediction_logits", "(", "scale", ",", "bias", ")", ":", "\n", "            ", "scale", "=", "scale", ".", "view", "(", "bs", ",", "-", "1", ",", "1", ",", "1", ")", "\n", "bias", "=", "bias", ".", "view", "(", "bs", ",", "-", "1", ",", "1", ",", "1", ")", "\n", "if", "self", ".", "with_flip", ":", "\n", "                ", "scale", "=", "scale", ".", "repeat", "(", "2", ",", "1", ",", "1", ",", "1", ")", "\n", "bias", "=", "bias", ".", "repeat", "(", "2", ",", "1", ",", "1", ",", "1", ")", "\n", "\n", "", "scaled_backbone_features", "=", "self", ".", "input_data", "*", "scale", "\n", "scaled_backbone_features", "=", "scaled_backbone_features", "+", "bias", "\n", "if", "self", ".", "insertion_mode", "==", "'after_c4'", ":", "\n", "                ", "x", "=", "self", ".", "net", ".", "feature_extractor", ".", "aspp", "(", "scaled_backbone_features", ")", "\n", "x", "=", "F", ".", "interpolate", "(", "x", ",", "mode", "=", "'bilinear'", ",", "size", "=", "self", ".", "_c1_features", ".", "size", "(", ")", "[", "2", ":", "]", ",", "\n", "align_corners", "=", "True", ")", "\n", "x", "=", "torch", ".", "cat", "(", "(", "x", ",", "self", ".", "_c1_features", ")", ",", "dim", "=", "1", ")", "\n", "scaled_backbone_features", "=", "self", ".", "net", ".", "feature_extractor", ".", "head", "(", "x", ")", "\n", "", "elif", "self", ".", "insertion_mode", "==", "'after_aspp'", ":", "\n", "                ", "scaled_backbone_features", "=", "self", ".", "net", ".", "feature_extractor", ".", "head", "(", "scaled_backbone_features", ")", "\n", "\n", "", "pred_logits", "=", "self", ".", "net", ".", "head", "(", "scaled_backbone_features", ")", "\n", "pred_logits", "=", "F", ".", "interpolate", "(", "pred_logits", ",", "size", "=", "image_nd", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "\n", "align_corners", "=", "True", ")", "\n", "return", "pred_logits", "\n", "\n", "", "self", ".", "opt_functor", ".", "init_click", "(", "get_prediction_logits", ",", "pos_mask", ",", "neg_mask", ",", "self", ".", "device", ")", "\n", "if", "num_clicks", ">", "self", ".", "optimize_after_n_clicks", ":", "\n", "            ", "opt_result", "=", "fmin_l_bfgs_b", "(", "func", "=", "self", ".", "opt_functor", ",", "x0", "=", "self", ".", "opt_data", ",", "\n", "**", "self", ".", "opt_functor", ".", "optimizer_params", ")", "\n", "self", ".", "opt_data", "=", "opt_result", "[", "0", "]", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "if", "self", ".", "opt_functor", ".", "best_prediction", "is", "not", "None", ":", "\n", "                ", "opt_pred_logits", "=", "self", ".", "opt_functor", ".", "best_prediction", "\n", "", "else", ":", "\n", "                ", "opt_data_nd", "=", "torch", ".", "from_numpy", "(", "self", ".", "opt_data", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "opt_vars", ",", "_", "=", "self", ".", "opt_functor", ".", "unpack_opt_params", "(", "opt_data_nd", ")", "\n", "opt_pred_logits", "=", "get_prediction_logits", "(", "*", "opt_vars", ")", "\n", "\n", "", "", "return", "opt_pred_logits", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.FeatureBRSPredictor._get_head_input": [[120, 148], ["torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "brs.FeatureBRSPredictor.net.prepare_input", "brs.FeatureBRSPredictor.net.get_coord_features", "brs.FeatureBRSPredictor.net.rgb_conv", "hasattr", "brs.FeatureBRSPredictor.net.feature_extractor.backbone", "brs.FeatureBRSPredictor.net.feature_extractor.skip_project", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "brs.FeatureBRSPredictor.net.maps_transform", "brs.FeatureBRSPredictor.net.feature_extractor.aspp", "torch.interpolate", "torch.interpolate", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "brs.FeatureBRSPredictor.net.feature_extractor", "brs.FeatureBRSPredictor.size"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features"], ["", "def", "_get_head_input", "(", "self", ",", "image_nd", ",", "points", ")", ":", "\n", "        ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "image_nd", ",", "prev_mask", "=", "self", ".", "net", ".", "prepare_input", "(", "image_nd", ")", "\n", "coord_features", "=", "self", ".", "net", ".", "get_coord_features", "(", "image_nd", ",", "prev_mask", ",", "points", ")", "\n", "\n", "if", "self", ".", "net", ".", "rgb_conv", "is", "not", "None", ":", "\n", "                ", "x", "=", "self", ".", "net", ".", "rgb_conv", "(", "torch", ".", "cat", "(", "(", "image_nd", ",", "coord_features", ")", ",", "dim", "=", "1", ")", ")", "\n", "additional_features", "=", "None", "\n", "", "elif", "hasattr", "(", "self", ".", "net", ",", "'maps_transform'", ")", ":", "\n", "                ", "x", "=", "image_nd", "\n", "additional_features", "=", "self", ".", "net", ".", "maps_transform", "(", "coord_features", ")", "\n", "\n", "", "if", "self", ".", "insertion_mode", "==", "'after_c4'", "or", "self", ".", "insertion_mode", "==", "'after_aspp'", ":", "\n", "                ", "c1", ",", "_", ",", "c3", ",", "c4", "=", "self", ".", "net", ".", "feature_extractor", ".", "backbone", "(", "x", ",", "additional_features", ")", "\n", "c1", "=", "self", ".", "net", ".", "feature_extractor", ".", "skip_project", "(", "c1", ")", "\n", "\n", "if", "self", ".", "insertion_mode", "==", "'after_aspp'", ":", "\n", "                    ", "x", "=", "self", ".", "net", ".", "feature_extractor", ".", "aspp", "(", "c4", ")", "\n", "x", "=", "F", ".", "interpolate", "(", "x", ",", "size", "=", "c1", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "x", "=", "torch", ".", "cat", "(", "(", "x", ",", "c1", ")", ",", "dim", "=", "1", ")", "\n", "backbone_features", "=", "x", "\n", "", "else", ":", "\n", "                    ", "backbone_features", "=", "c4", "\n", "self", ".", "_c1_features", "=", "c1", "\n", "", "", "else", ":", "\n", "                ", "backbone_features", "=", "self", ".", "net", ".", "feature_extractor", "(", "x", ",", "additional_features", ")", "[", "0", "]", "\n", "\n", "", "", "return", "backbone_features", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.HRNetFeatureBRSPredictor.__init__": [[151, 162], ["brs.BRSBasePredictor.__init__", "sum"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "opt_functor", ",", "insertion_mode", "=", "'A'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "model", ",", "device", ",", "opt_functor", "=", "opt_functor", ",", "**", "kwargs", ")", "\n", "self", ".", "insertion_mode", "=", "insertion_mode", "\n", "self", ".", "_c1_features", "=", "None", "\n", "\n", "if", "self", ".", "insertion_mode", "==", "'A'", ":", "\n", "            ", "self", ".", "num_channels", "=", "sum", "(", "k", "*", "model", ".", "feature_extractor", ".", "width", "for", "k", "in", "[", "1", ",", "2", ",", "4", ",", "8", "]", ")", "\n", "", "elif", "self", ".", "insertion_mode", "==", "'C'", ":", "\n", "            ", "self", ".", "num_channels", "=", "2", "*", "model", ".", "feature_extractor", ".", "ocr_width", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.HRNetFeatureBRSPredictor._get_prediction": [[163, 218], ["brs.HRNetFeatureBRSPredictor.get_points_nd", "brs.HRNetFeatureBRSPredictor._get_clicks_maps_nd", "len", "brs.HRNetFeatureBRSPredictor.opt_functor.init_click", "numpy.zeros", "brs.HRNetFeatureBRSPredictor._get_head_input", "scale.repeat.repeat.view", "bias.repeat.repeat.view", "torch.interpolate", "torch.interpolate", "scipy.optimize.fmin_l_bfgs_b", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "scale.repeat.repeat.repeat", "bias.repeat.repeat.repeat", "brs.HRNetFeatureBRSPredictor.net.feature_extractor.cls_head", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "torch.from_numpy().to", "brs.HRNetFeatureBRSPredictor.opt_functor.unpack_opt_params", "brs.HRNetFeatureBRSPredictor._get_prediction.get_prediction_logits"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor._get_clicks_maps_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.BaseOptimizer.init_click", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.HRNetFeatureBRSPredictor._get_head_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.ScaleBiasOptimizer.unpack_opt_params"], ["", "", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "pos_mask", ",", "neg_mask", "=", "self", ".", "_get_clicks_maps_nd", "(", "clicks_lists", ",", "image_nd", ".", "shape", "[", "2", ":", "]", ")", "\n", "num_clicks", "=", "len", "(", "clicks_lists", "[", "0", "]", ")", "\n", "bs", "=", "image_nd", ".", "shape", "[", "0", "]", "//", "2", "if", "self", ".", "with_flip", "else", "image_nd", ".", "shape", "[", "0", "]", "\n", "\n", "if", "self", ".", "opt_data", "is", "None", "or", "self", ".", "opt_data", ".", "shape", "[", "0", "]", "//", "(", "2", "*", "self", ".", "num_channels", ")", "!=", "bs", ":", "\n", "            ", "self", ".", "opt_data", "=", "np", ".", "zeros", "(", "(", "bs", "*", "2", "*", "self", ".", "num_channels", ")", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "\n", "", "if", "num_clicks", "<=", "self", ".", "net_clicks_limit", "or", "is_image_changed", "or", "self", ".", "input_data", "is", "None", ":", "\n", "            ", "self", ".", "input_data", "=", "self", ".", "_get_head_input", "(", "image_nd", ",", "points_nd", ")", "\n", "\n", "", "def", "get_prediction_logits", "(", "scale", ",", "bias", ")", ":", "\n", "            ", "scale", "=", "scale", ".", "view", "(", "bs", ",", "-", "1", ",", "1", ",", "1", ")", "\n", "bias", "=", "bias", ".", "view", "(", "bs", ",", "-", "1", ",", "1", ",", "1", ")", "\n", "if", "self", ".", "with_flip", ":", "\n", "                ", "scale", "=", "scale", ".", "repeat", "(", "2", ",", "1", ",", "1", ",", "1", ")", "\n", "bias", "=", "bias", ".", "repeat", "(", "2", ",", "1", ",", "1", ",", "1", ")", "\n", "\n", "", "scaled_backbone_features", "=", "self", ".", "input_data", "*", "scale", "\n", "scaled_backbone_features", "=", "scaled_backbone_features", "+", "bias", "\n", "if", "self", ".", "insertion_mode", "==", "'A'", ":", "\n", "                ", "if", "self", ".", "net", ".", "feature_extractor", ".", "ocr_width", ">", "0", ":", "\n", "                    ", "out_aux", "=", "self", ".", "net", ".", "feature_extractor", ".", "aux_head", "(", "scaled_backbone_features", ")", "\n", "feats", "=", "self", ".", "net", ".", "feature_extractor", ".", "conv3x3_ocr", "(", "scaled_backbone_features", ")", "\n", "\n", "context", "=", "self", ".", "net", ".", "feature_extractor", ".", "ocr_gather_head", "(", "feats", ",", "out_aux", ")", "\n", "feats", "=", "self", ".", "net", ".", "feature_extractor", ".", "ocr_distri_head", "(", "feats", ",", "context", ")", "\n", "", "else", ":", "\n", "                    ", "feats", "=", "scaled_backbone_features", "\n", "", "pred_logits", "=", "self", ".", "net", ".", "feature_extractor", ".", "cls_head", "(", "feats", ")", "\n", "", "elif", "self", ".", "insertion_mode", "==", "'C'", ":", "\n", "                ", "pred_logits", "=", "self", ".", "net", ".", "feature_extractor", ".", "cls_head", "(", "scaled_backbone_features", ")", "\n", "", "else", ":", "\n", "                ", "raise", "NotImplementedError", "\n", "\n", "", "pred_logits", "=", "F", ".", "interpolate", "(", "pred_logits", ",", "size", "=", "image_nd", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "\n", "align_corners", "=", "True", ")", "\n", "return", "pred_logits", "\n", "\n", "", "self", ".", "opt_functor", ".", "init_click", "(", "get_prediction_logits", ",", "pos_mask", ",", "neg_mask", ",", "self", ".", "device", ")", "\n", "if", "num_clicks", ">", "self", ".", "optimize_after_n_clicks", ":", "\n", "            ", "opt_result", "=", "fmin_l_bfgs_b", "(", "func", "=", "self", ".", "opt_functor", ",", "x0", "=", "self", ".", "opt_data", ",", "\n", "**", "self", ".", "opt_functor", ".", "optimizer_params", ")", "\n", "self", ".", "opt_data", "=", "opt_result", "[", "0", "]", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "if", "self", ".", "opt_functor", ".", "best_prediction", "is", "not", "None", ":", "\n", "                ", "opt_pred_logits", "=", "self", ".", "opt_functor", ".", "best_prediction", "\n", "", "else", ":", "\n", "                ", "opt_data_nd", "=", "torch", ".", "from_numpy", "(", "self", ".", "opt_data", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "opt_vars", ",", "_", "=", "self", ".", "opt_functor", ".", "unpack_opt_params", "(", "opt_data_nd", ")", "\n", "opt_pred_logits", "=", "get_prediction_logits", "(", "*", "opt_vars", ")", "\n", "\n", "", "", "return", "opt_pred_logits", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.HRNetFeatureBRSPredictor._get_head_input": [[219, 245], ["torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "brs.HRNetFeatureBRSPredictor.net.prepare_input", "brs.HRNetFeatureBRSPredictor.net.get_coord_features", "brs.HRNetFeatureBRSPredictor.net.feature_extractor.compute_hrnet_feats", "brs.HRNetFeatureBRSPredictor.net.rgb_conv", "hasattr", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "brs.HRNetFeatureBRSPredictor.net.maps_transform", "brs.HRNetFeatureBRSPredictor.net.feature_extractor.aux_head", "brs.HRNetFeatureBRSPredictor.net.feature_extractor.conv3x3_ocr", "brs.HRNetFeatureBRSPredictor.net.feature_extractor.ocr_gather_head", "brs.HRNetFeatureBRSPredictor.net.feature_extractor.ocr_distri_head"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.modeling.hrnet_ocr.HighResolutionNet.compute_hrnet_feats"], ["", "def", "_get_head_input", "(", "self", ",", "image_nd", ",", "points", ")", ":", "\n", "        ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "image_nd", ",", "prev_mask", "=", "self", ".", "net", ".", "prepare_input", "(", "image_nd", ")", "\n", "coord_features", "=", "self", ".", "net", ".", "get_coord_features", "(", "image_nd", ",", "prev_mask", ",", "points", ")", "\n", "\n", "if", "self", ".", "net", ".", "rgb_conv", "is", "not", "None", ":", "\n", "                ", "x", "=", "self", ".", "net", ".", "rgb_conv", "(", "torch", ".", "cat", "(", "(", "image_nd", ",", "coord_features", ")", ",", "dim", "=", "1", ")", ")", "\n", "additional_features", "=", "None", "\n", "", "elif", "hasattr", "(", "self", ".", "net", ",", "'maps_transform'", ")", ":", "\n", "                ", "x", "=", "image_nd", "\n", "additional_features", "=", "self", ".", "net", ".", "maps_transform", "(", "coord_features", ")", "\n", "\n", "", "feats", "=", "self", ".", "net", ".", "feature_extractor", ".", "compute_hrnet_feats", "(", "x", ",", "additional_features", ")", "\n", "\n", "if", "self", ".", "insertion_mode", "==", "'A'", ":", "\n", "                ", "backbone_features", "=", "feats", "\n", "", "elif", "self", ".", "insertion_mode", "==", "'C'", ":", "\n", "                ", "out_aux", "=", "self", ".", "net", ".", "feature_extractor", ".", "aux_head", "(", "feats", ")", "\n", "feats", "=", "self", ".", "net", ".", "feature_extractor", ".", "conv3x3_ocr", "(", "feats", ")", "\n", "\n", "context", "=", "self", ".", "net", ".", "feature_extractor", ".", "ocr_gather_head", "(", "feats", ",", "out_aux", ")", "\n", "backbone_features", "=", "self", ".", "net", ".", "feature_extractor", ".", "ocr_distri_head", "(", "feats", ",", "context", ")", "\n", "", "else", ":", "\n", "                ", "raise", "NotImplementedError", "\n", "\n", "", "", "return", "backbone_features", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.InputBRSPredictor.__init__": [[248, 251], ["brs.BRSBasePredictor.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "opt_functor", ",", "optimize_target", "=", "'rgb'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "model", ",", "device", ",", "opt_functor", "=", "opt_functor", ",", "**", "kwargs", ")", "\n", "self", ".", "optimize_target", "=", "optimize_target", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.InputBRSPredictor._get_prediction": [[252, 308], ["brs.InputBRSPredictor.get_points_nd", "brs.InputBRSPredictor._get_clicks_maps_nd", "len", "brs.InputBRSPredictor.opt_functor.init_click", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "brs.InputBRSPredictor.net.prepare_input", "brs.InputBRSPredictor.net.get_coord_features", "torch.interpolate", "torch.interpolate", "scipy.optimize.fmin_l_bfgs_b", "torch.from_numpy().view().to", "torch.from_numpy().view().to", "torch.from_numpy().view().to", "torch.from_numpy().view().to", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "brs.InputBRSPredictor.net.rgb_conv", "hasattr", "brs.InputBRSPredictor.net.backbone_forward", "brs.InputBRSPredictor.opt_functor.unpack_opt_params", "brs.InputBRSPredictor._get_prediction.get_prediction_logits"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs.BRSBasePredictor._get_clicks_maps_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.BaseOptimizer.init_click", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.get_coord_features", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_strong_baseline.BaselineModel.backbone_forward", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.ScaleBiasOptimizer.unpack_opt_params"], ["", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "pos_mask", ",", "neg_mask", "=", "self", ".", "_get_clicks_maps_nd", "(", "clicks_lists", ",", "image_nd", ".", "shape", "[", "2", ":", "]", ")", "\n", "num_clicks", "=", "len", "(", "clicks_lists", "[", "0", "]", ")", "\n", "\n", "if", "self", ".", "opt_data", "is", "None", "or", "is_image_changed", ":", "\n", "            ", "if", "self", ".", "optimize_target", "==", "'dmaps'", ":", "\n", "                ", "opt_channels", "=", "self", ".", "net", ".", "coord_feature_ch", "-", "1", "if", "self", ".", "net", ".", "with_prev_mask", "else", "self", ".", "net", ".", "coord_feature_ch", "\n", "", "else", ":", "\n", "                ", "opt_channels", "=", "3", "\n", "", "bs", "=", "image_nd", ".", "shape", "[", "0", "]", "//", "2", "if", "self", ".", "with_flip", "else", "image_nd", ".", "shape", "[", "0", "]", "\n", "self", ".", "opt_data", "=", "torch", ".", "zeros", "(", "(", "bs", ",", "opt_channels", ",", "image_nd", ".", "shape", "[", "2", "]", ",", "image_nd", ".", "shape", "[", "3", "]", ")", ",", "\n", "device", "=", "self", ".", "device", ",", "dtype", "=", "torch", ".", "float32", ")", "\n", "\n", "", "def", "get_prediction_logits", "(", "opt_bias", ")", ":", "\n", "            ", "input_image", ",", "prev_mask", "=", "self", ".", "net", ".", "prepare_input", "(", "image_nd", ")", "\n", "dmaps", "=", "self", ".", "net", ".", "get_coord_features", "(", "input_image", ",", "prev_mask", ",", "points_nd", ")", "\n", "\n", "if", "self", ".", "optimize_target", "==", "'rgb'", ":", "\n", "                ", "input_image", "=", "input_image", "+", "opt_bias", "\n", "", "elif", "self", ".", "optimize_target", "==", "'dmaps'", ":", "\n", "                ", "if", "self", ".", "net", ".", "with_prev_mask", ":", "\n", "                    ", "dmaps", "[", ":", ",", "1", ":", ",", ":", ",", ":", "]", "=", "dmaps", "[", ":", ",", "1", ":", ",", ":", ",", ":", "]", "+", "opt_bias", "\n", "", "else", ":", "\n", "                    ", "dmaps", "=", "dmaps", "+", "opt_bias", "\n", "\n", "", "", "if", "self", ".", "net", ".", "rgb_conv", "is", "not", "None", ":", "\n", "                ", "x", "=", "self", ".", "net", ".", "rgb_conv", "(", "torch", ".", "cat", "(", "(", "input_image", ",", "dmaps", ")", ",", "dim", "=", "1", ")", ")", "\n", "if", "self", ".", "optimize_target", "==", "'all'", ":", "\n", "                    ", "x", "=", "x", "+", "opt_bias", "\n", "", "coord_features", "=", "None", "\n", "", "elif", "hasattr", "(", "self", ".", "net", ",", "'maps_transform'", ")", ":", "\n", "                ", "x", "=", "input_image", "\n", "coord_features", "=", "self", ".", "net", ".", "maps_transform", "(", "dmaps", ")", "\n", "\n", "", "pred_logits", "=", "self", ".", "net", ".", "backbone_forward", "(", "x", ",", "coord_features", "=", "coord_features", ")", "[", "'instances'", "]", "\n", "pred_logits", "=", "F", ".", "interpolate", "(", "pred_logits", ",", "size", "=", "image_nd", ".", "size", "(", ")", "[", "2", ":", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "return", "pred_logits", "\n", "\n", "", "self", ".", "opt_functor", ".", "init_click", "(", "get_prediction_logits", ",", "pos_mask", ",", "neg_mask", ",", "self", ".", "device", ",", "\n", "shape", "=", "self", ".", "opt_data", ".", "shape", ")", "\n", "if", "num_clicks", ">", "self", ".", "optimize_after_n_clicks", ":", "\n", "            ", "opt_result", "=", "fmin_l_bfgs_b", "(", "func", "=", "self", ".", "opt_functor", ",", "x0", "=", "self", ".", "opt_data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "ravel", "(", ")", ",", "\n", "**", "self", ".", "opt_functor", ".", "optimizer_params", ")", "\n", "\n", "self", ".", "opt_data", "=", "torch", ".", "from_numpy", "(", "opt_result", "[", "0", "]", ")", ".", "view", "(", "self", ".", "opt_data", ".", "shape", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "if", "self", ".", "opt_functor", ".", "best_prediction", "is", "not", "None", ":", "\n", "                ", "opt_pred_logits", "=", "self", ".", "opt_functor", ".", "best_prediction", "\n", "", "else", ":", "\n", "                ", "opt_vars", ",", "_", "=", "self", ".", "opt_functor", ".", "unpack_opt_params", "(", "self", ".", "opt_data", ")", "\n", "opt_pred_logits", "=", "get_prediction_logits", "(", "*", "opt_vars", ")", "\n", "\n", "", "", "return", "opt_pred_logits", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.__init__": [[8, 43], ["isinstance", "torchvision.transforms.ToTensor", "cdnet.DiffisionPredictor.transforms.append", "cdnet.DiffisionPredictor.transforms.append", "cdnet.DiffisionPredictor.transforms.append", "isegm.inference.transforms.ResizeTrans", "isegm.inference.transforms.SigmoidForPred", "cdnet.DiffisionPredictor.transforms.append", "isegm.inference.transforms.LimitLongestSide", "isegm.inference.transforms.AddHorizontalFlip"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "\n", "net_clicks_limit", "=", "None", ",", "\n", "with_flip", "=", "False", ",", "\n", "zoom_in", "=", "None", ",", "\n", "max_size", "=", "None", ",", "\n", "infer_size", "=", "384", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "with_flip", "=", "with_flip", "\n", "self", ".", "net_clicks_limit", "=", "net_clicks_limit", "\n", "self", ".", "original_image", "=", "None", "\n", "self", ".", "device", "=", "device", "\n", "self", ".", "zoom_in", "=", "zoom_in", "\n", "self", ".", "prev_prediction", "=", "None", "\n", "self", ".", "model_indx", "=", "0", "\n", "self", ".", "click_models", "=", "None", "\n", "self", ".", "net_state_dict", "=", "None", "\n", "\n", "if", "isinstance", "(", "model", ",", "tuple", ")", ":", "\n", "            ", "self", ".", "net", ",", "self", ".", "click_models", "=", "model", "\n", "", "else", ":", "\n", "            ", "self", ".", "net", "=", "model", "\n", "\n", "", "self", ".", "to_tensor", "=", "transforms", ".", "ToTensor", "(", ")", "\n", "\n", "self", ".", "transforms", "=", "[", "zoom_in", "]", "if", "zoom_in", "is", "not", "None", "else", "[", "]", "\n", "if", "max_size", "is", "not", "None", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "LimitLongestSide", "(", "max_size", "=", "max_size", ")", ")", "\n", "", "self", ".", "crop_l", "=", "infer_size", "\n", "self", ".", "transforms", ".", "append", "(", "ResizeTrans", "(", "384", ")", ")", "\n", "self", ".", "transforms", ".", "append", "(", "SigmoidForPred", "(", ")", ")", "\n", "self", ".", "focus_roi", "=", "None", "\n", "self", ".", "global_roi", "=", "None", "\n", "self", ".", "with_flip", "=", "True", "\n", "if", "self", ".", "with_flip", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "AddHorizontalFlip", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.set_input_image": [[45, 53], ["cdnet.DiffisionPredictor.to_tensor", "cdnet.DiffisionPredictor.to", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "transform.reset", "len", "cdnet.DiffisionPredictor.original_image.unsqueeze"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.reset"], ["", "", "def", "set_input_image", "(", "self", ",", "image", ")", ":", "\n", "        ", "image_nd", "=", "self", ".", "to_tensor", "(", "image", ")", "\n", "for", "transform", "in", "self", ".", "transforms", ":", "\n", "            ", "transform", ".", "reset", "(", ")", "\n", "", "self", ".", "original_image", "=", "image_nd", ".", "to", "(", "self", ".", "device", ")", "\n", "if", "len", "(", "self", ".", "original_image", ".", "shape", ")", "==", "3", ":", "\n", "            ", "self", ".", "original_image", "=", "self", ".", "original_image", ".", "unsqueeze", "(", "0", ")", "\n", "", "self", ".", "prev_prediction", "=", "torch", ".", "zeros_like", "(", "self", ".", "original_image", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.set_prev_mask": [[54, 56], ["torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["None"], ["", "def", "set_prev_mask", "(", "self", ",", "mask", ")", ":", "\n", "        ", "self", ".", "prev_prediction", "=", "torch", ".", "from_numpy", "(", "mask", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "to", "(", "self", ".", "device", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.get_prediction": [[57, 92], ["clicker.get_clicks", "cdnet.DiffisionPredictor.apply_transforms", "cdnet.DiffisionPredictor._get_prediction", "reversed", "hasattr", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "t.inv_transform.cpu().numpy", "min", "isinstance", "t.inv_transform", "len", "t.inv_transform.cpu", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.apply_transforms", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_prediction", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.inv_transform"], ["", "def", "get_prediction", "(", "self", ",", "clicker", ",", "prev_mask", "=", "None", ")", ":", "\n", "        ", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "click", "=", "clicks_list", "[", "-", "1", "]", "\n", "last_y", ",", "last_x", "=", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", "\n", "self", ".", "last_y", "=", "last_y", "\n", "self", ".", "last_x", "=", "last_x", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "model_indx", "=", "min", "(", "clicker", ".", "click_indx_offset", "+", "len", "(", "clicks_list", ")", ",", "len", "(", "self", ".", "click_models", ")", ")", "-", "1", "\n", "if", "model_indx", "!=", "self", ".", "model_indx", ":", "\n", "                ", "self", ".", "model_indx", "=", "model_indx", "\n", "self", ".", "net", "=", "self", ".", "click_models", "[", "model_indx", "]", "\n", "\n", "", "", "input_image", "=", "self", ".", "original_image", "\n", "if", "prev_mask", "is", "None", ":", "\n", "            ", "prev_mask", "=", "self", ".", "prev_prediction", "\n", "", "if", "hasattr", "(", "self", ".", "net", ",", "'with_prev_mask'", ")", "and", "self", ".", "net", ".", "with_prev_mask", ":", "\n", "            ", "input_image", "=", "torch", ".", "cat", "(", "(", "input_image", ",", "prev_mask", ")", ",", "dim", "=", "1", ")", "\n", "\n", "\n", "", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "=", "self", ".", "apply_transforms", "(", "\n", "input_image", ",", "[", "clicks_list", "]", "\n", ")", "\n", "\n", "\n", "prediction", "=", "self", ".", "_get_prediction", "(", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", "\n", "\n", "#print(1,prediction.max(), prediction.min()) #\u8fd9\u91cc\u53d8\u6210binary\u4e86", "\n", "for", "t", "in", "reversed", "(", "self", ".", "transforms", ")", ":", "\n", "            ", "if", "not", "isinstance", "(", "t", ",", "AddHorizontalFlip", ")", ":", "\n", "                ", "prediction", "=", "t", ".", "inv_transform", "(", "prediction", ")", "\n", "#print(2,prediction.max(), prediction.min())", "\n", "", "", "prediction", "=", "prediction", ">", "0.5", "\n", "#self.prev_prediction = prediction", "\n", "return", "prediction", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor._get_prediction": [[94, 108], ["cdnet.DiffisionPredictor.get_points_nd", "cdnet.DiffisionPredictor.net", "cdnet.DiffisionPredictor.net.PixelDiffusion", "torch.flip", "torch.flip", "torch.flip", "torch.flip"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_deeplab_model.DeeplabModel.PixelDiffusion"], ["", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "output", "=", "self", ".", "net", "(", "image_nd", ",", "points_nd", ")", "\n", "click_map", "=", "output", "[", "'click_map'", "]", "\n", "mask", "=", "output", "[", "'instances'", "]", "\n", "\n", "if", "mask", ".", "shape", "[", "0", "]", "==", "2", ":", "\n", "            ", "mask", ",", "mask_f", "=", "mask", "[", ":", "1", "]", ",", "mask", "[", "1", ":", "]", "\n", "mask", "=", "0.5", "*", "(", "mask", "+", "torch", ".", "flip", "(", "mask_f", ",", "dims", "=", "[", "3", "]", ")", ")", "\n", "image_nd", "=", "image_nd", "[", ":", "1", "]", "\n", "click_map", "=", "click_map", "[", ":", "1", "]", "\n", "\n", "", "prediction", "=", "self", ".", "net", ".", "PixelDiffusion", "(", "image_nd", ",", "mask", ",", "click_map", ")", "\n", "return", "prediction", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor._get_transform_states": [[110, 112], ["x.get_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.get_state"], ["", "def", "_get_transform_states", "(", "self", ")", ":", "\n", "        ", "return", "[", "x", ".", "get_state", "(", ")", "for", "x", "in", "self", ".", "transforms", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor._set_transform_states": [[113, 118], ["zip", "print", "len", "len", "transform.set_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.set_state"], ["", "def", "_set_transform_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "assert", "len", "(", "states", ")", "==", "len", "(", "self", ".", "transforms", ")", "\n", "for", "state", ",", "transform", "in", "zip", "(", "states", ",", "self", ".", "transforms", ")", ":", "\n", "            ", "transform", ".", "set_state", "(", "state", ")", "\n", "", "print", "(", "'_set_transform_states'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.apply_transforms": [[119, 126], ["t.transform"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.transform"], ["", "def", "apply_transforms", "(", "self", ",", "image_nd", ",", "clicks_lists", ")", ":", "\n", "        ", "is_image_changed", "=", "False", "\n", "for", "t", "in", "self", ".", "transforms", ":", "\n", "            ", "image_nd", ",", "clicks_lists", "=", "t", ".", "transform", "(", "image_nd", ",", "clicks_lists", ")", "\n", "is_image_changed", "|=", "t", ".", "image_changed", "\n", "\n", "", "return", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.get_points_nd": [[127, 146], ["max", "max", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "sum", "min", "total_clicks.append", "len", "zip", "len", "len"], "methods", ["None"], ["", "def", "get_points_nd", "(", "self", ",", "clicks_lists", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos_clicks", "=", "[", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "for", "clicks_list", "in", "clicks_lists", "]", "\n", "num_neg_clicks", "=", "[", "len", "(", "clicks_list", ")", "-", "num_pos", "for", "clicks_list", ",", "num_pos", "in", "zip", "(", "clicks_lists", ",", "num_pos_clicks", ")", "]", "\n", "num_max_points", "=", "max", "(", "num_pos_clicks", "+", "num_neg_clicks", ")", "\n", "if", "self", ".", "net_clicks_limit", "is", "not", "None", ":", "\n", "            ", "num_max_points", "=", "min", "(", "self", ".", "net_clicks_limit", ",", "num_max_points", ")", "\n", "", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "\n", "for", "clicks_list", "in", "clicks_lists", ":", "\n", "            ", "clicks_list", "=", "clicks_list", "[", ":", "self", ".", "net_clicks_limit", "]", "\n", "pos_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "click", ".", "is_positive", "]", "\n", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "\n", "neg_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "not", "click", ".", "is_positive", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "\n", "", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.get_points_nd_inbbox": [[147, 166], ["sum", "max", "max", "total_clicks.append", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "len", "map_point_in_bbox", "pos_clicks.append", "neg_clicks.append", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.map_point_in_bbox"], ["", "def", "get_points_nd_inbbox", "(", "self", ",", "clicks_list", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos", "=", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "\n", "num_neg", "=", "len", "(", "clicks_list", ")", "-", "num_pos", "\n", "num_max_points", "=", "max", "(", "num_pos", ",", "num_neg", ")", "\n", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "pos_clicks", ",", "neg_clicks", "=", "[", "]", ",", "[", "]", "\n", "for", "click", "in", "clicks_list", ":", "\n", "            ", "flag", ",", "y", ",", "x", ",", "index", "=", "click", ".", "is_positive", ",", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", ",", "0", "\n", "y", ",", "x", "=", "map_point_in_bbox", "(", "y", ",", "x", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "self", ".", "crop_l", ")", "\n", "if", "flag", ":", "\n", "                ", "pos_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "", "else", ":", "\n", "                ", "neg_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "\n", "", "", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.get_states": [[170, 174], ["cdnet.DiffisionPredictor._get_transform_states", "cdnet.DiffisionPredictor.prev_prediction.clone"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_transform_states"], ["", "def", "get_states", "(", "self", ")", ":", "\n", "        ", "return", "{", "\n", "'transform_states'", ":", "self", ".", "_get_transform_states", "(", ")", ",", "\n", "'prev_prediction'", ":", "self", ".", "prev_prediction", ".", "clone", "(", ")", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.cdnet.DiffisionPredictor.set_states": [[176, 180], ["cdnet.DiffisionPredictor._set_transform_states", "print"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._set_transform_states"], ["", "def", "set_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "self", ".", "_set_transform_states", "(", "states", "[", "'transform_states'", "]", ")", "\n", "self", ".", "prev_prediction", "=", "states", "[", "'prev_prediction'", "]", "\n", "print", "(", "'set'", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.__init__": [[9, 46], ["isinstance", "torchvision.transforms.ToTensor", "focalclick.FocalPredictor.transforms.append", "focalclick.FocalPredictor.transforms.append", "focalclick.FocalPredictor.transforms.append", "isegm.inference.transforms.ResizeTrans", "isegm.inference.transforms.SigmoidForPred", "focalclick.FocalPredictor.transforms.append", "isegm.inference.transforms.LimitLongestSide", "isegm.inference.transforms.AddHorizontalFlip"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "\n", "net_clicks_limit", "=", "None", ",", "\n", "with_flip", "=", "False", ",", "\n", "zoom_in", "=", "None", ",", "\n", "max_size", "=", "None", ",", "\n", "infer_size", "=", "256", ",", "\n", "focus_crop_r", "=", "1.4", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "with_flip", "=", "with_flip", "\n", "self", ".", "net_clicks_limit", "=", "net_clicks_limit", "\n", "self", ".", "original_image", "=", "None", "\n", "self", ".", "device", "=", "device", "\n", "self", ".", "zoom_in", "=", "zoom_in", "\n", "self", ".", "prev_prediction", "=", "None", "\n", "self", ".", "model_indx", "=", "0", "\n", "self", ".", "click_models", "=", "None", "\n", "self", ".", "net_state_dict", "=", "None", "\n", "\n", "if", "isinstance", "(", "model", ",", "tuple", ")", ":", "\n", "            ", "self", ".", "net", ",", "self", ".", "click_models", "=", "model", "\n", "", "else", ":", "\n", "            ", "self", ".", "net", "=", "model", "\n", "\n", "", "self", ".", "to_tensor", "=", "transforms", ".", "ToTensor", "(", ")", "\n", "\n", "self", ".", "transforms", "=", "[", "zoom_in", "]", "if", "zoom_in", "is", "not", "None", "else", "[", "]", "\n", "if", "max_size", "is", "not", "None", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "LimitLongestSide", "(", "max_size", "=", "max_size", ")", ")", "\n", "", "self", ".", "crop_l", "=", "infer_size", "\n", "self", ".", "focus_crop_r", "=", "focus_crop_r", "\n", "self", ".", "transforms", ".", "append", "(", "ResizeTrans", "(", "self", ".", "crop_l", ")", ")", "\n", "self", ".", "transforms", ".", "append", "(", "SigmoidForPred", "(", ")", ")", "\n", "self", ".", "focus_roi", "=", "None", "\n", "self", ".", "global_roi", "=", "None", "\n", "\n", "if", "self", ".", "with_flip", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "AddHorizontalFlip", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.set_input_image": [[47, 55], ["focalclick.FocalPredictor.to_tensor", "focalclick.FocalPredictor.to", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "transform.reset", "len", "focalclick.FocalPredictor.original_image.unsqueeze"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.reset"], ["", "", "def", "set_input_image", "(", "self", ",", "image", ")", ":", "\n", "        ", "image_nd", "=", "self", ".", "to_tensor", "(", "image", ")", "\n", "for", "transform", "in", "self", ".", "transforms", ":", "\n", "            ", "transform", ".", "reset", "(", ")", "\n", "", "self", ".", "original_image", "=", "image_nd", ".", "to", "(", "self", ".", "device", ")", "\n", "if", "len", "(", "self", ".", "original_image", ".", "shape", ")", "==", "3", ":", "\n", "            ", "self", ".", "original_image", "=", "self", ".", "original_image", ".", "unsqueeze", "(", "0", ")", "\n", "", "self", ".", "prev_prediction", "=", "torch", ".", "zeros_like", "(", "self", ".", "original_image", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.set_prev_mask": [[56, 58], ["torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["None"], ["", "def", "set_prev_mask", "(", "self", ",", "mask", ")", ":", "\n", "        ", "self", ".", "prev_prediction", "=", "torch", ".", "from_numpy", "(", "mask", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "to", "(", "self", ".", "device", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.get_prediction": [[59, 135], ["clicker.get_clicks", "focalclick.FocalPredictor.apply_transforms", "focalclick.FocalPredictor._get_prediction", "torch.interpolate", "torch.interpolate", "reversed", "torch.log", "torch.log", "torch.log", "torch.log", "clicker.get_clicks", "isegm.utils.crop_local.get_focus_cropv1", "focalclick.FocalPredictor.mapp_roi", "focalclick.FocalPredictor._get_refine", "torch.interpolate", "torch.interpolate", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.log.cpu().numpy", "torch.log.cpu().numpy", "hasattr", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "t.inv_transform", "torch.log.cpu().numpy", "torch.log.cpu().numpy", "prev_mask.cpu().numpy", "len", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log.cpu().numpy", "torch.log.cpu().numpy", "min", "torch.log.cpu", "torch.log.cpu", "len", "image_nd.size", "torch.log.cpu", "torch.log.cpu", "prev_mask.cpu", "torch.log.cpu", "torch.log.cpu", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.apply_transforms", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_prediction", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.get_focus_cropv1", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.mapp_roi", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_refine", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.inv_transform"], ["", "def", "get_prediction", "(", "self", ",", "clicker", ",", "prev_mask", "=", "None", ")", ":", "\n", "        ", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "click", "=", "clicks_list", "[", "-", "1", "]", "\n", "last_y", ",", "last_x", "=", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", "\n", "self", ".", "last_y", "=", "last_y", "\n", "self", ".", "last_x", "=", "last_x", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "model_indx", "=", "min", "(", "clicker", ".", "click_indx_offset", "+", "len", "(", "clicks_list", ")", ",", "len", "(", "self", ".", "click_models", ")", ")", "-", "1", "\n", "if", "model_indx", "!=", "self", ".", "model_indx", ":", "\n", "                ", "self", ".", "model_indx", "=", "model_indx", "\n", "self", ".", "net", "=", "self", ".", "click_models", "[", "model_indx", "]", "\n", "\n", "", "", "input_image", "=", "self", ".", "original_image", "\n", "if", "prev_mask", "is", "None", ":", "\n", "            ", "prev_mask", "=", "self", ".", "prev_prediction", "\n", "", "if", "hasattr", "(", "self", ".", "net", ",", "'with_prev_mask'", ")", "and", "self", ".", "net", ".", "with_prev_mask", ":", "\n", "            ", "input_image", "=", "torch", ".", "cat", "(", "(", "input_image", ",", "prev_mask", ")", ",", "dim", "=", "1", ")", "\n", "\n", "", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "=", "self", ".", "apply_transforms", "(", "\n", "input_image", ",", "[", "clicks_list", "]", "\n", ")", "\n", "\n", "try", ":", "\n", "            ", "roi", "=", "self", ".", "transforms", "[", "0", "]", ".", "_object_roi", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "roi", "\n", "global_roi", "=", "(", "y1", ",", "y2", "+", "1", ",", "x1", ",", "x2", "+", "1", ")", "\n", "", "except", ":", "\n", "            ", "h", ",", "w", "=", "prev_mask", ".", "shape", "[", "-", "2", "]", ",", "prev_mask", ".", "shape", "[", "-", "1", "]", "\n", "global_roi", "=", "(", "0", ",", "h", ",", "0", ",", "w", ")", "\n", "", "self", ".", "global_roi", "=", "global_roi", "\n", "\n", "pred_logits", ",", "feature", "=", "self", ".", "_get_prediction", "(", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", "\n", "prediction", "=", "F", ".", "interpolate", "(", "pred_logits", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ",", "\n", "size", "=", "image_nd", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "\n", "\n", "for", "t", "in", "reversed", "(", "self", ".", "transforms", ")", ":", "\n", "            ", "prediction", "=", "t", ".", "inv_transform", "(", "prediction", ")", "\n", "\n", "#self.prev_prediction = prediction", "\n", "#return prediction.cpu().numpy()[0, 0]", "\n", "\n", "\n", "", "prediction", "=", "torch", ".", "log", "(", "prediction", "/", "(", "1", "-", "prediction", ")", ")", "\n", "coarse_mask", "=", "prediction", "\n", "prev_mask", "=", "prev_mask", "\n", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "image_full", "=", "self", ".", "original_image", "\n", "\n", "coarse_mask_np", "=", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "prev_mask_np", "=", "prev_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n", "# === Ablation Studies for Different Strategies of Focus Crop", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "get_focus_cropv1", "(", "coarse_mask_np", ",", "prev_mask_np", ",", "global_roi", ",", "last_y", ",", "last_x", ",", "self", ".", "focus_crop_r", ")", "\n", "#y1,y2,x1,x2 = get_focus_cropv1(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x, 1.2)", "\n", "#y1,y2,x1,x2 = get_focus_cropv1(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x, 1.6)", "\n", "#y1,y2,x1,x2 = get_focus_cropv2(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x, 1.4)", "\n", "#y1,y2,x1,x2 = get_object_crop(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x, 1.4)", "\n", "#y1,y2,x1,x2 = get_click_crop(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x, 1.4)", "\n", "\n", "focus_roi", "=", "(", "y1", ",", "y2", ",", "x1", ",", "x2", ")", "\n", "self", ".", "focus_roi", "=", "focus_roi", "\n", "focus_roi_in_global_roi", "=", "self", ".", "mapp_roi", "(", "focus_roi", ",", "global_roi", ")", "\n", "focus_pred", "=", "self", ".", "_get_refine", "(", "pred_logits", ",", "image_full", ",", "clicks_list", ",", "feature", ",", "focus_roi", ",", "focus_roi_in_global_roi", ")", "#.cpu().numpy()[0, 0]", "\n", "focus_pred", "=", "F", ".", "interpolate", "(", "focus_pred", ",", "(", "y2", "-", "y1", ",", "x2", "-", "x1", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "#.cpu().numpy()[0, 0]", "\n", "\n", "if", "len", "(", "clicks_list", ")", ">", "10", ":", "\n", "            ", "coarse_mask", "=", "self", ".", "prev_prediction", "\n", "coarse_mask", "=", "torch", ".", "log", "(", "coarse_mask", "/", "(", "1", "-", "coarse_mask", ")", ")", "\n", "", "coarse_mask", "[", ":", ",", ":", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "=", "focus_pred", "\n", "coarse_mask", "=", "torch", ".", "sigmoid", "(", "coarse_mask", ")", "\n", "\n", "self", ".", "prev_prediction", "=", "coarse_mask", "\n", "self", ".", "transforms", "[", "0", "]", ".", "_prev_probs", "=", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "return", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor._get_prediction": [[136, 140], ["focalclick.FocalPredictor.get_points_nd", "focalclick.FocalPredictor.net"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd"], ["", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "output", "=", "self", ".", "net", "(", "image_nd", ",", "points_nd", ")", "\n", "return", "output", "[", "'instances'", "]", ",", "output", "[", "'feature'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor._get_refine": [[141, 156], ["torch.interpolate", "torch.interpolate", "focalclick.FocalPredictor.get_points_nd_inbbox", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "focalclick.FocalPredictor.net.refine", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd_inbbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.refine"], ["", "def", "_get_refine", "(", "self", ",", "coarse_mask", ",", "image", ",", "clicks", ",", "feature", ",", "focus_roi", ",", "focus_roi_in_global_roi", ")", ":", "\n", "        ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi", "\n", "image_focus", "=", "image", "[", ":", ",", ":", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "\n", "image_focus", "=", "F", ".", "interpolate", "(", "image_focus", ",", "(", "self", ".", "crop_l", ",", "self", ".", "crop_l", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "mask_focus", "=", "coarse_mask", "\n", "points_nd", "=", "self", ".", "get_points_nd_inbbox", "(", "clicks", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi_in_global_roi", "\n", "roi", "=", "torch", ".", "tensor", "(", "[", "0", ",", "x1", ",", "y1", ",", "x2", ",", "y2", "]", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ".", "to", "(", "image_focus", ".", "device", ")", "\n", "\n", "\n", "pred", "=", "self", ".", "net", ".", "refine", "(", "image_focus", ",", "points_nd", ",", "feature", ",", "mask_focus", ",", "roi", ")", "#['instances_refined'] ", "\n", "focus_coarse", ",", "focus_refined", "=", "pred", "[", "'instances_coarse'", "]", ",", "pred", "[", "'instances_refined'", "]", "\n", "self", ".", "focus_coarse", "=", "torch", ".", "sigmoid", "(", "focus_coarse", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "self", ".", "focus_refined", "=", "torch", ".", "sigmoid", "(", "focus_refined", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "return", "focus_refined", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.mapp_roi": [[158, 173], ["max", "min", "max", "min"], "methods", ["None"], ["", "def", "mapp_roi", "(", "self", ",", "focus_roi", ",", "global_roi", ")", ":", "\n", "        ", "yg1", ",", "yg2", ",", "xg1", ",", "xg2", "=", "global_roi", "\n", "hg", ",", "wg", "=", "yg2", "-", "yg1", ",", "xg2", "-", "xg1", "\n", "yf1", ",", "yf2", ",", "xf1", ",", "xf2", "=", "focus_roi", "\n", "\n", "yf1_n", "=", "(", "yf1", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "yf2_n", "=", "(", "yf2", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "xf1_n", "=", "(", "xf1", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "xf2_n", "=", "(", "xf2", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "\n", "yf1_n", "=", "max", "(", "yf1_n", ",", "0", ")", "\n", "yf2_n", "=", "min", "(", "yf2_n", ",", "self", ".", "crop_l", ")", "\n", "xf1_n", "=", "max", "(", "xf1_n", ",", "0", ")", "\n", "xf2_n", "=", "min", "(", "xf2_n", ",", "self", ".", "crop_l", ")", "\n", "return", "(", "yf1_n", ",", "yf2_n", ",", "xf1_n", ",", "xf2_n", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor._get_transform_states": [[174, 176], ["x.get_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.get_state"], ["", "def", "_get_transform_states", "(", "self", ")", ":", "\n", "        ", "return", "[", "x", ".", "get_state", "(", ")", "for", "x", "in", "self", ".", "transforms", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor._set_transform_states": [[177, 182], ["zip", "print", "len", "len", "transform.set_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.set_state"], ["", "def", "_set_transform_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "assert", "len", "(", "states", ")", "==", "len", "(", "self", ".", "transforms", ")", "\n", "for", "state", ",", "transform", "in", "zip", "(", "states", ",", "self", ".", "transforms", ")", ":", "\n", "            ", "transform", ".", "set_state", "(", "state", ")", "\n", "", "print", "(", "'_set_transform_states'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.apply_transforms": [[183, 190], ["t.transform"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.transform"], ["", "def", "apply_transforms", "(", "self", ",", "image_nd", ",", "clicks_lists", ")", ":", "\n", "        ", "is_image_changed", "=", "False", "\n", "for", "t", "in", "self", ".", "transforms", ":", "\n", "            ", "image_nd", ",", "clicks_lists", "=", "t", ".", "transform", "(", "image_nd", ",", "clicks_lists", ")", "\n", "is_image_changed", "|=", "t", ".", "image_changed", "\n", "\n", "", "return", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.get_points_nd": [[191, 210], ["max", "max", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "sum", "min", "total_clicks.append", "len", "zip", "len", "len"], "methods", ["None"], ["", "def", "get_points_nd", "(", "self", ",", "clicks_lists", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos_clicks", "=", "[", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "for", "clicks_list", "in", "clicks_lists", "]", "\n", "num_neg_clicks", "=", "[", "len", "(", "clicks_list", ")", "-", "num_pos", "for", "clicks_list", ",", "num_pos", "in", "zip", "(", "clicks_lists", ",", "num_pos_clicks", ")", "]", "\n", "num_max_points", "=", "max", "(", "num_pos_clicks", "+", "num_neg_clicks", ")", "\n", "if", "self", ".", "net_clicks_limit", "is", "not", "None", ":", "\n", "            ", "num_max_points", "=", "min", "(", "self", ".", "net_clicks_limit", ",", "num_max_points", ")", "\n", "", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "\n", "for", "clicks_list", "in", "clicks_lists", ":", "\n", "            ", "clicks_list", "=", "clicks_list", "[", ":", "self", ".", "net_clicks_limit", "]", "\n", "pos_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "click", ".", "is_positive", "]", "\n", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "\n", "neg_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "not", "click", ".", "is_positive", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "\n", "", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.get_points_nd_inbbox": [[211, 230], ["sum", "max", "max", "total_clicks.append", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "len", "isegm.utils.crop_local.map_point_in_bbox", "pos_clicks.append", "neg_clicks.append", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.map_point_in_bbox"], ["", "def", "get_points_nd_inbbox", "(", "self", ",", "clicks_list", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos", "=", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "\n", "num_neg", "=", "len", "(", "clicks_list", ")", "-", "num_pos", "\n", "num_max_points", "=", "max", "(", "num_pos", ",", "num_neg", ")", "\n", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "pos_clicks", ",", "neg_clicks", "=", "[", "]", ",", "[", "]", "\n", "for", "click", "in", "clicks_list", ":", "\n", "            ", "flag", ",", "y", ",", "x", ",", "index", "=", "click", ".", "is_positive", ",", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", ",", "0", "\n", "y", ",", "x", "=", "map_point_in_bbox", "(", "y", ",", "x", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "self", ".", "crop_l", ")", "\n", "if", "flag", ":", "\n", "                ", "pos_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "", "else", ":", "\n", "                ", "neg_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "\n", "", "", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.get_states": [[234, 238], ["focalclick.FocalPredictor._get_transform_states", "focalclick.FocalPredictor.prev_prediction.clone"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_transform_states"], ["", "def", "get_states", "(", "self", ")", ":", "\n", "        ", "return", "{", "\n", "'transform_states'", ":", "self", ".", "_get_transform_states", "(", ")", ",", "\n", "'prev_prediction'", ":", "self", ".", "prev_prediction", ".", "clone", "(", ")", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.focalclick.FocalPredictor.set_states": [[240, 244], ["focalclick.FocalPredictor._set_transform_states", "print"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._set_transform_states"], ["", "def", "set_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "self", ".", "_set_transform_states", "(", "states", "[", "'transform_states'", "]", ")", "\n", "self", ".", "prev_prediction", "=", "states", "[", "'prev_prediction'", "]", "\n", "print", "(", "'set'", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.BaseOptimizer.__init__": [[9, 32], ["brs_losses.BRSMaskLoss"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "optimizer_params", ",", "\n", "prob_thresh", "=", "0.49", ",", "\n", "reg_weight", "=", "1e-3", ",", "\n", "min_iou_diff", "=", "0.01", ",", "\n", "brs_loss", "=", "BRSMaskLoss", "(", ")", ",", "\n", "with_flip", "=", "False", ",", "\n", "flip_average", "=", "False", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "brs_loss", "=", "brs_loss", "\n", "self", ".", "optimizer_params", "=", "optimizer_params", "\n", "self", ".", "prob_thresh", "=", "prob_thresh", "\n", "self", ".", "reg_weight", "=", "reg_weight", "\n", "self", ".", "min_iou_diff", "=", "min_iou_diff", "\n", "self", ".", "with_flip", "=", "with_flip", "\n", "self", ".", "flip_average", "=", "flip_average", "\n", "\n", "self", ".", "best_prediction", "=", "None", "\n", "self", ".", "_get_prediction_logits", "=", "None", "\n", "self", ".", "_opt_shape", "=", "None", "\n", "self", ".", "_best_loss", "=", "None", "\n", "self", ".", "_click_masks", "=", "None", "\n", "self", ".", "_last_mask", "=", "None", "\n", "self", ".", "device", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.BaseOptimizer.init_click": [[33, 40], ["None"], "methods", ["None"], ["", "def", "init_click", "(", "self", ",", "get_prediction_logits", ",", "pos_mask", ",", "neg_mask", ",", "device", ",", "shape", "=", "None", ")", ":", "\n", "        ", "self", ".", "best_prediction", "=", "None", "\n", "self", ".", "_get_prediction_logits", "=", "get_prediction_logits", "\n", "self", ".", "_click_masks", "=", "(", "pos_mask", ",", "neg_mask", ")", "\n", "self", ".", "_opt_shape", "=", "shape", "\n", "self", ".", "_last_mask", "=", "None", "\n", "self", ".", "device", "=", "device", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.BaseOptimizer.__call__": [[41, 78], ["torch.from_numpy().float().to", "torch.from_numpy().float().to.requires_grad_", "loss.detach().cpu().numpy", "loss.backward", "torch.from_numpy().float().to.grad.cpu().numpy().ravel().astype", "torch.enable_grad", "brs_functors.BaseOptimizer.unpack_opt_params", "brs_functors.BaseOptimizer._get_prediction_logits", "torch.sigmoid", "brs_functors.BaseOptimizer.brs_loss", "brs_functors.BaseOptimizer.detach", "isegm.model.metrics._compute_iou", "torch.from_numpy().float", "torch.chunk", "loss.detach().cpu", "numpy.zeros_like", "torch.from_numpy().float().to.grad.cpu().numpy().ravel", "len", "isegm.model.metrics._compute_iou.mean", "numpy.zeros_like", "torch.from_numpy", "torch.flip", "loss.detach", "torch.from_numpy().float().to.grad.cpu().numpy", "torch.from_numpy().float().to.grad.cpu"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.ScaleBiasOptimizer.unpack_opt_params", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics._compute_iou"], ["", "def", "__call__", "(", "self", ",", "x", ")", ":", "\n", "        ", "opt_params", "=", "torch", ".", "from_numpy", "(", "x", ")", ".", "float", "(", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "opt_params", ".", "requires_grad_", "(", "True", ")", "\n", "\n", "with", "torch", ".", "enable_grad", "(", ")", ":", "\n", "            ", "opt_vars", ",", "reg_loss", "=", "self", ".", "unpack_opt_params", "(", "opt_params", ")", "\n", "result_before_sigmoid", "=", "self", ".", "_get_prediction_logits", "(", "*", "opt_vars", ")", "\n", "result", "=", "torch", ".", "sigmoid", "(", "result_before_sigmoid", ")", "\n", "\n", "pos_mask", ",", "neg_mask", "=", "self", ".", "_click_masks", "\n", "if", "self", ".", "with_flip", "and", "self", ".", "flip_average", ":", "\n", "                ", "result", ",", "result_flipped", "=", "torch", ".", "chunk", "(", "result", ",", "2", ",", "dim", "=", "0", ")", "\n", "result", "=", "0.5", "*", "(", "result", "+", "torch", ".", "flip", "(", "result_flipped", ",", "dims", "=", "[", "3", "]", ")", ")", "\n", "pos_mask", ",", "neg_mask", "=", "pos_mask", "[", ":", "result", ".", "shape", "[", "0", "]", "]", ",", "neg_mask", "[", ":", "result", ".", "shape", "[", "0", "]", "]", "\n", "\n", "", "loss", ",", "f_max_pos", ",", "f_max_neg", "=", "self", ".", "brs_loss", "(", "result", ",", "pos_mask", ",", "neg_mask", ")", "\n", "loss", "=", "loss", "+", "reg_loss", "\n", "\n", "", "f_val", "=", "loss", ".", "detach", "(", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "if", "self", ".", "best_prediction", "is", "None", "or", "f_val", "<", "self", ".", "_best_loss", ":", "\n", "            ", "self", ".", "best_prediction", "=", "result_before_sigmoid", ".", "detach", "(", ")", "\n", "self", ".", "_best_loss", "=", "f_val", "\n", "\n", "", "if", "f_max_pos", "<", "(", "1", "-", "self", ".", "prob_thresh", ")", "and", "f_max_neg", "<", "self", ".", "prob_thresh", ":", "\n", "            ", "return", "[", "f_val", ",", "np", ".", "zeros_like", "(", "x", ")", "]", "\n", "\n", "", "current_mask", "=", "result", ">", "self", ".", "prob_thresh", "\n", "if", "self", ".", "_last_mask", "is", "not", "None", "and", "self", ".", "min_iou_diff", ">", "0", ":", "\n", "            ", "diff_iou", "=", "_compute_iou", "(", "current_mask", ",", "self", ".", "_last_mask", ")", "\n", "if", "len", "(", "diff_iou", ")", ">", "0", "and", "diff_iou", ".", "mean", "(", ")", ">", "1", "-", "self", ".", "min_iou_diff", ":", "\n", "                ", "return", "[", "f_val", ",", "np", ".", "zeros_like", "(", "x", ")", "]", "\n", "", "", "self", ".", "_last_mask", "=", "current_mask", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "f_grad", "=", "opt_params", ".", "grad", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "ravel", "(", ")", ".", "astype", "(", "np", ".", "float", ")", "\n", "\n", "return", "[", "f_val", ",", "f_grad", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.BaseOptimizer.unpack_opt_params": [[79, 81], ["None"], "methods", ["None"], ["", "def", "unpack_opt_params", "(", "self", ",", "opt_params", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.InputOptimizer.unpack_opt_params": [[84, 92], ["torch.cat.view", "torch.flip", "torch.cat", "torch.sum"], "methods", ["None"], ["    ", "def", "unpack_opt_params", "(", "self", ",", "opt_params", ")", ":", "\n", "        ", "opt_params", "=", "opt_params", ".", "view", "(", "self", ".", "_opt_shape", ")", "\n", "if", "self", ".", "with_flip", ":", "\n", "            ", "opt_params_flipped", "=", "torch", ".", "flip", "(", "opt_params", ",", "dims", "=", "[", "3", "]", ")", "\n", "opt_params", "=", "torch", ".", "cat", "(", "[", "opt_params", ",", "opt_params_flipped", "]", ",", "dim", "=", "0", ")", "\n", "", "reg_loss", "=", "self", ".", "reg_weight", "*", "torch", ".", "sum", "(", "opt_params", "**", "2", ")", "\n", "\n", "return", "(", "opt_params", ",", ")", ",", "reg_loss", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.ScaleBiasOptimizer.__init__": [[95, 99], ["brs_functors.BaseOptimizer.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "*", "args", ",", "scale_act", "=", "None", ",", "reg_bias_weight", "=", "10.0", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "*", "args", ",", "**", "kwargs", ")", "\n", "self", ".", "scale_act", "=", "scale_act", "\n", "self", ".", "reg_bias_weight", "=", "reg_bias_weight", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.brs_functors.ScaleBiasOptimizer.unpack_opt_params": [[100, 110], ["torch.chunk", "torch.tanh", "torch.sum", "torch.sin", "torch.sum"], "methods", ["None"], ["", "def", "unpack_opt_params", "(", "self", ",", "opt_params", ")", ":", "\n", "        ", "scale", ",", "bias", "=", "torch", ".", "chunk", "(", "opt_params", ",", "2", ",", "dim", "=", "0", ")", "\n", "reg_loss", "=", "self", ".", "reg_weight", "*", "(", "torch", ".", "sum", "(", "scale", "**", "2", ")", "+", "self", ".", "reg_bias_weight", "*", "torch", ".", "sum", "(", "bias", "**", "2", ")", ")", "\n", "\n", "if", "self", ".", "scale_act", "==", "'tanh'", ":", "\n", "            ", "scale", "=", "torch", ".", "tanh", "(", "scale", ")", "\n", "", "elif", "self", ".", "scale_act", "==", "'sin'", ":", "\n", "            ", "scale", "=", "torch", ".", "sin", "(", "scale", ")", "\n", "\n", "", "return", "(", "1", "+", "scale", ",", "bias", ")", ",", "reg_loss", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.__init__.get_predictor": [[10, 122], ["dict", "isinstance", "isegm.inference.transforms.ZoomIn", "lbfgs_params_.update", "dict", "baseline.BaselinePredictor", "predictor_params_.update", "cdnet.DiffisionPredictor", "predictor_params_.update", "focalclick.FocalPredictor", "predictor_params_.update", "baseline.BaselinePredictor", "brs_mode.startswith", "predictor_params_.update", "predictor_params_.update", "brs_functors.ScaleBiasOptimizer", "isinstance", "FeaturePredictor", "predictor_params_.update", "predictor_params_.update", "brs_functors.InputOptimizer", "brs.InputBRSPredictor", "predictor_params_.update"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.metrics.AdaptiveIoU.update"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.__init__": [[8, 41], ["isinstance", "torchvision.transforms.ToTensor", "baseline.BaselinePredictor.transforms.append", "baseline.BaselinePredictor.transforms.append", "baseline.BaselinePredictor.transforms.append", "isegm.inference.transforms.ResizeTrans", "isegm.inference.transforms.SigmoidForPred", "isegm.inference.transforms.LimitLongestSide"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "\n", "net_clicks_limit", "=", "None", ",", "\n", "with_flip", "=", "False", ",", "\n", "zoom_in", "=", "None", ",", "\n", "max_size", "=", "None", ",", "\n", "infer_size", "=", "384", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "with_flip", "=", "with_flip", "\n", "self", ".", "net_clicks_limit", "=", "net_clicks_limit", "\n", "self", ".", "original_image", "=", "None", "\n", "self", ".", "device", "=", "device", "\n", "self", ".", "zoom_in", "=", "zoom_in", "\n", "self", ".", "prev_prediction", "=", "None", "\n", "self", ".", "model_indx", "=", "0", "\n", "self", ".", "click_models", "=", "None", "\n", "self", ".", "net_state_dict", "=", "None", "\n", "\n", "if", "isinstance", "(", "model", ",", "tuple", ")", ":", "\n", "            ", "self", ".", "net", ",", "self", ".", "click_models", "=", "model", "\n", "", "else", ":", "\n", "            ", "self", ".", "net", "=", "model", "\n", "\n", "", "self", ".", "to_tensor", "=", "transforms", ".", "ToTensor", "(", ")", "\n", "\n", "self", ".", "transforms", "=", "[", "zoom_in", "]", "if", "zoom_in", "is", "not", "None", "else", "[", "]", "\n", "if", "max_size", "is", "not", "None", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "LimitLongestSide", "(", "max_size", "=", "max_size", ")", ")", "\n", "", "self", ".", "crop_l", "=", "infer_size", "\n", "self", ".", "transforms", ".", "append", "(", "ResizeTrans", "(", "self", ".", "crop_l", ")", ")", "\n", "self", ".", "transforms", ".", "append", "(", "SigmoidForPred", "(", ")", ")", "\n", "self", ".", "focus_roi", "=", "None", "\n", "self", ".", "global_roi", "=", "None", "\n", "self", ".", "with_flip", "=", "True", "\n", "#self.transforms.append(AddHorizontalFlip())", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.set_input_image": [[43, 51], ["baseline.BaselinePredictor.to_tensor", "baseline.BaselinePredictor.to", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "transform.reset", "len", "baseline.BaselinePredictor.original_image.unsqueeze"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.reset"], ["", "def", "set_input_image", "(", "self", ",", "image", ")", ":", "\n", "        ", "image_nd", "=", "self", ".", "to_tensor", "(", "image", ")", "\n", "for", "transform", "in", "self", ".", "transforms", ":", "\n", "            ", "transform", ".", "reset", "(", ")", "\n", "", "self", ".", "original_image", "=", "image_nd", ".", "to", "(", "self", ".", "device", ")", "\n", "if", "len", "(", "self", ".", "original_image", ".", "shape", ")", "==", "3", ":", "\n", "            ", "self", ".", "original_image", "=", "self", ".", "original_image", ".", "unsqueeze", "(", "0", ")", "\n", "", "self", ".", "prev_prediction", "=", "torch", ".", "zeros_like", "(", "self", ".", "original_image", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.set_prev_mask": [[52, 54], ["torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to().float", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze().to", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy().unsqueeze", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["None"], ["", "def", "set_prev_mask", "(", "self", ",", "mask", ")", ":", "\n", "        ", "self", ".", "prev_prediction", "=", "torch", ".", "from_numpy", "(", "mask", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "to", "(", "self", ".", "device", ")", ".", "float", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_prediction": [[55, 93], ["clicker.get_clicks", "baseline.BaselinePredictor.apply_transforms", "baseline.BaselinePredictor._get_prediction", "torch.interpolate", "torch.interpolate", "reversed", "hasattr", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "t.inv_transform", "t.inv_transform.cpu().numpy", "min", "len", "image_nd.size", "t.inv_transform.cpu", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Clicker.get_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.apply_transforms", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_prediction", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.inv_transform"], ["", "def", "get_prediction", "(", "self", ",", "clicker", ",", "prev_mask", "=", "None", ")", ":", "\n", "        ", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "click", "=", "clicks_list", "[", "-", "1", "]", "\n", "last_y", ",", "last_x", "=", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", "\n", "self", ".", "last_y", "=", "last_y", "\n", "self", ".", "last_x", "=", "last_x", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "model_indx", "=", "min", "(", "clicker", ".", "click_indx_offset", "+", "len", "(", "clicks_list", ")", ",", "len", "(", "self", ".", "click_models", ")", ")", "-", "1", "\n", "if", "model_indx", "!=", "self", ".", "model_indx", ":", "\n", "                ", "self", ".", "model_indx", "=", "model_indx", "\n", "self", ".", "net", "=", "self", ".", "click_models", "[", "model_indx", "]", "\n", "\n", "", "", "input_image", "=", "self", ".", "original_image", "\n", "if", "prev_mask", "is", "None", ":", "\n", "            ", "prev_mask", "=", "self", ".", "prev_prediction", "\n", "", "if", "hasattr", "(", "self", ".", "net", ",", "'with_prev_mask'", ")", "and", "self", ".", "net", ".", "with_prev_mask", ":", "\n", "            ", "input_image", "=", "torch", ".", "cat", "(", "(", "input_image", ",", "prev_mask", ")", ",", "dim", "=", "1", ")", "\n", "\n", "\n", "\n", "", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "=", "self", ".", "apply_transforms", "(", "\n", "input_image", ",", "[", "clicks_list", "]", "\n", ")", "\n", "\n", "pred_logits", "=", "self", ".", "_get_prediction", "(", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", "\n", "prediction", "=", "F", ".", "interpolate", "(", "pred_logits", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ",", "\n", "size", "=", "image_nd", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "\n", "for", "t", "in", "reversed", "(", "self", ".", "transforms", ")", ":", "\n", "#if not isinstance(t,SigmoidForPred):", "\n", "            ", "prediction", "=", "t", ".", "inv_transform", "(", "prediction", ")", "\n", "\n", "#if self.zoom_in is not None and self.zoom_in.check_possible_recalculation():", "\n", "#    return self.get_prediction(clicker)", "\n", "\n", "", "self", ".", "prev_prediction", "=", "prediction", "\n", "return", "prediction", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_prediction": [[94, 98], ["baseline.BaselinePredictor.get_points_nd", "baseline.BaselinePredictor.net"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd"], ["", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "output", "=", "self", ".", "net", "(", "image_nd", ",", "points_nd", ")", "\n", "return", "output", "[", "'instances'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_refine": [[99, 124], ["baseline.BaselinePredictor.get_points_nd_inbbox", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "torch.tensor().unsqueeze().float().to", "baseline.BaselinePredictor.net.refine", "torch.interpolate", "torch.interpolate", "print", "print", "print", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.tensor().unsqueeze().float", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.sigmoid().cpu().numpy", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.tensor().unsqueeze", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.sigmoid().cpu", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd_inbbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.model.is_segformer_model.SegFormerModel.refine"], ["", "def", "_get_refine", "(", "self", ",", "coarse_mask", ",", "image", ",", "clicks", ",", "feature", ",", "focus_roi", ",", "focus_roi_in_global_roi", ")", ":", "\n", "        ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi", "\n", "image_focus", "=", "image", "[", ":", ",", ":", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "\n", "try", ":", "\n", "            ", "image_focus", "=", "F", ".", "interpolate", "(", "image_focus", ",", "(", "self", ".", "crop_l", ",", "self", ".", "crop_l", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "", "except", ":", "\n", "            ", "ly", ",", "lx", ",", "lin", "=", "clicks", "[", "-", "1", "]", ".", "coords_and_indx", "\n", "print", "(", "'last clicks: '", ",", "clicks", "[", "-", "1", "]", ".", "is_positive", ")", "\n", "print", "(", "self", ".", "prev_prediction", ".", "shape", ")", "\n", "print", "(", "ly", ",", "lx", ",", "self", ".", "prev_prediction", "[", "0", ",", "0", ",", "ly", ",", "lx", "]", ")", "\n", "\n", "", "mask_focus", "=", "coarse_mask", "\n", "#mask_focus = coarse_mask[:,:,y1:y2,x1:x2]", "\n", "#mask_focus = F.interpolate(mask_focus,(self.crop_l,self.crop_l),mode='bilinear',align_corners=True)", "\n", "\n", "points_nd", "=", "self", ".", "get_points_nd_inbbox", "(", "clicks", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi_in_global_roi", "\n", "roi", "=", "torch", ".", "tensor", "(", "[", "0", ",", "x1", ",", "y1", ",", "x2", ",", "y2", "]", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ".", "to", "(", "image_focus", ".", "device", ")", "\n", "\n", "\n", "pred", "=", "self", ".", "net", ".", "refine", "(", "image_focus", ",", "points_nd", ",", "feature", ",", "mask_focus", ",", "roi", ")", "#['instances_refined'] ", "\n", "focus_coarse", ",", "focus_refined", "=", "pred", "[", "'instances_coarse'", "]", ",", "pred", "[", "'instances_refined'", "]", "\n", "self", ".", "focus_coarse", "=", "torch", ".", "sigmoid", "(", "focus_coarse", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "self", ".", "focus_refined", "=", "torch", ".", "sigmoid", "(", "focus_refined", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "return", "focus_refined", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.mapp_roi": [[127, 152], ["max", "min", "max", "min"], "methods", ["None"], ["", "def", "mapp_roi", "(", "self", ",", "focus_roi", ",", "global_roi", ")", ":", "\n", "        ", "yg1", ",", "yg2", ",", "xg1", ",", "xg2", "=", "global_roi", "\n", "hg", ",", "wg", "=", "yg2", "-", "yg1", ",", "xg2", "-", "xg1", "\n", "yf1", ",", "yf2", ",", "xf1", ",", "xf2", "=", "focus_roi", "\n", "\n", "'''\n        yf1_n = (yf1-yg1+1) * (self.crop_l/hg)\n        yf2_n = (yf2-yg1+1) * (self.crop_l/hg)\n        xf1_n = (xf1-xg1+1) * (self.crop_l/wg)\n        xf2_n = (xf2-xg1+1) * (self.crop_l/wg)\n\n        '''", "\n", "yf1_n", "=", "(", "yf1", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "yf2_n", "=", "(", "yf2", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "xf1_n", "=", "(", "xf1", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "xf2_n", "=", "(", "xf2", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "\n", "\n", "\n", "\n", "yf1_n", "=", "max", "(", "yf1_n", ",", "0", ")", "\n", "yf2_n", "=", "min", "(", "yf2_n", ",", "self", ".", "crop_l", ")", "\n", "xf1_n", "=", "max", "(", "xf1_n", ",", "0", ")", "\n", "xf2_n", "=", "min", "(", "xf2_n", ",", "self", ".", "crop_l", ")", "\n", "return", "(", "yf1_n", ",", "yf2_n", ",", "xf1_n", ",", "xf2_n", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_transform_states": [[158, 160], ["x.get_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.get_state"], ["", "def", "_get_transform_states", "(", "self", ")", ":", "\n", "        ", "return", "[", "x", ".", "get_state", "(", ")", "for", "x", "in", "self", ".", "transforms", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._set_transform_states": [[161, 166], ["zip", "print", "len", "len", "transform.set_state"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.set_state"], ["", "def", "_set_transform_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "assert", "len", "(", "states", ")", "==", "len", "(", "self", ".", "transforms", ")", "\n", "for", "state", ",", "transform", "in", "zip", "(", "states", ",", "self", ".", "transforms", ")", ":", "\n", "            ", "transform", ".", "set_state", "(", "state", ")", "\n", "", "print", "(", "'_set_transform_states'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.apply_transforms": [[167, 174], ["t.transform"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.transform"], ["", "def", "apply_transforms", "(", "self", ",", "image_nd", ",", "clicks_lists", ")", ":", "\n", "        ", "is_image_changed", "=", "False", "\n", "for", "t", "in", "self", ".", "transforms", ":", "\n", "            ", "image_nd", ",", "clicks_lists", "=", "t", ".", "transform", "(", "image_nd", ",", "clicks_lists", ")", "\n", "is_image_changed", "|=", "t", ".", "image_changed", "\n", "\n", "", "return", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd": [[175, 194], ["max", "max", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "sum", "min", "total_clicks.append", "len", "zip", "len", "len"], "methods", ["None"], ["", "def", "get_points_nd", "(", "self", ",", "clicks_lists", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos_clicks", "=", "[", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "for", "clicks_list", "in", "clicks_lists", "]", "\n", "num_neg_clicks", "=", "[", "len", "(", "clicks_list", ")", "-", "num_pos", "for", "clicks_list", ",", "num_pos", "in", "zip", "(", "clicks_lists", ",", "num_pos_clicks", ")", "]", "\n", "num_max_points", "=", "max", "(", "num_pos_clicks", "+", "num_neg_clicks", ")", "\n", "if", "self", ".", "net_clicks_limit", "is", "not", "None", ":", "\n", "            ", "num_max_points", "=", "min", "(", "self", ".", "net_clicks_limit", ",", "num_max_points", ")", "\n", "", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "\n", "for", "clicks_list", "in", "clicks_lists", ":", "\n", "            ", "clicks_list", "=", "clicks_list", "[", ":", "self", ".", "net_clicks_limit", "]", "\n", "pos_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "click", ".", "is_positive", "]", "\n", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "\n", "neg_clicks", "=", "[", "click", ".", "coords_and_indx", "for", "click", "in", "clicks_list", "if", "not", "click", ".", "is_positive", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "\n", "", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_points_nd_inbbox": [[195, 214], ["sum", "max", "max", "total_clicks.append", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "len", "map_point_in_bbox", "pos_clicks.append", "neg_clicks.append", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.map_point_in_bbox"], ["", "def", "get_points_nd_inbbox", "(", "self", ",", "clicks_list", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", ":", "\n", "        ", "total_clicks", "=", "[", "]", "\n", "num_pos", "=", "sum", "(", "x", ".", "is_positive", "for", "x", "in", "clicks_list", ")", "\n", "num_neg", "=", "len", "(", "clicks_list", ")", "-", "num_pos", "\n", "num_max_points", "=", "max", "(", "num_pos", ",", "num_neg", ")", "\n", "num_max_points", "=", "max", "(", "1", ",", "num_max_points", ")", "\n", "pos_clicks", ",", "neg_clicks", "=", "[", "]", ",", "[", "]", "\n", "for", "click", "in", "clicks_list", ":", "\n", "            ", "flag", ",", "y", ",", "x", ",", "index", "=", "click", ".", "is_positive", ",", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", ",", "0", "\n", "y", ",", "x", "=", "map_point_in_bbox", "(", "y", ",", "x", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ",", "self", ".", "crop_l", ")", "\n", "if", "flag", ":", "\n", "                ", "pos_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "", "else", ":", "\n", "                ", "neg_clicks", ".", "append", "(", "(", "y", ",", "x", ",", "index", ")", ")", "\n", "\n", "", "", "pos_clicks", "=", "pos_clicks", "+", "(", "num_max_points", "-", "len", "(", "pos_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "neg_clicks", "=", "neg_clicks", "+", "(", "num_max_points", "-", "len", "(", "neg_clicks", ")", ")", "*", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "\n", "total_clicks", ".", "append", "(", "pos_clicks", "+", "neg_clicks", ")", "\n", "return", "torch", ".", "tensor", "(", "total_clicks", ",", "device", "=", "self", ".", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.get_states": [[218, 222], ["baseline.BaselinePredictor._get_transform_states", "baseline.BaselinePredictor.prev_prediction.clone"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._get_transform_states"], ["", "def", "get_states", "(", "self", ")", ":", "\n", "        ", "return", "{", "\n", "'transform_states'", ":", "self", ".", "_get_transform_states", "(", ")", ",", "\n", "'prev_prediction'", ":", "self", ".", "prev_prediction", ".", "clone", "(", ")", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor.set_states": [[224, 228], ["baseline.BaselinePredictor._set_transform_states", "print"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.baseline.BaselinePredictor._set_transform_states"], ["", "def", "set_states", "(", "self", ",", "states", ")", ":", "\n", "        ", "self", ".", "_set_transform_states", "(", "states", "[", "'transform_states'", "]", ")", "\n", "self", ".", "prev_prediction", "=", "states", "[", "'prev_prediction'", "]", "\n", "print", "(", "'set'", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.limit_longest_side.LimitLongestSide.__init__": [[5, 7], ["zoom_in.ZoomIn.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "max_size", "=", "800", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "target_size", "=", "max_size", ",", "skip_clicks", "=", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.limit_longest_side.LimitLongestSide.transform": [[8, 23], ["max", "zoom_in.get_roi_image_nd", "limit_longest_side.LimitLongestSide._transform_clicks", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.get_roi_image_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn._transform_clicks"], ["", "def", "transform", "(", "self", ",", "image_nd", ",", "clicks_lists", ")", ":", "\n", "        ", "assert", "image_nd", ".", "shape", "[", "0", "]", "==", "1", "and", "len", "(", "clicks_lists", ")", "==", "1", "\n", "image_max_size", "=", "max", "(", "image_nd", ".", "shape", "[", "2", ":", "4", "]", ")", "\n", "self", ".", "image_changed", "=", "False", "\n", "\n", "if", "image_max_size", "<=", "self", ".", "target_size", ":", "\n", "            ", "return", "image_nd", ",", "clicks_lists", "\n", "", "self", ".", "_input_image", "=", "image_nd", "\n", "\n", "self", ".", "_object_roi", "=", "(", "0", ",", "image_nd", ".", "shape", "[", "2", "]", "-", "1", ",", "0", ",", "image_nd", ".", "shape", "[", "3", "]", "-", "1", ")", "\n", "self", ".", "_roi_image", "=", "get_roi_image_nd", "(", "image_nd", ",", "self", ".", "_object_roi", ",", "self", ".", "target_size", ")", "\n", "self", ".", "image_changed", "=", "True", "\n", "\n", "tclicks_lists", "=", "[", "self", ".", "_transform_clicks", "(", "clicks_lists", "[", "0", "]", ")", "]", "\n", "return", "self", ".", "_roi_image", ",", "tclicks_lists", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.BaseTransform.__init__": [[5, 7], ["None"], "methods", ["None"], ["\n", "class", "BasePredictor", "(", "object", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "model", ",", "device", ",", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.BaseTransform.transform": [[8, 10], ["None"], "methods", ["None"], ["net_clicks_limit", "=", "None", ",", "\n", "with_flip", "=", "False", ",", "\n", "zoom_in", "=", "None", ",", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.BaseTransform.inv_transform": [[11, 13], ["None"], "methods", ["None"], ["max_size", "=", "None", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "with_flip", "=", "with_flip", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.BaseTransform.reset": [[14, 16], ["None"], "methods", ["None"], ["self", ".", "net_clicks_limit", "=", "net_clicks_limit", "\n", "self", ".", "original_image", "=", "None", "\n", "self", ".", "device", "=", "device", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.BaseTransform.get_state": [[17, 19], ["None"], "methods", ["None"], ["self", ".", "zoom_in", "=", "zoom_in", "\n", "self", ".", "prev_prediction", "=", "None", "\n", "self", ".", "model_indx", "=", "0", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.BaseTransform.set_state": [[20, 22], ["None"], "methods", ["None"], ["self", ".", "click_models", "=", "None", "\n", "self", ".", "net_state_dict", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.SigmoidForPred.transform": [[25, 27], ["None"], "methods", ["None"], ["", "else", ":", "\n", "            ", "self", ".", "net", "=", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.SigmoidForPred.inv_transform": [[28, 30], ["torch.sigmoid"], "methods", ["None"], ["", "self", ".", "to_tensor", "=", "transforms", ".", "ToTensor", "(", ")", "\n", "\n", "self", ".", "transforms", "=", "[", "zoom_in", "]", "if", "zoom_in", "is", "not", "None", "else", "[", "]", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.SigmoidForPred.reset": [[31, 33], ["None"], "methods", ["None"], ["if", "max_size", "is", "not", "None", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "LimitLongestSide", "(", "max_size", "=", "max_size", ")", ")", "\n", "", "self", ".", "crop_l", "=", "256", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.SigmoidForPred.get_state": [[34, 36], ["None"], "methods", ["None"], ["self", ".", "transforms", ".", "append", "(", "ResizeTrans", "(", "self", ".", "crop_l", ")", ")", "\n", "self", ".", "transforms", ".", "append", "(", "SigmoidForPred", "(", ")", ")", "\n", "self", ".", "focus_roi", "=", "(", "0", ",", "10", ",", "0", ",", "10", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.base.SigmoidForPred.set_state": [[37, 39], ["None"], "methods", ["None"], ["self", ".", "global_roi", "=", "(", "0", ",", "10", ",", "0", ",", "10", ")", "\n", "\n", "self", ".", "with_flip", "=", "True", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.crops.Crops.__init__": [[12, 20], ["base.BaseTransform.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "crop_size", "=", "(", "320", ",", "480", ")", ",", "min_overlap", "=", "0.2", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "crop_height", ",", "self", ".", "crop_width", "=", "crop_size", "\n", "self", ".", "min_overlap", "=", "min_overlap", "\n", "\n", "self", ".", "x_offsets", "=", "None", "\n", "self", ".", "y_offsets", "=", "None", "\n", "self", ".", "_counts", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.crops.Crops.transform": [[21, 50], ["crops.get_offsets", "crops.get_offsets", "numpy.zeros", "torch.cat", "torch.tensor", "len", "torch.cat.append", "clicks_lists.append", "x.copy"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.get_offsets", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.get_offsets", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy"], ["", "def", "transform", "(", "self", ",", "image_nd", ",", "clicks_lists", ":", "List", "[", "List", "[", "Click", "]", "]", ")", ":", "\n", "        ", "assert", "image_nd", ".", "shape", "[", "0", "]", "==", "1", "and", "len", "(", "clicks_lists", ")", "==", "1", "\n", "image_height", ",", "image_width", "=", "image_nd", ".", "shape", "[", "2", ":", "4", "]", "\n", "self", ".", "_counts", "=", "None", "\n", "\n", "if", "image_height", "<", "self", ".", "crop_height", "or", "image_width", "<", "self", ".", "crop_width", ":", "\n", "            ", "return", "image_nd", ",", "clicks_lists", "\n", "\n", "", "self", ".", "x_offsets", "=", "get_offsets", "(", "image_width", ",", "self", ".", "crop_width", ",", "self", ".", "min_overlap", ")", "\n", "self", ".", "y_offsets", "=", "get_offsets", "(", "image_height", ",", "self", ".", "crop_height", ",", "self", ".", "min_overlap", ")", "\n", "self", ".", "_counts", "=", "np", ".", "zeros", "(", "(", "image_height", ",", "image_width", ")", ")", "\n", "\n", "image_crops", "=", "[", "]", "\n", "for", "dy", "in", "self", ".", "y_offsets", ":", "\n", "            ", "for", "dx", "in", "self", ".", "x_offsets", ":", "\n", "                ", "self", ".", "_counts", "[", "dy", ":", "dy", "+", "self", ".", "crop_height", ",", "dx", ":", "dx", "+", "self", ".", "crop_width", "]", "+=", "1", "\n", "image_crop", "=", "image_nd", "[", ":", ",", ":", ",", "dy", ":", "dy", "+", "self", ".", "crop_height", ",", "dx", ":", "dx", "+", "self", ".", "crop_width", "]", "\n", "image_crops", ".", "append", "(", "image_crop", ")", "\n", "", "", "image_crops", "=", "torch", ".", "cat", "(", "image_crops", ",", "dim", "=", "0", ")", "\n", "self", ".", "_counts", "=", "torch", ".", "tensor", "(", "self", ".", "_counts", ",", "device", "=", "image_nd", ".", "device", ",", "dtype", "=", "torch", ".", "float32", ")", "\n", "\n", "clicks_list", "=", "clicks_lists", "[", "0", "]", "\n", "clicks_lists", "=", "[", "]", "\n", "for", "dy", "in", "self", ".", "y_offsets", ":", "\n", "            ", "for", "dx", "in", "self", ".", "x_offsets", ":", "\n", "                ", "crop_clicks", "=", "[", "x", ".", "copy", "(", "coords", "=", "(", "x", ".", "coords", "[", "0", "]", "-", "dy", ",", "x", ".", "coords", "[", "1", "]", "-", "dx", ")", ")", "for", "x", "in", "clicks_list", "]", "\n", "clicks_lists", ".", "append", "(", "crop_clicks", ")", "\n", "\n", "", "", "return", "image_crops", ",", "clicks_lists", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.crops.Crops.inv_transform": [[51, 66], ["torch.zeros", "torch.div"], "methods", ["None"], ["", "def", "inv_transform", "(", "self", ",", "prob_map", ")", ":", "\n", "        ", "if", "self", ".", "_counts", "is", "None", ":", "\n", "            ", "return", "prob_map", "\n", "\n", "", "new_prob_map", "=", "torch", ".", "zeros", "(", "(", "1", ",", "1", ",", "*", "self", ".", "_counts", ".", "shape", ")", ",", "\n", "dtype", "=", "prob_map", ".", "dtype", ",", "device", "=", "prob_map", ".", "device", ")", "\n", "\n", "crop_indx", "=", "0", "\n", "for", "dy", "in", "self", ".", "y_offsets", ":", "\n", "            ", "for", "dx", "in", "self", ".", "x_offsets", ":", "\n", "                ", "new_prob_map", "[", "0", ",", "0", ",", "dy", ":", "dy", "+", "self", ".", "crop_height", ",", "dx", ":", "dx", "+", "self", ".", "crop_width", "]", "+=", "prob_map", "[", "crop_indx", ",", "0", "]", "\n", "crop_indx", "+=", "1", "\n", "", "", "new_prob_map", "=", "torch", ".", "div", "(", "new_prob_map", ",", "self", ".", "_counts", ")", "\n", "\n", "return", "new_prob_map", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.crops.Crops.get_state": [[67, 69], ["None"], "methods", ["None"], ["", "def", "get_state", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "x_offsets", ",", "self", ".", "y_offsets", ",", "self", ".", "_counts", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.crops.Crops.set_state": [[70, 72], ["None"], "methods", ["None"], ["", "def", "set_state", "(", "self", ",", "state", ")", ":", "\n", "        ", "self", ".", "x_offsets", ",", "self", ".", "y_offsets", ",", "self", ".", "_counts", "=", "state", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.crops.Crops.reset": [[73, 77], ["None"], "methods", ["None"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "self", ".", "x_offsets", "=", "None", "\n", "self", ".", "y_offsets", "=", "None", "\n", "self", ".", "_counts", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.crops.get_offsets": [[79, 98], ["math.ceil", "int", "range", "offsets.append"], "function", ["None"], ["", "", "def", "get_offsets", "(", "length", ",", "crop_size", ",", "min_overlap_ratio", "=", "0.2", ")", ":", "\n", "    ", "if", "length", "==", "crop_size", ":", "\n", "        ", "return", "[", "0", "]", "\n", "\n", "", "N", "=", "(", "length", "/", "crop_size", "-", "min_overlap_ratio", ")", "/", "(", "1", "-", "min_overlap_ratio", ")", "\n", "N", "=", "math", ".", "ceil", "(", "N", ")", "\n", "\n", "overlap_ratio", "=", "(", "N", "-", "length", "/", "crop_size", ")", "/", "(", "N", "-", "1", ")", "\n", "overlap_width", "=", "int", "(", "crop_size", "*", "overlap_ratio", ")", "\n", "\n", "offsets", "=", "[", "0", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "N", ")", ":", "\n", "        ", "new_offset", "=", "offsets", "[", "-", "1", "]", "+", "crop_size", "-", "overlap_width", "\n", "if", "new_offset", "+", "crop_size", ">", "length", ":", "\n", "            ", "new_offset", "=", "length", "-", "crop_size", "\n", "\n", "", "offsets", ".", "append", "(", "new_offset", ")", "\n", "\n", "", "return", "offsets", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.flip.AddHorizontalFlip.transform": [[9, 22], ["torch.cat", "len", "clicks_lists_flipped.append", "torch.flip", "click.copy"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy"], ["    ", "def", "transform", "(", "self", ",", "image_nd", ",", "clicks_lists", ":", "List", "[", "List", "[", "Click", "]", "]", ")", ":", "\n", "        ", "assert", "len", "(", "image_nd", ".", "shape", ")", "==", "4", "\n", "image_nd", "=", "torch", ".", "cat", "(", "[", "image_nd", ",", "torch", ".", "flip", "(", "image_nd", ",", "dims", "=", "[", "3", "]", ")", "]", ",", "dim", "=", "0", ")", "\n", "\n", "image_width", "=", "image_nd", ".", "shape", "[", "3", "]", "\n", "clicks_lists_flipped", "=", "[", "]", "\n", "for", "clicks_list", "in", "clicks_lists", ":", "\n", "            ", "clicks_list_flipped", "=", "[", "click", ".", "copy", "(", "coords", "=", "(", "click", ".", "coords", "[", "0", "]", ",", "image_width", "-", "click", ".", "coords", "[", "1", "]", "-", "1", ")", ")", "\n", "for", "click", "in", "clicks_list", "]", "\n", "clicks_lists_flipped", ".", "append", "(", "clicks_list_flipped", ")", "\n", "", "clicks_lists", "=", "clicks_lists", "+", "clicks_lists_flipped", "\n", "\n", "return", "image_nd", ",", "clicks_lists", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.flip.AddHorizontalFlip.inv_transform": [[23, 29], ["len", "torch.flip"], "methods", ["None"], ["", "def", "inv_transform", "(", "self", ",", "prob_map", ")", ":", "\n", "        ", "assert", "len", "(", "prob_map", ".", "shape", ")", "==", "4", "and", "prob_map", ".", "shape", "[", "0", "]", "%", "2", "==", "0", "\n", "num_maps", "=", "prob_map", ".", "shape", "[", "0", "]", "//", "2", "\n", "prob_map", ",", "prob_map_flipped", "=", "prob_map", "[", ":", "num_maps", "]", ",", "prob_map", "[", "num_maps", ":", "]", "\n", "\n", "return", "0.5", "*", "(", "prob_map", "+", "torch", ".", "flip", "(", "prob_map_flipped", ",", "dims", "=", "[", "3", "]", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.flip.AddHorizontalFlip.get_state": [[30, 32], ["None"], "methods", ["None"], ["", "def", "get_state", "(", "self", ")", ":", "\n", "        ", "return", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.flip.AddHorizontalFlip.set_state": [[33, 35], ["None"], "methods", ["None"], ["", "def", "set_state", "(", "self", ",", "state", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.flip.AddHorizontalFlip.reset": [[36, 38], ["None"], "methods", ["None"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "pass", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.ResizeTrans.__init__": [[12, 16], ["base.BaseTransform.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "l", "=", "480", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "crop_height", "=", "l", "\n", "self", ".", "crop_width", "=", "l", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.ResizeTrans.transform": [[17, 43], ["torch.interpolate", "torch.interpolate", "clicks_lists_resized.append", "len", "click.copy"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy"], ["", "def", "transform", "(", "self", ",", "image_nd", ",", "clicks_lists", ")", ":", "\n", "        ", "assert", "image_nd", ".", "shape", "[", "0", "]", "==", "1", "and", "len", "(", "clicks_lists", ")", "==", "1", "\n", "image_height", ",", "image_width", "=", "image_nd", ".", "shape", "[", "2", ":", "4", "]", "\n", "self", ".", "image_height", "=", "image_height", "\n", "self", ".", "image_width", "=", "image_width", "\n", "#image_np = np.transpose( image_nd[0].numpy(), (1,2,0)).astype(np.uint8)", "\n", "#image_np_r = cv2.resize( image_np, (self.crop_width, self.crop_height))", "\n", "#image_nd_r = torch.from_numpy(image_np_r).unsqueeze(0).permute(0,3,1,2).float()", "\n", "image_nd_r", "=", "F", ".", "interpolate", "(", "image_nd", ",", "(", "self", ".", "crop_height", ",", "self", ".", "crop_width", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "y_ratio", "=", "self", ".", "crop_height", "/", "image_height", "\n", "x_ratio", "=", "self", ".", "crop_width", "/", "image_width", "\n", "\n", "#clicks_list = clicks_lists[0]", "\n", "#clicks_lists = []", "\n", "#resize_clicks = [Click(is_positive=x.is_positive, coords=(x.coords[0] * y_ratio, x.coords[1] * x_ratio ))", "\n", "#                       for x in clicks_list]", "\n", "#clicks_lists.append(resize_clicks)", "\n", "\n", "clicks_lists_resized", "=", "[", "]", "\n", "for", "clicks_list", "in", "clicks_lists", ":", "\n", "            ", "clicks_list_resized", "=", "[", "click", ".", "copy", "(", "coords", "=", "(", "click", ".", "coords", "[", "0", "]", "*", "y_ratio", ",", "click", ".", "coords", "[", "1", "]", "*", "x_ratio", ")", ")", "\n", "for", "click", "in", "clicks_list", "]", "\n", "clicks_lists_resized", ".", "append", "(", "clicks_list_resized", ")", "\n", "\n", "", "return", "image_nd_r", ",", "clicks_lists_resized", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.ResizeTrans.inv_transform": [[44, 48], ["torch.interpolate", "torch.interpolate"], "methods", ["None"], ["", "def", "inv_transform", "(", "self", ",", "prob_map", ")", ":", "\n", "        ", "new_prob_map", "=", "F", ".", "interpolate", "(", "prob_map", ",", "(", "self", ".", "image_height", ",", "self", ".", "image_width", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "return", "new_prob_map", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.ResizeTrans.get_state": [[49, 51], ["None"], "methods", ["None"], ["", "def", "get_state", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "x_offsets", ",", "self", ".", "y_offsets", ",", "self", ".", "_counts", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.ResizeTrans.set_state": [[52, 54], ["None"], "methods", ["None"], ["", "def", "set_state", "(", "self", ",", "state", ")", ":", "\n", "        ", "self", ".", "x_offsets", ",", "self", ".", "y_offsets", ",", "self", ".", "_counts", "=", "state", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.ResizeTrans.reset": [[55, 59], ["None"], "methods", ["None"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "self", ".", "x_offsets", "=", "None", "\n", "self", ".", "y_offsets", "=", "None", "\n", "self", ".", "_counts", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.resize.get_offsets": [[61, 80], ["math.ceil", "int", "range", "offsets.append"], "function", ["None"], ["", "", "def", "get_offsets", "(", "length", ",", "crop_size", ",", "min_overlap_ratio", "=", "0.2", ")", ":", "\n", "    ", "if", "length", "==", "crop_size", ":", "\n", "        ", "return", "[", "0", "]", "\n", "\n", "", "N", "=", "(", "length", "/", "crop_size", "-", "min_overlap_ratio", ")", "/", "(", "1", "-", "min_overlap_ratio", ")", "\n", "N", "=", "math", ".", "ceil", "(", "N", ")", "\n", "\n", "overlap_ratio", "=", "(", "N", "-", "length", "/", "crop_size", ")", "/", "(", "N", "-", "1", ")", "\n", "overlap_width", "=", "int", "(", "crop_size", "*", "overlap_ratio", ")", "\n", "\n", "offsets", "=", "[", "0", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "N", ")", ":", "\n", "        ", "new_offset", "=", "offsets", "[", "-", "1", "]", "+", "crop_size", "-", "overlap_width", "\n", "if", "new_offset", "+", "crop_size", ">", "length", ":", "\n", "            ", "new_offset", "=", "length", "-", "crop_size", "\n", "\n", "", "offsets", ".", "append", "(", "new_offset", ")", "\n", "\n", "", "return", "offsets", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.__init__": [[11, 30], ["base.BaseTransform.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "\n", "target_size", "=", "480", ",", "\n", "skip_clicks", "=", "1", ",", "\n", "expansion_ratio", "=", "1.4", ",", "\n", "min_crop_size", "=", "10", ",", "#200", "\n", "recompute_thresh_iou", "=", "0.5", ",", "\n", "prob_thresh", "=", "0.49", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "target_size", "=", "target_size", "\n", "self", ".", "min_crop_size", "=", "min_crop_size", "\n", "self", ".", "skip_clicks", "=", "skip_clicks", "\n", "self", ".", "expansion_ratio", "=", "expansion_ratio", "\n", "self", ".", "recompute_thresh_iou", "=", "recompute_thresh_iou", "\n", "self", ".", "prob_thresh", "=", "prob_thresh", "\n", "\n", "self", ".", "_input_image_shape", "=", "None", "\n", "self", ".", "_prev_probs", "=", "None", "\n", "self", ".", "_object_roi", "=", "None", "\n", "self", ".", "_roi_image", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.transform": [[31, 72], ["zoom_in.get_roi_image_nd", "len", "print", "zoom_in.ZoomIn._transform_clicks", "zoom_in.ZoomIn._roi_image.to", "len", "current_pred_mask.sum", "zoom_in.get_object_roi", "zoom_in.check_object_roi", "isegm.utils.misc.get_bbox_iou"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.get_roi_image_nd", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn._transform_clicks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.get_object_roi", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.check_object_roi", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_iou"], ["", "def", "transform", "(", "self", ",", "image_nd", ",", "clicks_lists", ":", "List", "[", "List", "[", "Click", "]", "]", ")", ":", "\n", "        ", "assert", "image_nd", ".", "shape", "[", "0", "]", "==", "1", "and", "len", "(", "clicks_lists", ")", "==", "1", "\n", "self", ".", "image_changed", "=", "False", "\n", "\n", "clicks_list", "=", "clicks_lists", "[", "0", "]", "\n", "if", "len", "(", "clicks_list", ")", "<=", "self", ".", "skip_clicks", ":", "\n", "            ", "return", "image_nd", ",", "clicks_lists", "\n", "\n", "", "self", ".", "_input_image_shape", "=", "image_nd", ".", "shape", "\n", "\n", "current_object_roi", "=", "None", "\n", "if", "self", ".", "_prev_probs", "is", "not", "None", ":", "\n", "            ", "current_pred_mask", "=", "(", "self", ".", "_prev_probs", ">", "self", ".", "prob_thresh", ")", "[", "0", ",", "0", "]", "\n", "if", "current_pred_mask", ".", "sum", "(", ")", ">", "0", ":", "\n", "                ", "current_object_roi", "=", "get_object_roi", "(", "current_pred_mask", ",", "clicks_list", ",", "\n", "self", ".", "expansion_ratio", ",", "self", ".", "min_crop_size", ")", "\n", "", "", "else", ":", "\n", "            ", "print", "(", "'None'", ")", "\n", "\n", "", "if", "current_object_roi", "is", "None", ":", "\n", "            ", "if", "self", ".", "skip_clicks", ">=", "0", ":", "\n", "                ", "return", "image_nd", ",", "clicks_lists", "\n", "", "else", ":", "\n", "                ", "current_object_roi", "=", "0", ",", "image_nd", ".", "shape", "[", "2", "]", "-", "1", ",", "0", ",", "image_nd", ".", "shape", "[", "3", "]", "-", "1", "\n", "\n", "# here", "\n", "", "", "update_object_roi", "=", "True", "\n", "if", "self", ".", "_object_roi", "is", "None", ":", "\n", "            ", "update_object_roi", "=", "True", "\n", "", "elif", "not", "check_object_roi", "(", "self", ".", "_object_roi", ",", "clicks_list", ")", ":", "\n", "            ", "update_object_roi", "=", "True", "\n", "", "elif", "get_bbox_iou", "(", "current_object_roi", ",", "self", ".", "_object_roi", ")", "<", "self", ".", "recompute_thresh_iou", ":", "\n", "            ", "update_object_roi", "=", "True", "\n", "\n", "", "if", "update_object_roi", ":", "\n", "            ", "self", ".", "_object_roi", "=", "current_object_roi", "\n", "self", ".", "image_changed", "=", "True", "\n", "", "self", ".", "_roi_image", "=", "get_roi_image_nd", "(", "image_nd", ",", "self", ".", "_object_roi", ",", "self", ".", "target_size", ")", "\n", "\n", "tclicks_lists", "=", "[", "self", ".", "_transform_clicks", "(", "clicks_list", ")", "]", "\n", "return", "self", ".", "_roi_image", ".", "to", "(", "image_nd", ".", "device", ")", ",", "tclicks_lists", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.inv_transform": [[73, 95], ["torch.nn.functional.interpolate", "torch.zeros.cpu().numpy", "torch.nn.functional.interpolate.cpu().numpy", "torch.zeros", "torch.zeros.cpu", "torch.nn.functional.interpolate.cpu"], "methods", ["None"], ["", "def", "inv_transform", "(", "self", ",", "prob_map", ")", ":", "\n", "        ", "if", "self", ".", "_object_roi", "is", "None", ":", "\n", "            ", "self", ".", "_prev_probs", "=", "prob_map", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "return", "prob_map", "\n", "\n", "", "assert", "prob_map", ".", "shape", "[", "0", "]", "==", "1", "\n", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "=", "self", ".", "_object_roi", "\n", "prob_map", "=", "torch", ".", "nn", ".", "functional", ".", "interpolate", "(", "prob_map", ",", "size", "=", "(", "rmax", "-", "rmin", "+", "1", ",", "cmax", "-", "cmin", "+", "1", ")", ",", "\n", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "\n", "\n", "if", "self", ".", "_prev_probs", "is", "not", "None", ":", "\n", "            ", "new_prob_map", "=", "torch", ".", "zeros", "(", "*", "self", ".", "_prev_probs", ".", "shape", ",", "device", "=", "prob_map", ".", "device", ",", "dtype", "=", "prob_map", ".", "dtype", ")", "\n", "new_prob_map", "[", ":", ",", ":", ",", "rmin", ":", "rmax", "+", "1", ",", "cmin", ":", "cmax", "+", "1", "]", "=", "prob_map", "\n", "#new_prob_map[:, :, rmin:rmax, cmin:cmax] = prob_map", "\n", "", "else", ":", "\n", "            ", "new_prob_map", "=", "prob_map", "\n", "\n", "", "self", ".", "_prev_probs", "=", "new_prob_map", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "\n", "\n", "return", "new_prob_map", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.check_possible_recalculation": [[96, 108], ["pred_mask.sum", "zoom_in.get_object_roi", "isegm.utils.misc.get_bbox_iou"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.get_object_roi", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_iou"], ["", "def", "check_possible_recalculation", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "_prev_probs", "is", "None", "or", "self", ".", "_object_roi", "is", "not", "None", "or", "self", ".", "skip_clicks", ">", "0", ":", "\n", "            ", "return", "False", "\n", "\n", "", "pred_mask", "=", "(", "self", ".", "_prev_probs", ">", "self", ".", "prob_thresh", ")", "[", "0", ",", "0", "]", "\n", "if", "pred_mask", ".", "sum", "(", ")", ">", "0", ":", "\n", "            ", "possible_object_roi", "=", "get_object_roi", "(", "pred_mask", ",", "[", "]", ",", "\n", "self", ".", "expansion_ratio", ",", "self", ".", "min_crop_size", ")", "\n", "image_roi", "=", "(", "0", ",", "self", ".", "_input_image_shape", "[", "2", "]", "-", "1", ",", "0", ",", "self", ".", "_input_image_shape", "[", "3", "]", "-", "1", ")", "\n", "if", "get_bbox_iou", "(", "possible_object_roi", ",", "image_roi", ")", "<", "0.50", ":", "\n", "                ", "return", "True", "\n", "", "", "return", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.get_state": [[109, 112], ["zoom_in.ZoomIn._roi_image.cpu"], "methods", ["None"], ["", "def", "get_state", "(", "self", ")", ":", "\n", "        ", "roi_image", "=", "self", ".", "_roi_image", ".", "cpu", "(", ")", "if", "self", ".", "_roi_image", "is", "not", "None", "else", "None", "\n", "return", "self", ".", "_input_image_shape", ",", "self", ".", "_object_roi", ",", "self", ".", "_prev_probs", ",", "roi_image", ",", "self", ".", "image_changed", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.set_state": [[113, 115], ["None"], "methods", ["None"], ["", "def", "set_state", "(", "self", ",", "state", ")", ":", "\n", "        ", "self", ".", "_input_image_shape", ",", "self", ".", "_object_roi", ",", "self", ".", "_prev_probs", ",", "self", ".", "_roi_image", ",", "self", ".", "image_changed", "=", "state", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn.reset": [[116, 122], ["None"], "methods", ["None"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "self", ".", "_input_image_shape", "=", "None", "\n", "self", ".", "_object_roi", "=", "None", "\n", "self", ".", "_prev_probs", "=", "None", "\n", "self", ".", "_roi_image", "=", "None", "\n", "self", ".", "image_changed", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.ZoomIn._transform_clicks": [[123, 136], ["transformed_clicks.append", "click.copy"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy"], ["", "def", "_transform_clicks", "(", "self", ",", "clicks_list", ")", ":", "\n", "        ", "if", "self", ".", "_object_roi", "is", "None", ":", "\n", "            ", "return", "clicks_list", "\n", "\n", "", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "=", "self", ".", "_object_roi", "\n", "crop_height", ",", "crop_width", "=", "self", ".", "_roi_image", ".", "shape", "[", "2", ":", "]", "\n", "\n", "transformed_clicks", "=", "[", "]", "\n", "for", "click", "in", "clicks_list", ":", "\n", "            ", "new_r", "=", "crop_height", "*", "(", "click", ".", "coords", "[", "0", "]", "-", "rmin", ")", "/", "(", "rmax", "-", "rmin", "+", "1", ")", "\n", "new_c", "=", "crop_width", "*", "(", "click", ".", "coords", "[", "1", "]", "-", "cmin", ")", "/", "(", "cmax", "-", "cmin", "+", "1", ")", "\n", "transformed_clicks", ".", "append", "(", "click", ".", "copy", "(", "coords", "=", "(", "new_r", ",", "new_c", ")", ")", ")", "\n", "", "return", "transformed_clicks", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.get_object_roi": [[138, 151], ["pred_mask.copy.copy", "isegm.utils.misc.get_bbox_from_mask", "isegm.utils.misc.expand_bbox", "isegm.utils.misc.clamp_bbox", "int", "int"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.expand_bbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.clamp_bbox"], ["", "", "def", "get_object_roi", "(", "pred_mask", ",", "clicks_list", ",", "expansion_ratio", ",", "min_crop_size", ")", ":", "\n", "    ", "pred_mask", "=", "pred_mask", ".", "copy", "(", ")", "\n", "\n", "for", "click", "in", "clicks_list", ":", "\n", "        ", "if", "click", ".", "is_positive", ":", "\n", "            ", "pred_mask", "[", "int", "(", "click", ".", "coords", "[", "0", "]", ")", ",", "int", "(", "click", ".", "coords", "[", "1", "]", ")", "]", "=", "1", "\n", "\n", "", "", "bbox", "=", "get_bbox_from_mask", "(", "pred_mask", ")", "\n", "bbox", "=", "expand_bbox", "(", "bbox", ",", "expansion_ratio", ",", "min_crop_size", ")", "\n", "h", ",", "w", "=", "pred_mask", ".", "shape", "[", "0", "]", ",", "pred_mask", ".", "shape", "[", "1", "]", "\n", "bbox", "=", "clamp_bbox", "(", "bbox", ",", "0", ",", "h", "-", "1", ",", "0", ",", "w", "-", "1", ")", "\n", "\n", "return", "bbox", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.get_roi_image_nd": [[153, 172], ["isinstance", "int", "int", "torch.no_grad", "max", "round", "round"], "function", ["None"], ["", "def", "get_roi_image_nd", "(", "image_nd", ",", "object_roi", ",", "target_size", ")", ":", "\n", "    ", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "=", "object_roi", "\n", "\n", "height", "=", "rmax", "-", "rmin", "+", "1", "\n", "width", "=", "cmax", "-", "cmin", "+", "1", "\n", "\n", "if", "isinstance", "(", "target_size", ",", "tuple", ")", ":", "\n", "        ", "new_height", ",", "new_width", "=", "target_size", "\n", "", "else", ":", "\n", "        ", "scale", "=", "target_size", "/", "max", "(", "height", ",", "width", ")", "\n", "new_height", "=", "int", "(", "round", "(", "height", "*", "scale", ")", ")", "\n", "new_width", "=", "int", "(", "round", "(", "width", "*", "scale", ")", ")", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "roi_image_nd", "=", "image_nd", "[", ":", ",", ":", ",", "rmin", ":", "rmax", "+", "1", ",", "cmin", ":", "cmax", "+", "1", "]", "\n", "#roi_image_nd = torch.nn.functional.interpolate(roi_image_nd, size=(new_height, new_width),", "\n", "#                                               mode='bilinear', align_corners=True)", "\n", "\n", "", "return", "roi_image_nd", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.transforms.zoom_in.check_object_roi": [[174, 183], ["None"], "function", ["None"], ["", "def", "check_object_roi", "(", "object_roi", ",", "clicks_list", ")", ":", "\n", "    ", "for", "click", "in", "clicks_list", ":", "\n", "        ", "if", "click", ".", "is_positive", ":", "\n", "            ", "if", "click", ".", "coords", "[", "0", "]", "<", "object_roi", "[", "0", "]", "or", "click", ".", "coords", "[", "0", "]", ">=", "object_roi", "[", "1", "]", ":", "\n", "                ", "return", "False", "\n", "", "if", "click", ".", "coords", "[", "1", "]", "<", "object_roi", "[", "2", "]", "or", "click", ".", "coords", "[", "1", "]", ">=", "object_roi", "[", "3", "]", ":", "\n", "                ", "return", "False", "\n", "\n", "", "", "", "return", "True", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.UniformRandomResize.__init__": [[13, 17], ["albumentations.DualTransform.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "scale_range", "=", "(", "0.9", ",", "1.1", ")", ",", "interpolation", "=", "cv2", ".", "INTER_LINEAR", ",", "always_apply", "=", "False", ",", "p", "=", "1", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "always_apply", ",", "p", ")", "\n", "self", ".", "scale_range", "=", "scale_range", "\n", "self", ".", "interpolation", "=", "interpolation", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.UniformRandomResize.get_params_dependent_on_targets": [[18, 23], ["random.uniform", "int", "int", "round", "round"], "methods", ["None"], ["", "def", "get_params_dependent_on_targets", "(", "self", ",", "params", ")", ":", "\n", "        ", "scale", "=", "random", ".", "uniform", "(", "*", "self", ".", "scale_range", ")", "\n", "height", "=", "int", "(", "round", "(", "params", "[", "'image'", "]", ".", "shape", "[", "0", "]", "*", "scale", ")", ")", "\n", "width", "=", "int", "(", "round", "(", "params", "[", "'image'", "]", ".", "shape", "[", "1", "]", "*", "scale", ")", ")", "\n", "return", "{", "'new_height'", ":", "height", ",", "'new_width'", ":", "width", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.UniformRandomResize.apply": [[24, 26], ["albumentations.augmentations.functional.resize"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "def", "apply", "(", "self", ",", "img", ",", "new_height", "=", "0", ",", "new_width", "=", "0", ",", "interpolation", "=", "cv2", ".", "INTER_LINEAR", ",", "**", "params", ")", ":", "\n", "        ", "return", "F", ".", "resize", "(", "img", ",", "height", "=", "new_height", ",", "width", "=", "new_width", ",", "interpolation", "=", "interpolation", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.UniformRandomResize.apply_to_keypoint": [[27, 31], ["albumentations.augmentations.functional.keypoint_scale"], "methods", ["None"], ["", "def", "apply_to_keypoint", "(", "self", ",", "keypoint", ",", "new_height", "=", "0", ",", "new_width", "=", "0", ",", "**", "params", ")", ":", "\n", "        ", "scale_x", "=", "new_width", "/", "params", "[", "\"cols\"", "]", "\n", "scale_y", "=", "new_height", "/", "params", "[", "\"rows\"", "]", "\n", "return", "F", ".", "keypoint_scale", "(", "keypoint", ",", "scale_x", ",", "scale_y", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.UniformRandomResize.get_transform_init_args_names": [[32, 34], ["None"], "methods", ["None"], ["", "def", "get_transform_init_args_names", "(", "self", ")", ":", "\n", "        ", "return", "\"scale_range\"", ",", "\"interpolation\"", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.UniformRandomResize.targets_as_params": [[35, 38], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "targets_as_params", "(", "self", ")", ":", "\n", "        ", "return", "[", "\"image\"", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.__init__": [[41, 61], ["albumentations.DualTransform.__init__", "albumentations.core.transforms_interface.to_tuple"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "height", ",", "\n", "width", ",", "\n", "bbox_jitter", "=", "0.1", ",", "\n", "expansion_ratio", "=", "1.4", ",", "\n", "min_crop_size", "=", "200", ",", "\n", "min_area", "=", "100", ",", "\n", "always_resize", "=", "False", ",", "\n", "always_apply", "=", "False", ",", "\n", "p", "=", "0.5", ",", "\n", ")", ":", "\n", "        ", "super", "(", "ZoomIn", ",", "self", ")", ".", "__init__", "(", "always_apply", ",", "p", ")", "\n", "self", ".", "height", "=", "height", "\n", "self", ".", "width", "=", "width", "\n", "self", ".", "bbox_jitter", "=", "to_tuple", "(", "bbox_jitter", ")", "\n", "self", ".", "expansion_ratio", "=", "expansion_ratio", "\n", "self", ".", "min_crop_size", "=", "min_crop_size", "\n", "self", ".", "min_area", "=", "min_area", "\n", "self", ".", "always_resize", "=", "always_resize", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply": [[62, 73], ["albumentations.augmentations.functional.resize", "albumentations.augmentations.functional.resize"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "def", "apply", "(", "self", ",", "img", ",", "selected_object", ",", "bbox", ",", "**", "params", ")", ":", "\n", "        ", "if", "selected_object", "is", "None", ":", "\n", "            ", "if", "self", ".", "always_resize", ":", "\n", "                ", "img", "=", "F", ".", "resize", "(", "img", ",", "height", "=", "self", ".", "height", ",", "width", "=", "self", ".", "width", ")", "\n", "", "return", "img", "\n", "\n", "", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "=", "bbox", "\n", "img", "=", "img", "[", "rmin", ":", "rmax", "+", "1", ",", "cmin", ":", "cmax", "+", "1", "]", "\n", "img", "=", "F", ".", "resize", "(", "img", ",", "height", "=", "self", ".", "height", ",", "width", "=", "self", ".", "width", ")", "\n", "\n", "return", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply_to_mask": [[74, 96], ["isinstance", "albumentations.augmentations.functional.resize", "numpy.zeros_like", "albumentations.augmentations.functional.resize.copy", "albumentations.augmentations.functional.resize", "numpy.logical_not"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.clicker.Click.copy", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "def", "apply_to_mask", "(", "self", ",", "mask", ",", "selected_object", ",", "bbox", ",", "**", "params", ")", ":", "\n", "        ", "if", "selected_object", "is", "None", ":", "\n", "            ", "if", "self", ".", "always_resize", ":", "\n", "                ", "mask", "=", "F", ".", "resize", "(", "mask", ",", "height", "=", "self", ".", "height", ",", "width", "=", "self", ".", "width", ",", "\n", "interpolation", "=", "cv2", ".", "INTER_NEAREST", ")", "\n", "", "return", "mask", "\n", "\n", "", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "=", "bbox", "\n", "mask", "=", "mask", "[", "rmin", ":", "rmax", "+", "1", ",", "cmin", ":", "cmax", "+", "1", "]", "\n", "if", "isinstance", "(", "selected_object", ",", "tuple", ")", ":", "\n", "            ", "layer_indx", ",", "mask_id", "=", "selected_object", "\n", "obj_mask", "=", "mask", "[", ":", ",", ":", ",", "layer_indx", "]", "==", "mask_id", "\n", "new_mask", "=", "np", ".", "zeros_like", "(", "mask", ")", "\n", "new_mask", "[", ":", ",", ":", ",", "layer_indx", "]", "[", "obj_mask", "]", "=", "mask_id", "\n", "", "else", ":", "\n", "            ", "obj_mask", "=", "mask", "==", "selected_object", "\n", "new_mask", "=", "mask", ".", "copy", "(", ")", "\n", "new_mask", "[", "np", ".", "logical_not", "(", "obj_mask", ")", "]", "=", "0", "\n", "\n", "", "new_mask", "=", "F", ".", "resize", "(", "new_mask", ",", "height", "=", "self", ".", "height", ",", "width", "=", "self", ".", "width", ",", "\n", "interpolation", "=", "cv2", ".", "INTER_NEAREST", ")", "\n", "return", "new_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.get_params_dependent_on_targets": [[97, 137], ["len", "range", "isegm.utils.misc.get_labels_with_sizes", "random.choice", "isegm.utils.misc.get_bbox_from_mask", "isinstance", "isegm.utils.misc.expand_bbox", "transforms.ZoomIn._jitter_bbox", "isegm.utils.misc.clamp_bbox", "isegm.utils.misc.get_labels_with_sizes", "candidates.extend", "random.uniform", "zip", "zip"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_labels_with_sizes", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.expand_bbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn._jitter_bbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.clamp_bbox", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_labels_with_sizes"], ["", "def", "get_params_dependent_on_targets", "(", "self", ",", "params", ")", ":", "\n", "        ", "instances", "=", "params", "[", "'mask'", "]", "\n", "\n", "is_mask_layer", "=", "len", "(", "instances", ".", "shape", ")", ">", "2", "\n", "candidates", "=", "[", "]", "\n", "if", "is_mask_layer", ":", "\n", "            ", "for", "layer_indx", "in", "range", "(", "instances", ".", "shape", "[", "2", "]", ")", ":", "\n", "                ", "labels", ",", "areas", "=", "get_labels_with_sizes", "(", "instances", "[", ":", ",", ":", ",", "layer_indx", "]", ")", "\n", "candidates", ".", "extend", "(", "[", "(", "layer_indx", ",", "obj_id", ")", "\n", "for", "obj_id", ",", "area", "in", "zip", "(", "labels", ",", "areas", ")", "\n", "if", "area", ">", "self", ".", "min_area", "]", ")", "\n", "", "", "else", ":", "\n", "            ", "labels", ",", "areas", "=", "get_labels_with_sizes", "(", "instances", ")", "\n", "candidates", "=", "[", "obj_id", "for", "obj_id", ",", "area", "in", "zip", "(", "labels", ",", "areas", ")", "\n", "if", "area", ">", "self", ".", "min_area", "]", "\n", "\n", "", "selected_object", "=", "None", "\n", "bbox", "=", "None", "\n", "if", "candidates", ":", "\n", "            ", "selected_object", "=", "random", ".", "choice", "(", "candidates", ")", "\n", "if", "is_mask_layer", ":", "\n", "                ", "layer_indx", ",", "mask_id", "=", "selected_object", "\n", "obj_mask", "=", "instances", "[", ":", ",", ":", ",", "layer_indx", "]", "==", "mask_id", "\n", "", "else", ":", "\n", "                ", "obj_mask", "=", "instances", "==", "selected_object", "\n", "\n", "", "bbox", "=", "get_bbox_from_mask", "(", "obj_mask", ")", "\n", "\n", "if", "isinstance", "(", "self", ".", "expansion_ratio", ",", "tuple", ")", ":", "\n", "                ", "expansion_ratio", "=", "random", ".", "uniform", "(", "*", "self", ".", "expansion_ratio", ")", "\n", "", "else", ":", "\n", "                ", "expansion_ratio", "=", "self", ".", "expansion_ratio", "\n", "\n", "", "bbox", "=", "expand_bbox", "(", "bbox", ",", "expansion_ratio", ",", "self", ".", "min_crop_size", ")", "\n", "bbox", "=", "self", ".", "_jitter_bbox", "(", "bbox", ")", "\n", "bbox", "=", "clamp_bbox", "(", "bbox", ",", "0", ",", "obj_mask", ".", "shape", "[", "0", "]", "-", "1", ",", "0", ",", "obj_mask", ".", "shape", "[", "1", "]", "-", "1", ")", "\n", "\n", "", "return", "{", "\n", "'selected_object'", ":", "selected_object", ",", "\n", "'bbox'", ":", "bbox", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn._jitter_bbox": [[139, 149], ["int", "int", "int", "int", "random.uniform", "random.uniform", "random.uniform", "random.uniform"], "methods", ["None"], ["", "def", "_jitter_bbox", "(", "self", ",", "bbox", ")", ":", "\n", "        ", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "=", "bbox", "\n", "height", "=", "rmax", "-", "rmin", "+", "1", "\n", "width", "=", "cmax", "-", "cmin", "+", "1", "\n", "rmin", "=", "int", "(", "rmin", "+", "random", ".", "uniform", "(", "*", "self", ".", "bbox_jitter", ")", "*", "height", ")", "\n", "rmax", "=", "int", "(", "rmax", "+", "random", ".", "uniform", "(", "*", "self", ".", "bbox_jitter", ")", "*", "height", ")", "\n", "cmin", "=", "int", "(", "cmin", "+", "random", ".", "uniform", "(", "*", "self", ".", "bbox_jitter", ")", "*", "width", ")", "\n", "cmax", "=", "int", "(", "cmax", "+", "random", ".", "uniform", "(", "*", "self", ".", "bbox_jitter", ")", "*", "width", ")", "\n", "\n", "return", "rmin", ",", "rmax", ",", "cmin", ",", "cmax", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply_to_bbox": [[150, 152], ["None"], "methods", ["None"], ["", "def", "apply_to_bbox", "(", "self", ",", "bbox", ",", "**", "params", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply_to_keypoint": [[153, 155], ["None"], "methods", ["None"], ["", "def", "apply_to_keypoint", "(", "self", ",", "keypoint", ",", "**", "params", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.targets_as_params": [[156, 159], ["None"], "methods", ["None"], ["", "@", "property", "\n", "def", "targets_as_params", "(", "self", ")", ":", "\n", "        ", "return", "[", "\"mask\"", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.get_transform_init_args_names": [[160, 163], ["None"], "methods", ["None"], ["", "def", "get_transform_init_args_names", "(", "self", ")", ":", "\n", "        ", "return", "(", "\"height\"", ",", "\"width\"", ",", "\"bbox_jitter\"", ",", "\n", "\"expansion_ratio\"", ",", "\"min_crop_size\"", ",", "\"min_area\"", ",", "\"always_resize\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.remove_image_only_transforms": [[165, 179], ["keep_transforms.append", "transforms.remove_image_only_transforms", "issubclass", "keep_transforms.append"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.remove_image_only_transforms"], ["", "", "def", "remove_image_only_transforms", "(", "sdict", ")", ":", "\n", "    ", "if", "not", "'transforms'", "in", "sdict", ":", "\n", "        ", "return", "sdict", "\n", "\n", "", "keep_transforms", "=", "[", "]", "\n", "for", "tdict", "in", "sdict", "[", "'transforms'", "]", ":", "\n", "        ", "cls", "=", "SERIALIZABLE_REGISTRY", "[", "tdict", "[", "'__class_fullname__'", "]", "]", "\n", "if", "'transforms'", "in", "tdict", ":", "\n", "            ", "keep_transforms", ".", "append", "(", "remove_image_only_transforms", "(", "tdict", ")", ")", "\n", "", "elif", "not", "issubclass", "(", "cls", ",", "ImageOnlyTransform", ")", ":", "\n", "            ", "keep_transforms", ".", "append", "(", "tdict", ")", "\n", "", "", "sdict", "[", "'transforms'", "]", "=", "keep_transforms", "\n", "\n", "return", "sdict", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.__init__": [[13, 34], ["points_sampler.MultiPointSampler", "super().__init__", "base.ISDataset._load_samples_scores", "torchvision.transforms.ToTensor"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset._load_samples_scores"], ["        ", "self", ".", "with_flip", "=", "with_flip", "\n", "self", ".", "net_clicks_limit", "=", "net_clicks_limit", "\n", "self", ".", "original_image", "=", "None", "\n", "self", ".", "device", "=", "device", "\n", "self", ".", "zoom_in", "=", "zoom_in", "\n", "self", ".", "prev_prediction", "=", "None", "\n", "self", ".", "model_indx", "=", "0", "\n", "self", ".", "click_models", "=", "None", "\n", "self", ".", "net_state_dict", "=", "None", "\n", "\n", "if", "isinstance", "(", "model", ",", "tuple", ")", ":", "\n", "            ", "self", ".", "net", ",", "self", ".", "click_models", "=", "model", "\n", "", "else", ":", "\n", "            ", "self", ".", "net", "=", "model", "\n", "\n", "", "self", ".", "to_tensor", "=", "transforms", ".", "ToTensor", "(", ")", "\n", "\n", "self", ".", "transforms", "=", "[", "zoom_in", "]", "if", "zoom_in", "is", "not", "None", "else", "[", "]", "\n", "if", "max_size", "is", "not", "None", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "LimitLongestSide", "(", "max_size", "=", "max_size", ")", ")", "\n", "", "self", ".", "crop_l", "=", "256", "\n", "self", ".", "transforms", ".", "append", "(", "ResizeTrans", "(", "self", ".", "crop_l", ")", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.__getitem__": [[35, 121], ["base.ISDataset.get_sample", "base.ISDataset.augment_sample", "base.ISDataset.remove_small_objects", "base.ISDataset.points_sampler.sample_object", "numpy.array", "base.ISDataset.remove_small_regions", "numpy.random.choice", "base.ISDataset.points_sampler.sample_points", "base.ISDataset.get_trimap", "torch.tensor", "cv2.resize", "numpy.expand_dims().astype", "numpy.expand_dims().astype", "numpy.array", "numpy.array", "numpy.random.randint", "random.randrange", "mask[].sum", "base.ISDataset.sampling_roi_full_object", "cv2.resize", "cv2.resize", "numpy.random.randint", "numpy.random.randint", "len", "numpy.random.rand", "base.ISDataset.sampling_roi_on_boundary", "base.ISDataset.sampling_roi_full_object", "numpy.expand_dims", "numpy.expand_dims", "base.ISDataset.sum", "base.ISDataset.sum", "base.ISDataset.to_tensor", "numpy.array.astype", "base.ISDataset.to_tensor", "points_focus.astype", "torch.tensor.float", "base.ISDataset.sum", "base.ISDataset.sum", "base.ISDataset.to_tensor", "numpy.array.astype", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_sample", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.augment_sample", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.remove_small_objects", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler.sample_object", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.remove_small_regions", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler.sample_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_trimap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.sampling_roi_full_object", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.sampling_roi_on_boundary", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.sampling_roi_full_object"], ["self", ".", "transforms", ".", "append", "(", "SigmoidForPred", "(", ")", ")", "\n", "self", ".", "focus_roi", "=", "(", "0", ",", "10", ",", "0", ",", "10", ")", "\n", "self", ".", "global_roi", "=", "(", "0", ",", "10", ",", "0", ",", "10", ")", "\n", "\n", "self", ".", "with_flip", "=", "True", "\n", "if", "self", ".", "with_flip", ":", "\n", "            ", "self", ".", "transforms", ".", "append", "(", "AddHorizontalFlip", "(", ")", ")", "\n", "\n", "", "", "def", "set_input_image", "(", "self", ",", "image", ")", ":", "\n", "        ", "image_nd", "=", "self", ".", "to_tensor", "(", "image", ")", "\n", "for", "transform", "in", "self", ".", "transforms", ":", "\n", "            ", "transform", ".", "reset", "(", ")", "\n", "", "self", ".", "original_image", "=", "image_nd", ".", "to", "(", "self", ".", "device", ")", "\n", "if", "len", "(", "self", ".", "original_image", ".", "shape", ")", "==", "3", ":", "\n", "            ", "self", ".", "original_image", "=", "self", ".", "original_image", ".", "unsqueeze", "(", "0", ")", "\n", "", "self", ".", "prev_prediction", "=", "torch", ".", "zeros_like", "(", "self", ".", "original_image", "[", ":", ",", ":", "1", ",", ":", ",", ":", "]", ")", "\n", "\n", "", "def", "set_prev_mask", "(", "self", ",", "mask", ")", ":", "\n", "        ", "self", ".", "prev_prediction", "=", "torch", ".", "from_numpy", "(", "mask", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "to", "(", "self", ".", "device", ")", ".", "float", "(", ")", "\n", "\n", "", "def", "get_prediction", "(", "self", ",", "clicker", ",", "prev_mask", "=", "None", ")", ":", "\n", "        ", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "click", "=", "clicks_list", "[", "-", "1", "]", "\n", "last_y", ",", "last_x", "=", "click", ".", "coords", "[", "0", "]", ",", "click", ".", "coords", "[", "1", "]", "\n", "self", ".", "last_y", "=", "last_y", "\n", "self", ".", "last_x", "=", "last_x", "\n", "\n", "if", "self", ".", "click_models", "is", "not", "None", ":", "\n", "            ", "model_indx", "=", "min", "(", "clicker", ".", "click_indx_offset", "+", "len", "(", "clicks_list", ")", ",", "len", "(", "self", ".", "click_models", ")", ")", "-", "1", "\n", "if", "model_indx", "!=", "self", ".", "model_indx", ":", "\n", "                ", "self", ".", "model_indx", "=", "model_indx", "\n", "self", ".", "net", "=", "self", ".", "click_models", "[", "model_indx", "]", "\n", "\n", "", "", "input_image", "=", "self", ".", "original_image", "\n", "if", "prev_mask", "is", "None", ":", "\n", "            ", "prev_mask", "=", "self", ".", "prev_prediction", "\n", "", "if", "hasattr", "(", "self", ".", "net", ",", "'with_prev_mask'", ")", "and", "self", ".", "net", ".", "with_prev_mask", ":", "\n", "            ", "input_image", "=", "torch", ".", "cat", "(", "(", "input_image", ",", "prev_mask", ")", ",", "dim", "=", "1", ")", "\n", "\n", "\n", "\n", "", "image_nd", ",", "clicks_lists", ",", "is_image_changed", "=", "self", ".", "apply_transforms", "(", "\n", "input_image", ",", "[", "clicks_list", "]", "\n", ")", "\n", "\n", "try", ":", "\n", "            ", "roi", "=", "self", ".", "transforms", "[", "0", "]", ".", "_object_roi", "\n", "", "except", ":", "\n", "            ", "roi", "=", "None", "\n", "\n", "", "if", "roi", "is", "None", ":", "\n", "            ", "h", ",", "w", "=", "prev_mask", ".", "shape", "[", "-", "2", "]", ",", "prev_mask", ".", "shape", "[", "-", "1", "]", "\n", "global_roi", "=", "(", "0", ",", "h", ",", "0", ",", "w", ")", "\n", "\n", "", "else", ":", "\n", "            ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "roi", "\n", "global_roi", "=", "(", "y1", ",", "y2", "+", "1", ",", "x1", ",", "x2", "+", "1", ")", "\n", "\n", "", "self", ".", "global_roi", "=", "global_roi", "\n", "\n", "\n", "\n", "\n", "pred_logits", ",", "feature", "=", "self", ".", "_get_prediction", "(", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", "\n", "prediction", "=", "F", ".", "interpolate", "(", "pred_logits", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ",", "\n", "size", "=", "image_nd", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "\n", "\n", "for", "t", "in", "reversed", "(", "self", ".", "transforms", ")", ":", "\n", "#if not isinstance(t,SigmoidForPred):", "\n", "            ", "prediction", "=", "t", ".", "inv_transform", "(", "prediction", ")", "\n", "\n", "#if self.zoom_in is not None and self.zoom_in.check_possible_recalculation():", "\n", "#    return self.get_prediction(clicker)", "\n", "\n", "\n", "\n", "#self.prev_prediction = prediction", "\n", "#return prediction.cpu().numpy()[0, 0]", "\n", "\n", "\n", "", "prediction", "=", "torch", ".", "log", "(", "prediction", "/", "(", "1", "-", "prediction", ")", ")", "\n", "coarse_mask", "=", "prediction", "#.cpu().numpy()[0, 0] > 0.49", "\n", "prev_mask", "=", "prev_mask", "#.cpu().numpy()[0, 0] > 0.49", "\n", "clicks_list", "=", "clicker", ".", "get_clicks", "(", ")", "\n", "image_full", "=", "self", ".", "original_image", "\n", "#print(coarse_mask.max(),coarse_mask.min() )", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.remove_small_regions": [[123, 128], ["skimage.morphology.remove_small_objects", "numpy.expand_dims().astype", "numpy.expand_dims"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.remove_small_objects"], ["coarse_mask_np", "=", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "prev_mask_np", "=", "prev_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n", "\n", "if", "len", "(", "clicks_list", ")", ">", "10", ":", "\n", "            ", "progress_mode", "=", "True", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.sampling_roi_full_object": [[130, 136], ["isegm.utils.crop_local.getLargestCC", "isegm.utils.crop_local.get_bbox_from_mask", "isegm.utils.crop_local.expand_bbox_with_bias", "numpy.random.randint"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.getLargestCC", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.expand_bbox_with_bias"], ["            ", "progress_mode", "=", "False", "\n", "\n", "#y1,y2,x1,x2 = get_focus_bbox_all(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x,1.4, progress_mode)", "\n", "#y1,y2,x1,x2 = get_focus_bbox_pp(coarse_mask_np,prev_mask_np, global_roi,last_y,last_x, 1.4, 0)", "\n", "", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "get_focus_bbox_v5", "(", "coarse_mask_np", ",", "prev_mask_np", ",", "global_roi", ",", "last_y", ",", "last_x", ",", "1.4", ",", "0", ")", "\n", "\n", "if", "progress_mode", ":", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.sampling_roi_on_boundary": [[137, 151], ["alpha.astype.astype.astype", "numpy.ones", "cv2.dilate", "numpy.logical_and", "isegm.utils.crop_local.random_choose_target", "numpy.random.randint", "numpy.random.randint", "int", "int", "numpy.logical_not"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.crop_local.random_choose_target"], ["            ", "coarse_mask", "=", "self", ".", "prev_prediction", "\n", "coarse_mask", "=", "torch", ".", "log", "(", "coarse_mask", "/", "(", "1", "-", "coarse_mask", ")", ")", "\n", "\n", "", "focus_roi", "=", "(", "y1", ",", "y2", ",", "x1", ",", "x2", ")", "\n", "self", ".", "focus_roi", "=", "focus_roi", "\n", "focus_roi_in_global_roi", "=", "self", ".", "mapp_roi", "(", "focus_roi", ",", "global_roi", ")", "\n", "focus_pred", "=", "self", ".", "_get_refine", "(", "pred_logits", ",", "image_full", ",", "clicks_list", ",", "feature", ",", "focus_roi", ",", "focus_roi_in_global_roi", ")", "#.cpu().numpy()[0, 0]", "\n", "focus_pred", "=", "F", ".", "interpolate", "(", "focus_pred", ",", "(", "y2", "-", "y1", ",", "x2", "-", "x1", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", "#.cpu().numpy()[0, 0]", "\n", "\n", "coarse_mask", "[", ":", ",", ":", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "=", "focus_pred", "\n", "coarse_mask", "=", "torch", ".", "sigmoid", "(", "coarse_mask", ")", "\n", "\n", "\n", "self", ".", "prev_prediction", "=", "coarse_mask", "\n", "#print(111,self.transforms[0]._prev_probs.sum())", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_trimap": [[153, 167], ["numpy.logical_xor().astype", "numpy.ones", "cv2.dilate", "numpy.expand_dims.astype", "numpy.expand_dims", "cv2.resize", "cv2.resize", "mask_255_small.astype", "numpy.logical_xor"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["#print(222,self.transforms[0]._prev_probs.sum())", "\n", "return", "coarse_mask", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "\n", "\n", "", "def", "_get_prediction", "(", "self", ",", "image_nd", ",", "clicks_lists", ",", "is_image_changed", ")", ":", "\n", "        ", "points_nd", "=", "self", ".", "get_points_nd", "(", "clicks_lists", ")", "\n", "output", "=", "self", ".", "net", "(", "image_nd", ",", "points_nd", ")", "\n", "return", "output", "[", "'instances'", "]", ",", "output", "[", "'feature'", "]", "\n", "\n", "", "def", "_get_refine", "(", "self", ",", "coarse_mask", ",", "image", ",", "clicks", ",", "feature", ",", "focus_roi", ",", "focus_roi_in_global_roi", ")", ":", "\n", "        ", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi", "\n", "image_focus", "=", "image", "[", ":", ",", ":", ",", "y1", ":", "y2", ",", "x1", ":", "x2", "]", "\n", "try", ":", "\n", "            ", "image_focus", "=", "F", ".", "interpolate", "(", "image_focus", ",", "(", "self", ".", "crop_l", ",", "self", ".", "crop_l", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "", "except", ":", "\n", "            ", "ly", ",", "lx", ",", "lin", "=", "clicks", "[", "-", "1", "]", ".", "coords_and_indx", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.augment_sample": [[169, 178], ["sample.augment", "random.random", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.augment"], ["print", "(", "self", ".", "prev_prediction", ".", "shape", ")", "\n", "print", "(", "ly", ",", "lx", ",", "self", ".", "prev_prediction", "[", "0", ",", "0", ",", "ly", ",", "lx", "]", ")", "\n", "\n", "", "mask_focus", "=", "coarse_mask", "\n", "#mask_focus = coarse_mask[:,:,y1:y2,x1:x2]", "\n", "#mask_focus = F.interpolate(mask_focus,(self.crop_l,self.crop_l),mode='bilinear',align_corners=True)", "\n", "\n", "points_nd", "=", "self", ".", "get_points_nd_inbbox", "(", "clicks", ",", "y1", ",", "y2", ",", "x1", ",", "x2", ")", "\n", "y1", ",", "y2", ",", "x1", ",", "x2", "=", "focus_roi_in_global_roi", "\n", "roi", "=", "torch", ".", "tensor", "(", "[", "0", ",", "x1", ",", "y1", ",", "x2", ",", "y2", "]", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ".", "to", "(", "image_focus", ".", "device", ")", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_sample": [[179, 181], ["None"], "methods", ["None"], ["\n", "\n", "pred", "=", "self", ".", "net", ".", "refine", "(", "image_focus", ",", "points_nd", ",", "feature", ",", "mask_focus", ",", "roi", ")", "#['instances_refined'] ", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.__len__": [[182, 187], ["base.ISDataset.get_samples_number"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number"], ["focus_coarse", ",", "focus_refined", "=", "pred", "[", "'instances_coarse'", "]", ",", "pred", "[", "'instances_refined'", "]", "\n", "self", ".", "focus_coarse", "=", "torch", ".", "sigmoid", "(", "focus_coarse", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "self", ".", "focus_refined", "=", "torch", ".", "sigmoid", "(", "focus_refined", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", "0", ",", "0", "]", "*", "255", "\n", "return", "focus_refined", "\n", "\n", "#return self.net.refine(image_focus,points_nd, feature, mask_focus, roi)['instances_coarse'] ", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset.get_samples_number": [[188, 190], ["len"], "methods", ["None"], ["\n", "", "def", "mapp_roi", "(", "self", ",", "focus_roi", ",", "global_roi", ")", ":", "\n", "        ", "yg1", ",", "yg2", ",", "xg1", ",", "xg2", "=", "global_roi", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.base.ISDataset._load_samples_scores": [[191, 207], ["numpy.array", "numpy.array.sum", "print", "open", "pickle.load", "len"], "methods", ["None"], ["hg", ",", "wg", "=", "yg2", "-", "yg1", ",", "xg2", "-", "xg1", "\n", "yf1", ",", "yf2", ",", "xf1", ",", "xf2", "=", "focus_roi", "\n", "\n", "yf1_n", "=", "(", "yf1", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "yf2_n", "=", "(", "yf2", "-", "yg1", ")", "*", "(", "self", ".", "crop_l", "/", "hg", ")", "\n", "xf1_n", "=", "(", "xf1", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "xf2_n", "=", "(", "xf2", "-", "xg1", ")", "*", "(", "self", ".", "crop_l", "/", "wg", ")", "\n", "\n", "yf1_n", "=", "max", "(", "yf1_n", ",", "0", ")", "\n", "yf2_n", "=", "min", "(", "yf2_n", ",", "self", ".", "crop_l", ")", "\n", "xf1_n", "=", "max", "(", "xf1_n", ",", "0", ")", "\n", "xf2_n", "=", "min", "(", "xf2_n", ",", "self", ".", "crop_l", ")", "\n", "return", "(", "yf1_n", ",", "yf2_n", ",", "xf1_n", ",", "xf2_n", ")", "\n", "\n", "\n", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.BasePointSampler.__init__": [[10, 13], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "_selected_mask", "=", "None", "\n", "self", ".", "_selected_masks", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.BasePointSampler.sample_object": [[14, 16], ["None"], "methods", ["None"], ["", "def", "sample_object", "(", "self", ",", "sample", ":", "DSample", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.BasePointSampler.sample_points": [[17, 19], ["None"], "methods", ["None"], ["", "def", "sample_points", "(", "self", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.BasePointSampler.selected_mask": [[25, 28], ["mask[].astype"], "methods", ["None"], ["", "@", "selected_mask", ".", "setter", "\n", "def", "selected_mask", "(", "self", ",", "mask", ")", ":", "\n", "        ", "self", ".", "_selected_mask", "=", "mask", "[", "np", ".", "newaxis", ",", ":", "]", ".", "astype", "(", "np", ".", "float32", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler.__init__": [[31, 62], ["points_sampler.BasePointSampler.__init__", "math.isclose", "points_sampler.generate_probs", "points_sampler.generate_probs", "sum"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.generate_probs", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.generate_probs"], ["    ", "def", "__init__", "(", "self", ",", "max_num_points", ",", "prob_gamma", "=", "0.7", ",", "expand_ratio", "=", "0.1", ",", "\n", "positive_erode_prob", "=", "0.9", ",", "positive_erode_iters", "=", "3", ",", "\n", "negative_bg_prob", "=", "0.1", ",", "negative_other_prob", "=", "0.4", ",", "negative_border_prob", "=", "0.5", ",", "\n", "merge_objects_prob", "=", "0.0", ",", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "soft_targets", "=", "False", ",", "\n", "first_click_center", "=", "False", ",", "only_one_first_click", "=", "False", ",", "\n", "sfc_inner_k", "=", "1.7", ",", "sfc_full_inner_prob", "=", "0.0", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "max_num_points", "=", "max_num_points", "\n", "self", ".", "expand_ratio", "=", "expand_ratio", "\n", "self", ".", "positive_erode_prob", "=", "positive_erode_prob", "\n", "self", ".", "positive_erode_iters", "=", "positive_erode_iters", "\n", "self", ".", "merge_objects_prob", "=", "merge_objects_prob", "\n", "self", ".", "use_hierarchy", "=", "use_hierarchy", "\n", "self", ".", "soft_targets", "=", "soft_targets", "\n", "self", ".", "first_click_center", "=", "first_click_center", "\n", "self", ".", "only_one_first_click", "=", "only_one_first_click", "\n", "self", ".", "sfc_inner_k", "=", "sfc_inner_k", "\n", "self", ".", "sfc_full_inner_prob", "=", "sfc_full_inner_prob", "\n", "\n", "if", "max_num_merged_objects", "==", "-", "1", ":", "\n", "            ", "max_num_merged_objects", "=", "max_num_points", "\n", "", "self", ".", "max_num_merged_objects", "=", "max_num_merged_objects", "\n", "\n", "self", ".", "neg_strategies", "=", "[", "'bg'", ",", "'other'", ",", "'border'", "]", "\n", "self", ".", "neg_strategies_prob", "=", "[", "negative_bg_prob", ",", "negative_other_prob", ",", "negative_border_prob", "]", "\n", "assert", "math", ".", "isclose", "(", "sum", "(", "self", ".", "neg_strategies_prob", ")", ",", "1.0", ")", "\n", "\n", "self", ".", "_pos_probs", "=", "generate_probs", "(", "max_num_points", ",", "gamma", "=", "prob_gamma", ")", "\n", "self", ".", "_neg_probs", "=", "generate_probs", "(", "max_num_points", "+", "1", ",", "gamma", "=", "prob_gamma", ")", "\n", "self", ".", "_neg_masks", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler.sample_object": [[63, 91], ["points_sampler.MultiPointSampler._sample_mask", "numpy.logical_not", "points_sampler.MultiPointSampler._get_border_mask", "len", "sample.get_background_mask", "numpy.zeros_like", "len", "len", "numpy.logical_and", "numpy.logical_not", "numpy.logical_not", "sample.get_background_mask"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._sample_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._get_border_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.get_background_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.get_background_mask"], ["", "def", "sample_object", "(", "self", ",", "sample", ":", "DSample", ")", ":", "\n", "        ", "if", "len", "(", "sample", ")", "==", "0", ":", "\n", "            ", "bg_mask", "=", "sample", ".", "get_background_mask", "(", ")", "\n", "self", ".", "selected_mask", "=", "np", ".", "zeros_like", "(", "bg_mask", ",", "dtype", "=", "np", ".", "float32", ")", "\n", "self", ".", "_selected_masks", "=", "[", "[", "]", "]", "\n", "self", ".", "_neg_masks", "=", "{", "strategy", ":", "bg_mask", "for", "strategy", "in", "self", ".", "neg_strategies", "}", "\n", "self", ".", "_neg_masks", "[", "'required'", "]", "=", "[", "]", "\n", "return", "\n", "\n", "", "gt_mask", ",", "pos_masks", ",", "neg_masks", "=", "self", ".", "_sample_mask", "(", "sample", ")", "\n", "binary_gt_mask", "=", "gt_mask", ">", "0.5", "if", "self", ".", "soft_targets", "else", "gt_mask", ">", "0", "\n", "\n", "self", ".", "selected_mask", "=", "gt_mask", "\n", "self", ".", "_selected_masks", "=", "pos_masks", "\n", "\n", "neg_mask_bg", "=", "np", ".", "logical_not", "(", "binary_gt_mask", ")", "\n", "neg_mask_border", "=", "self", ".", "_get_border_mask", "(", "binary_gt_mask", ")", "\n", "if", "len", "(", "sample", ")", "<=", "len", "(", "self", ".", "_selected_masks", ")", ":", "\n", "            ", "neg_mask_other", "=", "neg_mask_bg", "\n", "", "else", ":", "\n", "            ", "neg_mask_other", "=", "np", ".", "logical_and", "(", "np", ".", "logical_not", "(", "sample", ".", "get_background_mask", "(", ")", ")", ",", "\n", "np", ".", "logical_not", "(", "binary_gt_mask", ")", ")", "\n", "\n", "", "self", ".", "_neg_masks", "=", "{", "\n", "'bg'", ":", "neg_mask_bg", ",", "\n", "'other'", ":", "neg_mask_other", ",", "\n", "'border'", ":", "neg_mask_border", ",", "\n", "'required'", ":", "neg_masks", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._sample_mask": [[93, 120], ["min", "numpy.random.randint", "random.sample", "points_sampler.MultiPointSampler._sample_from_masks_layer", "pos_segments.extend", "neg_segments.extend", "points_sampler.MultiPointSampler._positive_erode", "points_sampler.MultiPointSampler._positive_erode", "len", "random.random", "len", "random.choice", "numpy.maximum"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._sample_from_masks_layer", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._positive_erode", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._positive_erode"], ["", "def", "_sample_mask", "(", "self", ",", "sample", ":", "DSample", ")", ":", "\n", "        ", "root_obj_ids", "=", "sample", ".", "root_objects", "\n", "\n", "if", "len", "(", "root_obj_ids", ")", ">", "1", "and", "random", ".", "random", "(", ")", "<", "self", ".", "merge_objects_prob", ":", "\n", "            ", "max_selected_objects", "=", "min", "(", "len", "(", "root_obj_ids", ")", ",", "self", ".", "max_num_merged_objects", ")", "\n", "num_selected_objects", "=", "np", ".", "random", ".", "randint", "(", "2", ",", "max_selected_objects", "+", "1", ")", "\n", "random_ids", "=", "random", ".", "sample", "(", "root_obj_ids", ",", "num_selected_objects", ")", "\n", "", "else", ":", "\n", "            ", "random_ids", "=", "[", "random", ".", "choice", "(", "root_obj_ids", ")", "]", "\n", "\n", "", "gt_mask", "=", "None", "\n", "pos_segments", "=", "[", "]", "\n", "neg_segments", "=", "[", "]", "\n", "for", "obj_id", "in", "random_ids", ":", "\n", "            ", "obj_gt_mask", ",", "obj_pos_segments", ",", "obj_neg_segments", "=", "self", ".", "_sample_from_masks_layer", "(", "obj_id", ",", "sample", ")", "\n", "if", "gt_mask", "is", "None", ":", "\n", "                ", "gt_mask", "=", "obj_gt_mask", "\n", "", "else", ":", "\n", "                ", "gt_mask", "=", "np", ".", "maximum", "(", "gt_mask", ",", "obj_gt_mask", ")", "\n", "\n", "", "pos_segments", ".", "extend", "(", "obj_pos_segments", ")", "\n", "neg_segments", ".", "extend", "(", "obj_neg_segments", ")", "\n", "\n", "", "pos_masks", "=", "[", "self", ".", "_positive_erode", "(", "x", ")", "for", "x", "in", "pos_segments", "]", "\n", "neg_masks", "=", "[", "self", ".", "_positive_erode", "(", "x", ")", "for", "x", "in", "neg_segments", "]", "\n", "\n", "return", "gt_mask", ",", "pos_masks", ",", "neg_masks", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._sample_from_masks_layer": [[121, 167], ["points_sampler.MultiPointSampler._sample_from_masks_layer._select_node"], "methods", ["None"], ["", "def", "_sample_from_masks_layer", "(", "self", ",", "obj_id", ",", "sample", ":", "DSample", ")", ":", "\n", "        ", "objs_tree", "=", "sample", ".", "_objects", "\n", "\n", "if", "not", "self", ".", "use_hierarchy", ":", "\n", "            ", "node_mask", "=", "sample", ".", "get_object_mask", "(", "obj_id", ")", "\n", "gt_mask", "=", "sample", ".", "get_soft_object_mask", "(", "obj_id", ")", "if", "self", ".", "soft_targets", "else", "node_mask", "\n", "return", "gt_mask", ",", "[", "node_mask", "]", ",", "[", "]", "\n", "\n", "", "def", "_select_node", "(", "node_id", ")", ":", "\n", "            ", "node_info", "=", "objs_tree", "[", "node_id", "]", "\n", "if", "not", "node_info", "[", "'children'", "]", "or", "random", ".", "random", "(", ")", "<", "0.5", ":", "\n", "                ", "return", "node_id", "\n", "", "return", "_select_node", "(", "random", ".", "choice", "(", "node_info", "[", "'children'", "]", ")", ")", "\n", "\n", "", "selected_node", "=", "_select_node", "(", "obj_id", ")", "\n", "node_info", "=", "objs_tree", "[", "selected_node", "]", "\n", "node_mask", "=", "sample", ".", "get_object_mask", "(", "selected_node", ")", "\n", "gt_mask", "=", "sample", ".", "get_soft_object_mask", "(", "selected_node", ")", "if", "self", ".", "soft_targets", "else", "node_mask", "\n", "pos_mask", "=", "node_mask", ".", "copy", "(", ")", "\n", "\n", "negative_segments", "=", "[", "]", "\n", "if", "node_info", "[", "'parent'", "]", "is", "not", "None", "and", "node_info", "[", "'parent'", "]", "in", "objs_tree", ":", "\n", "            ", "parent_mask", "=", "sample", ".", "get_object_mask", "(", "node_info", "[", "'parent'", "]", ")", "\n", "#negative_segments.append(np.logical_and(parent_mask, np.logical_not(node_mask)))", "\n", "\n", "", "for", "child_id", "in", "node_info", "[", "'children'", "]", ":", "\n", "            ", "if", "objs_tree", "[", "child_id", "]", "[", "'area'", "]", "/", "node_info", "[", "'area'", "]", "<", "0.10", ":", "\n", "                ", "child_mask", "=", "sample", ".", "get_object_mask", "(", "child_id", ")", "\n", "pos_mask", "=", "np", ".", "logical_and", "(", "pos_mask", ",", "np", ".", "logical_not", "(", "child_mask", ")", ")", "\n", "\n", "", "", "if", "node_info", "[", "'children'", "]", ":", "\n", "            ", "max_disabled_children", "=", "min", "(", "len", "(", "node_info", "[", "'children'", "]", ")", ",", "3", ")", "\n", "num_disabled_children", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "max_disabled_children", "+", "1", ")", "\n", "disabled_children", "=", "random", ".", "sample", "(", "node_info", "[", "'children'", "]", ",", "num_disabled_children", ")", "\n", "\n", "for", "child_id", "in", "disabled_children", ":", "\n", "                ", "child_mask", "=", "sample", ".", "get_object_mask", "(", "child_id", ")", "\n", "pos_mask", "=", "np", ".", "logical_and", "(", "pos_mask", ",", "np", ".", "logical_not", "(", "child_mask", ")", ")", "\n", "if", "self", ".", "soft_targets", ":", "\n", "                    ", "soft_child_mask", "=", "sample", ".", "get_soft_object_mask", "(", "child_id", ")", "\n", "gt_mask", "=", "np", ".", "minimum", "(", "gt_mask", ",", "1.0", "-", "soft_child_mask", ")", "\n", "", "else", ":", "\n", "                    ", "gt_mask", "=", "np", ".", "logical_and", "(", "gt_mask", ",", "np", ".", "logical_not", "(", "child_mask", ")", ")", "\n", "#negative_segments.append(child_mask)", "\n", "\n", "", "", "", "return", "gt_mask", ",", "[", "pos_mask", "]", ",", "negative_segments", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler.sample_points": [[168, 184], ["points_sampler.MultiPointSampler._multi_mask_sample_points", "points_sampler.MultiPointSampler._multi_mask_sample_points", "zip", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._multi_mask_sample_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._multi_mask_sample_points"], ["", "def", "sample_points", "(", "self", ")", ":", "\n", "        ", "assert", "self", ".", "_selected_mask", "is", "not", "None", "\n", "\n", "pos_points", "=", "self", ".", "_multi_mask_sample_points", "(", "self", ".", "_selected_masks", ",", "\n", "is_negative", "=", "[", "False", "]", "*", "len", "(", "self", ".", "_selected_masks", ")", ",", "\n", "with_first_click", "=", "self", ".", "first_click_center", ")", "\n", "\n", "neg_strategy", "=", "[", "(", "self", ".", "_neg_masks", "[", "k", "]", ",", "prob", ")", "\n", "for", "k", ",", "prob", "in", "zip", "(", "self", ".", "neg_strategies", ",", "self", ".", "neg_strategies_prob", ")", "]", "\n", "neg_masks", "=", "self", ".", "_neg_masks", "[", "'required'", "]", "+", "[", "neg_strategy", "]", "\n", "neg_points", "=", "self", ".", "_multi_mask_sample_points", "(", "neg_masks", ",", "\n", "is_negative", "=", "[", "True", "]", "*", "len", "(", "self", ".", "_neg_masks", "[", "'required'", "]", ")", "+", "[", "True", "]", ")", "\n", "#rint('selected :', len(self._selected_masks))", "\n", "#print('neg_masks : ', len(neg_masks))", "\n", "\n", "return", "pos_points", "+", "neg_points", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._multi_mask_sample_points": [[185, 222], ["points_sampler.MultiPointSampler._sample_points", "len", "len", "points.extend", "enumerate", "len", "enumerate", "points_sampler.MultiPointSampler._sample_points", "len", "points.extend", "points.extend", "isinstance", "isinstance", "aggregated_masks_with_prob.append", "len", "len", "random.sample", "len", "aggregated_masks_with_prob.append", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._sample_points", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._sample_points"], ["", "def", "_multi_mask_sample_points", "(", "self", ",", "selected_masks", ",", "is_negative", ",", "with_first_click", "=", "False", ")", ":", "\n", "        ", "selected_masks", "=", "selected_masks", "[", ":", "self", ".", "max_num_points", "]", "\n", "\n", "each_obj_points", "=", "[", "\n", "self", ".", "_sample_points", "(", "mask", ",", "is_negative", "=", "is_negative", "[", "i", "]", ",", "\n", "with_first_click", "=", "with_first_click", ")", "\n", "for", "i", ",", "mask", "in", "enumerate", "(", "selected_masks", ")", "\n", "]", "\n", "each_obj_points", "=", "[", "x", "for", "x", "in", "each_obj_points", "if", "len", "(", "x", ")", ">", "0", "]", "\n", "\n", "points", "=", "[", "]", "\n", "if", "len", "(", "each_obj_points", ")", "==", "1", ":", "\n", "            ", "points", "=", "each_obj_points", "[", "0", "]", "\n", "", "elif", "len", "(", "each_obj_points", ")", ">", "1", ":", "\n", "            ", "if", "self", ".", "only_one_first_click", ":", "\n", "                ", "each_obj_points", "=", "each_obj_points", "[", ":", "1", "]", "\n", "\n", "", "points", "=", "[", "obj_points", "[", "0", "]", "for", "obj_points", "in", "each_obj_points", "]", "\n", "\n", "aggregated_masks_with_prob", "=", "[", "]", "\n", "for", "indx", ",", "x", "in", "enumerate", "(", "selected_masks", ")", ":", "\n", "                ", "if", "isinstance", "(", "x", ",", "(", "list", ",", "tuple", ")", ")", "and", "x", "and", "isinstance", "(", "x", "[", "0", "]", ",", "(", "list", ",", "tuple", ")", ")", ":", "\n", "                    ", "for", "t", ",", "prob", "in", "x", ":", "\n", "                        ", "aggregated_masks_with_prob", ".", "append", "(", "(", "t", ",", "prob", "/", "len", "(", "selected_masks", ")", ")", ")", "\n", "", "", "else", ":", "\n", "                    ", "aggregated_masks_with_prob", ".", "append", "(", "(", "x", ",", "1.0", "/", "len", "(", "selected_masks", ")", ")", ")", "\n", "\n", "", "", "other_points_union", "=", "self", ".", "_sample_points", "(", "aggregated_masks_with_prob", ",", "is_negative", "=", "True", ")", "\n", "if", "len", "(", "other_points_union", ")", "+", "len", "(", "points", ")", "<=", "self", ".", "max_num_points", ":", "\n", "                ", "points", ".", "extend", "(", "other_points_union", ")", "\n", "", "else", ":", "\n", "                ", "points", ".", "extend", "(", "random", ".", "sample", "(", "other_points_union", ",", "self", ".", "max_num_points", "-", "len", "(", "points", ")", ")", ")", "\n", "\n", "", "", "if", "len", "(", "points", ")", "<", "self", ".", "max_num_points", ":", "\n", "            ", "points", ".", "extend", "(", "[", "(", "-", "1", ",", "-", "1", ",", "-", "1", ")", "]", "*", "(", "self", ".", "max_num_points", "-", "len", "(", "points", ")", ")", ")", "\n", "\n", "", "return", "points", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._sample_points": [[223, 257], ["isinstance", "range", "numpy.random.choice", "numpy.argwhere", "len", "numpy.arange", "numpy.random.choice", "math.isclose", "points_sampler.get_point_candidates", "points.append", "numpy.arange", "numpy.argwhere", "sum", "numpy.random.choice", "point_indices[].tolist", "numpy.arange", "len", "numpy.random.randint"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.get_point_candidates"], ["", "def", "_sample_points", "(", "self", ",", "mask", ",", "is_negative", "=", "False", ",", "with_first_click", "=", "False", ")", ":", "\n", "        ", "if", "is_negative", ":", "\n", "            ", "num_points", "=", "np", ".", "random", ".", "choice", "(", "np", ".", "arange", "(", "self", ".", "max_num_points", "+", "1", ")", ",", "p", "=", "self", ".", "_neg_probs", ")", "\n", "", "else", ":", "\n", "            ", "num_points", "=", "1", "+", "np", ".", "random", ".", "choice", "(", "np", ".", "arange", "(", "self", ".", "max_num_points", ")", ",", "p", "=", "self", ".", "_pos_probs", ")", "\n", "\n", "", "indices_probs", "=", "None", "\n", "if", "isinstance", "(", "mask", ",", "(", "list", ",", "tuple", ")", ")", ":", "\n", "            ", "indices_probs", "=", "[", "x", "[", "1", "]", "for", "x", "in", "mask", "]", "\n", "indices", "=", "[", "(", "np", ".", "argwhere", "(", "x", ")", ",", "prob", ")", "for", "x", ",", "prob", "in", "mask", "]", "\n", "if", "indices_probs", ":", "\n", "                ", "assert", "math", ".", "isclose", "(", "sum", "(", "indices_probs", ")", ",", "1.0", ")", "\n", "", "", "else", ":", "\n", "            ", "indices", "=", "np", ".", "argwhere", "(", "mask", ")", "\n", "\n", "", "points", "=", "[", "]", "\n", "for", "j", "in", "range", "(", "num_points", ")", ":", "\n", "            ", "first_click", "=", "with_first_click", "and", "j", "==", "0", "and", "indices_probs", "is", "None", "\n", "\n", "if", "first_click", ":", "\n", "                ", "point_indices", "=", "get_point_candidates", "(", "mask", ",", "k", "=", "self", ".", "sfc_inner_k", ",", "full_prob", "=", "self", ".", "sfc_full_inner_prob", ")", "\n", "", "elif", "indices_probs", ":", "\n", "                ", "point_indices_indx", "=", "np", ".", "random", ".", "choice", "(", "np", ".", "arange", "(", "len", "(", "indices", ")", ")", ",", "p", "=", "indices_probs", ")", "\n", "point_indices", "=", "indices", "[", "point_indices_indx", "]", "[", "0", "]", "\n", "", "else", ":", "\n", "                ", "point_indices", "=", "indices", "\n", "\n", "", "num_indices", "=", "len", "(", "point_indices", ")", "\n", "if", "num_indices", ">", "0", ":", "\n", "                ", "point_indx", "=", "0", "if", "first_click", "else", "100", "\n", "click", "=", "point_indices", "[", "np", ".", "random", ".", "randint", "(", "0", ",", "num_indices", ")", "]", ".", "tolist", "(", ")", "+", "[", "point_indx", "]", "\n", "points", ".", "append", "(", "click", ")", "\n", "\n", "", "", "return", "points", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._positive_erode": [[258, 270], ["numpy.ones", "cv2.erode().astype", "random.random", "cv2.erode().astype.sum", "cv2.erode", "mask.astype"], "methods", ["None"], ["", "def", "_positive_erode", "(", "self", ",", "mask", ")", ":", "\n", "        ", "if", "random", ".", "random", "(", ")", ">", "self", ".", "positive_erode_prob", ":", "\n", "            ", "return", "mask", "\n", "\n", "", "kernel", "=", "np", ".", "ones", "(", "(", "3", ",", "3", ")", ",", "np", ".", "uint8", ")", "\n", "eroded_mask", "=", "cv2", ".", "erode", "(", "mask", ".", "astype", "(", "np", ".", "uint8", ")", ",", "\n", "kernel", ",", "iterations", "=", "self", ".", "positive_erode_iters", ")", ".", "astype", "(", "np", ".", "bool", ")", "\n", "\n", "if", "eroded_mask", ".", "sum", "(", ")", ">", "10", ":", "\n", "            ", "return", "eroded_mask", "\n", "", "else", ":", "\n", "            ", "return", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.MultiPointSampler._get_border_mask": [[271, 277], ["int", "numpy.ones", "cv2.dilate", "numpy.ceil", "mask.astype", "mask.astype", "numpy.sqrt", "mask.sum"], "methods", ["None"], ["", "", "def", "_get_border_mask", "(", "self", ",", "mask", ")", ":", "\n", "        ", "expand_r", "=", "int", "(", "np", ".", "ceil", "(", "self", ".", "expand_ratio", "*", "np", ".", "sqrt", "(", "mask", ".", "sum", "(", ")", ")", ")", ")", "\n", "kernel", "=", "np", ".", "ones", "(", "(", "3", ",", "3", ")", ",", "np", ".", "uint8", ")", "\n", "expanded_mask", "=", "cv2", ".", "dilate", "(", "mask", ".", "astype", "(", "np", ".", "uint8", ")", ",", "kernel", ",", "iterations", "=", "expand_r", ")", "\n", "expanded_mask", "[", "mask", ".", "astype", "(", "np", ".", "bool", ")", "]", "=", "0", "\n", "return", "expanded_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.generate_probs": [[279, 291], ["functools.lru_cache", "range", "numpy.array", "np.array.sum", "np.array.append"], "function", ["None"], ["", "", "@", "lru_cache", "(", "maxsize", "=", "None", ")", "\n", "def", "generate_probs", "(", "max_num_points", ",", "gamma", ")", ":", "\n", "    ", "probs", "=", "[", "]", "\n", "last_value", "=", "1", "\n", "for", "i", "in", "range", "(", "max_num_points", ")", ":", "\n", "        ", "probs", ".", "append", "(", "last_value", ")", "\n", "last_value", "*=", "gamma", "\n", "\n", "", "probs", "=", "np", ".", "array", "(", "probs", ")", "\n", "probs", "/=", "probs", ".", "sum", "(", ")", "\n", "\n", "return", "probs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.points_sampler.get_point_candidates": [[293, 309], ["numpy.pad", "cv2.distanceTransform", "numpy.argwhere", "dt.flatten", "max", "numpy.random.choice", "numpy.unravel_index", "numpy.array", "random.random", "np.pad.astype", "dt.flatten.sum", "len", "dt.max"], "function", ["None"], ["", "def", "get_point_candidates", "(", "obj_mask", ",", "k", "=", "1.7", ",", "full_prob", "=", "0.0", ")", ":", "\n", "    ", "if", "full_prob", ">", "0", "and", "random", ".", "random", "(", ")", "<", "full_prob", ":", "\n", "        ", "return", "obj_mask", "\n", "\n", "", "padded_mask", "=", "np", ".", "pad", "(", "obj_mask", ",", "(", "(", "1", ",", "1", ")", ",", "(", "1", ",", "1", ")", ")", ",", "'constant'", ")", "\n", "\n", "dt", "=", "cv2", ".", "distanceTransform", "(", "padded_mask", ".", "astype", "(", "np", ".", "uint8", ")", ",", "cv2", ".", "DIST_L2", ",", "0", ")", "[", "1", ":", "-", "1", ",", "1", ":", "-", "1", "]", "\n", "if", "k", ">", "0", ":", "\n", "        ", "inner_mask", "=", "dt", ">", "dt", ".", "max", "(", ")", "/", "k", "\n", "return", "np", ".", "argwhere", "(", "inner_mask", ")", "\n", "", "else", ":", "\n", "        ", "prob_map", "=", "dt", ".", "flatten", "(", ")", "\n", "prob_map", "/=", "max", "(", "prob_map", ".", "sum", "(", ")", ",", "1e-6", ")", "\n", "click_indx", "=", "np", ".", "random", ".", "choice", "(", "len", "(", "prob_map", ")", ",", "p", "=", "prob_map", ")", "\n", "click_coords", "=", "np", ".", "unravel_index", "(", "click_indx", ",", "dt", ".", "shape", ")", "\n", "return", "np", ".", "array", "(", "[", "click_coords", "]", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.__init__": [[8, 44], ["len", "dict", "enumerate", "copy.deepcopy", "copy.deepcopy", "isinstance", "isinstance"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "image", ",", "encoded_masks", ",", "objects", "=", "None", ",", "\n", "objects_ids", "=", "None", ",", "ignore_ids", "=", "None", ",", "sample_id", "=", "None", ",", "\n", "init_mask", "=", "None", ")", ":", "\n", "        ", "self", ".", "image", "=", "image", "\n", "self", ".", "sample_id", "=", "sample_id", "\n", "self", ".", "init_mask", "=", "init_mask", "\n", "\n", "if", "len", "(", "encoded_masks", ".", "shape", ")", "==", "2", ":", "\n", "            ", "encoded_masks", "=", "encoded_masks", "[", ":", ",", ":", ",", "np", ".", "newaxis", "]", "\n", "", "self", ".", "_encoded_masks", "=", "encoded_masks", "\n", "self", ".", "_ignored_regions", "=", "[", "]", "\n", "\n", "if", "objects_ids", "is", "not", "None", ":", "\n", "            ", "if", "not", "objects_ids", "or", "not", "isinstance", "(", "objects_ids", "[", "0", "]", ",", "tuple", ")", ":", "\n", "                ", "assert", "encoded_masks", ".", "shape", "[", "2", "]", "==", "1", "\n", "objects_ids", "=", "[", "(", "0", ",", "obj_id", ")", "for", "obj_id", "in", "objects_ids", "]", "\n", "\n", "", "self", ".", "_objects", "=", "dict", "(", ")", "\n", "for", "indx", ",", "obj_mapping", "in", "enumerate", "(", "objects_ids", ")", ":", "\n", "                ", "self", ".", "_objects", "[", "indx", "]", "=", "{", "\n", "'parent'", ":", "None", ",", "\n", "'mapping'", ":", "obj_mapping", ",", "\n", "'children'", ":", "[", "]", "\n", "}", "\n", "\n", "", "if", "ignore_ids", ":", "\n", "                ", "if", "isinstance", "(", "ignore_ids", "[", "0", "]", ",", "tuple", ")", ":", "\n", "                    ", "self", ".", "_ignored_regions", "=", "ignore_ids", "\n", "", "else", ":", "\n", "                    ", "self", ".", "_ignored_regions", "=", "[", "(", "0", ",", "region_id", ")", "for", "region_id", "in", "ignore_ids", "]", "\n", "", "", "", "else", ":", "\n", "            ", "self", ".", "_objects", "=", "deepcopy", "(", "objects", ")", "\n", "\n", "", "self", ".", "_augmented", "=", "False", "\n", "self", ".", "_soft_mask_aug", "=", "None", "\n", "self", ".", "_original_data", "=", "self", ".", "image", ",", "self", ".", "_encoded_masks", ",", "deepcopy", "(", "self", ".", "_objects", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.augment": [[46, 55], ["sample.DSample.reset_augmentation", "augmentator", "sample.DSample._compute_objects_areas", "sample.DSample.remove_small_objects"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.reset_augmentation", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample._compute_objects_areas", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.remove_small_objects"], ["", "def", "augment", "(", "self", ",", "augmentator", ")", ":", "\n", "        ", "self", ".", "reset_augmentation", "(", ")", "\n", "aug_output", "=", "augmentator", "(", "image", "=", "self", ".", "image", ",", "mask", "=", "self", ".", "_encoded_masks", ")", "\n", "image", ",", "mask", "=", "aug_output", "[", "'image'", "]", ",", "aug_output", "[", "'mask'", "]", "\n", "self", ".", "image", "=", "image", "\n", "self", ".", "_encoded_masks", "=", "mask", "\n", "self", ".", "_compute_objects_areas", "(", ")", "\n", "self", ".", "remove_small_objects", "(", "min_area", "=", "1", ")", "\n", "self", ".", "_augmented", "=", "True", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.reset_augmentation": [[57, 66], ["copy.deepcopy"], "methods", ["None"], ["", "def", "reset_augmentation", "(", "self", ")", ":", "\n", "        ", "if", "not", "self", ".", "_augmented", ":", "\n", "            ", "return", "\n", "", "orig_image", ",", "orig_masks", ",", "orig_objects", "=", "self", ".", "_original_data", "\n", "self", ".", "image", "=", "orig_image", "\n", "self", ".", "_encoded_masks", "=", "orig_masks", "\n", "self", ".", "_objects", "=", "deepcopy", "(", "orig_objects", ")", "\n", "self", ".", "_augmented", "=", "False", "\n", "self", ".", "_soft_mask_aug", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.remove_small_objects": [[67, 74], ["list", "sample.DSample._compute_objects_areas", "sample.DSample._objects.items", "sample.DSample._remove_object", "list", "sample.DSample._objects.values"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample._compute_objects_areas", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample._remove_object"], ["", "def", "remove_small_objects", "(", "self", ",", "min_area", ")", ":", "\n", "        ", "if", "self", ".", "_objects", "and", "not", "'area'", "in", "list", "(", "self", ".", "_objects", ".", "values", "(", ")", ")", "[", "0", "]", ":", "\n", "            ", "self", ".", "_compute_objects_areas", "(", ")", "\n", "\n", "", "for", "obj_id", ",", "obj_info", "in", "list", "(", "self", ".", "_objects", ".", "items", "(", ")", ")", ":", "\n", "            ", "if", "obj_info", "[", "'area'", "]", "<", "min_area", ":", "\n", "                ", "self", ".", "_remove_object", "(", "obj_id", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.get_object_mask": [[75, 84], ["None"], "methods", ["None"], ["", "", "", "def", "get_object_mask", "(", "self", ",", "obj_id", ")", ":", "\n", "        ", "layer_indx", ",", "mask_id", "=", "self", ".", "_objects", "[", "obj_id", "]", "[", "'mapping'", "]", "\n", "obj_mask", "=", "(", "self", ".", "_encoded_masks", "[", ":", ",", ":", ",", "layer_indx", "]", "==", "mask_id", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "if", "self", ".", "_ignored_regions", ":", "\n", "            ", "for", "layer_indx", ",", "mask_id", "in", "self", ".", "_ignored_regions", ":", "\n", "                ", "ignore_mask", "=", "self", ".", "_encoded_masks", "[", ":", ",", ":", ",", "layer_indx", "]", "==", "mask_id", "\n", "obj_mask", "[", "ignore_mask", "]", "=", "-", "1", "\n", "\n", "", "", "return", "obj_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.get_soft_object_mask": [[85, 92], ["numpy.clip", "sample.DSample._soft_mask_aug"], "methods", ["None"], ["", "def", "get_soft_object_mask", "(", "self", ",", "obj_id", ")", ":", "\n", "        ", "assert", "self", ".", "_soft_mask_aug", "is", "not", "None", "\n", "original_encoded_masks", "=", "self", ".", "_original_data", "[", "1", "]", "\n", "layer_indx", ",", "mask_id", "=", "self", ".", "_objects", "[", "obj_id", "]", "[", "'mapping'", "]", "\n", "obj_mask", "=", "(", "original_encoded_masks", "[", ":", ",", ":", ",", "layer_indx", "]", "==", "mask_id", ")", ".", "astype", "(", "np", ".", "float32", ")", "\n", "obj_mask", "=", "self", ".", "_soft_mask_aug", "(", "image", "=", "obj_mask", ",", "mask", "=", "original_encoded_masks", ")", "[", "'image'", "]", "\n", "return", "np", ".", "clip", "(", "obj_mask", ",", "0", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.get_background_mask": [[93, 95], ["numpy.max"], "methods", ["None"], ["", "def", "get_background_mask", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "max", "(", "self", ".", "_encoded_masks", ",", "axis", "=", "2", ")", "==", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.objects_ids": [[96, 99], ["list", "sample.DSample._objects.keys"], "methods", ["None"], ["", "@", "property", "\n", "def", "objects_ids", "(", "self", ")", ":", "\n", "        ", "return", "list", "(", "self", ".", "_objects", ".", "keys", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.gt_mask": [[100, 104], ["sample.DSample.get_object_mask", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.get_object_mask"], ["", "@", "property", "\n", "def", "gt_mask", "(", "self", ")", ":", "\n", "        ", "assert", "len", "(", "self", ".", "_objects", ")", "==", "1", "\n", "return", "self", ".", "get_object_mask", "(", "self", ".", "objects_ids", "[", "0", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.root_objects": [[105, 108], ["sample.DSample._objects.items"], "methods", ["None"], ["", "@", "property", "\n", "def", "root_objects", "(", "self", ")", ":", "\n", "        ", "return", "[", "obj_id", "for", "obj_id", ",", "obj_info", "in", "self", ".", "_objects", ".", "items", "(", ")", "if", "obj_info", "[", "'parent'", "]", "is", "None", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample._compute_objects_areas": [[109, 129], ["set", "range", "inverse_index.values", "isegm.utils.misc.get_labels_with_sizes", "zip", "sample.DSample._objects.items"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_labels_with_sizes"], ["", "def", "_compute_objects_areas", "(", "self", ")", ":", "\n", "        ", "inverse_index", "=", "{", "node", "[", "'mapping'", "]", ":", "node_id", "for", "node_id", ",", "node", "in", "self", ".", "_objects", ".", "items", "(", ")", "}", "\n", "ignored_regions_keys", "=", "set", "(", "self", ".", "_ignored_regions", ")", "\n", "\n", "for", "layer_indx", "in", "range", "(", "self", ".", "_encoded_masks", ".", "shape", "[", "2", "]", ")", ":", "\n", "            ", "objects_ids", ",", "objects_areas", "=", "get_labels_with_sizes", "(", "self", ".", "_encoded_masks", "[", ":", ",", ":", ",", "layer_indx", "]", ")", "\n", "for", "obj_id", ",", "obj_area", "in", "zip", "(", "objects_ids", ",", "objects_areas", ")", ":", "\n", "                ", "inv_key", "=", "(", "layer_indx", ",", "obj_id", ")", "\n", "if", "inv_key", "in", "ignored_regions_keys", ":", "\n", "                    ", "continue", "\n", "", "try", ":", "\n", "                    ", "self", ".", "_objects", "[", "inverse_index", "[", "inv_key", "]", "]", "[", "'area'", "]", "=", "obj_area", "\n", "del", "inverse_index", "[", "inv_key", "]", "\n", "", "except", "KeyError", ":", "\n", "                    ", "layer", "=", "self", ".", "_encoded_masks", "[", ":", ",", ":", ",", "layer_indx", "]", "\n", "layer", "[", "layer", "==", "obj_id", "]", "=", "0", "\n", "self", ".", "_encoded_masks", "[", ":", ",", ":", ",", "layer_indx", "]", "=", "layer", "\n", "\n", "", "", "", "for", "obj_id", "in", "inverse_index", ".", "values", "(", ")", ":", "\n", "            ", "self", ".", "_objects", "[", "obj_id", "]", "[", "'area'", "]", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample._remove_object": [[130, 142], ["None"], "methods", ["None"], ["", "", "def", "_remove_object", "(", "self", ",", "obj_id", ")", ":", "\n", "        ", "obj_info", "=", "self", ".", "_objects", "[", "obj_id", "]", "\n", "obj_parent", "=", "obj_info", "[", "'parent'", "]", "\n", "for", "child_id", "in", "obj_info", "[", "'children'", "]", ":", "\n", "            ", "self", ".", "_objects", "[", "child_id", "]", "[", "'parent'", "]", "=", "obj_parent", "\n", "\n", "", "if", "obj_parent", "is", "not", "None", ":", "\n", "            ", "parent_children", "=", "self", ".", "_objects", "[", "obj_parent", "]", "[", "'children'", "]", "\n", "parent_children", "=", "[", "x", "for", "x", "in", "parent_children", "if", "x", "!=", "obj_id", "]", "\n", "self", ".", "_objects", "[", "obj_parent", "]", "[", "'children'", "]", "=", "parent_children", "+", "obj_info", "[", "'children'", "]", "\n", "\n", "", "del", "self", ".", "_objects", "[", "obj_id", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.sample.DSample.__len__": [[143, 145], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "_objects", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.aligned_augmentation.AlignedAugmentator.__init__": [[14, 26], ["aligned_augmentation.get_truncated_normal"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.aligned_augmentation.get_truncated_normal"], ["    ", "def", "__init__", "(", "self", ",", "ratio", "=", "[", "0.3", ",", "1", "]", ",", "target_size", "=", "(", "256", ",", "256", ")", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Uniform'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "None", ")", ":", "\n", "        ", "'''\n        distribution belongs to [ 'Uniform, Gaussian' ]\n        '''", "\n", "self", ".", "ratio", "=", "ratio", "\n", "self", ".", "target_size", "=", "target_size", "\n", "self", ".", "flip", "=", "flip", "\n", "self", ".", "distribution", "=", "distribution", "\n", "self", ".", "gaussian", "=", "get_truncated_normal", "(", "mean", "=", "gs_center", ",", "sd", "=", "gs_sd", ",", "low", "=", "ratio", "[", "0", "]", ",", "upp", "=", "ratio", "[", "1", "]", ")", "\n", "self", ".", "color_augmentator", "=", "color_augmentator", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.aligned_augmentation.AlignedAugmentator.__call__": [[27, 74], ["numpy.random.randint", "numpy.random.randint", "cv2.resize", "mask[].astype", "cv2.resize().astype", "numpy.ascontiguousarray", "numpy.ascontiguousarray", "int", "int", "aligned_augmentation.AlignedAugmentator.pad_image_mask", "len", "numpy.expand_dims", "numpy.random.uniform", "numpy.random.uniform", "aligned_augmentation.AlignedAugmentator.gaussian.rvs", "cv2.resize", "numpy.random.rand", "numpy.flip", "numpy.flip", "numpy.random.rand", "numpy.flip", "numpy.flip", "aligned_augmentation.AlignedAugmentator.color_augmentator"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.aligned_augmentation.AlignedAugmentator.pad_image_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "def", "__call__", "(", "self", ",", "image", ",", "mask", ")", ":", "\n", "        ", "'''\n        image: np.array (267, 400, 3) np.uint8\n        mask:  np.array (267, 400, 1) np.int32\n        '''", "\n", "\n", "if", "self", ".", "distribution", "==", "'Uniform'", ":", "\n", "            ", "hr", ",", "wr", "=", "np", ".", "random", ".", "uniform", "(", "*", "self", ".", "ratio", ")", ",", "np", ".", "random", ".", "uniform", "(", "*", "self", ".", "ratio", ")", "\n", "", "elif", "self", ".", "distribution", "==", "'Gaussian'", ":", "\n", "            ", "hr", ",", "wr", "=", "self", ".", "gaussian", ".", "rvs", "(", "2", ")", "\n", "\n", "", "H", ",", "W", "=", "image", ".", "shape", "[", "0", "]", ",", "image", ".", "shape", "[", "1", "]", "\n", "h", ",", "w", "=", "int", "(", "H", "*", "hr", ")", ",", "int", "(", "W", "*", "wr", ")", "\n", "if", "hr", ">", "1", "or", "wr", ">", "1", ":", "\n", "            ", "image", ",", "mask", "=", "self", ".", "pad_image_mask", "(", "image", ",", "mask", ",", "hr", ",", "wr", ")", "\n", "H", ",", "W", "=", "image", ".", "shape", "[", "0", "]", ",", "image", ".", "shape", "[", "1", "]", "\n", "\n", "", "y1", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "H", "-", "h", ")", "\n", "x1", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "W", "-", "w", ")", "\n", "y2", "=", "y1", "+", "h", "\n", "x2", "=", "y1", "+", "W", "\n", "\n", "image_crop", "=", "image", "[", "y1", ":", "y2", ",", "x1", ":", "x2", ",", ":", "]", "\n", "image_crop", "=", "cv2", ".", "resize", "(", "image_crop", ",", "self", ".", "target_size", ")", "\n", "mask_crop", "=", "mask", "[", "y1", ":", "y2", ",", "x1", ":", "x2", ",", ":", "]", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "mask_crop", "=", "(", "cv2", ".", "resize", "(", "mask_crop", ",", "self", ".", "target_size", ")", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "if", "len", "(", "mask_crop", ".", "shape", ")", "==", "2", ":", "\n", "            ", "mask_crop", "=", "np", ".", "expand_dims", "(", "mask_crop", ",", "-", "1", ")", "\n", "\n", "", "if", "self", ".", "flip", ":", "\n", "            ", "if", "np", ".", "random", ".", "rand", "(", ")", "<", "0.3", ":", "\n", "                ", "image_crop", "=", "np", ".", "flip", "(", "image_crop", ",", "0", ")", "\n", "mask_crop", "=", "np", ".", "flip", "(", "mask_crop", ",", "0", ")", "\n", "", "if", "np", ".", "random", ".", "rand", "(", ")", "<", "0.3", ":", "\n", "                ", "image_crop", "=", "np", ".", "flip", "(", "image_crop", ",", "1", ")", "\n", "mask_crop", "=", "np", ".", "flip", "(", "mask_crop", ",", "1", ")", "\n", "\n", "", "", "image_crop", "=", "np", ".", "ascontiguousarray", "(", "image_crop", ")", "\n", "mask_crop", "=", "np", ".", "ascontiguousarray", "(", "mask_crop", ")", "\n", "\n", "if", "self", ".", "color_augmentator", "is", "not", "None", ":", "\n", "            ", "image_crop", "=", "self", ".", "color_augmentator", "(", "image", "=", "image_crop", ")", "[", "'image'", "]", "\n", "\n", "", "aug_output", "=", "{", "}", "\n", "aug_output", "[", "'image'", "]", "=", "image_crop", "\n", "aug_output", "[", "'mask'", "]", "=", "mask_crop", "\n", "return", "aug_output", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.aligned_augmentation.AlignedAugmentator.pad_image_mask": [[75, 93], ["numpy.random.randint", "numpy.pad", "numpy.pad", "numpy.random.randint", "numpy.pad", "numpy.pad", "int", "int"], "methods", ["None"], ["", "def", "pad_image_mask", "(", "self", ",", "image", ",", "mask", ",", "hr", ",", "wr", ")", ":", "\n", "        ", "H", ",", "W", "=", "image", ".", "shape", "[", "0", "]", ",", "image", ".", "shape", "[", "1", "]", "\n", "if", "hr", ">", "1", ":", "\n", "            ", "new_h", "=", "int", "(", "H", "*", "hr", ")", "+", "1", "\n", "pad_h", "=", "new_h", "-", "H", "\n", "pad_h1", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "pad_h", ")", "\n", "pad_h2", "=", "pad_h", "-", "pad_h1", "\n", "image", "=", "np", ".", "pad", "(", "image", ",", "(", "(", "pad_h1", ",", "pad_h2", ")", ",", "(", "0", ",", "0", ")", ",", "(", "0", ",", "0", ")", ")", ",", "'constant'", ")", "\n", "mask", "=", "np", ".", "pad", "(", "mask", ",", "(", "(", "pad_h1", ",", "pad_h2", ")", ",", "(", "0", ",", "0", ")", ",", "(", "0", ",", "0", ")", ")", ",", "'constant'", ")", "\n", "\n", "", "if", "wr", ">", "1", ":", "\n", "            ", "new_w", "=", "int", "(", "W", "*", "wr", ")", "+", "1", "\n", "pad_w", "=", "new_w", "-", "W", "\n", "pad_w1", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "pad_w", ")", "\n", "pad_w2", "=", "pad_w", "-", "pad_w1", "\n", "image", "=", "np", ".", "pad", "(", "image", ",", "(", "(", "0", ",", "0", ")", ",", "(", "pad_w1", ",", "pad_w2", ")", ",", "(", "0", ",", "0", ")", ")", ",", "'constant'", ")", "\n", "mask", "=", "np", ".", "pad", "(", "mask", ",", "(", "(", "0", ",", "0", ")", ",", "(", "pad_w1", ",", "pad_w2", ")", ",", "(", "0", ",", "0", ")", ")", ",", "'constant'", ")", "\n", "", "return", "image", ",", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.aligned_augmentation.get_truncated_normal": [[5, 8], ["scipy.stats.truncnorm"], "function", ["None"], ["def", "get_truncated_normal", "(", "mean", "=", "0", ",", "sd", "=", "1", ",", "low", "=", "0", ",", "upp", "=", "10", ")", ":", "\n", "    ", "return", "truncnorm", "(", "\n", "(", "low", "-", "mean", ")", "/", "sd", ",", "(", "upp", "-", "mean", ")", "/", "sd", ",", "loc", "=", "mean", ",", "scale", "=", "sd", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.compose.ComposeDataset.__init__": [[7, 14], ["base.ISDataset.__init__", "enumerate", "compose.ComposeDataset.dataset_samples.extend", "range", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "datasets", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "ComposeDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "\n", "self", ".", "_datasets", "=", "datasets", "\n", "self", ".", "dataset_samples", "=", "[", "]", "\n", "for", "dataset_indx", ",", "dataset", "in", "enumerate", "(", "self", ".", "_datasets", ")", ":", "\n", "            ", "self", ".", "dataset_samples", ".", "extend", "(", "[", "(", "dataset_indx", ",", "i", ")", "for", "i", "in", "range", "(", "len", "(", "dataset", ")", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.compose.ComposeDataset.get_sample": [[15, 18], ["compose.ComposeDataset._datasets[].get_sample"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_sample"], ["", "", "def", "get_sample", "(", "self", ",", "index", ")", ":", "\n", "        ", "dataset_indx", ",", "sample_indx", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "return", "self", ".", "_datasets", "[", "dataset_indx", "]", ".", "get_sample", "(", "sample_indx", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.compose.ProportionalComposeDataset.__init__": [[21, 34], ["base.ISDataset.__init__", "math.isclose", "enumerate", "len", "len", "sum", "compose.ProportionalComposeDataset.dataset_samples.extend", "range", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "datasets", ",", "ratios", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "\n", "assert", "len", "(", "ratios", ")", "==", "len", "(", "datasets", ")", ",", "\"The number of datasets must match the number of ratios\"", "\n", "assert", "isclose", "(", "sum", "(", "ratios", ")", ",", "1.0", ")", ",", "\"The sum of ratios must be equal to 1\"", "\n", "\n", "self", ".", "_ratios", "=", "ratios", "\n", "self", ".", "_datasets", "=", "datasets", "\n", "self", ".", "dataset_samples", "=", "[", "]", "\n", "for", "dataset_indx", ",", "dataset", "in", "enumerate", "(", "self", ".", "_datasets", ")", ":", "\n", "            ", "self", ".", "dataset_samples", ".", "extend", "(", "[", "(", "dataset_indx", ",", "i", ")", "for", "i", "in", "range", "(", "len", "(", "dataset", ")", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.compose.ProportionalComposeDataset.get_sample": [[35, 40], ["numpy.random.choice", "numpy.random.choice", "compose.ProportionalComposeDataset._datasets[].get_sample", "len", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_sample"], ["", "", "def", "get_sample", "(", "self", ",", "index", ")", ":", "\n", "        ", "dataset_indx", "=", "np", ".", "random", ".", "choice", "(", "len", "(", "self", ".", "_datasets", ")", ",", "p", "=", "self", ".", "_ratios", ")", "\n", "sample_indx", "=", "np", ".", "random", ".", "choice", "(", "len", "(", "self", ".", "_datasets", "[", "dataset_indx", "]", ")", ")", "\n", "\n", "return", "self", ".", "_datasets", "[", "dataset_indx", "]", ".", "get_sample", "(", "sample_indx", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.ytb_vos.YouTubeDataset.__init__": [[12, 35], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "os.join", "os.join", "os.join", "os.join", "os.join", "os.join", "open", "json.load", "video_dirs.append"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", "=", "None", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "YouTubeDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'YoutubeVOS'", "\n", "self", ".", "subset", "=", "'train'", "\n", "#dataset_path = '/home/admin/workspace/project/data/datasets/YTBVOS'", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "dataset_root", "=", "self", ".", "dataset_path", "\n", "self", ".", "image_root", "=", "osp", ".", "join", "(", "dataset_root", ",", "self", ".", "subset", ",", "\"JPEGImages\"", ")", "\n", "self", ".", "anno_root", "=", "osp", ".", "join", "(", "dataset_root", ",", "self", ".", "subset", ",", "\"Annotations\"", ")", "\n", "meta_file", "=", "osp", ".", "join", "(", "dataset_root", ",", "self", ".", "subset", ",", "\"meta.json\"", ")", "\n", "\n", "\n", "\n", "video_dirs", "=", "[", "]", "\n", "\n", "with", "open", "(", "meta_file", ")", "as", "f", ":", "\n", "            ", "records", "=", "json", ".", "load", "(", "f", ")", "\n", "records", "=", "records", "[", "\"videos\"", "]", "\n", "for", "video_id", "in", "records", ":", "\n", "                ", "video_dirs", ".", "append", "(", "video_id", ")", "\n", "", "", "self", ".", "video_dirs", "=", "video_dirs", "\n", "self", ".", "dataset_samples", "=", "video_dirs", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.ytb_vos.YouTubeDataset.get_sample": [[37, 69], ["os.join", "os.join", "os.join", "os.join", "os.listdir", "os.listdir", "os.listdir", "os.listdir", "numpy.random.choice", "numpy.random.choice.replace", "os.join", "os.join", "os.join", "os.join", "cv2.imread", "cv2.cvtColor", "PIL.Image.open().convert", "numpy.array().astype", "numpy.unique", "isegm.data.sample.DSample", "str", "PIL.Image.open", "numpy.array"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", ":", "\n", "        ", "video_dir", "=", "self", ".", "video_dirs", "[", "index", "]", "\n", "anno_dir", "=", "osp", ".", "join", "(", "self", ".", "anno_root", ",", "video_dir", ")", "\n", "image_dir", "=", "osp", ".", "join", "(", "self", ".", "image_root", ",", "video_dir", ")", "\n", "anno_names", "=", "os", ".", "listdir", "(", "anno_dir", ")", "\n", "anno_name", "=", "np", ".", "random", ".", "choice", "(", "anno_names", ")", "\n", "image_name", "=", "anno_name", ".", "replace", "(", "'png'", ",", "'jpg'", ")", "\n", "anno_path", "=", "osp", ".", "join", "(", "anno_dir", ",", "anno_name", ")", "\n", "image_path", "=", "osp", ".", "join", "(", "image_dir", ",", "image_name", ")", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "str", "(", "image_path", ")", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "\n", "instances_mask", "=", "Image", ".", "open", "(", "anno_path", ")", ".", "convert", "(", "'P'", ")", "\n", "instances_mask", "=", "np", ".", "array", "(", "instances_mask", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "#image = resize_thresh(image)", "\n", "#instances_mask = resize_thresh(instances_mask)", "\n", "instances_ids", "=", "np", ".", "unique", "(", "instances_mask", ")", "\n", "instances_ids", "=", "[", "i", "for", "i", "in", "instances_ids", "if", "i", "!=", "0", "]", "\n", "\n", "#print(image.shape, instances_mask.shape, instances_ids   )", "\n", "instances_info", "=", "{", "\n", "x", ":", "{", "'ignore'", ":", "False", "}", "\n", "for", "x", "in", "instances_ids", "\n", "}", "\n", "\n", "\n", "#in_id = np.random.choice(instances_ids)", "\n", "#instances_mask = (instances_mask == in_id) * 255", "\n", "#print(image.shape, instances_mask.shape, instances_ids)", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "instances_ids", ",", "ignore_ids", "=", "[", "-", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.ytb_vos.resize_thresh": [[70, 91], ["cv2.resize.astype", "int", "cv2.resize", "int", "cv2.resize"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "", "def", "resize_thresh", "(", "image", ",", "thresh", "=", "1280", ")", ":", "\n", "    ", "h", ",", "w", "=", "image", ".", "shape", "[", "0", "]", ",", "image", ".", "shape", "[", "1", "]", "\n", "image", "=", "image", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "if", "w", ">=", "h", ":", "\n", "        ", "if", "w", ">", "thresh", ":", "\n", "            ", "w_n", "=", "thresh", "\n", "h_n", "=", "h", "*", "thresh", "/", "w", "\n", "h_n", "=", "int", "(", "h_n", ")", "\n", "image", "=", "cv2", ".", "resize", "(", "image", ",", "(", "w_n", ",", "h_n", ")", ",", "interpolation", "=", "cv2", ".", "INTER_NEAREST", ")", "\n", "return", "image", "\n", "", "else", ":", "\n", "            ", "return", "image", "\n", "", "", "else", ":", "\n", "        ", "if", "h", ">", "thresh", ":", "\n", "            ", "h_n", "=", "thresh", "\n", "w_n", "=", "w", "*", "thresh", "/", "h", "\n", "w_n", "=", "int", "(", "w_n", ")", "\n", "image", "=", "cv2", ".", "resize", "(", "image", ",", "(", "w_n", ",", "h_n", ")", ",", "interpolation", "=", "cv2", ".", "INTER_NEAREST", ")", "\n", "return", "image", "\n", "", "else", ":", "\n", "            ", "return", "image", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.saliency.SaliencyDataset.__init__": [[11, 47], ["isegm.data.base.ISDataset.__init__", "os.listdir", "os.listdir", "os.listdir", "list", "i.replace", "i.replace().replace", "i.replace().replace", "saliency.SaliencyDataset.image_mask_dict.keys", "i.replace", "i.replace"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_paths", ",", "\n", "images_dir_name", "=", "'img'", ",", "masks_dir_name", "=", "'gt'", ",", "\n", "init_mask_mode", "=", "None", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "SaliencyDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'Saliency'", "\n", "image_mask_dict", "=", "{", "}", "\n", "\n", "# ====== MSRA-10k ======", "\n", "\n", "MSRA_root", "=", "dataset_paths", "[", "0", "]", "+", "'/'", "#'/home/admin/workspace/project/data/datasets/Saliency/MSRA10K_Imgs_GT/Imgs/'", "\n", "file_lst", "=", "os", ".", "listdir", "(", "MSRA_root", ")", "\n", "image_lst", "=", "[", "MSRA_root", "+", "i", "for", "i", "in", "file_lst", "if", "'.jpg'", "in", "i", "]", "\n", "for", "i", "in", "image_lst", ":", "\n", "            ", "mask_path", "=", "i", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", "\n", "image_mask_dict", "[", "i", "]", "=", "mask_path", "\n", "\n", "\n", "# ===== DUT-TR ========", "\n", "", "TR_root", "=", "dataset_paths", "[", "1", "]", "+", "'/'", "#'/home/admin/workspace/project/data/datasets/Saliency/DUTS-TR/DUTS-TR-Image/'", "\n", "file_lst", "=", "os", ".", "listdir", "(", "TR_root", ")", "\n", "image_lst", "=", "[", "TR_root", "+", "i", "for", "i", "in", "file_lst", "if", "'.jpg'", "in", "i", "]", "\n", "for", "i", "in", "image_lst", ":", "\n", "            ", "mask_path", "=", "i", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", ".", "replace", "(", "'DUTS-TR-Image'", ",", "'DUTS-TR-Mask'", ")", "\n", "image_mask_dict", "[", "i", "]", "=", "mask_path", "\n", "\n", "# ===== DUT-TE ========", "\n", "", "TE_root", "=", "dataset_paths", "[", "2", "]", "+", "'/'", "#'/home/admin/workspace/project/data/datasets/Saliency/DUTS-TE/DUTS-TE-Image/'", "\n", "file_lst", "=", "os", ".", "listdir", "(", "TE_root", ")", "\n", "image_lst", "=", "[", "TE_root", "+", "i", "for", "i", "in", "file_lst", "if", "'.jpg'", "in", "i", "]", "\n", "for", "i", "in", "image_lst", ":", "\n", "            ", "mask_path", "=", "i", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", ".", "replace", "(", "'DUTS-TE-Image'", ",", "'DUTS-TE-Mask'", ")", "\n", "image_mask_dict", "[", "i", "]", "=", "mask_path", "\n", "\n", "\n", "", "self", ".", "image_mask_dict", "=", "image_mask_dict", "\n", "self", ".", "dataset_samples", "=", "list", "(", "self", ".", "image_mask_dict", ".", "keys", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.saliency.SaliencyDataset.get_sample": [[48, 62], ["cv2.imread", "cv2.cvtColor", "cv2.imread().astype", "instances_mask.astype.astype.astype", "isegm.data.sample.DSample", "len", "cv2.imread"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_path", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "mask_path", "=", "self", ".", "image_mask_dict", "[", "image_path", "]", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "if", "len", "(", "instances_mask", ".", "shape", ")", "==", "3", ":", "\n", "            ", "instances_mask", "=", "instances_mask", "[", ":", ",", ":", ",", "0", "]", "\n", "", "instances_mask", "=", "instances_mask", ">", "128", "\n", "instances_mask", "=", "instances_mask", ".", "astype", "(", "np", ".", "int32", ")", "\n", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco.CocoDataset.__init__": [[11, 18], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "coco.CocoDataset.load_samples"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco.CocoDataset.load_samples"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "stuff_prob", "=", "0.0", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "CocoDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "split", "=", "split", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "stuff_prob", "=", "stuff_prob", "\n", "\n", "self", ".", "load_samples", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco.CocoDataset.load_samples": [[19, 34], ["set", "set", "open", "json.load"], "methods", ["None"], ["", "def", "load_samples", "(", "self", ")", ":", "\n", "        ", "annotation_path", "=", "self", ".", "dataset_path", "/", "'annotations'", "/", "f'panoptic_{self.split}.json'", "\n", "self", ".", "labels_path", "=", "self", ".", "dataset_path", "/", "'annotations'", "/", "f'panoptic_{self.split}'", "\n", "self", ".", "images_path", "=", "self", ".", "dataset_path", "/", "self", ".", "split", "\n", "\n", "with", "open", "(", "annotation_path", ",", "'r'", ")", "as", "f", ":", "\n", "            ", "annotation", "=", "json", ".", "load", "(", "f", ")", "\n", "\n", "", "self", ".", "dataset_samples", "=", "annotation", "[", "'annotations'", "]", "\n", "\n", "self", ".", "_categories", "=", "annotation", "[", "'categories'", "]", "\n", "self", ".", "_stuff_labels", "=", "[", "x", "[", "'id'", "]", "for", "x", "in", "self", ".", "_categories", "if", "x", "[", "'isthing'", "]", "==", "0", "]", "\n", "self", ".", "_things_labels", "=", "[", "x", "[", "'id'", "]", "for", "x", "in", "self", ".", "_categories", "if", "x", "[", "'isthing'", "]", "==", "1", "]", "\n", "self", ".", "_things_labels_set", "=", "set", "(", "self", ".", "_things_labels", ")", "\n", "self", ".", "_stuff_labels_set", "=", "set", "(", "self", ".", "_stuff_labels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco.CocoDataset.get_sample": [[35, 71], ["cv2.imread", "cv2.cvtColor", "cv2.imread().astype", "numpy.full_like", "isegm.data.sample.DSample", "coco.CocoDataset.get_image_name", "str", "cv2.imread", "things_ids.append", "stuff_ids.append", "random.random", "str"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco.CocoDataset.get_image_name"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "dataset_sample", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "\n", "image_path", "=", "self", ".", "images_path", "/", "self", ".", "get_image_name", "(", "dataset_sample", "[", "'file_name'", "]", ")", "\n", "label_path", "=", "self", ".", "labels_path", "/", "dataset_sample", "[", "'file_name'", "]", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "str", "(", "image_path", ")", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "label", "=", "cv2", ".", "imread", "(", "str", "(", "label_path", ")", ",", "cv2", ".", "IMREAD_UNCHANGED", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "label", "=", "256", "*", "256", "*", "label", "[", ":", ",", ":", ",", "0", "]", "+", "256", "*", "label", "[", ":", ",", ":", ",", "1", "]", "+", "label", "[", ":", ",", ":", ",", "2", "]", "\n", "\n", "instance_map", "=", "np", ".", "full_like", "(", "label", ",", "0", ")", "\n", "things_ids", "=", "[", "]", "\n", "stuff_ids", "=", "[", "]", "\n", "\n", "for", "segment", "in", "dataset_sample", "[", "'segments_info'", "]", ":", "\n", "            ", "class_id", "=", "segment", "[", "'category_id'", "]", "\n", "obj_id", "=", "segment", "[", "'id'", "]", "\n", "if", "class_id", "in", "self", ".", "_things_labels_set", ":", "\n", "                ", "if", "segment", "[", "'iscrowd'", "]", "==", "1", ":", "\n", "                    ", "continue", "\n", "", "things_ids", ".", "append", "(", "obj_id", ")", "\n", "", "else", ":", "\n", "                ", "stuff_ids", ".", "append", "(", "obj_id", ")", "\n", "\n", "", "instance_map", "[", "label", "==", "obj_id", "]", "=", "obj_id", "\n", "\n", "", "if", "self", ".", "stuff_prob", ">", "0", "and", "random", ".", "random", "(", ")", "<", "self", ".", "stuff_prob", ":", "\n", "            ", "instances_ids", "=", "things_ids", "+", "stuff_ids", "\n", "", "else", ":", "\n", "            ", "instances_ids", "=", "things_ids", "\n", "\n", "for", "stuff_id", "in", "stuff_ids", ":", "\n", "                ", "instance_map", "[", "instance_map", "==", "stuff_id", "]", "=", "0", "\n", "\n", "", "", "return", "DSample", "(", "image", ",", "instance_map", ",", "objects_ids", "=", "instances_ids", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco.CocoDataset.get_image_name": [[72, 75], ["panoptic_name.replace"], "methods", ["None"], ["", "@", "classmethod", "\n", "def", "get_image_name", "(", "cls", ",", "panoptic_name", ")", ":", "\n", "        ", "return", "panoptic_name", ".", "replace", "(", "'.png'", ",", "'.jpg'", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.grabcut.GrabCutDataset.__init__": [[11, 22], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "sorted", "grabcut.GrabCutDataset._insts_path.glob", "grabcut.GrabCutDataset._images_path.glob"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "\n", "images_dir_name", "=", "'data_GT'", ",", "masks_dir_name", "=", "'boundary_GT'", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "GrabCutDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'GrabCut'", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_images_path", "=", "self", ".", "dataset_path", "/", "images_dir_name", "\n", "self", ".", "_insts_path", "=", "self", ".", "dataset_path", "/", "masks_dir_name", "\n", "\n", "self", ".", "dataset_samples", "=", "[", "x", ".", "name", "for", "x", "in", "sorted", "(", "self", ".", "_images_path", ".", "glob", "(", "'*.*'", ")", ")", "]", "\n", "self", ".", "_masks_paths", "=", "{", "x", ".", "stem", ":", "x", "for", "x", "in", "self", ".", "_insts_path", ".", "glob", "(", "'*.*'", ")", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.grabcut.GrabCutDataset.get_sample": [[23, 35], ["str", "str", "cv2.imread", "cv2.cvtColor", "[].astype", "isegm.data.sample.DSample", "cv2.imread", "image_name.split"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_name", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "str", "(", "self", ".", "_images_path", "/", "image_name", ")", "\n", "mask_path", "=", "str", "(", "self", ".", "_masks_paths", "[", "image_name", ".", "split", "(", "'.'", ")", "[", "0", "]", "]", ")", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", "[", ":", ",", ":", ",", "0", "]", ".", "astype", "(", "np", ".", "int32", ")", "\n", "instances_mask", "[", "instances_mask", "==", "128", "]", "=", "-", "1", "\n", "instances_mask", "[", "instances_mask", ">", "128", "]", "=", "1", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "ignore_ids", "=", "[", "-", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.davis.DavisDataset.__init__": [[11, 23], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "sorted", "davis.DavisDataset._insts_path.glob", "davis.DavisDataset._images_path.glob"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "\n", "images_dir_name", "=", "'img'", ",", "masks_dir_name", "=", "'gt'", ",", "\n", "init_mask_mode", "=", "None", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "DavisDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'Davis'", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_images_path", "=", "self", ".", "dataset_path", "/", "images_dir_name", "\n", "self", ".", "_insts_path", "=", "self", ".", "dataset_path", "/", "masks_dir_name", "\n", "\n", "self", ".", "dataset_samples", "=", "[", "x", ".", "name", "for", "x", "in", "sorted", "(", "self", ".", "_images_path", ".", "glob", "(", "'*.*'", ")", ")", "]", "\n", "self", ".", "_masks_paths", "=", "{", "x", ".", "stem", ":", "x", "for", "x", "in", "self", ".", "_insts_path", ".", "glob", "(", "'*.*'", ")", "}", "\n", "self", ".", "init_mask_mode", "=", "init_mask_mode", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.davis.DavisDataset.get_sample": [[24, 49], ["str", "str", "cv2.imread", "cv2.cvtColor", "numpy.max", "isegm.data.sample.DSample", "cv2.imread().astype", "image_name.replace", "cv2.imread", "cv2.imread", "image_name.split"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_name", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "str", "(", "self", ".", "_images_path", "/", "image_name", ")", "\n", "mask_path", "=", "str", "(", "self", ".", "_masks_paths", "[", "image_name", ".", "split", "(", "'.'", ")", "[", "0", "]", "]", ")", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "np", ".", "max", "(", "cv2", ".", "imread", "(", "mask_path", ")", ".", "astype", "(", "np", ".", "int32", ")", ",", "axis", "=", "2", ")", "\n", "instances_mask", "[", "instances_mask", ">", "0", "]", "=", "1", "\n", "\n", "init_mask_dir", "=", "None", "\n", "if", "self", ".", "init_mask_mode", "==", "'low'", ":", "\n", "            ", "init_mask_dir", "=", "'/home/admin/workspace/project/data/datasets/DAVIS_Edit/DAVIS_low/'", "\n", "", "elif", "self", ".", "init_mask_mode", "==", "'mid'", ":", "\n", "            ", "init_mask_dir", "=", "'/home/admin/workspace/project/data/datasets/DAVIS_Edit/DAVIS_mid/'", "\n", "", "elif", "self", ".", "init_mask_mode", "==", "'high'", ":", "\n", "            ", "init_mask_dir", "=", "'/home/admin/workspace/project/data/datasets/DAVIS_Edit/DAVIS_high/'", "\n", "\n", "", "if", "init_mask_dir", "is", "not", "None", ":", "\n", "            ", "init_mask_path", "=", "init_mask_dir", "+", "image_name", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", "\n", "init_mask", "=", "cv2", ".", "imread", "(", "init_mask_path", ")", "[", ":", ",", ":", ",", "0", "]", ">", "0", "\n", "", "else", ":", "\n", "            ", "init_mask", "=", "None", "\n", "\n", "", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "sample_id", "=", "index", ",", "init_mask", "=", "init_mask", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDDataset.__init__": [[14, 27], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "dict", "open", "x.strip", "f.readlines"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "buggy_mask_thresh", "=", "0.08", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "SBDDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "assert", "split", "in", "{", "'train'", ",", "'val'", "}", "\n", "self", ".", "name", "=", "'SBD'", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "dataset_split", "=", "split", "\n", "self", ".", "_images_path", "=", "self", ".", "dataset_path", "/", "'img'", "\n", "self", ".", "_insts_path", "=", "self", ".", "dataset_path", "/", "'inst'", "\n", "self", ".", "_buggy_objects", "=", "dict", "(", ")", "\n", "self", ".", "_buggy_mask_thresh", "=", "buggy_mask_thresh", "\n", "\n", "with", "open", "(", "self", ".", "dataset_path", "/", "f'{split}.txt'", ",", "'r'", ")", "as", "f", ":", "\n", "            ", "self", ".", "dataset_samples", "=", "[", "x", ".", "strip", "(", ")", "for", "x", "in", "f", ".", "readlines", "(", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDDataset.get_sample": [[28, 40], ["str", "str", "cv2.imread", "cv2.cvtColor", "[].astype", "sbd.SBDDataset.remove_buggy_masks", "isegm.utils.misc.get_labels_with_sizes", "isegm.data.sample.DSample", "scipy.io.loadmat", "str"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDDataset.remove_buggy_masks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_labels_with_sizes"], ["", "", "def", "get_sample", "(", "self", ",", "index", ")", ":", "\n", "        ", "image_name", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "str", "(", "self", ".", "_images_path", "/", "f'{image_name}.jpg'", ")", "\n", "inst_info_path", "=", "str", "(", "self", ".", "_insts_path", "/", "f'{image_name}.mat'", ")", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "loadmat", "(", "str", "(", "inst_info_path", ")", ")", "[", "'GTinst'", "]", "[", "0", "]", "[", "0", "]", "[", "0", "]", ".", "astype", "(", "np", ".", "int32", ")", "\n", "instances_mask", "=", "self", ".", "remove_buggy_masks", "(", "index", ",", "instances_mask", ")", "\n", "instances_ids", ",", "_", "=", "get_labels_with_sizes", "(", "instances_mask", ")", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "instances_ids", ",", "sample_id", "=", "index", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDDataset.remove_buggy_masks": [[41, 61], ["sbd.SBDDataset._buggy_objects.get", "isegm.utils.misc.get_labels_with_sizes", "obj_mask.sum", "isegm.utils.misc.get_bbox_from_mask", "sbd.SBDDataset.append"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_labels_with_sizes", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask"], ["", "def", "remove_buggy_masks", "(", "self", ",", "index", ",", "instances_mask", ")", ":", "\n", "        ", "if", "self", ".", "_buggy_mask_thresh", ">", "0.0", ":", "\n", "            ", "buggy_image_objects", "=", "self", ".", "_buggy_objects", ".", "get", "(", "index", ",", "None", ")", "\n", "if", "buggy_image_objects", "is", "None", ":", "\n", "                ", "buggy_image_objects", "=", "[", "]", "\n", "instances_ids", ",", "_", "=", "get_labels_with_sizes", "(", "instances_mask", ")", "\n", "for", "obj_id", "in", "instances_ids", ":", "\n", "                    ", "obj_mask", "=", "instances_mask", "==", "obj_id", "\n", "mask_area", "=", "obj_mask", ".", "sum", "(", ")", "\n", "bbox", "=", "get_bbox_from_mask", "(", "obj_mask", ")", "\n", "bbox_area", "=", "(", "bbox", "[", "1", "]", "-", "bbox", "[", "0", "]", "+", "1", ")", "*", "(", "bbox", "[", "3", "]", "-", "bbox", "[", "2", "]", "+", "1", ")", "\n", "obj_area_ratio", "=", "mask_area", "/", "bbox_area", "\n", "if", "obj_area_ratio", "<", "self", ".", "_buggy_mask_thresh", ":", "\n", "                        ", "buggy_image_objects", ".", "append", "(", "obj_id", ")", "\n", "\n", "", "", "self", ".", "_buggy_objects", "[", "index", "]", "=", "buggy_image_objects", "\n", "", "for", "obj_id", "in", "buggy_image_objects", ":", "\n", "                ", "instances_mask", "[", "instances_mask", "==", "obj_id", "]", "=", "0", "\n", "\n", "", "", "return", "instances_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDEvaluationDataset.__init__": [[64, 77], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "sbd.SBDEvaluationDataset.get_sbd_images_and_ids_list", "open", "x.strip", "f.readlines"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDEvaluationDataset.get_sbd_images_and_ids_list"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'val'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "SBDEvaluationDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "assert", "split", "in", "{", "'train'", ",", "'val'", "}", "\n", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "dataset_split", "=", "split", "\n", "self", ".", "_images_path", "=", "self", ".", "dataset_path", "/", "'img'", "\n", "self", ".", "_insts_path", "=", "self", ".", "dataset_path", "/", "'inst'", "\n", "\n", "with", "open", "(", "self", ".", "dataset_path", "/", "f'{split}.txt'", ",", "'r'", ")", "as", "f", ":", "\n", "            ", "self", ".", "dataset_samples", "=", "[", "x", ".", "strip", "(", ")", "for", "x", "in", "f", ".", "readlines", "(", ")", "]", "\n", "\n", "", "self", ".", "dataset_samples", "=", "self", ".", "get_sbd_images_and_ids_list", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDEvaluationDataset.get_sample": [[78, 90], ["str", "str", "cv2.imread", "cv2.cvtColor", "[].astype", "isegm.data.sample.DSample", "scipy.io.loadmat", "str"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_name", ",", "instance_id", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "str", "(", "self", ".", "_images_path", "/", "f'{image_name}.jpg'", ")", "\n", "inst_info_path", "=", "str", "(", "self", ".", "_insts_path", "/", "f'{image_name}.mat'", ")", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "loadmat", "(", "str", "(", "inst_info_path", ")", ")", "[", "'GTinst'", "]", "[", "0", "]", "[", "0", "]", "[", "0", "]", ".", "astype", "(", "np", ".", "int32", ")", "\n", "instances_mask", "[", "instances_mask", "!=", "instance_id", "]", "=", "0", "\n", "instances_mask", "[", "instances_mask", ">", "0", "]", "=", "1", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.sbd.SBDEvaluationDataset.get_sbd_images_and_ids_list": [[91, 112], ["pkl_path.exists", "open", "pickle.load", "str", "[].astype", "isegm.utils.misc.get_labels_with_sizes", "open", "pickle.dump", "str", "pickle.load.append", "str", "scipy.io.loadmat", "str"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_labels_with_sizes"], ["", "def", "get_sbd_images_and_ids_list", "(", "self", ")", ":", "\n", "        ", "pkl_path", "=", "self", ".", "dataset_path", "/", "f'{self.dataset_split}_images_and_ids_list.pkl'", "\n", "\n", "if", "pkl_path", ".", "exists", "(", ")", ":", "\n", "            ", "with", "open", "(", "str", "(", "pkl_path", ")", ",", "'rb'", ")", "as", "fp", ":", "\n", "                ", "images_and_ids_list", "=", "pkl", ".", "load", "(", "fp", ")", "\n", "", "", "else", ":", "\n", "            ", "images_and_ids_list", "=", "[", "]", "\n", "\n", "for", "sample", "in", "self", ".", "dataset_samples", ":", "\n", "                ", "inst_info_path", "=", "str", "(", "self", ".", "_insts_path", "/", "f'{sample}.mat'", ")", "\n", "instances_mask", "=", "loadmat", "(", "str", "(", "inst_info_path", ")", ")", "[", "'GTinst'", "]", "[", "0", "]", "[", "0", "]", "[", "0", "]", ".", "astype", "(", "np", ".", "int32", ")", "\n", "instances_ids", ",", "_", "=", "get_labels_with_sizes", "(", "instances_mask", ")", "\n", "\n", "for", "instances_id", "in", "instances_ids", ":", "\n", "                    ", "images_and_ids_list", ".", "append", "(", "(", "sample", ",", "instances_id", ")", ")", "\n", "\n", "", "", "with", "open", "(", "str", "(", "pkl_path", ")", ",", "'wb'", ")", "as", "fp", ":", "\n", "                ", "pkl", ".", "dump", "(", "images_and_ids_list", ",", "fp", ")", "\n", "\n", "", "", "return", "images_and_ids_list", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.cocomval.COCOMValDataset.__init__": [[11, 29], ["isegm.data.base.ISDataset.__init__", "os.listdir", "list", "i.replace().replace", "cocomval.COCOMValDataset.image_mask_dict.keys", "i.replace"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "\n", "images_dir_name", "=", "'img'", ",", "masks_dir_name", "=", "'gt'", ",", "\n", "init_mask_mode", "=", "None", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "COCOMValDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'COCOMVal'", "\n", "image_mask_dict", "=", "{", "}", "\n", "\n", "mval_root", "=", "dataset_path", "+", "'/'", "\n", "image_dir", "=", "mval_root", "+", "'img/'", "\n", "gt_dir", "=", "mval_root", "+", "'gt/'", "\n", "file_lst", "=", "os", ".", "listdir", "(", "image_dir", ")", "\n", "image_lst", "=", "[", "image_dir", "+", "i", "for", "i", "in", "file_lst", "if", "'.jpg'", "in", "i", "]", "\n", "for", "i", "in", "image_lst", ":", "\n", "            ", "mask_path", "=", "i", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", ".", "replace", "(", "'/img/'", ",", "'/gt/'", ")", "\n", "image_mask_dict", "[", "i", "]", "=", "mask_path", "\n", "\n", "", "self", ".", "image_mask_dict", "=", "image_mask_dict", "\n", "self", ".", "dataset_samples", "=", "list", "(", "self", ".", "image_mask_dict", ".", "keys", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.cocomval.COCOMValDataset.get_sample": [[30, 44], ["cv2.imread", "cv2.cvtColor", "cv2.imread().astype", "instances_mask.astype.astype.astype", "isegm.data.sample.DSample", "len", "cv2.imread"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_path", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "mask_path", "=", "self", ".", "image_mask_dict", "[", "image_path", "]", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "if", "len", "(", "instances_mask", ".", "shape", ")", "==", "3", ":", "\n", "            ", "instances_mask", "=", "instances_mask", "[", ":", ",", ":", ",", "0", "]", "\n", "", "instances_mask", "=", "instances_mask", ">", "128", "\n", "instances_mask", "=", "instances_mask", ".", "astype", "(", "np", ".", "int32", ")", "\n", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.images_dir.ImagesDirDataset.__init__": [[10, 38], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "images_dir.ImagesDirDataset._insts_path.glob", "samples.values", "mask_name.split", "mask_name_split[].isdigit", "sorted", "[].append", "[].append", "len", "sorted", "images_dir.ImagesDirDataset._images_path.glob", "samples.items"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "\n", "images_dir_name", "=", "'images'", ",", "masks_dir_name", "=", "'masks'", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "ImagesDirDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_images_path", "=", "self", ".", "dataset_path", "/", "images_dir_name", "\n", "self", ".", "_insts_path", "=", "self", ".", "dataset_path", "/", "masks_dir_name", "\n", "\n", "images_list", "=", "[", "x", "for", "x", "in", "sorted", "(", "self", ".", "_images_path", ".", "glob", "(", "'*.*'", ")", ")", "]", "\n", "\n", "samples", "=", "{", "x", ".", "stem", ":", "{", "'image'", ":", "x", ",", "'masks'", ":", "[", "]", "}", "for", "x", "in", "images_list", "}", "\n", "for", "mask_path", "in", "self", ".", "_insts_path", ".", "glob", "(", "'*.*'", ")", ":", "\n", "            ", "mask_name", "=", "mask_path", ".", "stem", "\n", "if", "mask_name", "in", "samples", ":", "\n", "                ", "samples", "[", "mask_name", "]", "[", "'masks'", "]", ".", "append", "(", "mask_path", ")", "\n", "continue", "\n", "\n", "", "mask_name_split", "=", "mask_name", ".", "split", "(", "'_'", ")", "\n", "if", "mask_name_split", "[", "-", "1", "]", ".", "isdigit", "(", ")", ":", "\n", "                ", "mask_name", "=", "'_'", ".", "join", "(", "mask_name_split", "[", ":", "-", "1", "]", ")", "\n", "assert", "mask_name", "in", "samples", "\n", "samples", "[", "mask_name", "]", "[", "'masks'", "]", ".", "append", "(", "mask_path", ")", "\n", "\n", "", "", "for", "x", "in", "samples", ".", "values", "(", ")", ":", "\n", "            ", "assert", "len", "(", "x", "[", "'masks'", "]", ")", ">", "0", ",", "x", "[", "'image'", "]", "\n", "\n", "", "self", ".", "dataset_samples", "=", "[", "v", "for", "k", ",", "v", "in", "sorted", "(", "samples", ".", "items", "(", ")", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.images_dir.ImagesDirDataset.get_sample": [[39, 60], ["str", "enumerate", "cv2.imread", "cv2.cvtColor", "isegm.data.sample.DSample", "[].astype", "numpy.zeros_like", "masks.append", "objects.append", "ignored_regions.append", "numpy.stack", "cv2.imread", "str"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "sample", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "str", "(", "sample", "[", "'image'", "]", ")", "\n", "\n", "objects", "=", "[", "]", "\n", "ignored_regions", "=", "[", "]", "\n", "masks", "=", "[", "]", "\n", "for", "indx", ",", "mask_path", "in", "enumerate", "(", "sample", "[", "'masks'", "]", ")", ":", "\n", "            ", "gt_mask", "=", "cv2", ".", "imread", "(", "str", "(", "mask_path", ")", ")", "[", ":", ",", ":", ",", "0", "]", ".", "astype", "(", "np", ".", "int32", ")", "\n", "instances_mask", "=", "np", ".", "zeros_like", "(", "gt_mask", ")", "\n", "instances_mask", "[", "gt_mask", "==", "128", "]", "=", "2", "\n", "instances_mask", "[", "gt_mask", ">", "128", "]", "=", "1", "\n", "masks", ".", "append", "(", "instances_mask", ")", "\n", "objects", ".", "append", "(", "(", "indx", ",", "1", ")", ")", "\n", "ignored_regions", ".", "append", "(", "(", "indx", ",", "2", ")", ")", "\n", "\n", "", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "\n", "return", "DSample", "(", "image", ",", "np", ".", "stack", "(", "masks", ",", "axis", "=", "2", ")", ",", "\n", "objects_ids", "=", "objects", ",", "ignore_ids", "=", "ignored_regions", ",", "sample_id", "=", "index", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.davis585.Davis585Dataset.__init__": [[11, 20], ["isegm.data.base.ISDataset.__init__", "davis585.Davis585Dataset.generate_sample_dict", "list", "davis585.Davis585Dataset.sample_dict.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.davis585.Davis585Dataset.generate_sample_dict"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "\n", "images_dir_name", "=", "'img'", ",", "masks_dir_name", "=", "'gt'", ",", "\n", "init_mask_mode", "=", "None", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "Davis585Dataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'D585'", "+", "init_mask_mode", "\n", "self", ".", "dataset_path", "=", "dataset_path", "+", "'/'", "\n", "self", ".", "sample_dict", "=", "self", ".", "generate_sample_dict", "(", "self", ".", "dataset_path", ")", "\n", "self", ".", "dataset_samples", "=", "list", "(", "self", ".", "sample_dict", ".", "keys", "(", ")", ")", "\n", "self", ".", "init_mask_mode", "=", "init_mask_mode", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.davis585.Davis585Dataset.generate_sample_dict": [[21, 39], ["os.listdir", "os.listdir", "[].replace", "gt_name.split"], "methods", ["None"], ["", "def", "generate_sample_dict", "(", "self", ",", "dataset_path", ")", ":", "\n", "#sample_dict = {'mask_path': ['image_path','stm_init_path','sp_init_path']}", "\n", "        ", "sample_dict", "=", "{", "}", "\n", "sequence_names", "=", "os", ".", "listdir", "(", "dataset_path", ")", "\n", "for", "sequence_name", "in", "sequence_names", ":", "\n", "            ", "sequence_dir", "=", "self", ".", "dataset_path", "+", "sequence_name", "+", "'/'", "\n", "gt_names", "=", "os", ".", "listdir", "(", "sequence_dir", ")", "\n", "gt_names", "=", "[", "i", "for", "i", "in", "gt_names", "if", "'.png'", "in", "i", "and", "'init'", "not", "in", "i", "]", "\n", "for", "gt_name", "in", "gt_names", ":", "\n", "                ", "mask_path", "=", "sequence_dir", "+", "gt_name", "\n", "image_name", "=", "gt_name", ".", "split", "(", "'_'", ")", "[", "-", "1", "]", ".", "replace", "(", "'.png'", ",", "'.jpg'", ")", "\n", "image_path", "=", "sequence_dir", "+", "image_name", "\n", "stm_init_name", "=", "'init_stm_'", "+", "gt_name", "\n", "stm_init_path", "=", "sequence_dir", "+", "stm_init_name", "\n", "sp_init_name", "=", "'init_sp_'", "+", "gt_name", "\n", "sp_init_path", "=", "sequence_dir", "+", "sp_init_name", "\n", "sample_dict", "[", "mask_path", "]", "=", "[", "image_path", ",", "stm_init_path", ",", "sp_init_path", "]", "\n", "", "", "return", "sample_dict", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.davis585.Davis585Dataset.get_sample": [[41, 65], ["cv2.imread", "cv2.cvtColor", "isegm.data.sample.DSample", "cv2.imread", "cv2.imread", "cv2.imread"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "mask_path", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "self", ".", "sample_dict", "[", "mask_path", "]", "[", "0", "]", "\n", "stm_init_path", "=", "self", ".", "sample_dict", "[", "mask_path", "]", "[", "1", "]", "\n", "sp_init_path", "=", "self", ".", "sample_dict", "[", "mask_path", "]", "[", "2", "]", "\n", "#print(mask_path,image_path,stm_init_path,sp_init_path)", "\n", "#/home/admin/workspace/project/data/datasets/InterDavis/Selected/bear/init_stm_object1_00009.png", "\n", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", "[", ":", ",", ":", ",", "0", "]", ">", "128", "\n", "stm_init_mask", "=", "cv2", ".", "imread", "(", "stm_init_path", ")", "[", ":", ",", ":", ",", "0", "]", ">", "128", "\n", "sp_init_mask", "=", "cv2", ".", "imread", "(", "sp_init_path", ")", "[", ":", ",", ":", ",", "0", "]", ">", "128", "\n", "\n", "if", "self", ".", "init_mask_mode", "==", "'sp'", ":", "\n", "            ", "init_mask", "=", "sp_init_mask", "\n", "", "elif", "self", ".", "init_mask_mode", "==", "'stm'", ":", "\n", "            ", "init_mask", "=", "stm_init_mask", "\n", "", "elif", "self", ".", "init_mask_mode", "==", "'zero'", ":", "\n", "            ", "init_mask", "=", "None", "\n", "\n", "", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "sample_id", "=", "index", ",", "init_mask", "=", "init_mask", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.ade20k.ADE20kDataset.__init__": [[48, 58], ["isegm.data.base.ISDataset.__init__", "ade20k.iter_files", "list", "ade20k.ADE20kDataset.dataset_samples.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.ade20k.iter_files"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", "=", "None", ",", "with_part", "=", "False", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "ADE20kDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'ADE20K'", "\n", "self", ".", "subset", "=", "'train'", "\n", "self", ".", "dataset_path", "=", "dataset_path", "+", "'/ADE20K_2016_07_26/images/training/'", "\n", "images_dict", "=", "iter_files", "(", "self", ".", "dataset_path", ",", "with_part", "=", "with_part", ")", "\n", "self", ".", "dataset_samples", "=", "images_dict", "\n", "image_lst", "=", "list", "(", "self", ".", "dataset_samples", ".", "keys", "(", ")", ")", "\n", "self", ".", "image_lst", "=", "image_lst", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.ade20k.ADE20kDataset.get_sample": [[60, 76], ["cv2.imread", "cv2.imread", "cv2.imread", "cv2.imread", "cv2.cvtColor", "cv2.cvtColor", "cv2.cvtColor", "cv2.cvtColor", "[].astype", "numpy.unique", "numpy.unique", "isegm.data.sample.DSample", "len", "numpy.random.randint", "numpy.random.randint", "str", "len", "cv2.imread", "cv2.imread", "cv2.imread", "cv2.imread", "str"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", ":", "\n", "        ", "image_path", "=", "self", ".", "image_lst", "[", "index", "]", "\n", "mask_lst", "=", "self", ".", "dataset_samples", "[", "image_path", "]", "\n", "if", "len", "(", "mask_lst", ")", ">", "1", ":", "\n", "            ", "idx", "=", "np", ".", "random", ".", "randint", "(", "len", "(", "mask_lst", ")", ")", "\n", "", "else", ":", "\n", "            ", "idx", "=", "0", "\n", "", "mask_path", "=", "mask_lst", "[", "idx", "]", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "str", "(", "image_path", ")", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "str", "(", "mask_path", ")", ",", "cv2", ".", "IMREAD_UNCHANGED", ")", "[", ":", ",", ":", ",", "0", "]", ".", "astype", "(", "np", ".", "int32", ")", "\n", "instances_ids", "=", "np", ".", "unique", "(", "instances_mask", ")", "\n", "instances_ids", "=", "[", "i", "for", "i", "in", "instances_ids", "if", "i", "!=", "0", "]", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "instances_ids", ",", "ignore_ids", "=", "[", "-", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.ade20k.iter_files": [[23, 43], ["print", "tqdm.tqdm", "os.walk", "os.walk", "os.path.join", "os.path.join", "os.path.join.endswith", "os.path.join.replace", "mask_lst.append", "os.path.join.replace", "os.path.exists", "os.path.exists", "mask_lst.append", "os.path.join.replace", "os.path.exists", "os.path.exists", "mask_lst.append"], "function", ["None"], ["def", "iter_files", "(", "root_dir", ",", "with_part", "=", "False", ")", ":", "\n", "    ", "image_path_dict", "=", "{", "}", "\n", "print", "(", "'=== Loading ADE20k data ==== '", ")", "\n", "for", "root", ",", "dirs", ",", "files", "in", "tqdm", "(", "os", ".", "walk", "(", "root_dir", ")", ")", ":", "\n", "        ", "for", "file", "in", "files", ":", "\n", "            ", "file_name", "=", "os", ".", "path", ".", "join", "(", "root", ",", "file", ")", "\n", "if", "file_name", ".", "endswith", "(", "'.jpg'", ")", ":", "\n", "                ", "mask_lst", "=", "[", "]", "\n", "seg_path", "=", "file_name", ".", "replace", "(", "'.jpg'", ",", "'_seg.png'", ")", "\n", "mask_lst", ".", "append", "(", "seg_path", ")", "\n", "\n", "if", "with_part", "==", "True", ":", "\n", "                    ", "part_1_path", "=", "file_name", ".", "replace", "(", "'.jpg'", ",", "'_parts_1.png'", ")", "\n", "if", "os", ".", "path", ".", "exists", "(", "part_1_path", ")", ":", "\n", "                        ", "mask_lst", ".", "append", "(", "part_1_path", ")", "\n", "part_2_path", "=", "file_name", ".", "replace", "(", "'.jpg'", ",", "'_parts_2.png'", ")", "\n", "if", "os", ".", "path", ".", "exists", "(", "part_2_path", ")", ":", "\n", "                            ", "mask_lst", ".", "append", "(", "part_2_path", ")", "\n", "", "", "", "image_path_dict", "[", "file_name", "]", "=", "mask_lst", "\n", "", "", "", "return", "image_path_dict", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco_lvis.CocoLvisDataset.__init__": [[13, 38], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "open", "sorted", "set", "pickle.load().items", "open", "json.load", "pickle.load"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "img_split", "=", "'train2017'", ",", "stuff_prob", "=", "0.0", ",", "\n", "allow_list_name", "=", "None", ",", "anno_file", "=", "'hannotation.pickle'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "CocoLvisDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_split_path", "=", "dataset_path", "/", "split", "\n", "self", ".", "img_split_path", "=", "dataset_path", "/", "img_split", "\n", "self", ".", "split", "=", "split", "\n", "self", ".", "img_split", "=", "img_split", "\n", "self", ".", "_images_path", "=", "self", ".", "_split_path", "/", "'images'", "\n", "#self._images_path = self.img_split_path / 'images'", "\n", "\n", "self", ".", "_masks_path", "=", "self", ".", "_split_path", "/", "'masks'", "\n", "self", ".", "stuff_prob", "=", "stuff_prob", "\n", "\n", "with", "open", "(", "self", ".", "_split_path", "/", "anno_file", ",", "'rb'", ")", "as", "f", ":", "\n", "            ", "self", ".", "dataset_samples", "=", "sorted", "(", "pickle", ".", "load", "(", "f", ")", ".", "items", "(", ")", ")", "\n", "\n", "", "if", "allow_list_name", "is", "not", "None", ":", "\n", "            ", "allow_list_path", "=", "self", ".", "_split_path", "/", "allow_list_name", "\n", "with", "open", "(", "allow_list_path", ",", "'r'", ")", "as", "f", ":", "\n", "                ", "allow_images_ids", "=", "json", ".", "load", "(", "f", ")", "\n", "", "allow_images_ids", "=", "set", "(", "allow_images_ids", ")", "\n", "\n", "self", ".", "dataset_samples", "=", "[", "sample", "for", "sample", "in", "self", ".", "dataset_samples", "\n", "if", "sample", "[", "0", "]", "in", "allow_images_ids", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco_lvis.CocoLvisDataset.get_sample": [[39, 77], ["cv2.imread", "cv2.cvtColor", "numpy.stack", "copy.deepcopy", "list", "isegm.data.sample.DSample", "str", "open", "pickle.load", "cv2.imdecode", "copy.deepcopy.items", "range", "range", "random.random", "len", "len"], "methods", ["None"], ["", "", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_id", ",", "sample", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "self", ".", "_images_path", "/", "f'{image_id}.jpg'", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "str", "(", "image_path", ")", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "packed_masks_path", "=", "self", ".", "_masks_path", "/", "f'{image_id}.pickle'", "\n", "\n", "\n", "with", "open", "(", "packed_masks_path", ",", "'rb'", ")", "as", "f", ":", "\n", "            ", "encoded_layers", ",", "objs_mapping", "=", "pickle", ".", "load", "(", "f", ")", "\n", "", "layers", "=", "[", "cv2", ".", "imdecode", "(", "x", ",", "cv2", ".", "IMREAD_UNCHANGED", ")", "for", "x", "in", "encoded_layers", "]", "\n", "layers", "=", "np", ".", "stack", "(", "layers", ",", "axis", "=", "2", ")", "\n", "\n", "instances_info", "=", "deepcopy", "(", "sample", "[", "'hierarchy'", "]", ")", "\n", "\n", "for", "inst_id", ",", "inst_info", "in", "list", "(", "instances_info", ".", "items", "(", ")", ")", ":", "\n", "            ", "if", "inst_info", "is", "None", ":", "\n", "                ", "inst_info", "=", "{", "'children'", ":", "[", "]", ",", "'parent'", ":", "None", ",", "'node_level'", ":", "0", "}", "\n", "instances_info", "[", "inst_id", "]", "=", "inst_info", "\n", "", "inst_info", "[", "'mapping'", "]", "=", "objs_mapping", "[", "inst_id", "]", "\n", "\n", "", "if", "self", ".", "stuff_prob", ">", "0", "and", "random", ".", "random", "(", ")", "<", "self", ".", "stuff_prob", ":", "\n", "            ", "for", "inst_id", "in", "range", "(", "sample", "[", "'num_instance_masks'", "]", ",", "len", "(", "objs_mapping", ")", ")", ":", "\n", "                ", "instances_info", "[", "inst_id", "]", "=", "{", "\n", "'mapping'", ":", "objs_mapping", "[", "inst_id", "]", ",", "\n", "'parent'", ":", "None", ",", "\n", "'children'", ":", "[", "]", "\n", "}", "\n", "", "", "else", ":", "\n", "            ", "for", "inst_id", "in", "range", "(", "sample", "[", "'num_instance_masks'", "]", ",", "len", "(", "objs_mapping", ")", ")", ":", "\n", "                ", "layer_indx", ",", "mask_id", "=", "objs_mapping", "[", "inst_id", "]", "\n", "layers", "[", ":", ",", ":", ",", "layer_indx", "]", "[", "layers", "[", ":", ",", ":", ",", "layer_indx", "]", "==", "mask_id", "]", "=", "0", "\n", "\n", "\n", "\n", "#return DSample(image, layers, objects_ids=np.unique(layers), sample_id=index)", "\n", "", "", "return", "DSample", "(", "image", ",", "layers", ",", "objects", "=", "instances_info", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.openimages.OpenImagesDataset.__init__": [[14, 32], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "os.path.exists", "RuntimeError", "clean_anno_path.open", "pickle.load"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "assert", "split", "in", "{", "'train'", ",", "'val'", ",", "'test'", "}", "\n", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_split_path", "=", "self", ".", "dataset_path", "/", "split", "\n", "self", ".", "_images_path", "=", "self", ".", "_split_path", "/", "'images'", "\n", "self", ".", "_masks_path", "=", "self", ".", "_split_path", "/", "'masks'", "\n", "self", ".", "dataset_split", "=", "split", "\n", "\n", "clean_anno_path", "=", "self", ".", "_split_path", "/", "f'{split}-annotations-object-segmentation_clean.pkl'", "\n", "if", "os", ".", "path", ".", "exists", "(", "clean_anno_path", ")", ":", "\n", "            ", "with", "clean_anno_path", ".", "open", "(", "'rb'", ")", "as", "f", ":", "\n", "                ", "annotations", "=", "pkl", ".", "load", "(", "f", ")", "\n", "", "", "else", ":", "\n", "            ", "raise", "RuntimeError", "(", "f\"Can't find annotations at {clean_anno_path}\"", ")", "\n", "", "self", ".", "image_id_to_masks", "=", "annotations", "[", "'image_id_to_masks'", "]", "\n", "self", ".", "dataset_samples", "=", "annotations", "[", "'dataset_samples'", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.openimages.OpenImagesDataset.get_sample": [[33, 59], ["str", "cv2.imread", "cv2.cvtColor", "str", "cv2.imread", "cv2.cvtColor", "cv2.resize.astype", "min", "min", "isegm.data.sample.DSample", "cv2.resize", "cv2.resize", "random.choice", "cv2.resize.sum"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_id", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "\n", "image_path", "=", "str", "(", "self", ".", "_images_path", "/", "f'{image_id}.jpg'", ")", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "\n", "mask_paths", "=", "self", ".", "image_id_to_masks", "[", "image_id", "]", "\n", "# select random mask for an image", "\n", "mask_path", "=", "str", "(", "self", ".", "_masks_path", "/", "random", ".", "choice", "(", "mask_paths", ")", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", "\n", "instances_mask", "=", "cv2", ".", "cvtColor", "(", "instances_mask", ",", "cv2", ".", "COLOR_BGR2GRAY", ")", "\n", "instances_mask", "[", "instances_mask", ">", "0", "]", "=", "1", "\n", "instances_mask", "=", "instances_mask", ".", "astype", "(", "np", ".", "int32", ")", "\n", "\n", "min_width", "=", "min", "(", "image", ".", "shape", "[", "1", "]", ",", "instances_mask", ".", "shape", "[", "1", "]", ")", "\n", "min_height", "=", "min", "(", "image", ".", "shape", "[", "0", "]", ",", "instances_mask", ".", "shape", "[", "0", "]", ")", "\n", "\n", "if", "image", ".", "shape", "[", "0", "]", "!=", "min_height", "or", "image", ".", "shape", "[", "1", "]", "!=", "min_width", ":", "\n", "            ", "image", "=", "cv2", ".", "resize", "(", "image", ",", "(", "min_width", ",", "min_height", ")", ",", "interpolation", "=", "cv2", ".", "INTER_LINEAR", ")", "\n", "", "if", "instances_mask", ".", "shape", "[", "0", "]", "!=", "min_height", "or", "instances_mask", ".", "shape", "[", "1", "]", "!=", "min_width", ":", "\n", "            ", "instances_mask", "=", "cv2", ".", "resize", "(", "instances_mask", ",", "(", "min_width", ",", "min_height", ")", ",", "interpolation", "=", "cv2", ".", "INTER_NEAREST", ")", "\n", "\n", "", "object_ids", "=", "[", "1", "]", "if", "instances_mask", ".", "sum", "(", ")", ">", "0", "else", "[", "]", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "object_ids", ",", "sample_id", "=", "index", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.thinobject.ThinObjectDataset.__init__": [[11, 35], ["isegm.data.base.ISDataset.__init__", "os.listdir", "list", "os.path.join", "i.replace", "os.path.join", "os.path.join", "thinobject.ThinObjectDataset.mask_image_dict.keys"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "\n", "images_dir_name", "=", "'img'", ",", "masks_dir_name", "=", "'gt'", ",", "\n", "init_mask_mode", "=", "None", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "ThinObjectDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'ThinObject'", "\n", "# ====== ThinObjectDataset ======", "\n", "\n", "root", "=", "dataset_path", "#'/home/admin/workspace/project/data/datasets/ThinObject/ThinObject5K/'", "\n", "mask_dir", "=", "'masks'", "\n", "image_dir", "=", "'images'", "\n", "\n", "file_lst", "=", "os", ".", "listdir", "(", "os", ".", "path", ".", "join", "(", "root", ",", "mask_dir", ")", ")", "\n", "mask_lst", "=", "[", "i", "for", "i", "in", "file_lst", "if", "'.png'", "in", "i", "]", "\n", "mask_image_dict", "=", "{", "}", "\n", "\n", "\n", "for", "i", "in", "mask_lst", ":", "\n", "            ", "image_name", "=", "i", ".", "replace", "(", "'.png'", ",", "'.jpg'", ")", "\n", "image_path", "=", "os", ".", "path", ".", "join", "(", "root", ",", "image_dir", ",", "image_name", ")", "#root + image_dir + image_name", "\n", "mask_path", "=", "os", ".", "path", ".", "join", "(", "root", ",", "mask_dir", ",", "i", ")", "#root + mask_dir + i", "\n", "mask_image_dict", "[", "mask_path", "]", "=", "image_path", "\n", "\n", "", "self", ".", "mask_image_dict", "=", "mask_image_dict", "\n", "self", ".", "dataset_samples", "=", "list", "(", "self", ".", "mask_image_dict", ".", "keys", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.thinobject.ThinObjectDataset.get_sample": [[36, 50], ["cv2.imread", "cv2.cvtColor", "cv2.imread().astype", "instances_mask.astype.astype.astype", "isegm.data.sample.DSample", "len", "cv2.imread"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "mask_path", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "self", ".", "mask_image_dict", "[", "mask_path", "]", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "if", "len", "(", "instances_mask", ".", "shape", ")", "==", "3", ":", "\n", "            ", "instances_mask", "=", "instances_mask", "[", ":", ",", ":", ",", "0", "]", "\n", "", "instances_mask", "=", "instances_mask", ">", "128", "\n", "instances_mask", "=", "instances_mask", ".", "astype", "(", "np", ".", "int32", ")", "\n", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.hflicker.HFlickerDataset.__init__": [[11, 35], ["isegm.data.base.ISDataset.__init__", "os.listdir", "list", "hflicker.HFlickerDataset.mask_image_dict.keys", "i.split"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "\n", "images_dir_name", "=", "'img'", ",", "masks_dir_name", "=", "'gt'", ",", "\n", "init_mask_mode", "=", "None", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "HFlickerDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'HFlicker'", "\n", "# ====== HFlicker ======", "\n", "\n", "root", "=", "dataset_path", "#'/home/admin/workspace/project/data/datasets/HFlickr/'", "\n", "mask_dir", "=", "'/masks/'", "\n", "image_dir", "=", "'/real_images/'", "\n", "\n", "file_lst", "=", "os", ".", "listdir", "(", "root", "+", "mask_dir", ")", "\n", "mask_lst", "=", "[", "i", "for", "i", "in", "file_lst", "if", "'.png'", "in", "i", "]", "\n", "mask_image_dict", "=", "{", "}", "\n", "\n", "\n", "for", "i", "in", "mask_lst", ":", "\n", "            ", "image_name", "=", "i", ".", "split", "(", "'_'", ")", "[", "0", "]", "+", "'.jpg'", "\n", "image_path", "=", "root", "+", "image_dir", "+", "image_name", "\n", "mask_path", "=", "root", "+", "mask_dir", "+", "i", "\n", "mask_image_dict", "[", "mask_path", "]", "=", "image_path", "\n", "\n", "", "self", ".", "mask_image_dict", "=", "mask_image_dict", "\n", "self", ".", "dataset_samples", "=", "list", "(", "self", ".", "mask_image_dict", ".", "keys", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.hflicker.HFlickerDataset.get_sample": [[36, 50], ["cv2.imread", "cv2.cvtColor", "cv2.imread().astype", "instances_mask.astype.astype.astype", "isegm.data.sample.DSample", "len", "cv2.imread"], "methods", ["None"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "mask_path", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "self", ".", "mask_image_dict", "[", "mask_path", "]", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "if", "len", "(", "instances_mask", ".", "shape", ")", "==", "3", ":", "\n", "            ", "instances_mask", "=", "instances_mask", "[", ":", ",", ":", ",", "0", "]", "\n", "", "instances_mask", "=", "instances_mask", ">", "128", "\n", "instances_mask", "=", "instances_mask", ".", "astype", "(", "np", ".", "int32", ")", "\n", "\n", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "[", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.pascalvoc.PascalVocDataset.__init__": [[13, 27], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "pascalvoc.PascalVocDataset.get_images_and_ids_list", "open", "name.strip", "f.readlines"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.pascalvoc.PascalVocDataset.get_images_and_ids_list"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "assert", "split", "in", "{", "'train'", ",", "'val'", ",", "'trainval'", ",", "'test'", "}", "\n", "self", ".", "name", "=", "'Pascal'", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_images_path", "=", "self", ".", "dataset_path", "/", "\"JPEGImages\"", "\n", "self", ".", "_insts_path", "=", "self", ".", "dataset_path", "/", "\"SegmentationObject\"", "\n", "self", ".", "dataset_split", "=", "split", "\n", "\n", "\n", "with", "open", "(", "self", ".", "dataset_path", "/", "f'ImageSets/Segmentation/{split}.txt'", ",", "'r'", ")", "as", "f", ":", "\n", "            ", "dataset_samples", "=", "[", "name", ".", "strip", "(", ")", "for", "name", "in", "f", ".", "readlines", "(", ")", "]", "\n", "", "image_id_lst", "=", "self", ".", "get_images_and_ids_list", "(", "dataset_samples", ")", "\n", "self", ".", "dataset_samples", "=", "image_id_lst", "\n", "#print(image_id_lst[:5])", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.pascalvoc.PascalVocDataset.get_sample": [[51, 75], ["str", "str", "cv2.imread", "cv2.cvtColor", "cv2.imread", "cv2.cvtColor().astype", "numpy.zeros_like", "isegm.data.sample.DSample", "cv2.cvtColor"], "methods", ["None"], ["def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "sample_id", ",", "obj_id", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "#sample_id = str(sample_id)", "\n", "#print(sample_id)", "\n", "#num_zero = 6 - len(sample_id)", "\n", "#sample_id = '2007_'+'0'*num_zero + sample_id", "\n", "\n", "image_path", "=", "str", "(", "self", ".", "_images_path", "/", "f'{sample_id}.jpg'", ")", "\n", "mask_path", "=", "str", "(", "self", ".", "_insts_path", "/", "f'{sample_id}.png'", ")", "\n", "\n", "#print(image_path)", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", "\n", "instances_mask", "=", "cv2", ".", "cvtColor", "(", "instances_mask", ",", "cv2", ".", "COLOR_BGR2GRAY", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "\n", "instance_id", "=", "obj_id", "\n", "mask", "=", "np", ".", "zeros_like", "(", "instances_mask", ")", "\n", "mask", "[", "instances_mask", "==", "220", "]", "=", "220", "# ignored area", "\n", "mask", "[", "instances_mask", "==", "instance_id", "]", "=", "1", "\n", "objects_ids", "=", "[", "1", "]", "\n", "instances_mask", "=", "mask", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "objects_ids", ",", "ignore_ids", "=", "[", "220", "]", ",", "sample_id", "=", "index", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.pascalvoc.PascalVocDataset.get_images_and_ids_list": [[76, 91], ["range", "len", "str", "cv2.imread", "cv2.cvtColor().astype", "numpy.unique", "images_and_ids_list.append", "cv2.cvtColor"], "methods", ["None"], ["", "def", "get_images_and_ids_list", "(", "self", ",", "dataset_samples", ")", ":", "\n", "        ", "images_and_ids_list", "=", "[", "]", "\n", "#for i in tqdm(range(len(dataset_samples))):", "\n", "for", "i", "in", "range", "(", "len", "(", "dataset_samples", ")", ")", ":", "\n", "            ", "sample_id", "=", "dataset_samples", "[", "i", "]", "\n", "mask_path", "=", "str", "(", "self", ".", "_insts_path", "/", "f'{sample_id}.png'", ")", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "mask_path", ")", "\n", "instances_mask", "=", "cv2", ".", "cvtColor", "(", "instances_mask", ",", "cv2", ".", "COLOR_BGR2GRAY", ")", ".", "astype", "(", "np", ".", "int32", ")", "\n", "objects_ids", "=", "np", ".", "unique", "(", "instances_mask", ")", "\n", "\n", "objects_ids", "=", "[", "x", "for", "x", "in", "objects_ids", "if", "x", "!=", "0", "and", "x", "!=", "220", "]", "\n", "for", "j", "in", "objects_ids", ":", "\n", "                ", "images_and_ids_list", ".", "append", "(", "[", "sample_id", ",", "j", "]", ")", "\n", "#print(i,j,objects_ids)", "\n", "", "", "return", "images_and_ids_list", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.__init__": [[14, 37], ["isegm.data.base.ISDataset.__init__", "pathlib.Path", "collections.defaultdict", "open", "json.loads", "lvis.LvisDataset.annotations[].append", "train_categories_path.exists", "lvis.LvisDataset.generate_train_categories", "f.read", "len"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.generate_train_categories"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "\n", "max_overlap_ratio", "=", "0.5", ",", "\n", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "LvisDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "train_categories_path", "=", "dataset_path", "/", "'train_categories.json'", "\n", "self", ".", "_train_path", "=", "dataset_path", "/", "'train'", "\n", "self", ".", "_val_path", "=", "dataset_path", "/", "'val'", "\n", "\n", "self", ".", "split", "=", "split", "\n", "self", ".", "max_overlap_ratio", "=", "max_overlap_ratio", "\n", "\n", "with", "open", "(", "dataset_path", "/", "split", "/", "f'lvis_{self.split}.json'", ",", "'r'", ")", "as", "f", ":", "\n", "            ", "json_annotation", "=", "json", ".", "loads", "(", "f", ".", "read", "(", ")", ")", "\n", "\n", "", "self", ".", "annotations", "=", "defaultdict", "(", "list", ")", "\n", "for", "x", "in", "json_annotation", "[", "'annotations'", "]", ":", "\n", "            ", "self", ".", "annotations", "[", "x", "[", "'image_id'", "]", "]", ".", "append", "(", "x", ")", "\n", "\n", "", "if", "not", "train_categories_path", ".", "exists", "(", ")", ":", "\n", "            ", "self", ".", "generate_train_categories", "(", "dataset_path", ",", "train_categories_path", ")", "\n", "", "self", ".", "dataset_samples", "=", "[", "x", "for", "x", "in", "json_annotation", "[", "'images'", "]", "\n", "if", "len", "(", "self", ".", "annotations", "[", "x", "[", "'id'", "]", "]", ")", ">", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_sample": [[38, 79], ["random.shuffle", "cv2.imread", "cv2.cvtColor", "collections.defaultdict", "enumerate", "isegm.data.sample.DSample", "image_url.split", "str", "lvis.LvisDataset.get_mask_from_polygon", "object_mask.sum", "numpy.bincount", "objects_ids.append", "numpy.zeros_like", "instances_mask[].flatten", "numpy.logical_and().sum", "max", "enumerate", "max", "numpy.logical_and"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_mask_from_polygon"], ["", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_info", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_id", ",", "image_url", "=", "image_info", "[", "'id'", "]", ",", "image_info", "[", "'coco_url'", "]", "\n", "image_filename", "=", "image_url", ".", "split", "(", "'/'", ")", "[", "-", "1", "]", "\n", "image_annotations", "=", "self", ".", "annotations", "[", "image_id", "]", "\n", "random", ".", "shuffle", "(", "image_annotations", ")", "\n", "\n", "# LVISv1 splits do not match older LVIS splits (some images in val may come from COCO train2017)", "\n", "if", "'train2017'", "in", "image_url", ":", "\n", "            ", "image_path", "=", "self", ".", "_train_path", "/", "'images'", "/", "image_filename", "\n", "", "else", ":", "\n", "            ", "image_path", "=", "self", ".", "_val_path", "/", "'images'", "/", "image_filename", "\n", "", "image", "=", "cv2", ".", "imread", "(", "str", "(", "image_path", ")", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "\n", "instances_mask", "=", "None", "\n", "instances_area", "=", "defaultdict", "(", "int", ")", "\n", "objects_ids", "=", "[", "]", "\n", "for", "indx", ",", "obj_annotation", "in", "enumerate", "(", "image_annotations", ")", ":", "\n", "            ", "mask", "=", "self", ".", "get_mask_from_polygon", "(", "obj_annotation", ",", "image", ")", "\n", "object_mask", "=", "mask", ">", "0", "\n", "object_area", "=", "object_mask", ".", "sum", "(", ")", "\n", "\n", "if", "instances_mask", "is", "None", ":", "\n", "                ", "instances_mask", "=", "np", ".", "zeros_like", "(", "object_mask", ",", "dtype", "=", "np", ".", "int32", ")", "\n", "\n", "", "overlap_ids", "=", "np", ".", "bincount", "(", "instances_mask", "[", "object_mask", "]", ".", "flatten", "(", ")", ")", "\n", "overlap_areas", "=", "[", "overlap_area", "/", "instances_area", "[", "inst_id", "]", "for", "inst_id", ",", "overlap_area", "in", "enumerate", "(", "overlap_ids", ")", "\n", "if", "overlap_area", ">", "0", "and", "inst_id", ">", "0", "]", "\n", "overlap_ratio", "=", "np", ".", "logical_and", "(", "object_mask", ",", "instances_mask", ">", "0", ")", ".", "sum", "(", ")", "/", "object_area", "\n", "if", "overlap_areas", ":", "\n", "                ", "overlap_ratio", "=", "max", "(", "overlap_ratio", ",", "max", "(", "overlap_areas", ")", ")", "\n", "", "if", "overlap_ratio", ">", "self", ".", "max_overlap_ratio", ":", "\n", "                ", "continue", "\n", "\n", "", "instance_id", "=", "indx", "+", "1", "\n", "instances_mask", "[", "object_mask", "]", "=", "instance_id", "\n", "instances_area", "[", "instance_id", "]", "=", "object_area", "\n", "objects_ids", ".", "append", "(", "instance_id", ")", "\n", "\n", "", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "objects_ids", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_mask_from_polygon": [[81, 90], ["numpy.zeros", "numpy.array().reshape", "cv2.fillPoly", "numpy.round().astype", "numpy.array", "numpy.round"], "methods", ["None"], ["", "@", "staticmethod", "\n", "def", "get_mask_from_polygon", "(", "annotation", ",", "image", ")", ":", "\n", "        ", "mask", "=", "np", ".", "zeros", "(", "image", ".", "shape", "[", ":", "2", "]", ",", "dtype", "=", "np", ".", "int32", ")", "\n", "for", "contour_points", "in", "annotation", "[", "'segmentation'", "]", ":", "\n", "            ", "contour_points", "=", "np", ".", "array", "(", "contour_points", ")", ".", "reshape", "(", "(", "-", "1", ",", "2", ")", ")", "\n", "contour_points", "=", "np", ".", "round", "(", "contour_points", ")", ".", "astype", "(", "np", ".", "int32", ")", "[", "np", ".", "newaxis", ",", ":", "]", "\n", "cv2", ".", "fillPoly", "(", "mask", ",", "contour_points", ",", "1", ")", "\n", "\n", "", "return", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.generate_train_categories": [[91, 98], ["open", "json.load", "open", "json.dump"], "methods", ["None"], ["", "@", "staticmethod", "\n", "def", "generate_train_categories", "(", "dataset_path", ",", "train_categories_path", ")", ":", "\n", "        ", "with", "open", "(", "dataset_path", "/", "'train/lvis_train.json'", ",", "'r'", ")", "as", "f", ":", "\n", "            ", "annotation", "=", "json", ".", "load", "(", "f", ")", "\n", "\n", "", "with", "open", "(", "train_categories_path", ",", "'w'", ")", "as", "f", ":", "\n", "            ", "json", ".", "dump", "(", "annotation", "[", "'categories'", "]", ",", "f", ",", "indent", "=", "1", ")", "\n", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__": [[5, 8], ["grabcut.GrabCutDataset.__init__"], "methods", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.berkeley.BerkeleyDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "dataset_path", ",", "images_dir_name", "=", "'images'", ",", "masks_dir_name", "=", "'masks'", ",", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'Berkeley'", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops": [[26, 35], ["None"], "function", ["None"], ["def", "sra_flops", "(", "h", ",", "w", ",", "r", ",", "dim", ",", "num_heads", ")", ":", "\n", "    ", "dim_h", "=", "dim", "/", "num_heads", "\n", "n1", "=", "h", "*", "w", "\n", "n2", "=", "h", "/", "r", "*", "w", "/", "r", "\n", "\n", "f1", "=", "n1", "*", "dim_h", "*", "n2", "*", "num_heads", "\n", "f2", "=", "n1", "*", "n2", "*", "dim_h", "*", "num_heads", "\n", "\n", "return", "f1", "+", "f2", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.get_tr_flops": [[37, 79], ["mmcv.cnn.get_model_complexity_info", "print", "mmcv.cnn.utils.flops_counter.flops_to_string", "mmcv.cnn.utils.flops_counter.params_to_string", "count_flops.sra_flops", "len", "count_flops.sra_flops", "len", "count_flops.sra_flops", "len", "count_flops.sra_flops", "len", "count_flops.sra_flops", "len", "count_flops.sra_flops", "len", "count_flops.sra_flops", "len", "count_flops.sra_flops", "len"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.sra_flops"], ["", "def", "get_tr_flops", "(", "net", ",", "input_shape", ",", "input_cons", "=", "None", ")", ":", "\n", "    ", "flops", ",", "params", "=", "get_model_complexity_info", "(", "net", ",", "input_shape", ",", "as_strings", "=", "False", ",", "input_constructor", "=", "input_cons", ")", "\n", "_", ",", "H", ",", "W", "=", "input_shape", "\n", "net", "=", "net", ".", "backbone", "\n", "try", ":", "\n", "        ", "stage1", "=", "sra_flops", "(", "H", "//", "4", ",", "W", "//", "4", ",", "\n", "net", ".", "block1", "[", "0", "]", ".", "attn", ".", "sr_ratio", ",", "\n", "net", ".", "block1", "[", "0", "]", ".", "attn", ".", "dim", ",", "\n", "net", ".", "block1", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block1", ")", "\n", "stage2", "=", "sra_flops", "(", "H", "//", "8", ",", "W", "//", "8", ",", "\n", "net", ".", "block2", "[", "0", "]", ".", "attn", ".", "sr_ratio", ",", "\n", "net", ".", "block2", "[", "0", "]", ".", "attn", ".", "dim", ",", "\n", "net", ".", "block2", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block2", ")", "\n", "stage3", "=", "sra_flops", "(", "H", "//", "16", ",", "W", "//", "16", ",", "\n", "net", ".", "block3", "[", "0", "]", ".", "attn", ".", "sr_ratio", ",", "\n", "net", ".", "block3", "[", "0", "]", ".", "attn", ".", "dim", ",", "\n", "net", ".", "block3", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block3", ")", "\n", "stage4", "=", "sra_flops", "(", "H", "//", "32", ",", "W", "//", "32", ",", "\n", "net", ".", "block4", "[", "0", "]", ".", "attn", ".", "sr_ratio", ",", "\n", "net", ".", "block4", "[", "0", "]", ".", "attn", ".", "dim", ",", "\n", "net", ".", "block4", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block4", ")", "\n", "", "except", ":", "\n", "        ", "stage1", "=", "sra_flops", "(", "H", "//", "4", ",", "W", "//", "4", ",", "\n", "net", ".", "block1", "[", "0", "]", ".", "attn", ".", "squeeze_ratio", ",", "\n", "64", ",", "\n", "net", ".", "block1", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block1", ")", "\n", "stage2", "=", "sra_flops", "(", "H", "//", "8", ",", "W", "//", "8", ",", "\n", "net", ".", "block2", "[", "0", "]", ".", "attn", ".", "squeeze_ratio", ",", "\n", "128", ",", "\n", "net", ".", "block2", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block2", ")", "\n", "stage3", "=", "sra_flops", "(", "H", "//", "16", ",", "W", "//", "16", ",", "\n", "net", ".", "block3", "[", "0", "]", ".", "attn", ".", "squeeze_ratio", ",", "\n", "320", ",", "\n", "net", ".", "block3", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block3", ")", "\n", "stage4", "=", "sra_flops", "(", "H", "//", "32", ",", "W", "//", "32", ",", "\n", "net", ".", "block4", "[", "0", "]", ".", "attn", ".", "squeeze_ratio", ",", "\n", "512", ",", "\n", "net", ".", "block4", "[", "0", "]", ".", "attn", ".", "num_heads", ")", "*", "len", "(", "net", ".", "block4", ")", "\n", "\n", "", "print", "(", "stage1", "+", "stage2", "+", "stage3", "+", "stage4", ")", "\n", "flops", "+=", "stage1", "+", "stage2", "+", "stage3", "+", "stage4", "\n", "return", "flops_to_string", "(", "flops", ")", ",", "params_to_string", "(", "params", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.count_flops.prepare_input": [[83, 90], ["torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "dict"], "function", ["None"], ["", "def", "prepare_input", "(", "resolution", ")", ":", "\n", "    ", "image", "=", "torch", ".", "FloatTensor", "(", "1", ",", "*", "resolution", ")", "\n", "B", ",", "C", ",", "H", ",", "W", "=", "image", ".", "shape", "\n", "click_map", "=", "torch", ".", "FloatTensor", "(", "1", ",", "2", ",", "H", ",", "W", ")", "\n", "final_feature", "=", "torch", ".", "FloatTensor", "(", "1", ",", "256", ",", "H", "//", "4", ",", "W", "//", "4", ")", "\n", "cropped_logits", "=", "torch", ".", "FloatTensor", "(", "1", ",", "1", ",", "H", ",", "W", ")", "\n", "return", "dict", "(", "x", "=", "image", ",", "x1", "=", "click_map", ",", "x2", "=", "final_feature", ",", "x3", "=", "cropped_logits", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.parse_args": [[18, 105], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_mutually_exclusive_group", "parser.add_mutually_exclusive_group.add_argument", "argparse.ArgumentParser.add_argument", "parser.add_mutually_exclusive_group.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_mutually_exclusive_group", "parser.add_mutually_exclusive_group.add_argument", "parser.add_mutually_exclusive_group.add_argument", "argparse.ArgumentParser.add_mutually_exclusive_group", "parser.add_mutually_exclusive_group.add_argument", "parser.add_mutually_exclusive_group.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "parser.add_mutually_exclusive_group.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "isegm.utils.exp.load_config_file", "pathlib.Path", "torch.device", "torch.device", "max", "pathlib.Path", "parser.parse_args.gpus.split"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config_file"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'mode'", ",", "choices", "=", "[", "'CDNet'", ",", "'Baseline'", ",", "'FocalClick'", ",", "'NoBRS'", ",", "'RGB-BRS'", ",", "'DistMap-BRS'", ",", "\n", "'f-BRS-A'", ",", "'f-BRS-B'", ",", "'f-BRS-C'", "]", ",", "\n", "help", "=", "''", ")", "\n", "\n", "group_checkpoints", "=", "parser", ".", "add_mutually_exclusive_group", "(", "required", "=", "True", ")", "\n", "group_checkpoints", ".", "add_argument", "(", "'--checkpoint'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "\n", "help", "=", "'The path to the checkpoint. '", "\n", "'This can be a relative path (relative to cfg.INTERACTIVE_MODELS_PATH) '", "\n", "'or an absolute path. The file extension can be omitted.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--model_dir'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "\n", "help", "=", "'The path to the checkpoint.'", ")", "\n", "\n", "group_checkpoints", ".", "add_argument", "(", "'--exp-path'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "\n", "help", "=", "'The relative path to the experiment with checkpoints.'", "\n", "'(relative to cfg.EXPS_PATH)'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--datasets'", ",", "type", "=", "str", ",", "default", "=", "'GrabCut,Berkeley,DAVIS,SBD,PascalVOC'", ",", "\n", "help", "=", "'List of datasets on which the model should be tested. '", "\n", "'Datasets are separated by a comma. Possible choices: '", "\n", "'GrabCut, Berkeley, DAVIS, SBD, PascalVOC'", ")", "\n", "\n", "group_device", "=", "parser", ".", "add_mutually_exclusive_group", "(", ")", "\n", "group_device", ".", "add_argument", "(", "'--gpus'", ",", "type", "=", "str", ",", "default", "=", "'0'", ",", "\n", "help", "=", "'ID of used GPU.'", ")", "\n", "group_device", ".", "add_argument", "(", "'--cpu'", ",", "action", "=", "'store_true'", ",", "default", "=", "False", ",", "\n", "help", "=", "'Use only CPU for inference.'", ")", "\n", "\n", "group_iou_thresh", "=", "parser", ".", "add_mutually_exclusive_group", "(", ")", "\n", "group_iou_thresh", ".", "add_argument", "(", "'--target-iou'", ",", "type", "=", "float", ",", "default", "=", "0.90", ",", "\n", "help", "=", "'Target IoU threshold for the NoC metric. (min possible value = 0.8)'", ")", "\n", "group_iou_thresh", ".", "add_argument", "(", "'--iou-analysis'", ",", "action", "=", "'store_true'", ",", "default", "=", "False", ",", "\n", "help", "=", "'Plot mIoU(number of clicks) with target_iou=1.0.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--n-clicks'", ",", "type", "=", "int", ",", "default", "=", "20", ",", "\n", "help", "=", "'Maximum number of clicks for the NoC metric.'", ")", "\n", "parser", ".", "add_argument", "(", "'--min-n-clicks'", ",", "type", "=", "int", ",", "default", "=", "1", ",", "\n", "help", "=", "'Minimum number of clicks for the evaluation.'", ")", "\n", "parser", ".", "add_argument", "(", "'--thresh'", ",", "type", "=", "float", ",", "required", "=", "False", ",", "default", "=", "0.49", ",", "\n", "help", "=", "'The segmentation mask is obtained from the probability outputs using this threshold.'", ")", "\n", "parser", ".", "add_argument", "(", "'--clicks-limit'", ",", "type", "=", "int", ",", "default", "=", "None", ")", "\n", "parser", ".", "add_argument", "(", "'--eval-mode'", ",", "type", "=", "str", ",", "default", "=", "'cvpr'", ",", "\n", "help", "=", "'Possible choices: cvpr, fixed<number> (e.g. fixed400, fixed600).'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--save-ious'", ",", "action", "=", "'store_true'", ",", "default", "=", "False", ")", "\n", "parser", ".", "add_argument", "(", "'--print-ious'", ",", "action", "=", "'store_true'", ",", "default", "=", "False", ")", "\n", "parser", ".", "add_argument", "(", "'--vis'", ",", "action", "=", "'store_true'", ",", "default", "=", "False", ")", "\n", "group_checkpoints", ".", "add_argument", "(", "'--vis_path'", ",", "type", "=", "str", ",", "default", "=", "'./experiments/vis_val/'", ",", "\n", "help", "=", "'saveing path for the evaluation results'", ")", "\n", "parser", ".", "add_argument", "(", "'--model-name'", ",", "type", "=", "str", ",", "default", "=", "None", ",", "\n", "help", "=", "'The model name that is used for making plots.'", ")", "\n", "parser", ".", "add_argument", "(", "'--config-path'", ",", "type", "=", "str", ",", "default", "=", "'./config.yml'", ",", "\n", "help", "=", "'The path to the config file.'", ")", "\n", "parser", ".", "add_argument", "(", "'--logs-path'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "\n", "help", "=", "'The path to the evaluation logs. Default path: cfg.EXPS_PATH/evaluation_logs.'", ")", "\n", "parser", ".", "add_argument", "(", "'--infer-size'", ",", "type", "=", "int", ",", "default", "=", "384", ",", "\n", "help", "=", "'Inference input size for the model'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--target-crop-r'", ",", "type", "=", "float", ",", "default", "=", "1.40", ",", "\n", "help", "=", "'Target Crop Expand Ratio'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--focus-crop-r'", ",", "type", "=", "float", ",", "default", "=", "1.40", ",", "\n", "help", "=", "'Focus Crop Expand Ratio'", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "if", "args", ".", "cpu", ":", "\n", "        ", "args", ".", "device", "=", "torch", ".", "device", "(", "'cpu'", ")", "\n", "", "else", ":", "\n", "        ", "args", ".", "device", "=", "torch", ".", "device", "(", "f\"cuda:{args.gpus.split(',')[0]}\"", ")", "\n", "\n", "", "if", "(", "args", ".", "iou_analysis", "or", "args", ".", "print_ious", ")", "and", "args", ".", "min_n_clicks", "<=", "1", ":", "\n", "        ", "args", ".", "target_iou", "=", "1.01", "\n", "", "else", ":", "\n", "        ", "args", ".", "target_iou", "=", "max", "(", "0.8", ",", "args", ".", "target_iou", ")", "\n", "\n", "", "cfg", "=", "load_config_file", "(", "args", ".", "config_path", ",", "return_edict", "=", "True", ")", "\n", "cfg", ".", "EXPS_PATH", "=", "Path", "(", "cfg", ".", "EXPS_PATH", ")", "\n", "\n", "if", "args", ".", "logs_path", "==", "''", ":", "\n", "        ", "args", ".", "logs_path", "=", "cfg", ".", "EXPS_PATH", "/", "'evaluation_logs'", "\n", "", "else", ":", "\n", "        ", "args", ".", "logs_path", "=", "Path", "(", "args", ".", "logs_path", ")", "\n", "\n", "", "return", "args", ",", "cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.main": [[107, 153], ["evaluate_model.parse_args", "evaluate_model.get_checkpoints_list_and_logs_path", "print", "logs_path.mkdir", "args.datasets.split", "len", "isegm.inference.utils.get_dataset", "isegm.inference.utils.load_is_model", "evaluate_model.get_predictor_and_zoomin_params", "isegm.inference.predictors.get_predictor", "isegm.inference.evaluation.evaluate_dataset", "evaluate_model.save_results", "evaluate_model.save_iou_analysis_data"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.get_checkpoints_list_and_logs_path", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.get_dataset", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.load_is_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.get_predictor_and_zoomin_params", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.predictors.__init__.get_predictor", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.evaluation.evaluate_dataset", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.save_results", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.save_iou_analysis_data"], ["", "def", "main", "(", ")", ":", "\n", "    ", "args", ",", "cfg", "=", "parse_args", "(", ")", "\n", "\n", "checkpoints_list", ",", "logs_path", ",", "logs_prefix", "=", "get_checkpoints_list_and_logs_path", "(", "args", ",", "cfg", ")", "\n", "print", "(", "'checkpoint list: '", ",", "checkpoints_list", ")", "\n", "logs_path", ".", "mkdir", "(", "parents", "=", "True", ",", "exist_ok", "=", "True", ")", "\n", "\n", "single_model_eval", "=", "len", "(", "checkpoints_list", ")", "==", "1", "\n", "assert", "not", "args", ".", "iou_analysis", "if", "not", "single_model_eval", "else", "True", ",", "\"Can't perform IoU analysis for multiple checkpoints\"", "\n", "print_header", "=", "single_model_eval", "\n", "for", "dataset_name", "in", "args", ".", "datasets", ".", "split", "(", "','", ")", ":", "\n", "        ", "dataset", "=", "utils", ".", "get_dataset", "(", "dataset_name", ",", "cfg", ")", "\n", "#print(dataset_name)", "\n", "\n", "for", "checkpoint_path", "in", "checkpoints_list", ":", "\n", "            ", "model", "=", "utils", ".", "load_is_model", "(", "checkpoint_path", ",", "args", ".", "device", ")", "\n", "\n", "predictor_params", ",", "zoomin_params", "=", "get_predictor_and_zoomin_params", "(", "args", ",", "dataset_name", ")", "\n", "predictor", "=", "get_predictor", "(", "model", ",", "args", ".", "mode", ",", "args", ".", "device", ",", "\n", "infer_size", "=", "args", ".", "infer_size", ",", "\n", "prob_thresh", "=", "args", ".", "thresh", ",", "\n", "predictor_params", "=", "predictor_params", ",", "\n", "focus_crop_r", "=", "args", ".", "focus_crop_r", ",", "\n", "#zoom_in_params=None)", "\n", "zoom_in_params", "=", "zoomin_params", ")", "\n", "\n", "#vis_callback = get_prediction_vis_callback(logs_path, dataset_name, args.thresh) if args.vis else None", "\n", "dataset_results", "=", "evaluate_dataset", "(", "dataset", ",", "predictor", ",", "pred_thr", "=", "args", ".", "thresh", ",", "\n", "max_iou_thr", "=", "args", ".", "target_iou", ",", "\n", "min_clicks", "=", "args", ".", "min_n_clicks", ",", "\n", "max_clicks", "=", "args", ".", "n_clicks", ",", "\n", "vis", "=", "args", ".", "vis", ",", "\n", ")", "\n", "\n", "row_name", "=", "args", ".", "mode", "if", "single_model_eval", "else", "checkpoint_path", ".", "stem", "\n", "if", "args", ".", "iou_analysis", ":", "\n", "                ", "save_iou_analysis_data", "(", "args", ",", "dataset_name", ",", "logs_path", ",", "\n", "logs_prefix", ",", "dataset_results", ",", "\n", "model_name", "=", "args", ".", "model_name", ")", "\n", "\n", "", "save_results", "(", "args", ",", "row_name", ",", "dataset_name", ",", "logs_path", ",", "logs_prefix", ",", "dataset_results", ",", "\n", "save_ious", "=", "single_model_eval", "and", "args", ".", "save_ious", ",", "\n", "single_model_eval", "=", "single_model_eval", ",", "\n", "print_header", "=", "print_header", ")", "\n", "print_header", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.get_predictor_and_zoomin_params": [[155, 178], ["args.eval_mode.startswith", "int"], "function", ["None"], ["", "", "", "def", "get_predictor_and_zoomin_params", "(", "args", ",", "dataset_name", ")", ":", "\n", "    ", "predictor_params", "=", "{", "}", "\n", "\n", "if", "args", ".", "clicks_limit", "is", "not", "None", ":", "\n", "        ", "if", "args", ".", "clicks_limit", "==", "-", "1", ":", "\n", "            ", "args", ".", "clicks_limit", "=", "args", ".", "n_clicks", "\n", "", "predictor_params", "[", "'net_clicks_limit'", "]", "=", "args", ".", "clicks_limit", "\n", "\n", "", "if", "args", ".", "eval_mode", "==", "'cvpr'", ":", "\n", "        ", "zoom_in_params", "=", "{", "\n", "'target_size'", ":", "600", "if", "dataset_name", "==", "'DAVIS'", "else", "400", ",", "\n", "'expansion_ratio'", ":", "args", ".", "target_crop_r", "\n", "}", "\n", "", "elif", "args", ".", "eval_mode", ".", "startswith", "(", "'fixed'", ")", ":", "\n", "        ", "crop_size", "=", "int", "(", "args", ".", "eval_mode", "[", "5", ":", "]", ")", "\n", "zoom_in_params", "=", "{", "\n", "'skip_clicks'", ":", "-", "1", ",", "\n", "'target_size'", ":", "(", "crop_size", ",", "crop_size", ")", "\n", "}", "\n", "", "else", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n", "", "return", "predictor_params", ",", "zoom_in_params", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.get_checkpoints_list_and_logs_path": [[180, 210], ["list", "sorted", "rel_exp_path.split", "exp_path_prefix.parent.glob", "len", "len", "exp_path.relative_to", "pathlib.Path", "len", "isegm.inference.utils.find_checkpoint"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.find_checkpoint"], ["", "def", "get_checkpoints_list_and_logs_path", "(", "args", ",", "cfg", ")", ":", "\n", "    ", "logs_prefix", "=", "''", "\n", "if", "args", ".", "exp_path", ":", "\n", "        ", "rel_exp_path", "=", "args", ".", "exp_path", "\n", "checkpoint_prefix", "=", "''", "\n", "if", "':'", "in", "rel_exp_path", ":", "\n", "            ", "rel_exp_path", ",", "checkpoint_prefix", "=", "rel_exp_path", ".", "split", "(", "':'", ")", "\n", "\n", "", "exp_path_prefix", "=", "cfg", ".", "EXPS_PATH", "/", "rel_exp_path", "\n", "candidates", "=", "list", "(", "exp_path_prefix", ".", "parent", ".", "glob", "(", "exp_path_prefix", ".", "stem", "+", "'*'", ")", ")", "\n", "assert", "len", "(", "candidates", ")", "==", "1", ",", "\"Invalid experiment path.\"", "\n", "exp_path", "=", "candidates", "[", "0", "]", "\n", "checkpoints_list", "=", "sorted", "(", "(", "exp_path", "/", "'checkpoints'", ")", ".", "glob", "(", "checkpoint_prefix", "+", "'*.pth'", ")", ",", "reverse", "=", "True", ")", "\n", "assert", "len", "(", "checkpoints_list", ")", ">", "0", ",", "\"Couldn't find any checkpoints.\"", "\n", "\n", "if", "checkpoint_prefix", ":", "\n", "            ", "if", "len", "(", "checkpoints_list", ")", "==", "1", ":", "\n", "                ", "logs_prefix", "=", "checkpoints_list", "[", "0", "]", ".", "stem", "\n", "", "else", ":", "\n", "                ", "logs_prefix", "=", "f'all_{checkpoint_prefix}'", "\n", "", "", "else", ":", "\n", "            ", "logs_prefix", "=", "'all_checkpoints'", "\n", "\n", "", "logs_path", "=", "args", ".", "logs_path", "/", "exp_path", ".", "relative_to", "(", "cfg", ".", "EXPS_PATH", ")", "\n", "", "else", ":", "\n", "#checkpoints_list = [Path(utils.find_checkpoint(cfg.INTERACTIVE_MODELS_PATH, args.checkpoint))]", "\n", "        ", "checkpoints_list", "=", "[", "Path", "(", "utils", ".", "find_checkpoint", "(", "args", ".", "model_dir", ",", "args", ".", "checkpoint", ")", ")", "]", "\n", "logs_path", "=", "args", ".", "logs_path", "/", "'others'", "/", "checkpoints_list", "[", "0", "]", ".", "stem", "\n", "\n", "", "return", "checkpoints_list", ",", "logs_path", ",", "logs_prefix", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.save_results": [[212, 266], ["isegm.inference.utils.get_time_metrics", "numpy.arange().tolist", "isegm.inference.utils.compute_noc_metric", "isegm.inference.utils.get_results_table", "print", "log_path.exists", "min", "numpy.array().mean", "int", "print", "ious_path.mkdir", "numpy.arange", "isegm.inference.utils.compute_noc_metric", "open", "pickle.dump", "open", "f.write", "open", "f.write", "str", "len", "numpy.array", "f.write", "min", "logs_path.relative_to"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.get_time_metrics", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.compute_noc_metric", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.get_results_table", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.inference.utils.compute_noc_metric", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.TqdmToLogger.write", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.TqdmToLogger.write", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.log.TqdmToLogger.write"], ["", "def", "save_results", "(", "args", ",", "row_name", ",", "dataset_name", ",", "logs_path", ",", "logs_prefix", ",", "dataset_results", ",", "\n", "save_ious", "=", "False", ",", "print_header", "=", "True", ",", "single_model_eval", "=", "False", ")", ":", "\n", "    ", "all_ious", ",", "elapsed_time", "=", "dataset_results", "\n", "#print(all_ious)", "\n", "mean_spc", ",", "mean_spi", "=", "utils", ".", "get_time_metrics", "(", "all_ious", ",", "elapsed_time", ")", "\n", "\n", "iou_thrs", "=", "np", ".", "arange", "(", "0.8", ",", "min", "(", "0.95", ",", "args", ".", "target_iou", ")", "+", "0.001", ",", "0.05", ")", ".", "tolist", "(", ")", "\n", "noc_list", ",", "over_max_list", "=", "utils", ".", "compute_noc_metric", "(", "all_ious", ",", "iou_thrs", "=", "iou_thrs", ",", "max_clicks", "=", "args", ".", "n_clicks", ")", "\n", "\n", "row_name", "=", "'last'", "if", "row_name", "==", "'last_checkpoint'", "else", "row_name", "\n", "model_name", "=", "str", "(", "logs_path", ".", "relative_to", "(", "args", ".", "logs_path", ")", ")", "+", "':'", "+", "logs_prefix", "if", "logs_prefix", "else", "logs_path", ".", "stem", "\n", "header", ",", "table_row", "=", "utils", ".", "get_results_table", "(", "noc_list", ",", "over_max_list", ",", "row_name", ",", "dataset_name", ",", "\n", "mean_spc", ",", "elapsed_time", ",", "args", ".", "n_clicks", ",", "\n", "model_name", "=", "model_name", ")", "\n", "\n", "if", "args", ".", "print_ious", ":", "\n", "        ", "min_num_clicks", "=", "min", "(", "len", "(", "x", ")", "for", "x", "in", "all_ious", ")", "\n", "mean_ious", "=", "np", ".", "array", "(", "[", "x", "[", ":", "min_num_clicks", "]", "for", "x", "in", "all_ious", "]", ")", ".", "mean", "(", "axis", "=", "0", ")", "\n", "miou_str", "=", "' '", ".", "join", "(", "[", "f'mIoU@{click_id}={mean_ious[click_id - 1]:.2%};'", "\n", "for", "click_id", "in", "[", "1", ",", "2", ",", "3", ",", "5", ",", "10", ",", "20", "]", "if", "click_id", "<=", "min_num_clicks", "]", ")", "\n", "table_row", "+=", "'; '", "+", "miou_str", "\n", "", "else", ":", "\n", "        ", "target_iou_int", "=", "int", "(", "args", ".", "target_iou", "*", "100", ")", "\n", "if", "target_iou_int", "not", "in", "[", "80", ",", "85", ",", "90", "]", ":", "\n", "            ", "noc_list", ",", "over_max_list", "=", "utils", ".", "compute_noc_metric", "(", "all_ious", ",", "iou_thrs", "=", "[", "args", ".", "target_iou", "]", ",", "\n", "max_clicks", "=", "args", ".", "n_clicks", ")", "\n", "table_row", "+=", "f' NoC@{args.target_iou:.1%} = {noc_list[0]:.2f};'", "\n", "table_row", "+=", "f' >={args.n_clicks}@{args.target_iou:.1%} = {over_max_list[0]}'", "\n", "\n", "", "", "if", "print_header", ":", "\n", "        ", "print", "(", "header", ")", "\n", "", "print", "(", "table_row", ")", "\n", "\n", "if", "save_ious", ":", "\n", "        ", "ious_path", "=", "logs_path", "/", "'ious'", "/", "(", "logs_prefix", "if", "logs_prefix", "else", "''", ")", "\n", "ious_path", ".", "mkdir", "(", "parents", "=", "True", ",", "exist_ok", "=", "True", ")", "\n", "with", "open", "(", "ious_path", "/", "f'{dataset_name}_{args.eval_mode}_{args.mode}_{args.n_clicks}.pkl'", ",", "'wb'", ")", "as", "fp", ":", "\n", "            ", "pickle", ".", "dump", "(", "all_ious", ",", "fp", ")", "\n", "\n", "", "", "name_prefix", "=", "''", "\n", "if", "logs_prefix", ":", "\n", "        ", "name_prefix", "=", "logs_prefix", "+", "'_'", "\n", "if", "not", "single_model_eval", ":", "\n", "            ", "name_prefix", "+=", "f'{dataset_name}_'", "\n", "\n", "", "", "log_path", "=", "logs_path", "/", "f'{name_prefix}{args.eval_mode}_{args.mode}_{args.n_clicks}.txt'", "\n", "if", "log_path", ".", "exists", "(", ")", ":", "\n", "        ", "with", "open", "(", "log_path", ",", "'a'", ")", "as", "f", ":", "\n", "            ", "f", ".", "write", "(", "table_row", "+", "'\\n'", ")", "\n", "", "", "else", ":", "\n", "        ", "with", "open", "(", "log_path", ",", "'w'", ")", "as", "f", ":", "\n", "            ", "if", "print_header", ":", "\n", "                ", "f", ".", "write", "(", "header", "+", "'\\n'", ")", "\n", "", "f", ".", "write", "(", "table_row", "+", "'\\n'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.save_iou_analysis_data": [[268, 286], ["pkl_path.parent.mkdir", "pkl_path.open", "pickle.dump", "str", "logs_path.relative_to"], "function", ["None"], ["", "", "", "def", "save_iou_analysis_data", "(", "args", ",", "dataset_name", ",", "logs_path", ",", "logs_prefix", ",", "dataset_results", ",", "model_name", "=", "None", ")", ":", "\n", "    ", "all_ious", ",", "_", "=", "dataset_results", "\n", "\n", "name_prefix", "=", "''", "\n", "if", "logs_prefix", ":", "\n", "        ", "name_prefix", "=", "logs_prefix", "+", "'_'", "\n", "", "name_prefix", "+=", "dataset_name", "+", "'_'", "\n", "if", "model_name", "is", "None", ":", "\n", "        ", "model_name", "=", "str", "(", "logs_path", ".", "relative_to", "(", "args", ".", "logs_path", ")", ")", "+", "':'", "+", "logs_prefix", "if", "logs_prefix", "else", "logs_path", ".", "stem", "\n", "\n", "", "pkl_path", "=", "logs_path", "/", "f'plots/{name_prefix}{args.eval_mode}_{args.mode}_{args.n_clicks}.pickle'", "\n", "pkl_path", ".", "parent", ".", "mkdir", "(", "parents", "=", "True", ",", "exist_ok", "=", "True", ")", "\n", "with", "pkl_path", ".", "open", "(", "'wb'", ")", "as", "f", ":", "\n", "        ", "pickle", ".", "dump", "(", "{", "\n", "'dataset_name'", ":", "dataset_name", ",", "\n", "'model_name'", ":", "f'{model_name}_{args.mode}'", ",", "\n", "'all_ious'", ":", "all_ious", "\n", "}", ",", "f", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.evaluate_model.get_prediction_vis_callback": [[288, 299], ["save_path.mkdir", "isegm.utils.vis.draw_probmap", "isegm.utils.vis.draw_with_blend_and_clicks", "cv2.imwrite", "str", "numpy.concatenate"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_probmap", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.vis.draw_with_blend_and_clicks"], ["", "", "def", "get_prediction_vis_callback", "(", "logs_path", ",", "dataset_name", ",", "prob_thresh", ")", ":", "\n", "    ", "save_path", "=", "logs_path", "/", "'predictions_vis'", "/", "dataset_name", "\n", "save_path", ".", "mkdir", "(", "parents", "=", "True", ",", "exist_ok", "=", "True", ")", "\n", "\n", "def", "callback", "(", "image", ",", "gt_mask", ",", "pred_probs", ",", "sample_id", ",", "click_indx", ",", "clicks_list", ")", ":", "\n", "        ", "sample_path", "=", "save_path", "/", "f'{sample_id}_{click_indx}.jpg'", "\n", "prob_map", "=", "draw_probmap", "(", "pred_probs", ")", "\n", "image_with_mask", "=", "draw_with_blend_and_clicks", "(", "image", ",", "pred_probs", ">", "prob_thresh", ",", "clicks_list", "=", "clicks_list", ")", "\n", "cv2", ".", "imwrite", "(", "str", "(", "sample_path", ")", ",", "np", ".", "concatenate", "(", "(", "image_with_mask", ",", "prob_map", ")", ",", "axis", "=", "1", ")", "[", ":", ",", ":", ",", ":", ":", "-", "1", "]", ")", "\n", "\n", "", "return", "callback", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.plot_ious_analysis.parse_args": [[16, 61], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_mutually_exclusive_group", "parser.add_mutually_exclusive_group.add_argument", "parser.add_mutually_exclusive_group.add_argument", "parser.add_mutually_exclusive_group.add_argument", "parser.add_mutually_exclusive_group.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "isegm.utils.exp.load_config_file", "pathlib.Path", "parser.parse_args.datasets.split", "print", "parser.parse_args.plots_path.mkdir", "pathlib.Path"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config_file"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "\n", "group_pkl_path", "=", "parser", ".", "add_mutually_exclusive_group", "(", "required", "=", "True", ")", "\n", "group_pkl_path", ".", "add_argument", "(", "'--folder'", ",", "type", "=", "str", ",", "default", "=", "None", ",", "\n", "help", "=", "'Path to folder with .pickle files.'", ")", "\n", "group_pkl_path", ".", "add_argument", "(", "'--files'", ",", "nargs", "=", "'+'", ",", "default", "=", "None", ",", "\n", "help", "=", "'List of paths to .pickle files separated by space.'", ")", "\n", "group_pkl_path", ".", "add_argument", "(", "'--model-dirs'", ",", "nargs", "=", "'+'", ",", "default", "=", "None", ",", "\n", "help", "=", "\"List of paths to model directories with 'plots' folder \"", "\n", "\"containing .pickle files separated by space.\"", ")", "\n", "group_pkl_path", ".", "add_argument", "(", "'--exp-models'", ",", "nargs", "=", "'+'", ",", "default", "=", "None", ",", "\n", "help", "=", "'List of experiments paths suffixes (relative to cfg.EXPS_PATH/evaluation_logs). '", "\n", "'For each experiment, the checkpoint prefix must be specified '", "\n", "'by using the \":\" delimiter at the end.'", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'--mode'", ",", "choices", "=", "[", "'NoBRS'", ",", "'RGB-BRS'", ",", "'DistMap-BRS'", ",", "\n", "'f-BRS-A'", ",", "'f-BRS-B'", ",", "'f-BRS-C'", "]", ",", "\n", "default", "=", "None", ",", "nargs", "=", "'*'", ",", "help", "=", "''", ")", "\n", "parser", ".", "add_argument", "(", "'--datasets'", ",", "type", "=", "str", ",", "default", "=", "'GrabCut,Berkeley,DAVIS,COCO_MVal,SBD'", ",", "\n", "help", "=", "'List of datasets for plotting the iou analysis'", "\n", "'Datasets are separated by a comma. Possible choices: '", "\n", "'GrabCut, Berkeley, DAVIS, COCO_MVal, SBD'", ")", "\n", "parser", ".", "add_argument", "(", "'--config-path'", ",", "type", "=", "str", ",", "default", "=", "'./config.yml'", ",", "\n", "help", "=", "'The path to the config file.'", ")", "\n", "parser", ".", "add_argument", "(", "'--n-clicks'", ",", "type", "=", "int", ",", "default", "=", "-", "1", ",", "\n", "help", "=", "'Maximum number of clicks to plot.'", ")", "\n", "parser", ".", "add_argument", "(", "'--plots-path'", ",", "type", "=", "str", ",", "default", "=", "''", ",", "\n", "help", "=", "'The path to the evaluation logs. '", "\n", "'Default path: cfg.EXPS_PATH/evaluation_logs/iou_analysis.'", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "\n", "cfg", "=", "load_config_file", "(", "args", ".", "config_path", ",", "return_edict", "=", "True", ")", "\n", "cfg", ".", "EXPS_PATH", "=", "Path", "(", "cfg", ".", "EXPS_PATH", ")", "\n", "\n", "args", ".", "datasets", "=", "args", ".", "datasets", ".", "split", "(", "','", ")", "\n", "if", "args", ".", "plots_path", "==", "''", ":", "\n", "        ", "args", ".", "plots_path", "=", "cfg", ".", "EXPS_PATH", "/", "'evaluation_logs/iou_analysis'", "\n", "", "else", ":", "\n", "        ", "args", ".", "plots_path", "=", "Path", "(", "args", ".", "plots_path", ")", "\n", "", "print", "(", "args", ".", "plots_path", ")", "\n", "args", ".", "plots_path", ".", "mkdir", "(", "parents", "=", "True", ",", "exist_ok", "=", "True", ")", "\n", "\n", "return", "args", ",", "cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.plot_ious_analysis.main": [[63, 101], ["plot_ious_analysis.parse_args", "plot_ious_analysis.get_files_list", "collections.defaultdict", "collections.defaultdict.items", "numpy.array().mean", "matplotlib.figure", "dataset_results.items", "matplotlib.title", "matplotlib.grid", "matplotlib.legend", "matplotlib.yticks", "matplotlib.xticks", "plot_ious_analysis.get_target_file_path", "matplotlib.savefig", "open", "pickle.load", "len", "max", "print", "matplotlib.plot", "str", "numpy.array", "numpy.arange", "numpy.arange", "len"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.plot_ious_analysis.get_files_list", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.plot_ious_analysis.get_target_file_path"], ["", "def", "main", "(", ")", ":", "\n", "    ", "args", ",", "cfg", "=", "parse_args", "(", ")", "\n", "\n", "files_list", "=", "get_files_list", "(", "args", ",", "cfg", ")", "\n", "\n", "# Dict of dicts with mapping dataset_name -> model_name -> results", "\n", "aggregated_plot_data", "=", "defaultdict", "(", "dict", ")", "\n", "for", "file", "in", "files_list", ":", "\n", "        ", "with", "open", "(", "file", ",", "'rb'", ")", "as", "f", ":", "\n", "            ", "data", "=", "pickle", ".", "load", "(", "f", ")", "\n", "", "data", "[", "'all_ious'", "]", "=", "[", "x", "[", ":", "args", ".", "n_clicks", "]", "for", "x", "in", "data", "[", "'all_ious'", "]", "]", "\n", "aggregated_plot_data", "[", "data", "[", "'dataset_name'", "]", "]", "[", "data", "[", "'model_name'", "]", "]", "=", "np", ".", "array", "(", "data", "[", "'all_ious'", "]", ")", ".", "mean", "(", "0", ")", "\n", "\n", "", "for", "dataset_name", ",", "dataset_results", "in", "aggregated_plot_data", ".", "items", "(", ")", ":", "\n", "        ", "plt", ".", "figure", "(", "figsize", "=", "(", "12", ",", "7", ")", ")", "\n", "\n", "max_clicks", "=", "0", "\n", "for", "model_name", ",", "model_results", "in", "dataset_results", ".", "items", "(", ")", ":", "\n", "            ", "if", "args", ".", "n_clicks", "!=", "-", "1", ":", "\n", "                ", "model_results", "=", "model_results", "[", ":", "args", ".", "n_clicks", "]", "\n", "\n", "", "n_clicks", "=", "len", "(", "model_results", ")", "\n", "max_clicks", "=", "max", "(", "max_clicks", ",", "n_clicks", ")", "\n", "\n", "miou_str", "=", "' '", ".", "join", "(", "[", "f'mIoU@{click_id}={model_results[click_id-1]:.2%};'", "\n", "for", "click_id", "in", "[", "1", ",", "3", ",", "5", ",", "10", ",", "20", "]", "if", "click_id", "<=", "len", "(", "model_results", ")", "]", ")", "\n", "print", "(", "f'{model_name} on {dataset_name}:\\n{miou_str}\\n'", ")", "\n", "\n", "plt", ".", "plot", "(", "1", "+", "np", ".", "arange", "(", "n_clicks", ")", ",", "model_results", ",", "linewidth", "=", "2", ",", "label", "=", "model_name", ")", "\n", "\n", "", "plt", ".", "title", "(", "f'mIoU after every click for {dataset_name}'", ",", "fontsize", "=", "'x-large'", ")", "\n", "plt", ".", "grid", "(", ")", "\n", "plt", ".", "legend", "(", "loc", "=", "4", ",", "fontsize", "=", "'x-large'", ")", "\n", "plt", ".", "yticks", "(", "fontsize", "=", "'x-large'", ")", "\n", "plt", ".", "xticks", "(", "1", "+", "np", ".", "arange", "(", "max_clicks", ")", ",", "fontsize", "=", "'x-large'", ")", "\n", "\n", "fig_path", "=", "get_target_file_path", "(", "args", ".", "plots_path", ",", "dataset_name", ")", "\n", "plt", ".", "savefig", "(", "str", "(", "fig_path", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.plot_ious_analysis.get_target_file_path": [[103, 111], ["sorted", "str", "plots_path.glob", "len", "int", "previous_plots[].stem.split"], "function", ["None"], ["", "", "def", "get_target_file_path", "(", "plots_path", ",", "dataset_name", ")", ":", "\n", "    ", "previous_plots", "=", "sorted", "(", "plots_path", ".", "glob", "(", "f'{dataset_name}_*.png'", ")", ")", "\n", "if", "len", "(", "previous_plots", ")", "==", "0", ":", "\n", "        ", "index", "=", "0", "\n", "", "else", ":", "\n", "        ", "index", "=", "int", "(", "previous_plots", "[", "-", "1", "]", ".", "stem", ".", "split", "(", "'_'", ")", "[", "-", "1", "]", ")", "+", "1", "\n", "\n", "", "return", "str", "(", "plots_path", "/", "f'{dataset_name}_{index:03d}.png'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.plot_ious_analysis.get_files_list": [[113, 140], ["pathlib.Path().glob", "any", "pathlib.Path", "any", "Path().glob.extend", "pathlib.Path", "folder.glob", "rel_exp_path.split", "list", "Path().glob.extend", "exp_path_prefix.parent.glob", "len", "sorted"], "function", ["None"], ["", "def", "get_files_list", "(", "args", ",", "cfg", ")", ":", "\n", "    ", "if", "args", ".", "folder", "is", "not", "None", ":", "\n", "        ", "files_list", "=", "Path", "(", "args", ".", "folder", ")", ".", "glob", "(", "'*.pickle'", ")", "\n", "", "elif", "args", ".", "files", "is", "not", "None", ":", "\n", "        ", "files_list", "=", "args", ".", "files", "\n", "", "elif", "args", ".", "model_dirs", "is", "not", "None", ":", "\n", "        ", "files_list", "=", "[", "]", "\n", "for", "folder", "in", "args", ".", "model_dirs", ":", "\n", "            ", "folder", "=", "Path", "(", "folder", ")", "/", "'plots'", "\n", "files_list", ".", "extend", "(", "folder", ".", "glob", "(", "'*.pickle'", ")", ")", "\n", "", "", "elif", "args", ".", "exp_models", "is", "not", "None", ":", "\n", "        ", "files_list", "=", "[", "]", "\n", "for", "rel_exp_path", "in", "args", ".", "exp_models", ":", "\n", "            ", "rel_exp_path", ",", "checkpoint_prefix", "=", "rel_exp_path", ".", "split", "(", "':'", ")", "\n", "exp_path_prefix", "=", "cfg", ".", "EXPS_PATH", "/", "'evaluation_logs'", "/", "rel_exp_path", "\n", "candidates", "=", "list", "(", "exp_path_prefix", ".", "parent", ".", "glob", "(", "exp_path_prefix", ".", "stem", "+", "'*'", ")", ")", "\n", "assert", "len", "(", "candidates", ")", "==", "1", ",", "\"Invalid experiment path.\"", "\n", "exp_path", "=", "candidates", "[", "0", "]", "\n", "files_list", ".", "extend", "(", "sorted", "(", "(", "exp_path", "/", "'plots'", ")", ".", "glob", "(", "checkpoint_prefix", "+", "'*.pickle'", ")", ")", ")", "\n", "\n", "", "", "if", "args", ".", "mode", "is", "not", "None", ":", "\n", "        ", "files_list", "=", "[", "file", "for", "file", "in", "files_list", "\n", "if", "any", "(", "mode", "in", "file", ".", "stem", "for", "mode", "in", "args", ".", "mode", ")", "]", "\n", "", "files_list", "=", "[", "file", "for", "file", "in", "files_list", "\n", "if", "any", "(", "dataset", "in", "file", ".", "stem", "for", "dataset", "in", "args", ".", "datasets", ")", "]", "\n", "\n", "return", "files_list", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args": [[11, 24], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "isegm.utils.exp.load_config_file"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.exp.load_config_file"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", ")", "\n", "\n", "parser", ".", "add_argument", "(", "'dataset'", ",", "choices", "=", "[", "'openimages'", ",", "'ade20k'", ",", "'coco_lvis'", "]", ",", "help", "=", "''", ")", "\n", "parser", ".", "add_argument", "(", "'--split'", ",", "nargs", "=", "'+'", ",", "choices", "=", "[", "'train'", ",", "'val'", ",", "'test'", "]", ",", "type", "=", "str", ",", "default", "=", "[", "'train'", ",", "'val'", "]", ",", "\n", "help", "=", "''", ")", "\n", "parser", ".", "add_argument", "(", "'--n-jobs'", ",", "type", "=", "int", ",", "default", "=", "10", ")", "\n", "parser", ".", "add_argument", "(", "'--config-path'", ",", "type", "=", "str", ",", "default", "=", "'./config.yml'", ",", "\n", "help", "=", "'The path to the config file.'", ")", "\n", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "cfg", "=", "load_config_file", "(", "args", ".", "config_path", ",", "return_edict", "=", "True", ")", "\n", "return", "args", ",", "cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.main": [[26, 37], ["multiprocessing.set_start_method", "convert_annotations.parse_args", "scripts.annotations_conversion.openimages.create_annotations", "pathlib.Path", "scripts.annotations_conversion.ade20k.create_annotations", "pathlib.Path", "scripts.annotations_conversion.coco_lvis.create_annotations", "pathlib.Path", "pathlib.Path"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.scripts.convert_annotations.parse_args", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.openimages.create_annotations", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.openimages.create_annotations", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.openimages.create_annotations"], ["", "def", "main", "(", ")", ":", "\n", "    ", "mp", ".", "set_start_method", "(", "'spawn'", ")", "\n", "args", ",", "cfg", "=", "parse_args", "(", ")", "\n", "\n", "for", "split", "in", "args", ".", "split", ":", "\n", "        ", "if", "args", ".", "dataset", "==", "'openimages'", ":", "\n", "            ", "openimages", ".", "create_annotations", "(", "Path", "(", "cfg", ".", "OPENIMAGES_PATH", ")", ",", "dataset_split", "=", "split", ")", "\n", "", "elif", "args", ".", "dataset", "==", "'ade20k'", "and", "split", "!=", "'test'", ":", "\n", "            ", "ade20k", ".", "create_annotations", "(", "Path", "(", "cfg", ".", "ADE20K_PATH", ")", ",", "dataset_split", "=", "split", ",", "n_jobs", "=", "args", ".", "n_jobs", ")", "\n", "", "elif", "args", ".", "dataset", "==", "'coco_lvis'", ":", "\n", "            ", "coco_lvis", ".", "create_annotations", "(", "Path", "(", "cfg", ".", "LVIS_PATH", ")", ",", "Path", "(", "cfg", ".", "COCO_PATH", ")", ",", "dataset_split", "=", "split", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.parallel_map": [[9, 66], ["enumerate", "dict", "concurrent.futures.ProcessPoolExecutor", "tqdm.tqdm", "len", "concurrent.futures.as_completed", "out.append", "worker", "worker", "pool.submit", "pool.submit", "future.result", "print", "out.append", "worker", "worker", "tqdm.tqdm", "str"], "function", ["None"], ["def", "parallel_map", "(", "array", ",", "worker", ",", "const_args", "=", "None", ",", "n_jobs", "=", "16", ",", "use_kwargs", "=", "False", ",", "front_num", "=", "3", ",", "drop_none", "=", "False", ")", ":", "\n", "    ", "\"\"\"\n        A parallel version of the map function with a progress bar.\n\n        Args:\n            array (array-like): A list to iterate over\n            worker (function): A python function to apply to the elements of array\n            const_args (dict, default=None): Constant arguments, shared between all processes\n            n_jobs (int, default=16): The number of cores to use\n            use_kwargs (boolean, default=False): Whether to consider the elements of array as dictionaries of\n                keyword arguments to function\n            front_num (int, default=3): The number of iterations to run serially before kicking off the parallel job\n            drop_none (boolean, default=False): Whether to drop None values from the list of results or not\n        Returns:\n            [worker(**list[0], **const_args), worker(**list[1], **const_args), ...]\n    \"\"\"", "\n", "# Replace None with empty dict", "\n", "const_args", "=", "dict", "(", ")", "if", "const_args", "is", "None", "else", "const_args", "\n", "# We run the first few iterations serially to catch bugs", "\n", "if", "front_num", ">", "0", ":", "\n", "        ", "front", "=", "[", "worker", "(", "**", "a", ",", "**", "const_args", ")", "if", "use_kwargs", "else", "worker", "(", "a", ",", "**", "const_args", ")", "for", "a", "in", "array", "[", ":", "front_num", "]", "]", "\n", "", "else", ":", "\n", "        ", "front", "=", "[", "]", "\n", "# If we set n_jobs to 1, just run a list comprehension. This is useful for benchmarking and debugging.", "\n", "", "if", "n_jobs", "==", "1", ":", "\n", "        ", "return", "front", "+", "[", "worker", "(", "**", "a", ",", "**", "const_args", ")", "if", "use_kwargs", "else", "\n", "worker", "(", "a", ",", "**", "const_args", ")", "for", "a", "in", "tqdm", "(", "array", "[", "front_num", ":", "]", ")", "]", "\n", "# Assemble the workers", "\n", "", "with", "ProcessPoolExecutor", "(", "max_workers", "=", "n_jobs", ")", "as", "pool", ":", "\n", "# Pass the elements of array into function", "\n", "        ", "if", "use_kwargs", ":", "\n", "            ", "futures", "=", "[", "pool", ".", "submit", "(", "worker", ",", "**", "a", ",", "**", "const_args", ")", "for", "a", "in", "array", "[", "front_num", ":", "]", "]", "\n", "", "else", ":", "\n", "            ", "futures", "=", "[", "pool", ".", "submit", "(", "worker", ",", "a", ",", "**", "const_args", ")", "for", "a", "in", "array", "[", "front_num", ":", "]", "]", "\n", "", "tqdm_kwargs", "=", "{", "\n", "'total'", ":", "len", "(", "futures", ")", ",", "\n", "'unit'", ":", "'it'", ",", "\n", "'unit_scale'", ":", "True", ",", "\n", "'leave'", ":", "True", ",", "\n", "'ncols'", ":", "100", "\n", "}", "\n", "# Print out the progress as tasks complete", "\n", "for", "_", "in", "tqdm", "(", "as_completed", "(", "futures", ")", ",", "**", "tqdm_kwargs", ")", ":", "\n", "            ", "pass", "\n", "", "", "out", "=", "[", "]", "\n", "# Get the results from the futures.", "\n", "for", "i", ",", "future", "in", "enumerate", "(", "futures", ")", ":", "\n", "        ", "try", ":", "\n", "            ", "out", ".", "append", "(", "future", ".", "result", "(", ")", ")", "\n", "", "except", "Exception", "as", "e", ":", "\n", "            ", "print", "(", "f\"Caught {str(e)} on {i}-th input.\"", ")", "\n", "out", ".", "append", "(", "None", ")", "\n", "\n", "", "", "if", "drop_none", ":", "\n", "        ", "return", "[", "v", "for", "v", "in", "front", "+", "out", "if", "v", "is", "not", "None", "]", "\n", "", "else", ":", "\n", "        ", "return", "front", "+", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_masks_hierarchy": [[68, 123], ["collections.defaultdict", "numpy.zeros", "range", "sorted", "common.get_masks_hierarchy.check_inter"], "function", ["None"], ["", "", "def", "get_masks_hierarchy", "(", "masks", ",", "masks_meta", ")", ":", "\n", "    ", "order", "=", "sorted", "(", "list", "(", "enumerate", "(", "masks_meta", ")", ")", ",", "key", "=", "lambda", "x", ":", "x", "[", "1", "]", "[", "1", "]", ")", "[", ":", ":", "-", "1", "]", "\n", "hierarchy", "=", "defaultdict", "(", "list", ")", "\n", "\n", "def", "check_inter", "(", "i", ",", "j", ")", ":", "\n", "        ", "assert", "masks_meta", "[", "i", "]", "[", "1", "]", ">=", "masks_meta", "[", "j", "]", "[", "1", "]", "\n", "bbox_i", ",", "bbox_j", "=", "masks_meta", "[", "i", "]", "[", "0", "]", ",", "masks_meta", "[", "j", "]", "[", "0", "]", "\n", "bbox_score", "=", "get_bbox_intersection", "(", "bbox_i", ",", "bbox_j", ")", "/", "get_bbox_area", "(", "bbox_j", ")", "\n", "if", "bbox_score", "<", "0.7", ":", "\n", "            ", "return", "False", "\n", "\n", "", "mask_i", ",", "mask_j", "=", "masks", "[", "i", "]", ",", "masks", "[", "j", "]", "\n", "mask_score", "=", "np", ".", "logical_and", "(", "mask_i", ",", "mask_j", ")", ".", "sum", "(", ")", "/", "masks_meta", "[", "j", "]", "[", "1", "]", "\n", "return", "mask_score", ">", "0.8", "\n", "\n", "", "def", "get_root_indx", "(", "root_indx", ",", "check_indx", ")", ":", "\n", "        ", "children", "=", "hierarchy", "[", "root_indx", "]", "\n", "for", "child_indx", "in", "children", ":", "\n", "            ", "if", "masks_meta", "[", "child_indx", "]", "[", "1", "]", "<", "masks_meta", "[", "check_indx", "]", "[", "1", "]", ":", "\n", "                ", "continue", "\n", "", "result_indx", "=", "get_root_indx", "(", "child_indx", ",", "check_indx", ")", "\n", "if", "result_indx", "is", "not", "None", ":", "\n", "                ", "return", "result_indx", "\n", "\n", "", "", "if", "check_inter", "(", "root_indx", ",", "check_indx", ")", ":", "\n", "            ", "return", "root_indx", "\n", "\n", "", "return", "None", "\n", "\n", "", "used_masks", "=", "np", ".", "zeros", "(", "len", "(", "masks", ")", ",", "dtype", "=", "np", ".", "bool", ")", "\n", "parents", "=", "[", "None", "]", "*", "len", "(", "masks", ")", "\n", "node_level", "=", "[", "0", "]", "*", "len", "(", "masks", ")", "\n", "for", "ti", "in", "range", "(", "len", "(", "masks", ")", "-", "1", ")", ":", "\n", "        ", "for", "tj", "in", "range", "(", "ti", "+", "1", ",", "len", "(", "masks", ")", ")", ":", "\n", "            ", "i", "=", "order", "[", "ti", "]", "[", "0", "]", "\n", "j", "=", "order", "[", "tj", "]", "[", "0", "]", "\n", "\n", "assert", "i", "!=", "j", "\n", "if", "used_masks", "[", "j", "]", "or", "not", "check_inter", "(", "i", ",", "j", ")", ":", "\n", "                ", "continue", "\n", "\n", "", "ni", "=", "get_root_indx", "(", "i", ",", "j", ")", "\n", "assert", "ni", "!=", "j", "and", "parents", "[", "j", "]", "is", "None", "\n", "hierarchy", "[", "ni", "]", ".", "append", "(", "j", ")", "\n", "used_masks", "[", "j", "]", "=", "True", "\n", "parents", "[", "j", "]", "=", "ni", "\n", "node_level", "[", "j", "]", "=", "node_level", "[", "ni", "]", "+", "1", "\n", "\n", "", "", "hierarchy", "=", "[", "hierarchy", "[", "i", "]", "for", "i", "in", "range", "(", "len", "(", "masks", ")", ")", "]", "\n", "hierarchy", "=", "{", "i", ":", "{", "'children'", ":", "hierarchy", "[", "i", "]", ",", "\n", "'parent'", ":", "parents", "[", "i", "]", ",", "\n", "'node_level'", ":", "node_level", "[", "i", "]", "\n", "}", "\n", "for", "i", "in", "range", "(", "len", "(", "masks", ")", ")", "}", "\n", "return", "hierarchy", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_bbox_intersection": [[125, 129], ["common.get_segments_intersection", "common.get_segments_intersection"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_segments_intersection", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_segments_intersection"], ["", "def", "get_bbox_intersection", "(", "b1", ",", "b2", ")", ":", "\n", "    ", "h_i", "=", "get_segments_intersection", "(", "b1", "[", ":", "2", "]", ",", "b2", "[", ":", "2", "]", ")", "\n", "w_i", "=", "get_segments_intersection", "(", "b1", "[", "2", ":", "4", "]", ",", "b2", "[", "2", ":", "4", "]", ")", "\n", "return", "h_i", "*", "w_i", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_segments_intersection": [[131, 135], ["max", "min", "max"], "function", ["None"], ["", "def", "get_segments_intersection", "(", "s1", ",", "s2", ")", ":", "\n", "    ", "a", ",", "b", "=", "s1", "\n", "c", ",", "d", "=", "s2", "\n", "return", "max", "(", "0", ",", "min", "(", "b", ",", "d", ")", "-", "max", "(", "a", ",", "c", ")", "+", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_bbox_area": [[137, 139], ["None"], "function", ["None"], ["", "def", "get_bbox_area", "(", "bbox", ")", ":", "\n", "    ", "return", "(", "bbox", "[", "1", "]", "-", "bbox", "[", "0", "]", "+", "1", ")", "*", "(", "bbox", "[", "3", "]", "-", "bbox", "[", "2", "]", "+", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_iou": [[141, 145], ["numpy.logical_and().sum", "numpy.logical_or().sum", "numpy.logical_and", "numpy.logical_or"], "function", ["None"], ["", "def", "get_iou", "(", "mask1", ",", "mask2", ")", ":", "\n", "    ", "intersection_area", "=", "np", ".", "logical_and", "(", "mask1", ",", "mask2", ")", ".", "sum", "(", ")", "\n", "union_area", "=", "np", ".", "logical_or", "(", "mask1", ",", "mask2", ")", ".", "sum", "(", ")", "\n", "return", "intersection_area", "/", "union_area", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.encode_masks": [[147, 171], ["numpy.zeros", "len", "sorted", "enumerate", "list", "zip", "numpy.all", "numpy.zeros_like", "layers.append", "layers_objs.append", "cv2.imencode", "enumerate", "len", "layer_objs.append", "len", "len", "x[].sum"], "function", ["None"], ["", "def", "encode_masks", "(", "masks", ")", ":", "\n", "    ", "layers", "=", "[", "np", ".", "zeros", "(", "masks", "[", "0", "]", ".", "shape", ",", "dtype", "=", "np", ".", "uint8", ")", "]", "\n", "layers_objs", "=", "[", "[", "]", "]", "\n", "objs_mapping", "=", "[", "(", "None", ",", "None", ")", "]", "*", "len", "(", "masks", ")", "\n", "ordered_masks", "=", "sorted", "(", "list", "(", "enumerate", "(", "masks", ")", ")", ",", "key", "=", "lambda", "x", ":", "x", "[", "1", "]", ".", "sum", "(", ")", ")", "[", ":", ":", "-", "1", "]", "\n", "for", "global_id", ",", "obj_mask", "in", "ordered_masks", ":", "\n", "        ", "for", "layer_indx", ",", "(", "layer_mask", ",", "layer_objs", ")", "in", "enumerate", "(", "zip", "(", "layers", ",", "layers_objs", ")", ")", ":", "\n", "            ", "if", "len", "(", "layer_objs", ")", ">=", "255", ":", "\n", "                ", "continue", "\n", "", "if", "np", ".", "all", "(", "layer_mask", "[", "obj_mask", "]", "==", "0", ")", ":", "\n", "                ", "layer_objs", ".", "append", "(", "global_id", ")", "\n", "local_id", "=", "len", "(", "layer_objs", ")", "\n", "layer_mask", "[", "obj_mask", "]", "=", "local_id", "\n", "objs_mapping", "[", "global_id", "]", "=", "(", "layer_indx", ",", "local_id", ")", "\n", "break", "\n", "", "", "else", ":", "\n", "            ", "new_layer", "=", "np", ".", "zeros_like", "(", "layers", "[", "-", "1", "]", ")", "\n", "new_layer", "[", "obj_mask", "]", "=", "1", "\n", "objs_mapping", "[", "global_id", "]", "=", "(", "len", "(", "layers", ")", ",", "1", ")", "\n", "layers", ".", "append", "(", "new_layer", ")", "\n", "layers_objs", ".", "append", "(", "[", "global_id", "]", ")", "\n", "\n", "", "", "layers", "=", "[", "cv2", ".", "imencode", "(", "'.png'", ",", "x", ")", "[", "1", "]", "for", "x", "in", "layers", "]", "\n", "return", "layers", ",", "objs_mapping", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.decode_masks": [[173, 180], ["cv2.imdecode", "masks.append"], "function", ["None"], ["", "def", "decode_masks", "(", "packed_data", ")", ":", "\n", "    ", "layers", ",", "objs_mapping", "=", "packed_data", "\n", "layers", "=", "[", "cv2", ".", "imdecode", "(", "x", ",", "cv2", ".", "IMREAD_UNCHANGED", ")", "for", "x", "in", "layers", "]", "\n", "masks", "=", "[", "]", "\n", "for", "layer_indx", ",", "obj_id", "in", "objs_mapping", ":", "\n", "        ", "masks", ".", "append", "(", "layers", "[", "layer_indx", "]", "==", "obj_id", ")", "\n", "", "return", "masks", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.ade20k.worker_annotations_loader": [[17, 48], ["len", "list", "line.strip().split.strip().split", "int", "int", "name.strip", "set", "set", "[].append", "[].append", "line.strip().split.strip", "class_names.split", "range"], "function", ["None"], ["import", "numpy", "as", "np", "\n", "import", "os", "\n", "import", "json", "\n", "from", "PIL", "import", "Image", "\n", "\n", "\n", "def", "iter_files", "(", "root_dir", ",", "with_part", "=", "False", ")", ":", "\n", "    ", "image_path_dict", "=", "{", "}", "\n", "print", "(", "'=== Loading ADE20k data ==== '", ")", "\n", "for", "root", ",", "dirs", ",", "files", "in", "tqdm", "(", "os", ".", "walk", "(", "root_dir", ")", ")", ":", "\n", "        ", "for", "file", "in", "files", ":", "\n", "            ", "file_name", "=", "os", ".", "path", ".", "join", "(", "root", ",", "file", ")", "\n", "if", "file_name", ".", "endswith", "(", "'.jpg'", ")", ":", "\n", "                ", "mask_lst", "=", "[", "]", "\n", "seg_path", "=", "file_name", ".", "replace", "(", "'.jpg'", ",", "'_seg.png'", ")", "\n", "mask_lst", ".", "append", "(", "seg_path", ")", "\n", "\n", "if", "with_part", "==", "True", ":", "\n", "                    ", "part_1_path", "=", "file_name", ".", "replace", "(", "'.jpg'", ",", "'_parts_1.png'", ")", "\n", "if", "os", ".", "path", ".", "exists", "(", "part_1_path", ")", ":", "\n", "                        ", "mask_lst", ".", "append", "(", "part_1_path", ")", "\n", "part_2_path", "=", "file_name", ".", "replace", "(", "'.jpg'", ",", "'_parts_2.png'", ")", "\n", "if", "os", ".", "path", ".", "exists", "(", "part_2_path", ")", ":", "\n", "                            ", "mask_lst", ".", "append", "(", "part_2_path", ")", "\n", "", "", "", "image_path_dict", "[", "file_name", "]", "=", "mask_lst", "\n", "", "", "", "return", "image_path_dict", "\n", "\n", "\n", "\n", "\n", "", "class", "ADE20kDataset", "(", "ISDataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "dataset_path", "=", "None", ",", "with_part", "=", "False", ",", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.ade20k.load_and_parse_annotations": [[50, 66], ["scipy.io.loadmat", "scripts.annotations_conversion.common.parallel_map", "pathlib.Path().relative_to", "list", "image_id.split", "zip", "orig_annotations[].item", "pathlib.Path", "orig_annotations[].item"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.parallel_map"], ["        ", "super", "(", "ADE20kDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "self", ".", "name", "=", "'ADE20K'", "\n", "self", ".", "subset", "=", "'train'", "\n", "self", ".", "dataset_path", "=", "dataset_path", "+", "'/ADE20K_2016_07_26/images/training/'", "\n", "images_dict", "=", "iter_files", "(", "self", ".", "dataset_path", ",", "with_part", "=", "with_part", ")", "\n", "self", ".", "dataset_samples", "=", "images_dict", "\n", "image_lst", "=", "list", "(", "self", ".", "dataset_samples", ".", "keys", "(", ")", ")", "\n", "self", ".", "image_lst", "=", "image_lst", "\n", "\n", "\n", "", "def", "get_sample", "(", "self", ",", "index", ")", ":", "\n", "        ", "image_path", "=", "self", ".", "image_lst", "[", "index", "]", "\n", "mask_lst", "=", "self", ".", "dataset_samples", "[", "image_path", "]", "\n", "if", "len", "(", "mask_lst", ")", ">", "1", ":", "\n", "            ", "idx", "=", "np", ".", "random", ".", "randint", "(", "len", "(", "mask_lst", ")", ")", "\n", "", "else", ":", "\n", "            ", "idx", "=", "0", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.ade20k.create_annotations": [[68, 84], ["ade20k.load_and_parse_annotations", "enumerate", "anno_path.open", "pickle.dump"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.ade20k.load_and_parse_annotations"], ["\n", "image", "=", "cv2", ".", "imread", "(", "str", "(", "image_path", ")", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "\n", "instances_mask", "=", "cv2", ".", "imread", "(", "str", "(", "mask_path", ")", ",", "cv2", ".", "IMREAD_UNCHANGED", ")", "[", ":", ",", ":", ",", "0", "]", ".", "astype", "(", "np", ".", "int32", ")", "\n", "instances_ids", "=", "np", ".", "unique", "(", "instances_mask", ")", "\n", "instances_ids", "=", "[", "i", "for", "i", "in", "instances_ids", "if", "i", "!=", "0", "]", "\n", "return", "DSample", "(", "image", ",", "instances_mask", ",", "objects_ids", "=", "instances_ids", ",", "ignore_ids", "=", "[", "-", "1", "]", ",", "sample_id", "=", "index", ")", "\n", "\n", "\n", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.coco_lvis.create_annotations": [[12, 101], ["isegm.data.datasets.LvisDataset", "isegm.data.datasets.CocoDataset", "enumerate", "output_masks_path.mkdir", "dict", "tqdm.tqdm", "lvis_images.get", "coco_lvis.get_coco_sample", "numpy.zeros", "coco_sample[].keys", "enumerate", "enumerate", "scripts.annotations_conversion.common.get_masks_hierarchy", "list", "numpy.max", "len", "coco_sample[].keys", "open", "pickle.dump", "[].split", "enumerate", "coco_lvis_mapping.append", "[].split", "isegm.data.datasets.LvisDataset.get_mask_from_polygon", "enumerate", "zip", "zip", "scripts.annotations_conversion.common.get_masks_hierarchy.items", "numpy.logical_and", "open", "pickle.dump", "coco_sample[].split", "np.logical_and.sum", "lvis_masks.append", "lvis_bboxes.append", "np.logical_and.sum", "coco_masks.append", "coco_bboxes.append", "masks.append", "isegm.utils.misc.get_bbox_iou", "masks.append", "isegm.utils.misc.get_bbox_from_mask", "x.sum", "numpy.logical_not", "np.logical_and.sum", "masks.append", "scripts.annotations_conversion.common.encode_masks", "isegm.utils.misc.get_bbox_from_mask", "isegm.utils.misc.get_bbox_from_mask", "len", "x[].split", "lvis_info[].split", "isegm.utils.misc.get_bbox_iou", "scripts.annotations_conversion.common.get_iou", "scripts.annotations_conversion.common.get_iou"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.coco_lvis.get_coco_sample", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_masks_hierarchy", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.lvis.LvisDataset.get_mask_from_polygon", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_iou", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.encode_masks", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_from_mask", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.utils.misc.get_bbox_iou", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_iou", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.common.get_iou"], ["class", "CocoLvisDataset", "(", "ISDataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "img_split", "=", "'train2017'", ",", "stuff_prob", "=", "0.0", ",", "\n", "allow_list_name", "=", "None", ",", "anno_file", "=", "'hannotation.pickle'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", "CocoLvisDataset", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_split_path", "=", "dataset_path", "/", "split", "\n", "self", ".", "img_split_path", "=", "dataset_path", "/", "img_split", "\n", "self", ".", "split", "=", "split", "\n", "self", ".", "img_split", "=", "img_split", "\n", "self", ".", "_images_path", "=", "self", ".", "_split_path", "/", "'images'", "\n", "#self._images_path = self.img_split_path / 'images'", "\n", "\n", "self", ".", "_masks_path", "=", "self", ".", "_split_path", "/", "'masks'", "\n", "self", ".", "stuff_prob", "=", "stuff_prob", "\n", "\n", "with", "open", "(", "self", ".", "_split_path", "/", "anno_file", ",", "'rb'", ")", "as", "f", ":", "\n", "            ", "self", ".", "dataset_samples", "=", "sorted", "(", "pickle", ".", "load", "(", "f", ")", ".", "items", "(", ")", ")", "\n", "\n", "", "if", "allow_list_name", "is", "not", "None", ":", "\n", "            ", "allow_list_path", "=", "self", ".", "_split_path", "/", "allow_list_name", "\n", "with", "open", "(", "allow_list_path", ",", "'r'", ")", "as", "f", ":", "\n", "                ", "allow_images_ids", "=", "json", ".", "load", "(", "f", ")", "\n", "", "allow_images_ids", "=", "set", "(", "allow_images_ids", ")", "\n", "\n", "self", ".", "dataset_samples", "=", "[", "sample", "for", "sample", "in", "self", ".", "dataset_samples", "\n", "if", "sample", "[", "0", "]", "in", "allow_images_ids", "]", "\n", "\n", "", "", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_id", ",", "sample", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n", "image_path", "=", "self", ".", "_images_path", "/", "f'{image_id}.jpg'", "\n", "\n", "image", "=", "cv2", ".", "imread", "(", "str", "(", "image_path", ")", ")", "\n", "image", "=", "cv2", ".", "cvtColor", "(", "image", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "packed_masks_path", "=", "self", ".", "_masks_path", "/", "f'{image_id}.pickle'", "\n", "\n", "\n", "with", "open", "(", "packed_masks_path", ",", "'rb'", ")", "as", "f", ":", "\n", "            ", "encoded_layers", ",", "objs_mapping", "=", "pickle", ".", "load", "(", "f", ")", "\n", "", "layers", "=", "[", "cv2", ".", "imdecode", "(", "x", ",", "cv2", ".", "IMREAD_UNCHANGED", ")", "for", "x", "in", "encoded_layers", "]", "\n", "layers", "=", "np", ".", "stack", "(", "layers", ",", "axis", "=", "2", ")", "\n", "\n", "instances_info", "=", "deepcopy", "(", "sample", "[", "'hierarchy'", "]", ")", "\n", "\n", "for", "inst_id", ",", "inst_info", "in", "list", "(", "instances_info", ".", "items", "(", ")", ")", ":", "\n", "            ", "if", "inst_info", "is", "None", ":", "\n", "                ", "inst_info", "=", "{", "'children'", ":", "[", "]", ",", "'parent'", ":", "None", ",", "'node_level'", ":", "0", "}", "\n", "instances_info", "[", "inst_id", "]", "=", "inst_info", "\n", "", "inst_info", "[", "'mapping'", "]", "=", "objs_mapping", "[", "inst_id", "]", "\n", "\n", "", "if", "self", ".", "stuff_prob", ">", "0", "and", "random", ".", "random", "(", ")", "<", "self", ".", "stuff_prob", ":", "\n", "            ", "for", "inst_id", "in", "range", "(", "sample", "[", "'num_instance_masks'", "]", ",", "len", "(", "objs_mapping", ")", ")", ":", "\n", "                ", "instances_info", "[", "inst_id", "]", "=", "{", "\n", "'mapping'", ":", "objs_mapping", "[", "inst_id", "]", ",", "\n", "'parent'", ":", "None", ",", "\n", "'children'", ":", "[", "]", "\n", "}", "\n", "", "", "else", ":", "\n", "            ", "for", "inst_id", "in", "range", "(", "sample", "[", "'num_instance_masks'", "]", ",", "len", "(", "objs_mapping", ")", ")", ":", "\n", "                ", "layer_indx", ",", "mask_id", "=", "objs_mapping", "[", "inst_id", "]", "\n", "layers", "[", ":", ",", ":", ",", "layer_indx", "]", "[", "layers", "[", ":", ",", ":", ",", "layer_indx", "]", "==", "mask_id", "]", "=", "0", "\n", "\n", "\n", "\n", "#return DSample(image, layers, objects_ids=np.unique(layers), sample_id=index)", "\n", "", "", "return", "DSample", "(", "image", ",", "layers", ",", "objects", "=", "instances_info", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.coco_lvis.get_coco_sample": [[103, 141], ["cv2.imread", "cv2.cvtColor", "cv2.imread().astype", "numpy.full_like", "numpy.full_like", "dict", "dict", "dataset.get_image_name", "str", "cv2.imread", "str"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.datasets.coco.CocoDataset.get_image_name"], []], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.annotations_conversion.openimages.create_annotations": [[7, 34], ["pathlib.Path", "list", "collections.defaultdict", "open", "csv.DictReader", "annotations[].keys", "clean_anno_path.open", "pickle.dump", "[].append"], "function", ["None"], ["import", "numpy", "as", "np", "\n", "\n", "from", "isegm", ".", "data", ".", "base", "import", "ISDataset", "\n", "from", "isegm", ".", "data", ".", "sample", "import", "DSample", "\n", "\n", "\n", "class", "OpenImagesDataset", "(", "ISDataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "dataset_path", ",", "split", "=", "'train'", ",", "**", "kwargs", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "assert", "split", "in", "{", "'train'", ",", "'val'", ",", "'test'", "}", "\n", "\n", "self", ".", "dataset_path", "=", "Path", "(", "dataset_path", ")", "\n", "self", ".", "_split_path", "=", "self", ".", "dataset_path", "/", "split", "\n", "self", ".", "_images_path", "=", "self", ".", "_split_path", "/", "'images'", "\n", "self", ".", "_masks_path", "=", "self", ".", "_split_path", "/", "'masks'", "\n", "self", ".", "dataset_split", "=", "split", "\n", "\n", "clean_anno_path", "=", "self", ".", "_split_path", "/", "f'{split}-annotations-object-segmentation_clean.pkl'", "\n", "if", "os", ".", "path", ".", "exists", "(", "clean_anno_path", ")", ":", "\n", "            ", "with", "clean_anno_path", ".", "open", "(", "'rb'", ")", "as", "f", ":", "\n", "                ", "annotations", "=", "pkl", ".", "load", "(", "f", ")", "\n", "", "", "else", ":", "\n", "            ", "raise", "RuntimeError", "(", "f\"Can't find annotations at {clean_anno_path}\"", ")", "\n", "", "self", ".", "image_id_to_masks", "=", "annotations", "[", "'image_id_to_masks'", "]", "\n", "self", ".", "dataset_samples", "=", "annotations", "[", "'dataset_samples'", "]", "\n", "\n", "", "def", "get_sample", "(", "self", ",", "index", ")", "->", "DSample", ":", "\n", "        ", "image_id", "=", "self", ".", "dataset_samples", "[", "index", "]", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.generate_init_masks_480p.selectimagefromdir": [[9, 38], ["os.path.exists", "os.mkdir", "os.listdir", "sorted", "int", "range", "shutil.rmtree", "cv2.imread", "numpy.array", "range", "len", "image_name.replace", "PIL.Image.open", "numpy.unique", "len", "image_name.replace", "mask_j.sum", "cv2.imwrite", "cv2.imwrite", "str"], "function", ["None"], ["def", "selectimagefromdir", "(", "dir_name", "=", "'bear'", ",", "select_number", "=", "10", ")", ":", "\n", "    ", "image_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/DAVIS480P/JPEGImages/480p/'", "+", "dir_name", "+", "'/'", "\n", "mask_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/DAVIS480P/Annotations/480p/'", "+", "dir_name", "+", "'/'", "\n", "\n", "save_image_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/IS_newdata/DAVIS/Selected_480P/'", "+", "dir_name", "+", "'/'", "\n", "if", "os", ".", "path", ".", "exists", "(", "save_image_dir", ")", ":", "\n", "        ", "shutil", ".", "rmtree", "(", "save_image_dir", ")", "\n", "", "os", ".", "mkdir", "(", "save_image_dir", ")", "\n", "image_lst", "=", "os", ".", "listdir", "(", "image_dir", ")", "\n", "image_lst", "=", "sorted", "(", "image_lst", ",", "reverse", "=", "True", ")", "\n", "step", "=", "int", "(", "len", "(", "image_lst", ")", "/", "select_number", ")", "\n", "for", "index", "in", "range", "(", "select_number", ")", ":", "\n", "        ", "i", "=", "index", "*", "step", "\n", "image_name", "=", "image_lst", "[", "i", "]", "\n", "image_path", "=", "image_dir", "+", "image_name", "\n", "save_image_path", "=", "save_image_dir", "+", "image_name", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "#cv2.imwrite(save_image_path,image)", "\n", "\n", "mask_path", "=", "mask_dir", "+", "image_name", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", "\n", "mask", "=", "np", ".", "array", "(", "Image", ".", "open", "(", "mask_path", ")", ",", "dtype", "=", "np", ".", "uint8", ")", "\n", "#print(mask.shape, np.unique(mask)) #(1080, 1920, 3) [  0 128]", "\n", "labels", "=", "np", ".", "unique", "(", "mask", ")", "[", "1", ":", "]", "\n", "for", "j", "in", "range", "(", "len", "(", "labels", ")", ")", ":", "\n", "            ", "save_mask_path", "=", "save_image_dir", "+", "'object'", "+", "str", "(", "j", "+", "1", ")", "+", "'_'", "+", "image_name", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", "\n", "mask_j", "=", "(", "mask", "==", "labels", "[", "j", "]", ")", "\n", "if", "mask_j", ".", "sum", "(", ")", ">", "300", ":", "#100 * 100:", "\n", "                ", "cv2", ".", "imwrite", "(", "save_mask_path", ",", "mask_j", "*", "255", ")", "\n", "cv2", ".", "imwrite", "(", "save_image_path", ",", "image", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.generate_init_masks_480p.generate_init_mask_stm": [[41, 69], ["os.listdir", "int", "cv2.imread", "numpy.array", "cv2.imwrite", "mask_lst.append", "mask_name.split", "PIL.Image.open", "cv2.resize", "np.array.astype"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.segformer.segformer_head.resize"], ["", "", "", "", "def", "generate_init_mask_stm", "(", "dir_name", "=", "'bike-packing'", ")", ":", "\n", "    ", "stm_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/IS_newdata/DAVIS/stm/'", "+", "dir_name", "+", "'/'", "\n", "gt_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/IS_newdata/DAVIS/Selected_480P/'", "+", "dir_name", "+", "'/'", "\n", "image_lst", "=", "os", ".", "listdir", "(", "gt_dir", ")", "\n", "#print(image_lst)", "\n", "mask_lst", "=", "[", "]", "\n", "for", "i", "in", "image_lst", ":", "\n", "        ", "if", "'.png'", "in", "i", "and", "'init'", "not", "in", "i", ":", "\n", "            ", "mask_lst", ".", "append", "(", "i", ")", "\n", "\n", "", "", "for", "mask_name", "in", "mask_lst", ":", "\n", "        ", "obj_id", "=", "int", "(", "mask_name", "[", "6", "]", ")", "\n", "gt_mask_name", "=", "mask_name", ".", "split", "(", "'_'", ")", "[", "-", "1", "]", "\n", "mask", "=", "cv2", ".", "imread", "(", "gt_dir", "+", "mask_name", ")", "\n", "H", ",", "W", "=", "mask", ".", "shape", "[", "0", "]", ",", "mask", ".", "shape", "[", "1", "]", "\n", "\n", "\n", "#print(obj_id, gt_mask_name)", "\n", "stm_mask_path", "=", "stm_dir", "+", "gt_mask_name", "\n", "stm_mask", "=", "np", ".", "array", "(", "Image", ".", "open", "(", "stm_mask_path", ")", ",", "dtype", "=", "np", ".", "uint8", ")", "\n", "stm_mask", "=", "(", "stm_mask", "==", "obj_id", ")", "*", "255", "\n", "\n", "stm_mask", "=", "(", "(", "cv2", ".", "resize", "(", "stm_mask", ".", "astype", "(", "np", ".", "uint8", ")", ",", "(", "W", ",", "H", ")", ")", ">", "128", ")", "*", "255", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "\n", "\n", "init_mask_name", "=", "'init_stm_'", "+", "mask_name", "\n", "init_mask_path", "=", "gt_dir", "+", "init_mask_name", "\n", "cv2", ".", "imwrite", "(", "init_mask_path", ",", "stm_mask", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.generate_init_masks_480p.generate_init_mask_sp": [[71, 92], ["os.listdir", "tqdm.tqdm", "cv2.imread", "cv2.imread", "cv2.imwrite", "mask_lst.append", "[].replace", "superpixel_augmentation.superpixel_aug", "numpy.stack", "mask_name.split"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.superpixel_augmentation.superpixel_aug"], ["", "", "def", "generate_init_mask_sp", "(", "dir_name", "=", "'bike-packing'", ")", ":", "\n", "    ", "gt_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/IS_newdata/DAVIS/Selected_480P/'", "+", "dir_name", "+", "'/'", "\n", "image_lst", "=", "os", ".", "listdir", "(", "gt_dir", ")", "\n", "#print(image_lst)", "\n", "mask_lst", "=", "[", "]", "\n", "for", "i", "in", "image_lst", ":", "\n", "        ", "if", "'.png'", "in", "i", "and", "'init'", "not", "in", "i", ":", "\n", "            ", "mask_lst", ".", "append", "(", "i", ")", "\n", "\n", "", "", "for", "mask_name", "in", "tqdm", "(", "mask_lst", ")", ":", "\n", "        ", "gt_mask_path", "=", "gt_dir", "+", "mask_name", "\n", "gt_mask", "=", "cv2", ".", "imread", "(", "gt_mask_path", ")", "\n", "image_path", "=", "gt_dir", "+", "mask_name", ".", "split", "(", "'_'", ")", "[", "-", "1", "]", ".", "replace", "(", "'.png'", ",", "'.jpg'", ")", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "\n", "sp_mask", "=", "superpixel_aug", "(", "image", ",", "gt_mask", "[", ":", ",", ":", ",", "0", "]", ">", "128", ",", "0.85", ",", "0.75", ")", "[", "0", "]", "\n", "sp_mask", "=", "(", "np", ".", "stack", "(", "[", "sp_mask", ",", "sp_mask", ",", "sp_mask", "]", ",", "-", "1", ")", "*", "255", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "\n", "init_mask_name", "=", "'init_sp_'", "+", "mask_name", "\n", "init_mask_path", "=", "gt_dir", "+", "init_mask_name", "\n", "cv2", ".", "imwrite", "(", "init_mask_path", ",", "sp_mask", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.select_images.selectimagefromdir": [[8, 35], ["os.path.exists", "os.mkdir", "os.listdir", "sorted", "int", "range", "shutil.rmtree", "cv2.imread", "cv2.imwrite", "numpy.array", "range", "len", "image_name.replace", "PIL.Image.open", "numpy.unique", "len", "cv2.imwrite", "image_name.replace", "str"], "function", ["None"], ["def", "selectimagefromdir", "(", "dir_name", "=", "'bear'", ",", "select_number", "=", "10", ")", ":", "\n", "    ", "image_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/JPEGImages/Full-Resolution/'", "+", "dir_name", "+", "'/'", "\n", "mask_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/Annotations/Full-Resolution/'", "+", "dir_name", "+", "'/'", "\n", "\n", "save_image_dir", "=", "'/Users/chenxi/Desktop/Ali_projects/DATA/DAVIS/IS_newdata/DAVIS/Selected/'", "+", "dir_name", "+", "'/'", "\n", "if", "os", ".", "path", ".", "exists", "(", "save_image_dir", ")", ":", "\n", "        ", "shutil", ".", "rmtree", "(", "save_image_dir", ")", "\n", "", "os", ".", "mkdir", "(", "save_image_dir", ")", "\n", "image_lst", "=", "os", ".", "listdir", "(", "image_dir", ")", "\n", "image_lst", "=", "sorted", "(", "image_lst", ",", "reverse", "=", "True", ")", "\n", "step", "=", "int", "(", "len", "(", "image_lst", ")", "/", "select_number", ")", "\n", "for", "index", "in", "range", "(", "select_number", ")", ":", "\n", "        ", "i", "=", "index", "*", "step", "\n", "image_name", "=", "image_lst", "[", "i", "]", "\n", "image_path", "=", "image_dir", "+", "image_name", "\n", "save_image_path", "=", "save_image_dir", "+", "image_name", "\n", "image", "=", "cv2", ".", "imread", "(", "image_path", ")", "\n", "cv2", ".", "imwrite", "(", "save_image_path", ",", "image", ")", "\n", "\n", "mask_path", "=", "mask_dir", "+", "image_name", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", "\n", "mask", "=", "np", ".", "array", "(", "Image", ".", "open", "(", "mask_path", ")", ",", "dtype", "=", "np", ".", "uint8", ")", "\n", "#print(mask.shape, np.unique(mask)) #(1080, 1920, 3) [  0 128]", "\n", "labels", "=", "np", ".", "unique", "(", "mask", ")", "[", "1", ":", "]", "\n", "for", "j", "in", "range", "(", "len", "(", "labels", ")", ")", ":", "\n", "            ", "save_mask_path", "=", "save_image_dir", "+", "'object'", "+", "str", "(", "j", "+", "1", ")", "+", "'_'", "+", "image_name", ".", "replace", "(", "'.jpg'", ",", "'.png'", ")", "\n", "mask_j", "=", "(", "mask", "==", "labels", "[", "j", "]", ")", "*", "255", "\n", "cv2", ".", "imwrite", "(", "save_mask_path", ",", "mask_j", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.superpixel_augmentation.cal_iou": [[7, 12], ["numpy.logical_and().sum", "numpy.logical_or().sum", "numpy.logical_and", "numpy.logical_or"], "function", ["None"], ["def", "cal_iou", "(", "mask", ",", "gt", ")", ":", "\n", "    ", "intersection", "=", "np", ".", "logical_and", "(", "mask", ",", "gt", ")", ".", "sum", "(", ")", "\n", "union", "=", "np", ".", "logical_or", "(", "mask", ",", "gt", ")", ".", "sum", "(", ")", "\n", "iou", "=", "intersection", "/", "union", "\n", "return", "iou", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.superpixel_augmentation.superpixel_aug": [[14, 74], ["numpy.ones", "mask_np.astype", "cv2.erode", "cv2.dilate", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "cv2.cvtColor", "numpy.logical_not", "numpy.logical_not", "numpy.logical_not", "numpy.logical_not", "range", "superpixel_augmentation.cal_iou", "numpy.random.choice", "numpy.array", "fast_slic.Slic", "fast_slic.Slic.iterate", "numpy.argwhere", "superpixel_augmentation.cal_iou", "print", "numpy.random.choice", "numpy.random.choice", "region.sum", "numpy.random.choice", "numpy.logical_or", "numpy.logical_and", "numpy.random.randint", "numpy.logical_not", "len", "np.array.sum"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.superpixel_augmentation.cal_iou", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.DAVIS585_datatset.superpixel_augmentation.cal_iou"], ["", "def", "superpixel_aug", "(", "image_np", ",", "mask_np", ",", "target_iou_max", ",", "target_iou_min", ")", ":", "\n", "    ", "prob_boundary_inner_outer", "=", "[", "0.65", ",", "0.25", ",", "0.1", "]", "\n", "num_defect_decay", "=", "0.4", "\n", "max_num_defect", "=", "5", "\n", "\n", "#num_defect_probs = np.array([num_defect_decay ** i for i in range(max_num_defect)])", "\n", "#num_defect_probs = num_defect_probs / num_defect_probs.sum()", "\n", "num_defect_probs", "=", "[", "0.2", ",", "0.2", ",", "0.2", ",", "0.2", ",", "0.2", "]", "\n", "num_defect", "=", "np", ".", "random", ".", "choice", "(", "5", ",", "1", ",", "p", "=", "num_defect_probs", ")", "[", "0", "]", "+", "1", "\n", "#print(num_defect, num_defect_probs)", "\n", "kernel", "=", "np", ".", "ones", "(", "(", "5", ",", "5", ")", ",", "np", ".", "uint8", ")", "\n", "mask", "=", "mask_np", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "erosion", "=", "cv2", ".", "erode", "(", "mask", ",", "kernel", ",", "iterations", "=", "3", ")", "\n", "dilation", "=", "cv2", ".", "dilate", "(", "mask", ",", "kernel", ",", "iterations", "=", "3", ")", "\n", "\n", "boundary_mask", "=", "np", ".", "logical_and", "(", "np", ".", "logical_not", "(", "erosion", ")", ",", "dilation", ")", "\n", "inner_mask", "=", "np", ".", "logical_and", "(", "mask", ",", "np", ".", "logical_not", "(", "boundary_mask", ")", ")", "\n", "outer_mask", "=", "np", ".", "logical_and", "(", "np", ".", "logical_not", "(", "mask", ")", ",", "np", ".", "logical_not", "(", "boundary_mask", ")", ")", "\n", "regions", "=", "[", "boundary_mask", ",", "inner_mask", ",", "outer_mask", "]", "\n", "image_lab", "=", "cv2", ".", "cvtColor", "(", "image_np", ",", "cv2", ".", "COLOR_RGB2LAB", ")", "# You can convert the image to CIELAB space if you need.", "\n", "\n", "#mask_modified = mask", "\n", "number", "=", "0", "\n", "while", "(", "1", ")", ":", "\n", "       ", "mask_modified", "=", "mask", "\n", "num_defect", "=", "np", ".", "random", ".", "choice", "(", "5", ",", "1", ",", "p", "=", "num_defect_probs", ")", "[", "0", "]", "+", "1", "\n", "num_defect", "=", "10", "\n", "for", "i", "in", "range", "(", "num_defect", ")", ":", "\n", "           ", "region_index", "=", "np", ".", "random", ".", "choice", "(", "3", ",", "1", ",", "p", "=", "prob_boundary_inner_outer", ")", "[", "0", "]", "\n", "region", "=", "regions", "[", "region_index", "]", "\n", "#print(mask_np.sum(),region_index,region.sum() )", "\n", "if", "region", ".", "sum", "(", ")", "<", "5", ":", "\n", "              ", "region", "=", "mask_np", "\n", "\n", "#p = np.array( [0.3,1,1,0.5,0.4,0.2])", "\n", "", "p", "=", "np", ".", "array", "(", "[", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", "]", ")", "\n", "num_pixel", "=", "np", ".", "random", ".", "choice", "(", "[", "50", ",", "100", ",", "200", ",", "300", ",", "500", ",", "700", "]", ",", "1", ",", "p", "=", "p", "/", "p", ".", "sum", "(", ")", ")", "[", "0", "]", "\n", "slic", "=", "Slic", "(", "num_components", "=", "num_pixel", ",", "compactness", "=", "10", ")", "\n", "assignment", "=", "slic", ".", "iterate", "(", "image_lab", ")", "# Cluster Map", "\n", "indices", "=", "np", ".", "argwhere", "(", "region", ")", "\n", "y", ",", "x", "=", "indices", "[", "np", ".", "random", ".", "randint", "(", "0", ",", "len", "(", "indices", ")", ")", "]", "\n", "selected_patch", "=", "assignment", "==", "assignment", "[", "y", ",", "x", "]", "\n", "if", "mask_modified", "[", "y", ",", "x", "]", "==", "0", ":", "\n", "               ", "mask_modified", "=", "np", ".", "logical_or", "(", "mask_modified", ",", "selected_patch", ")", "\n", "", "else", ":", "\n", "               ", "mask_modified", "=", "np", ".", "logical_and", "(", "mask_modified", ",", "np", ".", "logical_not", "(", "selected_patch", ")", ")", "\n", "", "iou", "=", "cal_iou", "(", "mask_modified", ",", "mask_np", ")", "\n", "if", "iou", ">=", "target_iou_min", "and", "iou", "<=", "target_iou_max", ":", "\n", "               ", "return", "mask_modified", ",", "iou", "\n", "#print('failure iou :',iou, '  number : ',i)", "\n", "", "if", "iou", "<", "target_iou_min", ":", "\n", "               ", "break", "\n", "\n", "", "", "iou", "=", "cal_iou", "(", "mask_modified", ",", "mask_np", ")", "\n", "if", "iou", ">=", "target_iou_min", "and", "iou", "<=", "target_iou_max", ":", "\n", "            ", "return", "mask_modified", ",", "iou", "\n", "", "number", "+=", "1", "\n", "if", "number", ">", "30", ":", "\n", "         ", "print", "(", "'failure iou :'", ",", "iou", ",", "'  number : '", ",", "number", ")", "\n", "return", "mask_modified", ",", "iou", "", "", "", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_cclvs.main": [[8, 11], ["pplcnet_x1_cclvs.init_model", "pplcnet_x1_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_cclvs.init_model": [[13, 23], ["edict", "BaselineModel", "BaselineModel.to", "BaselineModel.apply", "BaselineModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "384", ",", "384", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "BaselineModel", "(", "backbone", "=", "'PPLCNet'", ",", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "PPLCNET_X1", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_cclvs.train": [[25, 89], ["edict", "NormalizedFocalLossSigmoid", "NormalizedFocalLossSigmoid", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.baseline_trainer.ISTrainer", "isegm.engine.baseline_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.70", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.2", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.mobilenetv2_x1_comb.main": [[8, 11], ["mobilenetv2_x1_comb.init_model", "mobilenetv2_x1_comb.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.mobilenetv2_x1_comb.init_model": [[13, 23], ["edict", "BaselineModel", "BaselineModel.to", "BaselineModel.apply", "BaselineModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "384", ",", "384", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "BaselineModel", "(", "backbone", "=", "'MobleNetV2'", ",", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "MOBILENETV2", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.mobilenetv2_x1_comb.train": [[25, 148], ["edict", "NormalizedFocalLossSigmoid", "NormalizedFocalLossSigmoid", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "ADE20kDataset", "CocoLvisDataset", "YouTubeDataset", "SaliencyDataset", "HFlickerDataset", "ThinObjectDataset", "isegm.data.compose.ProportionalComposeDataset", "CocoLvisDataset", "partial", "isegm.engine.baseline_trainer.ISTrainer", "isegm.engine.baseline_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.5", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "1", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.70", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_ade20k", "=", "ADE20kDataset", "(", "\n", "cfg", ".", "ADE20K_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", "with_part", "=", "False", "\n", ")", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.0", "\n", ")", "\n", "\n", "trainset_ytbvos", "=", "YouTubeDataset", "(", "\n", "cfg", ".", "YTBVOS_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "\n", "trainset_saliency", "=", "SaliencyDataset", "(", "\n", "[", "cfg", ".", "MSRA10K_PATH", ",", "cfg", ".", "DUT_TR_PATH", ",", "cfg", ".", "DUT_TE_PATH", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_hflicker", "=", "HFlickerDataset", "(", "\n", "cfg", ".", "HFLICKER_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_thin", "=", "ThinObjectDataset", "(", "\n", "cfg", ".", "THINOBJECT_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset", "=", "ProportionalComposeDataset", "(", "\n", "[", "trainset_cclvs", ",", "trainset_saliency", ",", "trainset_thin", ",", "trainset_ytbvos", ",", "trainset_hflicker", ",", "trainset_ade20k", "]", ",", "\n", "[", "0.35", ",", "0.10", ",", "0.1", ",", "0.2", ",", "0.1", ",", "0.15", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", ")", "\n", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-2", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_comb.main": [[8, 11], ["pplcnet_x1_comb.init_model", "pplcnet_x1_comb.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_comb.init_model": [[13, 23], ["edict", "BaselineModel", "BaselineModel.to", "BaselineModel.apply", "BaselineModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "384", ",", "384", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "BaselineModel", "(", "backbone", "=", "'PPLCNet'", ",", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "PPLCNET_X1", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_comb.train": [[25, 149], ["edict", "NormalizedFocalLossSigmoid", "NormalizedFocalLossSigmoid", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "YouTubeDataset", "ADE20kDataset", "SaliencyDataset", "HFlickerDataset", "ThinObjectDataset", "isegm.data.compose.ProportionalComposeDataset", "CocoLvisDataset", "partial", "isegm.engine.baseline_trainer.ISTrainer", "isegm.engine.baseline_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.5", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "1", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.70", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.1", "\n", ")", "\n", "\n", "trainset_ytbvos", "=", "YouTubeDataset", "(", "\n", "cfg", ".", "YTBVOS_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "\n", "trainset_ade20k", "=", "ADE20kDataset", "(", "\n", "cfg", ".", "ADE20K_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", "with_part", "=", "False", "\n", ")", "\n", "\n", "\n", "trainset_saliency", "=", "SaliencyDataset", "(", "\n", "[", "cfg", ".", "MSRA10K_PATH", ",", "cfg", ".", "DUT_TR_PATH", ",", "cfg", ".", "DUT_TE_PATH", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_hflicker", "=", "HFlickerDataset", "(", "\n", "cfg", ".", "HFLICKER_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_thin", "=", "ThinObjectDataset", "(", "\n", "cfg", ".", "THINOBJECT_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset", "=", "ProportionalComposeDataset", "(", "\n", "[", "trainset_cclvs", ",", "trainset_saliency", ",", "trainset_thin", ",", "trainset_ytbvos", ",", "trainset_hflicker", ",", "trainset_ade20k", "]", ",", "\n", "[", "0.35", ",", "0.10", ",", "0.1", ",", "0.2", ",", "0.1", ",", "0.15", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", ")", "\n", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-2", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_comb_noiter.main": [[8, 11], ["pplcnet_x1_comb_noiter.init_model", "pplcnet_x1_comb_noiter.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_comb_noiter.init_model": [[13, 25], ["edict", "BaselineModel", "BaselineModel.to", "BaselineModel.apply", "BaselineModel.feature_extractor.load_pretrained_weights", "BaselineModel.load_state_dict", "initializer.XavierGluon", "torch.load"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "384", ",", "384", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "BaselineModel", "(", "backbone", "=", "'PPLCNet'", ",", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "PPLCNET_X1", ")", "\n", "weight", "=", "torch", ".", "load", "(", "'/home/admin/workspace/project/codebase/ISeg/OpenSource/Open.v9/weights/baseline/pplnet/comb/last_checkpoint.pth'", ",", "map_location", "=", "'cpu'", ")", "[", "'state_dict'", "]", "\n", "model", ".", "load_state_dict", "(", "weight", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.pplcnet_x1_comb_noiter.train": [[27, 155], ["edict", "NormalizedFocalLossSigmoid", "ClickLoss", "NormalizedFocalLossSigmoid", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "YouTubeDataset", "ADE20kDataset", "SaliencyDataset", "HFlickerDataset", "ThinObjectDataset", "isegm.data.compose.ProportionalComposeDataset", "CocoLvisDataset", "partial", "isegm.engine.baseline_trainer.ISTrainer", "isegm.engine.baseline_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "click_loss", "=", "ClickLoss", "(", ")", "\n", "loss_cfg", ".", "click_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.5", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "1", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.90", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "False", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.1", "\n", ")", "\n", "\n", "trainset_ytbvos", "=", "YouTubeDataset", "(", "\n", "cfg", ".", "YTBVOS_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "\n", "trainset_ade20k", "=", "ADE20kDataset", "(", "\n", "cfg", ".", "ADE20K_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", "with_part", "=", "False", "\n", ")", "\n", "\n", "\n", "trainset_saliency", "=", "SaliencyDataset", "(", "\n", "[", "cfg", ".", "MSRA10K_PATH", ",", "cfg", ".", "DUT_TR_PATH", ",", "cfg", ".", "DUT_TE_PATH", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_hflicker", "=", "HFlickerDataset", "(", "\n", "cfg", ".", "HFLICKER_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_thin", "=", "ThinObjectDataset", "(", "\n", "cfg", ".", "THINOBJECT_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset", "=", "ProportionalComposeDataset", "(", "\n", "[", "trainset_cclvs", ",", "trainset_saliency", ",", "trainset_thin", ",", "trainset_ytbvos", ",", "trainset_hflicker", ",", "trainset_ade20k", "]", ",", "\n", "[", "0.35", ",", "0.10", ",", "0.1", ",", "0.2", ",", "0.1", ",", "0.15", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", ")", "\n", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-2", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "0", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.mobilenetv2_x1_cclvs.main": [[8, 11], ["mobilenetv2_x1_cclvs.init_model", "mobilenetv2_x1_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.mobilenetv2_x1_cclvs.init_model": [[13, 23], ["edict", "BaselineModel", "BaselineModel.to", "BaselineModel.apply", "BaselineModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "384", ",", "384", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "BaselineModel", "(", "backbone", "=", "'MobleNetV2'", ",", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "MOBILENETV2", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.strongbaseline.mobilenetv2_x1_cclvs.train": [[25, 90], ["edict", "NormalizedFocalLossSigmoid", "NormalizedFocalLossSigmoid", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.baseline_trainer.ISTrainer", "isegm.engine.baseline_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.70", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.2", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet32_S2_comb.main": [[8, 11], ["hrnet32_S2_comb.init_model", "hrnet32_S2_comb.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet32_S2_comb.init_model": [[13, 26], ["edict", "HRNetModel", "HRNetModel.to", "HRNetModel.apply", "HRNetModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "HRNetModel", "(", "pipeline_version", "=", "'s2'", ",", "width", "=", "32", ",", "ocr_width", "=", "128", ",", "small", "=", "False", ",", "with_aux_output", "=", "True", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "\n", "with_prev_mask", "=", "True", ")", "\n", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "HRNETV2_W32", ")", "\n", "#model.load_pretrained_weights('/home/admin/workspace/project/data/weights/ritm/coco_lvis_h18s_itermask.pth')", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet32_S2_comb.train": [[28, 160], ["edict", "NormalizedFocalLossSigmoid", "SigmoidBinaryCrossEntropyLoss", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "YouTubeDataset", "ADE20kDataset", "SaliencyDataset", "HFlickerDataset", "ThinObjectDataset", "isegm.data.compose.ProportionalComposeDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "SigmoidBinaryCrossEntropyLoss", "(", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.5", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "1", ",", "\n", "color_augmentator", "=", "color_augmentator", ")", "\n", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.1", "\n", ")", "\n", "\n", "trainset_ytbvos", "=", "YouTubeDataset", "(", "\n", "cfg", ".", "YTBVOS_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "\n", "trainset_ade20k", "=", "ADE20kDataset", "(", "\n", "cfg", ".", "ADE20K_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", "with_part", "=", "False", "\n", ")", "\n", "\n", "\n", "trainset_saliency", "=", "SaliencyDataset", "(", "\n", "[", "cfg", ".", "MSRA10K_PATH", ",", "cfg", ".", "DUT_TR_PATH", ",", "cfg", ".", "DUT_TE_PATH", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_hflicker", "=", "HFlickerDataset", "(", "\n", "cfg", ".", "HFLICKER_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_thin", "=", "ThinObjectDataset", "(", "\n", "cfg", ".", "THINOBJECT_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_comb", "=", "ProportionalComposeDataset", "(", "\n", "[", "trainset_cclvs", ",", "trainset_saliency", ",", "trainset_thin", ",", "trainset_ytbvos", ",", "trainset_hflicker", ",", "trainset_ade20k", "]", ",", "\n", "[", "0.35", ",", "0.10", ",", "0.1", ",", "0.2", ",", "0.1", ",", "0.15", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_comb", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S1_cclvs.main": [[10, 13], ["segformerB0_S1_cclvs.init_model", "segformerB0_S1_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S1_cclvs.init_model": [[15, 26], ["edict", "SegFormerModel", "SegFormerModel.to", "SegFormerModel.feature_extractor.load_pretrained_weights"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "\n", "model", "=", "SegFormerModel", "(", "pipeline_version", "=", "'s1'", ",", "model_version", "=", "'b0'", ",", "\n", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "SEGFORMER_B0", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S1_cclvs.train": [[27, 119], ["edict", "NormalizedFocalLossSigmoid", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "28", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "None", "\n", ")", "\n", "\n", "\n", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.2", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "#5e-3", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_comb.main": [[10, 13], ["segformerB0_S2_comb.init_model", "segformerB0_S2_comb.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_comb.init_model": [[15, 26], ["edict", "SegFormerModel", "SegFormerModel.to", "SegFormerModel.feature_extractor.load_pretrained_weights"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "\n", "model", "=", "SegFormerModel", "(", "pipeline_version", "=", "'s2'", ",", "model_version", "=", "'b0'", ",", "\n", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "SEGFORMER_B0", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_comb.train": [[27, 174], ["edict", "NormalizedFocalLossSigmoid", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "YouTubeDataset", "ADE20kDataset", "SaliencyDataset", "HFlickerDataset", "ThinObjectDataset", "isegm.data.compose.ProportionalComposeDataset", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "28", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.5", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "1", ")", "\n", "\n", "\n", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.1", "\n", ")", "\n", "\n", "trainset_ytbvos", "=", "YouTubeDataset", "(", "\n", "cfg", ".", "YTBVOS_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "\n", "trainset_ade20k", "=", "ADE20kDataset", "(", "\n", "cfg", ".", "ADE20K_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", "with_part", "=", "False", "\n", ")", "\n", "\n", "\n", "trainset_saliency", "=", "SaliencyDataset", "(", "\n", "[", "cfg", ".", "MSRA10K_PATH", ",", "cfg", ".", "DUT_TR_PATH", ",", "cfg", ".", "DUT_TE_PATH", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_hflicker", "=", "HFlickerDataset", "(", "\n", "cfg", ".", "HFLICKER_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_thin", "=", "ThinObjectDataset", "(", "\n", "cfg", ".", "THINOBJECT_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_comb", "=", "ProportionalComposeDataset", "(", "\n", "[", "trainset_cclvs", ",", "trainset_saliency", ",", "trainset_thin", ",", "trainset_ytbvos", ",", "trainset_hflicker", ",", "trainset_ade20k", "]", ",", "\n", "[", "0.35", ",", "0.10", ",", "0.1", ",", "0.2", ",", "0.1", ",", "0.15", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_comb", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S1_cclvs.main": [[8, 11], ["hrnet18s_S1_cclvs.init_model", "hrnet18s_S1_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S1_cclvs.init_model": [[13, 26], ["edict", "HRNetModel", "HRNetModel.to", "HRNetModel.apply", "HRNetModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "HRNetModel", "(", "pipeline_version", "=", "'s1'", ",", "width", "=", "18", ",", "ocr_width", "=", "48", ",", "small", "=", "True", ",", "with_aux_output", "=", "True", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "\n", "with_prev_mask", "=", "True", ")", "\n", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "HRNETV2_W18_SMALL", ")", "\n", "#model.load_pretrained_weights('/home/admin/workspace/project/data/weights/ritm/coco_lvis_h18s_itermask.pth')", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S1_cclvs.train": [[28, 96], ["edict", "NormalizedFocalLossSigmoid", "SigmoidBinaryCrossEntropyLoss", "WFNL", "torch.BCEWithLogitsLoss", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "SigmoidBinaryCrossEntropyLoss", "(", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.20", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "#2e-4", "\n", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet32_S2_cclvs.main": [[8, 11], ["hrnet32_S2_cclvs.init_model", "hrnet32_S2_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet32_S2_cclvs.init_model": [[13, 26], ["edict", "HRNetModel", "HRNetModel.to", "HRNetModel.apply", "HRNetModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "HRNetModel", "(", "pipeline_version", "=", "'s2'", ",", "width", "=", "32", ",", "ocr_width", "=", "128", ",", "small", "=", "False", ",", "with_aux_output", "=", "True", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "\n", "with_prev_mask", "=", "True", ")", "\n", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "HRNETV2_W32", ")", "\n", "#model.load_pretrained_weights('/home/admin/workspace/project/data/weights/ritm/coco_lvis_h18s_itermask.pth')", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet32_S2_cclvs.train": [[28, 101], ["edict", "NormalizedFocalLossSigmoid", "SigmoidBinaryCrossEntropyLoss", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "SigmoidBinaryCrossEntropyLoss", "(", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "color_augmentator", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.20", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB3_S2_comb.main": [[10, 13], ["segformerB3_S2_comb.init_model", "segformerB3_S2_comb.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB3_S2_comb.init_model": [[15, 26], ["edict", "SegFormerModel", "SegFormerModel.to", "SegFormerModel.feature_extractor.load_pretrained_weights"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "\n", "model", "=", "SegFormerModel", "(", "pipeline_version", "=", "'s2'", ",", "model_version", "=", "'b3'", ",", "\n", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "SEGFORMER_B3", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB3_S2_comb.train": [[27, 174], ["edict", "NormalizedFocalLossSigmoid", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "YouTubeDataset", "ADE20kDataset", "SaliencyDataset", "HFlickerDataset", "ThinObjectDataset", "isegm.data.compose.ProportionalComposeDataset", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "28", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.5", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "1", ",", "color_augmentator", "=", "color_augmentator", ")", "\n", "\n", "\n", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.1", "\n", ")", "\n", "\n", "trainset_ytbvos", "=", "YouTubeDataset", "(", "\n", "cfg", ".", "YTBVOS_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "\n", "trainset_ade20k", "=", "ADE20kDataset", "(", "\n", "cfg", ".", "ADE20K_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", "with_part", "=", "False", "\n", ")", "\n", "\n", "\n", "trainset_saliency", "=", "SaliencyDataset", "(", "\n", "[", "cfg", ".", "MSRA10K_PATH", ",", "cfg", ".", "DUT_TR_PATH", ",", "cfg", ".", "DUT_TE_PATH", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_hflicker", "=", "HFlickerDataset", "(", "\n", "cfg", ".", "HFLICKER_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_thin", "=", "ThinObjectDataset", "(", "\n", "cfg", ".", "THINOBJECT_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_comb", "=", "ProportionalComposeDataset", "(", "\n", "[", "trainset_cclvs", ",", "trainset_saliency", ",", "trainset_thin", ",", "trainset_ytbvos", ",", "trainset_hflicker", ",", "trainset_ade20k", "]", ",", "\n", "[", "0.35", ",", "0.10", ",", "0.1", ",", "0.2", ",", "0.1", ",", "0.15", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_comb", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_cclvs.main": [[10, 13], ["segformerB0_S2_cclvs.init_model", "segformerB0_S2_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_cclvs.init_model": [[15, 26], ["edict", "SegFormerModel", "SegFormerModel.to", "SegFormerModel.feature_extractor.load_pretrained_weights"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "\n", "model", "=", "SegFormerModel", "(", "pipeline_version", "=", "'s2'", ",", "model_version", "=", "'b0'", ",", "\n", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "SEGFORMER_B0", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_cclvs.train": [[27, 119], ["edict", "NormalizedFocalLossSigmoid", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "28", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "None", "\n", ")", "\n", "\n", "\n", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.2", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB3_S2_cclvs.main": [[10, 13], ["segformerB3_S2_cclvs.init_model", "segformerB3_S2_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB3_S2_cclvs.init_model": [[15, 26], ["edict", "SegFormerModel", "SegFormerModel.to", "SegFormerModel.feature_extractor.load_pretrained_weights"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "\n", "model", "=", "SegFormerModel", "(", "pipeline_version", "=", "'s2'", ",", "model_version", "=", "'b3'", ",", "\n", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "SEGFORMER_B3", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB3_S2_cclvs.train": [[27, 116], ["edict", "NormalizedFocalLossSigmoid", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "28", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "color_augmentator", "\n", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.2", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_cclvs.main": [[8, 11], ["hrnet18s_S2_cclvs.init_model", "hrnet18s_S2_cclvs.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_cclvs.init_model": [[13, 26], ["edict", "HRNetModel", "HRNetModel.to", "HRNetModel.apply", "HRNetModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "HRNetModel", "(", "pipeline_version", "=", "'s2'", ",", "width", "=", "18", ",", "ocr_width", "=", "48", ",", "small", "=", "True", ",", "with_aux_output", "=", "True", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "\n", "with_prev_mask", "=", "True", ")", "\n", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "HRNETV2_W18_SMALL", ")", "\n", "#model.load_pretrained_weights('/home/admin/workspace/project/data/weights/ritm/coco_lvis_h18s_itermask.pth')", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_cclvs.train": [[28, 94], ["edict", "NormalizedFocalLossSigmoid", "SigmoidBinaryCrossEntropyLoss", "WFNL", "torch.BCEWithLogitsLoss", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "SigmoidBinaryCrossEntropyLoss", "(", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.20", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_sbd.main": [[10, 13], ["segformerB0_S2_sbd.init_model", "segformerB0_S2_sbd.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_sbd.init_model": [[15, 26], ["edict", "SegFormerModel", "SegFormerModel.to", "SegFormerModel.feature_extractor.load_pretrained_weights"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "\n", "model", "=", "SegFormerModel", "(", "pipeline_version", "=", "'s2'", ",", "model_version", "=", "'b0'", ",", "\n", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "SEGFORMER_B0", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S2_sbd.train": [[27, 110], ["edict", "NormalizedFocalLossSigmoid", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "SBDDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "28", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "color_augmentator", "\n", ")", "\n", "\n", "\n", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset", "=", "SBDDataset", "(", "\n", "cfg", ".", "SBD_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "80", ",", "\n", "keep_background_prob", "=", "0.0", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "samples_scores_path", "=", "'./assets/sbd_samples_weights.pkl'", ",", "\n", "samples_scores_gamma", "=", "1.25", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_sbd.main": [[8, 11], ["hrnet18s_S2_sbd.init_model", "hrnet18s_S2_sbd.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_sbd.init_model": [[13, 26], ["edict", "HRNetModel", "HRNetModel.to", "HRNetModel.apply", "HRNetModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "HRNetModel", "(", "pipeline_version", "=", "'s2'", ",", "width", "=", "18", ",", "ocr_width", "=", "48", ",", "small", "=", "True", ",", "with_aux_output", "=", "True", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "\n", "with_prev_mask", "=", "True", ")", "\n", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "HRNETV2_W18_SMALL", ")", "\n", "#model.load_pretrained_weights('/home/admin/workspace/project/data/weights/ritm/coco_lvis_h18s_itermask.pth')", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_sbd.train": [[28, 102], ["edict", "NormalizedFocalLossSigmoid", "SigmoidBinaryCrossEntropyLoss", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "SBDDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "RandomBrightnessContrast", "RGBShift", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "SigmoidBinaryCrossEntropyLoss", "(", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "color_augmentator", "=", "Compose", "(", "[", "\n", "RandomBrightnessContrast", "(", "brightness_limit", "=", "(", "-", "0.25", ",", "0.25", ")", ",", "contrast_limit", "=", "(", "-", "0.15", ",", "0.4", ")", ",", "p", "=", "0.75", ")", ",", "\n", "RGBShift", "(", "r_shift_limit", "=", "10", ",", "g_shift_limit", "=", "10", ",", "b_shift_limit", "=", "10", ",", "p", "=", "0.75", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.3", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "\n", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "0.8", ",", "gs_sd", "=", "0.4", ",", "\n", "color_augmentator", "=", "color_augmentator", "\n", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset", "=", "SBDDataset", "(", "\n", "cfg", ".", "SBD_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "80", ",", "\n", "keep_background_prob", "=", "0.0", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "samples_scores_path", "=", "'./assets/sbd_samples_weights.pkl'", ",", "\n", "samples_scores_gamma", "=", "1.25", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S1_cclvs_oldaug.main": [[10, 13], ["segformerB0_S1_cclvs_oldaug.init_model", "segformerB0_S1_cclvs_oldaug.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S1_cclvs_oldaug.init_model": [[15, 26], ["edict", "SegFormerModel", "SegFormerModel.to", "SegFormerModel.feature_extractor.load_pretrained_weights"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "\n", "model", "=", "SegFormerModel", "(", "pipeline_version", "=", "'s1'", ",", "model_version", "=", "'b0'", ",", "\n", "use_leaky_relu", "=", "True", ",", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "binary_prev_mask", "=", "False", ",", "\n", "with_prev_mask", "=", "True", ",", "with_aux_output", "=", "True", ")", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "SEGFORMER_B0", ")", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.segformerB0_S1_cclvs_oldaug.train": [[27, 122], ["edict", "NormalizedFocalLossSigmoid", "WFNL", "torch.BCEWithLogitsLoss", "Compose", "Compose", "MultiPointSampler", "CocoLvisDataset", "CocoLvisDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "Flip", "RandomResizedCrop", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "28", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "\n", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ",", "w", "=", "0.5", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "\n", "train_augmentator", "=", "Compose", "(", "[", "\n", "\n", "Flip", "(", ")", ",", "\n", "#RandomRotate90(),", "\n", "#ShiftScaleRotate(shift_limit=0.03, scale_limit=0,", "\n", "#                 rotate_limit=(-3, 3), border_mode=0, p=0.75),", "\n", "\n", "RandomResizedCrop", "(", "crop_size", "[", "0", "]", ",", "crop_size", "[", "1", "]", ",", "scale", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "#RandomCrop(*crop_size),", "\n", "#RandomBrightnessContrast(brightness_limit=(-0.25, 0.25), contrast_limit=(-0.15, 0.4), p=0.75),", "\n", "#RGBShift(r_shift_limit=10, g_shift_limit=10, b_shift_limit=10, p=0.75)", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "\n", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.2", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-3", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "#5e-3", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_cclvs", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "5", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.main": [[8, 11], ["hrnet18s_S2_comb.init_model", "hrnet18s_S2_comb.train"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train"], ["def", "main", "(", "cfg", ")", ":", "\n", "    ", "model", ",", "model_cfg", "=", "init_model", "(", "cfg", ")", "\n", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.init_model": [[13, 26], ["edict", "HRNetModel", "HRNetModel.to", "HRNetModel.apply", "HRNetModel.feature_extractor.load_pretrained_weights", "initializer.XavierGluon"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.data.transforms.ZoomIn.apply", "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.mobilenet.segmentator.MobileSeg.load_pretrained_weights"], ["", "def", "init_model", "(", "cfg", ")", ":", "\n", "    ", "model_cfg", "=", "edict", "(", ")", "\n", "model_cfg", ".", "crop_size", "=", "(", "256", ",", "256", ")", "\n", "model_cfg", ".", "num_max_points", "=", "24", "\n", "model", "=", "HRNetModel", "(", "pipeline_version", "=", "'s2'", ",", "width", "=", "18", ",", "ocr_width", "=", "48", ",", "small", "=", "True", ",", "with_aux_output", "=", "True", ",", "use_leaky_relu", "=", "True", ",", "\n", "use_rgb_conv", "=", "False", ",", "use_disks", "=", "True", ",", "norm_radius", "=", "5", ",", "\n", "with_prev_mask", "=", "True", ")", "\n", "\n", "model", ".", "to", "(", "cfg", ".", "device", ")", "\n", "model", ".", "apply", "(", "initializer", ".", "XavierGluon", "(", "rnd_type", "=", "'gaussian'", ",", "magnitude", "=", "2.0", ")", ")", "\n", "model", ".", "feature_extractor", ".", "load_pretrained_weights", "(", "cfg", ".", "IMAGENET_PRETRAINED_MODELS", ".", "HRNETV2_W18_SMALL", ")", "\n", "#model.load_pretrained_weights('/home/admin/workspace/project/data/weights/ritm/coco_lvis_h18s_itermask.pth')", "\n", "return", "model", ",", "model_cfg", "\n", "\n"]], "home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.focalclick.hrnet18s_S2_comb.train": [[28, 152], ["edict", "NormalizedFocalLossSigmoid", "SigmoidBinaryCrossEntropyLoss", "WFNL", "torch.BCEWithLogitsLoss", "isegm.data.aligned_augmentation.AlignedAugmentator", "Compose", "MultiPointSampler", "CocoLvisDataset", "YouTubeDataset", "ADE20kDataset", "SaliencyDataset", "HFlickerDataset", "ThinObjectDataset", "isegm.data.compose.ProportionalComposeDataset", "CocoLvisDataset", "partial", "isegm.engine.focalclick_trainer.ISTrainer", "isegm.engine.focalclick_trainer.ISTrainer.run", "UniformRandomResize", "PadIfNeeded", "RandomCrop", "AdaptiveIoU"], "function", ["home.repos.pwc.inspect_result.XavierCHEN34_ClickSEG.engine.cdnet_trainer.ISTrainer.run"], ["", "def", "train", "(", "model", ",", "cfg", ",", "model_cfg", ")", ":", "\n", "    ", "cfg", ".", "batch_size", "=", "32", "if", "cfg", ".", "batch_size", "<", "1", "else", "cfg", ".", "batch_size", "\n", "cfg", ".", "val_batch_size", "=", "cfg", ".", "batch_size", "\n", "crop_size", "=", "model_cfg", ".", "crop_size", "\n", "\n", "loss_cfg", "=", "edict", "(", ")", "\n", "loss_cfg", ".", "instance_loss", "=", "NormalizedFocalLossSigmoid", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "instance_aux_loss", "=", "SigmoidBinaryCrossEntropyLoss", "(", ")", "\n", "loss_cfg", ".", "instance_aux_loss_weight", "=", "0.4", "\n", "loss_cfg", ".", "instance_refine_loss", "=", "WFNL", "(", "alpha", "=", "0.5", ",", "gamma", "=", "2", ")", "\n", "loss_cfg", ".", "instance_refine_loss_weight", "=", "1.0", "\n", "loss_cfg", ".", "trimap_loss", "=", "nn", ".", "BCEWithLogitsLoss", "(", ")", "#NormalizedFocalLossSigmoid(alpha=0.5, gamma=2)", "\n", "loss_cfg", ".", "trimap_loss_weight", "=", "1.0", "\n", "\n", "train_augmentator", "=", "AlignedAugmentator", "(", "ratio", "=", "[", "0.5", ",", "1.3", "]", ",", "target_size", "=", "crop_size", ",", "flip", "=", "True", ",", "distribution", "=", "'Gaussian'", ",", "gs_center", "=", "1", ")", "\n", "\n", "val_augmentator", "=", "Compose", "(", "[", "\n", "UniformRandomResize", "(", "scale_range", "=", "(", "0.75", ",", "1.25", ")", ")", ",", "\n", "PadIfNeeded", "(", "min_height", "=", "crop_size", "[", "0", "]", ",", "min_width", "=", "crop_size", "[", "1", "]", ",", "border_mode", "=", "0", ")", ",", "\n", "RandomCrop", "(", "*", "crop_size", ")", "\n", "]", ",", "p", "=", "1.0", ")", "\n", "\n", "points_sampler", "=", "MultiPointSampler", "(", "model_cfg", ".", "num_max_points", ",", "prob_gamma", "=", "0.80", ",", "\n", "merge_objects_prob", "=", "0.15", ",", "\n", "max_num_merged_objects", "=", "2", ",", "\n", "use_hierarchy", "=", "False", ",", "\n", "first_click_center", "=", "True", ")", "\n", "\n", "trainset_cclvs", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'train'", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", "stuff_prob", "=", "0.1", "\n", ")", "\n", "\n", "trainset_ytbvos", "=", "YouTubeDataset", "(", "\n", "cfg", ".", "YTBVOS_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "\n", "trainset_ade20k", "=", "ADE20kDataset", "(", "\n", "cfg", ".", "ADE20K_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", "with_part", "=", "False", "\n", ")", "\n", "\n", "\n", "trainset_saliency", "=", "SaliencyDataset", "(", "\n", "[", "cfg", ".", "MSRA10K_PATH", ",", "cfg", ".", "DUT_TR_PATH", ",", "cfg", ".", "DUT_TE_PATH", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_hflicker", "=", "HFlickerDataset", "(", "\n", "cfg", ".", "HFLICKER_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_thin", "=", "ThinObjectDataset", "(", "\n", "cfg", ".", "THINOBJECT_PATH", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "-", "1", ",", "\n", ")", "\n", "\n", "trainset_comb", "=", "ProportionalComposeDataset", "(", "\n", "[", "trainset_cclvs", ",", "trainset_saliency", ",", "trainset_thin", ",", "trainset_ytbvos", ",", "trainset_hflicker", ",", "trainset_ade20k", "]", ",", "\n", "[", "0.35", ",", "0.10", ",", "0.1", ",", "0.2", ",", "0.1", ",", "0.15", "]", ",", "\n", "augmentator", "=", "train_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "keep_background_prob", "=", "0.05", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "30000", ",", "\n", ")", "\n", "\n", "valset", "=", "CocoLvisDataset", "(", "\n", "cfg", ".", "LVIS_v1_PATH", ",", "\n", "split", "=", "'val'", ",", "\n", "augmentator", "=", "val_augmentator", ",", "\n", "min_object_area", "=", "1000", ",", "\n", "points_sampler", "=", "points_sampler", ",", "\n", "epoch_len", "=", "2000", "\n", ")", "\n", "\n", "optimizer_params", "=", "{", "\n", "'lr'", ":", "5e-4", ",", "'betas'", ":", "(", "0.9", ",", "0.999", ")", ",", "'eps'", ":", "1e-8", "\n", "}", "\n", "\n", "lr_scheduler", "=", "partial", "(", "torch", ".", "optim", ".", "lr_scheduler", ".", "MultiStepLR", ",", "\n", "milestones", "=", "[", "190", ",", "210", "]", ",", "gamma", "=", "0.1", ")", "\n", "trainer", "=", "ISTrainer", "(", "model", ",", "cfg", ",", "model_cfg", ",", "loss_cfg", ",", "\n", "trainset_comb", ",", "valset", ",", "\n", "optimizer", "=", "'adam'", ",", "\n", "optimizer_params", "=", "optimizer_params", ",", "\n", "lr_scheduler", "=", "lr_scheduler", ",", "\n", "checkpoint_interval", "=", "[", "(", "0", ",", "50", ")", ",", "(", "200", ",", "10", ")", "]", ",", "\n", "image_dump_interval", "=", "500", ",", "\n", "metrics", "=", "[", "AdaptiveIoU", "(", ")", "]", ",", "\n", "max_interactive_points", "=", "model_cfg", ".", "num_max_points", ",", "\n", "max_num_next_clicks", "=", "3", ")", "\n", "trainer", ".", "run", "(", "num_epochs", "=", "230", ")", "\n", "", ""]]}