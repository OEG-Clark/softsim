{"home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.transforms.VideoFolderPathToTensor.__init__": [[9, 11], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "max_len", "=", "None", ")", ":", "\n", "        ", "self", ".", "max_len", "=", "max_len", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.transforms.VideoFolderPathToTensor.__call__": [[12, 51], ["sorted", "cv2.imread", "len", "torchvision.transforms.Compose", "torch.FloatTensor", "range", "torch.FloatTensor.permute", "os.path.join", "cv2.imread", "cv2.cvtColor", "torch.from_numpy", "torchvision.transforms.Compose.permute", "torchvision.transforms.Compose.", "torchvision.transforms.Compose.float", "os.path.join", "torchvision.transforms.ToPILImage", "torchvision.transforms.ToTensor", "torchvision.transforms.Normalize", "torchvision.transforms.Resize", "os.listdir", "os.path.isfile", "os.path.join"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "path", ")", ":", "\n", "\n", "        ", "file_names", "=", "sorted", "(", "[", "os", ".", "path", ".", "join", "(", "path", ",", "f", ")", "for", "f", "in", "os", ".", "listdir", "(", "path", ")", "if", "os", ".", "path", ".", "isfile", "(", "os", ".", "path", ".", "join", "(", "path", ",", "f", ")", ")", "]", ")", "\n", "frames_path", "=", "[", "os", ".", "path", ".", "join", "(", "path", ",", "f", ")", "for", "f", "in", "file_names", "]", "\n", "\n", "frame", "=", "cv2", ".", "imread", "(", "frames_path", "[", "0", "]", ")", "\n", "height", ",", "width", ",", "channels", "=", "frame", ".", "shape", "\n", "num_frames", "=", "len", "(", "frames_path", ")", "\n", "\n", "transform", "=", "torchvision", ".", "transforms", ".", "Compose", "(", "[", "\n", "torchvision", ".", "transforms", ".", "ToPILImage", "(", ")", ",", "\n", "torchvision", ".", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "torchvision", ".", "transforms", ".", "Normalize", "(", "[", "0.485", ",", "0.456", ",", "0.406", "]", ",", "[", "0.229", ",", "0.224", ",", "0.225", "]", ")", ",", "\n", "torchvision", ".", "transforms", ".", "Resize", "(", "[", "224", ",", "224", "]", ")", "\n", "]", ")", "\n", "\n", "# EXTRACT_FREQUENCY = 18", "\n", "EXTRACT_FREQUENCY", "=", "1", "\n", "\n", "# num_time_steps = int(num_frames / EXTRACT_FREQUENCY)", "\n", "\n", "num_time_steps", "=", "16", "\n", "# num_time_steps = 4", "\n", "\n", "# (3 x T x H x W), https://pytorch.org/docs/stable/torchvision/models.html", "\n", "frames", "=", "torch", ".", "FloatTensor", "(", "channels", ",", "num_time_steps", ",", "224", ",", "224", ")", "\n", "\n", "for", "index", "in", "range", "(", "0", ",", "num_time_steps", ")", ":", "\n", "            ", "frame", "=", "cv2", ".", "imread", "(", "frames_path", "[", "index", "*", "EXTRACT_FREQUENCY", "]", ")", "\n", "frame", "=", "cv2", ".", "cvtColor", "(", "frame", ",", "cv2", ".", "COLOR_BGR2RGB", ")", "\n", "frame", "=", "torch", ".", "from_numpy", "(", "frame", ")", "\n", "frame", "=", "frame", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "# (H x W x C) to (C x H x W)", "\n", "frame", "=", "frame", "/", "255", "\n", "if", "frame", ".", "shape", "[", "2", "]", "!=", "224", ":", "\n", "                ", "frame", "=", "frame", "[", ":", ",", ":", ",", "80", ":", "560", "]", "\n", "", "frame", "=", "transform", "(", "frame", ")", "\n", "frames", "[", ":", ",", "index", ",", ":", ",", ":", "]", "=", "frame", ".", "float", "(", ")", "\n", "\n", "", "return", "frames", ".", "permute", "(", "1", ",", "0", ",", "2", ",", "3", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.Chomp1d.__init__": [[6, 9], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "chomp_size", ")", ":", "\n", "        ", "super", "(", "Chomp1d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "chomp_size", "=", "chomp_size", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.Chomp1d.forward": [[10, 12], ["x[].contiguous"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "[", ":", ",", ":", ",", ":", "-", "self", ".", "chomp_size", "]", ".", "contiguous", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.TemporalBlock.__init__": [[15, 34], ["torch.Module.__init__", "torch.nn.utils.weight_norm", "TCN.Chomp1d", "torch.ReLU", "torch.Dropout", "torch.nn.utils.weight_norm", "TCN.Chomp1d", "torch.ReLU", "torch.Dropout", "torch.Sequential", "torch.ReLU", "TCN.TemporalBlock.init_weights", "torch.Conv1d", "torch.Conv1d", "torch.Conv1d"], "methods", ["home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__init__", "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.TemporalBlock.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "n_inputs", ",", "n_outputs", ",", "kernel_size", ",", "stride", ",", "dilation", ",", "padding", ",", "dropout", "=", "0.2", ")", ":", "\n", "        ", "super", "(", "TemporalBlock", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv1", "=", "weight_norm", "(", "nn", ".", "Conv1d", "(", "n_inputs", ",", "n_outputs", ",", "kernel_size", ",", "\n", "stride", "=", "stride", ",", "padding", "=", "padding", ",", "dilation", "=", "dilation", ")", ")", "\n", "self", ".", "chomp1", "=", "Chomp1d", "(", "padding", ")", "\n", "self", ".", "relu1", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "dropout1", "=", "nn", ".", "Dropout", "(", "dropout", ")", "\n", "\n", "self", ".", "conv2", "=", "weight_norm", "(", "nn", ".", "Conv1d", "(", "n_outputs", ",", "n_outputs", ",", "kernel_size", ",", "\n", "stride", "=", "stride", ",", "padding", "=", "padding", ",", "dilation", "=", "dilation", ")", ")", "\n", "self", ".", "chomp2", "=", "Chomp1d", "(", "padding", ")", "\n", "self", ".", "relu2", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "dropout2", "=", "nn", ".", "Dropout", "(", "dropout", ")", "\n", "\n", "self", ".", "net", "=", "nn", ".", "Sequential", "(", "self", ".", "conv1", ",", "self", ".", "chomp1", ",", "self", ".", "relu1", ",", "self", ".", "dropout1", ",", "\n", "self", ".", "conv2", ",", "self", ".", "chomp2", ",", "self", ".", "relu2", ",", "self", ".", "dropout2", ")", "\n", "self", ".", "downsample", "=", "nn", ".", "Conv1d", "(", "n_inputs", ",", "n_outputs", ",", "1", ")", "if", "n_inputs", "!=", "n_outputs", "else", "None", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", ")", "\n", "self", ".", "init_weights", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.TemporalBlock.init_weights": [[35, 40], ["TCN.TemporalBlock.conv1.weight.data.normal_", "TCN.TemporalBlock.conv2.weight.data.normal_", "TCN.TemporalBlock.downsample.weight.data.normal_"], "methods", ["None"], ["", "def", "init_weights", "(", "self", ")", ":", "\n", "        ", "self", ".", "conv1", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "0.01", ")", "\n", "self", ".", "conv2", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "0.01", ")", "\n", "if", "self", ".", "downsample", "is", "not", "None", ":", "\n", "            ", "self", ".", "downsample", ".", "weight", ".", "data", ".", "normal_", "(", "0", ",", "0.01", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.TemporalBlock.forward": [[41, 45], ["TCN.TemporalBlock.net", "TCN.TemporalBlock.relu", "TCN.TemporalBlock.downsample"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "out", "=", "self", ".", "net", "(", "x", ")", "\n", "res", "=", "x", "if", "self", ".", "downsample", "is", "None", "else", "self", ".", "downsample", "(", "x", ")", "\n", "return", "self", ".", "relu", "(", "out", "+", "res", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.TemporalConvNet.__init__": [[48, 60], ["torch.Module.__init__", "len", "range", "torch.Sequential", "TCN.TemporalBlock"], "methods", ["home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "num_inputs", ",", "num_channels", ",", "kernel_size", "=", "2", ",", "dropout", "=", "0.2", ")", ":", "\n", "        ", "super", "(", "TemporalConvNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "layers", "=", "[", "]", "\n", "num_levels", "=", "len", "(", "num_channels", ")", "\n", "for", "i", "in", "range", "(", "num_levels", ")", ":", "\n", "            ", "dilation_size", "=", "2", "**", "i", "\n", "in_channels", "=", "num_inputs", "if", "i", "==", "0", "else", "num_channels", "[", "i", "-", "1", "]", "\n", "out_channels", "=", "num_channels", "[", "i", "]", "\n", "layers", "+=", "[", "TemporalBlock", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "dilation_size", ",", "\n", "padding", "=", "(", "kernel_size", "-", "1", ")", "*", "dilation_size", ",", "dropout", "=", "dropout", ")", "]", "\n", "\n", "", "self", ".", "network", "=", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.TCN.TemporalConvNet.forward": [[61, 63], ["TCN.TemporalConvNet.network"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "network", "(", "x", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.ResTCN.Identity.__init__": [[9, 11], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Identity", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.ResTCN.Identity.forward": [[12, 14], ["None"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.ResTCN.ResTCN.__init__": [[17, 42], ["torch.Module.__init__", "TCN.TemporalConvNet", "torch.Linear", "torch.Linear", "torchvision.models.resnet18", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "ResTCN", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "spatial_feat_dim", "=", "32", "\n", "self", ".", "num_classes", "=", "4", "\n", "self", ".", "nhid", "=", "128", "\n", "self", ".", "levels", "=", "8", "\n", "self", ".", "kernel_size", "=", "7", "\n", "self", ".", "dropout", "=", ".1", "\n", "self", ".", "channel_sizes", "=", "[", "self", ".", "nhid", "]", "*", "self", ".", "levels", "\n", "\n", "self", ".", "tcn", "=", "TemporalConvNet", "(", "\n", "self", ".", "spatial_feat_dim", ",", "\n", "self", ".", "channel_sizes", ",", "\n", "kernel_size", "=", "self", ".", "kernel_size", ",", "\n", "dropout", "=", "self", ".", "dropout", ")", "\n", "self", ".", "linear", "=", "nn", ".", "Linear", "(", "self", ".", "channel_sizes", "[", "-", "1", "]", ",", "self", ".", "num_classes", ")", "\n", "\n", "self", ".", "model_conv", "=", "torchvision", ".", "models", ".", "resnet18", "(", "pretrained", "=", "True", ")", "\n", "# for param in self.model_conv.parameters():", "\n", "#     param.requires_grad = False", "\n", "\n", "num_ftrs", "=", "self", ".", "model_conv", ".", "fc", ".", "in_features", "\n", "# self.model_conv.fc = nn.Linear(num_ftrs, 4)", "\n", "self", ".", "model_conv", ".", "fc", "=", "nn", ".", "Linear", "(", "num_ftrs", ",", "self", ".", "spatial_feat_dim", ")", "\n", "# self.model_conv.fc = Identity()", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.ResTCN.ResTCN.forward": [[47, 66], ["torch.zeros().cuda", "torch.zeros().cuda", "torch.zeros().cuda", "torch.zeros().cuda", "range", "z.transpose.transpose.transpose", "ResTCN.ResTCN.tcn", "ResTCN.ResTCN.linear", "data.size", "ResTCN.ResTCN.model_conv", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "data", ")", ":", "\n", "# t = 0", "\n", "# x = data[:, t, :, :, :]", "\n", "# output = self.model_conv(x)", "\n", "\n", "        ", "z", "=", "torch", ".", "zeros", "(", "[", "data", ".", "shape", "[", "0", "]", ",", "data", ".", "shape", "[", "1", "]", ",", "self", ".", "spatial_feat_dim", "]", ")", ".", "cuda", "(", ")", "\n", "for", "t", "in", "range", "(", "data", ".", "size", "(", "1", ")", ")", ":", "\n", "            ", "x", "=", "self", ".", "model_conv", "(", "data", "[", ":", ",", "t", ",", ":", ",", ":", ",", ":", "]", ")", "\n", "z", "[", ":", ",", "t", ",", ":", "]", "=", "x", "\n", "\n", "# y, _ = self.rnn(z)", "\n", "# output = self.linear(torch.sum(y, dim=1))", "\n", "\n", "", "z", "=", "z", ".", "transpose", "(", "1", ",", "2", ")", "\n", "y", "=", "self", ".", "tcn", "(", "z", ")", "\n", "# output = self.linear(y[:, :, -1])", "\n", "output", "=", "self", ".", "linear", "(", "torch", ".", "sum", "(", "y", ",", "dim", "=", "2", ")", ")", "\n", "\n", "return", "output", "\n", "", "", ""]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.utils.generate_dataloader": [[8, 17], ["datasets.VideoDataset", "torch.utils.data.DataLoader", "torchvision.transforms.Compose", "transforms.VideoFolderPathToTensor"], "function", ["None"], ["def", "generate_dataloader", "(", "batch_size", ",", "csv", ",", "root", ")", ":", "\n", "    ", "dataset", "=", "datasets", ".", "VideoDataset", "(", "csv", ",", "\n", "root", ",", "\n", "transform", "=", "torchvision", ".", "transforms", ".", "Compose", "(", "[", "transforms", ".", "VideoFolderPathToTensor", "(", ")", "]", ")", ")", "\n", "\n", "return", "DataLoader", "(", "dataset", ",", "\n", "batch_size", "=", "batch_size", ",", "\n", "shuffle", "=", "True", ",", "\n", "num_workers", "=", "4", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.utils.get_dataloader": [[19, 23], ["utils.generate_dataloader", "utils.generate_dataloader"], "function", ["home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.utils.generate_dataloader", "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.utils.generate_dataloader"], ["", "def", "get_dataloader", "(", "batch_size", ",", "csv_train", ",", "root_train", ",", "csv_test", ",", "root_test", ")", ":", "\n", "    ", "return", "{", "\n", "'train'", ":", "generate_dataloader", "(", "batch_size", ",", "csv_train", ",", "root_train", ")", ",", "\n", "'test'", ":", "generate_dataloader", "(", "batch_size", ",", "csv_test", ",", "root_test", ")", "}", "\n", "", ""]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__init__": [[8, 13], ["pandas.read_csv"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "csv", ",", "root", ",", "transform", "=", "None", ")", ":", "\n", "\n", "        ", "self", ".", "dataframe", "=", "pd", ".", "read_csv", "(", "csv", ")", "\n", "self", ".", "transform", "=", "transform", "\n", "self", ".", "root", "=", "root", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__len__": [[14, 16], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "dataframe", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.abedicodes_ResNet-TCN.None.datasets.VideoDataset.__getitem__": [[17, 24], ["os.path.join", "datasets.VideoDataset.transform"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "\n", "        ", "label", "=", "self", ".", "dataframe", ".", "iloc", "[", "index", "]", ".", "label", "\n", "video", "=", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "self", ".", "dataframe", ".", "iloc", "[", "index", "]", ".", "path", ")", "\n", "video", "=", "self", ".", "transform", "(", "video", ")", "\n", "\n", "return", "video", ",", "label", "\n", "", "", ""]]}