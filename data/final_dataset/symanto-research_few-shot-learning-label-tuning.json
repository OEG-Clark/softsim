{"home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.cli.evaluate_char_svm": [[23, 49], ["app.command", "run_experiments", "ValueError", "output_dir.joinpath", "CharSvmPredictor"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiments"], ["@", "app", ".", "command", "(", ")", "\n", "def", "evaluate_char_svm", "(", "\n", "output_dir", ":", "Path", ",", "\n", "n_examples", ":", "int", "=", "8", ",", "\n", "n_trials", ":", "int", "=", "5", ",", "\n", "multilingual", ":", "bool", "=", "True", ",", "\n", "n_test_examples", ":", "Optional", "[", "int", "]", "=", "None", ",", "\n", ")", ":", "\n", "    ", "import", "os", "\n", "\n", "os", ".", "environ", "[", "\"TF_CPP_MIN_LOG_LEVEL\"", "]", "=", "\"3\"", "\n", "os", ".", "environ", "[", "\"CUDA_VISIBLE_DEVICES\"", "]", "=", "\"\"", "\n", "\n", "if", "n_examples", "<=", "0", ":", "\n", "        ", "raise", "ValueError", "(", "\"SVM requires n_examples > 0!\"", ")", "\n", "\n", "", "from", "symanto_fsb", ".", "experiments", "import", "run_experiments", "\n", "from", "symanto_fsb", ".", "models", ".", "predictors", ".", "char_svm", "import", "CharSvmPredictor", "\n", "\n", "run_experiments", "(", "\n", "predictor_fn", "=", "lambda", ":", "CharSvmPredictor", "(", ")", ",", "\n", "output_dir", "=", "output_dir", ".", "joinpath", "(", "f\"{n_examples:03}\"", ")", ",", "\n", "n_examples", "=", "n_examples", ",", "\n", "multilingual", "=", "multilingual", ",", "\n", "n_test_examples", "=", "n_test_examples", ",", "\n", "n_trials", "=", "n_trials", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.cli.evaluate_sentence_transformer": [[52, 85], ["app.command", "tf.config.set_visible_devices", "run_experiments", "output_dir.joinpath", "DualEncoderPredictor"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiments"], ["", "@", "app", ".", "command", "(", ")", "\n", "def", "evaluate_sentence_transformer", "(", "\n", "output_dir", ":", "Path", ",", "\n", "model", ":", "str", "=", "\"symanto/sn-xlm-roberta-base-snli-mnli-anli-xnli\"", ",", "\n", "gpu", ":", "str", "=", "\"\"", ",", "\n", "n_examples", ":", "int", "=", "8", ",", "\n", "n_trials", ":", "int", "=", "5", ",", "\n", "multilingual", ":", "bool", "=", "True", ",", "\n", "n_test_examples", ":", "Optional", "[", "int", "]", "=", "None", ",", "\n", ")", ":", "\n", "    ", "import", "os", "\n", "\n", "os", ".", "environ", "[", "\"TF_CPP_MIN_LOG_LEVEL\"", "]", "=", "\"3\"", "\n", "os", ".", "environ", "[", "\"CUDA_VISIBLE_DEVICES\"", "]", "=", "gpu", "\n", "import", "tensorflow", "as", "tf", "\n", "\n", "tf", ".", "config", ".", "set_visible_devices", "(", "[", "]", ",", "\"GPU\"", ")", "\n", "\n", "from", "symanto_fsb", ".", "experiments", "import", "run_experiments", "\n", "from", "symanto_fsb", ".", "models", ".", "predictors", ".", "dual_encoder", "import", "DualEncoderPredictor", "\n", "\n", "run_experiments", "(", "\n", "predictor_fn", "=", "lambda", ":", "DualEncoderPredictor", "(", "\n", "{", "\n", "\"module\"", ":", "\"sentence_transformer\"", ",", "\n", "\"model\"", ":", "model", ",", "\n", "}", "\n", ")", ",", "\n", "output_dir", "=", "output_dir", ".", "joinpath", "(", "f\"{n_examples:03}\"", ")", ",", "\n", "n_examples", "=", "n_examples", ",", "\n", "multilingual", "=", "multilingual", ",", "\n", "n_test_examples", "=", "n_test_examples", ",", "\n", "n_trials", "=", "n_trials", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.cli.report": [[88, 93], ["app.command", "_report"], "function", ["None"], ["", "@", "app", ".", "command", "(", ")", "\n", "def", "report", "(", "output_dir", ":", "Path", ",", "output_file", ":", "Path", ")", ":", "\n", "    ", "from", "symanto_fsb", ".", "experiments", "import", "report", "as", "_report", "\n", "\n", "_report", "(", "output_dir", ",", "output_file", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.macro_f1_score": [[34, 36], ["sklearn.metrics.f1_score"], "function", ["None"], ["def", "macro_f1_score", "(", "x", ",", "y", ")", ":", "\n", "    ", "return", "f1_score", "(", "x", ",", "y", ",", "average", "=", "\"macro\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiments": [[38, 60], ["symanto_fsb.datasets.get_english_datasets", "symanto_fsb.datasets.get_english_datasets.extend", "symanto_fsb.datasets.get_english_datasets.extend", "experiments.run_experiment", "symanto_fsb.datasets.get_german_datasets", "symanto_fsb.datasets.get_spanish_datasets", "output_dir.joinpath", "experiments._get_dataset_dirname"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.get_english_datasets", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiment", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.get_german_datasets", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.get_spanish_datasets", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments._get_dataset_dirname"], ["", "def", "run_experiments", "(", "\n", "predictor_fn", ":", "Callable", "[", "[", "]", ",", "Predictor", "]", ",", "\n", "output_dir", ":", "Path", ",", "\n", "n_examples", ":", "int", "=", "0", ",", "\n", "multilingual", ":", "bool", "=", "True", ",", "\n", "n_trials", ":", "int", "=", "5", ",", "\n", "n_test_examples", ":", "Optional", "[", "int", "]", "=", "None", ",", "\n", ")", ":", "\n", "    ", "datasets", "=", "get_english_datasets", "(", ")", "\n", "if", "multilingual", ":", "\n", "        ", "datasets", ".", "extend", "(", "get_german_datasets", "(", ")", ")", "\n", "datasets", ".", "extend", "(", "get_spanish_datasets", "(", ")", ")", "\n", "\n", "", "for", "dataset", ",", "config", "in", "datasets", ":", "\n", "        ", "run_experiment", "(", "\n", "predictor_fn", ",", "\n", "output_dir", ".", "joinpath", "(", "_get_dataset_dirname", "(", "dataset", ",", "config", ")", ")", ",", "\n", "n_examples", ",", "\n", "n_trials", ",", "\n", "dataset", ",", "\n", "config", ",", "\n", "n_test_examples", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments._get_dataset_dirname": [[63, 67], ["None"], "function", ["None"], ["", "", "def", "_get_dataset_dirname", "(", "dataset", ":", "str", ",", "config", ":", "Optional", "[", "str", "]", ")", "->", "str", ":", "\n", "    ", "if", "config", "is", "None", ":", "\n", "        ", "return", "dataset", "\n", "", "return", "f\"{dataset}_{config}\"", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiment": [[69, 137], ["symanto_fsb.datasets.load_dataset", "symanto_fsb.labels.to_hypothesis", "range", "output_dir.joinpath().with_suffix", "output_dir.joinpath().with_suffix.exists", "predictor_fn", "experiments.test_model", "print", "output_dir.joinpath().with_suffix", "output_dir.joinpath().with_suffix.exists", "predictor_fn", "symanto_fsb.sampling.sample", "predictor_fn.few_shot", "experiments.test_model", "output_dir.joinpath", "output_dir.joinpath", "labels.int2str", "zip"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.test_model", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.sampling.sample", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.few_shot", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.test_model"], ["", "def", "run_experiment", "(", "\n", "predictor_fn", ":", "Callable", "[", "[", "]", ",", "Predictor", "]", ",", "\n", "output_dir", ":", "Path", ",", "\n", "n_examples", ":", "int", ",", "\n", "n_trials", ":", "int", ",", "\n", "dataset", ":", "str", ",", "\n", "config", ":", "Optional", "[", "str", "]", ",", "\n", "n_test_examples", ":", "Optional", "[", "int", "]", ",", "\n", ")", ":", "\n", "\n", "    ", "try", ":", "\n", "        ", "data_dict", "=", "load_dataset", "(", "dataset", ",", "config", ")", "\n", "", "except", "Exception", "as", "error", ":", "\n", "        ", "print", "(", "f\"Could not load dataset {dataset}: {error}\"", ")", "\n", "return", "\n", "", "labels", "=", "data_dict", "[", "\"test\"", "]", ".", "features", "[", "\"label\"", "]", "\n", "hypotheses", "=", "{", "\n", "label", ":", "to_hypothesis", "(", "label", ",", "dataset", ",", "config", ")", "for", "label", "in", "labels", ".", "names", "\n", "}", "\n", "\n", "if", "n_examples", ">", "0", ":", "\n", "\n", "        ", "for", "trial", "in", "range", "(", "n_trials", ")", ":", "\n", "            ", "result_file", "=", "output_dir", ".", "joinpath", "(", "\n", "f\"results_{trial:02}\"", "\n", ")", ".", "with_suffix", "(", "\".json\"", ")", "\n", "if", "result_file", ".", "exists", "(", ")", ":", "\n", "                ", "continue", "\n", "\n", "", "predictor", "=", "predictor_fn", "(", ")", "\n", "\n", "sample_data", "=", "sample", "(", "\n", "data_dict", "[", "\"train\"", "]", ",", "seed", "=", "trial", ",", "n_examples_per_label", "=", "n_examples", "\n", ")", "\n", "examples", "=", "[", "\n", "{", "\n", "\"text\"", ":", "text", ",", "\n", "\"label\"", ":", "labels", ".", "int2str", "(", "label", ")", ",", "\n", "}", "\n", "for", "text", ",", "label", "in", "zip", "(", "\n", "sample_data", "[", "\"text\"", "]", ",", "sample_data", "[", "\"label\"", "]", "\n", ")", "\n", "]", "\n", "predictor", ".", "few_shot", "(", "\n", "hypotheses", "=", "hypotheses", ",", "\n", "examples", "=", "examples", ",", "\n", ")", "\n", "\n", "test_model", "(", "\n", "predictor", ",", "\n", "hypotheses", ",", "\n", "data_dict", "[", "\"test\"", "]", ",", "\n", "result_file", ",", "\n", "n_test_examples", ",", "\n", ")", "\n", "\n", "", "", "else", ":", "\n", "\n", "        ", "result_file", "=", "output_dir", ".", "joinpath", "(", "\"results_00\"", ")", ".", "with_suffix", "(", "\".json\"", ")", "\n", "if", "result_file", ".", "exists", "(", ")", ":", "\n", "            ", "return", "\n", "", "predictor", "=", "predictor_fn", "(", ")", "\n", "test_model", "(", "\n", "predictor", ",", "\n", "hypotheses", ",", "\n", "data_dict", "[", "\"test\"", "]", ",", "\n", "result_file", ",", "\n", "n_test_examples", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.test_model": [[140, 199], ["predictor.predict", "result_file.parent.mkdir", "result_file.with_name().with_suffix", "sklearn.metrics.accuracy_score", "experiments.macro_f1_score", "symanto_fsb.sampling.sample", "result_file.with_name().with_suffix.open", "zip", "result_file.open", "json.dump", "result_file.with_name", "labels.int2str", "labels.int2str", "writer.write", "writer.write", "json.dumps"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.CharSvmPredictor.predict", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.macro_f1_score", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.sampling.sample"], ["", "", "def", "test_model", "(", "\n", "predictor", ":", "Predictor", ",", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "test_data", ":", "datasets", ".", "Dataset", ",", "\n", "result_file", ":", "Path", ",", "\n", "n_test_examples", ":", "Optional", "[", "int", "]", ",", "\n", ")", ":", "\n", "    ", "labels", "=", "test_data", ".", "features", "[", "\"label\"", "]", "\n", "\n", "if", "n_test_examples", "is", "not", "None", ":", "\n", "        ", "test_data", "=", "sample", "(", "# type: ignore", "\n", "test_data", ",", "seed", "=", "42", ",", "n_examples_per_label", "=", "n_test_examples", "\n", ")", "\n", "\n", "", "examples", "=", "[", "\n", "{", "\n", "\"text\"", ":", "text", ",", "\n", "\"label\"", ":", "None", ",", "\n", "}", "\n", "for", "text", "in", "test_data", "[", "\"text\"", "]", "\n", "]", "\n", "\n", "predictions", "=", "predictor", ".", "predict", "(", "hypotheses", ",", "examples", ")", "\n", "\n", "result_file", ".", "parent", ".", "mkdir", "(", "parents", "=", "True", ",", "exist_ok", "=", "True", ")", "\n", "\n", "pred_file", "=", "result_file", ".", "with_name", "(", "\n", "result_file", ".", "stem", "+", "\"_predictions\"", "\n", ")", ".", "with_suffix", "(", "\".jsonl\"", ")", "\n", "with", "pred_file", ".", "open", "(", "\"tw\"", ")", "as", "writer", ":", "\n", "        ", "for", "text", ",", "pred", ",", "ref", "in", "zip", "(", "\n", "test_data", "[", "\"text\"", "]", ",", "\n", "predictions", ",", "\n", "test_data", "[", "\"label\"", "]", ",", "\n", ")", ":", "\n", "            ", "pred_label", "=", "labels", ".", "int2str", "(", "pred", ")", "\n", "ref_label", "=", "labels", ".", "int2str", "(", "ref", ")", "\n", "writer", ".", "write", "(", "\n", "json", ".", "dumps", "(", "\n", "{", "\n", "\"text\"", ":", "text", ",", "\n", "\"reference\"", ":", "ref_label", ",", "\n", "\"prediction\"", ":", "pred_label", ",", "\n", "}", "\n", ")", "\n", ")", "\n", "writer", ".", "write", "(", "\"\\n\"", ")", "\n", "\n", "", "", "acc", "=", "accuracy_score", "(", "test_data", "[", "\"label\"", "]", ",", "predictions", ")", "\n", "mf1", "=", "macro_f1_score", "(", "test_data", "[", "\"label\"", "]", ",", "predictions", ")", "\n", "\n", "with", "result_file", ".", "open", "(", "\"tw\"", ")", "as", "writer", ":", "\n", "        ", "json", ".", "dump", "(", "\n", "{", "\n", "\"acc\"", ":", "acc", "*", "100.0", ",", "\n", "\"mf1\"", ":", "mf1", "*", "100.0", ",", "\n", "}", ",", "\n", "writer", ",", "\n", "indent", "=", "\"  \"", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.get_results": [[202, 211], ["data_dir.glob", "results.append", "filepath.open", "json.load", "isinstance", "ValueError"], "function", ["None"], ["", "", "def", "get_results", "(", "data_dir", ":", "Path", ")", "->", "List", "[", "dict", "]", ":", "\n", "    ", "results", "=", "[", "]", "\n", "for", "filepath", "in", "data_dir", ".", "glob", "(", "\"results_??.json\"", ")", ":", "\n", "        ", "with", "filepath", ".", "open", "(", "\"tr\"", ")", "as", "reader", ":", "\n", "            ", "result", "=", "json", ".", "load", "(", "reader", ")", "\n", "if", "not", "isinstance", "(", "result", ",", "dict", ")", ":", "\n", "                ", "raise", "ValueError", "(", "result", ")", "\n", "", "", "results", ".", "append", "(", "result", ")", "\n", "", "return", "results", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.report": [[213, 264], ["data_dir.glob", "pandas.DataFrame", "pd.DataFrame.sort_values", "pd.DataFrame.groupby", "pandas.DataFrame", "experiments.get_results", "pandas.DataFrame", "pd.DataFrame.mean", "row.update", "rows.append", "model_data.iterrows", "rows.append", "output_file.open", "pd.DataFrame.to_csv", "round", "dict().items", "dict"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.get_results"], ["", "def", "report", "(", "data_dir", ":", "Path", ",", "output_file", ":", "Path", ")", "->", "None", ":", "\n", "    ", "result_files", "=", "data_dir", ".", "glob", "(", "\"**/results_00.json\"", ")", "\n", "\n", "rows", "=", "[", "]", "\n", "\n", "for", "result_file", "in", "result_files", ":", "\n", "        ", "result_dir", "=", "result_file", ".", "parent", "\n", "dataset", "=", "result_dir", ".", "name", "\n", "n_examples", "=", "result_dir", ".", "parent", ".", "name", "\n", "model", "=", "result_dir", ".", "parent", ".", "parent", ".", "name", "\n", "\n", "results", "=", "get_results", "(", "result_dir", ")", "\n", "\n", "frame", "=", "pd", ".", "DataFrame", "(", "results", ")", "\n", "\n", "mean_results", "=", "frame", ".", "mean", "(", ")", "\n", "\n", "row", "=", "{", "\n", "\"model\"", ":", "model", ",", "\n", "\"n\"", ":", "n_examples", ",", "\n", "\"dataset\"", ":", "dataset", ",", "\n", "}", "\n", "\n", "row", ".", "update", "(", "\n", "{", "\n", "metric", ":", "round", "(", "value", ",", "1", ")", "\n", "for", "metric", ",", "value", "in", "dict", "(", "mean_results", ")", ".", "items", "(", ")", "\n", "}", "\n", ")", "\n", "\n", "rows", ".", "append", "(", "row", ")", "\n", "\n", "", "frame", "=", "pd", ".", "DataFrame", "(", "rows", ")", "\n", "frame", ".", "sort_values", "(", "\"dataset\"", ",", "inplace", "=", "True", ")", "\n", "\n", "rows", "=", "[", "]", "\n", "for", "(", "model", ",", "n_examples", ")", ",", "model_data", "in", "frame", ".", "groupby", "(", "[", "\"model\"", ",", "\"n\"", "]", ")", ":", "\n", "\n", "        ", "row", "=", "{", "\n", "\"model\"", ":", "model", ",", "\n", "\"n\"", ":", "n_examples", ",", "\n", "}", "\n", "\n", "for", "_", ",", "model_row", "in", "model_data", ".", "iterrows", "(", ")", ":", "\n", "            ", "row", "[", "model_row", "[", "\"dataset\"", "]", "]", "=", "model_row", "[", "\"mf1\"", "]", "\n", "\n", "", "rows", ".", "append", "(", "row", ")", "\n", "\n", "", "frame", "=", "pd", ".", "DataFrame", "(", "rows", ")", "\n", "with", "output_file", ".", "open", "(", "\"tw\"", ")", "as", "writer", ":", "\n", "        ", "frame", ".", "to_csv", "(", "writer", ",", "index", "=", "False", ",", "sep", "=", "\"\\t\"", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.sampling._hash": [[22, 26], ["str().encode", "hashlib.sha256().hexdigest", "str", "hashlib.sha256"], "function", ["None"], ["def", "_hash", "(", "text", ":", "str", ",", "seed", ":", "int", ")", "->", "str", ":", "\n", "    ", "\"\"\"Hashes a single example.\"\"\"", "\n", "key", "=", "str", "(", "(", "text", ",", "seed", ")", ")", ".", "encode", "(", "\"utf8\"", ")", "\n", "return", "hashlib", ".", "sha256", "(", "key", ")", ".", "hexdigest", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.sampling.sample": [[28, 53], ["collections.defaultdict", "collections.defaultdict", "enumerate", "collections.defaultdict.values", "sampling._hash", "examples_by_label[].append", "hash_to_index[].append", "examples.sort", "indexes.extend"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._hash"], ["", "def", "sample", "(", "\n", "dataset", ":", "datasets", ".", "Dataset", ",", "seed", ":", "int", ",", "n_examples_per_label", ":", "int", "\n", ")", "->", "Dict", "[", "str", ",", "List", "[", "Union", "[", "str", ",", "int", "]", "]", "]", ":", "\n", "\n", "    ", "examples_by_label", "=", "collections", ".", "defaultdict", "(", "list", ")", "\n", "\n", "hash_to_index", "=", "collections", ".", "defaultdict", "(", "list", ")", "\n", "\n", "for", "idx", ",", "row", "in", "enumerate", "(", "dataset", ")", ":", "\n", "        ", "fingerprint", "=", "_hash", "(", "row", "[", "\"text\"", "]", ",", "seed", ")", "\n", "examples_by_label", "[", "row", "[", "\"label\"", "]", "]", ".", "append", "(", "fingerprint", ")", "\n", "hash_to_index", "[", "fingerprint", "]", ".", "append", "(", "idx", ")", "\n", "\n", "", "indexes", "=", "[", "]", "\n", "\n", "for", "examples", "in", "examples_by_label", ".", "values", "(", ")", ":", "\n", "        ", "examples", ".", "sort", "(", ")", "\n", "for", "fingerprint", "in", "examples", "[", ":", "n_examples_per_label", "]", ":", "\n", "            ", "indexes", ".", "extend", "(", "hash_to_index", "[", "fingerprint", "]", ")", "\n", "\n", "", "", "def", "filter_fn", "(", "example", ",", "idx", ")", "->", "bool", ":", "\n", "        ", "del", "example", "\n", "return", "idx", "in", "indexes", "\n", "\n", "", "return", "dataset", "[", "indexes", "]", "# type: ignore", "\n", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize": [[18, 151], ["NotImplementedError", "label.lower", "NotImplementedError", "label.lower"], "function", ["None"], ["def", "verbalize", "(", "label", ":", "str", ",", "dataset", ":", "str", ",", "config", ":", "Optional", "[", "str", "]", "=", "None", ")", "->", "str", ":", "\n", "    ", "if", "dataset", "==", "\"gnad10\"", ":", "\n", "        ", "return", "label", "\n", "", "if", "dataset", "==", "\"ag_news\"", ":", "\n", "        ", "return", "{", "\n", "\"world\"", ":", "\"world\"", ",", "\n", "\"sports\"", ":", "\"sports\"", ",", "\n", "\"business\"", ":", "\"business\"", ",", "\n", "\"sci/tech\"", ":", "\"science\"", ",", "\n", "}", "[", "label", ".", "lower", "(", ")", "]", "\n", "", "if", "dataset", "==", "\"head_qa\"", ":", "\n", "        ", "return", "{", "\n", "\"medicine\"", ":", "\"medicina\"", ",", "\n", "\"nursery\"", ":", "\"enfermer\u00eda\"", ",", "\n", "\"chemistry\"", ":", "\"qu\u00edmica\"", ",", "\n", "\"biology\"", ":", "\"biolog\u00eda\"", ",", "\n", "\"psychology\"", ":", "\"psicolog\u00eda\"", ",", "\n", "\"pharmacology\"", ":", "\"farmacolog\u00eda\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"yahoo\"", ":", "\n", "        ", "return", "label", ".", "lower", "(", ")", "\n", "", "if", "dataset", "==", "\"amazon_reviews_multi\"", ":", "\n", "        ", "if", "config", "==", "\"de\"", ":", "\n", "            ", "return", "{", "\n", "\"1\"", ":", "\"furchtbar\"", ",", "\n", "\"2\"", ":", "\"schlecht\"", ",", "\n", "\"3\"", ":", "\"ok\"", ",", "\n", "\"4\"", ":", "\"gut\"", ",", "\n", "\"5\"", ":", "\"exzellent\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "config", "==", "\"en\"", ":", "\n", "            ", "return", "{", "\n", "\"1\"", ":", "\"terrible\"", ",", "\n", "\"2\"", ":", "\"bad\"", ",", "\n", "\"3\"", ":", "\"okay\"", ",", "\n", "\"4\"", ":", "\"good\"", ",", "\n", "\"5\"", ":", "\"excellent\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "config", "==", "\"es\"", ":", "\n", "            ", "return", "{", "\n", "\"1\"", ":", "\"terrible\"", ",", "\n", "\"2\"", ":", "\"mal\"", ",", "\n", "\"3\"", ":", "\"regular\"", ",", "\n", "\"4\"", ":", "\"bien\"", ",", "\n", "\"5\"", ":", "\"excelente\"", ",", "\n", "}", "[", "label", "]", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "(", "dataset", ",", "config", ")", "\n", "", "", "if", "dataset", "==", "\"imdb\"", ":", "\n", "        ", "return", "{", "\n", "\"pos\"", ":", "\"great\"", ",", "\n", "\"neg\"", ":", "\"terrible\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"yelp_review_full\"", ":", "\n", "        ", "return", "{", "\n", "\"1 star\"", ":", "\"terrible\"", ",", "\n", "\"2 star\"", ":", "\"bad\"", ",", "\n", "\"3 stars\"", ":", "\"okay\"", ",", "\n", "\"4 stars\"", ":", "\"good\"", ",", "\n", "\"5 stars\"", ":", "\"great\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"yelp_polarity\"", ":", "\n", "        ", "return", "{", "\n", "\"2\"", ":", "\"great\"", ",", "\n", "\"1\"", ":", "\"terrible\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"sab\"", ":", "\n", "        ", "return", "{", "\n", "\"positive\"", ":", "\"positivo\"", ",", "\n", "\"neutral\"", ":", "\"neutro\"", ",", "\n", "\"negative\"", ":", "\"negativo\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"SemEval2016TaskA\"", ":", "\n", "        ", "return", "{", "\n", "\"positive\"", ":", "\"positive\"", ",", "\n", "\"neutral\"", ":", "\"neutral\"", ",", "\n", "\"negative\"", ":", "\"negative\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"unified\"", ":", "\n", "        ", "if", "label", "==", "\"noemo\"", ":", "\n", "            ", "return", "\"no emotion\"", "\n", "", "return", "label", "\n", "", "if", "dataset", "==", "\"deisear\"", ":", "\n", "        ", "return", "{", "\n", "\"guilt\"", ":", "\"Schuld\"", ",", "\n", "\"anger\"", ":", "\"Wut\"", ",", "\n", "\"disgust\"", ":", "\"Ekel\"", ",", "\n", "\"fear\"", ":", "\"Angst\"", ",", "\n", "\"joy\"", ":", "\"Freude\"", ",", "\n", "\"shame\"", ":", "\"Scham\"", ",", "\n", "\"sadness\"", ":", "\"Traurigkeit\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"cola\"", ":", "\n", "        ", "return", "{", "\n", "\"acceptable\"", ":", "\"correct\"", ",", "\n", "\"unacceptable\"", ":", "\"incorrect\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"subj\"", ":", "\n", "        ", "return", "{", "\n", "\"objective\"", ":", "\"objective\"", ",", "\n", "\"subjective\"", ":", "\"subjective\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"trec\"", ":", "\n", "        ", "return", "{", "\n", "\"ABBR\"", ":", "\"expression\"", ",", "\n", "\"DESC\"", ":", "\"description\"", ",", "\n", "\"ENTY\"", ":", "\"entity\"", ",", "\n", "\"HUM\"", ":", "\"human\"", ",", "\n", "\"LOC\"", ":", "\"location\"", ",", "\n", "\"NUM\"", ":", "\"number\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"sitatuion\"", ":", "\n", "        ", "return", "{", "\n", "\"food\"", ":", "\"people there need food.\"", ",", "\n", "\"infra\"", ":", "\"people there need infrastructures.\"", ",", "\n", "\"med\"", ":", "\"people need medical assistance.\"", ",", "\n", "\"search\"", ":", "\"people there need search.\"", ",", "\n", "\"shelter\"", ":", "\"people there need shelter.\"", ",", "\n", "\"utils\"", ":", "\"people there need utilities.\"", ",", "\n", "\"water\"", ":", "\"people there need water.\"", ",", "\n", "\"crimeviolence\"", ":", "\"crime violence happened there.\"", ",", "\n", "\"terrorism\"", ":", "\"this text describes terrorist activity.\"", ",", "\n", "\"evac\"", ":", "\"This place is very dangerous and it is urgent to evacuate people to safety.\"", ",", "\n", "\"regimechange\"", ":", "\"Regime change happened in this country.\"", ",", "\n", "\"out-of-domain\"", ":", "\"This about something else.\"", ",", "\n", "}", "[", "label", "]", "\n", "", "if", "dataset", "==", "\"sb10k\"", ":", "\n", "        ", "return", "{", "\n", "\"positive\"", ":", "\"positiv\"", ",", "\n", "\"neutral\"", ":", "\"neutral\"", ",", "\n", "\"negative\"", ":", "\"negativ\"", ",", "\n", "}", "[", "label", "]", "\n", "", "raise", "NotImplementedError", "(", "dataset", ",", "config", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis": [[153, 196], ["labels.verbalize", "NotImplementedError", "NotImplementedError"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "to_hypothesis", "(", "\n", "label", ":", "str", ",", "dataset", ":", "str", ",", "config", ":", "Optional", "[", "str", "]", "=", "None", "\n", ")", "->", "str", ":", "\n", "    ", "label", "=", "verbalize", "(", "label", ",", "dataset", ",", "config", ")", "\n", "if", "dataset", "==", "\"gnad10\"", ":", "\n", "        ", "return", "f\"Das ist ein Artikel aus der Rubrik {label}.\"", "\n", "", "if", "dataset", "==", "\"ag_news\"", ":", "\n", "        ", "return", "f\"It is {label} news.\"", "\n", "", "if", "dataset", "==", "\"head_qa\"", ":", "\n", "        ", "return", "f\"Est\u00e1 relacionado con la {label}.\"", "\n", "", "if", "dataset", "==", "\"yahoo\"", ":", "\n", "        ", "return", "f\"It is related with {label}.\"", "\n", "", "if", "dataset", "==", "\"amazon_reviews_multi\"", ":", "\n", "        ", "if", "config", "==", "\"de\"", ":", "\n", "            ", "return", "f\"Dieses Produkt ist {label}.\"", "\n", "", "if", "config", "==", "\"es\"", ":", "\n", "            ", "return", "f\"Este producto est\u00e1 {label}.\"", "\n", "", "if", "config", "==", "\"en\"", ":", "\n", "            ", "return", "f\"This product is {label}.\"", "\n", "", "raise", "NotImplementedError", "(", "dataset", ",", "config", ")", "\n", "", "if", "dataset", "==", "\"imdb\"", ":", "\n", "        ", "return", "f\"It was {label}.\"", "\n", "", "if", "dataset", "==", "\"yelp_review_full\"", ":", "\n", "        ", "return", "f\"It was {label}.\"", "\n", "", "if", "dataset", "==", "\"yelp_polarity\"", ":", "\n", "        ", "return", "f\"It was {label}.\"", "\n", "", "if", "dataset", "==", "\"sab\"", ":", "\n", "        ", "return", "f\"Esta persona expresa un sentimiento {label}.\"", "\n", "", "if", "dataset", "==", "\"sb10k\"", ":", "\n", "        ", "return", "f\"Diese Person dr\u00fcckt ein {label}es Gef\u00fchl aus.\"", "\n", "", "if", "dataset", "==", "\"SemEval2016TaskA\"", ":", "\n", "        ", "return", "f\"This person expresses a {label} feeling.\"", "\n", "", "if", "dataset", "==", "\"unified\"", ":", "\n", "        ", "if", "label", "==", "\"no emotion\"", ":", "\n", "            ", "return", "\"This person doesn't feel any particular emotion.\"", "\n", "", "return", "f\"This person feels {label}.\"", "\n", "", "if", "dataset", "==", "\"deisear\"", ":", "\n", "        ", "return", "f\"Diese Person empfindet {label}.\"", "\n", "", "if", "dataset", "in", "[", "\"trec\"", ",", "\"subj\"", ",", "\"cola\"", "]", ":", "\n", "        ", "return", "f\"It is {label}.\"", "\n", "", "if", "dataset", "==", "\"situation\"", ":", "\n", "        ", "return", "label", "\n", "", "raise", "NotImplementedError", "(", "dataset", ",", "config", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_charsvm.TestCharSvm.test_charsvm": [[24, 44], ["tempfile.TemporaryDirectory", "pathlib.Path", "symanto_fsb.experiments.run_experiment", "symanto_fsb.experiments.get_results", "test_charsvm.TestCharSvm.assertEqual", "test_charsvm.TestCharSvm.assertGreater", "test_charsvm.TestCharSvm.assertGreater", "len", "symanto_fsb.models.predictors.char_svm.CharSvmPredictor"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiment", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.get_results"], ["    ", "def", "test_charsvm", "(", "self", ")", ":", "\n", "        ", "with", "tempfile", ".", "TemporaryDirectory", "(", ")", "as", "temp_dir", ":", "\n", "\n", "            ", "temp_path", "=", "Path", "(", "temp_dir", ")", "\n", "\n", "run_experiment", "(", "\n", "predictor_fn", "=", "lambda", ":", "CharSvmPredictor", "(", ")", ",", "\n", "output_dir", "=", "temp_path", ",", "\n", "n_examples", "=", "4", ",", "\n", "n_trials", "=", "1", ",", "\n", "dataset", "=", "\"gnad10\"", ",", "\n", "config", "=", "None", ",", "\n", "n_test_examples", "=", "10", ",", "\n", ")", "\n", "\n", "results", "=", "get_results", "(", "temp_path", ")", "\n", "self", ".", "assertEqual", "(", "1", ",", "len", "(", "results", ")", ")", "\n", "result", "=", "results", "[", "0", "]", "\n", "self", ".", "assertGreater", "(", "result", "[", "\"acc\"", "]", ",", "35", ")", "\n", "self", ".", "assertGreater", "(", "result", "[", "\"mf1\"", "]", ",", "36", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_gnad": [[21, 37], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["    ", "def", "test_gnad", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"gnad10\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "1028", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"train\"", "]", ")", ",", "9245", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\n", "\"Web\"", ",", "\n", "\"Panorama\"", ",", "\n", "\"International\"", ",", "\n", "\"Wirtschaft\"", ",", "\n", "\"Sport\"", ",", "\n", "\"Inland\"", ",", "\n", "\"Etat\"", ",", "\n", "\"Wissenschaft\"", ",", "\n", "\"Kultur\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_agnews": [[40, 47], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_agnews", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"ag_news\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "7600", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"train\"", "]", ")", ",", "120_000", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\"World\"", ",", "\"Sports\"", ",", "\"Business\"", ",", "\"Sci/Tech\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_amazon_reviews_multi": [[93, 103], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_amazon_reviews_multi", "(", "self", ")", ":", "\n", "        ", "for", "lang", "in", "[", "\"de\"", ",", "\"es\"", ",", "\"en\"", "]", ":", "\n", "            ", "dataset", "=", "load_dataset", "(", "\"amazon_reviews_multi\"", ",", "config", "=", "lang", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "5000", ")", "\n", "self", ".", "assertEqual", "(", "\n", "len", "(", "dataset", "[", "\"train\"", "]", ")", "+", "len", "(", "dataset", "[", "\"validation\"", "]", ")", ",", "205_000", "\n", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\"1\"", ",", "\"2\"", ",", "\"3\"", ",", "\"4\"", ",", "\"5\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_imdb": [[105, 111], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "", "def", "test_imdb", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"imdb\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "25_000", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"train\"", "]", ")", ",", "25_000", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "[", "\"neg\"", ",", "\"pos\"", "]", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_yelp_polarity": [[124, 129], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_yelp_polarity", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"yelp_polarity\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "38_000", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"train\"", "]", ")", ",", "560_000", ")", "\n", "self", ".", "assertEqual", "(", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "[", "\"1\"", ",", "\"2\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_sab": [[130, 142], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_sab", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"sab\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "459", ")", "\n", "self", ".", "assertEqual", "(", "\n", "len", "(", "dataset", "[", "\"train\"", "]", ")", "+", "len", "(", "dataset", "[", "\"validation\"", "]", ")", ",", "3979", "\n", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\n", "\"positive\"", ",", "\n", "\"neutral\"", ",", "\n", "\"negative\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_SemEval2016TaskA": [[145, 157], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_SemEval2016TaskA", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"SemEval2016TaskA\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "20_632", ")", "\n", "self", ".", "assertEqual", "(", "\n", "len", "(", "dataset", "[", "\"train\"", "]", ")", "+", "len", "(", "dataset", "[", "\"validation\"", "]", ")", ",", "9_834", "\n", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_sb10k": [[160, 170], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_sb10k", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"sb10k\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "994", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"train\"", "]", ")", ",", "8955", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_deisear": [[195, 211], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_deisear", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"deisear\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "340", ")", "\n", "self", ".", "assertEqual", "(", "\n", "len", "(", "dataset", "[", "\"train\"", "]", ")", "+", "len", "(", "dataset", "[", "\"validation\"", "]", ")", ",", "643", "\n", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\n", "\"guilt\"", ",", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"joy\"", ",", "\n", "\"shame\"", ",", "\n", "\"sadness\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_cola": [[214, 230], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len", "test_datasets.TestDatasets.assertIn", "dataset[].features[].int2str"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_cola", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"cola\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "1043", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"train\"", "]", ")", ",", "8551", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\"unacceptable\"", ",", "\"acceptable\"", "]", ",", "\n", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"test\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\"unacceptable\"", ",", "\"acceptable\"", "]", ",", "\n", ")", "\n", "for", "label", "in", "dataset", "[", "\"test\"", "]", "[", "\"label\"", "]", ":", "\n", "            ", "self", ".", "assertIn", "(", "\n", "dataset", "[", "\"test\"", "]", ".", "features", "[", "\"label\"", "]", ".", "int2str", "(", "label", ")", ",", "\n", "[", "\"unacceptable\"", ",", "\"acceptable\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_subj": [[232, 243], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "", "def", "test_subj", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"subj\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "1981", ")", "\n", "self", ".", "assertEqual", "(", "\n", "len", "(", "dataset", "[", "\"train\"", "]", ")", "+", "len", "(", "dataset", "[", "\"validation\"", "]", ")", ",", "8019", "\n", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\n", "\"subjective\"", ",", "\n", "\"objective\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_datasets.TestDatasets.test_trec": [[246, 253], ["symanto_fsb.datasets.load_dataset", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "test_datasets.TestDatasets.assertEqual", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], ["", "def", "test_trec", "(", "self", ")", ":", "\n", "        ", "dataset", "=", "load_dataset", "(", "\"trec\"", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"test\"", "]", ")", ",", "500", ")", "\n", "self", ".", "assertEqual", "(", "len", "(", "dataset", "[", "\"train\"", "]", ")", ",", "5452", ")", "\n", "self", ".", "assertEqual", "(", "\n", "dataset", "[", "\"train\"", "]", ".", "features", "[", "\"label\"", "]", ".", "names", ",", "\n", "[", "\"DESC\"", ",", "\"ENTY\"", ",", "\"ABBR\"", ",", "\"HUM\"", ",", "\"NUM\"", ",", "\"LOC\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_sampling.TestSampling.test_sampling": [[23, 51], ["symanto_fsb.datasets.load_dataset", "range", "range", "range", "collections.Counter", "test_sampling.TestSampling.assertEqual", "collections.Counter.most_common", "texts_per_trial.append", "len", "test_sampling.TestSampling.assertNotEqual", "symanto_fsb.sampling.sample", "test_sampling.TestSampling.assertEqual", "symanto_fsb.sampling.sample", "len", "test_sampling.TestSampling.assertEqual", "ValueError"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.sampling.sample", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.sampling.sample"], ["    ", "def", "test_sampling", "(", "self", ")", ":", "\n", "        ", "n_trials", "=", "5", "\n", "train", "=", "load_dataset", "(", "\"gnad10\"", ")", "[", "\"train\"", "]", "\n", "for", "n_examples_per_label", "in", "[", "2", ",", "8", ",", "16", "]", ":", "\n", "            ", "texts_per_trial", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "n_trials", ")", ":", "\n", "                ", "try", ":", "\n", "                    ", "train_sample", "=", "sample", "(", "\n", "train", ",", "seed", "=", "i", ",", "n_examples_per_label", "=", "n_examples_per_label", "\n", ")", "\n", "", "except", "KeyError", "as", "k_error", ":", "\n", "                    ", "raise", "ValueError", "(", "i", ")", "from", "k_error", "\n", "", "labels", "=", "Counter", "(", "train_sample", "[", "\"label\"", "]", ")", "\n", "self", ".", "assertEqual", "(", "\n", "len", "(", "labels", ")", ",", "train", ".", "features", "[", "\"label\"", "]", ".", "num_classes", "\n", ")", "\n", "for", "label", ",", "count", "in", "labels", ".", "most_common", "(", ")", ":", "\n", "                    ", "self", ".", "assertEqual", "(", "count", ",", "n_examples_per_label", ")", "\n", "", "texts_per_trial", ".", "append", "(", "train_sample", "[", "\"text\"", "]", ")", "\n", "\n", "", "for", "i", "in", "range", "(", "1", ",", "len", "(", "texts_per_trial", ")", ")", ":", "\n", "                ", "self", ".", "assertNotEqual", "(", "texts_per_trial", "[", "0", "]", ",", "texts_per_trial", "[", "i", "]", ")", "\n", "\n", "", "for", "i", "in", "range", "(", "5", ")", ":", "\n", "                ", "train_sample", "=", "sample", "(", "\n", "train", ",", "seed", "=", "i", ",", "n_examples_per_label", "=", "n_examples_per_label", "\n", ")", "\n", "self", ".", "assertEqual", "(", "texts_per_trial", "[", "i", "]", ",", "train_sample", "[", "\"text\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_gnad": [[21, 37], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["    ", "def", "test_gnad", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"Web\"", ",", "\n", "\"Panorama\"", ",", "\n", "\"International\"", ",", "\n", "\"Wirtschaft\"", ",", "\n", "\"Sport\"", ",", "\n", "\"Inland\"", ",", "\n", "\"Etat\"", ",", "\n", "\"Wissenschaft\"", ",", "\n", "\"Kultur\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"gnad10\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "labels", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_agnews": [[39, 45], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_agnews", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"World\"", ",", "\"Sports\"", ",", "\"Business\"", ",", "\"Sci/Tech\"", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"ag_news\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"world\"", ",", "\"sports\"", ",", "\"business\"", ",", "\"science\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_head_qa": [[47, 66], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_head_qa", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"medicine\"", ",", "\n", "\"nursery\"", ",", "\n", "\"chemistry\"", ",", "\n", "\"biology\"", ",", "\n", "\"psychology\"", ",", "\n", "\"pharmacology\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"head_qa\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"medicina\"", ",", "\n", "\"enfermer\u00eda\"", ",", "\n", "\"qu\u00edmica\"", ",", "\n", "\"biolog\u00eda\"", ",", "\n", "\"psicolog\u00eda\"", ",", "\n", "\"farmacolog\u00eda\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_yahoo": [[69, 84], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize", "label.lower"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_yahoo", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"Society & Culture\"", ",", "\n", "\"Science & Mathematics\"", ",", "\n", "\"Health\"", ",", "\n", "\"Education & Reference\"", ",", "\n", "\"Computers & Internet\"", ",", "\n", "\"Sports\"", ",", "\n", "\"Business & Finance\"", ",", "\n", "\"Entertainment & Music\"", ",", "\n", "\"Family & Relationships\"", ",", "\n", "\"Politics & Government\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"yahoo\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "texts", ",", "[", "label", ".", "lower", "(", ")", "for", "label", "in", "labels", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_amazon_reviews_multi": [[85, 99], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_amazon_reviews_multi", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"1\"", ",", "\"2\"", ",", "\"3\"", ",", "\"4\"", ",", "\"5\"", "]", "\n", "for", "lang", "in", "[", "\"de\"", ",", "\"es\"", ",", "\"en\"", "]", ":", "\n", "            ", "texts", "=", "[", "\n", "verbalize", "(", "label", ",", "\"amazon_reviews_multi\"", ",", "lang", ")", "\n", "for", "label", "in", "labels", "\n", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "{", "\n", "\"de\"", ":", "[", "\"furchtbar\"", ",", "\"schlecht\"", ",", "\"ok\"", ",", "\"gut\"", ",", "\"exzellent\"", "]", ",", "\n", "\"es\"", ":", "[", "\"terrible\"", ",", "\"mal\"", ",", "\"regular\"", ",", "\"bien\"", ",", "\"excelente\"", "]", ",", "\n", "\"en\"", ":", "[", "\"terrible\"", ",", "\"bad\"", ",", "\"okay\"", ",", "\"good\"", ",", "\"excellent\"", "]", ",", "\n", "}", "[", "lang", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_imdb": [[101, 107], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "", "def", "test_imdb", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"neg\"", ",", "\"pos\"", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"imdb\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"terrible\"", ",", "\"great\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_yelp_review_full": [[109, 113], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_yelp_review_full", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"1 star\"", ",", "\"2 star\"", ",", "\"3 stars\"", ",", "\"4 stars\"", ",", "\"5 stars\"", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"yelp_review_full\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "texts", ",", "[", "\"terrible\"", ",", "\"bad\"", ",", "\"okay\"", ",", "\"good\"", ",", "\"great\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_yelp_polarity": [[114, 120], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_yelp_polarity", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"1\"", ",", "\"2\"", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"yelp_polarity\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"terrible\"", ",", "\"great\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_sab": [[122, 132], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_sab", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"positive\"", ",", "\n", "\"neutral\"", ",", "\n", "\"negative\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"sab\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"positivo\"", ",", "\"neutro\"", ",", "\"negativo\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_SemEval2016TaskA": [[134, 144], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_SemEval2016TaskA", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"SemEval2016TaskA\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"positive\"", ",", "\"negative\"", ",", "\"neutral\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_sb10k": [[146, 156], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_sb10k", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"sb10k\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"positiv\"", ",", "\"negativ\"", ",", "\"neutral\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_unified": [[158, 185], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_unified", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"guilt\"", ",", "\n", "\"joy\"", ",", "\n", "\"love\"", ",", "\n", "\"noemo\"", ",", "\n", "\"sadness\"", ",", "\n", "\"shame\"", ",", "\n", "\"surprise\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"unified\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"guilt\"", ",", "\n", "\"joy\"", ",", "\n", "\"love\"", ",", "\n", "\"no emotion\"", ",", "\n", "\"sadness\"", ",", "\n", "\"shame\"", ",", "\n", "\"surprise\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_deisear": [[188, 209], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_deisear", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"guilt\"", ",", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"joy\"", ",", "\n", "\"shame\"", ",", "\n", "\"sadness\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"deisear\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"Schuld\"", ",", "\n", "\"Wut\"", ",", "\n", "\"Ekel\"", ",", "\n", "\"Angst\"", ",", "\n", "\"Freude\"", ",", "\n", "\"Scham\"", ",", "\n", "\"Traurigkeit\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_cola": [[212, 218], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_cola", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"unacceptable\"", ",", "\"acceptable\"", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"cola\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"incorrect\"", ",", "\"correct\"", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_subj": [[220, 227], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_subj", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"subjective\"", ",", "\n", "\"objective\"", ",", "\n", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"subj\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "texts", ",", "[", "\"subjective\"", ",", "\"objective\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_labels.TestLabels.test_trec": [[228, 240], ["test_labels.TestLabels.assertEqual", "symanto_fsb.labels.verbalize"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.verbalize"], ["", "def", "test_trec", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"DESC\"", ",", "\"ENTY\"", ",", "\"ABBR\"", ",", "\"HUM\"", ",", "\"NUM\"", ",", "\"LOC\"", "]", "\n", "texts", "=", "[", "verbalize", "(", "label", ",", "\"trec\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"description\"", ",", "\n", "\"entity\"", ",", "\n", "\"expression\"", ",", "\n", "\"human\"", ",", "\n", "\"number\"", ",", "\n", "\"location\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_sentence_transformer.TestSentenceTransformer.test_dual_encoder_few_shot": [[39, 63], ["symanto_fsb.models.siamese_models.label_tuning._get_configs", "tempfile.TemporaryDirectory", "pathlib.Path", "symanto_fsb.experiments.run_experiment", "symanto_fsb.experiments.get_results", "test_sentence_transformer.TestSentenceTransformer.assertEqual", "test_sentence_transformer.TestSentenceTransformer.assertGreater", "test_sentence_transformer.TestSentenceTransformer.assertGreater", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_configs", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiment", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.get_results"], ["    ", "def", "test_dual_encoder_few_shot", "(", "self", ")", ":", "\n", "        ", "get_config_backup", "=", "label_tuning", ".", "_get_configs", "\n", "configs", "=", "label_tuning", ".", "_get_configs", "(", ")", "\n", "label_tuning", ".", "_get_configs", "=", "lambda", ":", "configs", "[", ":", "1", "]", "\n", "\n", "with", "tempfile", ".", "TemporaryDirectory", "(", ")", "as", "temp_dir", ":", "\n", "            ", "temp_path", "=", "Path", "(", "temp_dir", ")", "\n", "run_experiment", "(", "\n", "predictor_fn", "=", "get_encoder", ",", "\n", "output_dir", "=", "temp_path", ",", "\n", "n_examples", "=", "4", ",", "\n", "n_trials", "=", "1", ",", "\n", "dataset", "=", "\"gnad10\"", ",", "\n", "config", "=", "None", ",", "\n", "n_test_examples", "=", "10", ",", "\n", ")", "\n", "\n", "results", "=", "get_results", "(", "temp_path", ")", "\n", "self", ".", "assertEqual", "(", "1", ",", "len", "(", "results", ")", ")", "\n", "result", "=", "results", "[", "0", "]", "\n", "self", ".", "assertGreater", "(", "result", "[", "\"acc\"", "]", ",", "59", ")", "\n", "self", ".", "assertGreater", "(", "result", "[", "\"mf1\"", "]", ",", "59", ")", "\n", "\n", "", "label_tuning", ".", "_get_configs", "=", "get_config_backup", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_sentence_transformer.TestSentenceTransformer.test_dual_encoder_zero_shot": [[64, 88], ["symanto_fsb.models.siamese_models.label_tuning._get_configs", "tempfile.TemporaryDirectory", "pathlib.Path", "symanto_fsb.experiments.run_experiment", "symanto_fsb.experiments.get_results", "test_sentence_transformer.TestSentenceTransformer.assertEqual", "test_sentence_transformer.TestSentenceTransformer.assertGreater", "test_sentence_transformer.TestSentenceTransformer.assertGreater", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_configs", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.run_experiment", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.experiments.get_results"], ["", "def", "test_dual_encoder_zero_shot", "(", "self", ")", ":", "\n", "        ", "get_config_backup", "=", "label_tuning", ".", "_get_configs", "\n", "configs", "=", "label_tuning", ".", "_get_configs", "(", ")", "\n", "label_tuning", ".", "_get_configs", "=", "lambda", ":", "configs", "[", ":", "1", "]", "\n", "\n", "with", "tempfile", ".", "TemporaryDirectory", "(", ")", "as", "temp_dir", ":", "\n", "            ", "temp_path", "=", "Path", "(", "temp_dir", ")", "\n", "run_experiment", "(", "\n", "predictor_fn", "=", "get_encoder", ",", "\n", "output_dir", "=", "temp_path", ",", "\n", "n_examples", "=", "0", ",", "\n", "n_trials", "=", "1", ",", "\n", "dataset", "=", "\"gnad10\"", ",", "\n", "config", "=", "None", ",", "\n", "n_test_examples", "=", "10", ",", "\n", ")", "\n", "\n", "results", "=", "get_results", "(", "temp_path", ")", "\n", "self", ".", "assertEqual", "(", "1", ",", "len", "(", "results", ")", ")", "\n", "result", "=", "results", "[", "0", "]", "\n", "self", ".", "assertGreater", "(", "result", "[", "\"acc\"", "]", ",", "35", ")", "\n", "self", ".", "assertGreater", "(", "result", "[", "\"mf1\"", "]", ",", "31", ")", "\n", "\n", "", "label_tuning", ".", "_get_configs", "=", "get_config_backup", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_sentence_transformer.get_encoder": [[29, 34], ["symanto_fsb.models.predictors.dual_encoder.DualEncoderPredictor"], "function", ["None"], ["def", "get_encoder", "(", ")", "->", "DualEncoderPredictor", ":", "\n", "    ", "return", "DualEncoderPredictor", "(", "\n", "{", "\n", "\"model\"", ":", "\"sentence-transformers/paraphrase-multilingual-mpnet-base-v2\"", ",", "\n", "\"module\"", ":", "\"sentence_transformer\"", ",", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_gnad": [[21, 46], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["    ", "def", "test_gnad", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"Web\"", ",", "\n", "\"Panorama\"", ",", "\n", "\"International\"", ",", "\n", "\"Wirtschaft\"", ",", "\n", "\"Sport\"", ",", "\n", "\"Inland\"", ",", "\n", "\"Etat\"", ",", "\n", "\"Wissenschaft\"", ",", "\n", "\"Kultur\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"gnad10\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"Das ist ein Artikel aus der Rubrik Web.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik Panorama.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik International.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik Wirtschaft.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik Sport.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik Inland.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik Etat.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik Wissenschaft.\"", ",", "\n", "\"Das ist ein Artikel aus der Rubrik Kultur.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_agnews": [[49, 59], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_agnews", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"World\"", ",", "\"Sports\"", ",", "\"Business\"", ",", "\"Sci/Tech\"", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"ag_news\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"It is world news.\"", ",", "\n", "\"It is sports news.\"", ",", "\n", "\"It is business news.\"", ",", "\n", "\"It is science news.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_head_qa": [[62, 81], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_head_qa", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"medicine\"", ",", "\n", "\"nursery\"", ",", "\n", "\"chemistry\"", ",", "\n", "\"biology\"", ",", "\n", "\"psychology\"", ",", "\n", "\"pharmacology\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"head_qa\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"Est\u00e1 relacionado con la medicina.\"", ",", "\n", "\"Est\u00e1 relacionado con la enfermer\u00eda.\"", ",", "\n", "\"Est\u00e1 relacionado con la qu\u00edmica.\"", ",", "\n", "\"Est\u00e1 relacionado con la biolog\u00eda.\"", ",", "\n", "\"Est\u00e1 relacionado con la psicolog\u00eda.\"", ",", "\n", "\"Est\u00e1 relacionado con la farmacolog\u00eda.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_yahoo": [[84, 101], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis", "label.lower"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_yahoo", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"Society & Culture\"", ",", "\n", "\"Science & Mathematics\"", ",", "\n", "\"Health\"", ",", "\n", "\"Education & Reference\"", ",", "\n", "\"Computers & Internet\"", ",", "\n", "\"Sports\"", ",", "\n", "\"Business & Finance\"", ",", "\n", "\"Entertainment & Music\"", ",", "\n", "\"Family & Relationships\"", ",", "\n", "\"Politics & Government\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"yahoo\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\"It is related with \"", "+", "label", ".", "lower", "(", ")", "+", "\".\"", "for", "label", "in", "labels", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_amazon_reviews_multi": [[103, 135], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_amazon_reviews_multi", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"1\"", ",", "\"2\"", ",", "\"3\"", ",", "\"4\"", ",", "\"5\"", "]", "\n", "for", "lang", "in", "[", "\"de\"", ",", "\"es\"", ",", "\"en\"", "]", ":", "\n", "            ", "texts", "=", "[", "\n", "to_hypothesis", "(", "label", ",", "\"amazon_reviews_multi\"", ",", "lang", ")", "\n", "for", "label", "in", "labels", "\n", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "{", "\n", "\"de\"", ":", "[", "\n", "\"Dieses Produkt ist furchtbar.\"", ",", "\n", "\"Dieses Produkt ist schlecht.\"", ",", "\n", "\"Dieses Produkt ist ok.\"", ",", "\n", "\"Dieses Produkt ist gut.\"", ",", "\n", "\"Dieses Produkt ist exzellent.\"", ",", "\n", "]", ",", "\n", "\"es\"", ":", "[", "\n", "\"Este producto est\u00e1 terrible.\"", ",", "\n", "\"Este producto est\u00e1 mal.\"", ",", "\n", "\"Este producto est\u00e1 regular.\"", ",", "\n", "\"Este producto est\u00e1 bien.\"", ",", "\n", "\"Este producto est\u00e1 excelente.\"", ",", "\n", "]", ",", "\n", "\"en\"", ":", "[", "\n", "\"This product is terrible.\"", ",", "\n", "\"This product is bad.\"", ",", "\n", "\"This product is okay.\"", ",", "\n", "\"This product is good.\"", ",", "\n", "\"This product is excellent.\"", ",", "\n", "]", ",", "\n", "}", "[", "lang", "]", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_imdb": [[137, 141], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "", "def", "test_imdb", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"neg\"", ",", "\"pos\"", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"imdb\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "texts", ",", "[", "\"It was terrible.\"", ",", "\"It was great.\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_yelp_review_full": [[142, 153], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_yelp_review_full", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"1 star\"", ",", "\"2 star\"", ",", "\"3 stars\"", ",", "\"4 stars\"", ",", "\"5 stars\"", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"yelp_review_full\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"It was terrible.\"", ",", "\n", "\"It was bad.\"", ",", "\n", "\"It was okay.\"", ",", "\n", "\"It was good.\"", ",", "\n", "\"It was great.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_yelp_polarity": [[156, 160], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_yelp_polarity", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"1\"", ",", "\"2\"", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"yelp_polarity\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "texts", ",", "[", "\"It was terrible.\"", ",", "\"It was great.\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_sab": [[161, 174], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_sab", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"positive\"", ",", "\n", "\"neutral\"", ",", "\n", "\"negative\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"sab\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"Esta persona expresa un sentimiento positivo.\"", ",", "\n", "\"Esta persona expresa un sentimiento neutro.\"", ",", "\n", "\"Esta persona expresa un sentimiento negativo.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_SemEval2016TaskA": [[177, 190], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_SemEval2016TaskA", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"SemEval2016TaskA\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"This person expresses a positive feeling.\"", ",", "\n", "\"This person expresses a negative feeling.\"", ",", "\n", "\"This person expresses a neutral feeling.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_sb10k": [[193, 206], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_sb10k", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"sb10k\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"Diese Person dr\u00fcckt ein positives Gef\u00fchl aus.\"", ",", "\n", "\"Diese Person dr\u00fcckt ein negatives Gef\u00fchl aus.\"", ",", "\n", "\"Diese Person dr\u00fcckt ein neutrales Gef\u00fchl aus.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_unified": [[209, 236], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_unified", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"guilt\"", ",", "\n", "\"joy\"", ",", "\n", "\"love\"", ",", "\n", "\"noemo\"", ",", "\n", "\"sadness\"", ",", "\n", "\"shame\"", ",", "\n", "\"surprise\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"unified\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"This person feels anger.\"", ",", "\n", "\"This person feels disgust.\"", ",", "\n", "\"This person feels fear.\"", ",", "\n", "\"This person feels guilt.\"", ",", "\n", "\"This person feels joy.\"", ",", "\n", "\"This person feels love.\"", ",", "\n", "\"This person doesn't feel any particular emotion.\"", ",", "\n", "\"This person feels sadness.\"", ",", "\n", "\"This person feels shame.\"", ",", "\n", "\"This person feels surprise.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_deisear": [[239, 260], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_deisear", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"guilt\"", ",", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"joy\"", ",", "\n", "\"shame\"", ",", "\n", "\"sadness\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"deisear\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"Diese Person empfindet Schuld.\"", ",", "\n", "\"Diese Person empfindet Wut.\"", ",", "\n", "\"Diese Person empfindet Ekel.\"", ",", "\n", "\"Diese Person empfindet Angst.\"", ",", "\n", "\"Diese Person empfindet Freude.\"", ",", "\n", "\"Diese Person empfindet Scham.\"", ",", "\n", "\"Diese Person empfindet Traurigkeit.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_cola": [[263, 267], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_cola", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"unacceptable\"", ",", "\"acceptable\"", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"cola\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "texts", ",", "[", "\"It is incorrect.\"", ",", "\"It is correct.\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_subj": [[268, 275], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_subj", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\n", "\"subjective\"", ",", "\n", "\"objective\"", ",", "\n", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"subj\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "texts", ",", "[", "\"It is subjective.\"", ",", "\"It is objective.\"", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.unit.test_hypotheses.TestHypotheses.test_trec": [[276, 288], ["test_hypotheses.TestHypotheses.assertEqual", "symanto_fsb.labels.to_hypothesis"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.symanto_fsb.labels.to_hypothesis"], ["", "def", "test_trec", "(", "self", ")", ":", "\n", "        ", "labels", "=", "[", "\"DESC\"", ",", "\"ENTY\"", ",", "\"ABBR\"", ",", "\"HUM\"", ",", "\"NUM\"", ",", "\"LOC\"", "]", "\n", "texts", "=", "[", "to_hypothesis", "(", "label", ",", "\"trec\"", ")", "for", "label", "in", "labels", "]", "\n", "self", ".", "assertEqual", "(", "\n", "texts", ",", "\n", "[", "\n", "\"It is description.\"", ",", "\n", "\"It is entity.\"", ",", "\n", "\"It is expression.\"", ",", "\n", "\"It is human.\"", ",", "\n", "\"It is number.\"", ",", "\n", "\"It is location.\"", ",", "\n", "]", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.deisear.DeIsearDataset._info": [[156, 180], ["datasets.Features", "datasets.DatasetInfo", "datasets.Value", "datasets.ClassLabel"], "methods", ["None"], ["def", "_info", "(", "self", ")", ":", "\n", "        ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "ClassLabel", "(", "\n", "names", "=", "[", "\n", "\"guilt\"", ",", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"joy\"", ",", "\n", "\"shame\"", ",", "\n", "\"sadness\"", ",", "\n", "]", ",", "\n", ")", ",", "\n", "}", ",", "\n", ")", "\n", "return", "datasets", ".", "DatasetInfo", "(", "\n", "description", "=", "_DESCRIPTION", ",", "\n", "features", "=", "features", ",", "\n", "supervised_keys", "=", "None", ",", "\n", "homepage", "=", "_HOMEPAGE", ",", "\n", "license", "=", "_LICENSE", ",", "\n", "citation", "=", "_CITATION", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.deisear.DeIsearDataset._split_generators": [[182, 205], ["dl_manager.download_and_extract", "datasets.SplitGenerator", "datasets.SplitGenerator", "datasets.SplitGenerator"], "methods", ["None"], ["", "def", "_split_generators", "(", "self", ",", "dl_manager", ")", ":", "\n", "        ", "\"\"\"Returns SplitGenerators.\"\"\"", "\n", "data_dir", "=", "dl_manager", ".", "download_and_extract", "(", "_URL", ")", "\n", "return", "[", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"train\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TEST", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"test\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "VALIDATION", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"dev\"", ",", "\n", "}", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.deisear.DeIsearDataset._generate_examples": [[209, 216], ["deisear.read", "pathlib.Path().joinpath", "pathlib.Path"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read"], ["", "def", "_generate_examples", "(", "\n", "self", ",", "\n", "data_dir", ",", "\n", "split", ",", "\n", ")", ":", "\n", "        ", "\"\"\"Yields examples as (key, example) tuples.\"\"\"", "\n", "yield", "from", "read", "(", "Path", "(", "data_dir", ")", ".", "joinpath", "(", "\"deISEARenISEAR\"", ")", ",", "split", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.deisear._to_emotion_label": [[65, 71], ["collections.Counter", "ValueError", "collections.Counter.most_common", "len"], "function", ["None"], ["def", "_to_emotion_label", "(", "values", ")", ":", "\n", "    ", "labels", "=", "collections", ".", "Counter", "(", "[", "v", "[", "\"annotation\"", "]", "for", "v", "in", "values", "]", ")", "\n", "label", ",", "count", "=", "labels", ".", "most_common", "(", "n", "=", "1", ")", "[", "0", "]", "\n", "if", "count", ">", "len", "(", "labels", ")", "//", "2", ":", "\n", "        ", "return", "_labels", "[", "label", "]", "\n", "", "raise", "ValueError", "(", "f\"No majority label: {values}\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.deisear._hash": [[73, 78], ["str().encode", "hashlib.sha256().hexdigest", "str", "hashlib.sha256"], "function", ["None"], ["", "def", "_hash", "(", "example_with_id", ")", "->", "str", ":", "\n", "    ", "\"\"\"Hashes a single example.\"\"\"", "\n", "key", "=", "example_with_id", "[", "0", "]", ",", "example_with_id", "[", "1", "]", "[", "\"text\"", "]", "\n", "key_bytes", "=", "str", "(", "key", ")", ".", "encode", "(", "\"utf8\"", ")", "\n", "return", "hashlib", ".", "sha256", "(", "key_bytes", ")", ".", "hexdigest", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.deisear._split": [[80, 92], ["range", "sum", "len", "cum_sizes.append", "enumerate", "sum", "int", "deisear._hash"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._hash"], ["", "def", "_split", "(", "examples", ",", "sizes", ":", "List", "[", "int", "]", ")", ":", "\n", "    ", "\"\"\"Creates a random split of the data.\"\"\"", "\n", "cum_sizes", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "sizes", ")", ")", ":", "\n", "        ", "cum_sizes", ".", "append", "(", "sum", "(", "sizes", "[", ":", "i", "+", "1", "]", ")", ")", "\n", "", "num_shards", "=", "sum", "(", "sizes", ")", "\n", "for", "example", "in", "examples", ":", "\n", "        ", "h", "=", "int", "(", "_hash", "(", "example", ")", ",", "16", ")", "%", "num_shards", "\n", "for", "index", ",", "size", "in", "enumerate", "(", "cum_sizes", ")", ":", "\n", "            ", "if", "h", "<", "size", ":", "\n", "                ", "yield", "example", ",", "index", "\n", "break", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.deisear.read": [[94, 141], ["data_path.joinpath", "collections.defaultdict", "deisear._split", "data_path.joinpath.open", "csv.DictReader", "collections.defaultdict.items", "deisear.read.get_examples"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._split"], ["", "", "", "", "def", "read", "(", "data_path", ":", "Path", ",", "split", ":", "str", ")", ":", "\n", "    ", "filepath", "=", "data_path", ".", "joinpath", "(", "\"deISEAR_validation.tsv\"", ")", "\n", "texts", "=", "collections", ".", "defaultdict", "(", "list", ")", "\n", "with", "filepath", ".", "open", "(", "\"rt\"", ")", "as", "reader", ":", "\n", "        ", "for", "row", "in", "csv", ".", "DictReader", "(", "\n", "reader", ",", "\n", "delimiter", "=", "\"\\t\"", ",", "\n", ")", ":", "\n", "            ", "text", "=", "row", "[", "\"Sentence\"", "]", "\n", "# fmt: off", "\n", "if", "text", ".", "startswith", "(", "\"Ich f\u00fchlte ..., \"", ")", ":", "\n", "                ", "text", "=", "text", "[", "len", "(", "\"Ich f\u00fchlte ..., \"", ")", ":", "]", "\n", "", "elif", "text", ".", "startswith", "(", "\"ich f\u00fchlte ..., \"", ")", ":", "\n", "                ", "text", "=", "text", "[", "len", "(", "\"ich f\u00fchlte ..., \"", ")", ":", "]", "\n", "", "elif", "text", ".", "startswith", "(", "\"Ich f\u00fchlte ...,,\"", ")", ":", "\n", "                ", "text", "=", "text", "[", "len", "(", "\"Ich f\u00fchlte ...,,\"", ")", ":", "]", "\n", "", "elif", "text", ".", "startswith", "(", "\"Ich f\u00fchlte ... \"", ")", ":", "\n", "                ", "text", "=", "text", "[", "len", "(", "\"Ich f\u00fchlte ... \"", ")", ":", "]", "\n", "", "elif", "text", ".", "startswith", "(", "\"Ich f\u00fchle ..., \"", ")", ":", "\n", "                ", "text", "=", "text", "[", "len", "(", "\"Ich f\u00fchle ..., \"", ")", ":", "]", "\n", "", "elif", "text", ".", "startswith", "(", "\"Ich f\u00fchle ... \"", ")", ":", "\n", "                ", "text", "=", "text", "[", "len", "(", "\"Ich f\u00fchle ... \"", ")", ":", "]", "\n", "", "elif", "text", ".", "startswith", "(", "\"Ich f\u00fchlte mich ..., \"", ")", ":", "\n", "                ", "text", "=", "text", "[", "len", "(", "\"Ich f\u00fchlte mich ..., \"", ")", ":", "]", "\n", "# fmt: on", "\n", "", "texts", "[", "text", "]", ".", "append", "(", "\n", "{", "\n", "\"id\"", ":", "row", "[", "\"Sentence_id\"", "]", ",", "\n", "\"annotation\"", ":", "row", "[", "\"Annotation\"", "]", ",", "\n", "}", "\n", ")", "\n", "\n", "", "", "def", "get_examples", "(", ")", ":", "\n", "        ", "for", "text", ",", "values", "in", "texts", ".", "items", "(", ")", ":", "\n", "            ", "try", ":", "\n", "                ", "label", "=", "_to_emotion_label", "(", "values", ")", "\n", "", "except", "ValueError", ":", "\n", "                ", "continue", "\n", "", "yield", "values", "[", "0", "]", "[", "\"id\"", "]", ",", "{", "\n", "\"text\"", ":", "text", ",", "\n", "\"label\"", ":", "label", ",", "\n", "}", "\n", "\n", "", "", "split_to_index", "=", "{", "\"test\"", ":", "0", ",", "\"dev\"", ":", "1", ",", "\"train\"", ":", "2", "}", "\n", "for", "ex", ",", "split_index", "in", "_split", "(", "get_examples", "(", ")", ",", "[", "1", ",", "1", ",", "1", "]", ")", ":", "\n", "        ", "if", "split_index", "==", "split_to_index", "[", "split", "]", ":", "\n", "            ", "yield", "ex", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.subj.SubjDataset._info": [[106, 120], ["datasets.Features", "datasets.DatasetInfo", "datasets.Value", "datasets.ClassLabel"], "methods", ["None"], ["def", "_info", "(", "self", ")", ":", "\n", "        ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "ClassLabel", "(", "names", "=", "[", "\"subjective\"", ",", "\"objective\"", "]", ")", ",", "\n", "}", ",", "\n", ")", "\n", "return", "datasets", ".", "DatasetInfo", "(", "\n", "description", "=", "_DESCRIPTION", ",", "\n", "features", "=", "features", ",", "\n", "supervised_keys", "=", "None", ",", "\n", "homepage", "=", "_HOMEPAGE", ",", "\n", "license", "=", "_LICENSE", ",", "\n", "citation", "=", "_CITATION", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.subj.SubjDataset._split_generators": [[122, 145], ["dl_manager.download_and_extract", "datasets.SplitGenerator", "datasets.SplitGenerator", "datasets.SplitGenerator"], "methods", ["None"], ["", "def", "_split_generators", "(", "self", ",", "dl_manager", ")", ":", "\n", "        ", "\"\"\"Returns SplitGenerators.\"\"\"", "\n", "data_dir", "=", "dl_manager", ".", "download_and_extract", "(", "_URL", ")", "\n", "return", "[", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"train\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TEST", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"test\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "VALIDATION", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"dev\"", ",", "\n", "}", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.subj.SubjDataset._generate_examples": [[149, 156], ["subj.read", "pathlib.Path"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read"], ["", "def", "_generate_examples", "(", "\n", "self", ",", "\n", "data_dir", ",", "\n", "split", ",", "\n", ")", ":", "\n", "        ", "\"\"\"Yields examples as (key, example) tuples.\"\"\"", "\n", "yield", "from", "read", "(", "Path", "(", "data_dir", ")", ",", "split", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.subj._hash": [[49, 54], ["str().encode", "hashlib.sha256().hexdigest", "str", "hashlib.sha256"], "function", ["None"], ["def", "_hash", "(", "example_with_id", ")", "->", "str", ":", "\n", "    ", "\"\"\"Hashes a single example.\"\"\"", "\n", "key", "=", "example_with_id", "[", "0", "]", ",", "example_with_id", "[", "1", "]", "[", "\"text\"", "]", "\n", "key_bytes", "=", "str", "(", "key", ")", ".", "encode", "(", "\"utf8\"", ")", "\n", "return", "hashlib", ".", "sha256", "(", "key_bytes", ")", ".", "hexdigest", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.subj._split": [[56, 68], ["range", "sum", "len", "cum_sizes.append", "enumerate", "sum", "int", "subj._hash"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._hash"], ["", "def", "_split", "(", "examples", ",", "sizes", ":", "List", "[", "int", "]", ")", ":", "\n", "    ", "\"\"\"Creates a random split of the data.\"\"\"", "\n", "cum_sizes", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "sizes", ")", ")", ":", "\n", "        ", "cum_sizes", ".", "append", "(", "sum", "(", "sizes", "[", ":", "i", "+", "1", "]", ")", ")", "\n", "", "num_shards", "=", "sum", "(", "sizes", ")", "\n", "for", "example", "in", "examples", ":", "\n", "        ", "h", "=", "int", "(", "_hash", "(", "example", ")", ",", "16", ")", "%", "num_shards", "\n", "for", "index", ",", "size", "in", "enumerate", "(", "cum_sizes", ")", ":", "\n", "            ", "if", "h", "<", "size", ":", "\n", "                ", "yield", "example", ",", "index", "\n", "break", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.subj.read": [[70, 91], ["subj._split", "subj.read.get_examples"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._split"], ["", "", "", "", "def", "read", "(", "data_path", ":", "Path", ",", "split", ":", "str", ")", ":", "\n", "    ", "def", "get_examples", "(", ")", ":", "\n", "        ", "for", "label", ",", "name", "in", "[", "\n", "(", "\"subjective\"", ",", "\"quote.tok.gt9.5000\"", ")", ",", "\n", "(", "\"objective\"", ",", "\"plot.tok.gt9.5000\"", ")", ",", "\n", "]", ":", "\n", "            ", "filepath", "=", "data_path", ".", "joinpath", "(", "name", ")", "\n", "with", "filepath", ".", "open", "(", "\"tr\"", ",", "encoding", "=", "\"Windows-1252\"", ")", "as", "reader", ":", "\n", "                ", "for", "index", ",", "line", "in", "enumerate", "(", "reader", ")", ":", "\n", "                    ", "text", "=", "line", ".", "strip", "(", ")", "\n", "if", "not", "text", ":", "\n", "                        ", "continue", "\n", "", "yield", "str", "(", "index", ")", ",", "{", "\n", "\"text\"", ":", "text", ",", "\n", "\"label\"", ":", "label", ",", "\n", "}", "\n", "\n", "", "", "", "", "split_to_index", "=", "{", "\"test\"", ":", "0", ",", "\"dev\"", ":", "1", ",", "\"train\"", ":", "2", "}", "\n", "for", "(", "_id", ",", "ex", ")", ",", "split_index", "in", "_split", "(", "get_examples", "(", ")", ",", "[", "20", ",", "20", ",", "60", "]", ")", ":", "\n", "        ", "if", "split_index", "==", "split_to_index", "[", "split", "]", ":", "\n", "            ", "yield", "f\"{split}_{ex['label']}_{int(_id):05}\"", ",", "ex", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.cola.ColaDataset._info": [[95, 109], ["datasets.Features", "datasets.DatasetInfo", "datasets.Value", "datasets.ClassLabel"], "methods", ["None"], ["def", "_info", "(", "self", ")", ":", "\n", "        ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "ClassLabel", "(", "names", "=", "_labels", ")", ",", "\n", "}", ",", "\n", ")", "\n", "return", "datasets", ".", "DatasetInfo", "(", "\n", "description", "=", "_DESCRIPTION", ",", "\n", "features", "=", "features", ",", "\n", "supervised_keys", "=", "None", ",", "\n", "homepage", "=", "_HOMEPAGE", ",", "\n", "license", "=", "_LICENSE", ",", "\n", "citation", "=", "_CITATION", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.cola.ColaDataset._split_generators": [[111, 127], ["dl_manager.download_and_extract", "datasets.SplitGenerator", "datasets.SplitGenerator"], "methods", ["None"], ["", "def", "_split_generators", "(", "self", ",", "dl_manager", ")", ":", "\n", "        ", "\"\"\"Returns SplitGenerators.\"\"\"", "\n", "data_dir", "=", "dl_manager", ".", "download_and_extract", "(", "_URL", ")", "\n", "return", "[", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"train\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TEST", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"test\"", ",", "\n", "}", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.cola.ColaDataset._generate_examples": [[131, 138], ["cola.read", "pathlib.Path"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read"], ["", "def", "_generate_examples", "(", "\n", "self", ",", "\n", "data_dir", ",", "\n", "split", ",", "\n", ")", ":", "\n", "        ", "\"\"\"Yields examples as (key, example) tuples.\"\"\"", "\n", "yield", "from", "read", "(", "Path", "(", "data_dir", ")", ",", "split", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.cola._to_label": [[51, 53], ["None"], "function", ["None"], ["def", "_to_label", "(", "index", ")", ":", "\n", "    ", "return", "_labels", "[", "index", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.cola.read": [[55, 79], ["data_path.joinpath().with_suffix", "data_path.joinpath().with_suffix.open", "csv.DictReader", "enumerate", "data_path.joinpath", "int", "cola._to_label"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._to_label"], ["", "def", "read", "(", "data_path", ":", "Path", ",", "split", ":", "str", ")", ":", "\n", "    ", "splits_to_filenames", "=", "{", "\n", "\"train\"", ":", "(", "\"in_domain_train\"", ",", ")", ",", "\n", "\"test\"", ":", "(", "\"in_domain_dev\"", ",", "\"out_of_domain_dev\"", ")", ",", "\n", "}", "\n", "\n", "for", "filename", "in", "splits_to_filenames", "[", "split", "]", ":", "\n", "        ", "filepath", "=", "data_path", ".", "joinpath", "(", "\n", "\"cola_public\"", ",", "\"raw\"", ",", "filename", "\n", ")", ".", "with_suffix", "(", "\".tsv\"", ")", "\n", "with", "filepath", ".", "open", "(", "\"rt\"", ")", "as", "reader", ":", "\n", "            ", "rows", "=", "csv", ".", "DictReader", "(", "\n", "reader", ",", "\n", "delimiter", "=", "\"\\t\"", ",", "\n", "fieldnames", "=", "[", "\"id\"", ",", "\"label\"", ",", "\"*\"", ",", "\"text\"", "]", ",", "\n", ")", "\n", "for", "index", ",", "row", "in", "enumerate", "(", "rows", ")", ":", "\n", "                ", "assert", "row", "[", "\"label\"", "]", "\n", "assert", "row", "[", "\"id\"", "]", "\n", "class_index", "=", "int", "(", "row", "[", "\"label\"", "]", ")", "\n", "label", "=", "_to_label", "(", "class_index", ")", "\n", "yield", "f\"{filename}_{row['id']}_{index:04}\"", ",", "{", "\n", "\"text\"", ":", "row", "[", "\"text\"", "]", ",", "\n", "\"label\"", ":", "label", ",", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.zsb.BenchmarkingZeroShotDataDataset._info": [[131, 188], ["datasets.DatasetInfo", "datasets.Features", "datasets.Features", "datasets.Value", "datasets.ClassLabel", "datasets.Features", "NotImplementedError", "datasets.Value", "datasets.ClassLabel", "datasets.Value", "datasets.Sequence", "datasets.Value"], "methods", ["None"], ["def", "_info", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "config", ".", "name", "==", "\"topic\"", ":", "\n", "            ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "ClassLabel", "(", "\n", "names", "=", "[", "\n", "\"Society & Culture\"", ",", "\n", "\"Science & Mathematics\"", ",", "\n", "\"Health\"", ",", "\n", "\"Education & Reference\"", ",", "\n", "\"Computers & Internet\"", ",", "\n", "\"Sports\"", ",", "\n", "\"Business & Finance\"", ",", "\n", "\"Entertainment & Music\"", ",", "\n", "\"Family & Relationships\"", ",", "\n", "\"Politics & Government\"", ",", "\n", "]", "\n", ")", ",", "\n", "}", ",", "\n", ")", "\n", "", "elif", "self", ".", "config", ".", "name", "==", "\"emotion\"", ":", "\n", "            ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "ClassLabel", "(", "\n", "names", "=", "[", "\n", "\"anger\"", ",", "\n", "\"disgust\"", ",", "\n", "\"fear\"", ",", "\n", "\"guilt\"", ",", "\n", "\"joy\"", ",", "\n", "\"love\"", ",", "\n", "\"noemo\"", ",", "\n", "\"sadness\"", ",", "\n", "\"shame\"", ",", "\n", "\"surprise\"", ",", "\n", "]", "\n", ")", ",", "\n", "}", ",", "\n", ")", "\n", "", "elif", "self", ".", "config", ".", "name", "==", "\"situation\"", ":", "\n", "            ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "Sequence", "(", "datasets", ".", "Value", "(", "\"string\"", ")", ")", ",", "\n", "}", ",", "\n", ")", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "(", "self", ".", "config", ".", "name", ")", "\n", "", "return", "datasets", ".", "DatasetInfo", "(", "\n", "description", "=", "_DESCRIPTION", ",", "\n", "features", "=", "features", ",", "\n", "supervised_keys", "=", "None", ",", "\n", "homepage", "=", "_HOMEPAGE", ",", "\n", "license", "=", "_LICENSE", ",", "\n", "citation", "=", "_CITATION", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.zsb.BenchmarkingZeroShotDataDataset._split_generators": [[190, 213], ["dl_manager.download_and_extract", "datasets.SplitGenerator", "datasets.SplitGenerator", "datasets.SplitGenerator"], "methods", ["None"], ["", "def", "_split_generators", "(", "self", ",", "dl_manager", ")", ":", "\n", "        ", "\"\"\"Returns SplitGenerators.\"\"\"", "\n", "data_dir", "=", "dl_manager", ".", "download_and_extract", "(", "_URL", ")", "\n", "return", "[", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"train\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TEST", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"test\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "VALIDATION", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"dev\"", ",", "\n", "}", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.zsb.BenchmarkingZeroShotDataDataset._generate_examples": [[217, 239], ["pathlib.Path().joinpath", "pathlib.Path", "zsb.read", "zsb.read", "NotImplementedError", "zsb.read"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read"], ["", "def", "_generate_examples", "(", "\n", "self", ",", "\n", "data_dir", ",", "\n", "split", ",", "\n", ")", ":", "\n", "        ", "\"\"\"Yields examples as (key, example) tuples.\"\"\"", "\n", "data_path", "=", "Path", "(", "data_dir", ")", ".", "joinpath", "(", "\n", "\"BenchmarkingZeroShot\"", ",", "self", ".", "config", ".", "name", "\n", ")", "\n", "if", "self", ".", "config", ".", "name", "==", "\"topic\"", ":", "\n", "            ", "yield", "from", "read", "(", "data_path", ",", "split", ",", "split_label", "=", "False", ")", "\n", "", "elif", "self", ".", "config", ".", "name", "==", "\"situation\"", ":", "\n", "            ", "yield", "from", "read", "(", "data_path", ",", "split", ",", "split_label", "=", "True", ")", "\n", "", "elif", "self", ".", "config", ".", "name", "==", "\"emotion\"", ":", "\n", "            ", "yield", "from", "read", "(", "\n", "data_path", ",", "\n", "split", ",", "\n", "split_label", "=", "False", ",", "\n", "fieldnames", "=", "[", "\"label\"", ",", "\"tag\"", ",", "\"text\"", "]", ",", "\n", ")", "\n", "", "else", ":", "\n", "            ", "raise", "NotImplementedError", "(", "self", ".", "config", ".", "name", ")", "\n", "", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.zsb.read": [[73, 105], ["data_path.joinpath().exists", "data_path.joinpath().with_suffix", "data_path.joinpath", "data_path.joinpath().open", "data_path.joinpath().with_suffix.open", "csv.DictReader", "enumerate", "line.strip", "data_path.joinpath", "data_path.joinpath", "label_names.append", "line.strip.split", "int"], "function", ["None"], ["def", "read", "(", "\n", "data_path", ":", "Path", ",", "split", ":", "str", ",", "split_label", ":", "bool", ",", "fieldnames", "=", "[", "\"label\"", ",", "\"text\"", "]", "\n", ")", ":", "\n", "    ", "label_names", "=", "None", "\n", "if", "data_path", ".", "joinpath", "(", "\"classes.txt\"", ")", ".", "exists", "(", ")", ":", "\n", "        ", "label_names", "=", "[", "]", "\n", "with", "data_path", ".", "joinpath", "(", "\"classes.txt\"", ")", ".", "open", "(", "\"tr\"", ")", "as", "reader", ":", "\n", "            ", "for", "line", "in", "reader", ":", "\n", "                ", "label", "=", "line", ".", "strip", "(", ")", "\n", "if", "label", ":", "\n", "                    ", "label_names", ".", "append", "(", "label", ")", "\n", "", "", "", "", "filenames", "=", "{", "\n", "\"train\"", ":", "(", "\"train_pu_half_v0\"", ",", "\"train_pu_half_v1\"", ")", ",", "\n", "\"dev\"", ":", "(", "\"dev\"", ",", ")", ",", "\n", "\"test\"", ":", "(", "\"test\"", ",", ")", ",", "\n", "}", "\n", "for", "filename", "in", "filenames", "[", "split", "]", ":", "\n", "        ", "filepath", "=", "data_path", ".", "joinpath", "(", "data_path", ",", "filename", ")", ".", "with_suffix", "(", "\".txt\"", ")", "\n", "with", "filepath", ".", "open", "(", "\"rt\"", ")", "as", "reader", ":", "\n", "            ", "csv_reader", "=", "csv", ".", "DictReader", "(", "\n", "reader", ",", "\n", "delimiter", "=", "\"\\t\"", ",", "\n", "fieldnames", "=", "fieldnames", ",", "\n", ")", "\n", "for", "index", ",", "row", "in", "enumerate", "(", "csv_reader", ")", ":", "\n", "                ", "label", "=", "row", "[", "\"label\"", "]", "\n", "labels", "=", "label", ".", "split", "(", ")", "if", "split_label", "else", "[", "label", "]", "\n", "if", "label_names", ":", "\n", "                    ", "labels", "=", "[", "label_names", "[", "int", "(", "label", ")", "]", "for", "label", "in", "labels", "]", "\n", "", "yield", "f\"{filename}_{index:04}\"", ",", "{", "\n", "\"text\"", ":", "row", "[", "\"text\"", "]", ",", "\n", "\"label\"", ":", "labels", "if", "split_label", "else", "labels", "[", "0", "]", ",", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sb10k.Sb10kDataset._info": [[75, 95], ["datasets.Features", "datasets.DatasetInfo", "datasets.Value", "datasets.ClassLabel"], "methods", ["None"], ["def", "_info", "(", "self", ")", ":", "\n", "        ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "ClassLabel", "(", "\n", "names", "=", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", "\n", ")", ",", "\n", "}", ",", "\n", ")", "\n", "return", "datasets", ".", "DatasetInfo", "(", "\n", "description", "=", "_DESCRIPTION", ",", "\n", "features", "=", "features", ",", "\n", "supervised_keys", "=", "None", ",", "\n", "homepage", "=", "_HOMEPAGE", ",", "\n", "license", "=", "_LICENSE", ",", "\n", "citation", "=", "_CITATION", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sb10k.Sb10kDataset._split_generators": [[97, 113], ["dl_manager.download_and_extract", "datasets.SplitGenerator", "datasets.SplitGenerator"], "methods", ["None"], ["", "def", "_split_generators", "(", "self", ",", "dl_manager", ")", ":", "\n", "        ", "\"\"\"Returns SplitGenerators.\"\"\"", "\n", "data_dir", "=", "dl_manager", ".", "download_and_extract", "(", "_URL", ")", "\n", "return", "[", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"train\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TEST", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"test\"", ",", "\n", "}", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sb10k.Sb10kDataset._generate_examples": [[117, 124], ["sb10k.read", "pathlib.Path"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read"], ["", "def", "_generate_examples", "(", "\n", "self", ",", "\n", "data_dir", ",", "\n", "split", ",", "\n", ")", ":", "\n", "        ", "\"\"\"Yields examples as (key, example) tuples.\"\"\"", "\n", "yield", "from", "read", "(", "Path", "(", "data_dir", ")", ",", "split", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sb10k.read": [[52, 60], ["data_path.joinpath", "data_path.joinpath.open", "csv.reader"], "function", ["None"], ["def", "read", "(", "data_path", ":", "Path", ",", "split", ":", "str", ")", ":", "\n", "    ", "filepath", "=", "data_path", ".", "joinpath", "(", "\"sb10k\"", ",", "f\"de_{split}.tsv\"", ")", "\n", "with", "filepath", ".", "open", "(", "\"rt\"", ")", "as", "reader", ":", "\n", "        ", "for", "row", "in", "csv", ".", "reader", "(", "\n", "reader", ",", "\n", "delimiter", "=", "\"\\t\"", ",", "\n", ")", ":", "\n", "            ", "yield", "row", "[", "0", "]", ",", "{", "\"text\"", ":", "row", "[", "3", "]", ",", "\"label\"", ":", "row", "[", "2", "]", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset": [[42, 150], ["datasets.load_dataset", "datasets.load_dataset", "data.cast.remove_columns", "data.cast.rename_column", "data.cast.rename_column", "data.cast.features.copy", "datasets.ClassLabel", "data.cast.map", "data.cast.cast", "ValueError", "isinstance", "ValueError", "ValueError", "ValueError", "new_features[].str2int", "data.cast.remove_columns", "data.cast.rename_column", "data.cast.features.keys", "data.cast.features.keys", "data.cast.features.keys", "isinstance", "data.cast.features.keys", "data.cast.remove_columns", "data.cast.rename_column", "data.cast.rename_column", "data.cast.features.copy", "datasets.ClassLabel", "data.cast.map", "data.cast.cast"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.load_dataset"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.get_english_datasets": [[152, 169], ["None"], "function", ["None"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.get_german_datasets": [[172, 177], ["None"], "function", ["None"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.__init__.get_spanish_datasets": [[180, 183], ["None"], "function", ["None"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.SabDataset._info": [[175, 211], ["datasets.Features", "datasets.DatasetInfo", "datasets.Value", "datasets.ClassLabel", "datasets.ClassLabel"], "methods", ["None"], ["def", "_info", "(", "self", ")", ":", "\n", "        ", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "(", "\n", "datasets", ".", "ClassLabel", "(", "\n", "names", "=", "[", "\n", "\"positive\"", ",", "\n", "\"neutral\"", ",", "\n", "\"negative\"", ",", "\n", "]", "\n", ")", "\n", "if", "self", ".", "config", ".", "name", "==", "\"sentiment\"", "\n", "else", "datasets", ".", "ClassLabel", "(", "\n", "names", "=", "[", "\n", "\"hate\"", ",", "\n", "\"dissatisfaction\"", ",", "\n", "\"love\"", ",", "\n", "\"satisfaction\"", ",", "\n", "\"happiness\"", ",", "\n", "\"sadness\"", ",", "\n", "\"fear\"", ",", "\n", "\"trust\"", ",", "\n", "\"no_emotion\"", ",", "\n", "]", "\n", ")", "\n", ")", ",", "\n", "}", ",", "\n", ")", "\n", "return", "datasets", ".", "DatasetInfo", "(", "\n", "description", "=", "_DESCRIPTION", ",", "\n", "features", "=", "features", ",", "\n", "supervised_keys", "=", "None", ",", "\n", "homepage", "=", "_HOMEPAGE", ",", "\n", "license", "=", "_LICENSE", ",", "\n", "citation", "=", "_CITATION", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.SabDataset._split_generators": [[213, 236], ["dl_manager.download_and_extract", "datasets.SplitGenerator", "datasets.SplitGenerator", "datasets.SplitGenerator"], "methods", ["None"], ["", "def", "_split_generators", "(", "self", ",", "dl_manager", ")", ":", "\n", "        ", "\"\"\"Returns SplitGenerators.\"\"\"", "\n", "data_dir", "=", "dl_manager", ".", "download_and_extract", "(", "_URL", ")", "\n", "return", "[", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"train\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TEST", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"test\"", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "VALIDATION", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "\"dev\"", ",", "\n", "}", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.SabDataset._generate_examples": [[240, 247], ["sab.read", "pathlib.Path"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read"], ["", "def", "_generate_examples", "(", "\n", "self", ",", "\n", "data_dir", ",", "\n", "split", ",", "\n", ")", ":", "\n", "        ", "\"\"\"Yields examples as (key, example) tuples.\"\"\"", "\n", "yield", "from", "read", "(", "Path", "(", "data_dir", ")", ",", "split", ",", "self", ".", "config", ".", "name", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._hash": [[55, 60], ["str().encode", "hashlib.sha256().hexdigest", "str", "hashlib.sha256"], "function", ["None"], ["def", "_hash", "(", "example_with_id", ")", "->", "str", ":", "\n", "    ", "\"\"\"Hashes a single example.\"\"\"", "\n", "key", "=", "example_with_id", "[", "0", "]", ",", "example_with_id", "[", "1", "]", "[", "\"text\"", "]", "\n", "key_bytes", "=", "str", "(", "key", ")", ".", "encode", "(", "\"utf8\"", ")", "\n", "return", "hashlib", ".", "sha256", "(", "key_bytes", ")", ".", "hexdigest", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._split": [[62, 74], ["range", "sum", "len", "cum_sizes.append", "enumerate", "sum", "int", "sab._hash"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._hash"], ["", "def", "_split", "(", "examples", ",", "sizes", ":", "List", "[", "int", "]", ")", ":", "\n", "    ", "\"\"\"Creates a random split of the data.\"\"\"", "\n", "cum_sizes", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "sizes", ")", ")", ":", "\n", "        ", "cum_sizes", ".", "append", "(", "sum", "(", "sizes", "[", ":", "i", "+", "1", "]", ")", ")", "\n", "", "num_shards", "=", "sum", "(", "sizes", ")", "\n", "for", "example", "in", "examples", ":", "\n", "        ", "h", "=", "int", "(", "_hash", "(", "example", ")", ",", "16", ")", "%", "num_shards", "\n", "for", "index", ",", "size", "in", "enumerate", "(", "cum_sizes", ")", ":", "\n", "            ", "if", "h", "<", "size", ":", "\n", "                ", "yield", "example", ",", "index", "\n", "break", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._to_label": [[108, 110], ["None"], "function", ["None"], ["def", "_to_label", "(", "v", ")", ":", "\n", "    ", "return", "_labels", "[", "v", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._get_first": [[112, 116], ["len", "ValueError"], "function", ["None"], ["", "def", "_get_first", "(", "elements", ")", ":", "\n", "    ", "if", "len", "(", "elements", ")", "!=", "1", ":", "\n", "        ", "raise", "ValueError", "(", "elements", ")", "\n", "", "return", "elements", "[", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab.read": [[118, 153], ["data_path.joinpath", "rdflib.Graph", "rdflib.Graph.parse", "collections.defaultdict", "sab._split", "str", "_properties.items", "data.values", "sab.read.get_examples"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.sab._split"], ["", "def", "read", "(", "data_path", ":", "Path", ",", "split", ":", "str", ",", "task", ":", "str", ")", ":", "\n", "    ", "filepath", "=", "data_path", ".", "joinpath", "(", "\"corpus.n3\"", ")", "\n", "g", "=", "rdflib", ".", "Graph", "(", ")", "\n", "g", ".", "parse", "(", "str", "(", "filepath", ")", ",", "format", "=", "\"n3\"", ")", "\n", "data", ":", "DefaultDict", "[", "str", ",", "Dict", "[", "str", ",", "List", "[", "str", "]", "]", "]", "=", "collections", ".", "defaultdict", "(", "dict", ")", "\n", "for", "subj", ",", "predicate", ",", "obj", "in", "g", ":", "\n", "        ", "for", "propert_name", ",", "property_id", "in", "_properties", ".", "items", "(", ")", ":", "\n", "            ", "if", "str", "(", "predicate", ")", "==", "property_id", ":", "\n", "                ", "if", "propert_name", "not", "in", "data", "[", "subj", "]", ":", "\n", "                    ", "data", "[", "subj", "]", "[", "propert_name", "]", "=", "[", "]", "\n", "", "data", "[", "subj", "]", "[", "propert_name", "]", ".", "append", "(", "str", "(", "obj", ")", ")", "\n", "break", "\n", "\n", "", "", "", "def", "get_examples", "(", ")", ":", "\n", "        ", "for", "datum", "in", "data", ".", "values", "(", ")", ":", "\n", "            ", "if", "\"sentiment\"", "not", "in", "datum", ":", "\n", "                ", "datum", "[", "\"sentiment\"", "]", "=", "[", "\"neutral\"", "]", "\n", "", "if", "task", "==", "\"sentiment\"", ":", "\n", "                ", "labels", "=", "[", "_to_label", "(", "v", ")", "for", "v", "in", "datum", "[", "\"sentiment\"", "]", "]", "\n", "", "elif", "task", "==", "\"emotion\"", ":", "\n", "                ", "labels", "=", "[", "_to_label", "(", "v", ")", "for", "v", "in", "datum", "[", "\"emotion\"", "]", "]", "\n", "", "else", ":", "\n", "                ", "raise", "NotImplementedError", "(", "labels", ")", "\n", "", "if", "len", "(", "labels", ")", "!=", "1", ":", "\n", "                ", "continue", "\n", "", "yield", "_get_first", "(", "datum", "[", "\"id\"", "]", ")", ",", "{", "\n", "\"text\"", ":", "_get_first", "(", "datum", "[", "\"content\"", "]", ")", ",", "\n", "\"label\"", ":", "labels", "[", "0", "]", ",", "\n", "}", "\n", "\n", "", "", "examples_with_split", "=", "_split", "(", "get_examples", "(", ")", ",", "[", "10", ",", "10", ",", "80", "]", ")", "\n", "split_to_index", "=", "{", "\"test\"", ":", "0", ",", "\"dev\"", ":", "1", ",", "\"train\"", ":", "2", "}", "\n", "for", "(", "(", "_id", ",", "ex", ")", ",", "split_index", ")", "in", "examples_with_split", ":", "\n", "        ", "if", "split_index", "==", "split_to_index", "[", "split", "]", ":", "\n", "            ", "yield", "_id", ",", "ex", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.SemEval2016TaskA.Semeval2016Dataset._info": [[59, 78], ["datasets.DatasetInfo", "datasets.Features", "datasets.Value", "datasets.ClassLabel"], "methods", ["None"], ["def", "_info", "(", "self", ")", ":", "\n", "        ", "return", "datasets", ".", "DatasetInfo", "(", "\n", "description", "=", "_DESCRIPTION", ",", "\n", "features", "=", "datasets", ".", "Features", "(", "\n", "{", "\n", "\"text\"", ":", "datasets", ".", "Value", "(", "\"string\"", ")", ",", "\n", "\"label\"", ":", "datasets", ".", "ClassLabel", "(", "\n", "names", "=", "[", "\n", "\"positive\"", ",", "\n", "\"negative\"", ",", "\n", "\"neutral\"", ",", "\n", "]", "\n", ")", ",", "\n", "}", ",", "\n", ")", ",", "\n", "supervised_keys", "=", "None", ",", "\n", "homepage", "=", "_HOMEPAGE", ",", "\n", "license", "=", "_LICENSE", ",", "\n", "citation", "=", "_CITATION", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.SemEval2016TaskA.Semeval2016Dataset._split_generators": [[80, 103], ["dl_manager.download_and_extract", "datasets.SplitGenerator", "datasets.SplitGenerator", "datasets.SplitGenerator"], "methods", ["None"], ["", "def", "_split_generators", "(", "self", ",", "dl_manager", ")", ":", "\n", "        ", "\"\"\"Returns SplitGenerators.\"\"\"", "\n", "data_dir", "=", "dl_manager", ".", "download_and_extract", "(", "_URL", ")", "\n", "return", "[", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "datasets", ".", "Split", ".", "TRAIN", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "TEST", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "datasets", ".", "Split", ".", "TEST", ",", "\n", "}", ",", "\n", ")", ",", "\n", "datasets", ".", "SplitGenerator", "(", "\n", "name", "=", "datasets", ".", "Split", ".", "VALIDATION", ",", "\n", "gen_kwargs", "=", "{", "\n", "\"data_dir\"", ":", "data_dir", ",", "\n", "\"split\"", ":", "datasets", ".", "Split", ".", "VALIDATION", ",", "\n", "}", ",", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.datasets.SemEval2016TaskA.Semeval2016Dataset._generate_examples": [[107, 134], ["pathlib.Path().joinpath", "pathlib.Path().joinpath.joinpath", "pathlib.Path", "Path().joinpath.joinpath.open", "enumerate", "csv.reader"], "methods", ["None"], ["", "def", "_generate_examples", "(", "\n", "self", ",", "\n", "data_dir", ",", "\n", "split", ",", "\n", ")", ":", "\n", "        ", "\"\"\"Yields examples as (key, example) tuples.\"\"\"", "\n", "data_path", "=", "Path", "(", "data_dir", ")", ".", "joinpath", "(", "\n", "\"2017_English_final\"", ",", "\"GOLD\"", ",", "\"Subtask_A\"", "\n", ")", "\n", "filenames", "=", "{", "\n", "datasets", ".", "Split", ".", "TRAIN", ":", "[", "\"twitter-2016train-A.txt\"", "]", ",", "\n", "datasets", ".", "Split", ".", "VALIDATION", ":", "[", "\n", "\"twitter-2016dev-A.txt\"", ",", "\n", "\"twitter-2016devtest-A.txt\"", ",", "\n", "]", ",", "\n", "datasets", ".", "Split", ".", "TEST", ":", "[", "\"twitter-2016test-A.txt\"", "]", ",", "\n", "}", "\n", "for", "filename", "in", "filenames", "[", "split", "]", ":", "\n", "            ", "path", "=", "data_path", ".", "joinpath", "(", "filename", ")", "\n", "with", "path", ".", "open", "(", "\"rt\"", ")", "as", "reader", ":", "\n", "                ", "for", "_id", ",", "row", "in", "enumerate", "(", "\n", "csv", ".", "reader", "(", "\n", "reader", ",", "\n", "delimiter", "=", "\"\\t\"", ",", "\n", ")", "\n", ")", ":", "\n", "                    ", "yield", "f\"{_id}_{row[0]}\"", ",", "{", "\"text\"", ":", "row", "[", "2", "]", ",", "\"label\"", ":", "row", "[", "1", "]", "}", "\n", "", "", "", "", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.DualEncoderPredictor.__init__": [[26, 33], ["importlib.import_module", "importlib.import_module.load_model", "model_config.get"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.load_model"], ["    ", "def", "__init__", "(", "self", ",", "model_config", ")", ":", "\n", "        ", "module_name", "=", "model_config", "[", "\"module\"", "]", "\n", "module", "=", "importlib", ".", "import_module", "(", "\n", "f\"symanto_fsb.models.siamese_models.{module_name}\"", "\n", ")", "\n", "self", ".", "model", "=", "module", ".", "load_model", "(", "model_config", ")", "# type: Model", "\n", "self", ".", "batch_size", "=", "model_config", ".", "get", "(", "\"batch_size\"", ",", "32", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.DualEncoderPredictor.score": [[34, 53], ["dual_encoder.DualEncoderPredictor.model.encode_batch", "tqdm.tqdm.tqdm", "numpy.concatenate", "list", "len", "len", "symanto_fsb.models.predictors.batch", "dual_encoder.DualEncoderPredictor.model.encode_batch", "numpy.inner", "matrixes.append", "hypotheses.values", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.encode_batch", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.__init__.batch", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.encode_batch"], ["", "def", "score", "(", "\n", "self", ",", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "examples", ":", "List", "[", "dict", "]", ",", "\n", ")", "->", "List", "[", "int", "]", ":", "\n", "        ", "hypothesis_encodings", "=", "self", ".", "model", ".", "encode_batch", "(", "\n", "list", "(", "hypotheses", ".", "values", "(", ")", ")", "\n", ")", "\n", "assert", "len", "(", "hypotheses", ")", "==", "len", "(", "hypothesis_encodings", ")", "\n", "matrixes", "=", "[", "]", "\n", "for", "batched_examples", "in", "tqdm", "(", "\n", "batch", "(", "examples", ",", "batch_size", "=", "self", ".", "batch_size", ")", ",", "\n", "total", "=", "len", "(", "examples", ")", "//", "self", ".", "batch_size", ",", "\n", ")", ":", "\n", "            ", "text", "=", "[", "e", "[", "\"text\"", "]", "for", "e", "in", "batched_examples", "]", "\n", "example_encodings", "=", "self", ".", "model", ".", "encode_batch", "(", "text", ")", "\n", "matrix", "=", "np", ".", "inner", "(", "example_encodings", ",", "hypothesis_encodings", ")", "\n", "matrixes", ".", "append", "(", "matrix", ")", "\n", "", "return", "np", ".", "concatenate", "(", "matrixes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.DualEncoderPredictor.predict": [[54, 64], ["dual_encoder.DualEncoderPredictor.score", "numpy.argmax", "numpy.argmax.tolist", "len", "len"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.DualEncoderPredictor.score"], ["", "def", "predict", "(", "\n", "self", ",", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "examples", ":", "List", "[", "dict", "]", ",", "\n", ")", "->", "List", "[", "int", "]", ":", "\n", "        ", "matrix", "=", "self", ".", "score", "(", "hypotheses", ",", "examples", ")", "\n", "indexes", "=", "np", ".", "argmax", "(", "matrix", ",", "axis", "=", "1", ")", "\n", "p_labels", "=", "indexes", ".", "tolist", "(", ")", "\n", "assert", "len", "(", "p_labels", ")", "==", "len", "(", "examples", ")", "\n", "return", "p_labels", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.DualEncoderPredictor.num_parameters": [[65, 67], ["dual_encoder.DualEncoderPredictor.model.num_parameters"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.DualEncoderPredictor.num_parameters"], ["", "def", "num_parameters", "(", "self", ")", "->", "int", ":", "\n", "        ", "return", "self", ".", "model", ".", "num_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.DualEncoderPredictor.few_shot": [[68, 77], ["dual_encoder.DualEncoderPredictor.model.few_shot"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.few_shot"], ["", "def", "few_shot", "(", "\n", "self", ",", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "examples", ":", "List", "[", "dict", "]", ",", "\n", ")", ":", "\n", "        ", "self", ".", "model", ".", "few_shot", "(", "\n", "hypotheses", ",", "\n", "examples", ",", "\n", "self", ".", "batch_size", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.dual_encoder.build_predictor": [[80, 82], ["dual_encoder.DualEncoderPredictor"], "function", ["None"], ["", "", "def", "build_predictor", "(", "model_config", ")", "->", "Predictor", ":", "\n", "    ", "return", "DualEncoderPredictor", "(", "model_config", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.__init__.Predictor.predict": [[31, 64], ["None"], "methods", ["None"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.__init__.Predictor.few_shot": [[65, 92], ["NotImplementedError"], "methods", ["None"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.__init__.batch": [[19, 28], ["batch.append", "len"], "function", ["None"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.CharSvmPredictor.__init__": [[35, 37], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "self", ".", "pipeline", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.CharSvmPredictor.predict": [[38, 49], ["char_svm.to_arrays", "char_svm.CharSvmPredictor.pipeline.predict", "ValueError"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.to_arrays", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.CharSvmPredictor.predict"], ["", "def", "predict", "(", "\n", "self", ",", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "examples", ":", "List", "[", "dict", "]", ",", "\n", ")", "->", "List", "[", "int", "]", ":", "\n", "        ", "del", "hypotheses", "\n", "if", "self", ".", "pipeline", "is", "None", ":", "\n", "            ", "raise", "ValueError", "(", "\"Attempting to use an untrained model.\"", ")", "\n", "", "x", ",", "_", "=", "to_arrays", "(", "examples", ")", "\n", "y", "=", "self", ".", "pipeline", ".", "predict", "(", "x", ")", "\n", "return", "[", "self", ".", "label_to_index", "[", "label", "]", "for", "label", "in", "y", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.CharSvmPredictor.few_shot": [[50, 67], ["sklearn.pipeline.Pipeline", "char_svm.to_arrays", "char_svm.CharSvmPredictor.pipeline.fit", "enumerate", "sklearn.feature_extraction.text.TfidfVectorizer", "sklearn.svm.LinearSVC", "hypotheses.keys"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.to_arrays"], ["", "def", "few_shot", "(", "\n", "self", ",", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "examples", ":", "List", "[", "dict", "]", ",", "\n", ")", ":", "\n", "        ", "self", ".", "pipeline", "=", "Pipeline", "(", "\n", "[", "\n", "(", "\n", "\"charngrams\"", ",", "\n", "TfidfVectorizer", "(", "analyzer", "=", "\"char\"", ",", "ngram_range", "=", "(", "2", ",", "5", ")", ")", ",", "\n", ")", ",", "\n", "(", "\"clf\"", ",", "LinearSVC", "(", ")", ")", ",", "\n", "]", "\n", ")", "\n", "train_x", ",", "train_y", "=", "to_arrays", "(", "examples", ")", "\n", "self", ".", "pipeline", ".", "fit", "(", "train_x", ",", "train_y", ")", "\n", "self", ".", "label_to_index", "=", "{", "l", ":", "i", "for", "i", ",", "l", "in", "enumerate", "(", "hypotheses", ".", "keys", "(", ")", ")", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.to_arrays": [[25, 32], ["x.append", "y.append", "numpy.array", "numpy.array"], "function", ["None"], ["def", "to_arrays", "(", "examples", ":", "List", "[", "dict", "]", ")", ":", "\n", "    ", "x", "=", "[", "]", "\n", "y", "=", "[", "]", "\n", "for", "example", "in", "examples", ":", "\n", "        ", "x", ".", "append", "(", "example", "[", "\"text\"", "]", ")", "\n", "y", ".", "append", "(", "example", "[", "\"label\"", "]", ")", "\n", "", "return", "np", ".", "array", "(", "x", ")", ",", "np", ".", "array", "(", "y", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.predictors.char_svm.build_predictor": [[69, 72], ["char_svm.CharSvmPredictor"], "function", ["None"], ["", "", "def", "build_predictor", "(", "model_config", ")", "->", "Predictor", ":", "\n", "    ", "del", "model_config", "\n", "return", "CharSvmPredictor", "(", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._mf1": [[23, 25], ["sklearn.metrics.f1_score"], "function", ["None"], ["def", "_mf1", "(", "x", ",", "y", ")", ":", "\n", "    ", "return", "f1_score", "(", "x", ",", "y", ",", "average", "=", "\"macro\"", ")", "*", "100.0", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_loss": [[27, 57], ["tensorflow.debugging.assert_all_finite", "tensorflow.debugging.assert_all_finite", "tensorflow.debugging.assert_all_finite", "tensorflow.matmul", "tensorflow.debugging.assert_all_finite", "tensorflow.debugging.assert_all_finite", "tensorflow.reduce_mean", "tensorflow.random.uniform", "tensorflow.where", "tensorflow.transpose", "len", "tensorflow.nn.sparse_softmax_cross_entropy_with_logits", "tensorflow.nn.softmax_cross_entropy_with_logits", "tensorflow.ones_like", "tensorflow.zeros_like", "tensorflow.expand_dims"], "function", ["None"], ["", "def", "_get_loss", "(", "text_embeddings", ",", "text_labels", ",", "label_embeddings", ",", "dropout", ":", "float", ")", ":", "\n", "    ", "\"\"\"\n    Args:\n        text_embeddings: float[N, k]\n        text_labels: float[N,K]\n        label_embeddings: float[K, k]\n        dropout: Dropout rate for class embeddings. 0.0 for none.\n    \"\"\"", "\n", "tf", ".", "debugging", ".", "assert_all_finite", "(", "text_embeddings", ",", "\"Text embeddings is NaN\"", ")", "\n", "tf", ".", "debugging", ".", "assert_all_finite", "(", "label_embeddings", ",", "\"Label embeddings is NaN\"", ")", "\n", "# 1. Compute dot product between every text and every class.", "\n", "embedding_dim", "=", "label_embeddings", ".", "shape", "[", "1", "]", "\n", "if", "dropout", ">", "0.0", ":", "\n", "        ", "r", "=", "tf", ".", "random", ".", "uniform", "(", "shape", "=", "(", "embedding_dim", ",", ")", ")", "\n", "dp_mask", "=", "tf", ".", "where", "(", "r", ">", "dropout", ",", "tf", ".", "ones_like", "(", "r", ")", ",", "tf", ".", "zeros_like", "(", "r", ")", ")", "\n", "label_embeddings", "=", "label_embeddings", "*", "tf", ".", "expand_dims", "(", "dp_mask", ",", "axis", "=", "0", ")", "\n", "", "tf", ".", "debugging", ".", "assert_all_finite", "(", "label_embeddings", ",", "\"Label embeddings is NaN\"", ")", "\n", "# float[N,K]", "\n", "dot_products", "=", "tf", ".", "matmul", "(", "text_embeddings", ",", "tf", ".", "transpose", "(", "label_embeddings", ")", ")", "\n", "tf", ".", "debugging", ".", "assert_all_finite", "(", "dot_products", ",", "\"Dot product is NaN\"", ")", "\n", "if", "len", "(", "text_labels", ".", "shape", ")", "==", "1", ":", "\n", "        ", "loss_per_example", "=", "tf", ".", "nn", ".", "sparse_softmax_cross_entropy_with_logits", "(", "\n", "text_labels", ",", "dot_products", "\n", ")", "\n", "", "else", ":", "\n", "        ", "loss_per_example", "=", "tf", ".", "nn", ".", "softmax_cross_entropy_with_logits", "(", "\n", "text_labels", ",", "dot_products", "\n", ")", "\n", "", "tf", ".", "debugging", ".", "assert_all_finite", "(", "loss_per_example", ",", "\"Loss per example is NaN\"", ")", "\n", "return", "tf", ".", "reduce_mean", "(", "loss_per_example", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.label_tuning": [[59, 107], ["tensorflow.constant", "tensorflow.constant", "tensorflow.constant", "range", "label_embeddings.numpy.numpy", "ValueError", "ValueError", "tensorflow.GradientTape", "tape.watch", "label_tuning._get_loss", "tensorflow.reduce_mean", "tape.gradient"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_loss"], ["", "def", "label_tuning", "(", "\n", "text_embeddings", ",", "\n", "text_labels", ",", "\n", "label_embeddings", ",", "\n", "n_steps", ":", "int", ",", "\n", "reg_coefficient", ":", "float", ",", "\n", "learning_rate", ":", "float", ",", "\n", "dropout", ":", "float", ",", "\n", ")", "->", "np", ".", "ndarray", ":", "\n", "    ", "\"\"\"\n    With N as number of examples, K as number of classes, k as embedding dimension.\n\n    Args:\n        'text_embeddings': float[N,k] of embedded texts\n        'text_labels': float[N,K] class score for each example.\n        'label_embeddings': float[K,k] class embeddings\n    Returns:\n        float[K,k] updated class embeddings\n    \"\"\"", "\n", "if", "text_embeddings", ".", "shape", "[", "0", "]", "==", "0", ":", "\n", "        ", "raise", "ValueError", "(", "text_embeddings", ".", "shape", ")", "\n", "", "if", "label_embeddings", ".", "shape", "[", "0", "]", "==", "0", ":", "\n", "        ", "raise", "ValueError", "(", "label_embeddings", ".", "shape", ")", "\n", "\n", "", "text_embeddings", "=", "tf", ".", "constant", "(", "text_embeddings", ")", "\n", "text_labels", "=", "tf", ".", "constant", "(", "text_labels", ")", "\n", "label_embeddings", "=", "tf", ".", "constant", "(", "label_embeddings", ")", "\n", "\n", "init_label_embeddings", "=", "label_embeddings", "\n", "\n", "for", "i", "in", "range", "(", "n_steps", ")", ":", "\n", "        ", "with", "tf", ".", "GradientTape", "(", ")", "as", "tape", ":", "\n", "            ", "tape", ".", "watch", "(", "label_embeddings", ")", "\n", "dot_loss", "=", "_get_loss", "(", "\n", "text_embeddings", ",", "\n", "text_labels", ",", "\n", "label_embeddings", ",", "\n", "dropout", "=", "dropout", ",", "\n", ")", "\n", "drift_loss", "=", "tf", ".", "reduce_mean", "(", "\n", "(", "label_embeddings", "-", "init_label_embeddings", ")", "**", "2", "\n", ")", "\n", "total_loss", "=", "dot_loss", "+", "reg_coefficient", "*", "drift_loss", "\n", "gradient", "=", "tape", ".", "gradient", "(", "total_loss", "+", "drift_loss", ",", "label_embeddings", ")", "\n", "label_embeddings", "=", "label_embeddings", "-", "(", "learning_rate", "*", "gradient", ")", "\n", "\n", "", "", "label_embeddings", "=", "label_embeddings", ".", "numpy", "(", ")", "\n", "return", "label_embeddings", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_configs": [[109, 126], ["param_spaces.items", "config.copy.copy", "new_configs.append"], "function", ["None"], ["", "def", "_get_configs", "(", ")", ":", "\n", "    ", "configs", "=", "[", "{", "}", "]", "\n", "param_spaces", "=", "{", "\n", "\"dropout\"", ":", "[", "0.01", ",", "0.1", "]", ",", "\n", "\"learning_rate\"", ":", "[", "0.5", ",", "0.05", "]", ",", "\n", "\"reg_coefficient\"", ":", "[", "0.1", ",", "0.01", "]", ",", "\n", "\"n_steps\"", ":", "[", "1000", ",", "2000", "]", ",", "\n", "}", "\n", "for", "param", ",", "space", "in", "param_spaces", ".", "items", "(", ")", ":", "\n", "        ", "new_configs", "=", "[", "]", "\n", "for", "config", "in", "configs", ":", "\n", "            ", "for", "value", "in", "space", ":", "\n", "                ", "config", "=", "config", ".", "copy", "(", ")", "\n", "config", "[", "param", "]", "=", "value", "\n", "new_configs", ".", "append", "(", "config", ")", "\n", "", "", "configs", "=", "new_configs", "\n", "", "return", "configs", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.macro_f1_score": [[128, 133], ["numpy.inner", "np.inner.argmax", "text_labels.argmax", "label_tuning._mf1"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._mf1"], ["", "def", "macro_f1_score", "(", "text_embeddings", ",", "text_labels", ",", "label_embeddings", ")", ":", "\n", "    ", "scores", "=", "np", ".", "inner", "(", "text_embeddings", ",", "label_embeddings", ")", "\n", "predictions", "=", "scores", ".", "argmax", "(", "axis", "=", "-", "1", ")", "\n", "references", "=", "text_labels", ".", "argmax", "(", "axis", "=", "-", "1", ")", "\n", "return", "_mf1", "(", "references", ",", "predictions", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_complement": [[135, 141], ["set", "set.difference_update", "sorted", "set.update"], "function", ["None"], ["", "def", "_get_complement", "(", "folds", ":", "List", "[", "List", "[", "int", "]", "]", ",", "fold", ":", "List", "[", "int", "]", ")", "->", "List", "[", "int", "]", ":", "\n", "    ", "complement", "=", "set", "(", ")", "\n", "for", "other_fold", "in", "folds", ":", "\n", "        ", "complement", ".", "update", "(", "other_fold", ")", "\n", "", "complement", ".", "difference_update", "(", "fold", ")", "\n", "return", "sorted", "(", "complement", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._evaluate_hparams": [[143, 167], ["enumerate", "numpy.concatenate", "numpy.concatenate", "label_tuning._mf1", "label_tuning._get_complement", "label_tuning.label_tuning", "numpy.inner", "np.concatenate.append", "np.concatenate.append", "len", "np.inner.argmax", "text_labels[].argmax", "len", "len"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._mf1", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_complement", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.label_tuning"], ["", "def", "_evaluate_hparams", "(", "\n", "text_embeddings", ",", "text_labels", ",", "label_embeddings", ",", "folds", ",", "hparams", "\n", ")", ":", "\n", "    ", "predictions", "=", "[", "]", "\n", "references", "=", "[", "]", "\n", "for", "fold_index", ",", "test_indexes", "in", "enumerate", "(", "folds", ")", ":", "\n", "        ", "train_indexes", "=", "_get_complement", "(", "folds", ",", "test_indexes", ")", "\n", "assert", "len", "(", "train_indexes", ")", "+", "len", "(", "test_indexes", ")", "==", "len", "(", "text_labels", ")", "\n", "tr_text_embeddings", "=", "text_embeddings", "[", "train_indexes", "]", "\n", "tr_text_labels", "=", "text_labels", "[", "train_indexes", "]", "\n", "new_label_embeddings", "=", "label_tuning", "(", "\n", "tr_text_embeddings", ",", "\n", "tr_text_labels", ",", "\n", "label_embeddings", ",", "\n", "**", "hparams", ",", "\n", ")", "\n", "te_text_embeddings", "=", "text_embeddings", "[", "test_indexes", "]", "\n", "scores", "=", "np", ".", "inner", "(", "te_text_embeddings", ",", "new_label_embeddings", ")", "\n", "predictions", ".", "append", "(", "scores", ".", "argmax", "(", "-", "1", ")", ")", "\n", "references", ".", "append", "(", "text_labels", "[", "test_indexes", "]", ".", "argmax", "(", "-", "1", ")", ")", "\n", "", "references", "=", "np", ".", "concatenate", "(", "references", ",", "axis", "=", "0", ")", "\n", "predictions", "=", "np", ".", "concatenate", "(", "predictions", ",", "axis", "=", "0", ")", "\n", "mf1", "=", "_mf1", "(", "references", ",", "predictions", ")", "\n", "return", "mf1", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.find_hparams": [[169, 232], ["collections.defaultdict", "enumerate", "collections.defaultdict.values", "label_tuning.macro_f1_score", "numpy.argmax", "numpy.argmax", "index_by_class[].append", "enumerate", "label_tuning._get_configs", "enumerate", "ProcessPoolExecutor", "enumerate", "round", "round", "range", "folds[].append", "label_tuning._evaluate_hparams", "mf1s.append", "mf1s_futures.append", "mf1.result.result", "mf1s.append", "ProcessPoolExecutor.submit"], "function", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.macro_f1_score", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._get_configs", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning._evaluate_hparams"], ["", "def", "find_hparams", "(", "\n", "text_embeddings", ",", "\n", "text_labels", ",", "\n", "label_embeddings", ",", "\n", "num_folds", ":", "int", ",", "\n", "configs", ":", "Optional", "[", "List", "[", "dict", "]", "]", "=", "None", ",", "\n", "n_workers", ":", "int", "=", "1", ",", "\n", ")", "->", "dict", ":", "\n", "\n", "    ", "index_by_class", "=", "collections", ".", "defaultdict", "(", "list", ")", "\n", "for", "index", ",", "scores", "in", "enumerate", "(", "text_labels", ")", ":", "\n", "        ", "class_index", "=", "np", ".", "argmax", "(", "scores", ")", "\n", "index_by_class", "[", "class_index", "]", ".", "append", "(", "index", ")", "\n", "\n", "", "folds", ":", "List", "[", "List", "[", "int", "]", "]", "=", "[", "[", "]", "for", "_", "in", "range", "(", "num_folds", ")", "]", "\n", "for", "indexes", "in", "index_by_class", ".", "values", "(", ")", ":", "\n", "        ", "for", "pos", ",", "index", "in", "enumerate", "(", "indexes", ")", ":", "\n", "            ", "folds", "[", "pos", "%", "num_folds", "]", ".", "append", "(", "index", ")", "\n", "\n", "", "", "initial_mf1", "=", "macro_f1_score", "(", "text_embeddings", ",", "text_labels", ",", "label_embeddings", ")", "\n", "\n", "if", "configs", "is", "None", ":", "\n", "        ", "configs", "=", "_get_configs", "(", ")", "\n", "\n", "", "if", "n_workers", "<=", "1", ":", "\n", "        ", "mf1s", "=", "[", "]", "\n", "for", "index", ",", "hparams", "in", "enumerate", "(", "configs", ")", ":", "\n", "            ", "mf1", "=", "_evaluate_hparams", "(", "\n", "text_embeddings", ",", "\n", "text_labels", ",", "\n", "label_embeddings", ",", "\n", "folds", ",", "\n", "hparams", ",", "\n", ")", "\n", "mf1s", ".", "append", "(", "mf1", ")", "\n", "", "", "else", ":", "\n", "        ", "from", "concurrent", ".", "futures", "import", "ProcessPoolExecutor", "\n", "\n", "mf1s_futures", "=", "[", "]", "\n", "exec", "=", "ProcessPoolExecutor", "(", "n_workers", ")", "\n", "for", "hparams", "in", "configs", ":", "\n", "            ", "mf1s_futures", ".", "append", "(", "\n", "exec", ".", "submit", "(", "\n", "_evaluate_hparams", ",", "\n", "text_embeddings", ",", "\n", "text_labels", ",", "\n", "label_embeddings", ",", "\n", "folds", ",", "\n", "hparams", ",", "\n", ")", "\n", ")", "\n", "\n", "", "mf1s", "=", "[", "]", "\n", "for", "index", ",", "mf1", "in", "enumerate", "(", "mf1s_futures", ")", ":", "\n", "            ", "mf1", "=", "mf1", ".", "result", "(", ")", "\n", "mf1s", ".", "append", "(", "mf1", ")", "\n", "\n", "", "", "best_config_index", "=", "np", ".", "argmax", "(", "mf1s", ")", "\n", "best_config", "=", "configs", "[", "best_config_index", "]", "\n", "return", "{", "\n", "\"hparams\"", ":", "best_config", ",", "\n", "\"zero-shot macro f1\"", ":", "round", "(", "initial_mf1", ",", "1", ")", ",", "\n", "\"few-shot macro f1\"", ":", "round", "(", "mf1s", "[", "best_config_index", "]", ",", "1", ")", ",", "\n", "}", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.SentenceTransformerModel.__init__": [[45, 48], ["sentence_transformers.SentenceTransformer"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "model_config", ":", "dict", ")", ":", "\n", "        ", "self", ".", "model", "=", "SentenceTransformer", "(", "model_config", "[", "\"model\"", "]", ")", "\n", "self", ".", "precomputed_embeddings", ":", "Dict", "[", "str", ",", "np", ".", "ndarray", "]", "=", "{", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.SentenceTransformerModel._encode_batch": [[49, 52], ["sentence_transformer.SentenceTransformerModel.model.encode"], "methods", ["None"], ["", "def", "_encode_batch", "(", "self", ",", "text", ":", "List", "[", "Text", "]", ")", "->", "np", ".", "ndarray", ":", "\n", "        ", "encodings", "=", "self", ".", "model", ".", "encode", "(", "text", ")", "\n", "return", "encodings", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.SentenceTransformerModel.encode_batch": [[53, 63], ["sentence_transformer.SentenceTransformerModel._encode_batch", "numpy.array", "zip"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.SentenceTransformerModel._encode_batch"], ["", "def", "encode_batch", "(", "self", ",", "text", ":", "List", "[", "Text", "]", ")", "->", "np", ".", "ndarray", ":", "\n", "        ", "encodings", "=", "self", ".", "_encode_batch", "(", "text", ")", "\n", "if", "self", ".", "precomputed_embeddings", "is", "not", "None", ":", "\n", "            ", "encodings", "=", "[", "\n", "self", ".", "precomputed_embeddings", "[", "text", "]", "\n", "if", "text", "in", "self", ".", "precomputed_embeddings", "\n", "else", "encoding", "\n", "for", "text", ",", "encoding", "in", "zip", "(", "text", ",", "encodings", ")", "\n", "]", "\n", "", "return", "np", ".", "array", "(", "encodings", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.SentenceTransformerModel.few_shot": [[64, 86], ["sentence_transformer.SentenceTransformerModel.encode_batch", "sentence_transformer.SentenceTransformerModel.encode_batch", "sentence_transformer.get_example_labels", "label_tuning.label_tuning", "zip", "list", "label_tuning.find_hparams", "hypotheses.values", "hypotheses.values"], "methods", ["home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.encode_batch", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.encode_batch", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.get_example_labels", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.label_tuning", "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.label_tuning.find_hparams"], ["", "def", "few_shot", "(", "\n", "self", ",", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "examples", ":", "List", "[", "dict", "]", ",", "\n", "batch_size", ":", "int", ",", "\n", ")", "->", "None", ":", "\n", "        ", "from", "symanto_fsb", ".", "models", ".", "siamese_models", "import", "label_tuning", "\n", "\n", "del", "batch_size", "\n", "label_embeddings", "=", "self", ".", "encode_batch", "(", "list", "(", "hypotheses", ".", "values", "(", ")", ")", ")", "\n", "example_embeddings", "=", "self", ".", "encode_batch", "(", "[", "e", "[", "\"text\"", "]", "for", "e", "in", "examples", "]", ")", "\n", "example_labels", "=", "get_example_labels", "(", "hypotheses", ",", "examples", ")", "\n", "hparams", "=", "label_tuning", ".", "find_hparams", "(", "\n", "example_embeddings", ",", "example_labels", ",", "label_embeddings", ",", "num_folds", "=", "4", "\n", ")", "[", "\"hparams\"", "]", "\n", "new_label_embeddings", "=", "label_tuning", ".", "label_tuning", "(", "\n", "example_embeddings", ",", "example_labels", ",", "label_embeddings", ",", "**", "hparams", "\n", ")", "\n", "for", "text", ",", "label_embedding", "in", "zip", "(", "\n", "hypotheses", ".", "values", "(", ")", ",", "new_label_embeddings", "\n", ")", ":", "\n", "            ", "self", ".", "precomputed_embeddings", "[", "text", "]", "=", "label_embedding", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.get_example_labels": [[25, 42], ["numpy.array", "np.array.append", "enumerate", "numpy.zeros", "len", "len"], "function", ["None"], ["def", "get_example_labels", "(", "\n", "hypotheses", ":", "Mapping", "[", "str", ",", "str", "]", ",", "\n", "examples", ":", "List", "[", "dict", "]", ",", "\n", ")", "->", "np", ".", "ndarray", ":", "\n", "    ", "label_to_index", "=", "{", "label", ":", "index", "for", "index", ",", "label", "in", "enumerate", "(", "hypotheses", ")", "}", "\n", "example_labels", "=", "[", "]", "\n", "for", "example", "in", "examples", ":", "\n", "        ", "if", "\"scores\"", "in", "example", ":", "\n", "            ", "scores", "=", "example", "[", "\"scores\"", "]", "\n", "assert", "scores", ".", "shape", "==", "(", "len", "(", "label_to_index", ")", ",", ")", "\n", "", "else", ":", "\n", "            ", "index", "=", "label_to_index", "[", "example", "[", "\"label\"", "]", "]", "\n", "scores", "=", "np", ".", "zeros", "(", "shape", "=", "(", "len", "(", "label_to_index", ")", ",", ")", ")", "\n", "scores", "[", "index", "]", "=", "1", "\n", "", "example_labels", ".", "append", "(", "scores", ")", "\n", "", "example_labels", "=", "np", ".", "array", "(", "example_labels", ")", "\n", "return", "example_labels", "\n", "\n"]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.sentence_transformer.load_model": [[88, 90], ["sentence_transformer.SentenceTransformerModel"], "function", ["None"], ["", "", "", "def", "load_model", "(", "model_config", ")", ":", "\n", "    ", "return", "SentenceTransformerModel", "(", "model_config", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.encode_batch": [[22, 25], ["None"], "methods", ["None"], []], "home.repos.pwc.inspect_result.symanto-research_few-shot-learning-label-tuning.siamese_models.__init__.Model.few_shot": [[26, 34], ["None"], "methods", ["None"], []]}