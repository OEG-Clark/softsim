{"home.repos.pwc.inspect_result.ristea_septr.None.septr.SeparableTr.__init__": [[9, 32], ["torch.nn.Module.__init__", "torch.nn.ModuleList", "septr.SeparableTr.transformer.append", "range", "torch.nn.Parameter", "torch.nn.Linear", "Exception", "septr_block.SepTrBlock", "septr.SeparableTr.transformer.append", "torch.randn", "septr_block.SepTrBlock"], "methods", ["home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channels", "=", "1", ",", "input_size", "=", "(", "128", ",", "128", ")", ",", "num_classes", "=", "35", ",", "depth", "=", "3", ",", "heads", "=", "5", ",", "mlp_dim", "=", "256", ",", "dim_head", "=", "256", ",", "\n", "down_sample_input", "=", "None", ",", "dim", "=", "256", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "inner_channels", "=", "channels", "\n", "\n", "self", ".", "transformer", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "if", "depth", "<", "1", ":", "\n", "            ", "raise", "Exception", "(", "\"Depth cannot be smaller than 1!\"", ")", "\n", "\n", "", "self", ".", "transformer", ".", "append", "(", "\n", "SepTrBlock", "(", "channels", "=", "inner_channels", ",", "input_size", "=", "input_size", ",", "heads", "=", "heads", ",", "mlp_dim", "=", "mlp_dim", ",", "\n", "dim_head", "=", "dim_head", ",", "down_sample_input", "=", "down_sample_input", ",", "dim", "=", "dim", ",", "project", "=", "True", ")", "\n", ")", "\n", "\n", "for", "i", "in", "range", "(", "1", ",", "depth", ")", ":", "\n", "            ", "self", ".", "transformer", ".", "append", "(", "\n", "SepTrBlock", "(", "channels", "=", "inner_channels", ",", "input_size", "=", "input_size", ",", "heads", "=", "heads", ",", "mlp_dim", "=", "mlp_dim", ",", "\n", "dim_head", "=", "dim_head", ",", "down_sample_input", "=", "down_sample_input", ",", "dim", "=", "dim", ",", "project", "=", "False", ")", "\n", ")", "\n", "\n", "", "self", ".", "cls_token", "=", "nn", ".", "Parameter", "(", "torch", ".", "randn", "(", "1", ",", "1", ",", "1", ",", "dim", ")", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "dim", ",", "num_classes", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr.SeparableTr.forward": [[33, 42], ["range", "septr.SeparableTr.fc", "len"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", ",", "cls_token", "=", "self", ".", "transformer", "[", "0", "]", "(", "x", ",", "self", ".", "cls_token", ")", "\n", "\n", "for", "i", "in", "range", "(", "0", ",", "len", "(", "self", ".", "transformer", ")", ")", ":", "\n", "            ", "x", ",", "cls_token", "=", "self", ".", "transformer", "[", "i", "]", "(", "x", ",", "cls_token", ")", "\n", "\n", "", "cls_token", "=", "cls_token", "[", ":", ",", "0", ",", "0", ",", ":", "]", "\n", "x", "=", "self", ".", "fc", "(", "cls_token", ")", "\n", "return", "x", "\n", "", "", ""]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.PreNorm.__init__": [[17, 21], ["torch.nn.Module.__init__", "torch.nn.LayerNorm"], "methods", ["home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "fn", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "norm", "=", "nn", ".", "LayerNorm", "(", "dim", ")", "\n", "self", ".", "fn", "=", "fn", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.PreNorm.forward": [[22, 24], ["septr_block.PreNorm.fn", "septr_block.PreNorm.norm"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "**", "kwargs", ")", ":", "\n", "        ", "return", "self", ".", "fn", "(", "self", ".", "norm", "(", "x", ")", ",", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.FeedForward.__init__": [[27, 35], ["torch.nn.Module.__init__", "torch.nn.Sequential", "torch.nn.Linear", "torch.nn.GELU", "torch.nn.Dropout", "torch.nn.Linear", "torch.nn.Dropout"], "methods", ["home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "hidden_dim", ",", "dropout", "=", "0.", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "net", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Linear", "(", "dim", ",", "hidden_dim", ")", ",", "\n", "nn", ".", "GELU", "(", ")", ",", "\n", "nn", ".", "Dropout", "(", "dropout", ")", ",", "\n", "nn", ".", "Linear", "(", "hidden_dim", ",", "dim", ")", ",", "\n", "nn", ".", "Dropout", "(", "dropout", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.FeedForward.forward": [[37, 39], ["septr_block.FeedForward.net"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "self", ".", "net", "(", "x", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.Attention.__init__": [[42, 57], ["torch.nn.Module.__init__", "torch.nn.Softmax", "torch.nn.Linear", "torch.nn.Sequential", "torch.nn.Identity", "torch.nn.Linear", "torch.nn.Dropout"], "methods", ["home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "heads", "=", "8", ",", "dim_head", "=", "64", ",", "dropout", "=", "0.", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "inner_dim", "=", "dim_head", "*", "heads", "\n", "project_out", "=", "not", "(", "heads", "==", "1", "and", "dim_head", "==", "dim", ")", "\n", "\n", "self", ".", "heads", "=", "heads", "\n", "self", ".", "scale", "=", "dim_head", "**", "-", "0.5", "\n", "\n", "self", ".", "attend", "=", "nn", ".", "Softmax", "(", "dim", "=", "-", "1", ")", "\n", "self", ".", "to_qkv", "=", "nn", ".", "Linear", "(", "dim", ",", "inner_dim", "*", "3", ",", "bias", "=", "False", ")", "\n", "\n", "self", ".", "to_out", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Linear", "(", "inner_dim", ",", "dim", ")", ",", "\n", "nn", ".", "Dropout", "(", "dropout", ")", "\n", ")", "if", "project_out", "else", "nn", ".", "Identity", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.Attention.forward": [[58, 69], ["septr_block.Attention.to_qkv().chunk", "map", "septr_block.Attention.attend", "torch.matmul", "einops.rearrange", "septr_block.Attention.to_out", "torch.matmul", "septr_block.Attention.to_qkv", "einops.rearrange", "k.transpose"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "qkv", "=", "self", ".", "to_qkv", "(", "x", ")", ".", "chunk", "(", "3", ",", "dim", "=", "-", "1", ")", "\n", "q", ",", "k", ",", "v", "=", "map", "(", "lambda", "t", ":", "rearrange", "(", "t", ",", "'b n (h d) -> b h n d'", ",", "h", "=", "self", ".", "heads", ")", ",", "qkv", ")", "\n", "\n", "dots", "=", "torch", ".", "matmul", "(", "q", ",", "k", ".", "transpose", "(", "-", "1", ",", "-", "2", ")", ")", "*", "self", ".", "scale", "\n", "\n", "attn", "=", "self", ".", "attend", "(", "dots", ")", "\n", "\n", "out", "=", "torch", ".", "matmul", "(", "attn", ",", "v", ")", "\n", "out", "=", "rearrange", "(", "out", ",", "'b h n d -> b n (h d)'", ")", "\n", "return", "self", ".", "to_out", "(", "out", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.Transformer.__init__": [[72, 79], ["torch.nn.Module.__init__", "torch.nn.ModuleList", "range", "septr_block.Transformer.layers.append", "torch.nn.ModuleList", "septr_block.PreNorm", "septr_block.PreNorm", "septr_block.Attention", "septr_block.FeedForward"], "methods", ["home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dim", ",", "depth", ",", "heads", ",", "dim_head", ",", "mlp_dim", ",", "dropout", "=", "0.", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", "[", "]", ")", "\n", "for", "_", "in", "range", "(", "depth", ")", ":", "\n", "            ", "self", ".", "layers", ".", "append", "(", "nn", ".", "ModuleList", "(", "[", "\n", "PreNorm", "(", "dim", ",", "Attention", "(", "dim", ",", "heads", "=", "heads", ",", "dim_head", "=", "dim_head", ",", "dropout", "=", "dropout", ")", ")", ",", "\n", "PreNorm", "(", "dim", ",", "FeedForward", "(", "dim", ",", "mlp_dim", ",", "dropout", "=", "dropout", ")", ")", "\n", "]", ")", ")", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.Transformer.forward": [[81, 86], ["attn", "ff"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "for", "attn", ",", "ff", "in", "self", ".", "layers", ":", "\n", "            ", "x", "=", "attn", "(", "x", ")", "+", "x", "\n", "x", "=", "ff", "(", "x", ")", "+", "x", "\n", "", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.Scale.__init__": [[89, 92], ["torch.nn.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__"], ["    ", "def", "__init__", "(", "self", ",", "val", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "val", "=", "val", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.Scale.forward": [[93, 95], ["None"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "*", "self", ".", "val", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__": [[98, 133], ["torch.nn.Module.__init__", "septr_block.pair", "torch.nn.Identity", "torch.nn.Identity", "torch.nn.Identity", "torch.nn.Identity", "einops.layers.torch.Rearrange", "einops.layers.torch.Rearrange", "einops.layers.torch.Rearrange", "einops.layers.torch.Rearrange", "einops.layers.torch.Rearrange", "torch.nn.Parameter", "torch.nn.Parameter", "septr_block.Transformer", "septr_block.Transformer", "torch.nn.AvgPool2d", "torch.nn.UpsamplingNearest2d", "torch.nn.Linear", "torch.nn.Sequential", "torch.randn", "torch.randn", "torch.nn.Linear", "septr_block.Scale"], "methods", ["home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.__init__", "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.pair"], ["    ", "def", "__init__", "(", "self", ",", "channels", ",", "input_size", ",", "heads", "=", "3", ",", "mlp_dim", "=", "128", ",", "dim_head", "=", "32", ",", "\n", "down_sample_input", "=", "None", ",", "project", "=", "False", ",", "reconstruct", "=", "False", ",", "dim", "=", "128", ",", "dropout_tr", "=", "0.0", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "patch_height", ",", "patch_width", "=", "pair", "(", "input_size", ")", "\n", "self", ".", "avg_pool", "=", "nn", ".", "Identity", "(", ")", "\n", "self", ".", "upsample", "=", "nn", ".", "Identity", "(", ")", "\n", "self", ".", "projection", "=", "nn", ".", "Identity", "(", ")", "\n", "self", ".", "reconstruction", "=", "nn", ".", "Identity", "(", ")", "\n", "\n", "if", "down_sample_input", "is", "not", "None", ":", "\n", "            ", "patch_height", "=", "patch_height", "//", "down_sample_input", "[", "0", "]", "\n", "patch_width", "=", "patch_width", "//", "down_sample_input", "[", "1", "]", "\n", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AvgPool2d", "(", "kernel_size", "=", "down_sample_input", ")", "\n", "self", ".", "upsample", "=", "nn", ".", "UpsamplingNearest2d", "(", "scale_factor", "=", "down_sample_input", ")", "\n", "\n", "", "if", "project", ":", "\n", "            ", "self", ".", "projection", "=", "nn", ".", "Linear", "(", "channels", ",", "dim", ")", "\n", "", "if", "reconstruct", ":", "\n", "            ", "self", ".", "reconstruction", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Linear", "(", "dim", ",", "channels", ")", ",", "\n", "Scale", "(", "dim", "**", "-", "0.5", ")", "\n", ")", "\n", "\n", "", "self", ".", "rearrange_patches_h", "=", "Rearrange", "(", "'b c h w -> b w h c'", ")", "\n", "self", ".", "rearrange_patches_w", "=", "Rearrange", "(", "'b c h w -> b h w c'", ")", "\n", "\n", "self", ".", "rearrange_in_tr", "=", "Rearrange", "(", "'b c h w -> (b c) h w'", ")", "\n", "self", ".", "rearrange_out_tr_h", "=", "Rearrange", "(", "'(b c) h w -> b w h c'", ",", "c", "=", "patch_width", ")", "\n", "self", ".", "rearrange_out_tr_w", "=", "Rearrange", "(", "'(b c) h w -> b w c h'", ",", "c", "=", "patch_height", ")", "\n", "\n", "self", ".", "pos_embedding_w", "=", "nn", ".", "Parameter", "(", "torch", ".", "randn", "(", "1", ",", "1", ",", "patch_width", "+", "1", ",", "dim", ")", ")", "\n", "self", ".", "pos_embedding_h", "=", "nn", ".", "Parameter", "(", "torch", ".", "randn", "(", "1", ",", "1", ",", "patch_height", "+", "1", ",", "dim", ")", ")", "\n", "self", ".", "transformer_w", "=", "Transformer", "(", "dim", ",", "1", ",", "heads", ",", "dim_head", ",", "mlp_dim", ",", "dropout_tr", ")", "\n", "self", ".", "transformer_h", "=", "Transformer", "(", "dim", ",", "1", ",", "heads", ",", "dim_head", ",", "mlp_dim", ",", "dropout_tr", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.SepTrBlock.forward": [[134, 172], ["septr_block.SepTrBlock.avg_pool", "septr_block.SepTrBlock.rearrange_patches_h", "septr_block.SepTrBlock.projection", "torch.cat", "septr_block.SepTrBlock.rearrange_in_tr", "septr_block.SepTrBlock.transformer_h", "septr_block.SepTrBlock.rearrange_out_tr_h", "septr_block.SepTrBlock.rearrange_patches_w", "h[].unsqueeze", "einops.repeat", "torch.cat", "septr_block.SepTrBlock.rearrange_in_tr", "septr_block.SepTrBlock.transformer_w", "septr_block.SepTrBlock.rearrange_out_tr_w", "septr_block.SepTrBlock.upsample", "septr_block.SepTrBlock.reconstruction", "w[].mean().unsqueeze().unsqueeze", "einops.repeat", "einops.repeat", "einops.repeat.mean().unsqueeze().unsqueeze", "w[].mean().unsqueeze", "einops.repeat.mean().unsqueeze", "w[].mean", "einops.repeat.mean"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ",", "cls_token", ")", ":", "\n", "        ", "x", "=", "self", ".", "avg_pool", "(", "x", ")", "\n", "\n", "# H inference", "\n", "h", "=", "self", ".", "rearrange_patches_h", "(", "x", ")", "\n", "h", "=", "self", ".", "projection", "(", "h", ")", "\n", "\n", "dim1", ",", "dim2", ",", "_", ",", "_", "=", "h", ".", "shape", "\n", "if", "cls_token", ".", "shape", "[", "0", "]", "==", "1", ":", "\n", "            ", "cls_token", "=", "repeat", "(", "cls_token", ",", "'() () n d -> b w n d'", ",", "b", "=", "dim1", ",", "w", "=", "dim2", ")", "\n", "", "else", ":", "\n", "            ", "cls_token", "=", "repeat", "(", "cls_token", ",", "'b () n d -> b w n d'", ",", "w", "=", "dim2", ")", "\n", "\n", "", "h", "=", "torch", ".", "cat", "(", "(", "cls_token", ",", "h", ")", ",", "dim", "=", "2", ")", "\n", "h", "+=", "self", ".", "pos_embedding_h", "\n", "\n", "h", "=", "self", ".", "rearrange_in_tr", "(", "h", ")", "\n", "h", "=", "self", ".", "transformer_h", "(", "h", ")", "\n", "h", "=", "self", ".", "rearrange_out_tr_h", "(", "h", ")", "\n", "\n", "# W inference", "\n", "w", "=", "self", ".", "rearrange_patches_w", "(", "h", "[", ":", ",", ":", ",", "1", ":", ",", ":", "]", ")", "\n", "\n", "cls_token", "=", "h", "[", ":", ",", ":", ",", "0", ",", ":", "]", ".", "unsqueeze", "(", "2", ")", "\n", "cls_token", "=", "repeat", "(", "cls_token", ".", "mean", "(", "(", "-", "1", ",", "-", "2", ")", ")", ".", "unsqueeze", "(", "1", ")", ".", "unsqueeze", "(", "1", ")", ",", "'b () d2 e -> b d1 d2 e'", ",", "d1", "=", "w", ".", "shape", "[", "1", "]", ")", "\n", "\n", "w", "=", "torch", ".", "cat", "(", "(", "cls_token", ",", "w", ")", ",", "dim", "=", "2", ")", "\n", "w", "+=", "self", ".", "pos_embedding_w", "\n", "\n", "w", "=", "self", ".", "rearrange_in_tr", "(", "w", ")", "\n", "w", "=", "self", ".", "transformer_w", "(", "w", ")", "\n", "w", "=", "self", ".", "rearrange_out_tr_w", "(", "w", ")", "\n", "\n", "x", "=", "self", ".", "upsample", "(", "w", "[", ":", ",", ":", ",", ":", ",", "1", ":", "]", ")", "\n", "x", "=", "self", ".", "reconstruction", "(", "x", ")", "\n", "\n", "cls_token", "=", "w", "[", ":", ",", ":", ",", ":", ",", "0", "]", ".", "mean", "(", "2", ")", ".", "unsqueeze", "(", "1", ")", ".", "unsqueeze", "(", "1", ")", "\n", "return", "x", ",", "cls_token", "\n", "", "", ""]], "home.repos.pwc.inspect_result.ristea_septr.None.septr_block.pair": [[11, 13], ["isinstance"], "function", ["None"], ["def", "pair", "(", "t", ")", ":", "\n", "    ", "return", "t", "if", "isinstance", "(", "t", ",", "tuple", ")", "else", "(", "t", ",", "t", ")", "\n", "\n"]]}