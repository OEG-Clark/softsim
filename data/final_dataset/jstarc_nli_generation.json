{"home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.CsvHistory.__init__": [[14, 18], ["open", "csv.writer"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "filename", ")", ":", "\n", "        ", "self", ".", "file", "=", "open", "(", "filename", ",", "'a'", ",", "0", ")", "\n", "self", ".", "writer", "=", "csv", ".", "writer", "(", "self", ".", "file", ")", "\n", "self", ".", "header", "=", "True", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.CsvHistory.on_epoch_end": [[19, 24], ["common.CsvHistory.writer.writerow", "common.CsvHistory.writer.writerow", "logs.keys", "logs.values"], "methods", ["None"], ["", "def", "on_epoch_end", "(", "self", ",", "epoch", ",", "logs", "=", "{", "}", ")", ":", "\n", "        ", "if", "self", ".", "header", ":", "\n", "            ", "self", ".", "writer", ".", "writerow", "(", "[", "'epoch'", "]", "+", "logs", ".", "keys", "(", ")", ")", "\n", "self", ".", "header", "=", "False", "\n", "", "self", ".", "writer", ".", "writerow", "(", "[", "epoch", "]", "+", "[", "\"%0.4f\"", "%", "v", "for", "v", "in", "logs", ".", "values", "(", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.CsvHistory.on_train_end": [[25, 27], ["common.CsvHistory.file.close"], "methods", ["None"], ["", "def", "on_train_end", "(", "self", ",", "logs", "=", "{", "}", ")", ":", "\n", "        ", "self", ".", "file", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.make_fixed_embeddings": [[6, 10], ["numpy.array", "keras.layers.embeddings.Embedding", "glove.values"], "function", ["None"], ["def", "make_fixed_embeddings", "(", "glove", ",", "seq_len", ")", ":", "\n", "    ", "glove_mat", "=", "np", ".", "array", "(", "glove", ".", "values", "(", ")", ")", "\n", "return", "Embedding", "(", "input_dim", "=", "glove_mat", ".", "shape", "[", "0", "]", ",", "output_dim", "=", "glove_mat", ".", "shape", "[", "1", "]", ",", "\n", "weights", "=", "[", "glove_mat", "]", ",", "trainable", "=", "False", ",", "input_length", "=", "seq_len", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.merge_result_batches": [[28, 34], ["list", "range", "len", "range", "len", "numpy.concatenate"], "function", ["None"], ["", "", "def", "merge_result_batches", "(", "batches", ")", ":", "\n", "    ", "res", "=", "list", "(", "batches", "[", "0", "]", ")", "\n", "for", "i", "in", "range", "(", "1", ",", "len", "(", "batches", ")", ")", ":", "\n", "        ", "for", "j", "in", "range", "(", "len", "(", "res", ")", ")", ":", "\n", "            ", "res", "[", "j", "]", "=", "np", ".", "concatenate", "(", "[", "res", "[", "j", "]", ",", "batches", "[", "i", "]", "[", "j", "]", "]", ")", "\n", "", "", "return", "res", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.FeedLSTM.__init__": [[8, 13], ["keras.layers.recurrent.LSTM.__init__"], "methods", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.__init__"], ["    ", "def", "__init__", "(", "self", ",", "feed_layer", "=", "None", ",", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "feed_layer", "=", "feed_layer", "\n", "self", ".", "supports_masking", "=", "False", "\n", "\n", "super", "(", "FeedLSTM", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.FeedLSTM.set_state": [[14, 16], ["keras.backend.theano_backend.set_value"], "methods", ["None"], ["", "def", "set_state", "(", "self", ",", "noise", ")", ":", "\n", "        ", "K", ".", "set_value", "(", "self", ".", "states", "[", "1", "]", ",", "noise", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.FeedLSTM.get_initial_states": [[17, 27], ["keras.backend.theano_backend.zeros_like", "keras.backend.theano_backend.sum", "keras.backend.theano_backend.zeros", "keras.backend.theano_backend.dot", "range", "len"], "methods", ["None"], ["", "def", "get_initial_states", "(", "self", ",", "x", ")", ":", "\n", "# build an all-zero tensor of shape (samples, output_dim)", "\n", "        ", "initial_state", "=", "K", ".", "zeros_like", "(", "x", ")", "# (samples, timesteps, input_dim)", "\n", "initial_state", "=", "K", ".", "sum", "(", "initial_state", ",", "axis", "=", "1", ")", "# (samples, input_dim)", "\n", "reducer", "=", "K", ".", "zeros", "(", "(", "self", ".", "input_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "initial_state", "=", "K", ".", "dot", "(", "initial_state", ",", "reducer", ")", "# (samples, output_dim)", "\n", "initial_states", "=", "[", "initial_state", "for", "_", "in", "range", "(", "len", "(", "self", ".", "states", ")", ")", "]", "\n", "if", "self", ".", "feed_layer", "is", "not", "None", ":", "\n", "            ", "initial_states", "[", "1", "]", "=", "self", ".", "feed_layer", "\n", "", "return", "initial_states", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.__init__": [[31, 35], ["keras.layers.recurrent.LSTM.__init__"], "methods", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.__init__"], ["    ", "def", "__init__", "(", "self", ",", "feed_state", "=", "False", ",", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "feed_state", "=", "feed_state", "\n", "self", ".", "supports_masking", "=", "False", "\n", "super", "(", "LstmAttentionLayer", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.get_output_shape_for": [[36, 41], ["None"], "methods", ["None"], ["", "def", "get_output_shape_for", "(", "self", ",", "input_shape", ")", ":", "\n", "        ", "if", "self", ".", "return_sequences", ":", "\n", "            ", "return", "(", "input_shape", "[", "0", "]", "[", "0", "]", ",", "input_shape", "[", "0", "]", "[", "1", "]", ",", "self", ".", "output_dim", ")", "\n", "", "else", ":", "\n", "            ", "return", "(", "input_shape", "[", "0", "]", "[", "0", "]", ",", "self", ".", "output_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.compute_mask": [[42, 44], ["None"], "methods", ["None"], ["", "", "def", "compute_mask", "(", "self", ",", "input", ",", "mask", ")", ":", "\n", "        ", "return", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.call": [[45, 47], ["super().call"], "methods", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.call"], ["", "def", "call", "(", "self", ",", "x", ",", "mask", "=", "None", ")", ":", "\n", "        ", "return", "super", "(", "LSTM", ",", "self", ")", ".", "call", "(", "x", ",", "None", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.build": [[48, 87], ["attention.LstmAttentionLayer.init", "attention.LstmAttentionLayer.init", "attention.LstmAttentionLayer.init", "keras.backend.theano_backend.zeros", "attention.LstmAttentionLayer.init", "attention.LstmAttentionLayer.inner_init", "keras.backend.theano_backend.zeros", "attention.LstmAttentionLayer.init", "attention.LstmAttentionLayer.inner_init", "attention.LstmAttentionLayer.forget_bias_init", "attention.LstmAttentionLayer.init", "attention.LstmAttentionLayer.inner_init", "keras.backend.theano_backend.zeros", "attention.LstmAttentionLayer.init", "attention.LstmAttentionLayer.inner_init", "keras.backend.theano_backend.zeros", "keras.engine.InputSpec", "attention.LstmAttentionLayer.reset_states"], "methods", ["None"], ["", "def", "build", "(", "self", ",", "input_shape", ")", ":", "\n", "\n", "        ", "self", ".", "input_spec", "=", "[", "InputSpec", "(", "shape", "=", "shape", ")", "for", "shape", "in", "input_shape", "]", "\n", "\n", "input_dim", "=", "input_shape", "[", "1", "]", "[", "2", "]", "\n", "self", ".", "input_dim", "=", "input_dim", "\n", "\n", "if", "self", ".", "stateful", ":", "\n", "            ", "self", ".", "reset_states", "(", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "states", "=", "[", "None", ",", "None", "]", "\n", "\n", "", "self", ".", "W_s", "=", "self", ".", "init", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "W_t", "=", "self", ".", "init", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "W_a", "=", "self", ".", "init", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "w_e", "=", "K", ".", "zeros", "(", "(", "self", ".", "output_dim", ",", ")", ")", "\n", "\n", "self", ".", "W_i", "=", "self", ".", "init", "(", "(", "2", "*", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "U_i", "=", "self", ".", "inner_init", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "b_i", "=", "K", ".", "zeros", "(", "(", "self", ".", "output_dim", ",", ")", ")", "\n", "\n", "self", ".", "W_f", "=", "self", ".", "init", "(", "(", "2", "*", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "U_f", "=", "self", ".", "inner_init", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "b_f", "=", "self", ".", "forget_bias_init", "(", "(", "self", ".", "output_dim", ",", ")", ")", "\n", "\n", "self", ".", "W_c", "=", "self", ".", "init", "(", "(", "2", "*", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "U_c", "=", "self", ".", "inner_init", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "b_c", "=", "K", ".", "zeros", "(", "(", "self", ".", "output_dim", ",", ")", ")", "\n", "\n", "self", ".", "W_o", "=", "self", ".", "init", "(", "(", "2", "*", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "U_o", "=", "self", ".", "inner_init", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "self", ".", "b_o", "=", "K", ".", "zeros", "(", "(", "self", ".", "output_dim", ",", ")", ")", "\n", "\n", "\n", "self", ".", "trainable_weights", "=", "[", "self", ".", "W_s", ",", "self", ".", "W_t", ",", "self", ".", "W_a", ",", "self", ".", "w_e", ",", "\n", "self", ".", "W_i", ",", "self", ".", "U_i", ",", "self", ".", "b_i", ",", "\n", "self", ".", "W_c", ",", "self", ".", "U_c", ",", "self", ".", "b_c", ",", "\n", "self", ".", "W_f", ",", "self", ".", "U_f", ",", "self", ".", "b_f", ",", "\n", "self", ".", "W_o", ",", "self", ".", "U_o", ",", "self", ".", "b_o", "]", "\n", "", "def", "preprocess_input", "(", "self", ",", "x", ")", ":", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.preprocess_input": [[87, 89], ["None"], "methods", ["None"], ["", "def", "preprocess_input", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "x", "[", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.set_state": [[90, 92], ["keras.backend.theano_backend.set_value"], "methods", ["None"], ["", "def", "set_state", "(", "self", ",", "noise", ")", ":", "\n", "        ", "K", ".", "set_value", "(", "self", ".", "states", "[", "1", "]", ",", "noise", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.get_constants": [[93, 95], ["keras.backend.theano_backend.dot"], "methods", ["None"], ["", "def", "get_constants", "(", "self", ",", "x", ")", ":", "\n", "        ", "return", "[", "x", "[", "1", "]", ",", "K", ".", "dot", "(", "x", "[", "1", "]", ",", "self", ".", "W_s", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.get_initial_states": [[96, 107], ["keras.backend.theano_backend.zeros_like", "keras.backend.theano_backend.sum", "keras.backend.theano_backend.zeros", "keras.backend.theano_backend.dot", "range", "len"], "methods", ["None"], ["", "def", "get_initial_states", "(", "self", ",", "x", ")", ":", "\n", "# build an all-zero tensor of shape (samples, output_dim)", "\n", "        ", "initial_state", "=", "K", ".", "zeros_like", "(", "x", "[", "0", "]", ")", "# (samples, timesteps, input_dim)", "\n", "initial_state", "=", "K", ".", "sum", "(", "initial_state", ",", "axis", "=", "1", ")", "# (samples, input_dim)", "\n", "reducer", "=", "K", ".", "zeros", "(", "(", "self", ".", "output_dim", ",", "self", ".", "output_dim", ")", ")", "\n", "initial_state", "=", "K", ".", "dot", "(", "initial_state", ",", "reducer", ")", "# (samples, output_dim)", "\n", "initial_states", "=", "[", "initial_state", "for", "_", "in", "range", "(", "len", "(", "self", ".", "states", ")", ")", "]", "\n", "if", "self", ".", "feed_state", ":", "\n", "            ", "initial_states", "[", "1", "]", "=", "x", "[", "2", "]", "\n", "\n", "", "return", "initial_states", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.step": [[108, 133], ["keras.backend.theano_backend.dot", "keras.backend.theano_backend.dot", "keras.backend.theano_backend.tanh().dot", "keras.backend.theano_backend.softmax", "weighted.sum", "keras.backend.theano_backend.T.concatenate", "attention.LstmAttentionLayer.inner_activation", "attention.LstmAttentionLayer.inner_activation", "attention.LstmAttentionLayer.inner_activation", "keras.backend.theano_backend.dot.dimshuffle", "keras.backend.theano_backend.softmax.dimshuffle", "keras.backend.theano_backend.dot", "keras.backend.theano_backend.dot", "keras.backend.theano_backend.dot", "keras.backend.theano_backend.dot", "attention.LstmAttentionLayer.activation", "keras.backend.theano_backend.dot.dimshuffle", "keras.backend.theano_backend.tanh", "keras.backend.theano_backend.dot", "keras.backend.theano_backend.dot", "attention.LstmAttentionLayer.activation", "keras.backend.theano_backend.dot", "keras.backend.theano_backend.dot"], "methods", ["None"], ["", "def", "step", "(", "self", ",", "x", ",", "states", ")", ":", "\n", "        ", "h_s", "=", "states", "[", "2", "]", "\n", "P_j", "=", "states", "[", "3", "]", "\n", "\n", "P_t", "=", "K", ".", "dot", "(", "x", ",", "self", ".", "W_t", ")", "\n", "P_a", "=", "K", ".", "dot", "(", "states", "[", "0", "]", ",", "self", ".", "W_a", ")", "\n", "sum3", "=", "P_j", "+", "P_t", ".", "dimshuffle", "(", "(", "0", ",", "'x'", ",", "1", ")", ")", "+", "P_a", ".", "dimshuffle", "(", "(", "0", ",", "'x'", ",", "1", ")", ")", "\n", "E_kj", "=", "K", ".", "tanh", "(", "sum3", ")", ".", "dot", "(", "self", ".", "w_e", ")", "\n", "Alpha_kj", "=", "K", ".", "softmax", "(", "E_kj", ")", "\n", "weighted", "=", "h_s", "*", "Alpha_kj", ".", "dimshuffle", "(", "(", "0", ",", "1", ",", "'x'", ")", ")", "\n", "a_k", "=", "weighted", ".", "sum", "(", "axis", "=", "1", ")", "\n", "m_k", "=", "K", ".", "T", ".", "concatenate", "(", "[", "a_k", ",", "x", "]", ",", "axis", "=", "1", ")", "\n", "\n", "x_i", "=", "K", ".", "dot", "(", "m_k", ",", "self", ".", "W_i", ")", "+", "self", ".", "b_i", "\n", "x_f", "=", "K", ".", "dot", "(", "m_k", ",", "self", ".", "W_f", ")", "+", "self", ".", "b_f", "\n", "x_c", "=", "K", ".", "dot", "(", "m_k", ",", "self", ".", "W_c", ")", "+", "self", ".", "b_c", "\n", "x_o", "=", "K", ".", "dot", "(", "m_k", ",", "self", ".", "W_o", ")", "+", "self", ".", "b_o", "\n", "\n", "i", "=", "self", ".", "inner_activation", "(", "x_i", "+", "K", ".", "dot", "(", "states", "[", "0", "]", ",", "self", ".", "U_i", ")", ")", "\n", "f", "=", "self", ".", "inner_activation", "(", "x_f", "+", "K", ".", "dot", "(", "states", "[", "0", "]", ",", "self", ".", "U_f", ")", ")", "\n", "c", "=", "f", "*", "states", "[", "1", "]", "+", "i", "*", "self", ".", "activation", "(", "x_c", "+", "K", ".", "dot", "(", "states", "[", "0", "]", ",", "self", ".", "U_c", ")", ")", "\n", "o", "=", "self", ".", "inner_activation", "(", "x_o", "+", "K", ".", "dot", "(", "states", "[", "0", "]", ",", "self", ".", "U_o", ")", ")", "\n", "h", "=", "o", "*", "self", ".", "activation", "(", "c", ")", "\n", "\n", "return", "h", ",", "[", "h", ",", "c", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.attention.LstmAttentionLayer.get_config": [[134, 138], ["super().get_config", "dict", "list", "list", "super().get_config.items", "config.items"], "methods", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.get_config"], ["", "def", "get_config", "(", "self", ")", ":", "\n", "        ", "config", "=", "{", "'feed_state'", ":", "self", ".", "feed_state", "}", "\n", "base_config", "=", "super", "(", "LstmAttentionLayer", ",", "self", ")", ".", "get_config", "(", ")", "\n", "return", "dict", "(", "list", "(", "base_config", ".", "items", "(", ")", ")", "+", "list", "(", "config", ".", "items", "(", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.classify_alg.train": [[6, 16], ["keras.callbacks.EarlyStopping", "keras.callbacks.ModelCheckpoint", "common.CsvHistory", "model.fit", "os.path.exists", "os.makedirs"], "function", ["None"], ["def", "train", "(", "train", ",", "dev", ",", "model", ",", "model_dir", ",", "batch_size", ")", ":", "\n", "\n", "    ", "if", "not", "os", ".", "path", ".", "exists", "(", "model_dir", ")", ":", "\n", "         ", "os", ".", "makedirs", "(", "model_dir", ")", "\n", "", "es", "=", "EarlyStopping", "(", "patience", "=", "2", ")", "\n", "saver", "=", "ModelCheckpoint", "(", "model_dir", "+", "'/model.weights'", ",", "monitor", "=", "'val_loss'", ",", "save_best_only", "=", "True", ")", "\n", "csv", "=", "CsvHistory", "(", "model_dir", "+", "'/history.csv'", ")", "\n", "return", "model", ".", "fit", "(", "[", "train", "[", "0", "]", ",", "train", "[", "1", "]", "]", ",", "train", "[", "2", "]", ",", "batch_size", "=", "batch_size", ",", "\n", "nb_epoch", "=", "1000", ",", "validation_data", "=", "(", "[", "dev", "[", "0", "]", ",", "dev", "[", "1", "]", "]", ",", "dev", "[", "2", "]", ")", ",", "\n", "callbacks", "=", "[", "saver", ",", "es", ",", "csv", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.classify_models.attention_model": [[9, 26], ["keras.layers.Input", "keras.layers.Input", "keras.models.Model", "keras.models.Model.compile", "common.make_fixed_embeddings", "common.make_fixed_embeddings", "keras.layers.recurrent.LSTM", "keras.layers.recurrent.LSTM", "attention.LstmAttentionLayer", "keras.layers.core.Dense"], "function", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.make_fixed_embeddings", "home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.make_fixed_embeddings"], ["def", "attention_model", "(", "hidden_size", ",", "glove", ")", ":", "\n", "\n", "    ", "prem_input", "=", "Input", "(", "shape", "=", "(", "None", ",", ")", ",", "dtype", "=", "'int32'", ")", "\n", "hypo_input", "=", "Input", "(", "shape", "=", "(", "None", ",", ")", ",", "dtype", "=", "'int32'", ")", "\n", "\n", "prem_embeddings", "=", "make_fixed_embeddings", "(", "glove", ",", "None", ")", "(", "prem_input", ")", "\n", "hypo_embeddings", "=", "make_fixed_embeddings", "(", "glove", ",", "None", ")", "(", "hypo_input", ")", "\n", "premise_layer", "=", "LSTM", "(", "output_dim", "=", "hidden_size", ",", "return_sequences", "=", "True", ",", "\n", "inner_activation", "=", "'sigmoid'", ")", "(", "prem_embeddings", ")", "\n", "hypo_layer", "=", "LSTM", "(", "output_dim", "=", "hidden_size", ",", "return_sequences", "=", "True", ",", "\n", "inner_activation", "=", "'sigmoid'", ")", "(", "hypo_embeddings", ")", "\n", "attention", "=", "LstmAttentionLayer", "(", "output_dim", "=", "hidden_size", ")", "(", "[", "hypo_layer", ",", "premise_layer", "]", ")", "\n", "final_dense", "=", "Dense", "(", "3", ",", "activation", "=", "'softmax'", ")", "(", "attention", ")", "\n", "\n", "model", "=", "Model", "(", "input", "=", "[", "prem_input", ",", "hypo_input", "]", ",", "output", "=", "final_dense", ")", "\n", "model", ".", "compile", "(", "loss", "=", "'categorical_crossentropy'", ",", "optimizer", "=", "'adam'", ",", "metrics", "=", "[", "'accuracy'", "]", ")", "\n", "return", "model", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.classify_models.attention_bnorm_model": [[28, 48], ["keras.layers.Input", "keras.layers.Input", "keras.models.Model", "keras.models.Model.compile", "common.make_fixed_embeddings", "common.make_fixed_embeddings", "keras.layers.recurrent.LSTM", "keras.layers.normalization.BatchNormalization", "keras.layers.recurrent.LSTM", "keras.layers.normalization.BatchNormalization", "attention.LstmAttentionLayer", "keras.layers.normalization.BatchNormalization", "keras.layers.core.Dense"], "function", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.make_fixed_embeddings", "home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.make_fixed_embeddings"], ["", "def", "attention_bnorm_model", "(", "hidden_size", ",", "glove", ")", ":", "\n", "\n", "    ", "prem_input", "=", "Input", "(", "shape", "=", "(", "None", ",", ")", ",", "dtype", "=", "'int32'", ")", "\n", "hypo_input", "=", "Input", "(", "shape", "=", "(", "None", ",", ")", ",", "dtype", "=", "'int32'", ")", "\n", "\n", "prem_embeddings", "=", "make_fixed_embeddings", "(", "glove", ",", "None", ")", "(", "prem_input", ")", "\n", "hypo_embeddings", "=", "make_fixed_embeddings", "(", "glove", ",", "None", ")", "(", "hypo_input", ")", "\n", "premise_layer", "=", "LSTM", "(", "output_dim", "=", "hidden_size", ",", "return_sequences", "=", "True", ",", "\n", "inner_activation", "=", "'sigmoid'", ")", "(", "prem_embeddings", ")", "\n", "premise_bn", "=", "BatchNormalization", "(", ")", "(", "premise_layer", ")", "\n", "hypo_layer", "=", "LSTM", "(", "output_dim", "=", "hidden_size", ",", "return_sequences", "=", "True", ",", "\n", "inner_activation", "=", "'sigmoid'", ")", "(", "hypo_embeddings", ")", "\n", "hypo_bn", "=", "BatchNormalization", "(", ")", "(", "hypo_layer", ")", "\n", "attention", "=", "LstmAttentionLayer", "(", "output_dim", "=", "hidden_size", ")", "(", "[", "hypo_bn", ",", "premise_bn", "]", ")", "\n", "att_bn", "=", "BatchNormalization", "(", ")", "(", "attention", ")", "\n", "final_dense", "=", "Dense", "(", "3", ",", "activation", "=", "'softmax'", ")", "(", "att_bn", ")", "\n", "\n", "model", "=", "Model", "(", "input", "=", "[", "prem_input", ",", "hypo_input", "]", ",", "output", "=", "final_dense", ")", "\n", "model", ".", "compile", "(", "loss", "=", "'categorical_crossentropy'", ",", "optimizer", "=", "'adam'", ",", "metrics", "=", "[", "'accuracy'", "]", ")", "\n", "return", "model", "\n", "", ""]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.adverse_models.discriminator": [[9, 18], ["keras.layers.Input", "keras.models.Model", "keras.models.Model.compile", "common.make_fixed_embeddings", "keras.layers.recurrent.LSTM", "keras.layers.core.Dense"], "function", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.common.make_fixed_embeddings"], ["def", "discriminator", "(", "glove", ",", "hidden_size", ")", ":", "\n", "\n", "    ", "hypo_input", "=", "Input", "(", "shape", "=", "(", "None", ",", ")", ",", "dtype", "=", "'int32'", ")", "\n", "embeds", "=", "make_fixed_embeddings", "(", "glove", ",", "None", ")", "(", "hypo_input", ")", "\n", "lstm", "=", "LSTM", "(", "hidden_size", ",", "inner_activation", "=", "'sigmoid'", ")", "(", "embeds", ")", "\n", "output", "=", "Dense", "(", "1", ",", "activation", "=", "'sigmoid'", ")", "(", "lstm", ")", "\n", "discriminator", "=", "Model", "(", "[", "hypo_input", "]", ",", "output", ")", "\n", "discriminator", ".", "compile", "(", "loss", "=", "'binary_crossentropy'", ",", "optimizer", "=", "'adam'", ")", "\n", "return", "discriminator", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.adverse_models.adverse_model": [[19, 35], ["keras.layers.Input", "keras.layers.Input", "keras.models.Model", "keras.models.Model.compile", "keras.layers.core.Lambda", "len", "len", "keras.backend.log", "keras.backend.log", "adverse_models.discriminator", "adverse_models.discriminator"], "function", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.adverse_models.discriminator", "home.repos.pwc.inspect_result.jstarc_nli_generation.None.adverse_models.discriminator"], ["", "def", "adverse_model", "(", "discriminator", ")", ":", "\n", "\n", "    ", "train_input", "=", "Input", "(", "shape", "=", "(", "None", ",", ")", ",", "dtype", "=", "'int32'", ")", "\n", "hypo_input", "=", "Input", "(", "shape", "=", "(", "None", ",", ")", ",", "dtype", "=", "'int32'", ")", "\n", "\n", "def", "margin_opt", "(", "inputs", ")", ":", "\n", "        ", "assert", "len", "(", "inputs", ")", "==", "2", ",", "(", "'Margin Output needs '", "\n", "'2 inputs, %d given'", "%", "len", "(", "inputs", ")", ")", "\n", "return", "K", ".", "log", "(", "inputs", "[", "0", "]", ")", "+", "K", ".", "log", "(", "1", "-", "inputs", "[", "1", "]", ")", "\n", "\n", "", "margin", "=", "Lambda", "(", "margin_opt", ",", "output_shape", "=", "(", "lambda", "s", ":", "(", "None", ",", "1", ")", ")", ")", "(", "[", "discriminator", "(", "train_input", ")", ",", "discriminator", "(", "hypo_input", ")", "]", ")", "\n", "adverserial", "=", "Model", "(", "[", "train_input", ",", "hypo_input", "]", ",", "margin", ")", "\n", "\n", "adverserial", ".", "compile", "(", "loss", "=", "minimize", ",", "optimizer", "=", "'adam'", ")", "\n", "return", "adverserial", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.adverse_models.minimize": [[36, 38], ["keras.backend.abs", "keras.backend.mean"], "function", ["None"], ["", "def", "minimize", "(", "y_true", ",", "y_pred", ")", ":", "\n", "        ", "return", "K", ".", "abs", "(", "K", ".", "mean", "(", "y_pred", ",", "axis", "=", "-", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.adverse_models.reinit": [[39, 41], ["ad_model.compile"], "function", ["None"], ["", "def", "reinit", "(", "ad_model", ")", ":", "\n", "    ", "ad_model", ".", "compile", "(", "loss", "=", "minimize", ",", "optimizer", "=", "'adam'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.__init__": [[14, 26], ["keras.initializations.get", "hierarchical_softmax.HierarchicalSoftmax.__init__.hshape"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "output_dim", ",", "init", "=", "'glorot_uniform'", ",", "**", "kwargs", ")", ":", "\n", "        ", "self", ".", "init", "=", "initializations", ".", "get", "(", "init", ")", "\n", "self", ".", "output_dim", "=", "output_dim", "\n", "\n", "def", "hshape", "(", "n", ")", ":", "\n", "            ", "from", "math", "import", "sqrt", ",", "ceil", "\n", "l1", "=", "ceil", "(", "sqrt", "(", "n", ")", ")", "\n", "l2", "=", "ceil", "(", "n", "/", "l1", ")", "\n", "return", "int", "(", "l1", ")", ",", "int", "(", "l2", ")", "\n", "\n", "", "self", ".", "n_classes", ",", "self", ".", "n_outputs_per_class", "=", "hshape", "(", "output_dim", ")", "\n", "super", "(", "HierarchicalSoftmax", ",", "self", ")", ".", "__init__", "(", "**", "kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.build": [[27, 37], ["hierarchical_softmax.HierarchicalSoftmax.init", "keras.backend.zeros", "hierarchical_softmax.HierarchicalSoftmax.init", "keras.backend.zeros", "keras.engine.InputSpec"], "methods", ["None"], ["", "def", "build", "(", "self", ",", "input_shape", ")", ":", "\n", "\n", "        ", "self", ".", "input_spec", "=", "[", "InputSpec", "(", "shape", "=", "shape", ")", "for", "shape", "in", "input_shape", "]", "\n", "input_dim", "=", "self", ".", "input_spec", "[", "0", "]", ".", "shape", "[", "-", "1", "]", "\n", "self", ".", "W1", "=", "self", ".", "init", "(", "(", "input_dim", ",", "self", ".", "n_classes", ")", ",", "name", "=", "'{}_W1'", ".", "format", "(", "self", ".", "name", ")", ")", "\n", "self", ".", "b1", "=", "K", ".", "zeros", "(", "(", "self", ".", "n_classes", ",", ")", ",", "name", "=", "'{}_b1'", ".", "format", "(", "self", ".", "name", ")", ")", "\n", "self", ".", "W2", "=", "self", ".", "init", "(", "(", "self", ".", "n_classes", ",", "input_dim", ",", "self", ".", "n_outputs_per_class", ")", ",", "name", "=", "'{}_W2'", ".", "format", "(", "self", ".", "name", ")", ")", "\n", "self", ".", "b2", "=", "K", ".", "zeros", "(", "(", "self", ".", "n_classes", ",", "self", ".", "n_outputs_per_class", ")", ",", "name", "=", "'{}_b2'", ".", "format", "(", "self", ".", "name", ")", ")", "\n", "\n", "self", ".", "trainable_weights", "=", "[", "self", ".", "W1", ",", "self", ".", "b1", ",", "self", ".", "W2", ",", "self", ".", "b2", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.get_output_shape_for": [[40, 42], ["None"], "methods", ["None"], ["", "def", "get_output_shape_for", "(", "self", ",", "input_shape", ")", ":", "\n", "        ", "return", "(", "input_shape", "[", "0", "]", "[", "0", "]", ",", "input_shape", "[", "0", "]", "[", "1", "]", ",", "None", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.call": [[43, 59], ["keras.backend.reshape", "theano.tensor.nnet.h_softmax", "keras.backend.reshape", "X[].flatten", "keras.backend.shape", "keras.backend.shape"], "methods", ["None"], ["", "def", "call", "(", "self", ",", "X", ",", "mask", "=", "None", ")", ":", "\n", "\n", "        ", "input_shape", "=", "self", ".", "input_spec", "[", "0", "]", ".", "shape", "\n", "\n", "x", "=", "K", ".", "reshape", "(", "X", "[", "0", "]", ",", "(", "-", "1", ",", "input_shape", "[", "2", "]", ")", ")", "\n", "target", "=", "X", "[", "1", "]", ".", "flatten", "(", ")", "if", "self", ".", "trainable", "else", "None", "\n", "\n", "Y", "=", "h_softmax", "(", "x", ",", "K", ".", "shape", "(", "x", ")", "[", "0", "]", ",", "self", ".", "output_dim", ",", "\n", "self", ".", "n_classes", ",", "self", ".", "n_outputs_per_class", ",", "\n", "self", ".", "W1", ",", "self", ".", "b1", ",", "self", ".", "W2", ",", "self", ".", "b2", ",", "target", ")", "\n", "\n", "output_dim", "=", "1", "if", "self", ".", "trainable", "else", "self", ".", "output_dim", "\n", "input_length", "=", "K", ".", "shape", "(", "X", "[", "0", "]", ")", "[", "1", "]", "\n", "\n", "y", "=", "K", ".", "reshape", "(", "Y", ",", "(", "-", "1", ",", "input_length", ",", "output_dim", ")", ")", "\n", "return", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.get_config": [[62, 67], ["super().get_config", "dict", "list", "list", "super().get_config.items", "config.items"], "methods", ["home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.HierarchicalSoftmax.get_config"], ["", "def", "get_config", "(", "self", ")", ":", "\n", "        ", "config", "=", "{", "'output_dim'", ":", "self", ".", "output_dim", ",", "\n", "'init'", ":", "self", ".", "init", ".", "__name__", "}", "\n", "base_config", "=", "super", "(", "HierarchicalSoftmax", ",", "self", ")", ".", "get_config", "(", ")", "\n", "return", "dict", "(", "list", "(", "base_config", ".", "items", "(", ")", ")", "+", "list", "(", "config", ".", "items", "(", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.jstarc_nli_generation.None.hierarchical_softmax.hs_categorical_crossentropy": [[68, 71], ["theano.clip", "theano.nnet.categorical_crossentropy"], "function", ["None"], ["", "", "def", "hs_categorical_crossentropy", "(", "y_true", ",", "y_pred", ")", ":", "\n", "    ", "y_pred", "=", "T", ".", "clip", "(", "y_pred", ",", "_EPSILON", ",", "1.0", "-", "_EPSILON", ")", "\n", "return", "T", ".", "nnet", ".", "categorical_crossentropy", "(", "y_pred", ",", "y_true", ")", "\n", "\n"]]}