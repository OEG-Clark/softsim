{"home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.create_kernel": [[12, 63], ["numpy.array", "numpy.array"], "function", ["None"], ["def", "create_kernel", "(", "dim", "=", "2", ")", ":", "\n", "    ", "if", "dim", "==", "2", ":", "\n", "        ", "Ky", "=", "[", "[", "1.0", ",", "2.0", ",", "1.0", "]", ",", "\n", "[", "0.0", ",", "0.0", ",", "0.0", "]", ",", "\n", "[", "-", "1.0", ",", "-", "2.0", ",", "-", "1.0", "]", "]", "\n", "Kx", "=", "[", "[", "-", "1.0", ",", "0.0", ",", "1.0", "]", ",", "\n", "[", "-", "2.0", ",", "0.0", ",", "2.0", "]", ",", "\n", "[", "-", "1.0", ",", "0.0", ",", "1.0", "]", "]", "\n", "bi_K", "=", "[", "[", "8", ",", "4", "]", ",", "[", "2", ",", "1", "]", "]", "\n", "\n", "K_x_", "=", "[", "[", "1.0", ",", "1.0", ",", "1.0", "]", ",", "\n", "[", "1.0", ",", "-", "8.0", ",", "1.0", "]", ",", "\n", "[", "1.0", ",", "1.0", ",", "1.0", "]", "]", "\n", "K_y_", "=", "[", "[", "1.0", ",", "1.0", ",", "1.0", "]", ",", "\n", "[", "1.0", ",", "-", "8.0", ",", "1.0", "]", ",", "\n", "[", "1.0", ",", "1.0", ",", "1.0", "]", "]", "\n", "Kx_", "=", "np", ".", "array", "(", "K_x", ")", "/", "8.0", "\n", "Ky_", "=", "np", ".", "array", "(", "K_y", ")", "/", "8.0", "\n", "return", "Kx", ",", "Ky", ",", "bi_K", "\n", "\n", "", "elif", "dim", "==", "3", ":", "\n", "        ", "Kx", "=", "[", "[", "[", "-", "1.0", ",", "-", "2.0", ",", "-", "1.0", "]", ",", "\n", "[", "0.0", ",", "0.0", ",", "0.0", "]", ",", "\n", "[", "1.0", ",", "2.0", ",", "1.0", "]", "]", ",", "\n", "[", "[", "-", "2.0", ",", "-", "4.0", ",", "-", "2.0", "]", ",", "\n", "[", "0.0", ",", "0.0", ",", "0.0", "]", ",", "\n", "[", "2.0", ",", "4.0", ",", "2.0", "]", "]", ",", "\n", "[", "[", "-", "1.0", ",", "-", "2.0", ",", "-", "1.0", "]", ",", "\n", "[", "0.0", ",", "0.0", ",", "0.0", "]", ",", "\n", "[", "1.0", ",", "2.0", ",", "1.0", "]", "]", "]", "\n", "\n", "Ky", "=", "[", "[", "[", "-", "1.0", ",", "-", "2.0", ",", "-", "1.0", "]", ",", "\n", "[", "-", "2.0", ",", "-", "4.0", ",", "-", "2.0", "]", ",", "\n", "[", "-", "1.0", ",", "-", "2.0", ",", "-", "1.0", "]", "]", ",", "\n", "[", "[", "0.0", ",", "0.0", ",", "0.0", "]", ",", "\n", "[", "0.0", ",", "0.0", ",", "0.0", "]", ",", "\n", "[", "0.0", ",", "0.0", ",", "0.0", "]", "]", ",", "\n", "[", "[", "1.0", ",", "2.0", ",", "1.0", "]", ",", "\n", "[", "2.0", ",", "4.0", ",", "2.0", "]", ",", "\n", "[", "1.0", ",", "2.0", ",", "1.0", "]", "]", "]", "\n", "\n", "Kz", "=", "[", "[", "[", "-", "1.0", ",", "0.0", ",", "1.0", "]", ",", "\n", "[", "-", "2.0", ",", "0.0", ",", "2.0", "]", ",", "\n", "[", "-", "1.0", ",", "0.0", ",", "1.0", "]", "]", ",", "\n", "[", "[", "-", "2.0", ",", "0.0", ",", "2.0", "]", ",", "\n", "[", "-", "4.0", ",", "0.0", ",", "4.0", "]", ",", "\n", "[", "-", "2.0", ",", "0.0", ",", "2.0", "]", "]", ",", "\n", "[", "[", "-", "1.0", ",", "0.0", ",", "1.0", "]", ",", "\n", "[", "-", "2.0", ",", "0.0", ",", "2.0", "]", ",", "\n", "[", "-", "1.0", ",", "0.0", ",", "1.0", "]", "]", "]", "\n", "return", "Kx", ",", "Ky", ",", "Kz", "\n", "\n"]], "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.dilation": [[65, 80], ["torch.ones().type", "d_K.repeat.repeat", "torch.nn.functional.conv2d", "torch.ones().type", "d_K.repeat.repeat", "torch.nn.functional.conv3d", "torch.ones", "tensor.float", "torch.ones", "tensor.float"], "function", ["None"], ["", "", "def", "dilation", "(", "tensor", ",", "d", "=", "2", ",", "dim", "=", "2", ")", ":", "\n", "    ", "if", "dim", "==", "2", ":", "\n", "        ", "k_shape", "=", "2", "*", "d", "-", "1", "\n", "d_K", "=", "torch", ".", "ones", "(", "k_shape", ",", "k_shape", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "d_K", "=", "d_K", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "dil_tensor", "=", "torch", ".", "nn", ".", "functional", ".", "conv2d", "(", "input", "=", "tensor", ".", "float", "(", ")", ",", "\n", "weight", "=", "d_K", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ")", "\n", "return", "dil_tensor", "\n", "", "if", "dim", "==", "3", ":", "\n", "        ", "k_shape", "=", "2", "*", "d", "-", "1", "\n", "d_K", "=", "torch", ".", "ones", "(", "k_shape", ",", "k_shape", ",", "k_shape", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "d_K", "=", "d_K", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "dil_tensor", "=", "torch", ".", "nn", ".", "functional", ".", "conv3d", "(", "input", "=", "tensor", ".", "float", "(", ")", ",", "\n", "weight", "=", "d_K", ",", "stride", "=", "(", "1", ",", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ",", "1", ")", ")", "\n", "return", "dil_tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.compute_boundary_loss2D": [[82, 135], ["time.time", "boundaryLoss.create_kernel", "torch.tensor", "Kx_weight.repeat.repeat", "torch.nn.functional.conv2d", "torch.nn.functional.conv2d", "torch.tensor", "Ky_weight.repeat.repeat", "torch.nn.functional.conv2d", "torch.nn.functional.conv2d", "torch.sqrt", "torch.sqrt", "boundaryLoss.dilation", "boundaryLoss.dilation", "grad_gt[].bool", "grad_pred[].bool", "print", "grad_gt[].bool.any", "grad_pred[].bool.any", "torch.nonzero", "torch.nonzero", "torch.zeros().type", "torch.zeros().type", "torch.cdist", "torch.min", "torch.min", "torch.sum", "torch.sum", "mask_gt.unsqueeze().unsqueeze().float", "Kx_weight.repeat.float", "mask_pred.unsqueeze().unsqueeze().float", "Kx_weight.repeat.float", "mask_gt.unsqueeze().unsqueeze().float", "Ky_weight.repeat.float", "mask_pred.unsqueeze().unsqueeze().float", "Ky_weight.repeat.float", "torch.nn.functional.conv2d.pow", "torch.nn.functional.conv2d.pow", "torch.nn.functional.conv2d.pow", "torch.nn.functional.conv2d.pow", "torch.nonzero.float", "torch.nonzero.float", "grad_gt[].bool.any", "grad_pred[].bool.any", "torch.tensor().type", "torch.tensor().type", "torch.tensor().type", "torch.tensor().type", "time.time", "torch.zeros", "torch.zeros", "mask_gt.unsqueeze().unsqueeze", "mask_pred.unsqueeze().unsqueeze", "mask_gt.unsqueeze().unsqueeze", "mask_pred.unsqueeze().unsqueeze", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "mask_gt.unsqueeze", "mask_pred.unsqueeze", "mask_gt.unsqueeze", "mask_pred.unsqueeze"], "function", ["home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.create_kernel", "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.dilation", "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.dilation"], ["", "", "def", "compute_boundary_loss2D", "(", "mask_gt", ",", "mask_pred", ")", ":", "\n", "\n", "    ", "t1", "=", "time", ".", "time", "(", ")", "\n", "Kx", ",", "Ky", ",", "bi_K", "=", "create_kernel", "(", "2", ")", "\n", "\n", "Kx_weight", "=", "torch", ".", "tensor", "(", "[", "Kx", "]", ")", "\n", "Kx_weight", "=", "Kx_weight", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "grad_gt_x", "=", "torch", ".", "nn", ".", "functional", ".", "conv2d", "(", "input", "=", "mask_gt", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "\n", "weight", "=", "Kx_weight", ".", "float", "(", ")", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ")", "\n", "grad_pred_x", "=", "torch", ".", "nn", ".", "functional", ".", "conv2d", "(", "input", "=", "mask_pred", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "\n", "weight", "=", "Kx_weight", ".", "float", "(", ")", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ")", "\n", "\n", "Ky_weight", "=", "torch", ".", "tensor", "(", "[", "Ky", "]", ")", "\n", "Ky_weight", "=", "Ky_weight", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "grad_gt_y", "=", "torch", ".", "nn", ".", "functional", ".", "conv2d", "(", "input", "=", "mask_gt", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "\n", "weight", "=", "Ky_weight", ".", "float", "(", ")", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ")", "\n", "grad_pred_y", "=", "torch", ".", "nn", ".", "functional", ".", "conv2d", "(", "input", "=", "mask_pred", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "\n", "weight", "=", "Ky_weight", ".", "float", "(", ")", ",", "stride", "=", "(", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ")", ")", "\n", "\n", "grad_gt", "=", "torch", ".", "sqrt", "(", "grad_gt_x", ".", "pow", "(", "2", ")", "+", "grad_gt_y", ".", "pow", "(", "2", ")", ")", "\n", "grad_pred", "=", "torch", ".", "sqrt", "(", "grad_pred_x", ".", "pow", "(", "2", ")", "+", "grad_pred_y", ".", "pow", "(", "2", ")", ")", "\n", "\n", "grad_gt", "=", "dilation", "(", "grad_gt", ",", "4", ")", "\n", "grad_pred", "=", "dilation", "(", "grad_pred", ",", "4", ")", "\n", "\n", "borders_gt", "=", "grad_gt", "[", "0", ",", "0", ",", ":", ",", ":", "]", ".", "bool", "(", ")", "\n", "borders_pred", "=", "grad_pred", "[", "0", ",", "0", ",", ":", ",", ":", "]", ".", "bool", "(", ")", "\n", "\n", "if", "borders_gt", ".", "any", "(", ")", "&", "borders_pred", ".", "any", "(", ")", ":", "\n", "        ", "idx_nonzero_gt", "=", "torch", ".", "nonzero", "(", "borders_gt", ")", "\n", "idx_nonzero_pred", "=", "torch", ".", "nonzero", "(", "borders_pred", ")", "\n", "\n", "distances_gt_to_pred", "=", "torch", ".", "zeros", "(", "idx_nonzero_gt", ".", "shape", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "zeros", "(", "idx_nonzero_pred", ".", "shape", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "\n", "dist", "=", "torch", ".", "cdist", "(", "idx_nonzero_gt", ".", "float", "(", ")", ",", "idx_nonzero_pred", ".", "float", "(", ")", ")", "\n", "distances_gt_to_pred", "=", "torch", ".", "min", "(", "dist", ",", "dim", "=", "1", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "min", "(", "dist", ",", "dim", "=", "0", ")", "\n", "\n", "", "elif", "borders_gt", ".", "any", "(", ")", "or", "borders_pred", ".", "any", "(", ")", ":", "\n", "        ", "distances_gt_to_pred", "=", "torch", ".", "tensor", "(", "[", "2", "**", "20", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "tensor", "(", "[", "2", "**", "20", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "\n", "", "else", ":", "\n", "        ", "distances_gt_to_pred", "=", "torch", ".", "tensor", "(", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "tensor", "(", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "\n", "", "avg_dist_gt_to_pred", "=", "torch", ".", "sum", "(", "distances_gt_to_pred", ".", "values", ")", "/", "idx_nonzero_gt", ".", "shape", "[", "0", "]", "\n", "avg_dist_pred_to_gt", "=", "torch", ".", "sum", "(", "distances_pred_to_gt", ".", "values", ")", "/", "idx_nonzero_pred", ".", "shape", "[", "0", "]", "\n", "\n", "print", "(", "time", ".", "time", "(", ")", "-", "t1", ")", "\n", "\n", "return", "(", "avg_dist_gt_to_pred", "+", "avg_dist_pred_to_gt", ")", "/", "2", "\n", "\n"]], "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.compute_boundary_loss3D": [[137, 193], ["time.time", "boundaryLoss.create_kernel", "torch.tensor", "Kx_weight.repeat.repeat", "torch.nn.functional.conv3d", "torch.nn.functional.conv3d", "torch.tensor", "Ky_weight.repeat.repeat", "torch.nn.functional.conv3d", "torch.nn.functional.conv3d", "torch.tensor", "Kz_weight.repeat.repeat", "torch.nn.functional.conv3d", "torch.nn.functional.conv3d", "torch.sqrt", "torch.sqrt", "boundaryLoss.dilation", "boundaryLoss.dilation", "grad_gt[].bool", "grad_pred[].bool", "print", "grad_gt[].bool.any", "grad_pred[].bool.any", "torch.nonzero", "torch.nonzero", "torch.zeros().type", "torch.zeros().type", "torch.cdist", "torch.min", "torch.min", "torch.sum", "torch.sum", "mask_gt.unsqueeze().unsqueeze().float", "mask_pred.unsqueeze().unsqueeze().float", "mask_gt.unsqueeze().unsqueeze().float", "mask_pred.unsqueeze().unsqueeze().float", "mask_gt.unsqueeze().unsqueeze().float", "mask_pred.unsqueeze().unsqueeze().float", "torch.nn.functional.conv3d.pow", "torch.nn.functional.conv3d.pow", "torch.nonzero.float().cuda", "torch.nonzero.float().cuda", "grad_gt[].bool.any", "grad_pred[].bool.any", "torch.tensor().type", "torch.tensor().type", "torch.tensor().type", "torch.tensor().type", "time.time", "torch.nn.functional.conv3d.pow", "torch.nn.functional.conv3d.pow", "torch.nn.functional.conv3d.pow", "torch.nn.functional.conv3d.pow", "torch.zeros", "torch.zeros", "mask_gt.unsqueeze().unsqueeze", "mask_pred.unsqueeze().unsqueeze", "mask_gt.unsqueeze().unsqueeze", "mask_pred.unsqueeze().unsqueeze", "mask_gt.unsqueeze().unsqueeze", "mask_pred.unsqueeze().unsqueeze", "torch.nonzero.float", "torch.nonzero.float", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "mask_gt.unsqueeze", "mask_pred.unsqueeze", "mask_gt.unsqueeze", "mask_pred.unsqueeze", "mask_gt.unsqueeze", "mask_pred.unsqueeze"], "function", ["home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.create_kernel", "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.dilation", "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.dilation"], ["", "def", "compute_boundary_loss3D", "(", "mask_gt", ",", "mask_pred", ")", ":", "\n", "\n", "    ", "t1", "=", "time", ".", "time", "(", ")", "\n", "\n", "Kx", ",", "Ky", ",", "Kz", "=", "create_kernel", "(", "3", ")", "\n", "\n", "Kx_weight", "=", "torch", ".", "tensor", "(", "[", "Kx", "]", ")", "\n", "Kx_weight", "=", "Kx_weight", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "grad_gt_x", "=", "torch", ".", "nn", ".", "functional", ".", "conv3d", "(", "input", "=", "mask_gt", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "weight", "=", "Kx_weight", ",", "stride", "=", "(", "1", ",", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ",", "1", ")", ")", "\n", "grad_pred_x", "=", "torch", ".", "nn", ".", "functional", ".", "conv3d", "(", "input", "=", "mask_pred", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "weight", "=", "Kx_weight", ",", "stride", "=", "(", "1", ",", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ",", "1", ")", ")", "\n", "\n", "Ky_weight", "=", "torch", ".", "tensor", "(", "[", "Ky", "]", ")", "\n", "Ky_weight", "=", "Ky_weight", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "grad_gt_y", "=", "torch", ".", "nn", ".", "functional", ".", "conv3d", "(", "input", "=", "mask_gt", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "weight", "=", "Ky_weight", ",", "stride", "=", "(", "1", ",", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ",", "1", ")", ")", "\n", "grad_pred_y", "=", "torch", ".", "nn", ".", "functional", ".", "conv3d", "(", "input", "=", "mask_pred", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "weight", "=", "Ky_weight", ",", "stride", "=", "(", "1", ",", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ",", "1", ")", ")", "\n", "\n", "Kz_weight", "=", "torch", ".", "tensor", "(", "[", "Kz", "]", ")", "\n", "Kz_weight", "=", "Kz_weight", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "1", ",", "1", ")", "\n", "grad_gt_z", "=", "torch", ".", "nn", ".", "functional", ".", "conv3d", "(", "input", "=", "mask_gt", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "weight", "=", "Kz_weight", ",", "stride", "=", "(", "1", ",", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ",", "1", ")", ")", "\n", "grad_pred_z", "=", "torch", ".", "nn", ".", "functional", ".", "conv3d", "(", "input", "=", "mask_pred", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", ".", "float", "(", ")", ",", "weight", "=", "Kz_weight", ",", "stride", "=", "(", "1", ",", "1", ",", "1", ")", ",", "padding", "=", "(", "1", ",", "1", ",", "1", ")", ")", "\n", "\n", "grad_gt", "=", "torch", ".", "sqrt", "(", "grad_gt_x", ".", "pow", "(", "2", ")", "+", "grad_gt_y", ".", "pow", "(", "2", ")", "+", "grad_gt_z", ".", "pow", "(", "2", ")", ")", "\n", "grad_pred", "=", "torch", ".", "sqrt", "(", "grad_pred_x", ".", "pow", "(", "2", ")", "+", "grad_pred_y", ".", "pow", "(", "2", ")", "+", "grad_pred_z", ".", "pow", "(", "2", ")", ")", "\n", "\n", "grad_gt", "=", "dilation", "(", "grad_gt", ",", "3", ",", "3", ")", "\n", "grad_pred", "=", "dilation", "(", "grad_pred", ",", "3", ",", "3", ")", "\n", "\n", "borders_gt", "=", "grad_gt", "[", "0", ",", "0", ",", ":", ",", ":", ",", ":", "]", ".", "bool", "(", ")", "\n", "borders_pred", "=", "grad_pred", "[", "0", ",", "0", ",", ":", ",", ":", ",", ":", "]", ".", "bool", "(", ")", "\n", "\n", "if", "borders_gt", ".", "any", "(", ")", "&", "borders_pred", ".", "any", "(", ")", ":", "\n", "        ", "idx_nonzero_gt", "=", "torch", ".", "nonzero", "(", "borders_gt", ")", "\n", "idx_nonzero_pred", "=", "torch", ".", "nonzero", "(", "borders_pred", ")", "\n", "\n", "distances_gt_to_pred", "=", "torch", ".", "zeros", "(", "idx_nonzero_gt", ".", "shape", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "zeros", "(", "idx_nonzero_pred", ".", "shape", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "\n", "dist", "=", "torch", ".", "cdist", "(", "idx_nonzero_gt", ".", "float", "(", ")", ".", "cuda", "(", ")", ",", "idx_nonzero_pred", ".", "float", "(", ")", ".", "cuda", "(", ")", ")", "\n", "\n", "distances_gt_to_pred", "=", "torch", ".", "min", "(", "dist", ",", "dim", "=", "1", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "min", "(", "dist", ",", "dim", "=", "0", ")", "\n", "\n", "", "elif", "borders_gt", ".", "any", "(", ")", "or", "borders_pred", ".", "any", "(", ")", ":", "\n", "        ", "distances_gt_to_pred", "=", "torch", ".", "tensor", "(", "[", "2", "**", "20", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "tensor", "(", "[", "2", "**", "20", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "\n", "", "else", ":", "\n", "        ", "distances_gt_to_pred", "=", "torch", ".", "tensor", "(", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "distances_pred_to_gt", "=", "torch", ".", "tensor", "(", "[", "0", "]", ")", ".", "type", "(", "torch", ".", "float", ")", "\n", "\n", "", "avg_dist_gt_to_pred", "=", "torch", ".", "sum", "(", "distances_gt_to_pred", ".", "values", ")", "/", "idx_nonzero_gt", ".", "shape", "[", "0", "]", "\n", "avg_dist_pred_to_gt", "=", "torch", ".", "sum", "(", "distances_pred_to_gt", ".", "values", ")", "/", "idx_nonzero_pred", ".", "shape", "[", "0", "]", "\n", "\n", "print", "(", "time", ".", "time", "(", ")", "-", "t1", ")", "\n", "\n", "return", "(", "avg_dist_gt_to_pred", "+", "avg_dist_pred_to_gt", ")", "/", "2", "\n", "\n"]], "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.boundaryLoss.bitmp": [[195, 209], ["numpy.array", "numpy.split", "r.reshape.reshape", "r.reshape.reshape", "r.reshape.reshape", "list", "numpy.array().reshape", "numpy.dot", "PIL.Image.fromarray", "map", "np.dot.astype", "zip", "numpy.array"], "function", ["None"], ["", "def", "bitmp", "(", "img", ")", ":", "\n", "    ", "ary", "=", "np", ".", "array", "(", "img", ")", "\n", "\n", "r", ",", "g", ",", "b", "=", "np", ".", "split", "(", "ary", ",", "3", ",", "axis", "=", "2", ")", "\n", "r", "=", "r", ".", "reshape", "(", "-", "1", ")", "\n", "g", "=", "r", ".", "reshape", "(", "-", "1", ")", "\n", "b", "=", "r", ".", "reshape", "(", "-", "1", ")", "\n", "\n", "bitmap", "=", "list", "(", "map", "(", "lambda", "x", ":", "0.299", "*", "x", "[", "0", "]", "+", "0.587", "*", "x", "[", "1", "]", "+", "0.114", "*", "x", "[", "2", "]", ",", "\n", "zip", "(", "r", ",", "g", ",", "b", ")", ")", ")", "\n", "bitmap", "=", "np", ".", "array", "(", "bitmap", ")", ".", "reshape", "(", "[", "ary", ".", "shape", "[", "0", "]", ",", "ary", ".", "shape", "[", "1", "]", "]", ")", "\n", "bitmap", "=", "np", ".", "dot", "(", "(", "bitmap", ">", "128", ")", ".", "astype", "(", "float", ")", ",", "255", ")", "\n", "img_b", "=", "Image", ".", "fromarray", "(", "bitmap", ".", "astype", "(", "np", ".", "uint8", ")", ")", "\n", "return", "img_b", "\n", "\n"]], "home.repos.pwc.inspect_result.Vidhiwar_loss-metrics-compile.lib.roughnessIndex.compute_roughness_index": [[8, 62], ["mask.astype.astype", "numpy.zeros", "range", "scipy.ndimage.filters.correlate", "scipy.ndimage.filters.correlate", "scipy.ndimage.filters.correlate", "numpy.zeros_like", "numpy.zeros_like", "border_layer_prev.any", "border_layer_next.any", "layer_prev.astype", "layer.astype", "layer_next.astype", "scipy.ndimage.morphology.distance_transform_edt", "scipy.ndimage.morphology.distance_transform_edt", "numpy.nonzero", "numpy.nonzero", "numpy.arctan"], "function", ["None"], ["def", "compute_roughness_index", "(", "mask", ")", ":", "\n", "    ", "\"\"\"\n    This function is used to calculate the roughness index of a 3D  surface.\n    The roughness index is the angle that a boundary element in one layer \n    makes with the corresponding boundary element of another layer.\n    \n    args:\n    mask: a 3D numpy vector that is the mask of an object.\n    \n    Returns:\n    roughness_index: a 4D numpy vector countaining the normal angle of each \n    boundary element in one layer to the corresponding neighbouring layers boundary elements.\n    \"\"\"", "\n", "mask", "=", "mask", ".", "astype", "(", "bool", ")", "\n", "roughness_index", "=", "np", ".", "zeros", "(", "mask", ".", "shape", "+", "(", "2", ",", ")", ",", "np", ".", "float", ")", "\n", "\n", "for", "i", "in", "range", "(", "1", ",", "mask", ".", "shape", "[", "0", "]", "-", "1", ")", ":", "\n", "\n", "#seperating the current, previous and next layer", "\n", "        ", "layer_prev", "=", "mask", "[", "i", "-", "1", ",", ":", ",", ":", "]", "\n", "layer_next", "=", "mask", "[", "i", "+", "1", ",", ":", ",", ":", "]", "\n", "layer", "=", "mask", "[", "i", ",", ":", ",", ":", "]", "\n", "\n", "#Finding the border elements in each layer", "\n", "kernel", "=", "[", "[", "8", ",", "4", "]", ",", "[", "2", ",", "1", "]", "]", "\n", "neighbour_code_map_layer_prev", "=", "ndimage", ".", "filters", ".", "correlate", "(", "layer_prev", ".", "astype", "(", "np", ".", "uint8", ")", ",", "kernel", ",", "mode", "=", "\"constant\"", ",", "cval", "=", "0", ")", "\n", "neighbour_code_map_layer", "=", "ndimage", ".", "filters", ".", "correlate", "(", "layer", ".", "astype", "(", "np", ".", "uint8", ")", ",", "kernel", ",", "mode", "=", "\"constant\"", ",", "cval", "=", "0", ")", "\n", "neighbour_code_map_layer_next", "=", "ndimage", ".", "filters", ".", "correlate", "(", "layer_next", ".", "astype", "(", "np", ".", "uint8", ")", ",", "kernel", ",", "mode", "=", "\"constant\"", ",", "cval", "=", "0", ")", "\n", "\n", "border_layer_prev", "=", "(", "(", "neighbour_code_map_layer_prev", "!=", "0", ")", "&", "(", "neighbour_code_map_layer_prev", "!=", "15", ")", ")", "\n", "border_layer", "=", "(", "(", "neighbour_code_map_layer", "!=", "0", ")", "&", "(", "neighbour_code_map_layer", "!=", "15", ")", ")", "\n", "border_layer_next", "=", "(", "(", "neighbour_code_map_layer_next", "!=", "0", ")", "&", "(", "neighbour_code_map_layer_next", "!=", "15", ")", ")", "\n", "\n", "#computing distance eucladian distance transform for each element in a layer", "\n", "distmap_layer_prev", "=", "np", ".", "zeros_like", "(", "border_layer_prev", ")", "\n", "distmap_layer_next", "=", "np", ".", "zeros_like", "(", "border_layer_next", ")", "\n", "\n", "if", "border_layer_prev", ".", "any", "(", ")", ":", "\n", "            ", "distmap_layer_prev", "=", "ndimage", ".", "morphology", ".", "distance_transform_edt", "(", "\n", "~", "border_layer_prev", ",", "sampling", "=", "[", "1", ",", "1", "]", ")", "\n", "\n", "", "if", "border_layer_next", ".", "any", "(", ")", ":", "\n", "            ", "distmap_layer_next", "=", "ndimage", ".", "morphology", ".", "distance_transform_edt", "(", "\n", "~", "border_layer_next", ",", "sampling", "=", "[", "1", ",", "1", "]", ")", "\n", "\n", "", "idx", "=", "np", ".", "nonzero", "(", "border_layer", ")", "[", "0", "]", "\n", "idy", "=", "np", ".", "nonzero", "(", "border_layer", ")", "[", "1", "]", "\n", "\n", "roughness_index", "[", "i", ",", "idx", ",", "idy", ",", "0", "]", "=", "distmap_layer_prev", "[", "idx", ",", "idy", "]", "\n", "roughness_index", "[", "i", ",", "idx", ",", "idy", ",", "1", "]", "=", "distmap_layer_next", "[", "idx", ",", "idy", "]", "\n", "\n", "", "roughness_index", "=", "np", ".", "arctan", "(", "roughness_index", ")", "*", "180", "/", "np", ".", "pi", "\n", "\n", "return", "roughness_index", "\n", "\n"]]}