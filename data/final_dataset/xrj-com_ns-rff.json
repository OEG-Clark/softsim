{"home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_TS_CNN_L2softmax.Confs.__init__": [[6, 8], ["src.trainer.RFFConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "None", ",", "d2", "=", "32", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_TS_CNN_L2softmax.Confs.get_flag": [[9, 13], ["None"], "methods", ["None"], ["", "def", "get_flag", "(", "self", ")", ":", "\n", "        ", "self", ".", "eval_model", "=", "CLF_L2Softmax", "\n", "self", ".", "data_idx", "=", "-", "1", "\n", "self", ".", "flag", "=", "'Baseline-TS-CNN-L2softmax-snr{}-d2={}-nz={}'", ".", "format", "(", "self", ".", "train_snr", ",", "self", ".", "d2", ",", "self", ".", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_TS_CNN_L2softmax.Trainer.__init__": [[15, 18], ["trainer_baseline_TS_CNN_L2softmax.Confs.__init__", "src.trainer.RFFTrainer.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "8", ",", "d2", "=", "32", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "Confs", ".", "__init__", "(", "self", ",", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "RFFTrainer", ".", "__init__", "(", "self", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_NS_CNN_softmax.Confs.__init__": [[6, 8], ["src.trainer.RFFConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "None", ",", "d2", "=", "None", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_NS_CNN_softmax.Confs.get_flag": [[9, 13], ["None"], "methods", ["None"], ["", "def", "get_flag", "(", "self", ")", ":", "\n", "        ", "self", ".", "eval_model", "=", "NS_CLF_Softmax", "\n", "self", ".", "data_idx", "=", "0", "\n", "self", ".", "flag", "=", "'Baseline-NS-CNN-softmax-snr{}-d1={}-d2={}-nz={}'", ".", "format", "(", "self", ".", "train_snr", ",", "self", ".", "d1", ",", "self", ".", "d2", ",", "self", ".", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_NS_CNN_softmax.Trainer.__init__": [[15, 18], ["trainer_baseline_NS_CNN_softmax.Confs.__init__", "src.trainer.RFFTrainer.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "8", ",", "d2", "=", "16", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "Confs", ".", "__init__", "(", "self", ",", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "RFFTrainer", ".", "__init__", "(", "self", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_TS_CNN_softmax.Confs.__init__": [[6, 8], ["src.trainer.RFFConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "None", ",", "d2", "=", "32", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_TS_CNN_softmax.Confs.get_flag": [[9, 13], ["None"], "methods", ["None"], ["", "def", "get_flag", "(", "self", ")", ":", "\n", "        ", "self", ".", "eval_model", "=", "CLF_Softmax", "\n", "self", ".", "data_idx", "=", "-", "1", "\n", "self", ".", "flag", "=", "'Baseline-TS-CNN-softmax-snr{}-d2={}=z_dim={}'", ".", "format", "(", "self", ".", "train_snr", ",", "self", ".", "d2", ",", "self", ".", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_TS_CNN_softmax.Trainer.__init__": [[15, 18], ["trainer_baseline_TS_CNN_softmax.Confs.__init__", "src.trainer.RFFTrainer.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "8", ",", "d2", "=", "32", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "Confs", ".", "__init__", "(", "self", ",", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "RFFTrainer", ".", "__init__", "(", "self", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_NS_CNN_L2softmax.Confs.__init__": [[5, 7], ["src.trainer.RFFConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "None", ",", "d2", "=", "None", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_NS_CNN_L2softmax.Confs.get_flag": [[8, 12], ["None"], "methods", ["None"], ["", "def", "get_flag", "(", "self", ")", ":", "\n", "        ", "self", ".", "eval_model", "=", "NS_CLF_L2Softmax", "\n", "self", ".", "data_idx", "=", "0", "\n", "self", ".", "flag", "=", "'Baseline-NS-CNN-L2softmax-snr{}-d1={}-d2={}-nz={}'", ".", "format", "(", "self", ".", "train_snr", ",", "self", ".", "d1", ",", "self", ".", "d2", ",", "self", ".", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_NS_CNN_L2softmax.Trainer.__init__": [[14, 17], ["trainer_baseline_NS_CNN_L2softmax.Confs.__init__", "src.trainer.RFFTrainer.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "8", ",", "d2", "=", "24", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "Confs", ".", "__init__", "(", "self", ",", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "RFFTrainer", ".", "__init__", "(", "self", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_CNN_softmax.Confs.__init__": [[5, 7], ["src.trainer.RFFConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "None", ",", "d2", "=", "16", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_CNN_softmax.Confs.get_flag": [[8, 12], ["None"], "methods", ["None"], ["", "def", "get_flag", "(", "self", ")", ":", "\n", "        ", "self", ".", "eval_model", "=", "CLF_Softmax", "\n", "self", ".", "data_idx", "=", "0", "\n", "self", ".", "flag", "=", "'Baseline-CNN-softmax-snr{}-d2={}-nz={}'", ".", "format", "(", "self", ".", "train_snr", ",", "self", ".", "d2", ",", "self", ".", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_CNN_softmax.Trainer.__init__": [[14, 17], ["trainer_baseline_CNN_softmax.Confs.__init__", "src.trainer.RFFTrainer.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "8", ",", "d2", "=", "16", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "Confs", ".", "__init__", "(", "self", ",", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "RFFTrainer", ".", "__init__", "(", "self", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_CNN_L2softmax.Confs.__init__": [[5, 7], ["src.trainer.RFFConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "None", ",", "d2", "=", "32", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_CNN_L2softmax.Confs.get_flag": [[8, 12], ["None"], "methods", ["None"], ["", "def", "get_flag", "(", "self", ")", ":", "\n", "        ", "self", ".", "eval_model", "=", "CLF_L2Softmax", "\n", "self", ".", "data_idx", "=", "0", "\n", "self", ".", "flag", "=", "'Baseline-CNN-L2softmax-snr{}-d2={}-nz={}'", ".", "format", "(", "self", ".", "train_snr", ",", "self", ".", "d2", ",", "self", ".", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.None.trainer_baseline_CNN_L2softmax.Trainer.__init__": [[14, 17], ["trainer_baseline_CNN_L2softmax.Confs.__init__", "src.trainer.RFFTrainer.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", "=", "None", ",", "device", "=", "0", ",", "d1", "=", "8", ",", "d2", "=", "16", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "Confs", ".", "__init__", "(", "self", ",", "train_snr", ",", "device", ",", "d1", ",", "d2", ",", "z_dim", ")", "\n", "RFFTrainer", ".", "__init__", "(", "self", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NormalizedModel.__init__": [[12, 14], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ")", "->", "None", ":", "\n", "        ", "super", "(", "NormalizedModel", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NormalizedModel.forward": [[15, 22], ["input.mean", "input.std"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ":", "torch", ".", "Tensor", ")", "->", "torch", ".", "Tensor", ":", "\n", "# mean = input.mean(dim=2, keepdim=True).repeat(1, 1, 1280, 1)", "\n", "# std = input.std(dim=2, keepdim=True).repeat(1, 1, 1280, 1)", "\n", "        ", "mean", "=", "input", ".", "mean", "(", ")", "\n", "std", "=", "input", ".", "std", "(", ")", "\n", "normalized_input", "=", "(", "input", "-", "mean", ")", "/", "std", "\n", "return", "normalized_input", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.ArcMarginProduct.__init__": [[32, 46], ["torch.Module.__init__", "torch.Parameter", "torch.Parameter", "torch.Parameter", "torch.init.xavier_uniform_", "torch.init.xavier_uniform_", "torch.init.xavier_uniform_", "math.cos", "math.sin", "math.cos", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "math.sin"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["def", "__init__", "(", "self", ",", "in_features", ",", "out_features", ",", "s", "=", "30.0", ",", "m", "=", "0.50", ",", "easy_margin", "=", "False", ")", ":", "\n", "        ", "super", "(", "ArcMarginProduct", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "in_features", "=", "in_features", "\n", "self", ".", "out_features", "=", "out_features", "\n", "self", ".", "s", "=", "s", "\n", "self", ".", "m", "=", "m", "\n", "self", ".", "weight", "=", "nn", ".", "Parameter", "(", "torch", ".", "FloatTensor", "(", "out_features", ",", "in_features", ")", ")", "\n", "nn", ".", "init", ".", "xavier_uniform_", "(", "self", ".", "weight", ")", "\n", "\n", "self", ".", "easy_margin", "=", "easy_margin", "\n", "self", ".", "cos_m", "=", "math", ".", "cos", "(", "m", ")", "\n", "self", ".", "sin_m", "=", "math", ".", "sin", "(", "m", ")", "\n", "self", ".", "th", "=", "math", ".", "cos", "(", "math", ".", "pi", "-", "m", ")", "\n", "self", ".", "mm", "=", "math", ".", "sin", "(", "math", ".", "pi", "-", "m", ")", "*", "m", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.ArcMarginProduct.forward": [[47, 67], ["torch.linear", "torch.linear", "torch.linear", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.zeros.scatter_", "torch.linear", "torch.linear", "torch.linear", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.normalize", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.where", "torch.linear.size", "label.view().long", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "torch.pow", "label.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "label", "=", "None", ")", ":", "\n", "        ", "if", "label", "is", "None", ":", "\n", "            ", "return", "F", ".", "linear", "(", "input", ",", "self", ".", "weight", ")", "\n", "# --------------------------- cos(theta) & phi(theta) ---------------------------", "\n", "", "cosine", "=", "F", ".", "linear", "(", "F", ".", "normalize", "(", "input", ")", ",", "F", ".", "normalize", "(", "self", ".", "weight", ")", ")", "\n", "sine", "=", "torch", ".", "sqrt", "(", "1.0", "-", "torch", ".", "pow", "(", "cosine", ",", "2", ")", ")", "\n", "phi", "=", "cosine", "*", "self", ".", "cos_m", "-", "sine", "*", "self", ".", "sin_m", "\n", "if", "self", ".", "easy_margin", ":", "\n", "            ", "phi", "=", "torch", ".", "where", "(", "cosine", ">", "0", ",", "phi", ",", "cosine", ")", "\n", "", "else", ":", "\n", "            ", "phi", "=", "torch", ".", "where", "(", "cosine", ">", "self", ".", "th", ",", "phi", ",", "cosine", "-", "self", ".", "mm", ")", "\n", "# --------------------------- convert label to one-hot ---------------------------", "\n", "# one_hot = torch.zeros(cosine.size(), requires_grad=True, device='cuda')", "\n", "", "one_hot", "=", "torch", ".", "zeros", "(", "cosine", ".", "size", "(", ")", ",", "device", "=", "input", ".", "device", ")", "\n", "one_hot", ".", "scatter_", "(", "1", ",", "label", ".", "view", "(", "-", "1", ",", "1", ")", ".", "long", "(", ")", ",", "1", ")", "\n", "# -------------torch.where(out_i = {x_i if condition_i else y_i) -------------", "\n", "output", "=", "(", "one_hot", "*", "phi", ")", "+", "(", "(", "1.0", "-", "one_hot", ")", "*", "cosine", ")", "# you can use torch.where if your torch.__version__ is 0.4", "\n", "output", "*=", "self", ".", "s", "\n", "# print(output)", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF.__init__": [[70, 96], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Linear", "torch.Linear", "torch.Linear", "models.NormalizedModel", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Dropout", "torch.Dropout", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "1", ",", "out_channels", "=", "10", ",", "d", "=", "64", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "# Output_dim = 1", "\n", "self", ".", "main_module", "=", "nn", ".", "Sequential", "(", "\n", "# Image (1x1280x2)", "\n", "NormalizedModel", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "2", "*", "d", ",", "kernel_size", "=", "(", "10", ",", "1", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "5", ",", "0", ")", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "nn", ".", "MaxPool2d", "(", "(", "4", ",", "1", ")", ")", ",", "\n", "\n", "# State (128x320x2)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "2", "*", "d", ",", "out_channels", "=", "4", "*", "d", ",", "kernel_size", "=", "(", "3", ",", "2", ")", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", ",", "\n", "# nn.BatchNorm2d(512),", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "nn", ".", "MaxPool2d", "(", "(", "4", ",", "1", ")", ")", ",", "\n", "\n", "# State (256x80x3)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "4", "*", "d", ",", "out_channels", "=", "4", "*", "d", ",", "kernel_size", "=", "(", "80", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", ",", "\n", "# nn.BatchNorm2d(1024),", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "nn", ".", "Dropout", "(", "p", "=", "0.5", ")", "\n", ")", "\n", "# outptut of main module --> State (1024x4x4)", "\n", "\n", "self", ".", "output", "=", "nn", ".", "Linear", "(", "4", "*", "d", ",", "out_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF.forward": [[98, 102], ["models.BaseCLF.features", "models.BaseCLF.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "features", "(", "input", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF.features": [[103, 107], ["len", "models.BaseCLF.main_module().view", "models.BaseCLF.main_module"], "methods", ["None"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", "=", "len", "(", "input", ")", "\n", "out", "=", "self", ".", "main_module", "(", "input", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF2.__init__": [[109, 146], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "2", ",", "out_dim", "=", "1", ",", "d", "=", "4", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "d", "=", "d", "\n", "self", ".", "main_module", "=", "nn", ".", "Sequential", "(", "\n", "# Image (2x16x80)", "\n", "# NormalizedModel(),", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "self", ".", "d", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (dx16x80)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", ",", "out_channels", "=", "self", ".", "d", "*", "2", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "2", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (2dx16x80)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "2", ",", "out_channels", "=", "self", ".", "d", "*", "4", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "2", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "4", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (4dx8x40)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "4", ",", "out_channels", "=", "self", ".", "d", "*", "8", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "8", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (8dx8x40)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "8", ",", "out_channels", "=", "self", ".", "d", "*", "16", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "2", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "16", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (16dx4x20)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "16", ",", "out_channels", "=", "self", ".", "d", "*", "32", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "2", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "32", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (32dx2x10)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "32", ",", "out_channels", "=", "out_dim", ",", "kernel_size", "=", "(", "2", ",", "10", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "0", ",", "0", ")", ")", ",", "\n", "# nn.BatchNorm2d(out_dim), ", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF2.forward": [[151, 155], ["models.BaseCLF2.features"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "features", "(", "input", ")", "\n", "# out = self.output(out)", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF2.features": [[156, 161], ["input.view().permute().flatten().view", "models.BaseCLF2.main_module().view", "input.view().permute().flatten", "models.BaseCLF2.main_module", "input.view().permute", "input.view"], "methods", ["None"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "input_img", "=", "input", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", ".", "flatten", "(", ")", ".", "view", "(", "N", ",", "-", "1", ",", "16", ",", "80", ")", "\n", "out", "=", "self", ".", "main_module", "(", "input_img", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF3.__init__": [[163, 205], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Dropout", "torch.Dropout", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "2", ",", "out_channels", "=", "1", ",", "d", "=", "4", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "d", "=", "d", "\n", "self", ".", "main_module", "=", "nn", ".", "Sequential", "(", "\n", "# Image (2x16x80)", "\n", "# NormalizedModel(),", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "self", ".", "d", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (dx16x80)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", ",", "out_channels", "=", "self", ".", "d", "*", "2", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "2", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (2dx16x80)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "2", ",", "out_channels", "=", "self", ".", "d", "*", "4", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "2", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "4", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (4dx8x40)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "4", ",", "out_channels", "=", "self", ".", "d", "*", "8", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "8", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (8dx8x40)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "8", ",", "out_channels", "=", "self", ".", "d", "*", "16", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "2", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "self", ".", "d", "*", "16", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (16dx4x20)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "16", ",", "out_channels", "=", "self", ".", "d", "*", "32", ",", "kernel_size", "=", "(", "3", ",", "3", ")", ",", "stride", "=", "2", ",", "padding", "=", "(", "1", ",", "1", ")", ")", ",", "\n", "# nn.BatchNorm2d(self.d*32),", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "\n", "# State (32dx2x10)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "d", "*", "32", ",", "out_channels", "=", "512", ",", "kernel_size", "=", "(", "2", ",", "10", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "0", ",", "0", ")", ")", ",", "\n", "# nn.BatchNorm2d(512),", "\n", "nn", ".", "Dropout", "(", "p", "=", "0.5", ")", "\n", ")", "\n", "# outptut of main module --> State (1024x4x4)", "\n", "self", ".", "output", "=", "nn", ".", "Linear", "(", "512", ",", "out_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF3.forward": [[207, 211], ["models.BaseCLF3.features", "models.BaseCLF3.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "features", "(", "input", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.BaseCLF3.features": [[212, 217], ["input.view().permute().flatten().view", "models.BaseCLF3.main_module().view", "input.view().permute().flatten", "models.BaseCLF3.main_module", "input.view().permute", "input.view"], "methods", ["None"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "input_img", "=", "input", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", ".", "flatten", "(", ")", ".", "view", "(", "N", ",", "-", "1", ",", "16", ",", "80", ")", "\n", "out", "=", "self", ".", "main_module", "(", "input_img", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.Synchronization.__init__": [[219, 223], ["torch.Module.__init__", "models.BaseCLF2", "models.BaseCLF2"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "d", "=", "4", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "freq_estimation", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "1", ",", "d", "=", "d", ")", "\n", "self", ".", "phase_estimation", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "1", ",", "d", "=", "d", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.Synchronization.forward": [[224, 231], ["models.Synchronization.freq_estimation().view", "freq_compensation", "models.Synchronization.phase_estimation().view", "phase_compensation", "input.view", "phase_compensation.view", "phase_compensation.view", "models.Synchronization.freq_estimation", "models.Synchronization.phase_estimation", "input.view", "phase_compensation.view"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.freq_compensation", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.phase_compensation"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "freq_offset", "=", "self", ".", "freq_estimation", "(", "input", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ")", ".", "view", "(", "-", "1", ")", "\n", "out", "=", "freq_compensation", "(", "input", ".", "view", "(", "N", ",", "T", ",", "-", "1", ")", ",", "freq_offset", ")", "\n", "phase_offset", "=", "self", ".", "phase_estimation", "(", "out", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ")", ".", "view", "(", "-", "1", ")", "\n", "out", "=", "phase_compensation", "(", "out", ".", "view", "(", "N", ",", "T", ",", "-", "1", ")", ",", "phase_offset", ")", "\n", "return", "out", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ",", "freq_offset", ",", "phase_offset", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.SynchronizationVis.__init__": [[233, 237], ["torch.Module.__init__", "models.BaseCLF", "models.BaseCLF"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "d", "=", "64", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "freq_estimation", "=", "BaseCLF", "(", "1", ",", "out_channels", "=", "1", ",", "d", "=", "d", ")", "\n", "self", ".", "phase_estimation", "=", "BaseCLF", "(", "1", ",", "out_channels", "=", "1", ",", "d", "=", "d", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.SynchronizationVis.forward": [[238, 245], ["models.SynchronizationVis.freq_estimation().view", "freq_compensation", "models.SynchronizationVis.phase_estimation().view", "phase_compensation", "input.view", "phase_compensation.view", "phase_compensation.view", "models.SynchronizationVis.freq_estimation", "models.SynchronizationVis.phase_estimation", "input.view", "phase_compensation.view"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.freq_compensation", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.phase_compensation"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "freq_offset", "=", "self", ".", "freq_estimation", "(", "input", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ")", ".", "view", "(", "-", "1", ")", "\n", "out", "=", "freq_compensation", "(", "input", ".", "view", "(", "N", ",", "T", ",", "-", "1", ")", ",", "freq_offset", ")", "\n", "phase_offset", "=", "self", ".", "phase_estimation", "(", "out", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ")", ".", "view", "(", "-", "1", ")", "\n", "out", "=", "phase_compensation", "(", "out", ".", "view", "(", "N", ",", "T", ",", "-", "1", ")", ",", "phase_offset", ")", "\n", "return", "out", ".", "view", "(", "N", ",", "1", ",", "T", ",", "2", ")", ",", "freq_offset", ",", "phase_offset", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_yjb.__init__": [[248, 274], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Linear", "torch.Linear", "torch.Linear", "models.NormalizedModel", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Dropout", "torch.Dropout", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "1", ",", "out_channels", "=", "10", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "# Output_dim = 1", "\n", "self", ".", "main_module", "=", "nn", ".", "Sequential", "(", "\n", "# Image (1x1280x2)", "\n", "NormalizedModel", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "1", ",", "out_channels", "=", "128", ",", "kernel_size", "=", "(", "10", ",", "1", ")", ",", "stride", "=", "1", ",", "padding", "=", "(", "5", ",", "0", ")", ")", ",", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "nn", ".", "MaxPool2d", "(", "(", "4", ",", "1", ")", ")", ",", "\n", "\n", "# State (128x320x2)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "128", ",", "out_channels", "=", "256", ",", "kernel_size", "=", "(", "3", ",", "2", ")", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", ",", "\n", "# nn.BatchNorm2d(512),", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "nn", ".", "MaxPool2d", "(", "(", "4", ",", "1", ")", ")", ",", "\n", "\n", "# State (256x80x3)", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "256", ",", "out_channels", "=", "z_dim", ",", "kernel_size", "=", "(", "80", ",", "3", ")", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", ",", "\n", "# nn.BatchNorm2d(1024),", "\n", "nn", ".", "LeakyReLU", "(", "0.2", ")", ",", "\n", "nn", ".", "Dropout", "(", "p", "=", "0.5", ")", "\n", ")", "\n", "# outptut of main module --> State (1024x4x4)", "\n", "\n", "self", ".", "output", "=", "nn", ".", "Linear", "(", "z_dim", ",", "out_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_yjb.forward": [[276, 280], ["models.CLF_yjb.features", "models.CLF_yjb.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "features", "(", "input", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_yjb.features": [[281, 285], ["len", "models.CLF_yjb.main_module().view", "models.CLF_yjb.main_module"], "methods", ["None"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", "=", "len", "(", "input", ")", "\n", "out", "=", "self", ".", "main_module", "(", "input", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_Softmax.__init__": [[288, 293], ["torch.Module.__init__", "models.BaseCLF2", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "out_channels", "=", "10", ",", "d1", "=", "8", ",", "d2", "=", "32", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "self", ".", "main_module", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "z_dim", ",", "d", "=", "d2", ")", "\n", "self", ".", "output", "=", "nn", ".", "Linear", "(", "z_dim", ",", "out_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_Softmax.forward": [[294, 299], ["models.CLF_Softmax.features", "models.CLF_Softmax.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "segment", "=", "input", "\n", "out", "=", "self", ".", "features", "(", "segment", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_Softmax.features": [[300, 305], ["models.CLF_Softmax.main_module.features().view", "models.CLF_Softmax.main_module.features"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "segment", "=", "input", "\n", "out", "=", "self", ".", "main_module", ".", "features", "(", "segment", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_L2Softmax.__init__": [[307, 312], ["torch.Module.__init__", "models.BaseCLF2", "models.ArcMarginProduct"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "out_channels", "=", "10", ",", "d1", "=", "8", ",", "d2", "=", "24", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "self", ".", "main_module", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "z_dim", ",", "d", "=", "d2", ")", "\n", "self", ".", "output", "=", "ArcMarginProduct", "(", "z_dim", ",", "out_channels", ",", "s", "=", "10", ",", "m", "=", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_L2Softmax.forward": [[313, 318], ["models.CLF_L2Softmax.features", "models.CLF_L2Softmax.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "segment", "=", "input", "\n", "out", "=", "self", ".", "features", "(", "segment", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ",", "labels", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.CLF_L2Softmax.features": [[319, 324], ["models.CLF_L2Softmax.main_module.features().view", "models.CLF_L2Softmax.main_module.features"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "segment", "=", "input", "\n", "out", "=", "self", ".", "main_module", ".", "features", "(", "segment", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_Softmax.__init__": [[326, 333], ["torch.Module.__init__", "models.Synchronization", "models.BaseCLF2", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "out_channels", "=", "10", ",", "d1", "=", "8", ",", "d2", "=", "24", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "# Output_dim = 1", "\n", "self", ".", "synchronization", "=", "Synchronization", "(", "d", "=", "d1", ")", "\n", "self", ".", "main_module", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "z_dim", ",", "d", "=", "d2", ")", "\n", "self", ".", "output", "=", "nn", ".", "Linear", "(", "z_dim", ",", "out_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_Softmax.forward": [[334, 339], ["models.NS_CLF_Softmax.features", "models.NS_CLF_Softmax.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "segment", "=", "input", "\n", "out", "=", "self", ".", "features", "(", "segment", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_Softmax.features": [[340, 345], ["models.NS_CLF_Softmax.synchronization", "models.NS_CLF_Softmax.main_module.features().view", "models.NS_CLF_Softmax.main_module.features"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "segment", ",", "_", ",", "_", "=", "self", ".", "synchronization", "(", "input", ")", "\n", "out", "=", "self", ".", "main_module", ".", "features", "(", "segment", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_Softmax_Vis.__init__": [[347, 354], ["torch.Module.__init__", "models.SynchronizationVis", "models.BaseCLF2", "torch.Linear", "torch.Linear", "torch.Linear"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "out_channels", "=", "10", ",", "d1", "=", "8", ",", "d2", "=", "24", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "# Output_dim = 1", "\n", "self", ".", "synchronization", "=", "SynchronizationVis", "(", "d1", ")", "\n", "self", ".", "main_module", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "z_dim", ",", "d", "=", "d2", ")", "\n", "self", ".", "output", "=", "nn", ".", "Linear", "(", "z_dim", ",", "out_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_Softmax_Vis.forward": [[355, 360], ["models.NS_CLF_Softmax_Vis.features", "models.NS_CLF_Softmax_Vis.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "segment", "=", "input", "\n", "out", "=", "self", ".", "features", "(", "segment", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_Softmax_Vis.features": [[361, 366], ["models.NS_CLF_Softmax_Vis.synchronization", "models.NS_CLF_Softmax_Vis.main_module.features().view", "models.NS_CLF_Softmax_Vis.main_module.features"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "segment", ",", "_", ",", "_", "=", "self", ".", "synchronization", "(", "input", ")", "\n", "out", "=", "self", ".", "main_module", ".", "features", "(", "segment", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax.__init__": [[368, 375], ["torch.Module.__init__", "models.Synchronization", "models.BaseCLF2", "models.ArcMarginProduct"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "out_channels", "=", "10", ",", "d1", "=", "8", ",", "d2", "=", "24", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "# Output_dim = 1", "\n", "self", ".", "synchronization", "=", "Synchronization", "(", "d", "=", "d1", ")", "\n", "self", ".", "main_module", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "z_dim", ",", "d", "=", "d2", ")", "\n", "self", ".", "output", "=", "ArcMarginProduct", "(", "z_dim", ",", "out_channels", ",", "s", "=", "10", ",", "m", "=", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax.forward": [[376, 381], ["models.NS_CLF_L2Softmax.features", "models.NS_CLF_L2Softmax.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "segment", "=", "input", "\n", "out", "=", "self", ".", "features", "(", "segment", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ",", "labels", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax.features": [[382, 387], ["models.NS_CLF_L2Softmax.synchronization", "models.NS_CLF_L2Softmax.main_module.features().view", "models.NS_CLF_L2Softmax.main_module.features"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "segment", ",", "_", ",", "_", "=", "self", ".", "synchronization", "(", "input", ")", "\n", "out", "=", "self", ".", "main_module", ".", "features", "(", "segment", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.__init__": [[389, 396], ["torch.Module.__init__", "models.SynchronizationVis", "models.BaseCLF2", "models.ArcMarginProduct"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "out_channels", "=", "10", ",", "d1", "=", "8", ",", "d2", "=", "24", ",", "z_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "# Input_dim = channels (1x1280x2)", "\n", "# Output_dim = 1", "\n", "self", ".", "synchronization", "=", "SynchronizationVis", "(", ")", "\n", "self", ".", "main_module", "=", "BaseCLF2", "(", "2", ",", "out_dim", "=", "z_dim", ",", "d", "=", "d2", ")", "\n", "self", ".", "output", "=", "ArcMarginProduct", "(", "z_dim", ",", "out_channels", ",", "s", "=", "10", ",", "m", "=", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.forward": [[397, 402], ["models.NS_CLF_L2Softmax_Vis.features", "models.NS_CLF_L2Softmax_Vis.output"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "forward", "(", "self", ",", "input", ",", "labels", "=", "None", ")", ":", "\n", "        ", "segment", "=", "input", "\n", "out", "=", "self", ".", "features", "(", "segment", ")", "\n", "out", "=", "self", ".", "output", "(", "out", ",", "labels", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features": [[403, 408], ["models.NS_CLF_L2Softmax_Vis.synchronization", "models.NS_CLF_L2Softmax_Vis.main_module.features().view", "models.NS_CLF_L2Softmax_Vis.main_module.features"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "features", "(", "self", ",", "input", ")", ":", "\n", "        ", "N", ",", "_", ",", "T", ",", "_", "=", "input", ".", "shape", "\n", "segment", ",", "_", ",", "_", "=", "self", ".", "synchronization", "(", "input", ")", "\n", "out", "=", "self", ".", "main_module", ".", "features", "(", "segment", ")", ".", "view", "(", "N", ",", "-", "1", ")", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFConfs.__init__": [[11, 19], ["marveltoolbox.BaseConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ",", "train_snr", ",", "device", "=", "0", ",", "d1", "=", "None", ",", "d2", "=", "None", ",", "z_dim", "=", "32", ")", ":", "\n", "        ", "self", ".", "train_snr", "=", "train_snr", "\n", "self", ".", "device", "=", "device", "\n", "self", ".", "device_ids", "=", "[", "device", "]", "\n", "self", ".", "d1", "=", "d1", "\n", "self", ".", "d2", "=", "d2", "\n", "self", ".", "z_dim", "=", "z_dim", "\n", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFConfs.get_dataset": [[20, 28], ["range"], "methods", ["None"], ["", "def", "get_dataset", "(", "self", ")", ":", "\n", "        ", "self", ".", "dataset", "=", "'zigbee'", "\n", "self", ".", "nc", "=", "2", "\n", "self", ".", "batch_size", "=", "64", "\n", "self", ".", "class_num", "=", "54", "\n", "self", ".", "epochs", "=", "150", "\n", "self", ".", "train_devices", "=", "range", "(", "45", ")", "\n", "self", ".", "train_ids", "=", "[", "1", ",", "2", ",", "3", ",", "4", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFConfs.get_flag": [[29, 33], ["None"], "methods", ["None"], ["", "def", "get_flag", "(", "self", ")", ":", "\n", "        ", "self", ".", "eval_model", "=", "NS_CLF_Arcface_old", "\n", "self", ".", "data_idx", "=", "0", "\n", "self", ".", "flag", "=", "'Baseline-CNS-CNN-arcface-old-snr{}-nz{}'", ".", "format", "(", "self", ".", "train_snr", ".", "self", ".", "z_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFConfs.get_device": [[34, 38], ["torch.device", "torch.device", "torch.device", "torch.device", "torch.device", "torch.device", "torch.device", "torch.device", "torch.device", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available", "torch.cuda.is_available"], "methods", ["None"], ["", "def", "get_device", "(", "self", ")", ":", "\n", "        ", "self", ".", "device", "=", "torch", ".", "device", "(", "\n", "\"cuda:{}\"", ".", "format", "(", "self", ".", "device", ")", "if", "torch", ".", "cuda", ".", "is_available", "(", ")", "else", "\"cpu\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFTrainer.__init__": [[41, 59], ["marveltoolbox.BaseTrainer.__init__", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "torch.optim.Adam", "dataset.RFdataset", "dataset.RFdataset", "trainer.RFFTrainer.preprocessing", "trainer.RFFTrainer.eval_model().to", "trainer.RFFTrainer.eval_model().to", "trainer.RFFTrainer.models[].parameters", "range", "trainer.RFFTrainer.eval_model", "trainer.RFFTrainer.eval_model"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "mt", ".", "BaseTrainer", ".", "__init__", "(", "self", ",", "self", ")", "\n", "if", "(", "not", "self", ".", "d1", "is", "None", ")", "and", "(", "not", "self", ".", "d2", "is", "None", ")", ":", "\n", "            ", "self", ".", "models", "[", "'C'", "]", "=", "self", ".", "eval_model", "(", "in_channels", "=", "self", ".", "nc", ",", "out_channels", "=", "self", ".", "class_num", ",", "d1", "=", "self", ".", "d1", ",", "d2", "=", "self", ".", "d2", ",", "z_dim", "=", "self", ".", "z_dim", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "models", "[", "'C'", "]", "=", "self", ".", "eval_model", "(", "in_channels", "=", "self", ".", "nc", ",", "out_channels", "=", "self", ".", "class_num", ",", "z_dim", "=", "self", ".", "z_dim", ")", ".", "to", "(", "self", ".", "device", ")", "\n", "\n", "", "self", ".", "optims", "[", "'C'", "]", "=", "torch", ".", "optim", ".", "Adam", "(", "\n", "self", ".", "models", "[", "'C'", "]", ".", "parameters", "(", ")", ",", "lr", "=", "1e-4", ",", "betas", "=", "(", "0.5", ",", "0.99", ")", ")", "\n", "\n", "self", ".", "datasets", "[", "'train'", "]", "=", "RFdataset", "(", "device_ids", "=", "self", ".", "train_devices", ",", "test_ids", "=", "self", ".", "train_ids", ",", "rand_max_SNR", "=", "self", ".", "train_snr", ")", "\n", "self", ".", "datasets", "[", "'open'", "]", "=", "RFdataset", "(", "device_ids", "=", "range", "(", "45", ",", "54", ")", ",", "test_ids", "=", "[", "1", ",", "2", ",", "3", ",", "4", ",", "5", "]", ",", "rand_max_SNR", "=", "None", ")", "\n", "# self.datasets['close'] = RFdataset(device_ids=range(45), test_ids=[5], rand_max_SNR=None)", "\n", "\n", "self", ".", "preprocessing", "(", ")", "\n", "\n", "self", ".", "records", "[", "'acc'", "]", "=", "0.0", "\n", "self", ".", "records", "[", "'auc'", "]", "=", "0.0", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFTrainer.train": [[60, 77], ["trainer.RFFTrainer.models[].train", "enumerate", "torch.cross_entropy.item", "torch.cross_entropy", "torch.cross_entropy", "torch.cross_entropy", "trainer.RFFTrainer.optims[].zero_grad", "torch.cross_entropy.backward", "trainer.RFFTrainer.optims[].step", "x.to", "y.to", "torch.cross_entropy.item", "trainer.RFFTrainer.print_logs"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFTrainer.train"], ["", "def", "train", "(", "self", ",", "epoch", ")", ":", "\n", "        ", "self", ".", "logs", "=", "{", "}", "\n", "self", ".", "models", "[", "'C'", "]", ".", "train", "(", ")", "\n", "for", "i", ",", "data", "in", "enumerate", "(", "self", ".", "dataloaders", "[", "'train'", "]", ")", ":", "\n", "            ", "x", ",", "y", "=", "data", "[", "self", ".", "data_idx", "]", ",", "data", "[", "1", "]", "\n", "x", ",", "y", "=", "x", ".", "to", "(", "self", ".", "device", ")", ",", "y", ".", "to", "(", "self", ".", "device", ")", "\n", "scores", "=", "self", ".", "models", "[", "'C'", "]", "(", "x", ",", "y", ")", "\n", "loss", "=", "F", ".", "cross_entropy", "(", "scores", ",", "y", ")", "\n", "self", ".", "optims", "[", "'C'", "]", ".", "zero_grad", "(", ")", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optims", "[", "'C'", "]", ".", "step", "(", ")", "\n", "\n", "if", "i", "%", "100", "==", "0", ":", "\n", "                ", "self", ".", "logs", "[", "'Train Loss'", "]", "=", "loss", ".", "item", "(", ")", "\n", "self", ".", "print_logs", "(", "epoch", ",", "i", ")", "\n", "\n", "", "", "return", "loss", ".", "item", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.trainer.RFFTrainer.eval": [[78, 132], ["trainer.RFFTrainer.models[].eval", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "evaluation.inter_intra_dist", "evaluation.distance_hist_plot", "evaluation.get_auc_eer", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "trainer.RFFTrainer.cpu().detach().numpy", "torch.cat.cpu().numpy", "torch.cat.cpu().numpy", "torch.cat.cpu().numpy", "trainer.RFFTrainer.print_logs", "trainer.RFFTrainer.print_logs", "len", "trainer.RFFTrainer.models[].features", "feature_list.append", "label_list.append", "len", "len", "x.to", "y.to", "trainer.RFFTrainer.models[].output", "torch.cross_entropy().item", "torch.cross_entropy().item", "torch.cross_entropy().item", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "trainer.RFFTrainer.cpu().detach", "torch.cat.cpu", "torch.cat.cpu", "torch.cat.cpu", "torch.cross_entropy", "torch.cross_entropy", "torch.cross_entropy", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "trainer.RFFTrainer.cpu"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.eval", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.inter_intra_dist", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.distance_hist_plot", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.get_auc_eer", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "def", "eval", "(", "self", ",", "epoch", ",", "eval_dataset", "=", "'open'", ")", ":", "\n", "        ", "self", ".", "logs", "=", "{", "}", "\n", "self", ".", "models", "[", "'C'", "]", ".", "eval", "(", ")", "\n", "correct", "=", "0.0", "\n", "test_loss", "=", "0.0", "\n", "feature_list", "=", "[", "]", "\n", "label_list", "=", "[", "]", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "for", "data", "in", "self", ".", "dataloaders", "[", "eval_dataset", "]", ":", "\n", "                ", "x", ",", "y", "=", "data", "[", "self", ".", "data_idx", "]", ",", "data", "[", "1", "]", "\n", "x", ",", "y", "=", "x", ".", "to", "(", "self", ".", "device", ")", ",", "y", ".", "to", "(", "self", ".", "device", ")", "\n", "N", "=", "len", "(", "x", ")", "\n", "features", "=", "self", ".", "models", "[", "'C'", "]", ".", "features", "(", "x", ")", "\n", "feature_list", ".", "append", "(", "features", ")", "\n", "label_list", ".", "append", "(", "y", ")", "\n", "\n", "if", "eval_dataset", "==", "'close'", ":", "\n", "                    ", "scores", "=", "self", ".", "models", "[", "'C'", "]", ".", "output", "(", "features", ")", "\n", "test_loss", "+=", "F", ".", "cross_entropy", "(", "scores", ",", "y", ",", "reduction", "=", "'sum'", ")", ".", "item", "(", ")", "\n", "pred_y", "=", "torch", ".", "argmax", "(", "scores", ",", "dim", "=", "1", ")", "\n", "correct", "+=", "torch", ".", "sum", "(", "pred_y", "==", "y", ")", ".", "item", "(", ")", "\n", "\n", "", "", "", "features", "=", "torch", ".", "cat", "(", "feature_list", ",", "dim", "=", "0", ")", "\n", "labels", "=", "torch", ".", "cat", "(", "label_list", ")", "\n", "intra_dist", ",", "inter_dist", "=", "inter_intra_dist", "(", "features", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ")", "\n", "distance_hist_plot", "(", "intra_dist", ",", "inter_dist", ",", "filename", "=", "'./plots/{}_{}_dist_hist.png'", ".", "format", "(", "self", ".", "flag", ",", "eval_dataset", ")", ")", "\n", "eer", ",", "roc_auc", ",", "thresh", "=", "get_auc_eer", "(", "intra_dist", ",", "inter_dist", ",", "plot_roc", "=", "True", ",", "filename", "=", "'./plots/{}_{}_roc.png'", ".", "format", "(", "self", ".", "flag", ",", "eval_dataset", ")", ")", "\n", "is_best", "=", "False", "\n", "\n", "if", "eval_dataset", "==", "'close'", ":", "\n", "            ", "acc", "=", "correct", "/", "len", "(", "self", ".", "datasets", "[", "eval_dataset", "]", ")", "\n", "test_loss", "=", "test_loss", "/", "len", "(", "self", ".", "datasets", "[", "eval_dataset", "]", ")", "\n", "\n", "if", "acc", ">=", "self", ".", "records", "[", "'acc'", "]", ":", "\n", "                ", "is_best", "=", "True", "\n", "self", ".", "records", "[", "'acc'", "]", "=", "acc", "\n", "", "self", ".", "logs", "[", "'Test Loss'", "]", "=", "test_loss", "\n", "self", ".", "logs", "[", "'acc'", "]", "=", "acc", "\n", "self", ".", "logs", "[", "'auc'", "]", "=", "roc_auc", "\n", "self", ".", "logs", "[", "'eer'", "]", "=", "eer", "\n", "self", ".", "logs", "[", "'data'", "]", "=", "eval_dataset", "\n", "self", ".", "print_logs", "(", "epoch", ",", "0", ")", "\n", "", "else", ":", "\n", "\n", "            ", "if", "roc_auc", ">=", "self", ".", "records", "[", "'auc'", "]", ":", "\n", "                ", "is_best", "=", "True", "\n", "self", ".", "records", "[", "'auc'", "]", "=", "roc_auc", "\n", "", "self", ".", "logs", "[", "'auc'", "]", "=", "roc_auc", "\n", "self", ".", "logs", "[", "'eer'", "]", "=", "eer", "\n", "self", ".", "logs", "[", "'data'", "]", "=", "eval_dataset", "\n", "self", ".", "print_logs", "(", "epoch", ",", "0", ")", "\n", "\n", "", "return", "is_best", "\n", "", "", ""]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.dataset.RFdataset.__init__": [[10, 25], ["torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "torch.load", "len", "str", "os.path.isfile", "preprocessing.main", "str"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.main"], ["    ", "def", "__init__", "(", "self", ",", "device_ids", ",", "test_ids", ",", "flag", "=", "'data_new'", ",", "SNR", "=", "None", ",", "rand_max_SNR", "=", "None", ",", "is_return_more", "=", "False", ")", ":", "\n", "        ", "if", "len", "(", "device_ids", ")", ">", "1", ":", "\n", "            ", "device_flag", "=", "'{}-{}'", ".", "format", "(", "device_ids", "[", "0", "]", ",", "device_ids", "[", "-", "1", "]", ")", "\n", "", "else", ":", "\n", "            ", "device_flag", "=", "str", "(", "device_ids", "[", "0", "]", ")", "\n", "", "test_flag", "=", "'-'", ".", "join", "(", "[", "str", "(", "i", ")", "for", "i", "in", "test_ids", "]", ")", "\n", "file_name", "=", "'{}_dv{}_id{}.pth'", ".", "format", "(", "flag", ",", "device_flag", ",", "test_flag", ")", "\n", "file_name", "=", "'/workspace/DATASET/ZigBee/new/{}'", ".", "format", "(", "file_name", ")", "\n", "if", "not", "os", ".", "path", ".", "isfile", "(", "file_name", ")", ":", "\n", "            ", "main", "(", "device_ids", ",", "test_ids", ",", "flag", "=", "flag", ")", "\n", "\n", "", "self", ".", "data", "=", "torch", ".", "load", "(", "file_name", ")", "\n", "self", ".", "snr", "=", "SNR", "\n", "self", ".", "max_snr", "=", "rand_max_SNR", "\n", "self", ".", "is_return_more", "=", "is_return_more", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.dataset.RFdataset.__getitem__": [[27, 53], ["[].view", "[].view", "[].view", "[].view", "marveltoolbox.utils.TorchComplex.awgn", "marveltoolbox.utils.TorchComplex.awgn", "marveltoolbox.utils.TorchComplex.awgn", "torch.randint().item", "torch.randint().item", "torch.randint().item", "torch.randint().item", "torch.randint().item", "torch.randint().item", "torch.randint().item", "torch.randint().item", "torch.randint().item", "marveltoolbox.utils.TorchComplex.awgn", "marveltoolbox.utils.TorchComplex.awgn", "marveltoolbox.utils.TorchComplex.awgn", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint", "torch.randint"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "idx", "=", "self", ".", "data", "[", "'idx'", "]", "[", "index", "]", "\n", "x", "=", "self", ".", "data", "[", "'x'", "]", "[", "index", "]", "[", "idx", ":", "idx", "+", "1280", ",", ":", "]", ".", "view", "(", "1", ",", "-", "1", ",", "2", ")", "\n", "x_origin", "=", "self", ".", "data", "[", "'x_origin'", "]", "[", "index", "]", "[", "idx", ":", "idx", "+", "1280", ",", ":", "]", ".", "view", "(", "1", ",", "-", "1", ",", "2", ")", "\n", "x_fo", "=", "self", ".", "data", "[", "'x_fo'", "]", "[", "index", "]", "[", "idx", ":", "idx", "+", "1280", ",", ":", "]", ".", "view", "(", "1", ",", "-", "1", ",", "2", ")", "\n", "x_fopo", "=", "self", ".", "data", "[", "'x_fopo'", "]", "[", "index", "]", "[", "idx", ":", "idx", "+", "1280", ",", ":", "]", ".", "view", "(", "1", ",", "-", "1", ",", "2", ")", "\n", "y", "=", "self", ".", "data", "[", "'y'", "]", "[", "index", "]", "\n", "length", "=", "self", ".", "data", "[", "'length'", "]", "[", "index", "]", "\n", "coarse_freq", "=", "self", ".", "data", "[", "'coarse_freq'", "]", "[", "index", "]", "\n", "fine_freq", "=", "self", ".", "data", "[", "'fine_freq'", "]", "[", "index", "]", "\n", "phase", "=", "self", ".", "data", "[", "'phase'", "]", "[", "index", "]", "\n", "# rec_freq = (rec_freq + 142000)/(142000-23000)", "\n", "if", "not", "self", ".", "snr", "is", "None", ":", "\n", "            ", "x_origin", "+=", "tc", ".", "awgn", "(", "x_origin", ",", "self", ".", "snr", ",", "SNR_x", "=", "30", ")", "\n", "x_fopo", "+=", "tc", ".", "awgn", "(", "x_fopo", ",", "self", ".", "snr", ",", "SNR_x", "=", "30", ")", "\n", "x", "+=", "tc", ".", "awgn", "(", "x", ",", "self", ".", "snr", ",", "SNR_x", "=", "30", ")", "\n", "\n", "", "if", "not", "self", ".", "max_snr", "is", "None", ":", "\n", "            ", "rand_snr", "=", "torch", ".", "randint", "(", "5", ",", "self", ".", "max_snr", ",", "(", "1", ",", ")", ")", ".", "item", "(", ")", "\n", "x_origin", "+=", "tc", ".", "awgn", "(", "x_origin", ",", "rand_snr", ",", "SNR_x", "=", "30", ")", "\n", "x_fopo", "+=", "tc", ".", "awgn", "(", "x_fopo", ",", "rand_snr", ",", "SNR_x", "=", "30", ")", "\n", "x", "+=", "tc", ".", "awgn", "(", "x", ",", "rand_snr", ",", "SNR_x", "=", "30", ")", "\n", "", "if", "self", ".", "is_return_more", ":", "\n", "            ", "return", "x_origin", ",", "y", ",", "x", ",", "x_fo", ",", "x_fopo", ",", "coarse_freq", ",", "fine_freq", ",", "phase", "\n", "", "else", ":", "\n", "            ", "return", "x_origin", ",", "y", ",", "x", ",", "x_fo", ",", "x_fopo", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.dataset.RFdataset.__len__": [[54, 56], ["len"], "methods", ["None"], ["", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "data", "[", "'y'", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.Config.__init__": [[30, 35], ["marveltoolbox.BaseExpConfs.__init__"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "exp_flag", "=", "'demo'", "\n", "self", ".", "snr", "=", "None", "\n", "self", ".", "device", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__": [[37, 40], ["marveltoolbox.BaseExperiment.__init__", "experiment.RFFExperiments.preprocessing"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "mt", ".", "BaseExperiment", ".", "__init__", "(", "self", ",", "self", ")", "\n", "self", ".", "preprocessing", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.main": [[41, 59], ["experiment.RFFExperiments.trainers.keys", "experiment.RFFExperiments.datasets.keys", "trainer.run", "marveltoolbox.utils.params_count", "experiment.RFFExperiments.print_logs", "experiment.RFFExperiments.eval", "experiment.RFFExperiments.ROC", "experiment.RFFExperiments.print_logs"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.eval", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.ROC"], ["", "def", "main", "(", "self", ",", "*", "args", ",", "**", "kwargs", ")", ":", "\n", "        ", "trainer_keys", "=", "self", ".", "trainers", ".", "keys", "(", ")", "\n", "dataset_keys", "=", "self", ".", "datasets", ".", "keys", "(", ")", "\n", "for", "trainer_key", "in", "trainer_keys", ":", "\n", "            ", "trainer", "=", "self", ".", "trainers", "[", "trainer_key", "]", "(", "device", "=", "self", ".", "device", ")", "\n", "trainer", ".", "run", "(", "load_best", "=", "True", ",", "retrain", "=", "False", ",", "is_del_loger", "=", "True", ")", "\n", "self", ".", "input_idx", "=", "trainer", ".", "data_idx", "\n", "self", ".", "logs", "=", "{", "}", "\n", "self", ".", "logs", "[", "'trainer'", "]", "=", "trainer_key", "\n", "self", ".", "logs", "[", "'param num'", "]", "=", "mt", ".", "utils", ".", "params_count", "(", "trainer", ".", "models", "[", "'C'", "]", ")", "\n", "self", ".", "print_logs", "(", ")", "\n", "for", "dataset_key", "in", "dataset_keys", ":", "\n", "                ", "self", ".", "logs", "=", "{", "}", "\n", "self", ".", "eval", "(", "trainer", ",", "trainer_key", ",", "dataset_key", ")", "\n", "self", ".", "ROC", "(", "trainer_key", ",", "dataset_key", ")", "\n", "self", ".", "logs", "[", "'dataset'", "]", "=", "dataset_key", "\n", "self", ".", "print_logs", "(", ")", "\n", "", "del", "trainer", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.eval": [[61, 99], ["trainer.models[].eval", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.cat().cpu().detach", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "experiment.RFFExperiments.print_logs", "len", "trainer.models[].features", "feature_list.append", "label_list.append", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "torch.cat().cpu", "len", "len", "x.to", "y.to", "trainer.models[].output", "torch.cross_entropy().item", "torch.cross_entropy().item", "torch.cross_entropy().item", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.argmax", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.sum().item", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cross_entropy", "torch.cross_entropy", "torch.cross_entropy", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.eval", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.models.NS_CLF_L2Softmax_Vis.features"], ["", "", "def", "eval", "(", "self", ",", "trainer", ",", "trainer_name", ",", "eval_dataset", ")", ":", "\n", "        ", "trainer", ".", "models", "[", "'C'", "]", ".", "eval", "(", ")", "\n", "device", "=", "trainer", ".", "device", "\n", "correct", "=", "0.0", "\n", "test_loss", "=", "0.0", "\n", "feature_list", "=", "[", "]", "\n", "label_list", "=", "[", "]", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "for", "data", "in", "self", ".", "dataloaders", "[", "eval_dataset", "]", ":", "\n", "                ", "x", ",", "y", "=", "data", "[", "trainer", ".", "data_idx", "]", ",", "data", "[", "1", "]", "\n", "x", ",", "y", "=", "x", ".", "to", "(", "device", ")", ",", "y", ".", "to", "(", "device", ")", "\n", "N", "=", "len", "(", "x", ")", "\n", "features", "=", "trainer", ".", "models", "[", "'C'", "]", ".", "features", "(", "x", ")", "\n", "feature_list", ".", "append", "(", "features", ")", "\n", "label_list", ".", "append", "(", "y", ")", "\n", "\n", "if", "'close'", "in", "eval_dataset", ":", "\n", "                    ", "scores", "=", "trainer", ".", "models", "[", "'C'", "]", ".", "output", "(", "features", ")", "\n", "test_loss", "+=", "F", ".", "cross_entropy", "(", "scores", ",", "y", ",", "reduction", "=", "'sum'", ")", ".", "item", "(", ")", "\n", "pred_y", "=", "torch", ".", "argmax", "(", "scores", ",", "dim", "=", "1", ")", "\n", "correct", "+=", "torch", ".", "sum", "(", "pred_y", "==", "y", ")", ".", "item", "(", ")", "\n", "\n", "", "", "", "features", "=", "torch", ".", "cat", "(", "feature_list", ",", "dim", "=", "0", ")", ".", "cpu", "(", ")", ".", "detach", "(", ")", "\n", "labels", "=", "torch", ".", "cat", "(", "label_list", ")", ".", "cpu", "(", ")", ".", "detach", "(", ")", "\n", "self", ".", "results", "[", "trainer_name", "]", "[", "eval_dataset", "]", "[", "'features'", "]", "=", "features", "\n", "self", ".", "results", "[", "trainer_name", "]", "[", "eval_dataset", "]", "[", "'labels'", "]", "=", "labels", "\n", "\n", "if", "'close'", "in", "eval_dataset", ":", "\n", "            ", "acc", "=", "correct", "/", "len", "(", "self", ".", "datasets", "[", "eval_dataset", "]", ")", "\n", "test_loss", "=", "test_loss", "/", "len", "(", "self", ".", "datasets", "[", "eval_dataset", "]", ")", "\n", "self", ".", "results", "[", "trainer_name", "]", "[", "eval_dataset", "]", "[", "'acc'", "]", "=", "acc", "\n", "self", ".", "results", "[", "trainer_name", "]", "[", "eval_dataset", "]", "[", "'test_loss'", "]", "=", "test_loss", "\n", "self", ".", "logs", "[", "'Test Loss'", "]", "=", "test_loss", "\n", "self", ".", "logs", "[", "'acc'", "]", "=", "acc", "\n", "self", ".", "logs", "[", "'data'", "]", "=", "eval_dataset", "\n", "self", ".", "print_logs", "(", ")", "\n", "self", ".", "logs", "=", "{", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.ROC": [[101, 116], ["[].numpy", "[].numpy", "evaluation.inter_intra_dist", "evaluation.get_auc_eer"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.inter_intra_dist", "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.get_auc_eer"], ["", "", "def", "ROC", "(", "self", ",", "trainer", ",", "dataset", ",", "is_save_dist", "=", "True", ")", ":", "\n", "        ", "features", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'features'", "]", ".", "numpy", "(", ")", "\n", "labels", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'labels'", "]", ".", "numpy", "(", ")", "\n", "intra_dist", ",", "inter_dist", "=", "inter_intra_dist", "(", "features", ",", "labels", ")", "\n", "\n", "eer", ",", "roc_auc", ",", "thresh", "=", "get_auc_eer", "(", "intra_dist", ",", "inter_dist", ",", "plot_roc", "=", "False", ")", "\n", "if", "is_save_dist", ":", "\n", "            ", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'intra_dist'", "]", "=", "intra_dist", "\n", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'inter_dist'", "]", "=", "inter_dist", "\n", "", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'eer'", "]", "=", "eer", "\n", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'roc_auc'", "]", "=", "roc_auc", "\n", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'thresh'", "]", "=", "thresh", "\n", "self", ".", "logs", "[", "'auc'", "]", "=", "roc_auc", "\n", "self", ".", "logs", "[", "'eer'", "]", "=", "eer", "\n", "self", ".", "logs", "[", "'thresh'", "]", "=", "thresh", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.dist_hist_plots": [[117, 124], ["evaluation.distance_hist_plot"], "methods", ["home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.distance_hist_plot"], ["", "def", "dist_hist_plots", "(", "self", ",", "trainer_keys", ",", "dataset_keys", ")", ":", "\n", "        ", "for", "trainer", "in", "trainer_keys", ":", "\n", "            ", "for", "dataset", "in", "dataset_keys", ":", "\n", "                ", "intra_dist", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'intra_dist'", "]", "\n", "inter_dist", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'inter_dist'", "]", "\n", "distance_hist_plot", "(", "\n", "intra_dist", ",", "inter_dist", ",", "filename", "=", "self", ".", "exp_path", "+", "'/Final_{}_{}_{}_dist_hist.png'", ".", "format", "(", "self", ".", "flag", ",", "trainer", ",", "dataset", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.roc_plots": [[125, 168], ["plt.figure", "os.path.join", "list", "plt.plot", "plt.xlim", "plt.ylim", "plt.xlabel", "plt.ylabel", "plt.legend", "plt.show", "plt.savefig", "plt.close", "np.ones_like", "np.zeros_like", "np.append", "np.append", "roc_curve", "auc", "brentq", "print", "plt.plot", "interp1d", "interp1d", "int"], "methods", ["None"], ["", "", "", "def", "roc_plots", "(", "self", ",", "trainer_keys", ",", "dataset_keys", ",", "name_dict", ",", "file_name", "=", "'ROC.png'", ")", ":", "\n", "        ", "plt", ".", "figure", "(", "figsize", "=", "(", "4", ",", "4", ")", ",", "dpi", "=", "300", ")", "\n", "lw", "=", "2", "\n", "filename", "=", "os", ".", "path", ".", "join", "(", "self", ".", "exp_path", ",", "file_name", ")", "\n", "colour_idxs", "=", "list", "(", "mcolors", ".", "TABLEAU_COLORS", ")", "\n", "linestyle", "=", "[", "'solid'", ",", "'dashed'", ",", "'dashdot'", ",", "'dotted'", "]", "\n", "ci", "=", "0", "\n", "# colours = ['blue', 'green', 'red', 'black', 'yellow', 'orange']", "\n", "for", "trainer", "in", "trainer_keys", ":", "\n", "            ", "for", "dataset", "in", "dataset_keys", ":", "\n", "\n", "                ", "intra_dist", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'intra_dist'", "]", "\n", "inter_dist", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'inter_dist'", "]", "\n", "inter_label", "=", "np", ".", "ones_like", "(", "inter_dist", ")", "\n", "intra_label", "=", "np", ".", "zeros_like", "(", "intra_dist", ")", "\n", "y_test", "=", "np", ".", "append", "(", "inter_label", ",", "intra_label", ")", "\n", "y_score", "=", "np", ".", "append", "(", "inter_dist", ",", "intra_dist", ")", "\n", "fpr", ",", "tpr", ",", "threshold", "=", "roc_curve", "(", "y_test", ",", "y_score", ")", "\n", "roc_auc", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "eer", "=", "brentq", "(", "lambda", "x", ":", "1.", "-", "x", "-", "interp1d", "(", "fpr", ",", "tpr", ")", "(", "x", ")", ",", "0.", ",", "1.", ")", "\n", "thresh", "=", "interp1d", "(", "fpr", ",", "threshold", ")", "(", "eer", ")", "\n", "print", "(", "trainer", ",", "dataset", ",", "'auc:{}'", ".", "format", "(", "roc_auc", ")", ",", "'eer:{}'", ".", "format", "(", "eer", ")", ")", "\n", "if", "name_dict", "is", "None", ":", "\n", "                    ", "label_name", "=", "trainer", "\n", "", "else", ":", "\n", "                    ", "label_name", "=", "name_dict", "[", "trainer", "]", "\n", "", "plt", ".", "plot", "(", "\n", "fpr", ",", "tpr", ",", "color", "=", "mcolors", ".", "TABLEAU_COLORS", "[", "colour_idxs", "[", "ci", "]", "]", ",", "\n", "linestyle", "=", "linestyle_tuple", "[", "int", "(", "ci", "%", "7", ")", "]", "[", "1", "]", ",", "\n", "lw", "=", "lw", ",", "label", "=", "'AUC:{:.2f} EER:{:.2f} {}'", ".", "format", "(", "roc_auc", ",", "eer", ",", "label_name", ")", ")", "\n", "ci", "+=", "1", "\n", "", "", "plt", ".", "plot", "(", "[", "0", ",", "1", "]", ",", "[", "0", ",", "1", "]", ",", "color", "=", "'navy'", ",", "lw", "=", "lw", ",", "linestyle", "=", "'--'", ")", "\n", "plt", ".", "xlim", "(", "[", "0.0", ",", "1.0", "]", ")", "\n", "plt", ".", "ylim", "(", "[", "0.0", ",", "1.05", "]", ")", "\n", "# plt.yscale('log')", "\n", "# plt.xscale('log')", "\n", "plt", ".", "xlabel", "(", "'False Positive Rate'", ")", "\n", "plt", ".", "ylabel", "(", "'True Positive Rate'", ")", "\n", "# plt.title('ROC {}'.format(dataset_keys[0]))", "\n", "plt", ".", "legend", "(", "loc", "=", "\"lower right\"", ")", "\n", "plt", ".", "show", "(", ")", "\n", "plt", ".", "savefig", "(", "filename", ",", "bbox_inches", "=", "'tight'", ")", "\n", "plt", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.pr_plots": [[169, 212], ["plt.figure", "os.path.join", "list", "plt.plot", "plt.xlim", "plt.ylim", "plt.xlabel", "plt.ylabel", "plt.legend", "plt.show", "plt.savefig", "plt.close", "np.ones_like", "np.zeros_like", "np.append", "np.append", "precision_recall_curve", "auc", "print", "plt.plot", "int"], "methods", ["None"], ["", "def", "pr_plots", "(", "self", ",", "trainer_keys", ",", "dataset_keys", ",", "name_dict", ",", "file_name", "=", "'PR.png'", ")", ":", "\n", "        ", "plt", ".", "figure", "(", "figsize", "=", "(", "4", ",", "4", ")", ",", "dpi", "=", "300", ")", "\n", "lw", "=", "2", "\n", "filename", "=", "os", ".", "path", ".", "join", "(", "self", ".", "exp_path", ",", "file_name", ")", "\n", "colour_idxs", "=", "list", "(", "mcolors", ".", "TABLEAU_COLORS", ")", "\n", "linestyle", "=", "[", "'solid'", ",", "'dashed'", ",", "'dashdot'", ",", "'dotted'", "]", "\n", "ci", "=", "0", "\n", "# colours = ['blue', 'green', 'red', 'black', 'yellow', 'orange']", "\n", "for", "trainer", "in", "trainer_keys", ":", "\n", "            ", "for", "dataset", "in", "dataset_keys", ":", "\n", "\n", "                ", "intra_dist", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'intra_dist'", "]", "\n", "inter_dist", "=", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'inter_dist'", "]", "\n", "inter_label", "=", "np", ".", "ones_like", "(", "inter_dist", ")", "\n", "intra_label", "=", "np", ".", "zeros_like", "(", "intra_dist", ")", "\n", "y_test", "=", "np", ".", "append", "(", "inter_label", ",", "intra_label", ")", "\n", "y_score", "=", "np", ".", "append", "(", "inter_dist", ",", "intra_dist", ")", "\n", "precision", ",", "recall", ",", "threshold", "=", "precision_recall_curve", "(", "y_test", ",", "y_score", ")", "\n", "pr_auc", "=", "auc", "(", "recall", ",", "precision", ")", "\n", "# eer = brentq(lambda x: 1. - x - interp1d(fpr, tpr)(x), 0., 1.)", "\n", "# thresh = interp1d(fpr, threshold)(eer)", "\n", "print", "(", "trainer", ",", "dataset", ",", "'pr_auc:{}'", ".", "format", "(", "pr_auc", ")", ")", "\n", "if", "name_dict", "is", "None", ":", "\n", "                    ", "label_name", "=", "trainer", "\n", "", "else", ":", "\n", "                    ", "label_name", "=", "name_dict", "[", "trainer", "]", "\n", "", "plt", ".", "plot", "(", "\n", "recall", ",", "precision", ",", "color", "=", "mcolors", ".", "TABLEAU_COLORS", "[", "colour_idxs", "[", "ci", "]", "]", ",", "\n", "linestyle", "=", "linestyle_tuple", "[", "int", "(", "ci", "%", "7", ")", "]", "[", "1", "]", ",", "\n", "lw", "=", "lw", ",", "label", "=", "'auc:{:.2f} {}'", ".", "format", "(", "pr_auc", ",", "label_name", ")", ")", "\n", "ci", "+=", "1", "\n", "", "", "plt", ".", "plot", "(", "[", "0", ",", "1", "]", ",", "[", "0", ",", "1", "]", ",", "color", "=", "'navy'", ",", "lw", "=", "lw", ",", "linestyle", "=", "'--'", ")", "\n", "plt", ".", "xlim", "(", "[", "0.0", ",", "1.0", "]", ")", "\n", "plt", ".", "ylim", "(", "[", "0.0", ",", "1.05", "]", ")", "\n", "# plt.yscale('log')", "\n", "# plt.xscale('log')", "\n", "plt", ".", "xlabel", "(", "'Recall'", ")", "\n", "plt", ".", "ylabel", "(", "'Precision'", ")", "\n", "# plt.title('ROC {}'.format(dataset_keys[0]))", "\n", "plt", ".", "legend", "(", "loc", "=", "\"lower right\"", ")", "\n", "plt", ".", "show", "(", ")", "\n", "plt", ".", "savefig", "(", "filename", ",", "bbox_inches", "=", "'tight'", ")", "\n", "plt", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.snr_auc_plots": [[213, 251], ["plt.figure", "os.path.join", "list", "print", "plt.xlabel", "plt.ylabel", "plt.legend", "plt.show", "plt.savefig", "plt.close", "plt.plot", "auc_list.append", "best_models.setdefault", "int", "int", "int", "len"], "methods", ["None"], ["", "def", "snr_auc_plots", "(", "self", ",", "trainer_keys", ",", "dataset_keys", ",", "snr_list", ",", "name_dict", "=", "None", ",", "file_name", "=", "'snr_auc.png'", ")", ":", "\n", "        ", "plt", ".", "figure", "(", "figsize", "=", "(", "4", ",", "4", ")", ",", "dpi", "=", "300", ")", "\n", "lw", "=", "2", "\n", "filename", "=", "os", ".", "path", ".", "join", "(", "self", ".", "exp_path", ",", "file_name", ")", "\n", "colour_idxs", "=", "list", "(", "mcolors", ".", "TABLEAU_COLORS", ")", "\n", "linestyle", "=", "[", "'solid'", ",", "'dashed'", ",", "'dashdot'", ",", "'dotted'", "]", "\n", "# colours = ['blue', 'green', 'red', 'black', 'yellow', 'orange']", "\n", "best_models", "=", "{", "}", "\n", "for", "dataset", "in", "dataset_keys", ":", "\n", "            ", "ci", "=", "0", "\n", "for", "trainer", "in", "trainer_keys", ":", "\n", "                ", "auc_list", "=", "[", "]", "\n", "for", "snr", "in", "snr_list", ":", "\n", "                    ", "auc_list", ".", "append", "(", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "snr", "]", "[", "'roc_auc'", "]", ")", "\n", "if", "auc_list", "[", "-", "1", "]", ">", "best_models", ".", "setdefault", "(", "dataset", ",", "[", "''", ",", "0.0", ",", "0.0", "]", ")", "[", "1", "]", ":", "\n", "                        ", "best_models", "[", "dataset", "]", "=", "[", "trainer", ",", "auc_list", "[", "-", "1", "]", ",", "snr", "]", "\n", "", "", "if", "name_dict", "is", "None", ":", "\n", "                    ", "label_name", "=", "trainer", "\n", "", "else", ":", "\n", "                    ", "label_name", "=", "name_dict", "[", "trainer", "]", "\n", "", "plt", ".", "plot", "(", "\n", "snr_list", ",", "auc_list", ",", "marker", "=", "markers", "[", "int", "(", "ci", "%", "7", ")", "]", ",", "\n", "color", "=", "mcolors", ".", "TABLEAU_COLORS", "[", "colour_idxs", "[", "int", "(", "ci", "%", "len", "(", "colour_idxs", ")", ")", "]", "]", ",", "\n", "linestyle", "=", "linestyle_tuple", "[", "int", "(", "ci", "%", "7", ")", "]", "[", "1", "]", ",", "\n", "lw", "=", "lw", ",", "label", "=", "'{}'", ".", "format", "(", "label_name", ")", ")", "\n", "# plt.scatter(snr_list, auc_list, color=mcolors.TABLEAU_COLORS[colour_idxs[int(ci%len(colour_idxs))]], label='{}'.format(trainer_type))", "\n", "# plt.scatter(param_list, auc_list, label='{}'.format(trainer_type))", "\n", "ci", "+=", "1", "\n", "", "", "print", "(", "best_models", ")", "\n", "# plt.yscale('log')", "\n", "# plt.xscale('log')", "\n", "plt", ".", "xlabel", "(", "'SNR (dB)'", ")", "\n", "plt", ".", "ylabel", "(", "'ROC-AUC'", ")", "\n", "# plt.title('SNR-AUC {}'.format(dataset_keys[0]))", "\n", "plt", ".", "legend", "(", "loc", "=", "\"lower right\"", ")", "\n", "plt", ".", "show", "(", ")", "\n", "plt", ".", "savefig", "(", "filename", ",", "bbox_inches", "=", "'tight'", ")", "\n", "plt", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.param_auc_plots": [[252, 288], ["plt.figure", "os.path.join", "list", "trainer_dict.items", "print", "plt.xlabel", "plt.ylabel", "plt.ylim", "plt.legend", "plt.show", "plt.savefig", "plt.close", "plt.scatter", "param_list.append", "auc_list.append", "best_models.setdefault", "int", "int", "len"], "methods", ["None"], ["", "def", "param_auc_plots", "(", "self", ",", "trainer_dict", ",", "dataset_keys", ",", "name_dict", "=", "None", ",", "file_name", "=", "None", ")", ":", "\n", "        ", "plt", ".", "figure", "(", "figsize", "=", "(", "4", ",", "4", ")", ",", "dpi", "=", "300", ")", "\n", "lw", "=", "2", "\n", "filename", "=", "os", ".", "path", ".", "join", "(", "self", ".", "exp_path", ",", "file_name", ")", "\n", "colour_idxs", "=", "list", "(", "mcolors", ".", "TABLEAU_COLORS", ")", "\n", "linestyle", "=", "[", "'solid'", ",", "'dashed'", ",", "'dashdot'", ",", "'dotted'", "]", "\n", "best_models", "=", "{", "}", "\n", "ci", "=", "0", "\n", "for", "trainer_type", ",", "trainer_list", "in", "trainer_dict", ".", "items", "(", ")", ":", "\n", "            ", "param_list", "=", "[", "]", "\n", "auc_list", "=", "[", "]", "\n", "for", "trainer", "in", "trainer_list", ":", "\n", "                ", "for", "dataset", "in", "dataset_keys", ":", "\n", "                    ", "param_list", ".", "append", "(", "(", "self", ".", "results", "[", "trainer", "]", "[", "'params'", "]", "-", "513", "*", "54", ")", "/", "1000000", ")", "\n", "auc_list", ".", "append", "(", "self", ".", "results", "[", "trainer", "]", "[", "dataset", "]", "[", "'roc_auc'", "]", ")", "\n", "if", "auc_list", "[", "-", "1", "]", ">", "best_models", ".", "setdefault", "(", "dataset", ",", "[", "''", ",", "0.0", ",", "0.0", "]", ")", "[", "1", "]", ":", "\n", "                        ", "best_models", "[", "dataset", "]", "=", "[", "trainer", ",", "auc_list", "[", "-", "1", "]", ",", "param_list", "[", "-", "1", "]", "]", "\n", "", "", "", "if", "name_dict", "is", "None", ":", "\n", "                ", "label_name", "=", "trainer_type", "\n", "", "else", ":", "\n", "                ", "label_name", "=", "name_dict", "[", "trainer_type", "]", "\n", "", "plt", ".", "scatter", "(", "param_list", ",", "auc_list", ",", "\n", "color", "=", "mcolors", ".", "TABLEAU_COLORS", "[", "colour_idxs", "[", "int", "(", "ci", "%", "len", "(", "colour_idxs", ")", ")", "]", "]", ",", "marker", "=", "markers", "[", "int", "(", "ci", "%", "7", ")", "]", ",", "\n", "label", "=", "'{}'", ".", "format", "(", "label_name", ")", ")", "\n", "# plt.scatter(param_list, auc_list, label='{}'.format(trainer_type))", "\n", "ci", "+=", "1", "\n", "", "print", "(", "best_models", ")", "\n", "plt", ".", "xlabel", "(", "'# Params (M)'", ")", "\n", "plt", ".", "ylabel", "(", "'ROC-AUC'", ")", "\n", "plt", ".", "ylim", "(", "0.95", ",", "1.005", ")", "\n", "# plt.ylim(0.990,1.001)", "\n", "# plt.title('Params-AUC {}'.format(dataset_keys[0]))", "\n", "plt", ".", "legend", "(", "loc", "=", "\"lower right\"", ")", "\n", "plt", ".", "show", "(", ")", "\n", "plt", ".", "savefig", "(", "filename", ",", "bbox_inches", "=", "'tight'", ")", "\n", "plt", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.experiment.RFFExperiments.acc_plots": [[290, 292], ["None"], "methods", ["None"], ["", "def", "acc_plots", "(", "self", ",", "trainer_keys", ",", "dataset_keys", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.freq_offset_estimation": [[19, 37], ["marveltoolbox.utils.TorchComplex.conj", "marveltoolbox.utils.TorchComplex.prod", "torch.mean", "marveltoolbox.utils.TorchComplex.phase"], "function", ["None"], ["def", "freq_offset_estimation", "(", "\n", "segment", ",", "\n", "DP_NUM", "=", "Despreading_Number", ",", "\n", "OQPSK_SAMPLE_PER_SYM", "=", "OQPSK_Sample_per_Symbol", ",", "\n", "PROCESS_SAMPLING_RATE", "=", "Process_Sampling_Rate", ",", "\n", ")", ":", "\n", "# shape of input segment:(N, T, 2)", "\n", "# return: (N,)", "\n", "    ", "sym_length", "=", "OQPSK_SAMPLE_PER_SYM", "*", "DP_NUM", "\n", "unified_OQPSK", "=", "segment", "[", ":", ",", "sym_length", "*", "1", ":", "sym_length", "*", "4", ",", ":", "]", "\n", "conj_unified_OQPSK", "=", "tc", ".", "conj", "(", "segment", "[", ":", ",", "sym_length", "*", "4", ":", "sym_length", "*", "7", ",", ":", "]", ")", "\n", "differ_OQPSK", "=", "tc", ".", "prod", "(", "unified_OQPSK", ",", "conj_unified_OQPSK", ")", "\n", "differ_average", "=", "torch", ".", "mean", "(", "differ_OQPSK", ",", "dim", "=", "1", ")", "\n", "differ_angle", "=", "tc", ".", "phase", "(", "differ_average", ")", "\n", "\n", "freq_offset_DS", "=", "differ_angle", "/", "DP_NUM", "/", "OQPSK_SAMPLE_PER_SYM", "/", "3", "/", "2", "/", "pi", "\n", "freq_offset_DS", "=", "freq_offset_DS", "*", "PROCESS_SAMPLING_RATE", "\n", "return", "freq_offset_DS", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.freq_compensation": [[38, 52], ["torch.arange().view().to().repeat", "torch.cat", "marveltoolbox.utils.TorchComplex.exp", "marveltoolbox.utils.TorchComplex.prod", "torch.arange().view().to", "torch.arange().view", "torch.cat.view().repeat", "torch.arange", "torch.cat.view"], "function", ["None"], ["", "def", "freq_compensation", "(", "\n", "segment", ",", "\n", "freq", ",", "\n", "PROCESS_SAMPLING_RATE", "=", "Process_Sampling_Rate", "\n", ")", ":", "\n", "# shape of input segment:(N, T, 2)", "\n", "# shape of input freq:(N,)", "\n", "# return: (N, T, 2)", "\n", "    ", "N", ",", "segment_length", "=", "segment", ".", "shape", "[", "0", "]", ",", "segment", ".", "shape", "[", "1", "]", "\n", "n", "=", "torch", ".", "arange", "(", "0", ",", "segment_length", ")", ".", "view", "(", "1", ",", "-", "1", ",", "1", ")", ".", "to", "(", "segment", ".", "device", ")", ".", "repeat", "(", "N", ",", "1", ",", "1", ")", "\n", "freq", "=", "freq", ".", "view", "(", "N", ",", "1", ",", "1", ")", ".", "repeat", "(", "1", ",", "segment_length", ",", "1", ")", "/", "PROCESS_SAMPLING_RATE", "*", "n", "*", "2", "*", "pi", "\n", "freq", "=", "torch", ".", "cat", "(", "[", "freq", "*", "0", ",", "freq", "]", ",", "dim", "=", "2", ")", "\n", "exp_freq", "=", "tc", ".", "exp", "(", "freq", ")", "\n", "return", "tc", ".", "prod", "(", "segment", ",", "exp_freq", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.phase_offset_estimation": [[53, 68], ["template[].view().repeat.to", "template[].view().repeat", "torch.mean", "marveltoolbox.utils.TorchComplex.phase", "marveltoolbox.utils.TorchComplex.prod", "template[].view"], "function", ["None"], ["", "def", "phase_offset_estimation", "(", "\n", "segment", ",", "\n", "T", "=", "1280", ",", "\n", "template", "=", "conj_OQPSK_2530_SHR_SYM", "\n", ")", ":", "\n", "# shape of input segment:(N, T, 2)", "\n", "# shape of input segment:(T, 2)", "\n", "# return: (N, T, 2)", "\n", "    ", "N", "=", "segment", ".", "shape", "[", "0", "]", "\n", "preamble", "=", "segment", "[", ":", ",", ":", "T", ",", ":", "]", "\n", "template", "=", "template", ".", "to", "(", "segment", ".", "device", ")", "\n", "template", "=", "template", "[", ":", "T", ",", ":", "]", ".", "view", "(", "1", ",", "T", ",", "2", ")", ".", "repeat", "(", "N", ",", "1", ",", "1", ")", "\n", "mean_corr", "=", "torch", ".", "mean", "(", "tc", ".", "prod", "(", "preamble", ",", "template", ")", ",", "dim", "=", "1", ")", "\n", "phase", "=", "tc", ".", "phase", "(", "mean_corr", ")", "\n", "return", "phase", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.ZigBee_processing.phase_compensation": [[69, 81], ["torch.cat", "marveltoolbox.utils.TorchComplex.exp().view().repeat", "marveltoolbox.utils.TorchComplex.prod", "marveltoolbox.utils.TorchComplex.exp().view", "phase.view", "phase.view", "marveltoolbox.utils.TorchComplex.exp"], "function", ["None"], ["", "def", "phase_compensation", "(", "\n", "segment", ",", "\n", "phase", "\n", ")", ":", "\n", "# shape of input segment:(N, T, 2)", "\n", "# shape of input phase:(N,)", "\n", "# return: (N, T, 2)", "\n", "    ", "N", ",", "T", ",", "_", "=", "segment", ".", "shape", "\n", "neg_j_phase", "=", "torch", ".", "cat", "(", "[", "phase", ".", "view", "(", "N", ",", "1", ")", "*", "0", ",", "-", "1", "*", "phase", ".", "view", "(", "N", ",", "1", ")", "]", ",", "dim", "=", "1", ")", "\n", "exp_phase", "=", "tc", ".", "exp", "(", "neg_j_phase", ")", ".", "view", "(", "N", ",", "1", ",", "2", ")", ".", "repeat", "(", "1", ",", "T", ",", "1", ")", "\n", "segment", "=", "tc", ".", "prod", "(", "segment", ",", "exp_phase", ")", "\n", "return", "segment", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.torch_distance": [[12, 16], ["x.mm", "x.size", "x.t", "x_x.t"], "function", ["None"], ["def", "torch_distance", "(", "x", ")", ":", "\n", "    ", "x_x", "=", "(", "x", "*", "x", ")", ".", "sum", "(", "1", ")", ".", "repeat", "(", "1", ",", "x", ".", "size", "(", "0", ")", ")", "\n", "x2_x", "=", "x", ".", "mm", "(", "x", ".", "t", "(", ")", ")", "\n", "return", "x_x", "+", "x_x", ".", "t", "(", ")", "-", "2", "*", "x2_x", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.torch_distance_mask": [[18, 25], ["label.repeat.view", "label.repeat.repeat", "torch.arange().repeat().to", "torch.arange().repeat().to", "len", "label.repeat.size", "torch.arange().repeat", "torch.arange().repeat", "label.repeat.size", "label.repeat.eq", "label.repeat.ne", "torch.arange", "torch.arange", "label.repeat.t", "torch.arange().repeat().to.t", "label.repeat.t", "torch.arange().repeat().to.t", "label.repeat.size"], "function", ["None"], ["", "def", "torch_distance_mask", "(", "label", ")", ":", "\n", "    ", "label", "=", "label", ".", "view", "(", "len", "(", "label", ")", ",", "1", ")", "\n", "label", "=", "label", ".", "repeat", "(", "1", ",", "label", ".", "size", "(", "0", ")", ")", "\n", "index", "=", "torch", ".", "arange", "(", "0", ",", "label", ".", "size", "(", "0", ")", ")", ".", "repeat", "(", "label", ".", "size", "(", "0", ")", ",", "1", ")", ".", "to", "(", "label", ".", "device", ")", "\n", "intra_mask", "=", "(", "(", "label", ".", "eq", "(", "label", ".", "t", "(", ")", ")", ")", "+", "(", "index", ">", "index", ".", "t", "(", ")", ")", ")", ".", "eq", "(", "2", ")", "\n", "inter_mask", "=", "(", "(", "label", ".", "ne", "(", "label", ".", "t", "(", ")", ")", ")", "+", "(", "index", ">", "index", ".", "t", "(", ")", ")", ")", ".", "eq", "(", "2", ")", "\n", "return", "inter_mask", ",", "intra_mask", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.inter_intra_dist": [[27, 50], ["numpy.tile", "numpy.eye", "sklearn.metrics.pairwise.pairwise_distances", "sklearn.metrics.pairwise.pairwise_distances", "numpy.diag", "len", "len"], "function", ["None"], ["", "def", "inter_intra_dist", "(", "features", ",", "labels", ",", "metric", "=", "'cosine'", ",", "other_features", "=", "None", ")", ":", "\n", "    ", "if", "not", "other_features", ":", "\n", "        ", "label_repeat", "=", "np", ".", "tile", "(", "labels", ",", "(", "len", "(", "labels", ")", ",", "1", ")", ")", "\n", "itself_dist", "=", "np", ".", "eye", "(", "len", "(", "labels", ")", ")", "\n", "intra_dist_mask", "=", "(", "(", "label_repeat", "==", "label_repeat", ".", "T", ")", "-", "\n", "itself_dist", ")", ".", "astype", "(", "np", ".", "bool", ")", "\n", "inter_dist_mask", "=", "label_repeat", "!=", "label_repeat", ".", "T", "\n", "\n", "distance", "=", "pairwise_distances", "(", "features", ",", "metric", "=", "metric", ")", "\n", "\n", "intra_dist", "=", "distance", "[", "intra_dist_mask", "]", "\n", "inter_dist", "=", "distance", "[", "inter_dist_mask", "]", "\n", "\n", "", "else", ":", "\n", "        ", "distance", "=", "pairwise_distances", "(", "features", ",", "other_features", ",", "metric", "=", "metric", ")", "\n", "pair_dist", "=", "np", ".", "diag", "(", "distance", ")", "\n", "# print(features.shape)", "\n", "# print(other_features.shape)", "\n", "# print(pair_dist.shape)", "\n", "inter_dist", "=", "pair_dist", "[", "labels", "==", "0", "]", "\n", "intra_dist", "=", "pair_dist", "[", "labels", "!=", "0", "]", "\n", "\n", "", "return", "intra_dist", ",", "inter_dist", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.pair_dist": [[51, 55], ["sklearn.metrics.pairwise.pairwise_distances", "numpy.diag"], "function", ["None"], ["", "def", "pair_dist", "(", "features1", ",", "features2", ",", "metric", "=", "'cosine'", ")", ":", "\n", "    ", "distance", "=", "pairwise_distances", "(", "features1", ",", "features2", ",", "metric", "=", "metric", ")", "\n", "pair_dist", "=", "np", ".", "diag", "(", "distance", ")", "\n", "return", "pair_dist", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.compute_centers": [[56, 69], ["len", "numpy.zeros", "numpy.zeros_like", "range", "list", "len", "numpy.ones_like", "set"], "function", ["None"], ["", "def", "compute_centers", "(", "features", ",", "labels", ")", ":", "\n", "    ", "class_num", "=", "len", "(", "list", "(", "set", "(", "labels", ")", ")", ")", "\n", "N", "=", "features", ".", "shape", "[", "0", "]", "\n", "D", "=", "features", ".", "shape", "[", "1", "]", "\n", "centers", "=", "np", ".", "zeros", "(", "(", "class_num", ",", "D", ")", ")", "\n", "center_count", "=", "np", ".", "zeros_like", "(", "centers", ")", "\n", "for", "i", "in", "range", "(", "len", "(", "labels", ")", ")", ":", "\n", "        ", "index", "=", "labels", "[", "i", "]", "\n", "centers", "[", "index", "]", "+=", "features", "[", "i", "]", "\n", "center_count", "[", "index", "]", "+=", "np", ".", "ones_like", "(", "features", "[", "i", "]", ")", "\n", "\n", "", "centers", "/=", "center_count", "\n", "return", "centers", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.center_dist": [[71, 82], ["len", "numpy.zeros", "sklearn.metrics.pairwise.pairwise_distances", "numpy.arange"], "function", ["None"], ["", "def", "center_dist", "(", "features", ",", "labels", ",", "centers", ")", ":", "\n", "    ", "class_num", "=", "len", "(", "centers", ")", "\n", "N", "=", "features", ".", "shape", "[", "0", "]", "\n", "D", "=", "features", ".", "shape", "[", "1", "]", "\n", "mask", "=", "np", ".", "zeros", "(", "(", "N", ",", "class_num", ")", ")", "\n", "mask", "[", "np", ".", "arange", "(", "N", ")", ",", "labels", "]", "=", "1", "\n", "\n", "distance", "=", "pairwise_distances", "(", "features", ",", "centers", ")", "\n", "intra_dist", "=", "distance", "[", "mask", "==", "1", "]", "\n", "inter_dist", "=", "distance", "[", "mask", "==", "0", "]", "\n", "return", "intra_dist", ",", "inter_dist", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.distance_hist_plot": [[83, 94], ["matplotlib.figure", "matplotlib.hist", "matplotlib.hist", "matplotlib.legend", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.savefig", "matplotlib.close"], "function", ["None"], ["", "def", "distance_hist_plot", "(", "intra_dist", ",", "inter_dist", ",", "filename", "=", "None", ")", ":", "\n", "    ", "plt", ".", "figure", "(", "figsize", "=", "(", "4", ",", "3", ")", ",", "dpi", "=", "300", ")", "\n", "# plt.title('Distance distribution')", "\n", "plt", ".", "hist", "(", "intra_dist", ",", "100", ",", "density", "=", "True", ",", "alpha", "=", "0.5", ")", "\n", "plt", ".", "hist", "(", "inter_dist", ",", "100", ",", "density", "=", "True", ",", "alpha", "=", "0.5", ")", "\n", "plt", ".", "legend", "(", "[", "'Intra dist'", ",", "'Inter dist'", "]", ")", "\n", "plt", ".", "xlabel", "(", "'Distance'", ")", "\n", "plt", ".", "ylabel", "(", "'Density'", ")", "\n", "if", "not", "filename", "is", "None", ":", "\n", "        ", "plt", ".", "savefig", "(", "filename", ",", "bbox_inches", "=", "'tight'", ")", "\n", "plt", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.get_auc_eer": [[98, 125], ["numpy.ones_like", "numpy.zeros_like", "numpy.append", "numpy.append", "sklearn.metrics.roc_curve", "sklearn.metrics.auc", "scipy.optimize.brentq", "scipy.interpolate.interp1d", "matplotlib.figure", "matplotlib.plot", "matplotlib.plot", "matplotlib.xlim", "matplotlib.ylim", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.title", "matplotlib.legend", "matplotlib.show", "matplotlib.savefig", "matplotlib.close", "scipy.interpolate.interp1d"], "function", ["None"], ["", "", "def", "get_auc_eer", "(", "intra_dist", ",", "inter_dist", ",", "plot_roc", "=", "False", ",", "filename", "=", "None", ")", ":", "\n", "    ", "inter_label", "=", "np", ".", "ones_like", "(", "inter_dist", ")", "\n", "intra_label", "=", "np", ".", "zeros_like", "(", "intra_dist", ")", "\n", "y_test", "=", "np", ".", "append", "(", "inter_label", ",", "intra_label", ")", "\n", "y_score", "=", "np", ".", "append", "(", "inter_dist", ",", "intra_dist", ")", "\n", "fpr", ",", "tpr", ",", "threshold", "=", "roc_curve", "(", "y_test", ",", "y_score", ")", "\n", "roc_auc", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "eer", "=", "brentq", "(", "lambda", "x", ":", "1.", "-", "x", "-", "interp1d", "(", "fpr", ",", "tpr", ")", "(", "x", ")", ",", "0.", ",", "1.", ")", "\n", "thresh", "=", "interp1d", "(", "fpr", ",", "threshold", ")", "(", "eer", ")", "\n", "if", "plot_roc", ":", "\n", "        ", "plt", ".", "figure", "(", ")", "\n", "lw", "=", "2", "\n", "plt", ".", "plot", "(", "fpr", ",", "tpr", ",", "color", "=", "'darkorange'", ",", "\n", "lw", "=", "lw", ",", "label", "=", "'ROC curve (area = %0.2f)'", "%", "roc_auc", ")", "\n", "plt", ".", "plot", "(", "[", "0", ",", "1", "]", ",", "[", "0", ",", "1", "]", ",", "color", "=", "'navy'", ",", "lw", "=", "lw", ",", "linestyle", "=", "'--'", ")", "\n", "plt", ".", "xlim", "(", "[", "0.0", ",", "1.0", "]", ")", "\n", "plt", ".", "ylim", "(", "[", "0.0", ",", "1.05", "]", ")", "\n", "plt", ".", "xlabel", "(", "'False Positive Rate'", ")", "\n", "plt", ".", "ylabel", "(", "'True Positive Rate'", ")", "\n", "plt", ".", "title", "(", "'Receiver operating characteristic example'", ")", "\n", "plt", ".", "legend", "(", "loc", "=", "\"lower right\"", ")", "\n", "plt", ".", "show", "(", ")", "\n", "if", "not", "filename", "is", "None", ":", "\n", "            ", "plt", ".", "savefig", "(", "filename", ")", "\n", "plt", ".", "close", "(", ")", "\n", "\n", "", "", "return", "eer", ",", "roc_auc", ",", "thresh", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.cos_clf": [[127, 131], ["torch.cat", "torch.cat", "torch.cosine_similarity().view", "torch.cosine_similarity"], "function", ["None"], ["", "def", "cos_clf", "(", "feature_x", ",", "feature_t", ",", "threshold", "=", "0.79", ")", ":", "\n", "    ", "cosine_sim", "=", "-", "F", ".", "cosine_similarity", "(", "feature_x", ",", "feature_t", ")", ".", "view", "(", "-", "1", ",", "1", ")", "+", "1", "\n", "output", "=", "torch", ".", "cat", "(", "(", "-", "cosine_sim", "+", "2", "*", "threshold", ",", "cosine_sim", ")", ",", "dim", "=", "1", ")", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.l2_norm": [[132, 140], ["input.size", "torch.pow", "torch.pow", "torch.sum().add_", "torch.sum().add_", "torch.sqrt", "torch.sqrt", "torch.div", "torch.div", "torch.div.view", "torch.sqrt.view().expand_as", "torch.sum", "torch.sum", "torch.sqrt.view"], "function", ["None"], ["", "def", "l2_norm", "(", "input", ")", ":", "\n", "    ", "input_size", "=", "input", ".", "size", "(", ")", "\n", "buffer", "=", "torch", ".", "pow", "(", "input", ",", "2", ")", "\n", "normp", "=", "torch", ".", "sum", "(", "buffer", ",", "1", ")", ".", "add_", "(", "1e-10", ")", "\n", "norm", "=", "torch", ".", "sqrt", "(", "normp", ")", "\n", "_output", "=", "torch", ".", "div", "(", "input", ",", "norm", ".", "view", "(", "-", "1", ",", "1", ")", ".", "expand_as", "(", "input", ")", ")", "\n", "output", "=", "_output", ".", "view", "(", "input_size", ")", "\n", "return", "output", ",", "norm", "\n", "\n"]], "home.repos.pwc.inspect_result.xrj-com_ns-rff.src.evaluation.BO_balance_score": [[141, 143], ["None"], "function", ["None"], ["", "def", "BO_balance_score", "(", "RB", ",", "auc", ",", "lamda", "=", "20000", ")", ":", "\n", "    ", "return", "RB", "-", "(", "1", "-", "auc", ")", "*", "lamda", "", "", ""]]}