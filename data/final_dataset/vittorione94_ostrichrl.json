{"home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.Physics.qpos": [[13, 15], ["mocap_tracking.Physics.data.qpos.copy"], "methods", ["None"], ["    ", "def", "qpos", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.Physics.qvel": [[16, 18], ["numpy.clip"], "methods", ["None"], ["", "def", "qvel", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "clip", "(", "self", ".", "data", ".", "qvel", ",", "-", "100", ",", "100", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.Physics.pelvis_height": [[19, 21], ["mocap_tracking.Physics.named.data.geom_xpos[].copy"], "methods", ["None"], ["", "def", "pelvis_height", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "geom_xpos", "[", "'cassie-pelvis'", ",", "'z'", "]", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.Physics.feet_height": [[22, 25], ["numpy.array"], "methods", ["None"], ["", "def", "feet_height", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "array", "(", "[", "self", ".", "named", ".", "data", ".", "xpos", "[", "'right-foot'", ",", "'z'", "]", ",", "\n", "self", ".", "named", ".", "data", ".", "xpos", "[", "'left-foot'", ",", "'z'", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.MoCapTask.__init__": [[28, 43], ["dm_control.suite.base.Task.__init__", "mocap_tracking.MoCapTask.initialize_clip"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.__init__", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.initialize_clip"], ["    ", "def", "__init__", "(", "\n", "self", ",", "clip", ",", "min_episode_steps", ",", "pose_rew_weight", ",", "rot_rew_weight", ",", "\n", "init_noise_scale", ",", "rew_threshold", ",", "test", ",", "play", ",", "random", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "random", "=", "random", ")", "\n", "self", ".", "_min_episode_steps", "=", "min_episode_steps", "\n", "self", ".", "_pose_rew_weight", "=", "pose_rew_weight", "\n", "self", ".", "_rot_rew_weight", "=", "rot_rew_weight", "\n", "self", ".", "_init_noise_scale", "=", "init_noise_scale", "\n", "self", ".", "_rew_threshold", "=", "rew_threshold", "\n", "self", ".", "_test", "=", "test", "\n", "self", ".", "_play", "=", "play", "\n", "self", ".", "_mocap_index", "=", "0", "\n", "self", ".", "_max_mocap_index", "=", "1", "\n", "self", ".", "initialize_clip", "(", "clip", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.MoCapTask.initialize_clip": [[44, 66], ["numpy.load", "numpy.load", "numpy.load", "numpy.load", "len", "os.path.dirname"], "methods", ["None"], ["", "def", "initialize_clip", "(", "self", ",", "clip", ")", ":", "\n", "        ", "path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "+", "'/../../assets/mocap/cassie/'", "\n", "\n", "# Joints.", "\n", "qpos_path", "=", "path", "+", "'qpos/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_qpos", "=", "np", ".", "load", "(", "qpos_path", ")", "\n", "\n", "# Velocities (approximated).", "\n", "qvel_path", "=", "path", "+", "'qvel/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_qvel", "=", "np", ".", "load", "(", "qvel_path", ")", "\n", "\n", "# Xipos.", "\n", "xipos_path", "=", "path", "+", "'xipos/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_xipos", "=", "np", ".", "load", "(", "xipos_path", ")", "\n", "\n", "# Ximat.", "\n", "ximat_path", "=", "path", "+", "'ximat/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_ximat", "=", "np", ".", "load", "(", "ximat_path", ")", "\n", "\n", "self", ".", "_clip_length", "=", "self", ".", "_mocap_qpos", ".", "shape", "[", "0", "]", "\n", "\n", "self", ".", "_num_bodies", "=", "len", "(", "self", ".", "_mocap_xipos", "[", "0", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.MoCapTask.initialize_episode": [[67, 100], ["mocap_tracking.MoCapTask.random.randint", "physics.data.qpos[].copy", "mocap_tracking.MoCapTask.random.normal", "mocap_tracking.MoCapTask.random.normal", "range", "physics.step"], "methods", ["None"], ["", "def", "initialize_episode", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "self", ".", "_test", ":", "\n", "            ", "self", ".", "_mocap_index", "=", "0", "\n", "", "else", ":", "\n", "            ", "self", ".", "_mocap_index", "=", "self", ".", "random", ".", "randint", "(", "\n", "self", ".", "_clip_length", "-", "self", ".", "_min_episode_steps", ")", "\n", "", "self", ".", "_max_mocap_index", "=", "self", ".", "_clip_length", "-", "1", "\n", "\n", "# Joints.", "\n", "target_qpos", "=", "self", ".", "_mocap_qpos", "[", "self", ".", "_mocap_index", "]", "\n", "physics", ".", "data", ".", "qpos", "[", ":", "]", "=", "target_qpos", "\n", "\n", "# Velocities.", "\n", "target_qvel", "=", "self", ".", "_mocap_qvel", "[", "self", ".", "_mocap_index", "]", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "target_qvel", "\n", "\n", "if", "not", "self", ".", "_test", "and", "self", ".", "_init_noise_scale", ":", "\n", "            ", "init_root_qpos", "=", "physics", ".", "data", ".", "qpos", "[", ":", "6", "]", ".", "copy", "(", ")", "\n", "physics", ".", "data", ".", "qpos", "[", "8", "]", "+=", "self", ".", "random", ".", "normal", "(", "\n", "0", ",", "self", ".", "_init_noise_scale", ")", "\n", "physics", ".", "data", ".", "qpos", "[", "21", "]", "+=", "self", ".", "random", ".", "normal", "(", "\n", "0", ",", "self", ".", "_init_noise_scale", ")", "\n", "\n", "# Satisfy constraints.", "\n", "for", "_", "in", "range", "(", "20", ")", ":", "\n", "                ", "physics", ".", "step", "(", ")", "\n", "\n", "", "physics", ".", "data", ".", "time", "=", "0", "\n", "physics", ".", "data", ".", "qpos", "[", ":", "6", "]", "=", "init_root_qpos", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "target_qvel", "\n", "\n", "", "if", "self", ".", "_play", ":", "\n", "            ", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.MoCapTask.after_step": [[101, 128], ["numpy.linalg.norm", "numpy.prod", "numpy.reshape", "numpy.reshape", "numpy.matmul", "numpy.arccos", "numpy.prod", "physics.forward", "numpy.exp", "numpy.transpose", "numpy.clip", "numpy.exp", "numpy.trace"], "methods", ["None"], ["", "", "def", "after_step", "(", "self", ",", "physics", ")", ":", "\n", "        ", "self", ".", "_mocap_index", "+=", "1", "\n", "\n", "if", "self", ".", "_play", ":", "\n", "            ", "target_qpos", "=", "self", ".", "_mocap_qpos", "[", "self", ".", "_mocap_index", "]", "\n", "physics", ".", "data", ".", "qpos", "[", ":", "]", "=", "target_qpos", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "0", "\n", "physics", ".", "forward", "(", ")", "\n", "\n", "# Xipos.", "\n", "", "target_xipos", "=", "self", ".", "_mocap_xipos", "[", "self", ".", "_mocap_index", "]", "\n", "xipos", "=", "physics", ".", "data", ".", "xipos", "[", "2", ":", "self", ".", "_num_bodies", "+", "2", "]", "\n", "xipos_dists", "=", "np", ".", "linalg", ".", "norm", "(", "target_xipos", "-", "xipos", ",", "axis", "=", "-", "1", ")", "\n", "xipos_rew", "=", "np", ".", "prod", "(", "np", ".", "exp", "(", "-", "self", ".", "_pose_rew_weight", "*", "xipos_dists", ")", ")", "\n", "\n", "# Ximat.", "\n", "target_ximat", "=", "self", ".", "_mocap_ximat", "[", "self", ".", "_mocap_index", "]", "\n", "ximat", "=", "physics", ".", "data", ".", "ximat", "[", "2", ":", "self", ".", "_num_bodies", "+", "2", "]", "\n", "ximat", "=", "np", ".", "reshape", "(", "ximat", ",", "(", "self", ".", "_num_bodies", ",", "3", ",", "3", ")", ")", "\n", "target_ximat", "=", "np", ".", "reshape", "(", "target_ximat", ",", "(", "self", ".", "_num_bodies", ",", "3", ",", "3", ")", ")", "\n", "mul", "=", "np", ".", "matmul", "(", "target_ximat", ",", "np", ".", "transpose", "(", "ximat", ",", "(", "0", ",", "2", ",", "1", ")", ")", ")", "\n", "angles", "=", "np", ".", "arccos", "(", "\n", "np", ".", "clip", "(", "(", "np", ".", "trace", "(", "mul", ",", "axis1", "=", "1", ",", "axis2", "=", "2", ")", "-", "1", ")", "/", "2", ",", "-", "1", ",", "1", ")", ")", "\n", "\n", "ximat_rew", "=", "np", ".", "prod", "(", "np", ".", "exp", "(", "-", "self", ".", "_rot_rew_weight", "*", "angles", ")", ")", "\n", "\n", "self", ".", "_reward", "=", "xipos_rew", "*", "ximat_rew", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.MoCapTask.get_observation": [[129, 141], ["collections.OrderedDict", "physics.pelvis_height", "physics.feet_height", "physics.qpos", "physics.qvel", "numpy.array"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.feet_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.qpos", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qvel"], ["", "def", "get_observation", "(", "self", ",", "physics", ")", ":", "\n", "        ", "obs", "=", "collections", ".", "OrderedDict", "(", ")", "\n", "\n", "obs", "[", "'pelvis_height'", "]", "=", "physics", ".", "pelvis_height", "(", ")", "\n", "obs", "[", "'feet_height'", "]", "=", "physics", ".", "feet_height", "(", ")", "\n", "obs", "[", "'qpos'", "]", "=", "physics", ".", "qpos", "(", ")", "\n", "obs", "[", "'qvel'", "]", "=", "physics", ".", "qvel", "(", ")", "\n", "\n", "obs", "[", "'time_left'", "]", "=", "np", ".", "array", "(", "\n", "[", "1.0", "-", "self", ".", "_mocap_index", "/", "self", ".", "_max_mocap_index", "]", ")", "\n", "\n", "return", "obs", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.MoCapTask.get_reward": [[142, 144], ["None"], "methods", ["None"], ["", "def", "get_reward", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "self", ".", "_reward", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.MoCapTask.get_termination": [[145, 151], ["None"], "methods", ["None"], ["", "def", "get_termination", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "self", ".", "_reward", "<", "self", ".", "_rew_threshold", "and", "not", "self", ".", "_test", ":", "\n", "            ", "return", "1", "\n", "\n", "", "if", "self", ".", "_mocap_index", "+", "1", ">=", "self", ".", "_clip_length", ":", "\n", "            ", "return", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.mocap_tracking.mocap_tracking": [[153, 174], ["ostrichrl.tasks.cassie.SUITE.add", "mocap_tracking.MoCapTask", "os.path.dirname", "Physics.from_xml_path", "dm_control.rl.control.Environment"], "function", ["None"], ["", "", "", "@", "SUITE", ".", "add", "(", "'benchmarking'", ")", "\n", "def", "mocap_tracking", "(", "\n", "clip", "=", "'0047'", ",", "min_episode_steps", "=", "20", ",", "pose_rew_weight", "=", "0.2", ",", "\n", "rot_rew_weight", "=", "0.1", ",", "environment_kwargs", "=", "None", ",", "rew_threshold", "=", "0.01", ",", "\n", "init_noise_scale", "=", "0.02", ",", "test", "=", "False", ",", "play", "=", "False", ",", "random", "=", "None", ",", "\n", ")", ":", "\n", "    ", "task", "=", "MoCapTask", "(", "\n", "clip", "=", "clip", ",", "min_episode_steps", "=", "min_episode_steps", ",", "\n", "pose_rew_weight", "=", "pose_rew_weight", ",", "rot_rew_weight", "=", "rot_rew_weight", ",", "\n", "rew_threshold", "=", "rew_threshold", ",", "init_noise_scale", "=", "init_noise_scale", ",", "\n", "test", "=", "test", ",", "play", "=", "play", ",", "random", "=", "random", ")", "\n", "\n", "path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "\n", "path", "+=", "'/../../assets/models/cassie/cassie.xml'", "\n", "physics", "=", "Physics", ".", "from_xml_path", "(", "path", ")", "\n", "environment_kwargs", "=", "environment_kwargs", "or", "{", "}", "\n", "env", "=", "control", ".", "Environment", "(", "\n", "physics", ",", "task", ",", "time_limit", "=", "10000", ",", "control_timestep", "=", "0.025", ",", "\n", "**", "environment_kwargs", ")", "\n", "\n", "return", "env", "\n", "", ""]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Physics.qpos_without_x": [[13, 15], ["run.Physics.data.qpos.copy"], "methods", ["None"], ["    ", "def", "qpos_without_x", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", ".", "copy", "(", ")", "[", "1", ":", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Physics.qvel": [[16, 18], ["numpy.clip"], "methods", ["None"], ["", "def", "qvel", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "clip", "(", "self", ".", "data", ".", "qvel", ",", "-", "100", ",", "100", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Physics.pelvis_height": [[19, 21], ["run.Physics.named.data.geom_xpos[].copy"], "methods", ["None"], ["", "def", "pelvis_height", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "geom_xpos", "[", "'cassie-pelvis'", ",", "'z'", "]", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Physics.feet_height": [[22, 25], ["numpy.array"], "methods", ["None"], ["", "def", "feet_height", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "array", "(", "[", "self", ".", "named", ".", "data", ".", "xpos", "[", "'right-foot'", ",", "'z'", "]", ",", "\n", "self", ".", "named", ".", "data", ".", "xpos", "[", "'left-foot'", ",", "'z'", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Physics.torso_angle": [[26, 28], ["None"], "methods", ["None"], ["", "def", "torso_angle", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", "[", "4", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Physics.horizontal_velocity": [[29, 31], ["None"], "methods", ["None"], ["", "def", "horizontal_velocity", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "sensordata", "[", "'torso_subtreelinvel'", "]", "[", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Run.initialize_episode": [[34, 49], ["physics.data.qpos[].copy", "run.Run.random.uniform", "run.Run.random.uniform", "range", "physics.step"], "methods", ["None"], ["    ", "def", "initialize_episode", "(", "self", ",", "physics", ")", ":", "\n", "        ", "init_root_qpos", "=", "physics", ".", "data", ".", "qpos", "[", ":", "6", "]", ".", "copy", "(", ")", "\n", "\n", "physics", ".", "data", ".", "qpos", "[", "8", "]", "=", "self", ".", "random", ".", "uniform", "(", "-", "0.1", ",", "0.5", ")", "\n", "physics", ".", "data", ".", "qpos", "[", "21", "]", "=", "self", ".", "random", ".", "uniform", "(", "-", "0.1", ",", "0.5", ")", "\n", "physics", ".", "data", ".", "qpos", "[", "17", "]", "=", "-", "1", "\n", "physics", ".", "data", ".", "qpos", "[", "30", "]", "=", "-", "1", "\n", "\n", "# Satisfy constraints.", "\n", "for", "_", "in", "range", "(", "50", ")", ":", "\n", "            ", "physics", ".", "step", "(", ")", "\n", "\n", "", "physics", ".", "data", ".", "time", "=", "0", "\n", "physics", ".", "data", ".", "qpos", "[", ":", "6", "]", "=", "init_root_qpos", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Run.after_step": [[50, 52], ["None"], "methods", ["None"], ["", "def", "after_step", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Run.get_observation": [[53, 64], ["collections.OrderedDict", "physics.pelvis_height", "physics.feet_height", "physics.qpos_without_x", "physics.qvel", "physics.horizontal_velocity"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.feet_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qpos_without_x", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qvel", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.horizontal_velocity"], ["", "def", "get_observation", "(", "self", ",", "physics", ")", ":", "\n", "        ", "obs", "=", "collections", ".", "OrderedDict", "(", ")", "\n", "\n", "obs", "[", "'pelvis_height'", "]", "=", "physics", ".", "pelvis_height", "(", ")", "\n", "obs", "[", "'feet_height'", "]", "=", "physics", ".", "feet_height", "(", ")", "\n", "obs", "[", "'qpos'", "]", "=", "physics", ".", "qpos_without_x", "(", ")", "\n", "obs", "[", "'qvel'", "]", "=", "physics", ".", "qvel", "(", ")", "\n", "\n", "obs", "[", "'horizontal_velocity'", "]", "=", "physics", ".", "horizontal_velocity", "(", ")", "\n", "\n", "return", "obs", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Run.get_reward": [[65, 67], ["physics.horizontal_velocity"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.horizontal_velocity"], ["", "def", "get_reward", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "physics", ".", "horizontal_velocity", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.Run.get_termination": [[68, 73], ["physics.pelvis_height", "physics.torso_angle", "physics.torso_angle"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.torso_angle", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.torso_angle"], ["", "def", "get_termination", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "physics", ".", "pelvis_height", "(", ")", "<", "0.6", ":", "\n", "            ", "return", "1", "\n", "", "if", "physics", ".", "torso_angle", "(", ")", "<", "-", "0.8", "or", "physics", ".", "torso_angle", "(", ")", ">", "0.8", ":", "\n", "            ", "return", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.cassie.run.run": [[75, 88], ["ostrichrl.tasks.cassie.SUITE.add", "run.Run", "os.path.dirname", "Physics.from_xml_path", "dm_control.rl.control.Environment"], "function", ["None"], ["", "", "", "@", "SUITE", ".", "add", "(", "'benchmarking'", ")", "\n", "def", "run", "(", "environment_kwargs", "=", "None", ",", "random", "=", "None", ")", ":", "\n", "    ", "task", "=", "Run", "(", "random", "=", "random", ")", "\n", "\n", "path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "\n", "path", "+=", "'/../../assets/models/cassie/cassie.xml'", "\n", "physics", "=", "Physics", ".", "from_xml_path", "(", "path", ")", "\n", "environment_kwargs", "=", "environment_kwargs", "or", "{", "}", "\n", "env", "=", "control", ".", "Environment", "(", "\n", "physics", ",", "task", ",", "time_limit", "=", "25", ",", "control_timestep", "=", "0.025", ",", "\n", "**", "environment_kwargs", ")", "\n", "\n", "return", "env", "\n", "", ""]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.qpos": [[13, 15], ["mocap_tracking.Physics.data.qpos.copy"], "methods", ["None"], ["    ", "def", "qpos", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.qvel": [[16, 18], ["numpy.clip"], "methods", ["None"], ["", "def", "qvel", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "clip", "(", "self", ".", "data", ".", "qvel", ",", "-", "100", ",", "100", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.pelvis_height": [[19, 21], ["mocap_tracking.Physics.named.data.geom_xpos[].copy"], "methods", ["None"], ["", "def", "pelvis_height", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "geom_xpos", "[", "'cassie-pelvis'", ",", "'z'", "]", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.feet_height": [[22, 25], ["numpy.array"], "methods", ["None"], ["", "def", "feet_height", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "array", "(", "[", "self", ".", "named", ".", "data", ".", "xpos", "[", "'right-foot'", ",", "'z'", "]", ",", "\n", "self", ".", "named", ".", "data", ".", "xpos", "[", "'left-foot'", ",", "'z'", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.muscle_lengths": [[26, 28], ["mocap_tracking.Physics.data.actuator_length.copy"], "methods", ["None"], ["\n", "", "", "class", "MoCapTask", "(", "base", ".", "Task", ")", ":", "\n", "    ", "def", "__init__", "(", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.muscle_velocities": [[29, 31], ["numpy.clip"], "methods", ["None"], ["self", ",", "clip", ",", "min_episode_steps", ",", "pose_rew_weight", ",", "rot_rew_weight", ",", "\n", "init_noise_scale", ",", "rew_threshold", ",", "test", ",", "play", ",", "random", ",", "\n", ")", ":", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.muscle_activations": [[32, 34], ["numpy.clip"], "methods", ["None"], ["        ", "super", "(", ")", ".", "__init__", "(", "random", "=", "random", ")", "\n", "self", ".", "_min_episode_steps", "=", "min_episode_steps", "\n", "self", ".", "_pose_rew_weight", "=", "pose_rew_weight", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.Physics.muscle_forces": [[35, 37], ["numpy.clip"], "methods", ["None"], ["self", ".", "_rot_rew_weight", "=", "rot_rew_weight", "\n", "self", ".", "_init_noise_scale", "=", "init_noise_scale", "\n", "self", ".", "_rew_threshold", "=", "rew_threshold", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.__init__": [[40, 55], ["dm_control.suite.base.Task.__init__", "mocap_tracking.MoCapTask.initialize_clip"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.__init__", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.initialize_clip"], ["self", ".", "_mocap_index", "=", "0", "\n", "self", ".", "_max_mocap_index", "=", "1", "\n", "self", ".", "initialize_clip", "(", "clip", ")", "\n", "\n", "", "def", "initialize_clip", "(", "self", ",", "clip", ")", ":", "\n", "        ", "path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "+", "'/../../assets/mocap/cassie/'", "\n", "\n", "# Joints.", "\n", "qpos_path", "=", "path", "+", "'qpos/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_qpos", "=", "np", ".", "load", "(", "qpos_path", ")", "\n", "\n", "# Velocities (approximated).", "\n", "qvel_path", "=", "path", "+", "'qvel/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_qvel", "=", "np", ".", "load", "(", "qvel_path", ")", "\n", "\n", "# Xipos.", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.initialize_clip": [[56, 79], ["numpy.load", "numpy.load", "numpy.load", "numpy.load", "len", "len", "os.path.dirname"], "methods", ["None"], ["xipos_path", "=", "path", "+", "'xipos/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_xipos", "=", "np", ".", "load", "(", "xipos_path", ")", "\n", "\n", "# Ximat.", "\n", "ximat_path", "=", "path", "+", "'ximat/'", "+", "clip", "+", "'.npy'", "\n", "self", ".", "_mocap_ximat", "=", "np", ".", "load", "(", "ximat_path", ")", "\n", "\n", "self", ".", "_clip_length", "=", "self", ".", "_mocap_qpos", ".", "shape", "[", "0", "]", "\n", "\n", "self", ".", "_num_bodies", "=", "len", "(", "self", ".", "_mocap_xipos", "[", "0", "]", ")", "\n", "\n", "", "def", "initialize_episode", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "self", ".", "_test", ":", "\n", "            ", "self", ".", "_mocap_index", "=", "0", "\n", "", "else", ":", "\n", "            ", "self", ".", "_mocap_index", "=", "self", ".", "random", ".", "randint", "(", "\n", "self", ".", "_clip_length", "-", "self", ".", "_min_episode_steps", ")", "\n", "", "self", ".", "_max_mocap_index", "=", "self", ".", "_clip_length", "-", "1", "\n", "\n", "# Joints.", "\n", "target_qpos", "=", "self", ".", "_mocap_qpos", "[", "self", ".", "_mocap_index", "]", "\n", "physics", ".", "data", ".", "qpos", "[", ":", "]", "=", "target_qpos", "\n", "\n", "# Velocities.", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.initialize_episode": [[80, 98], ["mocap_tracking.MoCapTask.random.randint", "mocap_tracking.MoCapTask.random.normal"], "methods", ["None"], ["target_qvel", "=", "self", ".", "_mocap_qvel", "[", "self", ".", "_mocap_index", "]", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "target_qvel", "\n", "\n", "if", "not", "self", ".", "_test", "and", "self", ".", "_init_noise_scale", ":", "\n", "            ", "init_root_qpos", "=", "physics", ".", "data", ".", "qpos", "[", ":", "6", "]", ".", "copy", "(", ")", "\n", "physics", ".", "data", ".", "qpos", "[", "8", "]", "+=", "self", ".", "random", ".", "normal", "(", "\n", "0", ",", "self", ".", "_init_noise_scale", ")", "\n", "physics", ".", "data", ".", "qpos", "[", "21", "]", "+=", "self", ".", "random", ".", "normal", "(", "\n", "0", ",", "self", ".", "_init_noise_scale", ")", "\n", "\n", "# Satisfy constraints.", "\n", "for", "_", "in", "range", "(", "20", ")", ":", "\n", "                ", "physics", ".", "step", "(", ")", "\n", "\n", "", "physics", ".", "data", ".", "time", "=", "0", "\n", "physics", ".", "data", ".", "qpos", "[", ":", "6", "]", "=", "init_root_qpos", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "target_qvel", "\n", "\n", "", "if", "self", ".", "_play", ":", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.after_step": [[99, 126], ["numpy.linalg.norm", "numpy.prod", "numpy.reshape", "numpy.reshape", "numpy.matmul", "numpy.arccos", "numpy.prod", "physics.forward", "numpy.exp", "numpy.transpose", "numpy.clip", "numpy.exp", "numpy.trace"], "methods", ["None"], ["            ", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "0", "\n", "\n", "", "", "def", "after_step", "(", "self", ",", "physics", ")", ":", "\n", "        ", "self", ".", "_mocap_index", "+=", "1", "\n", "\n", "if", "self", ".", "_play", ":", "\n", "            ", "target_qpos", "=", "self", ".", "_mocap_qpos", "[", "self", ".", "_mocap_index", "]", "\n", "physics", ".", "data", ".", "qpos", "[", ":", "]", "=", "target_qpos", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "0", "\n", "physics", ".", "forward", "(", ")", "\n", "\n", "# Xipos.", "\n", "", "target_xipos", "=", "self", ".", "_mocap_xipos", "[", "self", ".", "_mocap_index", "]", "\n", "xipos", "=", "physics", ".", "data", ".", "xipos", "[", "2", ":", "self", ".", "_num_bodies", "+", "2", "]", "\n", "xipos_dists", "=", "np", ".", "linalg", ".", "norm", "(", "target_xipos", "-", "xipos", ",", "axis", "=", "-", "1", ")", "\n", "xipos_rew", "=", "np", ".", "prod", "(", "np", ".", "exp", "(", "-", "self", ".", "_pose_rew_weight", "*", "xipos_dists", ")", ")", "\n", "\n", "# Ximat.", "\n", "target_ximat", "=", "self", ".", "_mocap_ximat", "[", "self", ".", "_mocap_index", "]", "\n", "ximat", "=", "physics", ".", "data", ".", "ximat", "[", "2", ":", "self", ".", "_num_bodies", "+", "2", "]", "\n", "ximat", "=", "np", ".", "reshape", "(", "ximat", ",", "(", "self", ".", "_num_bodies", ",", "3", ",", "3", ")", ")", "\n", "target_ximat", "=", "np", ".", "reshape", "(", "target_ximat", ",", "(", "self", ".", "_num_bodies", ",", "3", ",", "3", ")", ")", "\n", "mul", "=", "np", ".", "matmul", "(", "target_ximat", ",", "np", ".", "transpose", "(", "ximat", ",", "(", "0", ",", "2", ",", "1", ")", ")", ")", "\n", "angles", "=", "np", ".", "arccos", "(", "\n", "np", ".", "clip", "(", "(", "np", ".", "trace", "(", "mul", ",", "axis1", "=", "1", ",", "axis2", "=", "2", ")", "-", "1", ")", "/", "2", ",", "-", "1", ",", "1", ")", ")", "\n", "\n", "ximat_rew", "=", "np", ".", "prod", "(", "np", ".", "exp", "(", "-", "self", ".", "_rot_rew_weight", "*", "angles", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.get_observation": [[127, 143], ["collections.OrderedDict", "physics.pelvis_height", "physics.feet_height", "physics.qpos", "physics.qvel", "physics.muscle_activations", "physics.muscle_forces", "physics.muscle_lengths", "physics.muscle_velocities", "numpy.array"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.feet_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.qpos", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qvel", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_activations", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_forces", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_lengths", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_velocities"], ["self", ".", "_reward", "=", "xipos_rew", "*", "ximat_rew", "\n", "\n", "", "def", "get_observation", "(", "self", ",", "physics", ")", ":", "\n", "        ", "obs", "=", "collections", ".", "OrderedDict", "(", ")", "\n", "\n", "obs", "[", "'pelvis_height'", "]", "=", "physics", ".", "pelvis_height", "(", ")", "\n", "obs", "[", "'feet_height'", "]", "=", "physics", ".", "feet_height", "(", ")", "\n", "obs", "[", "'qpos'", "]", "=", "physics", ".", "qpos", "(", ")", "\n", "obs", "[", "'qvel'", "]", "=", "physics", ".", "qvel", "(", ")", "\n", "\n", "obs", "[", "'time_left'", "]", "=", "np", ".", "array", "(", "\n", "[", "1.0", "-", "self", ".", "_mocap_index", "/", "self", ".", "_max_mocap_index", "]", ")", "\n", "\n", "return", "obs", "\n", "\n", "", "def", "get_reward", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "self", ".", "_reward", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.get_reward": [[144, 146], ["None"], "methods", ["None"], ["\n", "", "def", "get_termination", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "self", ".", "_reward", "<", "self", ".", "_rew_threshold", "and", "not", "self", ".", "_test", ":", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.MoCapTask.get_termination": [[147, 153], ["None"], "methods", ["None"], ["            ", "return", "1", "\n", "\n", "", "if", "self", ".", "_mocap_index", "+", "1", ">=", "self", ".", "_clip_length", ":", "\n", "            ", "return", "1", "\n", "\n", "\n", "", "", "", "@", "SUITE", ".", "add", "(", "'benchmarking'", ")", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.mocap_tracking.mocap_tracking": [[155, 176], ["ostrichrl.tasks.ostrich.SUITE.add", "mocap_tracking.MoCapTask", "os.path.dirname", "Physics.from_xml_path", "dm_control.rl.control.Environment"], "function", ["None"], ["clip", "=", "'0047'", ",", "min_episode_steps", "=", "20", ",", "pose_rew_weight", "=", "0.2", ",", "\n", "rot_rew_weight", "=", "0.1", ",", "environment_kwargs", "=", "None", ",", "rew_threshold", "=", "0.01", ",", "\n", "init_noise_scale", "=", "0.02", ",", "test", "=", "False", ",", "play", "=", "False", ",", "random", "=", "None", ",", "\n", ")", ":", "\n", "    ", "task", "=", "MoCapTask", "(", "\n", "clip", "=", "clip", ",", "min_episode_steps", "=", "min_episode_steps", ",", "\n", "pose_rew_weight", "=", "pose_rew_weight", ",", "rot_rew_weight", "=", "rot_rew_weight", ",", "\n", "rew_threshold", "=", "rew_threshold", ",", "init_noise_scale", "=", "init_noise_scale", ",", "\n", "test", "=", "test", ",", "play", "=", "play", ",", "random", "=", "random", ")", "\n", "\n", "path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "\n", "path", "+=", "'/../../assets/models/cassie/cassie.xml'", "\n", "physics", "=", "Physics", ".", "from_xml_path", "(", "path", ")", "\n", "environment_kwargs", "=", "environment_kwargs", "or", "{", "}", "\n", "env", "=", "control", ".", "Environment", "(", "\n", "physics", ",", "task", ",", "time_limit", "=", "10000", ",", "control_timestep", "=", "0.025", ",", "\n", "**", "environment_kwargs", ")", "\n", "\n", "return", "env", "\n", "", ""]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.qpos": [[15, 17], ["foraging.Physics.data.qpos.copy"], "methods", ["None"], ["    ", "def", "qpos", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.qvel": [[18, 22], ["foraging.Physics.data.qvel.copy", "numpy.clip"], "methods", ["None"], ["", "def", "qvel", "(", "self", ")", ":", "\n", "        ", "qvel", "=", "self", ".", "data", ".", "qvel", ".", "copy", "(", ")", "\n", "qvel", "=", "np", ".", "clip", "(", "qvel", ",", "-", "100", ",", "100", ")", "\n", "return", "qvel", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.muscle_lengths": [[23, 25], ["foraging.Physics.data.actuator_length.copy"], "methods", ["None"], ["", "def", "muscle_lengths", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "actuator_length", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.muscle_velocities": [[26, 30], ["foraging.Physics.data.actuator_velocity.copy", "numpy.clip"], "methods", ["None"], ["", "def", "muscle_velocities", "(", "self", ")", ":", "\n", "        ", "velocities", "=", "self", ".", "data", ".", "actuator_velocity", ".", "copy", "(", ")", "\n", "velocities", "=", "np", ".", "clip", "(", "velocities", ",", "-", "100", ",", "100", ")", "\n", "return", "velocities", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.muscle_activations": [[31, 35], ["foraging.Physics.data.act.copy", "numpy.clip"], "methods", ["None"], ["", "def", "muscle_activations", "(", "self", ")", ":", "\n", "        ", "activations", "=", "self", ".", "data", ".", "act", ".", "copy", "(", ")", "\n", "activations", "=", "np", ".", "clip", "(", "activations", ",", "-", "100", ",", "100", ")", "\n", "return", "activations", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.muscle_forces": [[36, 41], ["foraging.Physics.data.actuator_force.copy", "numpy.clip"], "methods", ["None"], ["", "def", "muscle_forces", "(", "self", ")", ":", "\n", "        ", "forces", "=", "self", ".", "data", ".", "actuator_force", ".", "copy", "(", ")", "\n", "forces", "/=", "1000", "\n", "forces", "=", "np", ".", "clip", "(", "forces", ",", "-", "100", ",", "100", ")", "\n", "return", "forces", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.beak": [[42, 44], ["foraging.Physics.named.data.site_xpos[].copy"], "methods", ["None"], ["", "def", "beak", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "site_xpos", "[", "'beak'", "]", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.__init__": [[47, 55], ["dm_control.suite.base.Task.__init__", "numpy.array"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.__init__"], ["    ", "def", "__init__", "(", "self", ",", "random", "=", "None", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", "random", "=", "random", ")", "\n", "\n", "self", ".", "prev_pos", "=", "None", "\n", "self", ".", "target", "=", "np", ".", "array", "(", "[", "0", ",", "0", ",", "0", "]", ")", "\n", "self", ".", "forbidden_sphere_radius", "=", "0.6", "\n", "self", ".", "allowed_sphere_radius", "=", "0.8", "\n", "self", ".", "threshold", "=", "5e-2", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.initialize_episode": [[56, 84], ["numpy.zeros_like", "foraging.Task.random.uniform", "foraging.Task.random.uniform", "foraging.Task.random.uniform", "numpy.arccos", "numpy.array", "numpy.linalg.norm", "numpy.cbrt", "numpy.cos", "numpy.sin", "numpy.cos", "numpy.sin", "numpy.sin"], "methods", ["None"], ["", "def", "initialize_episode", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "self", ".", "prev_pos", "is", "None", ":", "\n", "            ", "self", ".", "prev_pos", "=", "np", ".", "zeros_like", "(", "physics", ".", "data", ".", "qpos", "[", ":", "]", ")", "\n", "\n", "# Set initial neck position", "\n", "", "physics", ".", "named", ".", "data", ".", "qpos", "[", ":", "]", "=", "self", ".", "prev_pos", "\n", "\n", "while", "True", ":", "\n", "# Set target position", "\n", "            ", "phi", "=", "self", ".", "random", ".", "uniform", "(", "low", "=", "0", ",", "high", "=", "2", "*", "np", ".", "pi", ")", "\n", "costheta", "=", "self", ".", "random", ".", "uniform", "(", "low", "=", "-", "1", ",", "high", "=", "1", ")", "\n", "u", "=", "self", ".", "random", ".", "uniform", "(", "low", "=", "0", ",", "high", "=", "1", ")", "\n", "\n", "theta", "=", "np", ".", "arccos", "(", "costheta", ")", "\n", "r", "=", "self", ".", "allowed_sphere_radius", "*", "np", ".", "cbrt", "(", "u", ")", "\n", "\n", "x", "=", "r", "*", "np", ".", "sin", "(", "theta", ")", "*", "np", ".", "cos", "(", "phi", ")", "\n", "y", "=", "r", "*", "np", ".", "sin", "(", "theta", ")", "*", "np", ".", "sin", "(", "phi", ")", "\n", "z", "=", "r", "*", "np", ".", "cos", "(", "theta", ")", "\n", "\n", "self", ".", "target", "=", "np", ".", "array", "(", "[", "x", ",", "y", ",", "z", "]", ")", "\n", "self", ".", "target", "+=", "physics", ".", "named", ".", "data", ".", "site_xpos", "[", "'allowed_sphere'", "]", "\n", "\n", "# check if self.target is inside the threshol_sphere", "\n", "dist", "=", "np", ".", "linalg", ".", "norm", "(", "\n", "self", ".", "target", "-", "physics", ".", "named", ".", "data", ".", "site_xpos", "[", "'forbidden_sphere'", "]", ")", "\n", "if", "not", "dist", "<=", "self", ".", "forbidden_sphere_radius", ":", "\n", "                ", "break", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.after_step": [[85, 91], ["None"], "methods", ["None"], ["", "", "", "def", "after_step", "(", "self", ",", "physics", ")", ":", "\n", "# In env.step() a call to physics.step() is made and that also resets", "\n", "# the position of the target site. Specifying this function is also", "\n", "# important because there's an issue with visualize reward.", "\n", "        ", "physics", ".", "named", ".", "data", ".", "site_xpos", "[", "'target'", "]", "=", "self", ".", "target", "\n", "return", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.get_reward": [[92, 97], ["numpy.sqrt"], "methods", ["None"], ["", "def", "get_reward", "(", "self", ",", "physics", ")", ":", "\n", "        ", "target_site", "=", "physics", ".", "named", ".", "data", ".", "site_xpos", "[", "'target'", "]", "\n", "beak_site", "=", "physics", ".", "named", ".", "data", ".", "site_xpos", "[", "'beak'", "]", "\n", "self", ".", "distance", "=", "np", ".", "sqrt", "(", "(", "(", "target_site", "-", "beak_site", ")", "**", "2", ")", ".", "sum", "(", ")", ")", "\n", "return", "-", "self", ".", "distance", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.get_termination": [[98, 103], ["physics.data.qpos.copy"], "methods", ["None"], ["", "def", "get_termination", "(", "self", ",", "physics", ")", ":", "\n", "# The last pose is used to initialize the next episode.", "\n", "        ", "self", ".", "prev_pos", "=", "physics", ".", "data", ".", "qpos", ".", "copy", "(", ")", "\n", "if", "self", ".", "distance", "<=", "self", ".", "threshold", ":", "\n", "            ", "return", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Task.get_observation": [[104, 120], ["collections.OrderedDict", "physics.qpos", "physics.qvel", "physics.muscle_activations", "physics.muscle_forces", "physics.muscle_lengths", "physics.muscle_velocities", "physics.beak", "foraging.Task.target.copy", "physics.beak"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.qpos", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qvel", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_activations", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_forces", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_lengths", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_velocities", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.beak", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.Physics.beak"], ["", "", "def", "get_observation", "(", "self", ",", "physics", ")", ":", "\n", "        ", "obs", "=", "collections", ".", "OrderedDict", "(", ")", "\n", "\n", "obs", "[", "'qpos'", "]", "=", "physics", ".", "qpos", "(", ")", "\n", "obs", "[", "'qvel'", "]", "=", "physics", ".", "qvel", "(", ")", "\n", "\n", "obs", "[", "'muscle_activations'", "]", "=", "physics", ".", "muscle_activations", "(", ")", "\n", "obs", "[", "'muscle_forces'", "]", "=", "physics", ".", "muscle_forces", "(", ")", "\n", "obs", "[", "'muscle_lengths'", "]", "=", "physics", ".", "muscle_lengths", "(", ")", "\n", "obs", "[", "'muscle_velocities'", "]", "=", "physics", ".", "muscle_velocities", "(", ")", "\n", "\n", "obs", "[", "'beak'", "]", "=", "physics", ".", "beak", "(", ")", "\n", "obs", "[", "'target'", "]", "=", "self", ".", "target", ".", "copy", "(", ")", "\n", "obs", "[", "'target_beak'", "]", "=", "self", ".", "target", "-", "physics", ".", "beak", "(", ")", "\n", "\n", "return", "obs", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.foraging.foraging": [[122, 137], ["ostrichrl.tasks.ostrich.SUITE.add", "foraging.Task", "os.path.dirname", "Physics.from_xml_path", "dm_control.rl.control.Environment"], "function", ["None"], ["", "", "@", "SUITE", ".", "add", "(", "'benchmarking'", ")", "\n", "def", "foraging", "(", "\n", "environment_kwargs", "=", "None", ",", "random", "=", "None", ",", "\n", ")", ":", "\n", "    ", "task", "=", "Task", "(", "random", "=", "random", ")", "\n", "\n", "path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "\n", "path", "+=", "'/../../assets/models/ostrich/ostrich_neck.xml'", "\n", "physics", "=", "Physics", ".", "from_xml_path", "(", "path", ")", "\n", "environment_kwargs", "=", "environment_kwargs", "or", "{", "}", "\n", "env", "=", "control", ".", "Environment", "(", "\n", "physics", ",", "task", ",", "time_limit", "=", "25", ",", "control_timestep", "=", "0.025", ",", "\n", "**", "environment_kwargs", ")", "\n", "\n", "return", "env", "\n", "", ""]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.Physics.qpos_without_x": [[13, 15], ["run_torque.Physics.data.qpos.copy"], "methods", ["None"], ["    ", "def", "qpos_without_x", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", ".", "copy", "(", ")", "[", "1", ":", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.Physics.qvel": [[16, 20], ["run_torque.Physics.data.qvel.copy", "numpy.clip"], "methods", ["None"], ["", "def", "qvel", "(", "self", ")", ":", "\n", "        ", "qvel", "=", "self", ".", "data", ".", "qvel", ".", "copy", "(", ")", "\n", "qvel", "=", "np", ".", "clip", "(", "qvel", ",", "-", "100", ",", "100", ")", "\n", "return", "qvel", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.Physics.pelvis_height": [[21, 23], ["run_torque.Physics.named.data.geom_xpos[].copy"], "methods", ["None"], ["", "def", "pelvis_height", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "geom_xpos", "[", "'pelvis'", ",", "'z'", "]", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.Physics.feet_height": [[24, 27], ["numpy.array"], "methods", ["None"], ["", "def", "feet_height", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "array", "(", "[", "self", ".", "named", ".", "data", ".", "xpos", "[", "'r_pes'", ",", "'z'", "]", ",", "\n", "self", ".", "named", ".", "data", ".", "xpos", "[", "'l_pes'", ",", "'z'", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.Physics.torso_angle": [[28, 30], ["run_torque.Physics.data.qpos.copy"], "methods", ["None"], ["", "def", "torso_angle", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", ".", "copy", "(", ")", "[", "4", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.Physics.horizontal_velocity": [[31, 33], ["run_torque.Physics.named.data.sensordata[].copy"], "methods", ["None"], ["", "def", "horizontal_velocity", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "sensordata", "[", "'torso_subtreelinvel'", "]", ".", "copy", "(", ")", "[", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.RunTorque.initialize_episode": [[36, 41], ["run_torque.RunTorque.random.uniform"], "methods", ["None"], ["    ", "def", "initialize_episode", "(", "self", ",", "physics", ")", ":", "\n", "        ", "limits", "=", "physics", ".", "data", ".", "model", ".", "jnt_range", "[", "6", ":", "]", "\n", "physics", ".", "data", ".", "qpos", "[", "6", ":", "]", "=", "self", ".", "random", ".", "uniform", "(", "\n", "low", "=", "limits", "[", ":", ",", "0", "]", "/", "5", ",", "high", "=", "limits", "[", ":", ",", "1", "]", "/", "5", ")", "\n", "physics", ".", "data", ".", "qvel", "[", ":", "]", "=", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.RunTorque.after_step": [[42, 44], ["None"], "methods", ["None"], ["", "def", "after_step", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.RunTorque.get_observation": [[45, 56], ["collections.OrderedDict", "physics.pelvis_height", "physics.feet_height", "physics.qpos_without_x", "physics.qvel", "physics.horizontal_velocity"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.feet_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qpos_without_x", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qvel", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.horizontal_velocity"], ["", "def", "get_observation", "(", "self", ",", "physics", ")", ":", "\n", "        ", "obs", "=", "collections", ".", "OrderedDict", "(", ")", "\n", "\n", "obs", "[", "'pelvis_height'", "]", "=", "physics", ".", "pelvis_height", "(", ")", "\n", "obs", "[", "'feet_height'", "]", "=", "physics", ".", "feet_height", "(", ")", "\n", "obs", "[", "'qpos'", "]", "=", "physics", ".", "qpos_without_x", "(", ")", "\n", "obs", "[", "'qvel'", "]", "=", "physics", ".", "qvel", "(", ")", "\n", "\n", "obs", "[", "'horizontal_velocity'", "]", "=", "physics", ".", "horizontal_velocity", "(", ")", "\n", "\n", "return", "obs", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.RunTorque.get_reward": [[57, 59], ["physics.horizontal_velocity"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.horizontal_velocity"], ["", "def", "get_reward", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "physics", ".", "horizontal_velocity", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.RunTorque.get_termination": [[60, 65], ["physics.pelvis_height", "physics.torso_angle", "physics.torso_angle"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.torso_angle", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.torso_angle"], ["", "def", "get_termination", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "physics", ".", "pelvis_height", "(", ")", "<", "0.6", ":", "\n", "            ", "return", "1", "\n", "", "if", "physics", ".", "torso_angle", "(", ")", "<", "-", "0.8", "or", "physics", ".", "torso_angle", "(", ")", ">", "0.8", ":", "\n", "            ", "return", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run_torque.run_torque": [[67, 80], ["ostrichrl.tasks.ostrich.SUITE.add", "run_torque.RunTorque", "os.path.dirname", "Physics.from_xml_path", "dm_control.rl.control.Environment"], "function", ["None"], ["", "", "", "@", "SUITE", ".", "add", "(", "'benchmarking'", ")", "\n", "def", "run_torque", "(", "environment_kwargs", "=", "None", ",", "random", "=", "None", ")", ":", "\n", "    ", "task", "=", "RunTorque", "(", "random", "=", "random", ")", "\n", "\n", "path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "\n", "path", "+=", "'/../../assets/models/ostrich/ostrich_legs_torque.xml'", "\n", "physics", "=", "Physics", ".", "from_xml_path", "(", "path", ")", "\n", "environment_kwargs", "=", "environment_kwargs", "or", "{", "}", "\n", "env", "=", "control", ".", "Environment", "(", "\n", "physics", ",", "task", ",", "time_limit", "=", "25", ",", "control_timestep", "=", "0.025", ",", "\n", "**", "environment_kwargs", ")", "\n", "\n", "return", "env", "\n", "", ""]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qpos_without_x": [[13, 15], ["run.Physics.data.qpos.copy"], "methods", ["None"], ["    ", "def", "qpos_without_x", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", ".", "copy", "(", ")", "[", "1", ":", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qvel": [[16, 18], ["numpy.clip"], "methods", ["None"], ["", "def", "qvel", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "clip", "(", "self", ".", "data", ".", "qvel", ",", "-", "100", ",", "100", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height": [[19, 21], ["run.Physics.named.data.geom_xpos[].copy"], "methods", ["None"], ["", "def", "pelvis_height", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "geom_xpos", "[", "'cassie-pelvis'", ",", "'z'", "]", ".", "copy", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.feet_height": [[22, 25], ["numpy.array"], "methods", ["None"], ["", "def", "feet_height", "(", "self", ")", ":", "\n", "        ", "return", "np", ".", "array", "(", "[", "self", ".", "named", ".", "data", ".", "xpos", "[", "'right-foot'", ",", "'z'", "]", ",", "\n", "self", ".", "named", ".", "data", ".", "xpos", "[", "'left-foot'", ",", "'z'", "]", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.head_height": [[26, 28], ["run.Physics.named.data.xpos[].copy"], "methods", ["None"], ["", "def", "torso_angle", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "data", ".", "qpos", "[", "4", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_lengths": [[29, 31], ["run.Physics.data.actuator_length.copy"], "methods", ["None"], ["", "def", "horizontal_velocity", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "named", ".", "data", ".", "sensordata", "[", "'torso_subtreelinvel'", "]", "[", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_velocities": [[32, 34], ["numpy.clip"], "methods", ["None"], ["\n", "", "", "class", "Run", "(", "base", ".", "Task", ")", ":", "\n", "    ", "def", "initialize_episode", "(", "self", ",", "physics", ")", ":", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_activations": [[35, 37], ["numpy.clip"], "methods", ["None"], ["        ", "init_root_qpos", "=", "physics", ".", "data", ".", "qpos", "[", ":", "6", "]", ".", "copy", "(", ")", "\n", "\n", "physics", ".", "data", ".", "qpos", "[", "8", "]", "=", "self", ".", "random", ".", "uniform", "(", "-", "0.1", ",", "0.5", ")", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_forces": [[38, 40], ["numpy.clip"], "methods", ["None"], ["physics", ".", "data", ".", "qpos", "[", "21", "]", "=", "self", ".", "random", ".", "uniform", "(", "-", "0.1", ",", "0.5", ")", "\n", "physics", ".", "data", ".", "qpos", "[", "17", "]", "=", "-", "1", "\n", "physics", ".", "data", ".", "qpos", "[", "30", "]", "=", "-", "1", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.torso_angle": [[41, 43], ["None"], "methods", ["None"], ["\n", "# Satisfy constraints.", "\n", "for", "_", "in", "range", "(", "50", ")", ":", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.horizontal_velocity": [[44, 46], ["None"], "methods", ["None"], ["            ", "physics", ".", "step", "(", ")", "\n", "\n", "", "physics", ".", "data", ".", "time", "=", "0", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Run.initialize_episode": [[49, 54], ["run.Run.random.uniform"], "methods", ["None"], ["\n", "", "def", "after_step", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "\n", "\n", "", "def", "get_observation", "(", "self", ",", "physics", ")", ":", "\n", "        ", "obs", "=", "collections", ".", "OrderedDict", "(", ")", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Run.after_step": [[55, 57], ["None"], "methods", ["None"], ["\n", "obs", "[", "'pelvis_height'", "]", "=", "physics", ".", "pelvis_height", "(", ")", "\n", "obs", "[", "'feet_height'", "]", "=", "physics", ".", "feet_height", "(", ")", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Run.get_observation": [[58, 75], ["collections.OrderedDict", "physics.head_height", "physics.pelvis_height", "physics.feet_height", "physics.qpos_without_x", "physics.qvel", "physics.muscle_activations", "physics.muscle_forces", "physics.muscle_lengths", "physics.muscle_velocities", "physics.horizontal_velocity"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.head_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.feet_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qpos_without_x", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.qvel", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_activations", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_forces", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_lengths", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.muscle_velocities", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.horizontal_velocity"], ["obs", "[", "'qpos'", "]", "=", "physics", ".", "qpos_without_x", "(", ")", "\n", "obs", "[", "'qvel'", "]", "=", "physics", ".", "qvel", "(", ")", "\n", "\n", "obs", "[", "'horizontal_velocity'", "]", "=", "physics", ".", "horizontal_velocity", "(", ")", "\n", "\n", "return", "obs", "\n", "\n", "", "def", "get_reward", "(", "self", ",", "physics", ")", ":", "\n", "        ", "return", "physics", ".", "horizontal_velocity", "(", ")", "\n", "\n", "", "def", "get_termination", "(", "self", ",", "physics", ")", ":", "\n", "        ", "if", "physics", ".", "pelvis_height", "(", ")", "<", "0.6", ":", "\n", "            ", "return", "1", "\n", "", "if", "physics", ".", "torso_angle", "(", ")", "<", "-", "0.8", "or", "physics", ".", "torso_angle", "(", ")", ">", "0.8", ":", "\n", "            ", "return", "1", "\n", "\n", "\n", "", "", "", "@", "SUITE", ".", "add", "(", "'benchmarking'", ")", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Run.get_reward": [[76, 78], ["physics.horizontal_velocity"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.horizontal_velocity"], ["def", "run", "(", "environment_kwargs", "=", "None", ",", "random", "=", "None", ")", ":", "\n", "    ", "task", "=", "Run", "(", "random", "=", "random", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Run.get_termination": [[79, 86], ["physics.head_height", "physics.pelvis_height", "physics.torso_angle", "physics.torso_angle"], "methods", ["home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.head_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.pelvis_height", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.torso_angle", "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.Physics.torso_angle"], ["path", "=", "os", ".", "path", ".", "dirname", "(", "__file__", ")", "\n", "path", "+=", "'/../../assets/models/cassie/cassie.xml'", "\n", "physics", "=", "Physics", ".", "from_xml_path", "(", "path", ")", "\n", "environment_kwargs", "=", "environment_kwargs", "or", "{", "}", "\n", "env", "=", "control", ".", "Environment", "(", "\n", "physics", ",", "task", ",", "time_limit", "=", "25", ",", "control_timestep", "=", "0.025", ",", "\n", "**", "environment_kwargs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.vittorione94_ostrichrl.ostrich.run.run": [[88, 101], ["ostrichrl.tasks.ostrich.SUITE.add", "run.Run", "os.path.dirname", "Physics.from_xml_path", "dm_control.rl.control.Environment"], "function", ["None"], ["", ""]]}