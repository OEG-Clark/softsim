{"home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.corruption_evaluator.zsl_launch": [[11, 68], ["torchvision.models.resnet101().cuda", "torch.Sequential", "print", "torch.load().cuda", "torch.load().cuda", "torch.load().cuda", "fullgraph.FullGraph().cuda", "FullGraph().cuda.eval", "torch.SGD", "art.classifiers.PyTorchClassifier", "time.time", "enumerate", "time.time", "numpy.array", "tools.normalized_accuracy_zsl", "print", "print", "FullGraph().cuda.parameters", "sample[].numpy", "sample[].numpy", "art.classifiers.PyTorchClassifier.predict", "preds.extend", "np.array.extend", "torchvision.models.resnet101", "torch.load", "torch.load", "torch.load", "fullgraph.FullGraph", "numpy.argmax", "print", "list", "len", "torchvision.models.resnet101().cuda.children"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.normalized_accuracy_zsl"], ["def", "zsl_launch", "(", "dataloader", ",", "unseenVectors", ",", "criterion", ",", "params", ")", ":", "\n", "    ", "if", "params", "[", "\"dataset\"", "]", "==", "\"CUB\"", ":", "\n", "        ", "from", "configs", ".", "config_CUB", "import", "cub_model_paths", "\n", "model_path", "=", "cub_model_paths", "[", "params", "[", "\"test_model\"", "]", "]", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"AWA2\"", ":", "\n", "        ", "from", "configs", ".", "config_AWA2", "import", "awa_model_paths", "\n", "model_path", "=", "awa_model_paths", "[", "params", "[", "\"test_model\"", "]", "]", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"SUN\"", ":", "\n", "        ", "from", "configs", ".", "config_SUN", "import", "sun_model_paths", "\n", "model_path", "=", "sun_model_paths", "[", "params", "[", "\"test_model\"", "]", "]", "\n", "\n", "", "resnet", "=", "torchvision", ".", "models", ".", "resnet101", "(", "pretrained", "=", "True", ")", ".", "cuda", "(", ")", "\n", "feature_extractor", "=", "nn", ".", "Sequential", "(", "*", "list", "(", "resnet", ".", "children", "(", ")", ")", "[", ":", "-", "1", "]", ")", "\n", "\n", "print", "(", "\"Loading:\"", ",", "model_path", ")", "\n", "model_ale", "=", "torch", ".", "load", "(", "model_path", ")", ".", "cuda", "(", ")", "\n", "if", "params", "[", "\"test_model\"", "]", "==", "\"ant\"", "or", "params", "[", "\"test_model\"", "]", "==", "\"augmix\"", ":", "\n", "        ", "model_ale", "=", "model_ale", ".", "ale_graph", "\n", "\n", "", "full_graph", "=", "FullGraph", "(", "feature_extractor", ",", "model_ale", ",", "unseenVectors", ")", ".", "cuda", "(", ")", "\n", "full_graph", ".", "eval", "(", ")", "\n", "optimizer", "=", "optim", ".", "SGD", "(", "full_graph", ".", "parameters", "(", ")", ",", "lr", "=", "0.01", ",", "momentum", "=", "0.5", ")", "\n", "\n", "if", "params", "[", "\"dataset\"", "]", "==", "\"CUB\"", ":", "\n", "        ", "no_classes", "=", "50", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"AWA2\"", ":", "\n", "        ", "no_classes", "=", "10", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"SUN\"", ":", "\n", "        ", "no_classes", "=", "72", "\n", "\n", "", "classifier", "=", "PyTorchClassifier", "(", "model", "=", "full_graph", ",", "loss", "=", "criterion", ",", "\n", "optimizer", "=", "optimizer", ",", "input_shape", "=", "(", "1", ",", "150", ",", "150", ")", ",", "nb_classes", "=", "no_classes", ")", "\n", "batch_size", "=", "params", "[", "\"batch_size\"", "]", "\n", "\n", "preds", "=", "[", "]", "\n", "labels_", "=", "[", "]", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "\n", "for", "index", ",", "sample", "in", "enumerate", "(", "dataloader", ")", ":", "\n", "        ", "img", "=", "sample", "[", "0", "]", ".", "numpy", "(", ")", "\n", "label", "=", "sample", "[", "1", "]", ".", "numpy", "(", ")", "\n", "\n", "predictions", "=", "classifier", ".", "predict", "(", "img", ",", "batch_size", "=", "batch_size", ")", "\n", "preds", ".", "extend", "(", "np", ".", "argmax", "(", "predictions", ",", "axis", "=", "1", ")", ")", "\n", "labels_", ".", "extend", "(", "label", ")", "\n", "\n", "if", "index", "%", "1000", "==", "0", ":", "\n", "            ", "print", "(", "index", ",", "len", "(", "dataloader", ")", ")", "\n", "\n", "", "", "end", "=", "time", ".", "time", "(", ")", "\n", "\n", "labels_", "=", "np", ".", "array", "(", "labels_", ")", "\n", "\n", "acc_adversarial", "=", "normalized_accuracy_zsl", "(", "preds", ",", "labels_", ")", "\n", "\n", "print", "(", "\"ZSL Top-1:\"", ",", "acc_adversarial", ")", "\n", "print", "(", "end", "-", "start", ",", "\"seconds passed for ZSL.\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.corruption_evaluator.gzsl_launch": [[69, 147], ["torchvision.models.resnet101().cuda", "torch.Sequential", "print", "torch.load().cuda", "torch.load().cuda", "torch.load().cuda", "fullgraph.FullGraph().cuda", "FullGraph().cuda.eval", "torch.SGD", "art.classifiers.PyTorchClassifier", "time.time", "enumerate", "numpy.array", "numpy.unique", "numpy.array", "enumerate", "time.time", "numpy.array", "numpy.unique", "numpy.concatenate", "numpy.array", "numpy.concatenate", "tools.harmonic_score_gzsl", "print", "FullGraph().cuda.parameters", "sample[].numpy", "sample[].numpy", "art.classifiers.PyTorchClassifier.predict", "np.array.extend", "np.array.extend", "sample[].numpy", "sample[].numpy", "art.classifiers.PyTorchClassifier.predict", "np.array.extend", "np.array.extend", "torchvision.models.resnet101", "torch.load", "torch.load", "torch.load", "fullgraph.FullGraph", "numpy.argmax", "print", "numpy.argmax", "print", "list", "len", "len", "torchvision.models.resnet101().cuda.children"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.harmonic_score_gzsl"], ["", "def", "gzsl_launch", "(", "dataloader_seen", ",", "dataloader_unseen", ",", "all_vectors", ",", "criterion", ",", "params", ")", ":", "\n", "    ", "if", "params", "[", "\"dataset\"", "]", "==", "\"CUB\"", ":", "\n", "        ", "from", "configs", ".", "config_CUB", "import", "cub_model_paths", "\n", "model_path", "=", "cub_model_paths", "[", "params", "[", "\"test_model\"", "]", "]", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"AWA2\"", ":", "\n", "        ", "from", "configs", ".", "config_AWA2", "import", "awa_model_paths", "\n", "model_path", "=", "awa_model_paths", "[", "params", "[", "\"test_model\"", "]", "]", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"SUN\"", ":", "\n", "        ", "from", "configs", ".", "config_SUN", "import", "sun_model_paths", "\n", "model_path", "=", "sun_model_paths", "[", "params", "[", "\"test_model\"", "]", "]", "\n", "\n", "", "resnet", "=", "torchvision", ".", "models", ".", "resnet101", "(", "pretrained", "=", "True", ")", ".", "cuda", "(", ")", "\n", "feature_extractor", "=", "nn", ".", "Sequential", "(", "*", "list", "(", "resnet", ".", "children", "(", ")", ")", "[", ":", "-", "1", "]", ")", "\n", "\n", "print", "(", "\"Loading:\"", ",", "model_path", ")", "\n", "model_ale", "=", "torch", ".", "load", "(", "model_path", ")", ".", "cuda", "(", ")", "\n", "if", "params", "[", "\"test_model\"", "]", "==", "\"ant\"", "or", "params", "[", "\"test_model\"", "]", "==", "\"augmix\"", ":", "\n", "        ", "model_ale", "=", "model_ale", ".", "ale_graph", "\n", "\n", "", "full_graph", "=", "FullGraph", "(", "feature_extractor", ",", "model_ale", ",", "all_vectors", ")", ".", "cuda", "(", ")", "\n", "full_graph", ".", "eval", "(", ")", "\n", "optimizer", "=", "optim", ".", "SGD", "(", "full_graph", ".", "parameters", "(", ")", ",", "lr", "=", "0.01", ",", "momentum", "=", "0.5", ")", "\n", "\n", "if", "params", "[", "\"dataset\"", "]", "==", "\"CUB\"", ":", "\n", "        ", "no_classes", "=", "200", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"AWA2\"", ":", "\n", "        ", "no_classes", "=", "50", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"SUN\"", ":", "\n", "        ", "no_classes", "=", "717", "\n", "\n", "", "classifier", "=", "PyTorchClassifier", "(", "model", "=", "full_graph", ",", "loss", "=", "criterion", ",", "\n", "optimizer", "=", "optimizer", ",", "input_shape", "=", "(", "1", ",", "150", ",", "150", ")", ",", "nb_classes", "=", "no_classes", ")", "\n", "batch_size", "=", "params", "[", "\"batch_size\"", "]", "\n", "\n", "preds_seen", "=", "[", "]", "\n", "labels_seen_", "=", "[", "]", "\n", "start", "=", "time", ".", "time", "(", ")", "\n", "\n", "for", "index", ",", "sample", "in", "enumerate", "(", "dataloader_seen", ")", ":", "\n", "        ", "img", "=", "sample", "[", "0", "]", ".", "numpy", "(", ")", "\n", "label", "=", "sample", "[", "1", "]", ".", "numpy", "(", ")", "\n", "\n", "predictions", "=", "classifier", ".", "predict", "(", "img", ",", "batch_size", "=", "batch_size", ")", "\n", "preds_seen", ".", "extend", "(", "np", ".", "argmax", "(", "predictions", ",", "axis", "=", "1", ")", ")", "\n", "labels_seen_", ".", "extend", "(", "label", ")", "\n", "\n", "if", "index", "%", "1000", "==", "0", ":", "\n", "            ", "print", "(", "index", ",", "len", "(", "dataloader_seen", ")", ")", "\n", "\n", "", "", "labels_seen_", "=", "np", ".", "array", "(", "labels_seen_", ")", "\n", "uniq_labels_seen", "=", "np", ".", "unique", "(", "labels_seen_", ")", "\n", "\n", "labels_unseen_", "=", "[", "]", "\n", "preds_unseen", "=", "[", "]", "\n", "preds_seen", "=", "np", ".", "array", "(", "preds_seen", ")", "\n", "\n", "for", "index", ",", "sample", "in", "enumerate", "(", "dataloader_unseen", ")", ":", "\n", "        ", "img", "=", "sample", "[", "0", "]", ".", "numpy", "(", ")", "\n", "label", "=", "sample", "[", "1", "]", ".", "numpy", "(", ")", "\n", "\n", "predictions", "=", "classifier", ".", "predict", "(", "img", ",", "batch_size", "=", "batch_size", ")", "\n", "preds_unseen", ".", "extend", "(", "np", ".", "argmax", "(", "predictions", ",", "axis", "=", "1", ")", ")", "\n", "labels_unseen_", ".", "extend", "(", "label", ")", "\n", "\n", "if", "index", "%", "1000", "==", "0", ":", "\n", "            ", "print", "(", "index", ",", "len", "(", "dataloader_unseen", ")", ")", "\n", "\n", "", "", "end", "=", "time", ".", "time", "(", ")", "\n", "\n", "labels_unseen_", "=", "np", ".", "array", "(", "labels_unseen_", ")", "\n", "uniq_labels_unseen", "=", "np", ".", "unique", "(", "labels_unseen_", ")", "\n", "\n", "combined_labels", "=", "np", ".", "concatenate", "(", "(", "labels_seen_", ",", "labels_unseen_", ")", ")", "\n", "preds_unseen", "=", "np", ".", "array", "(", "preds_unseen", ")", "\n", "combined_preds", "=", "np", ".", "concatenate", "(", "(", "preds_seen", ",", "preds_unseen", ")", ")", "\n", "harmonic_score_gzsl", "(", "combined_preds", ",", "combined_labels", ",", "uniq_labels_seen", ",", "uniq_labels_unseen", ")", "\n", "\n", "print", "(", "end", "-", "start", ",", "\"seconds passed for GZSL.\"", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.MotionImage.motion_blur": [[45, 47], ["wand.api.library.MagickMotionBlurImage"], "methods", ["None"], ["    ", "def", "motion_blur", "(", "self", ",", "radius", "=", "0.0", ",", "sigma", "=", "0.0", ",", "angle", "=", "0.0", ")", ":", "\n", "        ", "wandlibrary", ".", "MagickMotionBlurImage", "(", "self", ".", "wand", ",", "radius", ",", "sigma", ",", "angle", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.disk": [[23, 36], ["numpy.meshgrid", "numpy.array", "numpy.sum", "cv2.GaussianBlur", "numpy.arange", "numpy.arange"], "function", ["None"], ["def", "disk", "(", "radius", ",", "alias_blur", "=", "0.1", ",", "dtype", "=", "np", ".", "float32", ")", ":", "\n", "    ", "if", "radius", "<=", "8", ":", "\n", "        ", "L", "=", "np", ".", "arange", "(", "-", "8", ",", "8", "+", "1", ")", "\n", "ksize", "=", "(", "3", ",", "3", ")", "\n", "", "else", ":", "\n", "        ", "L", "=", "np", ".", "arange", "(", "-", "radius", ",", "radius", "+", "1", ")", "\n", "ksize", "=", "(", "5", ",", "5", ")", "\n", "", "X", ",", "Y", "=", "np", ".", "meshgrid", "(", "L", ",", "L", ")", "\n", "aliased_disk", "=", "np", ".", "array", "(", "(", "X", "**", "2", "+", "Y", "**", "2", ")", "<=", "radius", "**", "2", ",", "dtype", "=", "dtype", ")", "\n", "aliased_disk", "/=", "np", ".", "sum", "(", "aliased_disk", ")", "\n", "\n", "# supersample disk to antialias", "\n", "return", "cv2", ".", "GaussianBlur", "(", "aliased_disk", ",", "ksize", "=", "ksize", ",", "sigmaX", "=", "alias_blur", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.plasma_fractal": [[49, 96], ["numpy.empty", "np.empty.min", "numpy.roll", "generate_corruption.plasma_fractal.wibbledmean"], "function", ["None"], ["", "", "def", "plasma_fractal", "(", "mapsize", "=", "256", ",", "wibbledecay", "=", "3", ")", ":", "\n", "    ", "\"\"\"\n    Generate a heightmap using diamond-square algorithm.\n    Return square 2d array, side length 'mapsize', of floats in range 0-255.\n    'mapsize' must be a power of two.\n    \"\"\"", "\n", "assert", "(", "mapsize", "&", "(", "mapsize", "-", "1", ")", "==", "0", ")", "\n", "maparray", "=", "np", ".", "empty", "(", "(", "mapsize", ",", "mapsize", ")", ",", "dtype", "=", "np", ".", "float_", ")", "\n", "maparray", "[", "0", ",", "0", "]", "=", "0", "\n", "stepsize", "=", "mapsize", "\n", "wibble", "=", "100", "\n", "\n", "def", "wibbledmean", "(", "array", ")", ":", "\n", "        ", "return", "array", "/", "4", "+", "wibble", "*", "np", ".", "random", ".", "uniform", "(", "-", "wibble", ",", "wibble", ",", "array", ".", "shape", ")", "\n", "\n", "", "def", "fillsquares", "(", ")", ":", "\n", "        ", "\"\"\"For each square of points stepsize apart,\n           calculate middle value as mean of points + wibble\"\"\"", "\n", "cornerref", "=", "maparray", "[", "0", ":", "mapsize", ":", "stepsize", ",", "0", ":", "mapsize", ":", "stepsize", "]", "\n", "squareaccum", "=", "cornerref", "+", "np", ".", "roll", "(", "cornerref", ",", "shift", "=", "-", "1", ",", "axis", "=", "0", ")", "\n", "squareaccum", "+=", "np", ".", "roll", "(", "squareaccum", ",", "shift", "=", "-", "1", ",", "axis", "=", "1", ")", "\n", "maparray", "[", "stepsize", "//", "2", ":", "mapsize", ":", "stepsize", ",", "\n", "stepsize", "//", "2", ":", "mapsize", ":", "stepsize", "]", "=", "wibbledmean", "(", "squareaccum", ")", "\n", "\n", "", "def", "filldiamonds", "(", ")", ":", "\n", "        ", "\"\"\"For each diamond of points stepsize apart,\n           calculate middle value as mean of points + wibble\"\"\"", "\n", "mapsize", "=", "maparray", ".", "shape", "[", "0", "]", "\n", "drgrid", "=", "maparray", "[", "stepsize", "//", "2", ":", "mapsize", ":", "stepsize", ",", "stepsize", "//", "2", ":", "mapsize", ":", "stepsize", "]", "\n", "ulgrid", "=", "maparray", "[", "0", ":", "mapsize", ":", "stepsize", ",", "0", ":", "mapsize", ":", "stepsize", "]", "\n", "ldrsum", "=", "drgrid", "+", "np", ".", "roll", "(", "drgrid", ",", "1", ",", "axis", "=", "0", ")", "\n", "lulsum", "=", "ulgrid", "+", "np", ".", "roll", "(", "ulgrid", ",", "-", "1", ",", "axis", "=", "1", ")", "\n", "ltsum", "=", "ldrsum", "+", "lulsum", "\n", "maparray", "[", "0", ":", "mapsize", ":", "stepsize", ",", "stepsize", "//", "2", ":", "mapsize", ":", "stepsize", "]", "=", "wibbledmean", "(", "ltsum", ")", "\n", "tdrsum", "=", "drgrid", "+", "np", ".", "roll", "(", "drgrid", ",", "1", ",", "axis", "=", "1", ")", "\n", "tulsum", "=", "ulgrid", "+", "np", ".", "roll", "(", "ulgrid", ",", "-", "1", ",", "axis", "=", "0", ")", "\n", "ttsum", "=", "tdrsum", "+", "tulsum", "\n", "maparray", "[", "stepsize", "//", "2", ":", "mapsize", ":", "stepsize", ",", "0", ":", "mapsize", ":", "stepsize", "]", "=", "wibbledmean", "(", "ttsum", ")", "\n", "\n", "", "while", "stepsize", ">=", "2", ":", "\n", "        ", "fillsquares", "(", ")", "\n", "filldiamonds", "(", ")", "\n", "stepsize", "//=", "2", "\n", "wibble", "/=", "wibbledecay", "\n", "\n", "", "maparray", "-=", "maparray", ".", "min", "(", ")", "\n", "return", "maparray", "/", "maparray", ".", "max", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.clipped_zoom": [[97, 109], ["int", "int", "scipy.ndimage.zoom", "numpy.ceil", "numpy.ceil"], "function", ["None"], ["", "def", "clipped_zoom", "(", "img", ",", "zoom_factor", ")", ":", "\n", "    ", "h", "=", "img", ".", "shape", "[", "0", "]", "\n", "w", "=", "img", ".", "shape", "[", "1", "]", "\n", "ch", "=", "int", "(", "np", ".", "ceil", "(", "h", "/", "zoom_factor", ")", ")", "\n", "cw", "=", "int", "(", "np", ".", "ceil", "(", "w", "/", "zoom_factor", ")", ")", "\n", "\n", "top", "=", "(", "h", "-", "ch", ")", "//", "2", "\n", "img_zoomed", "=", "scizoom", "(", "img", "[", "top", ":", "top", "+", "ch", ",", "top", ":", "top", "+", "cw", "]", ",", "(", "zoom_factor", ",", "zoom_factor", ",", "1", ")", ",", "order", "=", "1", ")", "\n", "trim_top", "=", "(", "img_zoomed", ".", "shape", "[", "0", "]", "-", "h", ")", "//", "2", "\n", "trim_top_w", "=", "(", "img", ".", "shape", "[", "1", "]", "-", "w", ")", "//", "2", "\n", "\n", "return", "img_zoomed", "[", "trim_top", ":", "trim_top", "+", "h", ",", "trim_top_w", ":", "trim_top_w", "+", "w", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.gaussian_noise": [[110, 115], ["numpy.array", "numpy.clip", "numpy.random.normal"], "function", ["None"], ["", "def", "gaussian_noise", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", ".08", ",", ".12", ",", "0.18", ",", "0.26", ",", "0.38", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "return", "np", ".", "clip", "(", "x", "+", "np", ".", "random", ".", "normal", "(", "size", "=", "x", ".", "shape", ",", "scale", "=", "c", ")", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.shot_noise": [[116, 121], ["numpy.array", "numpy.clip", "numpy.random.poisson"], "function", ["None"], ["", "def", "shot_noise", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "60", ",", "25", ",", "12", ",", "5", ",", "3", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "return", "np", ".", "clip", "(", "np", ".", "random", ".", "poisson", "(", "x", "*", "c", ")", "/", "c", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.impulse_noise": [[122, 127], ["skimage.util.random_noise", "numpy.clip", "numpy.array"], "function", ["None"], ["", "def", "impulse_noise", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", ".03", ",", ".06", ",", ".09", ",", "0.17", ",", "0.27", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "sk", ".", "util", ".", "random_noise", "(", "np", ".", "array", "(", "x", ")", "/", "255.", ",", "mode", "=", "'s&p'", ",", "amount", "=", "c", ",", "seed", "=", "123", ")", "\n", "return", "np", ".", "clip", "(", "x", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.speckle_noise": [[128, 133], ["numpy.array", "numpy.clip", "numpy.random.normal"], "function", ["None"], ["", "def", "speckle_noise", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", ".15", ",", ".2", ",", "0.35", ",", "0.45", ",", "0.6", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "return", "np", ".", "clip", "(", "x", "+", "x", "*", "np", ".", "random", ".", "normal", "(", "size", "=", "x", ".", "shape", ",", "scale", "=", "c", ")", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.gaussian_blur": [[134, 139], ["skimage.filters.gaussian", "numpy.clip", "numpy.array"], "function", ["None"], ["", "def", "gaussian_blur", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "1", ",", "2", ",", "3", ",", "4", ",", "6", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "gaussian", "(", "np", ".", "array", "(", "x", ")", "/", "255.", ",", "sigma", "=", "c", ",", "multichannel", "=", "True", ")", "\n", "return", "np", ".", "clip", "(", "x", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.glass_blur": [[140, 155], ["numpy.uint8", "range", "range", "numpy.clip", "skimage.filters.gaussian", "range", "skimage.filters.gaussian", "numpy.random.randint", "numpy.array"], "function", ["None"], ["", "def", "glass_blur", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "0.7", ",", "1", ",", "2", ")", ",", "(", "0.9", ",", "2", ",", "1", ")", ",", "(", "1", ",", "2", ",", "3", ")", ",", "(", "1.1", ",", "3", ",", "2", ")", ",", "(", "1.5", ",", "4", ",", "2", ")", "]", "[", "severity", "-", "1", "]", "\n", "\n", "orig_size", "=", "x", ".", "size", "\n", "x", "=", "np", ".", "uint8", "(", "gaussian", "(", "np", ".", "array", "(", "x", ")", "/", "255.", ",", "sigma", "=", "c", "[", "0", "]", ",", "multichannel", "=", "True", ")", "*", "255", ")", "\n", "\n", "for", "i", "in", "range", "(", "c", "[", "2", "]", ")", ":", "\n", "        ", "for", "h", "in", "range", "(", "orig_size", "[", "1", "]", "-", "c", "[", "1", "]", ",", "c", "[", "1", "]", ",", "-", "1", ")", ":", "\n", "            ", "for", "w", "in", "range", "(", "orig_size", "[", "0", "]", "-", "c", "[", "1", "]", ",", "c", "[", "1", "]", ",", "-", "1", ")", ":", "\n", "                ", "dx", ",", "dy", "=", "np", ".", "random", ".", "randint", "(", "-", "c", "[", "1", "]", ",", "c", "[", "1", "]", ",", "size", "=", "(", "2", ",", ")", ")", "\n", "h_prime", ",", "w_prime", "=", "h", "+", "dy", ",", "w", "+", "dx", "\n", "# swap", "\n", "x", "[", "h", ",", "w", "]", ",", "x", "[", "h_prime", ",", "w_prime", "]", "=", "x", "[", "h_prime", ",", "w_prime", "]", ",", "x", "[", "h", ",", "w", "]", "\n", "\n", "", "", "", "return", "np", ".", "clip", "(", "gaussian", "(", "x", "/", "255.", ",", "sigma", "=", "c", "[", "0", "]", ",", "multichannel", "=", "True", ")", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.defocus_blur": [[156, 168], ["generate_corruption.disk", "range", "numpy.array().transpose", "numpy.array", "np.array().transpose.append", "numpy.clip", "cv2.filter2D", "numpy.array"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.disk"], ["", "def", "defocus_blur", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "3", ",", "0.1", ")", ",", "(", "4", ",", "0.5", ")", ",", "(", "6", ",", "0.5", ")", ",", "(", "8", ",", "0.5", ")", ",", "(", "10", ",", "0.5", ")", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "kernel", "=", "disk", "(", "radius", "=", "c", "[", "0", "]", ",", "alias_blur", "=", "c", "[", "1", "]", ")", "\n", "\n", "channels", "=", "[", "]", "\n", "for", "d", "in", "range", "(", "3", ")", ":", "\n", "        ", "channels", ".", "append", "(", "cv2", ".", "filter2D", "(", "x", "[", ":", ",", ":", ",", "d", "]", ",", "-", "1", ",", "kernel", ")", ")", "\n", "", "channels", "=", "np", ".", "array", "(", "channels", ")", ".", "transpose", "(", "(", "1", ",", "2", ",", "0", ")", ")", "# 3x224x224 -> 224x224x3", "\n", "\n", "return", "np", ".", "clip", "(", "channels", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.motion_blur": [[169, 185], ["io.BytesIO", "cv2.imdecode.save", "generate_corruption.MotionImage", "cv2.imdecode.motion_blur", "cv2.imdecode", "numpy.fromstring", "len", "numpy.clip", "numpy.clip", "io.BytesIO.getvalue", "numpy.random.uniform", "cv2.imdecode.make_blob", "numpy.array().transpose", "numpy.array"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.motion_blur"], ["", "def", "motion_blur", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "10", ",", "3", ")", ",", "(", "15", ",", "5", ")", ",", "(", "15", ",", "8", ")", ",", "(", "15", ",", "12", ")", ",", "(", "20", ",", "15", ")", "]", "[", "severity", "-", "1", "]", "\n", "\n", "output", "=", "BytesIO", "(", ")", "\n", "x", ".", "save", "(", "output", ",", "format", "=", "'PNG'", ")", "\n", "x", "=", "MotionImage", "(", "blob", "=", "output", ".", "getvalue", "(", ")", ")", "\n", "\n", "x", ".", "motion_blur", "(", "radius", "=", "c", "[", "0", "]", ",", "sigma", "=", "c", "[", "1", "]", ",", "angle", "=", "np", ".", "random", ".", "uniform", "(", "-", "45", ",", "45", ")", ")", "\n", "\n", "x", "=", "cv2", ".", "imdecode", "(", "np", ".", "fromstring", "(", "x", ".", "make_blob", "(", ")", ",", "np", ".", "uint8", ")", ",", "\n", "cv2", ".", "IMREAD_UNCHANGED", ")", "\n", "\n", "if", "len", "(", "x", ".", "shape", ")", "==", "3", ":", "\n", "        ", "return", "np", ".", "clip", "(", "x", "[", "...", ",", "[", "2", ",", "1", ",", "0", "]", "]", ",", "0", ",", "255", ")", "# BGR to RGB", "\n", "", "else", ":", "\n", "        ", "return", "np", ".", "clip", "(", "np", ".", "array", "(", "[", "x", ",", "x", ",", "x", "]", ")", ".", "transpose", "(", "(", "1", ",", "2", ",", "0", ")", ")", ",", "0", ",", "255", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.zoom_blur": [[186, 199], ["numpy.zeros_like", "generate_corruption.clipped_zoom", "numpy.clip", "numpy.arange", "numpy.arange", "numpy.arange", "numpy.arange", "numpy.arange", "len", "numpy.array"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.clipped_zoom"], ["", "", "def", "zoom_blur", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "np", ".", "arange", "(", "1", ",", "1.11", ",", "0.01", ")", ",", "\n", "np", ".", "arange", "(", "1", ",", "1.16", ",", "0.01", ")", ",", "\n", "np", ".", "arange", "(", "1", ",", "1.21", ",", "0.02", ")", ",", "\n", "np", ".", "arange", "(", "1", ",", "1.26", ",", "0.02", ")", ",", "\n", "np", ".", "arange", "(", "1", ",", "1.31", ",", "0.03", ")", "]", "[", "severity", "-", "1", "]", "\n", "x", "=", "(", "np", ".", "array", "(", "x", ")", "/", "255.", ")", ".", "astype", "(", "np", ".", "float32", ")", "\n", "out", "=", "np", ".", "zeros_like", "(", "x", ")", "\n", "for", "zoom_factor", "in", "c", ":", "\n", "            ", "out", "+=", "clipped_zoom", "(", "x", ",", "zoom_factor", ")", "\n", "\n", "", "x", "=", "(", "x", "+", "out", ")", "/", "(", "len", "(", "c", ")", "+", "1", ")", "\n", "return", "np", ".", "clip", "(", "x", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.fractal_map_size_mapper": [[200, 211], ["None"], "function", ["None"], ["", "def", "fractal_map_size_mapper", "(", "largest_dim", ")", ":", "\n", "    ", "map_size", "=", "0.", "\n", "#For AWA2, largest dim after resizing is 913 and smallest dim  is 256. Therefore, pick 256,512 or 1024.", "\n", "if", "largest_dim", "==", "256", ":", "\n", "        ", "map_size", "=", "256", "\n", "", "elif", "largest_dim", ">", "256", "and", "largest_dim", "<=", "512", ":", "\n", "        ", "map_size", "=", "512", "\n", "", "else", ":", "\n", "        ", "map_size", "=", "1024", "\n", "\n", "", "return", "map_size", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.fog": [[212, 230], ["generate_corruption.fractal_map_size_mapper", "x.max", "numpy.array", "numpy.clip", "generate_corruption.plasma_fractal"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.fractal_map_size_mapper", "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.plasma_fractal"], ["", "def", "fog", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "cx", "=", "[", "(", "1.5", ",", "2", ")", ",", "(", "2", ",", "2", ")", ",", "(", "2.5", ",", "1.7", ")", ",", "(", "2.5", ",", "1.5", ")", ",", "(", "3", ",", "1.4", ")", "]", "[", "severity", "-", "1", "]", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "\n", "#Get largest dimension, get a map of size equal to nearest power of two, crop to image size for processing", "\n", "h", "=", "x", ".", "shape", "[", "0", "]", "\n", "w", "=", "x", ".", "shape", "[", "1", "]", "\n", "if", "h", ">=", "w", ":", "\n", "        ", "largest_dim", "=", "h", "\n", "", "else", ":", "\n", "        ", "largest_dim", "=", "w", "\n", "\n", "", "map_size", "=", "fractal_map_size_mapper", "(", "largest_dim", ")", "\n", "max_val", "=", "x", ".", "max", "(", ")", "\n", "\n", "x", "+=", "cx", "[", "0", "]", "*", "plasma_fractal", "(", "mapsize", "=", "map_size", ",", "wibbledecay", "=", "cx", "[", "1", "]", ")", "[", ":", "h", ",", ":", "w", "]", "[", "...", ",", "np", ".", "newaxis", "]", "\n", "\n", "return", "np", ".", "clip", "(", "x", "*", "max_val", "/", "(", "max_val", "+", "cx", "[", "0", "]", ")", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.round_up": [[231, 234], ["math.ceil"], "function", ["None"], ["", "def", "round_up", "(", "n", ",", "decimals", "=", "0", ")", ":", "\n", "    ", "multiplier", "=", "10", "**", "decimals", "\n", "return", "math", ".", "ceil", "(", "n", "*", "multiplier", ")", "/", "multiplier", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.frost": [[235, 266], ["numpy.random.randint", "cv2.imread", "numpy.array", "generate_corruption.round_up", "cv2.resize", "numpy.clip", "numpy.random.randint", "numpy.random.randint"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.round_up"], ["", "def", "frost", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "1", ",", "0.4", ")", ",", "\n", "(", "0.8", ",", "0.6", ")", ",", "\n", "(", "0.7", ",", "0.7", ")", ",", "\n", "(", "0.65", ",", "0.7", ")", ",", "\n", "(", "0.6", ",", "0.75", ")", "]", "[", "severity", "-", "1", "]", "\n", "idx", "=", "np", ".", "random", ".", "randint", "(", "5", ")", "\n", "filename", "=", "[", "'frost_images/frost1.png'", ",", "'frost_images/frost2.png'", ",", "'frost_images/frost3.png'", ",", "'frost_images/frost4.jpg'", ",", "\n", "'frost_images/frost5.jpg'", ",", "'frost_images/frost6.jpg'", "]", "[", "idx", "]", "\n", "frost", "=", "cv2", ".", "imread", "(", "filename", ")", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "\n", "\n", "frost_im_size", "=", "frost", ".", "shape", "[", "0", ":", "2", "]", "\n", "orig_im_size", "=", "x", ".", "shape", "[", "0", ":", "2", "]", "\n", "\n", "# IF our image is, in any dimension than, larger the frost image, upscale the frost image.", "\n", "scale_ratio", "=", "1.0", "\n", "\n", "if", "orig_im_size", "[", "0", "]", ">", "frost_im_size", "[", "0", "]", "or", "orig_im_size", "[", "1", "]", ">", "frost_im_size", "[", "1", "]", ":", "\n", "        ", "if", "orig_im_size", "[", "0", "]", ">", "frost_im_size", "[", "0", "]", "and", "orig_im_size", "[", "1", "]", "<=", "frost_im_size", "[", "1", "]", ":", "\n", "            ", "scale_ratio", "=", "orig_im_size", "[", "0", "]", "/", "frost_im_size", "[", "0", "]", "\n", "\n", "", "if", "orig_im_size", "[", "1", "]", ">", "frost_im_size", "[", "1", "]", "and", "orig_im_size", "[", "0", "]", "<=", "frost_im_size", "[", "0", "]", ":", "\n", "            ", "scale_ratio", "=", "orig_im_size", "[", "1", "]", "/", "frost_im_size", "[", "1", "]", "\n", "\n", "", "", "scale_ratio", "=", "round_up", "(", "scale_ratio", ",", "1", ")", "\n", "frost", "=", "cv2", ".", "resize", "(", "frost", ",", "None", ",", "fx", "=", "scale_ratio", ",", "fy", "=", "scale_ratio", ")", "\n", "x_start", ",", "y_start", "=", "np", ".", "random", ".", "randint", "(", "0", ",", "frost", ".", "shape", "[", "0", "]", "+", "1", "-", "orig_im_size", "[", "0", "]", ")", ",", "np", ".", "random", ".", "randint", "(", "0", ",", "frost", ".", "shape", "[", "1", "]", "+", "1", "-", "orig_im_size", "[", "1", "]", ")", "\n", "frost", "=", "frost", "[", "x_start", ":", "x_start", "+", "orig_im_size", "[", "0", "]", ",", "y_start", ":", "y_start", "+", "orig_im_size", "[", "1", "]", "]", "[", "...", ",", "[", "2", ",", "1", ",", "0", "]", "]", "\n", "\n", "return", "np", ".", "clip", "(", "c", "[", "0", "]", "*", "x", "+", "c", "[", "1", "]", "*", "frost", ",", "0", ",", "255", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.snow": [[267, 296], ["numpy.random.normal", "generate_corruption.clipped_zoom", "PIL.Image.fromarray", "io.BytesIO", "MotionImage.save", "generate_corruption.MotionImage", "generate_corruption.MotionImage.motion_blur", "numpy.array", "cv2.imdecode", "numpy.clip", "io.BytesIO.getvalue", "numpy.random.uniform", "numpy.fromstring", "numpy.maximum", "MotionImage.make_blob", "numpy.rot90", "numpy.clip", "MotionImage.squeeze", "cv2.cvtColor().reshape", "cv2.cvtColor"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.clipped_zoom", "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.motion_blur"], ["", "def", "snow", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "0.1", ",", "0.3", ",", "3", ",", "0.5", ",", "10", ",", "4", ",", "0.8", ")", ",", "\n", "(", "0.2", ",", "0.3", ",", "2", ",", "0.5", ",", "12", ",", "4", ",", "0.7", ")", ",", "\n", "(", "0.55", ",", "0.3", ",", "4", ",", "0.9", ",", "12", ",", "8", ",", "0.7", ")", ",", "\n", "(", "0.55", ",", "0.3", ",", "4.5", ",", "0.85", ",", "12", ",", "8", ",", "0.65", ")", ",", "\n", "(", "0.55", ",", "0.3", ",", "2.5", ",", "0.85", ",", "12", ",", "12", ",", "0.55", ")", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ",", "dtype", "=", "np", ".", "float32", ")", "/", "255.", "\n", "h", "=", "x", ".", "shape", "[", "0", "]", "\n", "w", "=", "x", ".", "shape", "[", "1", "]", "\n", "snow_layer", "=", "np", ".", "random", ".", "normal", "(", "size", "=", "x", ".", "shape", "[", ":", "2", "]", ",", "loc", "=", "c", "[", "0", "]", ",", "scale", "=", "c", "[", "1", "]", ")", "# [:2] for monochrome", "\n", "\n", "snow_layer", "=", "clipped_zoom", "(", "snow_layer", "[", "...", ",", "np", ".", "newaxis", "]", ",", "c", "[", "2", "]", ")", "\n", "snow_layer", "[", "snow_layer", "<", "c", "[", "3", "]", "]", "=", "0", "\n", "\n", "snow_layer", "=", "PILImage", ".", "fromarray", "(", "(", "np", ".", "clip", "(", "snow_layer", ".", "squeeze", "(", ")", ",", "0", ",", "1", ")", "*", "255", ")", ".", "astype", "(", "np", ".", "uint8", ")", ",", "mode", "=", "'L'", ")", "\n", "output", "=", "BytesIO", "(", ")", "\n", "snow_layer", ".", "save", "(", "output", ",", "format", "=", "'PNG'", ")", "\n", "snow_layer", "=", "MotionImage", "(", "blob", "=", "output", ".", "getvalue", "(", ")", ")", "\n", "\n", "snow_layer", ".", "motion_blur", "(", "radius", "=", "c", "[", "4", "]", ",", "sigma", "=", "c", "[", "5", "]", ",", "angle", "=", "np", ".", "random", ".", "uniform", "(", "-", "135", ",", "-", "45", ")", ")", "\n", "\n", "snow_layer", "=", "cv2", ".", "imdecode", "(", "np", ".", "fromstring", "(", "snow_layer", ".", "make_blob", "(", ")", ",", "np", ".", "uint8", ")", ",", "\n", "cv2", ".", "IMREAD_UNCHANGED", ")", "/", "255.", "\n", "snow_layer", "=", "snow_layer", "[", "...", ",", "np", ".", "newaxis", "]", "\n", "\n", "x", "=", "c", "[", "6", "]", "*", "x", "+", "(", "1", "-", "c", "[", "6", "]", ")", "*", "np", ".", "maximum", "(", "x", ",", "cv2", ".", "cvtColor", "(", "x", ",", "cv2", ".", "COLOR_RGB2GRAY", ")", ".", "reshape", "(", "h", ",", "w", ",", "1", ")", "*", "1.5", "+", "0.5", ")", "\n", "\n", "return", "np", ".", "clip", "(", "x", "[", "0", ":", "snow_layer", ".", "shape", "[", "0", "]", ",", "0", ":", "snow_layer", ".", "shape", "[", "1", "]", "]", "+", "snow_layer", "+", "np", ".", "rot90", "(", "snow_layer", ",", "k", "=", "2", ")", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.spatter": [[297, 347], ["numpy.random.normal", "skimage.filters.gaussian", "numpy.array", "cv2.distanceTransform", "cv2.threshold", "cv2.blur().astype", "cv2.equalizeHist", "numpy.array", "cv2.filter2D", "cv2.blur().astype", "cv2.cvtColor", "numpy.max", "numpy.concatenate", "cv2.cvtColor", "cv2.cvtColor", "numpy.where", "skimage.filters.gaussian", "numpy.concatenate", "cv2.Canny", "cv2.cvtColor", "skimage.filters.gaussian.astype", "numpy.clip", "cv2.blur", "cv2.blur", "numpy.clip", "numpy.ones_like", "numpy.ones_like", "numpy.ones_like", "numpy.ones_like", "numpy.ones_like", "numpy.ones_like"], "function", ["None"], ["", "def", "spatter", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "0.65", ",", "0.3", ",", "4", ",", "0.69", ",", "0.6", ",", "0", ")", ",", "\n", "(", "0.65", ",", "0.3", ",", "3", ",", "0.68", ",", "0.6", ",", "0", ")", ",", "\n", "(", "0.65", ",", "0.3", ",", "2", ",", "0.68", ",", "0.5", ",", "0", ")", ",", "\n", "(", "0.65", ",", "0.3", ",", "1", ",", "0.65", ",", "1.5", ",", "1", ")", ",", "\n", "(", "0.67", ",", "0.4", ",", "1", ",", "0.65", ",", "1.5", ",", "1", ")", "]", "[", "severity", "-", "1", "]", "\n", "x", "=", "np", ".", "array", "(", "x", ",", "dtype", "=", "np", ".", "float32", ")", "/", "255.", "\n", "\n", "liquid_layer", "=", "np", ".", "random", ".", "normal", "(", "size", "=", "x", ".", "shape", "[", ":", "2", "]", ",", "loc", "=", "c", "[", "0", "]", ",", "scale", "=", "c", "[", "1", "]", ")", "\n", "\n", "liquid_layer", "=", "gaussian", "(", "liquid_layer", ",", "sigma", "=", "c", "[", "2", "]", ")", "\n", "liquid_layer", "[", "liquid_layer", "<", "c", "[", "3", "]", "]", "=", "0", "\n", "if", "c", "[", "5", "]", "==", "0", ":", "\n", "        ", "liquid_layer", "=", "(", "liquid_layer", "*", "255", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "dist", "=", "255", "-", "cv2", ".", "Canny", "(", "liquid_layer", ",", "50", ",", "150", ")", "\n", "dist", "=", "cv2", ".", "distanceTransform", "(", "dist", ",", "cv2", ".", "DIST_L2", ",", "5", ")", "\n", "_", ",", "dist", "=", "cv2", ".", "threshold", "(", "dist", ",", "20", ",", "20", ",", "cv2", ".", "THRESH_TRUNC", ")", "\n", "dist", "=", "cv2", ".", "blur", "(", "dist", ",", "(", "3", ",", "3", ")", ")", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "dist", "=", "cv2", ".", "equalizeHist", "(", "dist", ")", "\n", "ker", "=", "np", ".", "array", "(", "[", "[", "-", "2", ",", "-", "1", ",", "0", "]", ",", "[", "-", "1", ",", "1", ",", "1", "]", ",", "[", "0", ",", "1", ",", "2", "]", "]", ")", "\n", "dist", "=", "cv2", ".", "filter2D", "(", "dist", ",", "cv2", ".", "CV_8U", ",", "ker", ")", "\n", "dist", "=", "cv2", ".", "blur", "(", "dist", ",", "(", "3", ",", "3", ")", ")", ".", "astype", "(", "np", ".", "float32", ")", "\n", "\n", "m", "=", "cv2", ".", "cvtColor", "(", "liquid_layer", "*", "dist", ",", "cv2", ".", "COLOR_GRAY2BGRA", ")", "\n", "m", "/=", "np", ".", "max", "(", "m", ",", "axis", "=", "(", "0", ",", "1", ")", ")", "\n", "m", "*=", "c", "[", "4", "]", "\n", "\n", "color", "=", "np", ".", "concatenate", "(", "(", "175", "/", "255.", "*", "np", ".", "ones_like", "(", "m", "[", "...", ",", ":", "1", "]", ")", ",", "\n", "238", "/", "255.", "*", "np", ".", "ones_like", "(", "m", "[", "...", ",", ":", "1", "]", ")", ",", "\n", "238", "/", "255.", "*", "np", ".", "ones_like", "(", "m", "[", "...", ",", ":", "1", "]", ")", ")", ",", "axis", "=", "2", ")", "\n", "\n", "color", "=", "cv2", ".", "cvtColor", "(", "color", ",", "cv2", ".", "COLOR_BGR2BGRA", ")", "\n", "x", "=", "cv2", ".", "cvtColor", "(", "x", ",", "cv2", ".", "COLOR_BGR2BGRA", ")", "\n", "\n", "return", "cv2", ".", "cvtColor", "(", "np", ".", "clip", "(", "x", "+", "m", "*", "color", ",", "0", ",", "1", ")", ",", "cv2", ".", "COLOR_BGRA2BGR", ")", "*", "255", "\n", "", "else", ":", "\n", "        ", "m", "=", "np", ".", "where", "(", "liquid_layer", ">", "c", "[", "3", "]", ",", "1", ",", "0", ")", "\n", "m", "=", "gaussian", "(", "m", ".", "astype", "(", "np", ".", "float32", ")", ",", "sigma", "=", "c", "[", "4", "]", ")", "\n", "m", "[", "m", "<", "0.8", "]", "=", "0", "\n", "#         m = np.abs(m) ** (1/c[4])", "\n", "\n", "# mud brown", "\n", "color", "=", "np", ".", "concatenate", "(", "(", "63", "/", "255.", "*", "np", ".", "ones_like", "(", "x", "[", "...", ",", ":", "1", "]", ")", ",", "\n", "42", "/", "255.", "*", "np", ".", "ones_like", "(", "x", "[", "...", ",", ":", "1", "]", ")", ",", "\n", "20", "/", "255.", "*", "np", ".", "ones_like", "(", "x", "[", "...", ",", ":", "1", "]", ")", ")", ",", "axis", "=", "2", ")", "\n", "\n", "color", "*=", "m", "[", "...", ",", "np", ".", "newaxis", "]", "\n", "x", "*=", "(", "1", "-", "m", "[", "...", ",", "np", ".", "newaxis", "]", ")", "\n", "\n", "return", "np", ".", "clip", "(", "x", "+", "color", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.contrast": [[348, 354], ["numpy.mean", "numpy.array", "numpy.clip"], "function", ["None"], ["", "", "def", "contrast", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "0.4", ",", ".3", ",", ".2", ",", ".1", ",", ".05", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "means", "=", "np", ".", "mean", "(", "x", ",", "axis", "=", "(", "0", ",", "1", ")", ",", "keepdims", "=", "True", ")", "\n", "return", "np", ".", "clip", "(", "(", "x", "-", "means", ")", "*", "c", "+", "means", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.brightness": [[355, 364], ["skimage.color.rgb2hsv", "numpy.clip", "skimage.color.hsv2rgb", "numpy.array", "numpy.clip"], "function", ["None"], ["", "def", "brightness", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", ".1", ",", ".2", ",", ".3", ",", ".4", ",", ".5", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "x", "=", "sk", ".", "color", ".", "rgb2hsv", "(", "x", ")", "\n", "x", "[", ":", ",", ":", ",", "2", "]", "=", "np", ".", "clip", "(", "x", "[", ":", ",", ":", ",", "2", "]", "+", "c", ",", "0", ",", "1", ")", "\n", "x", "=", "sk", ".", "color", ".", "hsv2rgb", "(", "x", ")", "\n", "\n", "return", "np", ".", "clip", "(", "x", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.saturate": [[365, 374], ["skimage.color.rgb2hsv", "numpy.clip", "skimage.color.hsv2rgb", "numpy.array", "numpy.clip"], "function", ["None"], ["", "def", "saturate", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "0.3", ",", "0", ")", ",", "(", "0.1", ",", "0", ")", ",", "(", "2", ",", "0", ")", ",", "(", "5", ",", "0.1", ")", ",", "(", "20", ",", "0.2", ")", "]", "[", "severity", "-", "1", "]", "\n", "\n", "x", "=", "np", ".", "array", "(", "x", ")", "/", "255.", "\n", "x", "=", "sk", ".", "color", ".", "rgb2hsv", "(", "x", ")", "\n", "x", "[", ":", ",", ":", ",", "1", "]", "=", "np", ".", "clip", "(", "x", "[", ":", ",", ":", ",", "1", "]", "*", "c", "[", "0", "]", "+", "c", "[", "1", "]", ",", "0", ",", "1", ")", "\n", "x", "=", "sk", ".", "color", ".", "hsv2rgb", "(", "x", ")", "\n", "\n", "return", "np", ".", "clip", "(", "x", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.jpeg_compression": [[375, 383], ["io.BytesIO", "PILImage.open.save", "PIL.Image.open"], "function", ["None"], ["", "def", "jpeg_compression", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "25", ",", "18", ",", "15", ",", "10", ",", "7", "]", "[", "severity", "-", "1", "]", "\n", "\n", "output", "=", "BytesIO", "(", ")", "\n", "x", ".", "save", "(", "output", ",", "'JPEG'", ",", "quality", "=", "c", ")", "\n", "x", "=", "PILImage", ".", "open", "(", "output", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.pixelate": [[384, 393], ["x.resize.resize", "x.resize.resize", "int", "int"], "function", ["None"], ["", "def", "pixelate", "(", "x", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "0.6", ",", "0.5", ",", "0.4", ",", "0.3", ",", "0.25", "]", "[", "severity", "-", "1", "]", "\n", "\n", "orig_size", "=", "(", "x", ".", "size", "[", "0", "]", ",", "x", ".", "size", "[", "1", "]", ")", "\n", "\n", "x", "=", "x", ".", "resize", "(", "(", "int", "(", "orig_size", "[", "0", "]", "*", "c", ")", ",", "int", "(", "orig_size", "[", "1", "]", "*", "c", ")", ")", ",", "PILImage", ".", "BOX", ")", "\n", "x", "=", "x", ".", "resize", "(", "(", "orig_size", "[", "0", "]", ",", "orig_size", "[", "1", "]", ")", ",", "PILImage", ".", "BOX", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.elastic_transform": [[395, 425], ["numpy.float32", "cv2.getAffineTransform", "cv2.warpAffine", "numpy.meshgrid", "numpy.array", "numpy.float32", "min", "numpy.random.uniform().astype", "numpy.arange", "numpy.arange", "numpy.arange", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.clip", "scipy.ndimage.interpolation.map_coordinates().reshape", "numpy.random.uniform", "skimage.filters.gaussian", "skimage.filters.gaussian", "numpy.random.uniform", "numpy.random.uniform", "scipy.ndimage.interpolation.map_coordinates"], "function", ["None"], ["", "def", "elastic_transform", "(", "image", ",", "severity", "=", "1", ")", ":", "\n", "    ", "c", "=", "[", "(", "244", "*", "2", ",", "244", "*", "0.7", ",", "244", "*", "0.1", ")", ",", "\n", "(", "244", "*", "2", ",", "244", "*", "0.08", ",", "244", "*", "0.2", ")", ",", "\n", "(", "244", "*", "0.05", ",", "244", "*", "0.01", ",", "244", "*", "0.02", ")", ",", "\n", "(", "244", "*", "0.07", ",", "244", "*", "0.01", ",", "244", "*", "0.02", ")", ",", "\n", "(", "244", "*", "0.12", ",", "244", "*", "0.01", ",", "244", "*", "0.02", ")", "]", "[", "severity", "-", "1", "]", "\n", "\n", "image", "=", "np", ".", "array", "(", "image", ",", "dtype", "=", "np", ".", "float32", ")", "/", "255.", "\n", "shape", "=", "image", ".", "shape", "\n", "shape_size", "=", "shape", "[", ":", "2", "]", "\n", "\n", "# random affine", "\n", "center_square", "=", "np", ".", "float32", "(", "shape_size", ")", "//", "2", "\n", "square_size", "=", "min", "(", "shape_size", ")", "//", "3", "\n", "pts1", "=", "np", ".", "float32", "(", "[", "center_square", "+", "square_size", ",", "\n", "[", "center_square", "[", "0", "]", "+", "square_size", ",", "center_square", "[", "1", "]", "-", "square_size", "]", ",", "\n", "center_square", "-", "square_size", "]", ")", "\n", "pts2", "=", "pts1", "+", "np", ".", "random", ".", "uniform", "(", "-", "c", "[", "2", "]", ",", "c", "[", "2", "]", ",", "size", "=", "pts1", ".", "shape", ")", ".", "astype", "(", "np", ".", "float32", ")", "\n", "M", "=", "cv2", ".", "getAffineTransform", "(", "pts1", ",", "pts2", ")", "\n", "image", "=", "cv2", ".", "warpAffine", "(", "image", ",", "M", ",", "shape_size", "[", ":", ":", "-", "1", "]", ",", "borderMode", "=", "cv2", ".", "BORDER_REFLECT_101", ")", "\n", "\n", "dx", "=", "(", "gaussian", "(", "np", ".", "random", ".", "uniform", "(", "-", "1", ",", "1", ",", "size", "=", "shape", "[", ":", "2", "]", ")", ",", "\n", "c", "[", "1", "]", ",", "mode", "=", "'reflect'", ",", "truncate", "=", "3", ")", "*", "c", "[", "0", "]", ")", ".", "astype", "(", "np", ".", "float32", ")", "\n", "dy", "=", "(", "gaussian", "(", "np", ".", "random", ".", "uniform", "(", "-", "1", ",", "1", ",", "size", "=", "shape", "[", ":", "2", "]", ")", ",", "\n", "c", "[", "1", "]", ",", "mode", "=", "'reflect'", ",", "truncate", "=", "3", ")", "*", "c", "[", "0", "]", ")", ".", "astype", "(", "np", ".", "float32", ")", "\n", "dx", ",", "dy", "=", "dx", "[", "...", ",", "np", ".", "newaxis", "]", ",", "dy", "[", "...", ",", "np", ".", "newaxis", "]", "\n", "\n", "x", ",", "y", ",", "z", "=", "np", ".", "meshgrid", "(", "np", ".", "arange", "(", "shape", "[", "1", "]", ")", ",", "np", ".", "arange", "(", "shape", "[", "0", "]", ")", ",", "np", ".", "arange", "(", "shape", "[", "2", "]", ")", ")", "\n", "indices", "=", "np", ".", "reshape", "(", "y", "+", "dy", ",", "(", "-", "1", ",", "1", ")", ")", ",", "np", ".", "reshape", "(", "x", "+", "dx", ",", "(", "-", "1", ",", "1", ")", ")", ",", "np", ".", "reshape", "(", "z", ",", "(", "-", "1", ",", "1", ")", ")", "\n", "return", "np", ".", "clip", "(", "map_coordinates", "(", "image", ",", "indices", ",", "order", "=", "1", ",", "mode", "=", "'reflect'", ")", ".", "reshape", "(", "shape", ")", ",", "0", ",", "1", ")", "*", "255", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.get_corruptions": [[426, 462], ["collections.OrderedDict"], "function", ["None"], ["", "def", "get_corruptions", "(", ")", ":", "\n", "    ", "import", "collections", "\n", "d", "=", "collections", ".", "OrderedDict", "(", ")", "\n", "\n", "#Test corruptions", "\n", "\n", "#Noise category", "\n", "d", "[", "'gaussian_noise'", "]", "=", "gaussian_noise", "\n", "d", "[", "'shot_noise'", "]", "=", "shot_noise", "\n", "d", "[", "'impulse_noise'", "]", "=", "impulse_noise", "\n", "\n", "#Blur category", "\n", "d", "[", "'zoom_blur'", "]", "=", "zoom_blur", "\n", "d", "[", "'glass_blur'", "]", "=", "glass_blur", "\n", "d", "[", "'defocus_blur'", "]", "=", "defocus_blur", "\n", "d", "[", "'motion_blur'", "]", "=", "motion_blur", "\n", "\n", "#Weather category", "\n", "d", "[", "'brightness'", "]", "=", "brightness", "\n", "d", "[", "'snow'", "]", "=", "snow", "\n", "d", "[", "'fog'", "]", "=", "fog", "\n", "d", "[", "'frost'", "]", "=", "frost", "\n", "\n", "#Digital category", "\n", "d", "[", "'contrast'", "]", "=", "contrast", "\n", "d", "[", "'jpeg_compression'", "]", "=", "jpeg_compression", "\n", "d", "[", "'pixelate'", "]", "=", "pixelate", "\n", "d", "[", "'elastic_transform'", "]", "=", "elastic_transform", "\n", "\n", "# Validation corruptions, one for each category", "\n", "d", "[", "'speckle_noise'", "]", "=", "speckle_noise", "\n", "d", "[", "'gaussian_blur'", "]", "=", "gaussian_blur", "\n", "d", "[", "'spatter'", "]", "=", "spatter", "\n", "d", "[", "'saturate'", "]", "=", "saturate", "\n", "\n", "return", "d", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.load_json": [[9, 15], ["open", "json.load", "print", "json.dumps"], "function", ["None"], ["def", "load_json", "(", "file_path", ",", "verbose", "=", "False", ")", ":", "\n", "    ", "with", "open", "(", "file_path", ")", "as", "f", ":", "\n", "        ", "params", "=", "json", ".", "load", "(", "f", ")", "\n", "", "if", "verbose", ":", "\n", "        ", "print", "(", "json", ".", "dumps", "(", "params", ",", "indent", "=", "4", ")", ")", "\n", "", "return", "params", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.load_data": [[16, 22], ["scipy.loadmat"], "function", ["None"], ["", "def", "load_data", "(", "data", ",", "dataName", ")", ":", "\n", "    ", "\"\"\" Load data from .mat files \"\"\"", "\n", "dataContent", "=", "sio", ".", "loadmat", "(", "data", ")", "\n", "dataContent", "=", "dataContent", "[", "dataName", "]", "\n", "\n", "return", "dataContent", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.normalized_accuracy_zsl": [[23, 29], ["sklearn.metrics.confusion_matrix", "sklearn.metrics.confusion_matrix.astype", "numpy.sum", "float", "sklearn.metrics.confusion_matrix.sum", "cm_normalized.diagonal", "len", "cm_normalized.diagonal"], "function", ["None"], ["", "def", "normalized_accuracy_zsl", "(", "all_predictions", ",", "all_labels", ")", ":", "\n", "    ", "cm_gzsl", "=", "confusion_matrix", "(", "all_labels", ",", "all_predictions", ")", "\n", "cm_normalized", "=", "cm_gzsl", ".", "astype", "(", "'float'", ")", "/", "cm_gzsl", ".", "sum", "(", "axis", "=", "1", ")", "[", ":", ",", "np", ".", "newaxis", "]", "\n", "cm_overall_normalized_acc", "=", "np", ".", "sum", "(", "cm_normalized", ".", "diagonal", "(", ")", ")", "/", "float", "(", "len", "(", "cm_normalized", ".", "diagonal", "(", ")", ")", ")", "\n", "\n", "return", "cm_overall_normalized_acc", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.harmonic_score_gzsl": [[30, 45], ["sklearn.metrics.confusion_matrix", "cm_normalized[].diagonal", "unique_lab_seen.astype", "unique_lab_unseen.astype", "print", "sklearn.metrics.confusion_matrix.astype", "numpy.sum", "float", "numpy.sum", "float", "sklearn.metrics.confusion_matrix.sum", "len", "len"], "function", ["None"], ["", "def", "harmonic_score_gzsl", "(", "all_predictions", ",", "all_labels", ",", "unique_lab_seen", ",", "unique_lab_unseen", ")", ":", "\n", "    ", "cm_gzsl", "=", "confusion_matrix", "(", "all_labels", ",", "all_predictions", ")", "\n", "cm_normalized", "=", "cm_gzsl", ".", "astype", "(", "'float'", ")", "/", "cm_gzsl", ".", "sum", "(", "axis", "=", "1", ")", "[", ":", ",", "np", ".", "newaxis", "]", "\n", "\n", "diagonal_vals", "=", "cm_normalized", "[", ":", "]", ".", "diagonal", "(", ")", "\n", "known_class_range", "=", "unique_lab_seen", ".", "astype", "(", "int", ")", "\n", "unknown_class_range", "=", "unique_lab_unseen", ".", "astype", "(", "int", ")", "\n", "\n", "known_classes_avg_accuracy", "=", "np", ".", "sum", "(", "diagonal_vals", "[", "known_class_range", "]", ")", "/", "float", "(", "len", "(", "diagonal_vals", "[", "known_class_range", "]", ")", ")", "\n", "unknown_classes_avg_accuracy", "=", "np", ".", "sum", "(", "diagonal_vals", "[", "unknown_class_range", "]", ")", "/", "float", "(", "len", "(", "diagonal_vals", "[", "unknown_class_range", "]", ")", ")", "\n", "\n", "h_score", "=", "(", "known_classes_avg_accuracy", "*", "unknown_classes_avg_accuracy", "*", "2", ")", "/", "(", "known_classes_avg_accuracy", "+", "unknown_classes_avg_accuracy", ")", "\n", "print", "(", "\"Known/unknown/h_score\"", ",", "known_classes_avg_accuracy", ",", "unknown_classes_avg_accuracy", ",", "h_score", ")", "\n", "\n", "return", "known_classes_avg_accuracy", ",", "unknown_classes_avg_accuracy", ",", "h_score", "\n", "", ""]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.fullgraph.FullGraph.__init__": [[4, 9], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.__init__"], ["    ", "def", "__init__", "(", "self", ",", "resnet_graph", ",", "ale_graph", ",", "classVectors", ")", ":", "\n", "        ", "super", "(", "FullGraph", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "resnet_graph", "=", "resnet_graph", "\n", "self", ".", "ale_graph", "=", "ale_graph", "\n", "self", ".", "classVectors", "=", "classVectors", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.fullgraph.FullGraph.forward": [[10, 16], ["fullgraph.FullGraph.resnet_graph", "features.squeeze().squeeze.squeeze().squeeze.squeeze().squeeze", "fullgraph.FullGraph.ale_graph", "features.squeeze().squeeze.squeeze().squeeze.squeeze"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "image", ")", ":", "\n", "        ", "features", "=", "self", ".", "resnet_graph", "(", "image", ")", "\n", "features", "=", "features", ".", "squeeze", "(", "2", ")", ".", "squeeze", "(", "2", ")", "\n", "out", "=", "self", ".", "ale_graph", "(", "features", ",", "self", ".", "classVectors", ")", "\n", "\n", "return", "out", "", "", "", ""]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.model.Network.__init__": [[16, 19], ["super().__init__", "torch.nn.Linear"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.__init__"], ["def", "__init__", "(", "self", ",", "feature_dim", ",", "vector_dim", ")", ":", "\n", "        ", "super", "(", "Network", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "wHidden1", "=", "torch", ".", "nn", ".", "Linear", "(", "feature_dim", ",", "vector_dim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.model.Network.forward": [[20, 25], ["model.Network.wHidden1", "torch.matmul", "torch.t"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "imageFeatures", ",", "classVectors", ")", ":", "\n", "        ", "imageFeatures", "=", "self", ".", "wHidden1", "(", "imageFeatures", ")", "\n", "out", "=", "torch", ".", "matmul", "(", "imageFeatures", ",", "torch", ".", "t", "(", "classVectors", ")", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.run.main": [[14, 104], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args", "print", "tools.load_json", "tools.load_data", "tools.load_data", "numpy.unique", "torch.from_numpy().float().cuda", "torch.from_numpy().float().cuda", "generate_corruption.get_corruptions", "torch.nn.CrossEntropyLoss", "corruption_evaluator.zsl_launch", "corruption_evaluator.gzsl_launch", "torchvision.transforms.Compose", "scipy.loadmat", "scipy.loadmat", "print", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torchvision.transforms.Compose", "scipy.loadmat", "scipy.loadmat", "print", "torch.from_numpy().float", "torch.from_numpy().float", "dataloader_placeholder", "dataloader_placeholder", "dataloader_placeholder", "dataloader_placeholder", "dataloader_placeholder", "dataloader_placeholder", "torchvision.transforms.Resize", "torchvision.transforms.Compose", "scipy.loadmat", "scipy.loadmat", "print", "NotImplementedError", "torchvision.transforms.Resize", "torch.from_numpy", "torch.from_numpy", "torchvision.transforms.Resize"], "function", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.load_json", "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.load_data", "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.tools.load_data", "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.generate_corruption.get_corruptions", "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.corruption_evaluator.zsl_launch", "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.None.corruption_evaluator.gzsl_launch"], ["def", "main", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", "description", "=", "'JSON file'", ")", "\n", "parser", ".", "add_argument", "(", "\"--path\"", ",", "dest", "=", "\"json_path\"", ",", "type", "=", "str", ",", "help", "=", "'path to json file. defaults to params.json'", ",", "default", "=", "\"params.json\"", ")", "\n", "args", "=", "parser", ".", "parse_args", "(", ")", "\n", "print", "(", "\"JSON file:\"", ",", "args", ".", "json_path", ")", "\n", "params", "=", "load_json", "(", "args", ".", "json_path", ")", "\n", "\n", "if", "params", "[", "\"dataset\"", "]", "==", "\"CUB\"", ":", "\n", "        ", "preprocess", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "Resize", "(", "256", ")", ",", "\n", "]", ")", "\n", "\n", "from", "configs", ".", "config_CUB", "import", "MAIN_DATAPATH", ",", "TEST_DATAPATH", "\n", "att_split", "=", "sio", ".", "loadmat", "(", "params", "[", "\"CUB_paths\"", "]", "[", "\"att_split\"", "]", ")", "\n", "root", "=", "params", "[", "\"CUB_paths\"", "]", "[", "\"root\"", "]", "\n", "metaData", "=", "sio", ".", "loadmat", "(", "params", "[", "\"CUB_paths\"", "]", "[", "\"metaData\"", "]", ")", "\n", "print", "(", "\"CUB Dataset chosen.\"", ")", "\n", "dataloader_placeholder", "=", "CUBDataset", "\n", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"AWA2\"", ":", "\n", "        ", "preprocess", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "Resize", "(", "256", ")", "\n", "]", ")", "\n", "\n", "from", "configs", ".", "config_AWA2", "import", "MAIN_DATAPATH", ",", "TEST_DATAPATH", "\n", "att_split", "=", "sio", ".", "loadmat", "(", "params", "[", "\"AWA2_paths\"", "]", "[", "\"att_split\"", "]", ")", "\n", "root", "=", "params", "[", "\"AWA2_paths\"", "]", "[", "\"root\"", "]", "\n", "metaData", "=", "sio", ".", "loadmat", "(", "params", "[", "\"AWA2_paths\"", "]", "[", "\"metaData\"", "]", ")", "\n", "print", "(", "\"AWA2 Dataset chosen.\"", ")", "\n", "dataloader_placeholder", "=", "AWADataset", "\n", "\n", "", "elif", "params", "[", "\"dataset\"", "]", "==", "\"SUN\"", ":", "\n", "        ", "preprocess", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "Resize", "(", "256", ")", ",", "\n", "]", ")", "\n", "\n", "from", "configs", ".", "config_SUN", "import", "MAIN_DATAPATH", ",", "TEST_DATAPATH", "\n", "att_split", "=", "sio", ".", "loadmat", "(", "params", "[", "\"SUN_paths\"", "]", "[", "\"att_split\"", "]", ")", "\n", "root", "=", "params", "[", "\"SUN_paths\"", "]", "[", "\"root\"", "]", "\n", "metaData", "=", "sio", ".", "loadmat", "(", "params", "[", "\"SUN_paths\"", "]", "[", "\"metaData\"", "]", ")", "\n", "print", "(", "\"SUN Dataset chosen.\"", ")", "\n", "dataloader_placeholder", "=", "SunDataset", "\n", "\n", "", "else", ":", "\n", "        ", "raise", "NotImplementedError", "(", "\"Invalid dataset chosen. \"", ")", "\n", "\n", "", "all_class_vector", "=", "load_data", "(", "MAIN_DATAPATH", "+", "'all_class_vec.mat'", ",", "\"all_class_vec\"", ")", "\n", "unseen_labels", "=", "load_data", "(", "TEST_DATAPATH", "+", "'test_unseen_labels.mat'", ",", "'test_unseen_labels'", ")", "\n", "\n", "unseenClassIndices", "=", "np", ".", "unique", "(", "unseen_labels", ")", "\n", "unseenVectors", "=", "torch", ".", "from_numpy", "(", "all_class_vector", "[", "unseenClassIndices", ",", ":", "]", ")", ".", "float", "(", ")", ".", "cuda", "(", ")", "\n", "allVectors", "=", "torch", ".", "from_numpy", "(", "all_class_vector", ")", ".", "float", "(", ")", ".", "cuda", "(", ")", "\n", "\n", "test_unseen_indexes", "=", "att_split", "[", "\"test_unseen_loc\"", "]", "\n", "test_seen_indexes", "=", "att_split", "[", "\"test_seen_loc\"", "]", "\n", "\n", "files", "=", "metaData", "[", "\"image_files\"", "]", "\n", "labels", "=", "metaData", "[", "\"labels\"", "]", "\n", "\n", "clist", "=", "get_corruptions", "(", ")", "\n", "\n", "if", "params", "[", "\"is_corruption\"", "]", ":", "\n", "        ", "dataloader_zsl", "=", "DataLoader", "(", "dataloader_placeholder", "(", "test_unseen_indexes", ",", "files", ",", "labels", ",", "root", ",", "zsl", "=", "True", ",", "transform", "=", "preprocess", ",", "\n", "corruption_method", "=", "clist", "[", "params", "[", "\"corruption_method\"", "]", "]", ",", "corruption_severity", "=", "params", "[", "\"corruption_severity\"", "]", ")", ",", "batch_size", "=", "1", ",", "\n", "shuffle", "=", "params", "[", "\"shuffle_dataset\"", "]", ",", "num_workers", "=", "params", "[", "\"num_workers\"", "]", ",", "pin_memory", "=", "params", "[", "\"pin_memory\"", "]", ")", "\n", "\n", "\n", "dataloader_unseen", "=", "DataLoader", "(", "dataloader_placeholder", "(", "test_unseen_indexes", ",", "files", ",", "labels", ",", "root", ",", "transform", "=", "preprocess", ",", "\n", "corruption_method", "=", "clist", "[", "params", "[", "\"corruption_method\"", "]", "]", ",", "corruption_severity", "=", "params", "[", "\"corruption_severity\"", "]", ")", ",", "\n", "batch_size", "=", "1", ",", "shuffle", "=", "params", "[", "\"shuffle_dataset\"", "]", ",", "num_workers", "=", "params", "[", "\"num_workers\"", "]", ",", "\n", "pin_memory", "=", "params", "[", "\"pin_memory\"", "]", ")", "\n", "dataloader_seen", "=", "DataLoader", "(", "dataloader_placeholder", "(", "test_seen_indexes", ",", "files", ",", "labels", ",", "root", ",", "transform", "=", "preprocess", ",", "\n", "corruption_method", "=", "clist", "[", "params", "[", "\"corruption_method\"", "]", "]", ",", "corruption_severity", "=", "params", "[", "\"corruption_severity\"", "]", ")", ",", "\n", "batch_size", "=", "1", ",", "shuffle", "=", "params", "[", "\"shuffle_dataset\"", "]", ",", "num_workers", "=", "params", "[", "\"num_workers\"", "]", ",", "\n", "pin_memory", "=", "params", "[", "\"pin_memory\"", "]", ")", "\n", "\n", "", "else", ":", "\n", "        ", "dataloader_zsl", "=", "DataLoader", "(", "dataloader_placeholder", "(", "test_unseen_indexes", ",", "files", ",", "labels", ",", "root", ",", "zsl", "=", "True", ",", "transform", "=", "preprocess", ")", ",", "batch_size", "=", "1", ",", "\n", "shuffle", "=", "params", "[", "\"shuffle_dataset\"", "]", ",", "num_workers", "=", "params", "[", "\"num_workers\"", "]", ",", "pin_memory", "=", "params", "[", "\"pin_memory\"", "]", ")", "\n", "\n", "dataloader_unseen", "=", "DataLoader", "(", "dataloader_placeholder", "(", "test_unseen_indexes", ",", "files", ",", "labels", ",", "root", ",", "transform", "=", "preprocess", ")", ",", "batch_size", "=", "1", ",", "\n", "shuffle", "=", "params", "[", "\"shuffle_dataset\"", "]", ",", "num_workers", "=", "params", "[", "\"num_workers\"", "]", ",", "pin_memory", "=", "params", "[", "\"pin_memory\"", "]", ")", "\n", "dataloader_seen", "=", "DataLoader", "(", "dataloader_placeholder", "(", "test_seen_indexes", ",", "files", ",", "labels", ",", "root", ",", "transform", "=", "preprocess", ")", ",", "batch_size", "=", "1", ",", "\n", "shuffle", "=", "params", "[", "\"shuffle_dataset\"", "]", ",", "num_workers", "=", "params", "[", "\"num_workers\"", "]", ",", "pin_memory", "=", "params", "[", "\"pin_memory\"", "]", ")", "\n", "\n", "\n", "", "criterion", "=", "torch", ".", "nn", ".", "CrossEntropyLoss", "(", "reduction", "=", "'sum'", ")", "\n", "\n", "zsl_launch", "(", "dataloader_zsl", ",", "unseenVectors", ",", "criterion", ",", "params", ")", "\n", "gzsl_launch", "(", "dataloader_seen", ",", "dataloader_unseen", ",", "allVectors", ",", "criterion", ",", "params", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.awa_dataloader.AWADataset.__init__": [[9, 29], ["torchvision.transforms.Compose", "print", "awa_dataloader.AWADataset.map_labels_zsl", "torchvision.transforms.ToTensor"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.map_labels_zsl"], ["    ", "def", "__init__", "(", "self", ",", "indexes", ",", "files", ",", "labels", ",", "data_root", ",", "zsl", "=", "False", ",", "transform", "=", "None", ",", "corruption_method", "=", "None", ",", "corruption_severity", "=", "None", ")", ":", "\n", "\n", "        ", "self", ".", "index_instances", "=", "indexes", "\n", "self", ".", "data_root", "=", "data_root", "\n", "\n", "self", ".", "file_names", "=", "files", "[", "self", ".", "index_instances", "-", "1", "]", "\n", "self", ".", "labels", "=", "(", "labels", "[", "self", ".", "index_instances", "-", "1", "]", "-", "1", ")", "\n", "self", ".", "method", "=", "corruption_method", "\n", "self", ".", "severity", "=", "corruption_severity", "\n", "self", ".", "toTensor", "=", "transforms", ".", "Compose", "(", "[", "transforms", ".", "ToTensor", "(", ")", "]", ")", "\n", "\n", "if", "self", ".", "method", "is", "None", ":", "\n", "            ", "self", ".", "is_corruption", "=", "False", "\n", "", "else", ":", "\n", "            ", "self", ".", "is_corruption", "=", "True", "\n", "print", "(", "\"Dataloader:\"", ",", "self", ".", "method", ".", "__name__", ",", "\"_\"", ",", "self", ".", "severity", ")", "\n", "", "if", "zsl", ":", "\n", "            ", "self", ".", "map_labels_zsl", "(", ")", "\n", "\n", "", "self", ".", "transform", "=", "transform", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.awa_dataloader.AWADataset.__len__": [[30, 32], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "index_instances", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.awa_dataloader.AWADataset.map_labels_zsl": [[33, 57], ["enumerate", "print"], "methods", ["None"], ["", "def", "map_labels_zsl", "(", "self", ")", ":", "\n", "        ", "for", "index", ",", "i", "in", "enumerate", "(", "self", ".", "labels", ")", ":", "\n", "            ", "if", "i", "==", "6", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "0", "\n", "", "elif", "i", "==", "8", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "1", "\n", "", "elif", "i", "==", "22", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "2", "\n", "", "elif", "i", "==", "23", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "3", "\n", "", "elif", "i", "==", "29", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "4", "\n", "", "elif", "i", "==", "30", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "5", "\n", "", "elif", "i", "==", "33", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "6", "\n", "", "elif", "i", "==", "40", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "7", "\n", "", "elif", "i", "==", "46", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "8", "\n", "", "elif", "i", "==", "49", ":", "\n", "                ", "self", ".", "labels", "[", "index", "]", "=", "9", "\n", "", "else", ":", "\n", "                ", "print", "(", "\"Wrong label for zsl conversion!\"", ",", "i", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.awa_dataloader.AWADataset.fetch_batch": [[58, 81], ["os.path.join", "PIL.Image.open().convert", "awa_dataloader.AWADataset.transform", "awa_dataloader.AWADataset.toTensor", "torch.Tensor", "[].split", "PIL.Image.fromarray", "PIL.Image.open", "awa_dataloader.AWADataset.method", "numpy.uint8", "print", "numpy.asarray"], "methods", ["None"], ["", "", "", "def", "fetch_batch", "(", "self", ",", "idx", ")", ":", "\n", "        ", "im_name", "=", "self", ".", "file_names", "[", "idx", "]", "[", "0", "]", "[", "0", "]", "[", "0", "]", ".", "split", "(", "'JPEGImages/'", ")", "[", "1", "]", "\n", "\n", "image_file", "=", "os", ".", "path", ".", "join", "(", "self", ".", "data_root", ",", "im_name", ")", "\n", "\n", "img_pil", "=", "Image", ".", "open", "(", "image_file", ")", ".", "convert", "(", "\"RGB\"", ")", "\n", "img_pil", "=", "self", ".", "transform", "(", "img_pil", ")", "\n", "\n", "if", "self", ".", "is_corruption", ":", "\n", "            ", "try", ":", "\n", "                ", "img_pil", "=", "self", ".", "method", "(", "img_pil", ",", "self", ".", "severity", ")", "\n", "", "except", ":", "\n", "                ", "print", "(", "\"Failure:\"", ",", "self", ".", "method", ".", "__name__", ",", "self", ".", "severity", ",", "im_name", ")", "\n", "img_pil", "=", "np", ".", "asarray", "(", "img_pil", ")", "\n", "\n", "", "img_pil", "=", "Image", ".", "fromarray", "(", "np", ".", "uint8", "(", "img_pil", ")", ")", "\n", "\n", "", "img_tensor", "=", "self", ".", "toTensor", "(", "img_pil", ")", "\n", "label", "=", "self", ".", "labels", "[", "idx", "]", "\n", "label", "=", "label", "[", "0", "]", "\n", "label", "=", "torch", ".", "Tensor", "(", "label", ")", "\n", "\n", "return", "(", "img_tensor", ",", "label", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.awa_dataloader.AWADataset.__getitem__": [[82, 85], ["awa_dataloader.AWADataset.fetch_batch"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.fetch_batch"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "batch", "=", "self", ".", "fetch_batch", "(", "idx", ")", "\n", "return", "batch", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.cub_dataloader.CUBDataset.__init__": [[14, 40], ["torchvision.transforms.Normalize", "torchvision.transforms.Compose", "print", "cub_dataloader.CUBDataset.map_labels_zsl", "torchvision.transforms.ToTensor"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.map_labels_zsl"], ["    ", "def", "__init__", "(", "self", ",", "indexes", ",", "files", ",", "labels", ",", "data_root", ",", "zsl", "=", "False", ",", "transform", "=", "None", ",", "corruption_method", "=", "None", ",", "corruption_severity", "=", "None", ")", ":", "\n", "        ", "self", ".", "index_instances", "=", "indexes", "\n", "self", ".", "data_root", "=", "data_root", "\n", "\n", "self", ".", "normalize", "=", "transforms", ".", "Normalize", "(", "\n", "mean", "=", "[", "0.485", ",", "0.456", ",", "0.406", "]", ",", "\n", "std", "=", "[", "0.229", ",", "0.224", ",", "0.225", "]", "\n", ")", "\n", "\n", "self", ".", "file_names", "=", "files", "[", "self", ".", "index_instances", "-", "1", "]", "\n", "self", ".", "labels", "=", "(", "labels", "[", "self", ".", "index_instances", "-", "1", "]", "-", "1", ")", "\n", "\n", "self", ".", "method", "=", "corruption_method", "\n", "self", ".", "severity", "=", "corruption_severity", "\n", "self", ".", "toTensor", "=", "transforms", ".", "Compose", "(", "[", "transforms", ".", "ToTensor", "(", ")", "]", ")", "\n", "\n", "if", "self", ".", "method", "is", "None", ":", "\n", "            ", "self", ".", "is_corruption", "=", "False", "\n", "", "else", ":", "\n", "            ", "self", ".", "is_corruption", "=", "True", "\n", "print", "(", "\"Dataloader:\"", ",", "self", ".", "method", ".", "__name__", ",", "\"_\"", ",", "self", ".", "severity", ")", "\n", "\n", "", "if", "zsl", ":", "\n", "            ", "self", ".", "map_labels_zsl", "(", ")", "\n", "\n", "", "self", ".", "transform", "=", "transform", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.cub_dataloader.CUBDataset.__len__": [[41, 43], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "index_instances", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.cub_dataloader.CUBDataset.map_labels_zsl": [[44, 47], ["enumerate"], "methods", ["None"], ["", "def", "map_labels_zsl", "(", "self", ")", ":", "\n", "        ", "for", "index", ",", "label", "in", "enumerate", "(", "self", ".", "labels", ")", ":", "\n", "            ", "self", ".", "labels", "[", "index", "]", "=", "gzsl_to_zsl_label_indexes", "[", "label", "[", "0", "]", "[", "0", "]", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.cub_dataloader.CUBDataset.fetch_batch": [[48, 72], ["os.path.join", "PIL.Image.open().convert", "cub_dataloader.CUBDataset.transform", "cub_dataloader.CUBDataset.toTensor", "cub_dataloader.CUBDataset.normalize", "torch.Tensor", "[].split", "PIL.Image.fromarray", "PIL.Image.open", "cub_dataloader.CUBDataset.method", "numpy.uint8", "print", "numpy.asarray"], "methods", ["None"], ["", "", "def", "fetch_batch", "(", "self", ",", "idx", ")", ":", "\n", "        ", "im_name", "=", "self", ".", "file_names", "[", "idx", "]", "[", "0", "]", "[", "0", "]", "[", "0", "]", ".", "split", "(", "'images/'", ")", "[", "1", "]", "\n", "image_file", "=", "os", ".", "path", ".", "join", "(", "self", ".", "data_root", ",", "im_name", ")", "\n", "\n", "img_pil", "=", "Image", ".", "open", "(", "image_file", ")", ".", "convert", "(", "\"RGB\"", ")", "\n", "img_pil", "=", "self", ".", "transform", "(", "img_pil", ")", "\n", "\n", "if", "self", ".", "is_corruption", ":", "\n", "            ", "try", ":", "\n", "                ", "img_pil", "=", "self", ".", "method", "(", "img_pil", ",", "self", ".", "severity", ")", "\n", "", "except", ":", "\n", "                ", "print", "(", "\"Failure:\"", ",", "self", ".", "method", ".", "__name__", ",", "self", ".", "severity", ",", "im_name", ")", "\n", "img_pil", "=", "np", ".", "asarray", "(", "img_pil", ")", "\n", "\n", "", "img_pil", "=", "Image", ".", "fromarray", "(", "np", ".", "uint8", "(", "img_pil", ")", ")", "\n", "\n", "", "img_tensor", "=", "self", ".", "toTensor", "(", "img_pil", ")", "\n", "img_tensor", "=", "self", ".", "normalize", "(", "img_tensor", ")", "\n", "\n", "label", "=", "self", ".", "labels", "[", "idx", "]", "\n", "label", "=", "label", "[", "0", "]", "\n", "label", "=", "torch", ".", "Tensor", "(", "label", ")", "\n", "\n", "return", "(", "img_tensor", ",", "label", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.cub_dataloader.CUBDataset.__getitem__": [[73, 77], ["cub_dataloader.CUBDataset.fetch_batch"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.fetch_batch"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "batch", "=", "self", ".", "fetch_batch", "(", "idx", ")", "\n", "\n", "return", "batch", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.__init__": [[16, 42], ["torchvision.transforms.Normalize", "torchvision.transforms.Compose", "print", "sun_dataloader.SunDataset.map_labels_zsl", "torchvision.transforms.ToTensor"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.map_labels_zsl"], ["    ", "def", "__init__", "(", "self", ",", "indexes", ",", "files", ",", "labels", ",", "data_root", ",", "zsl", "=", "False", ",", "transform", "=", "None", ",", "corruption_method", "=", "None", ",", "corruption_severity", "=", "None", ")", ":", "\n", "        ", "self", ".", "index_instances", "=", "indexes", "\n", "self", ".", "data_root", "=", "data_root", "\n", "\n", "self", ".", "normalize", "=", "transforms", ".", "Normalize", "(", "\n", "mean", "=", "[", "0.485", ",", "0.456", ",", "0.406", "]", ",", "\n", "std", "=", "[", "0.229", ",", "0.224", ",", "0.225", "]", "\n", ")", "\n", "\n", "self", ".", "file_names", "=", "files", "[", "self", ".", "index_instances", "-", "1", "]", "\n", "self", ".", "labels", "=", "(", "labels", "[", "self", ".", "index_instances", "-", "1", "]", "-", "1", ")", "\n", "\n", "self", ".", "method", "=", "corruption_method", "\n", "self", ".", "severity", "=", "corruption_severity", "\n", "self", ".", "toTensor", "=", "transforms", ".", "Compose", "(", "[", "transforms", ".", "ToTensor", "(", ")", "]", ")", "\n", "\n", "if", "self", ".", "method", "is", "None", ":", "\n", "            ", "self", ".", "is_corruption", "=", "False", "\n", "", "else", ":", "\n", "            ", "self", ".", "is_corruption", "=", "True", "\n", "print", "(", "\"Dataloader:\"", ",", "self", ".", "method", ".", "__name__", ",", "\"_\"", ",", "self", ".", "severity", ")", "\n", "\n", "", "if", "zsl", ":", "\n", "            ", "self", ".", "map_labels_zsl", "(", ")", "\n", "\n", "", "self", ".", "transform", "=", "transform", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.__len__": [[43, 45], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "index_instances", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.map_labels_zsl": [[46, 49], ["enumerate"], "methods", ["None"], ["", "def", "map_labels_zsl", "(", "self", ")", ":", "\n", "        ", "for", "index", ",", "label", "in", "enumerate", "(", "self", ".", "labels", ")", ":", "\n", "            ", "self", ".", "labels", "[", "index", "]", "=", "gzsl_to_zsl_label_indexes", "[", "label", "[", "0", "]", "[", "0", "]", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.fetch_batch": [[50, 75], ["os.path.join", "PIL.Image.open().convert", "sun_dataloader.SunDataset.transform", "sun_dataloader.SunDataset.toTensor", "sun_dataloader.SunDataset.normalize", "torch.Tensor", "[].split", "PIL.Image.fromarray", "torch.Tensor.astype", "PIL.Image.open", "sun_dataloader.SunDataset.method", "numpy.uint8", "print", "numpy.asarray"], "methods", ["None"], ["", "", "def", "fetch_batch", "(", "self", ",", "idx", ")", ":", "\n", "        ", "im_name", "=", "self", ".", "file_names", "[", "idx", "]", "[", "0", "]", "[", "0", "]", "[", "0", "]", ".", "split", "(", "'images/'", ")", "[", "1", "]", "\n", "image_file", "=", "os", ".", "path", ".", "join", "(", "self", ".", "data_root", ",", "im_name", ")", "\n", "\n", "img_pil", "=", "Image", ".", "open", "(", "image_file", ")", ".", "convert", "(", "\"RGB\"", ")", "\n", "img_pil", "=", "self", ".", "transform", "(", "img_pil", ")", "\n", "\n", "if", "self", ".", "is_corruption", ":", "\n", "            ", "try", ":", "\n", "                ", "img_pil", "=", "self", ".", "method", "(", "img_pil", ",", "self", ".", "severity", ")", "\n", "", "except", ":", "\n", "                ", "print", "(", "\"Failure:\"", ",", "self", ".", "method", ".", "__name__", ",", "self", ".", "severity", ",", "im_name", ")", "\n", "img_pil", "=", "np", ".", "asarray", "(", "img_pil", ")", "\n", "\n", "", "img_pil", "=", "Image", ".", "fromarray", "(", "np", ".", "uint8", "(", "img_pil", ")", ")", "\n", "\n", "", "img_tensor", "=", "self", ".", "toTensor", "(", "img_pil", ")", "\n", "img_tensor", "=", "self", ".", "normalize", "(", "img_tensor", ")", "\n", "\n", "\n", "label", "=", "self", ".", "labels", "[", "idx", "]", "\n", "label", "=", "label", "[", "0", "]", "\n", "label", "=", "torch", ".", "Tensor", "(", "label", ".", "astype", "(", "int", ")", ")", "\n", "\n", "return", "(", "img_tensor", ",", "label", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.__getitem__": [[76, 80], ["sun_dataloader.SunDataset.fetch_batch"], "methods", ["home.repos.pwc.inspect_result.MKYucel_zero_shot_corruption_benchmarks.dataloaders.sun_dataloader.SunDataset.fetch_batch"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "batch", "=", "self", ".", "fetch_batch", "(", "idx", ")", "\n", "\n", "return", "batch", "\n", "", "", ""]]}