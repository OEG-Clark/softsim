{"home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyData.__init__": [[19, 47], ["torch.utils.data.Dataset.__init__", "os.path.join", "os.path.join", "os.path.join", "os.listdir", "enumerate", "dataset_loader.MyData.lbl_names.append", "dataset_loader.MyData.img_names.append", "dataset_loader.MyData.focal_names.append", "name.endswith", "os.path.join", "os.path.join", "os.path.join"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["def", "__init__", "(", "self", ",", "root", ",", "transform", "=", "False", ")", ":", "\n", "        ", "super", "(", "MyData", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "root", "=", "root", "\n", "\n", "self", ".", "img_names", "=", "[", "]", "\n", "self", ".", "lbl_names", "=", "[", "]", "\n", "self", ".", "focal_names", "=", "[", "]", "\n", "\n", "subsets", "=", "[", "\"DUTLF-FS-Train\"", ",", "\"HFUT-Train\"", "]", "\n", "for", "subset", "in", "subsets", ":", "\n", "\n", "            ", "img_root", "=", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "subset", ",", "'train_images'", ")", "\n", "lbl_root", "=", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "subset", ",", "'train_masks'", ")", "\n", "focal_root", "=", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "subset", ",", "'train_original_focal'", ")", "\n", "\n", "file_names", "=", "os", ".", "listdir", "(", "img_root", ")", "\n", "\n", "for", "i", ",", "name", "in", "enumerate", "(", "file_names", ")", ":", "\n", "                ", "if", "not", "name", ".", "endswith", "(", "'.jpg'", ")", ":", "\n", "                    ", "continue", "\n", "", "self", ".", "lbl_names", ".", "append", "(", "\n", "os", ".", "path", ".", "join", "(", "lbl_root", ",", "name", "[", ":", "-", "4", "]", "+", "'.png'", ")", "\n", ")", "\n", "self", ".", "img_names", ".", "append", "(", "\n", "os", ".", "path", ".", "join", "(", "img_root", ",", "name", ")", "\n", ")", "\n", "self", ".", "focal_names", ".", "append", "(", "\n", "os", ".", "path", ".", "join", "(", "focal_root", ",", "name", "[", ":", "-", "4", "]", "+", "'.mat'", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyData.__len__": [[51, 53], ["len"], "methods", ["None"], ["", "", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "img_names", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyData.__getitem__": [[54, 86], ["PIL.Image.open", "numpy.array.resize", "numpy.array", "PIL.Image.open", "numpy.array.resize", "numpy.array", "scipy.loadmat", "numpy.array", "range", "numpy.concatenate", "dataset_loader.MyData.transform", "focal[].astype", "cv2.resize", "new_focal.append"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyTestData.transform"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "# load image", "\n", "        ", "img_file", "=", "self", ".", "img_names", "[", "index", "]", "\n", "img", "=", "PIL", ".", "Image", ".", "open", "(", "img_file", ")", "\n", "img", "=", "img", ".", "resize", "(", "(", "256", ",", "256", ")", ")", "\n", "img", "=", "np", ".", "array", "(", "img", ",", "dtype", "=", "np", ".", "uint8", ")", "\n", "\n", "lbl_file", "=", "self", ".", "lbl_names", "[", "index", "]", "\n", "lbl", "=", "PIL", ".", "Image", ".", "open", "(", "lbl_file", ")", "\n", "lbl", "=", "lbl", ".", "resize", "(", "(", "256", ",", "256", ")", ")", "\n", "lbl", "=", "np", ".", "array", "(", "lbl", ",", "dtype", "=", "np", ".", "int32", ")", "\n", "\n", "focal_file", "=", "self", ".", "focal_names", "[", "index", "]", "\n", "focal", "=", "sio", ".", "loadmat", "(", "focal_file", ")", "\n", "focal", "=", "focal", "[", "'img'", "]", "\n", "focal", "=", "np", ".", "array", "(", "focal", ",", "dtype", "=", "np", ".", "int32", ")", "\n", "\n", "if", "focal", ".", "shape", "[", "0", "]", "!=", "256", ":", "\n", "            ", "new_focal", "=", "[", "]", "\n", "\n", "focal_num", "=", "focal", ".", "shape", "[", "2", "]", "//", "3", "\n", "\n", "for", "i", "in", "range", "(", "focal_num", ")", ":", "\n", "                ", "a", "=", "focal", "[", ":", ",", ":", ",", "i", "*", "3", ":", "i", "*", "3", "+", "3", "]", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "a", "=", "cv2", ".", "resize", "(", "a", ",", "(", "256", ",", "256", ")", ")", "\n", "new_focal", ".", "append", "(", "a", ")", "\n", "", "focal", "=", "np", ".", "concatenate", "(", "new_focal", ",", "axis", "=", "2", ")", "\n", "\n", "", "if", "self", ".", "transform", ":", "\n", "            ", "return", "self", ".", "transform", "(", "img", ",", "lbl", ",", "focal", ")", "\n", "", "else", ":", "\n", "            ", "return", "img", ",", "lbl", ",", "focal", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyData.transform": [[87, 106], ["torch.from_numpy().float.transpose", "torch.from_numpy().float", "lbl.unsqueeze.unsqueeze.unsqueeze", "numpy.tile", "numpy.tile", "torch.from_numpy().float.transpose", "torch.from_numpy().float", "torch.from_numpy().float.astype", "torch.from_numpy().float", "torch.from_numpy().float.astype", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy"], "methods", ["None"], ["", "", "def", "transform", "(", "self", ",", "img", ",", "lbl", ",", "focal", ")", ":", "\n", "        ", "img", "=", "img", ".", "astype", "(", "np", ".", "float64", ")", "/", "255.0", "\n", "img", "-=", "self", ".", "mean_rgb", "\n", "img", "/=", "self", ".", "std_rgb", "\n", "img", "=", "img", ".", "transpose", "(", "2", ",", "0", ",", "1", ")", "# to verify", "\n", "img", "=", "torch", ".", "from_numpy", "(", "img", ")", ".", "float", "(", ")", "\n", "lbl", "=", "torch", ".", "from_numpy", "(", "lbl", ")", ".", "float", "(", ")", "/", "255", "\n", "lbl", "=", "lbl", ".", "unsqueeze", "(", "0", ")", "\n", "\n", "focal_num", "=", "focal", ".", "shape", "[", "2", "]", "//", "3", "\n", "mean_focal", "=", "np", ".", "tile", "(", "self", ".", "mean_rgb", ",", "focal_num", ")", "\n", "std_focal", "=", "np", ".", "tile", "(", "self", ".", "std_rgb", ",", "focal_num", ")", "\n", "\n", "focal", "=", "focal", ".", "astype", "(", "np", ".", "float64", ")", "/", "255.0", "\n", "focal", "-=", "mean_focal", "\n", "focal", "/=", "std_focal", "\n", "focal", "=", "focal", ".", "transpose", "(", "2", ",", "0", ",", "1", ")", "\n", "focal", "=", "torch", ".", "from_numpy", "(", "focal", ")", ".", "float", "(", ")", "\n", "return", "img", ",", "lbl", ",", "focal", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyTestData.__init__": [[124, 149], ["torch.utils.data.Dataset.__init__", "os.path.join", "os.path.join", "os.listdir", "enumerate", "dataset_loader.MyTestData.img_names.append", "dataset_loader.MyTestData.names.append", "dataset_loader.MyTestData.focal_names.append", "name.endswith", "os.path.join", "os.path.join"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["def", "__init__", "(", "self", ",", "root", ",", "transform", "=", "False", ")", ":", "\n", "        ", "super", "(", "MyTestData", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "root", "=", "root", "\n", "self", ".", "_transform", "=", "transform", "\n", "\n", "self", ".", "img_names", "=", "[", "]", "\n", "self", ".", "names", "=", "[", "]", "\n", "self", ".", "focal_names", "=", "[", "]", "\n", "\n", "subsets", "=", "[", "\"LFSD\"", ",", "\"HFUT\"", ",", "\"DUTLF-FS\"", "]", "\n", "for", "subset", "in", "subsets", ":", "\n", "\n", "            ", "img_root", "=", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "subset", ",", "\"TestSet\"", ",", "'test_images'", ")", "\n", "focal_root", "=", "os", ".", "path", ".", "join", "(", "self", ".", "root", ",", "subset", ",", "\"TestSet\"", ",", "'test_original_focal'", ")", "\n", "file_names", "=", "os", ".", "listdir", "(", "img_root", ")", "\n", "\n", "for", "i", ",", "name", "in", "enumerate", "(", "file_names", ")", ":", "\n", "                ", "if", "not", "name", ".", "endswith", "(", "'.jpg'", ")", ":", "\n", "                    ", "continue", "\n", "", "self", ".", "img_names", ".", "append", "(", "\n", "os", ".", "path", ".", "join", "(", "img_root", ",", "name", ")", "\n", ")", "\n", "self", ".", "names", ".", "append", "(", "name", "[", ":", "-", "4", "]", ")", "\n", "self", ".", "focal_names", ".", "append", "(", "\n", "os", ".", "path", ".", "join", "(", "focal_root", ",", "name", "[", ":", "-", "4", "]", "+", "'.mat'", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyTestData.__len__": [[151, 153], ["len"], "methods", ["None"], ["", "", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "img_names", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyTestData.__getitem__": [[154, 185], ["PIL.Image.open", "numpy.array.resize", "numpy.array", "scipy.loadmat", "numpy.array", "range", "numpy.concatenate", "dataset_loader.MyTestData.transform", "focal[].astype", "cv2.resize", "new_focal.append"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyTestData.transform"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "# load image", "\n", "        ", "img_file", "=", "self", ".", "img_names", "[", "index", "]", "\n", "img", "=", "PIL", ".", "Image", ".", "open", "(", "img_file", ")", "\n", "img_size", "=", "img", ".", "size", "\n", "img", "=", "img", ".", "resize", "(", "(", "256", ",", "256", ")", ")", "\n", "img", "=", "np", ".", "array", "(", "img", ",", "dtype", "=", "np", ".", "uint8", ")", "\n", "\n", "# load focal", "\n", "focal_file", "=", "self", ".", "focal_names", "[", "index", "]", "\n", "focal", "=", "sio", ".", "loadmat", "(", "focal_file", ")", "\n", "focal", "=", "focal", "[", "'img'", "]", "\n", "focal", "=", "np", ".", "array", "(", "focal", ",", "dtype", "=", "np", ".", "int32", ")", "\n", "\n", "if", "focal", ".", "shape", "[", "0", "]", "!=", "256", ":", "\n", "            ", "new_focal", "=", "[", "]", "\n", "\n", "focal_num", "=", "focal", ".", "shape", "[", "2", "]", "//", "3", "\n", "\n", "for", "i", "in", "range", "(", "focal_num", ")", ":", "\n", "                ", "a", "=", "focal", "[", ":", ",", ":", ",", "i", "*", "3", ":", "i", "*", "3", "+", "3", "]", ".", "astype", "(", "np", ".", "uint8", ")", "\n", "a", "=", "cv2", ".", "resize", "(", "a", ",", "(", "256", ",", "256", ")", ")", "\n", "new_focal", ".", "append", "(", "a", ")", "\n", "", "focal", "=", "np", ".", "concatenate", "(", "new_focal", ",", "axis", "=", "2", ")", "\n", "\n", "\n", "", "if", "self", ".", "_transform", ":", "\n", "            ", "img", ",", "focal", "=", "self", ".", "transform", "(", "img", ",", "focal", ")", "\n", "return", "img_file", ",", "img", ",", "focal", "\n", "", "else", ":", "\n", "            ", "return", "img_file", ",", "img", ",", "focal", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.dataset_loader.MyTestData.transform": [[186, 204], ["torch.from_numpy().float.transpose", "torch.from_numpy().float", "numpy.tile", "numpy.tile", "torch.from_numpy().float.transpose", "torch.from_numpy().float", "torch.from_numpy().float.astype", "torch.from_numpy().float.astype", "torch.from_numpy", "torch.from_numpy"], "methods", ["None"], ["", "", "def", "transform", "(", "self", ",", "img", ",", "focal", ")", ":", "\n", "        ", "img", "=", "img", ".", "astype", "(", "np", ".", "float64", ")", "/", "255.0", "\n", "img", "-=", "self", ".", "mean_rgb", "\n", "img", "/=", "self", ".", "std_rgb", "\n", "img", "=", "img", ".", "transpose", "(", "2", ",", "0", ",", "1", ")", "\n", "img", "=", "torch", ".", "from_numpy", "(", "img", ")", ".", "float", "(", ")", "\n", "\n", "focal_num", "=", "focal", ".", "shape", "[", "2", "]", "//", "3", "\n", "mean_focal", "=", "np", ".", "tile", "(", "self", ".", "mean_rgb", ",", "focal_num", ")", "\n", "std_focal", "=", "np", ".", "tile", "(", "self", ".", "std_rgb", ",", "focal_num", ")", "\n", "\n", "focal", "=", "focal", ".", "astype", "(", "np", ".", "float64", ")", "/", "255.0", "\n", "focal", "-=", "mean_focal", "\n", "focal", "/=", "std_focal", "\n", "focal", "=", "focal", ".", "transpose", "(", "2", ",", "0", ",", "1", ")", "\n", "focal", "=", "torch", ".", "from_numpy", "(", "focal", ")", ".", "float", "(", ")", "\n", "\n", "return", "img", ",", "focal", "", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.trainsforms.Compose.__init__": [[17, 19], ["None"], "methods", ["None"], ["def", "__init__", "(", "self", ",", "transforms", ")", ":", "\n", "        ", "self", ".", "transforms", "=", "transforms", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.trainsforms.Compose.__call__": [[20, 24], ["t"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "data", ")", ":", "\n", "        ", "for", "t", "in", "self", ".", "transforms", ":", "\n", "            ", "data", "=", "t", "(", "data", ")", "\n", "", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.trainsforms.RandomHorizontalFlip.__call__": [[30, 45], ["random.random", "img.transpose.transpose.transpose", "lbl.transpose.transpose.transpose", "range", "len", "focal_difference[].transpose"], "methods", ["None"], ["def", "__call__", "(", "self", ",", "data", ")", ":", "\n", "        ", "img", ",", "lbl", ",", "focal_difference", "=", "data", "\n", "\n", "if", "random", ".", "random", "(", ")", "<", "0.5", ":", "\n", "            ", "img", "=", "img", ".", "transpose", "(", "Image", ".", "FLIP_LEFT_RIGHT", ")", "\n", "lbl", "=", "lbl", ".", "transpose", "(", "Image", ".", "FLIP_LEFT_RIGHT", ")", "\n", "\n", "\n", "for", "i", "in", "range", "(", "len", "(", "focal_difference", ")", ")", ":", "\n", "                ", "focal_difference", "[", "i", "]", "=", "focal_difference", "[", "i", "]", ".", "transpose", "(", "Image", ".", "FLIP_LEFT_RIGHT", ")", "\n", "\n", "\n", "", "", "data", "=", "[", "img", ",", "lbl", ",", "focal_difference", "]", "\n", "\n", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.trainsforms.Random_rotation.__call__": [[49, 62], ["random.choice", "img.rotate.rotate.rotate", "lbl.rotate.rotate.rotate", "range", "len", "focal_difference[].rotate"], "methods", ["None"], ["    ", "def", "__call__", "(", "self", ",", "data", ")", ":", "\n", "        ", "img", ",", "lbl", ",", "focal_difference", "=", "data", "\n", "angle", "=", "random", ".", "choice", "(", "[", "0", ",", "90", ",", "180", ",", "270", "]", ")", "\n", "\n", "\n", "img", "=", "img", ".", "rotate", "(", "angle", ")", "\n", "lbl", "=", "lbl", ".", "rotate", "(", "angle", ")", "\n", "\n", "for", "i", "in", "range", "(", "len", "(", "focal_difference", ")", ")", ":", "\n", "            ", "focal_difference", "[", "i", "]", "=", "focal_difference", "[", "i", "]", ".", "rotate", "(", "angle", ")", "\n", "\n", "", "data", "=", "[", "img", ",", "lbl", ",", "focal_difference", "]", "\n", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.trainsforms.Random_crop_Resize.__init__": [[65, 67], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "crop_size", ")", ":", "\n", "        ", "self", ".", "crop_size", "=", "crop_size", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.dataset.trainsforms.Random_crop_Resize.__call__": [[68, 92], ["img.resize.resize.crop", "lbl.resize.resize.crop", "img.resize.resize.resize", "lbl.resize.resize.resize", "range", "random.randint", "random.randint", "len", "focal_difference[].crop", "focal_difference[].resize"], "methods", ["None"], ["", "def", "__call__", "(", "self", ",", "data", ")", ":", "\n", "\n", "        ", "img", ",", "lbl", ",", "focal_difference", "=", "data", "\n", "assert", "img", ".", "size", "==", "lbl", ".", "size", ",", "\"img should have the same shape as label\"", "\n", "\n", "width", ",", "height", "=", "img", ".", "size", "\n", "\n", "x", ",", "y", "=", "random", ".", "randint", "(", "0", ",", "self", ".", "crop_size", ")", ",", "random", ".", "randint", "(", "0", ",", "self", ".", "crop_size", ")", "\n", "region", "=", "[", "x", ",", "y", ",", "width", "-", "x", ",", "height", "-", "y", "]", "\n", "\n", "img", "=", "img", ".", "crop", "(", "region", ")", "\n", "lbl", "=", "lbl", ".", "crop", "(", "region", ")", "\n", "\n", "img", "=", "img", ".", "resize", "(", "(", "width", ",", "height", ")", ",", "Image", ".", "BILINEAR", ")", "\n", "lbl", "=", "lbl", ".", "resize", "(", "(", "width", ",", "height", ")", ",", "Image", ".", "NEAREST", ")", "\n", "\n", "for", "i", "in", "range", "(", "len", "(", "focal_difference", ")", ")", ":", "\n", "            ", "focal_difference", "[", "i", "]", "=", "focal_difference", "[", "i", "]", ".", "crop", "(", "region", ")", "\n", "focal_difference", "[", "i", "]", "=", "focal_difference", "[", "i", "]", ".", "resize", "(", "(", "width", ",", "height", ")", ",", "Image", ".", "BILINEAR", ")", "\n", "\n", "\n", "", "data", "=", "[", "img", ",", "lbl", ",", "focal_difference", "]", "\n", "\n", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.convgru.ConvGRUCell.__init__": [[11, 27], ["torch.nn.Module.__init__", "torch.nn.Conv2d", "torch.nn.Conv2d", "torch.nn.Conv2d", "convgru.ConvGRUCell.state_dict", "isinstance", "torch.nn.init.kaiming_normal_", "torch.nn.init.constant_"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["def", "__init__", "(", "self", ",", "input_channels", ",", "hidden_channels", ",", "kernel_size", ",", "cuda_flag", "=", "True", ")", ":", "\n", "        ", "super", "(", "ConvGRUCell", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "input_channels", "=", "input_channels", "\n", "self", ".", "cuda_flag", "=", "cuda_flag", "\n", "self", ".", "hidden_channels", "=", "hidden_channels", "\n", "self", ".", "kernel_size", "=", "kernel_size", "\n", "\n", "padding", "=", "self", ".", "kernel_size", "//", "2", "\n", "self", ".", "reset_gate", "=", "nn", ".", "Conv2d", "(", "input_channels", "+", "hidden_channels", ",", "hidden_channels", ",", "3", ",", "padding", "=", "padding", ")", "\n", "self", ".", "update_gate", "=", "nn", ".", "Conv2d", "(", "input_channels", "+", "hidden_channels", ",", "hidden_channels", ",", "3", ",", "padding", "=", "padding", ")", "\n", "self", ".", "output_gate", "=", "nn", ".", "Conv2d", "(", "input_channels", "+", "hidden_channels", ",", "hidden_channels", ",", "3", ",", "padding", "=", "padding", ")", "\n", "# init", "\n", "for", "m", "in", "self", ".", "state_dict", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "nn", ".", "init", ".", "kaiming_normal_", "(", "m", ".", "weight", ",", "mode", "=", "'fan_out'", ",", "nonlinearity", "=", "'relu'", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "m", ".", "bias", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.convgru.ConvGRUCell.forward": [[28, 45], ["torch.cat", "torch.sigmoid", "torch.sigmoid", "torch.tanh", "convgru.ConvGRUCell.reset_gate", "convgru.ConvGRUCell.update_gate", "convgru.ConvGRUCell.output_gate", "list", "torch.zeros().cuda", "torch.zeros", "torch.cat", "x.data.size", "x.data.size", "torch.zeros"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ",", "hidden", ")", ":", "\n", "        ", "if", "hidden", "is", "None", ":", "\n", "           ", "size_h", "=", "[", "x", ".", "data", ".", "size", "(", ")", "[", "0", "]", ",", "self", ".", "hidden_channels", "]", "+", "list", "(", "x", ".", "data", ".", "size", "(", ")", "[", "2", ":", "]", ")", "\n", "if", "self", ".", "cuda_flag", ":", "\n", "              ", "hidden", "=", "torch", ".", "zeros", "(", "size_h", ")", ".", "cuda", "(", ")", "\n", "", "else", ":", "\n", "              ", "hidden", "=", "torch", ".", "zeros", "(", "size_h", ")", "\n", "\n", "", "", "inputs", "=", "torch", ".", "cat", "(", "(", "x", ",", "hidden", ")", ",", "dim", "=", "1", ")", "\n", "reset_gate", "=", "torch", ".", "sigmoid", "(", "self", ".", "reset_gate", "(", "inputs", ")", ")", "\n", "update_gate", "=", "torch", ".", "sigmoid", "(", "self", ".", "update_gate", "(", "inputs", ")", ")", "\n", "\n", "reset_hidden", "=", "reset_gate", "*", "hidden", "\n", "reset_inputs", "=", "torch", ".", "tanh", "(", "self", ".", "output_gate", "(", "torch", ".", "cat", "(", "(", "x", ",", "reset_hidden", ")", ",", "dim", "=", "1", ")", ")", ")", "\n", "new_hidden", "=", "(", "1", "-", "update_gate", ")", "*", "reset_inputs", "+", "update_gate", "*", "hidden", "\n", "\n", "return", "new_hidden", "", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.non_local._NonLocalBlockND.__init__": [[7, 86], ["torch.nn.Module.__init__", "conv_nd", "conv_nd", "conv_nd", "conv_nd", "conv_nd", "conv_nd", "torch.nn.Sequential", "torch.nn.MaxPool3d", "torch.nn.Sequential", "torch.nn.init.constant_", "torch.nn.init.constant_", "conv_nd", "torch.nn.init.constant_", "torch.nn.init.constant_", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Conv2d", "torch.nn.ReLU", "torch.nn.Sequential", "conv_nd", "torch.nn.MaxPool2d", "torch.nn.MaxPool1d", "conv_nd", "bn", "conv_nd", "bn"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "inter_channels", "=", "None", ",", "dimension", "=", "3", ",", "sub_sample", "=", "True", ",", "bn_layer", "=", "True", ")", ":", "\n", "        ", "super", "(", "_NonLocalBlockND", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "assert", "dimension", "in", "[", "1", ",", "2", ",", "3", "]", "\n", "\n", "self", ".", "dimension", "=", "dimension", "\n", "self", ".", "sub_sample", "=", "sub_sample", "\n", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "inter_channels", "=", "inter_channels", "\n", "\n", "if", "self", ".", "inter_channels", "is", "None", ":", "\n", "            ", "self", ".", "inter_channels", "=", "in_channels", "//", "2", "\n", "if", "self", ".", "inter_channels", "==", "0", ":", "\n", "                ", "self", ".", "inter_channels", "=", "1", "\n", "\n", "", "", "if", "dimension", "==", "3", ":", "\n", "            ", "conv_nd", "=", "nn", ".", "Conv3d", "\n", "max_pool_layer", "=", "nn", ".", "MaxPool3d", "(", "kernel_size", "=", "(", "1", ",", "2", ",", "2", ")", ")", "\n", "bn", "=", "nn", ".", "BatchNorm3d", "\n", "", "elif", "dimension", "==", "2", ":", "\n", "            ", "conv_nd", "=", "nn", ".", "Conv2d", "\n", "max_pool_layer", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "(", "2", ",", "2", ")", ")", "\n", "bn", "=", "nn", ".", "BatchNorm2d", "\n", "", "else", ":", "\n", "            ", "conv_nd", "=", "nn", ".", "Conv1d", "\n", "max_pool_layer", "=", "nn", ".", "MaxPool1d", "(", "kernel_size", "=", "(", "2", ")", ")", "\n", "bn", "=", "nn", ".", "BatchNorm1d", "\n", "\n", "", "self", ".", "g", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "inter_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "\n", "if", "bn_layer", ":", "\n", "            ", "self", ".", "W", "=", "nn", ".", "Sequential", "(", "\n", "conv_nd", "(", "in_channels", "=", "self", ".", "inter_channels", ",", "out_channels", "=", "self", ".", "in_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", ",", "\n", "bn", "(", "self", ".", "in_channels", ")", "\n", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "self", ".", "W", "[", "1", "]", ".", "weight", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "self", ".", "W", "[", "1", "]", ".", "bias", ",", "0", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "W", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "inter_channels", ",", "out_channels", "=", "self", ".", "in_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "self", ".", "W", ".", "weight", ",", "0", ")", "\n", "nn", ".", "init", ".", "constant_", "(", "self", ".", "W", ".", "bias", ",", "0", ")", "\n", "\n", "", "self", ".", "theta", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "inter_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "self", ".", "phi", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "inter_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "\n", "if", "sub_sample", ":", "\n", "            ", "self", ".", "g", "=", "nn", ".", "Sequential", "(", "self", ".", "g", ",", "max_pool_layer", ")", "\n", "self", ".", "phi", "=", "nn", ".", "Sequential", "(", "self", ".", "phi", ",", "max_pool_layer", ")", "\n", "\n", "\n", "\n", "", "self", ".", "rgb_g", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "inter_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "self", ".", "rgb_phi", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "inter_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "self", ".", "rgb_theta", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "in_channels", ",", "out_channels", "=", "self", ".", "inter_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "\n", "self", ".", "concat_project", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "self", ".", "inter_channels", "*", "2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "bias", "=", "False", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", "\n", ")", "\n", "\n", "if", "bn_layer", ":", "\n", "            ", "self", ".", "rgb_W", "=", "nn", ".", "Sequential", "(", "\n", "conv_nd", "(", "in_channels", "=", "self", ".", "inter_channels", ",", "out_channels", "=", "self", ".", "in_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", ",", "\n", "bn", "(", "self", ".", "in_channels", ")", "\n", ")", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "rgb_W", "=", "conv_nd", "(", "in_channels", "=", "self", ".", "inter_channels", ",", "out_channels", "=", "self", ".", "in_channels", ",", "\n", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.non_local._NonLocalBlockND.forward": [[87, 198], ["x.size", "non_local._NonLocalBlockND.g", "torch.nn.functional.unfold", "g_x_d1.permute.permute.view", "g_x_d1.permute.permute.permute", "torch.nn.functional.unfold", "torch.cat.view", "torch.cat.permute", "torch.cat", "torch.cat", "g_x.reshape.reshape.reshape", "non_local._NonLocalBlockND.theta", "torch.nn.functional.unfold", "theta_x_d1.permute.permute.view", "theta_x_d1.permute.permute.permute", "torch.nn.functional.unfold", "torch.cat.view", "torch.cat.permute", "torch.cat", "torch.cat", "theta_x.reshape.reshape.reshape", "non_local._NonLocalBlockND.phi", "phi_x.permute.permute.view", "phi_x.permute.permute.permute", "torch.matmul", "torch.nn.functional.softmax", "torch.matmul", "y.view.view.permute().contiguous", "y.view.view.view", "non_local._NonLocalBlockND.W", "non_local._NonLocalBlockND.rgb_g", "torch.nn.functional.unfold", "g_rgb_d1.permute.permute.view", "g_rgb_d1.permute.permute.permute", "torch.nn.functional.unfold", "torch.cat.view", "torch.cat.permute", "torch.cat", "torch.cat", "g_rgb.reshape.reshape.reshape", "non_local._NonLocalBlockND.rgb_theta", "torch.nn.functional.unfold", "theta_rgb_d1.permute.permute.view", "theta_rgb_d1.permute.permute.permute", "torch.nn.functional.unfold", "torch.cat.view", "torch.cat.permute", "torch.cat", "torch.cat", "x.size", "non_local._NonLocalBlockND.rgb_phi", "phi_rgb.repeat.repeat.view", "phi_rgb.repeat.repeat.permute", "theta_rgb.repeat.repeat.size", "phi_rgb.repeat.repeat.size", "theta_rgb.repeat.repeat.repeat", "phi_rgb.repeat.repeat.repeat", "torch.cat", "non_local._NonLocalBlockND.concat_project", "f.view.view.view", "f.view.view.size", "torch.matmul", "y_rgb.view.view.permute().contiguous", "y_rgb.view.view.view", "non_local._NonLocalBlockND.rgb_W", "x.size", "x.size", "rgb.size", "rgb.size", "y.view.view.permute", "y_rgb.view.view.permute"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "x", ",", "rgb", ")", ":", "\n", "        ", "'''\n        :param x: (N, c, h, w)\n        :return:\n        '''", "\n", "#", "\n", "focal_num", "=", "x", ".", "size", "(", "0", ")", "\n", "h", ",", "w", "=", "x", ".", "size", "(", "2", ")", ",", "x", ".", "size", "(", "3", ")", "\n", "kernel_size", "=", "3", "\n", "\n", "#################################################focalfocal#####################################33", "\n", "g_x", "=", "self", ".", "g", "(", "x", ")", "\n", "\n", "g_x_d1", "=", "F", ".", "unfold", "(", "g_x", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "1", ",", "padding", "=", "1", ")", "\n", "g_x_d1", "=", "g_x_d1", ".", "view", "(", "focal_num", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "h", "*", "w", ")", "\n", "g_x_d1", "=", "g_x_d1", ".", "permute", "(", "3", ",", "0", ",", "2", ",", "1", ")", "\n", "\n", "g_x_d3", "=", "F", ".", "unfold", "(", "g_x", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "3", ",", "padding", "=", "3", ")", "\n", "g_x_d3", "=", "g_x_d3", ".", "view", "(", "focal_num", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "h", "*", "w", ")", "\n", "g_x_d3", "=", "g_x_d3", ".", "permute", "(", "3", ",", "0", ",", "2", ",", "1", ")", "\n", "g_x_d3", "=", "torch", ".", "cat", "(", "(", "g_x_d3", "[", ":", ",", ":", ",", ":", "4", ",", ":", "]", ",", "g_x_d3", "[", ":", ",", ":", ",", "5", ":", ",", ":", "]", ")", ",", "dim", "=", "2", ")", "\n", "\n", "g_x", "=", "torch", ".", "cat", "(", "(", "g_x_d1", ",", "g_x_d3", ")", ",", "dim", "=", "2", ")", "\n", "g_x", "=", "g_x", ".", "reshape", "(", "h", "*", "w", ",", "-", "1", ",", "self", ".", "inter_channels", ")", "# [h*w, c, (3*3-1)*12]", "\n", "\n", "theta_x", "=", "self", ".", "theta", "(", "x", ")", "\n", "\n", "theta_x_d1", "=", "F", ".", "unfold", "(", "theta_x", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "1", ",", "padding", "=", "1", ")", "\n", "theta_x_d1", "=", "theta_x_d1", ".", "view", "(", "focal_num", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "h", "*", "w", ")", "\n", "theta_x_d1", "=", "theta_x_d1", ".", "permute", "(", "3", ",", "1", ",", "0", ",", "2", ")", "\n", "\n", "theta_x_d3", "=", "F", ".", "unfold", "(", "theta_x", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "3", ",", "padding", "=", "3", ")", "\n", "theta_x_d3", "=", "theta_x_d3", ".", "view", "(", "focal_num", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "h", "*", "w", ")", "\n", "theta_x_d3", "=", "theta_x_d3", ".", "permute", "(", "3", ",", "1", ",", "0", ",", "2", ")", "\n", "theta_x_d3", "=", "torch", ".", "cat", "(", "(", "theta_x_d3", "[", ":", ",", ":", ",", ":", ",", ":", "4", "]", ",", "theta_x_d3", "[", ":", ",", ":", ",", ":", ",", "5", ":", "]", ")", ",", "dim", "=", "3", ")", "\n", "\n", "theta_x", "=", "torch", ".", "cat", "(", "(", "theta_x_d1", ",", "theta_x_d3", ")", ",", "dim", "=", "3", ")", "\n", "theta_x", "=", "theta_x", ".", "reshape", "(", "h", "*", "w", ",", "self", ".", "inter_channels", ",", "-", "1", ")", "# [h*w, c, (3*3)*12]", "\n", "\n", "phi_x", "=", "self", ".", "phi", "(", "x", ")", "\n", "phi_x", "=", "phi_x", ".", "view", "(", "focal_num", ",", "-", "1", ",", "h", "*", "w", ")", "\n", "phi_x", "=", "phi_x", ".", "permute", "(", "2", ",", "0", ",", "1", ")", "\n", "\n", "f", "=", "torch", ".", "matmul", "(", "phi_x", ",", "theta_x", ")", "\n", "f_div_C", "=", "F", ".", "softmax", "(", "f", ",", "dim", "=", "-", "1", ")", "\n", "\n", "y", "=", "torch", ".", "matmul", "(", "f_div_C", ",", "g_x", ")", "\n", "y", "=", "y", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "contiguous", "(", ")", "\n", "y", "=", "y", ".", "view", "(", "focal_num", ",", "self", ".", "inter_channels", ",", "h", ",", "w", ")", "\n", "\n", "W_y", "=", "self", ".", "W", "(", "y", ")", "\n", "\n", "#################################################rgb focal#####################################33", "\n", "\n", "rgb_h", ",", "rgb_w", "=", "rgb", ".", "size", "(", "2", ")", ",", "rgb", ".", "size", "(", "3", ")", "\n", "kernel_size", "=", "3", "\n", "\n", "g_rgb", "=", "self", ".", "rgb_g", "(", "rgb", ")", "\n", "\n", "g_rgb_d1", "=", "F", ".", "unfold", "(", "g_rgb", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "1", ",", "padding", "=", "1", ")", "\n", "g_rgb_d1", "=", "g_rgb_d1", ".", "view", "(", "1", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "rgb_h", "*", "rgb_w", ")", "\n", "g_rgb_d1", "=", "g_rgb_d1", ".", "permute", "(", "3", ",", "0", ",", "2", ",", "1", ")", "\n", "\n", "g_rgb_d3", "=", "F", ".", "unfold", "(", "g_rgb", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "3", ",", "padding", "=", "3", ")", "\n", "g_rgb_d3", "=", "g_rgb_d3", ".", "view", "(", "1", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "rgb_h", "*", "rgb_w", ")", "\n", "g_rgb_d3", "=", "g_rgb_d3", ".", "permute", "(", "3", ",", "0", ",", "2", ",", "1", ")", "\n", "g_rgb_d3", "=", "torch", ".", "cat", "(", "(", "g_rgb_d3", "[", ":", ",", ":", ",", ":", "4", ",", ":", "]", ",", "g_rgb_d3", "[", ":", ",", ":", ",", "5", ":", ",", ":", "]", ")", ",", "dim", "=", "2", ")", "\n", "\n", "g_rgb", "=", "torch", ".", "cat", "(", "(", "g_rgb_d1", ",", "g_rgb_d3", ")", ",", "dim", "=", "2", ")", "\n", "g_rgb", "=", "g_rgb", ".", "reshape", "(", "rgb_h", "*", "rgb_w", ",", "-", "1", ",", "self", ".", "inter_channels", ")", "# [h*w, c, (3*3-1)*12]", "\n", "\n", "theta_rgb", "=", "self", ".", "rgb_theta", "(", "rgb", ")", "\n", "\n", "theta_rgb_d1", "=", "F", ".", "unfold", "(", "theta_rgb", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "1", ",", "padding", "=", "1", ")", "\n", "theta_rgb_d1", "=", "theta_rgb_d1", ".", "view", "(", "1", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "rgb_h", "*", "rgb_w", ")", "\n", "theta_rgb_d1", "=", "theta_rgb_d1", ".", "permute", "(", "3", ",", "1", ",", "0", ",", "2", ")", "\n", "\n", "theta_rgb_d3", "=", "F", ".", "unfold", "(", "theta_rgb", ",", "kernel_size", "=", "kernel_size", ",", "stride", "=", "1", ",", "dilation", "=", "3", ",", "padding", "=", "3", ")", "\n", "theta_rgb_d3", "=", "theta_rgb_d3", ".", "view", "(", "1", ",", "-", "1", ",", "kernel_size", "*", "kernel_size", ",", "rgb_h", "*", "rgb_w", ")", "\n", "theta_rgb_d3", "=", "theta_rgb_d3", ".", "permute", "(", "3", ",", "1", ",", "0", ",", "2", ")", "\n", "theta_rgb_d3", "=", "torch", ".", "cat", "(", "(", "theta_rgb_d3", "[", ":", ",", ":", ",", ":", ",", ":", "4", "]", ",", "theta_rgb_d3", "[", ":", ",", ":", ",", ":", ",", "5", ":", "]", ")", ",", "dim", "=", "3", ")", "\n", "\n", "theta_rgb", "=", "torch", ".", "cat", "(", "(", "theta_rgb_d1", ",", "theta_rgb_d3", ")", ",", "dim", "=", "3", ")", "\n", "# theta_rgb = theta_rgb.reshape(rgb_h*rgb_w, self.inter_channels, -1)#[h*w, c, (3*3)*12]", "\n", "\n", "# caculate the simality between focal and rgb", "\n", "focal_num", "=", "x", ".", "size", "(", "0", ")", "\n", "phi_rgb", "=", "self", ".", "rgb_phi", "(", "x", ")", "# input x!!!!!!!!!!!!!!!!!", "\n", "phi_rgb", "=", "phi_rgb", ".", "view", "(", "focal_num", ",", "-", "1", ",", "1", ",", "rgb_h", "*", "rgb_w", ")", "\n", "phi_rgb", "=", "phi_rgb", ".", "permute", "(", "3", ",", "1", ",", "0", ",", "2", ")", "\n", "\n", "w_", "=", "theta_rgb", ".", "size", "(", "3", ")", "\n", "h_", "=", "phi_rgb", ".", "size", "(", "2", ")", "\n", "theta_rgb", "=", "theta_rgb", ".", "repeat", "(", "1", ",", "1", ",", "h_", ",", "1", ")", "\n", "phi_rgb", "=", "phi_rgb", ".", "repeat", "(", "1", ",", "1", ",", "1", ",", "w_", ")", "\n", "\n", "concat_feature", "=", "torch", ".", "cat", "(", "[", "theta_rgb", ",", "phi_rgb", "]", ",", "dim", "=", "1", ")", "\n", "f", "=", "self", ".", "concat_project", "(", "concat_feature", ")", "\n", "f", "=", "f", ".", "view", "(", "f", ".", "shape", "[", "0", "]", ",", "f", ".", "shape", "[", "2", "]", ",", "f", ".", "shape", "[", "3", "]", ")", "\n", "\n", "N", "=", "f", ".", "size", "(", "-", "1", ")", "\n", "f_div_C_rgb", "=", "f", "/", "N", "\n", "\n", "y_rgb", "=", "torch", ".", "matmul", "(", "f_div_C_rgb", ",", "g_rgb", ")", "\n", "y_rgb", "=", "y_rgb", ".", "permute", "(", "1", ",", "2", ",", "0", ")", ".", "contiguous", "(", ")", "\n", "y_rgb", "=", "y_rgb", ".", "view", "(", "focal_num", ",", "self", ".", "inter_channels", ",", "h", ",", "w", ")", "\n", "\n", "W_y_rgb", "=", "self", ".", "rgb_W", "(", "y_rgb", ")", "\n", "\n", "z", "=", "W_y", "+", "W_y_rgb", "+", "x", "\n", "return", "z", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.non_local.NONLocalBlock3D.__init__": [[201, 206], ["non_local._NonLocalBlockND.__init__"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "inter_channels", "=", "None", ",", "sub_sample", "=", "True", ",", "bn_layer", "=", "True", ")", ":", "\n", "        ", "super", "(", "NONLocalBlock3D", ",", "self", ")", ".", "__init__", "(", "in_channels", ",", "\n", "inter_channels", "=", "inter_channels", ",", "\n", "dimension", "=", "3", ",", "sub_sample", "=", "sub_sample", ",", "\n", "bn_layer", "=", "bn_layer", ")", "\n", "", "", "class", "NONLocalBlock2D", "(", "_NonLocalBlockND", ")", ":", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.non_local.NONLocalBlock2D.__init__": [[207, 212], ["non_local._NonLocalBlockND.__init__"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "inter_channels", "=", "None", ",", "sub_sample", "=", "True", ",", "bn_layer", "=", "True", ")", ":", "\n", "        ", "super", "(", "NONLocalBlock2D", ",", "self", ")", ".", "__init__", "(", "in_channels", ",", "\n", "inter_channels", "=", "inter_channels", ",", "\n", "dimension", "=", "2", ",", "sub_sample", "=", "sub_sample", ",", "\n", "bn_layer", "=", "bn_layer", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.__init__": [[43, 62], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "cuda", ",", "model_rgb", ",", "\n", "model_focal", ",", "model_fuse", ",", "optimizer_rgb", ",", "\n", "optimizer_focal", ",", "optimizer_fuse", ",", "\n", "train_loader", ",", "max_iter", ",", "snapshot", ",", "outpath", ",", "sshow", ",", "size_average", "=", "False", ")", ":", "\n", "        ", "self", ".", "cuda", "=", "cuda", "\n", "self", ".", "model_rgb", "=", "model_rgb", "\n", "self", ".", "model_focal", "=", "model_focal", "\n", "self", ".", "model_fuse", "=", "model_fuse", "\n", "self", ".", "optim_rgb", "=", "optimizer_rgb", "\n", "self", ".", "optim_focal", "=", "optimizer_focal", "\n", "self", ".", "optim_fuse", "=", "optimizer_fuse", "\n", "self", ".", "train_loader", "=", "train_loader", "\n", "self", ".", "epoch", "=", "0", "\n", "self", ".", "iteration", "=", "0", "\n", "self", ".", "max_iter", "=", "max_iter", "\n", "self", ".", "snapshot", "=", "snapshot", "\n", "self", ".", "outpath", "=", "outpath", "\n", "self", ".", "sshow", "=", "sshow", "\n", "self", ".", "size_average", "=", "size_average", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.train_epoch": [[65, 144], ["enumerate", "torch.cat.size", "torch.cat.size", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "trainer.Trainer.optim_rgb.zero_grad", "trainer.Trainer.optim_focal.zero_grad", "trainer.Trainer.optim_fuse.zero_grad", "trainer.Trainer.model_rgb", "trainer.Trainer.model_focal", "trainer.Trainer.model_fuse", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "torch.binary_cross_entropy_with_logits", "loss.backward", "trainer.Trainer.optim_rgb.step", "trainer.Trainer.optim_focal.step", "trainer.Trainer.optim_fuse.step", "trainer.Trainer.adjust_lr", "trainer.Trainer.adjust_lr", "trainer.Trainer.adjust_lr", "print", "torch.sigmoid", "torch.sigmoid", "[].cpu().data.numpy", "cv2.imwrite", "torch.save", "torch.save", "torch.save", "torch.save", "print", "torch.save", "torch.save", "torch.save", "torch.save", "print", "torch.save", "torch.save", "torch.save", "torch.save", "print", "len", "image.cuda", "target.cuda", "torch.cat.cuda", "torch.cat.cuda", "trainer.Trainer.model_rgb.state_dict", "trainer.Trainer.model_focal.state_dict", "trainer.Trainer.model_fuse.state_dict", "datetime.datetime.datetime.now", "[].cpu"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.adjust_lr", "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.adjust_lr", "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.adjust_lr"], ["", "def", "train_epoch", "(", "self", ")", ":", "\n", "\n", "\n", "        ", "for", "batch_idx", ",", "(", "image", ",", "target", ",", "focal", ")", "in", "enumerate", "(", "self", ".", "train_loader", ")", ":", "\n", "\n", "\n", "            ", "iteration", "=", "batch_idx", "+", "self", ".", "epoch", "*", "len", "(", "self", ".", "train_loader", ")", "\n", "\n", "\n", "if", "iteration", "==", "150000", "or", "iteration", "==", "180000", ":", "\n", "                ", "self", ".", "adjust_lr", "(", "self", ".", "optim_rgb", ",", "decay_rate", "=", "0.1", ")", "\n", "self", ".", "adjust_lr", "(", "self", ".", "optim_focal", ",", "decay_rate", "=", "0.1", ")", "\n", "self", ".", "adjust_lr", "(", "self", ".", "optim_fuse", ",", "decay_rate", "=", "0.1", ")", "\n", "\n", "\n", "\n", "", "if", "self", ".", "iteration", "!=", "0", "and", "(", "iteration", "-", "1", ")", "!=", "self", ".", "iteration", ":", "\n", "                ", "continue", "# for resuming", "\n", "", "self", ".", "iteration", "=", "iteration", "\n", "if", "self", ".", "iteration", ">=", "self", ".", "max_iter", ":", "\n", "                ", "break", "\n", "", "if", "self", ".", "cuda", ":", "\n", "                ", "image", ",", "target", ",", "focal", "=", "image", ".", "cuda", "(", ")", ",", "target", ".", "cuda", "(", ")", ",", "focal", ".", "cuda", "(", ")", "\n", "\n", "", "basize", ",", "dime", ",", "height", ",", "width", "=", "focal", ".", "size", "(", ")", "# 2*36*256*256", "\n", "\n", "focal_num", "=", "focal", ".", "shape", "[", "1", "]", "//", "3", "\n", "focal", "=", "torch", ".", "chunk", "(", "focal", ",", "focal_num", ",", "dim", "=", "1", ")", "\n", "focal", "=", "torch", ".", "cat", "(", "focal", ",", "dim", "=", "0", ")", "\n", "\n", "\n", "self", ".", "optim_rgb", ".", "zero_grad", "(", ")", "\n", "self", ".", "optim_focal", ".", "zero_grad", "(", ")", "\n", "self", ".", "optim_fuse", ".", "zero_grad", "(", ")", "\n", "\n", "lowlevel_feature_rgb", ",", "rgb_feature", "=", "self", ".", "model_rgb", "(", "image", ")", "\n", "focal_feature", "=", "self", ".", "model_focal", "(", "focal", ")", "\n", "pred0", ",", "pred1", ",", "pred2", ",", "pred3", ",", "pred4", "=", "self", ".", "model_fuse", "(", "rgb_feature", ",", "focal_feature", ",", "lowlevel_feature_rgb", ")", "\n", "\n", "loss0", "=", "F", ".", "binary_cross_entropy_with_logits", "(", "pred0", ",", "target", ")", "\n", "loss1", "=", "F", ".", "binary_cross_entropy_with_logits", "(", "pred1", ",", "target", ")", "\n", "loss2", "=", "F", ".", "binary_cross_entropy_with_logits", "(", "pred2", ",", "target", ")", "\n", "loss3", "=", "F", ".", "binary_cross_entropy_with_logits", "(", "pred3", ",", "target", ")", "\n", "loss4", "=", "F", ".", "binary_cross_entropy_with_logits", "(", "pred4", ",", "target", ")", "\n", "\n", "loss", "=", "(", "loss0", "+", "loss1", "+", "loss2", "+", "loss3", "+", "loss4", ")", "/", "5", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optim_rgb", ".", "step", "(", ")", "\n", "self", ".", "optim_focal", ".", "step", "(", ")", "\n", "self", ".", "optim_fuse", ".", "step", "(", ")", "\n", "\n", "\n", "\n", "if", "iteration", "%", "10", "==", "0", ":", "\n", "\n", "\n", "                ", "print", "(", "'{} Epoch [{:03d}], Step [{:04d}/{:04d}], total loss: {:0.4f}'", ".", "format", "(", "datetime", ".", "now", "(", ")", ",", "self", ".", "epoch", ",", "iteration", ",", "self", ".", "max_iter", ",", "loss", ".", "data", ")", ")", "\n", "\n", "", "if", "iteration", "%", "50", "==", "0", ":", "\n", "                ", "pred1", "=", "F", ".", "sigmoid", "(", "pred1", ")", "\n", "pred1", "=", "pred1", "[", "0", "]", "[", "0", "]", ".", "cpu", "(", ")", ".", "data", ".", "numpy", "(", ")", "\n", "cv2", ".", "imwrite", "(", "\"show/{}_1.png\"", ".", "format", "(", "iteration", ")", ",", "255", "*", "pred1", ")", "\n", "\n", "\n", "\n", "\n", "", "if", "(", "iteration", "+", "1", ")", "==", "self", ".", "max_iter", ":", "\n", "                ", "savename", "=", "(", "'%s/snapshot_iter_%d.pth'", "%", "(", "self", ".", "outpath", ",", "iteration", "+", "1", ")", ")", "\n", "torch", ".", "save", "(", "self", ".", "model_rgb", ".", "state_dict", "(", ")", ",", "savename", ")", "\n", "print", "(", "'save: (snapshot: %d)'", "%", "(", "iteration", "+", "1", ")", ")", "\n", "\n", "savename_focal", "=", "(", "'%s/focal_snapshot_iter_%d.pth'", "%", "(", "self", ".", "outpath", ",", "iteration", "+", "1", ")", ")", "\n", "torch", ".", "save", "(", "self", ".", "model_focal", ".", "state_dict", "(", ")", ",", "savename_focal", ")", "\n", "print", "(", "'save: (snapshot_focal: %d)'", "%", "(", "iteration", "+", "1", ")", ")", "\n", "\n", "savename_fuse", "=", "(", "'%s/fuse_snapshot_iter_%d.pth'", "%", "(", "self", ".", "outpath", ",", "iteration", "+", "1", ")", ")", "\n", "torch", ".", "save", "(", "self", ".", "model_fuse", ".", "state_dict", "(", ")", ",", "savename_fuse", ")", "\n", "print", "(", "'save: (snapshot_fuse: %d)'", "%", "(", "iteration", "+", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.train": [[147, 170], ["int", "range", "math.ceil", "print", "print", "trainer.Trainer.train_epoch", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "torch.save", "len", "trainer.Trainer.model_rgb.state_dict", "trainer.Trainer.model_focal.state_dict", "trainer.Trainer.model_fuse.state_dict"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.train_epoch"], ["", "", "", "def", "train", "(", "self", ")", ":", "\n", "        ", "max_epoch", "=", "int", "(", "math", ".", "ceil", "(", "1.", "*", "self", ".", "max_iter", "/", "len", "(", "self", ".", "train_loader", ")", ")", ")", "\n", "\n", "for", "epoch", "in", "range", "(", "max_epoch", ")", ":", "\n", "            ", "print", "(", "epoch", ")", "\n", "print", "(", "self", ".", "optim_rgb", ".", "param_groups", "[", "0", "]", "[", "\"lr\"", "]", ")", "\n", "self", ".", "epoch", "=", "epoch", "\n", "self", ".", "train_epoch", "(", ")", "\n", "if", "epoch", "!=", "0", "and", "epoch", "%", "1", "==", "0", ":", "\n", "\n", "                ", "savename", "=", "(", "'%s/snapshot_epoch_%d.pth'", "%", "(", "self", ".", "outpath", ",", "epoch", ")", ")", "\n", "torch", ".", "save", "(", "self", ".", "model_rgb", ".", "state_dict", "(", ")", ",", "savename", ")", "\n", "\n", "\n", "savename_focal", "=", "(", "'%s/focal_snapshot_epoch_%d.pth'", "%", "(", "self", ".", "outpath", ",", "epoch", ")", ")", "\n", "torch", ".", "save", "(", "self", ".", "model_focal", ".", "state_dict", "(", ")", ",", "savename_focal", ")", "\n", "\n", "\n", "savename_fuse", "=", "(", "'%s/fuse_snapshot_epoch_%d.pth'", "%", "(", "self", ".", "outpath", ",", "epoch", ")", ")", "\n", "torch", ".", "save", "(", "self", ".", "model_fuse", ".", "state_dict", "(", ")", ",", "savename_fuse", ")", "\n", "\n", "", "if", "self", ".", "iteration", ">=", "self", ".", "max_iter", ":", "\n", "                ", "break", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.Trainer.adjust_lr": [[171, 176], ["print"], "methods", ["None"], ["", "", "", "def", "adjust_lr", "(", "self", ",", "optimizer", ",", "decay_rate", "=", "0.1", ")", ":", "\n", "        ", "decay", "=", "decay_rate", "\n", "for", "param_group", "in", "optimizer", ".", "param_groups", ":", "\n", "            ", "param_group", "[", "'lr'", "]", "*=", "decay", "\n", "", "print", "(", "\"lr=\"", ",", "optimizer", ".", "param_groups", "[", "0", "]", "[", "\"lr\"", "]", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.get_one_hot": [[10, 22], ["torch.ones().cuda", "torch.ones().cuda", "torch.ones", "torch.ones", "gt.view", "gt.view", "gt.view", "gt.view"], "function", ["None"], ["def", "get_one_hot", "(", "num", ",", "gt", ")", ":", "\n", "\n", "    ", "a", "=", "torch", ".", "ones", "(", "[", "1", ",", "2", ",", "num", "]", ")", ".", "cuda", "(", ")", "\n", "\n", "a", "[", ":", ",", "0", ",", "gt", ".", "view", "(", "num", ")", "==", "1", "]", "=", "1", "\n", "a", "[", ":", ",", "1", ",", "gt", ".", "view", "(", "num", ")", "==", "1", "]", "=", "0", "\n", "\n", "a", "[", ":", ",", "0", ",", "gt", ".", "view", "(", "num", ")", "==", "0", "]", "=", "0", "\n", "a", "[", ":", ",", "1", ",", "gt", ".", "view", "(", "num", ")", "==", "0", "]", "=", "1", "\n", "\n", "\n", "return", "a", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.similarity": [[25, 38], ["torch.interpolate().view", "trainer.get_one_hot", "torch.matmul", "torch.matmul", "torch.binary_cross_entropy_with_logits", "torch.matmul.permute", "torch.interpolate"], "function", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.trainer.get_one_hot"], ["", "def", "similarity", "(", "input", ",", "target", ")", ":", "\n", "\n", "    ", "target_1_4", "=", "F", ".", "interpolate", "(", "target", ",", "scale_factor", "=", "0.25", ",", "mode", "=", "\"nearest\"", ")", ".", "view", "(", "1", ",", "1", ",", "-", "1", ")", "\n", "target_1_4", "[", "target_1_4", ">", "0.5", "]", "=", "1", "\n", "target_1_4", "[", "target_1_4", "<=", "0.5", "]", "=", "0", "\n", "target_1_4", "=", "get_one_hot", "(", "target_1_4", ".", "shape", "[", "2", "]", ",", "target_1_4", ")", "\n", "target_1_4", "=", "torch", ".", "matmul", "(", "target_1_4", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ",", "target_1_4", ")", "\n", "\n", "\n", "loss_1_4", "=", "F", ".", "binary_cross_entropy_with_logits", "(", "input", ",", "target_1_4", ")", "\n", "\n", "\n", "return", "loss_1_4", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.fusenetwork.FuseNet.__init__": [[10, 36], ["torch.nn.Module.__init__", "non_local.NONLocalBlock2D", "decoder.FocalFuseAttention", "decoder.FocalFuseAttention", "decoder.FocalFuseAttention", "decoder.FocalFuseAttention", "decoder.FocalFuseAttention", "convgru.ConvGRUCell", "torch.nn.Conv2d", "torch.nn.Sequential", "torch.nn.Conv2d", "torch.nn.Conv2d", "torch.nn.Conv2d", "torch.nn.Conv2d", "torch.nn.Conv2d", "torch.nn.Conv2d", "torch.nn.ReLU", "torch.nn.Conv2d", "torch.nn.ReLU", "torch.nn.Conv2d", "torch.nn.ReLU"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "FuseNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "non_local", "=", "NONLocalBlock2D", "(", "in_channels", "=", "64", ",", "inter_channels", "=", "16", ",", "sub_sample", "=", "False", ",", "bn_layer", "=", "True", ")", "\n", "\n", "self", ".", "focal_fuse0", "=", "FocalFuseAttention", "(", "in_channels", "=", "64", ")", "\n", "self", ".", "focal_fuse1", "=", "FocalFuseAttention", "(", "in_channels", "=", "64", ")", "\n", "self", ".", "focal_fuse2", "=", "FocalFuseAttention", "(", "in_channels", "=", "64", ")", "\n", "self", ".", "focal_fuse3", "=", "FocalFuseAttention", "(", "in_channels", "=", "64", ")", "\n", "self", ".", "focal_fuse4", "=", "FocalFuseAttention", "(", "in_channels", "=", "64", ")", "\n", "\n", "self", ".", "gru", "=", "ConvGRUCell", "(", "input_channels", "=", "64", ",", "hidden_channels", "=", "64", ",", "kernel_size", "=", "3", ")", "\n", "self", ".", "tran", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "64", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "refine", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "64", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "64", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "64", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ")", "\n", "\n", "self", ".", "pred0", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "pred1", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "pred2", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "pred3", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "pred4", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "stride", "=", "1", ",", "kernel_size", "=", "3", ",", "padding", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.fusenetwork.FuseNet.forward": [[38, 70], ["fusenetwork.FuseNet.non_local", "fusenetwork.FuseNet.focal_fuse0", "fusenetwork.FuseNet.gru", "fusenetwork.FuseNet.pred0", "fusenetwork.FuseNet.non_local", "fusenetwork.FuseNet.focal_fuse1", "fusenetwork.FuseNet.gru", "fusenetwork.FuseNet.pred1", "fusenetwork.FuseNet.non_local", "fusenetwork.FuseNet.focal_fuse2", "fusenetwork.FuseNet.gru", "fusenetwork.FuseNet.pred2", "fusenetwork.FuseNet.non_local", "fusenetwork.FuseNet.focal_fuse3", "fusenetwork.FuseNet.gru", "fusenetwork.FuseNet.pred3", "fusenetwork.FuseNet.non_local", "fusenetwork.FuseNet.focal_fuse4", "fusenetwork.FuseNet.gru", "torch.nn.functional.upsample", "fusenetwork.FuseNet.refine", "fusenetwork.FuseNet.pred4", "torch.nn.functional.upsample", "torch.nn.functional.upsample", "torch.nn.functional.upsample", "torch.nn.functional.upsample", "torch.nn.functional.upsample", "fusenetwork.FuseNet.tran"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "rgb_feature", ",", "focal_feature", ",", "lowlevel_feature", ")", ":", "\n", "        ", "focal_feature_0", "=", "self", ".", "non_local", "(", "focal_feature", ",", "rgb_feature", ")", "\n", "x0", "=", "self", ".", "focal_fuse0", "(", "focal_feature_0", ")", "\n", "output0", "=", "self", ".", "gru", "(", "x0", ",", "rgb_feature", ")", "\n", "pred0", "=", "self", ".", "pred0", "(", "F", ".", "upsample", "(", "output0", ",", "scale_factor", "=", "4", ",", "mode", "=", "\"bilinear\"", ")", ")", "\n", "\n", "focal_feature_1", "=", "self", ".", "non_local", "(", "focal_feature_0", ",", "output0", ")", "\n", "x1", "=", "self", ".", "focal_fuse1", "(", "focal_feature_1", ")", "\n", "output1", "=", "self", ".", "gru", "(", "x1", ",", "output0", ")", "\n", "pred1", "=", "self", ".", "pred1", "(", "F", ".", "upsample", "(", "output1", ",", "scale_factor", "=", "4", ",", "mode", "=", "\"bilinear\"", ")", ")", "\n", "\n", "focal_feature_2", "=", "self", ".", "non_local", "(", "focal_feature_1", ",", "output1", ")", "\n", "x2", "=", "self", ".", "focal_fuse2", "(", "focal_feature_2", ")", "\n", "output2", "=", "self", ".", "gru", "(", "x2", ",", "output1", ")", "\n", "pred2", "=", "self", ".", "pred2", "(", "F", ".", "upsample", "(", "output2", ",", "scale_factor", "=", "4", ",", "mode", "=", "\"bilinear\"", ")", ")", "\n", "\n", "focal_feature_3", "=", "self", ".", "non_local", "(", "focal_feature_2", ",", "output2", ")", "\n", "x3", "=", "self", ".", "focal_fuse3", "(", "focal_feature_3", ")", "\n", "output3", "=", "self", ".", "gru", "(", "x3", ",", "output2", ")", "\n", "pred3", "=", "self", ".", "pred3", "(", "F", ".", "upsample", "(", "output3", ",", "scale_factor", "=", "4", ",", "mode", "=", "\"bilinear\"", ")", ")", "\n", "\n", "focal_feature_4", "=", "self", ".", "non_local", "(", "focal_feature_3", ",", "output3", ")", "\n", "x4", "=", "self", ".", "focal_fuse4", "(", "focal_feature_4", ")", "\n", "output4", "=", "self", ".", "gru", "(", "x4", ",", "output3", ")", "\n", "\n", "output4", "=", "F", ".", "upsample", "(", "output4", ",", "scale_factor", "=", "2", ",", "mode", "=", "\"bilinear\"", ")", "\n", "output4", "=", "self", ".", "refine", "(", "output4", "+", "self", ".", "tran", "(", "lowlevel_feature", ")", ")", "\n", "\n", "pred4", "=", "self", ".", "pred4", "(", "F", ".", "upsample", "(", "output4", ",", "scale_factor", "=", "2", ",", "mode", "=", "\"bilinear\"", ")", ")", "\n", "\n", "\n", "return", "pred0", ",", "pred1", ",", "pred2", ",", "pred3", ",", "pred4", "\n", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.FocalFuseAttention.__init__": [[9, 13], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "utils.CALayer"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ")", ":", "\n", "        ", "super", "(", "FocalFuseAttention", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "channel_fuse", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "in_channels", ",", "out_channels", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "self", ".", "se", "=", "CALayer", "(", "channel", "=", "in_channels", ",", "reduction", "=", "in_channels", "//", "8", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.FocalFuseAttention.forward": [[14, 21], ["decoder.FocalFuseAttention.channel_fuse", "torch.softmax", "torch.softmax", "torch.softmax", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum().unsqueeze", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.sum"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "fuse", "=", "self", ".", "channel_fuse", "(", "input", ")", "\n", "fuse_attention", "=", "F", ".", "softmax", "(", "fuse", ",", "dim", "=", "0", ")", "\n", "output", "=", "input", "*", "fuse_attention", "\n", "output", "=", "torch", ".", "sum", "(", "output", ",", "dim", "=", "0", ")", ".", "unsqueeze", "(", "0", ")", "\n", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.decoder_module.__init__": [[25, 49], ["torch.Module.__init__", "utils.BasicConv2d", "utils.BasicConv2d", "decoder.FocalFuseAttention", "utils.BasicConv2d", "utils.BasicConv2d", "decoder.FocalGuidedRefine", "non_local.NONLocalBlock2D"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "nl", "=", "False", ",", "refine", "=", "False", ")", ":", "\n", "        ", "super", "(", "decoder_module", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "rgb_skip", "=", "BasicConv2d", "(", "in_planes", "=", "in_channels", ",", "out_planes", "=", "out_channels", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ")", "\n", "self", ".", "focal_skip", "=", "BasicConv2d", "(", "in_planes", "=", "in_channels", ",", "out_planes", "=", "out_channels", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ")", "\n", "\n", "self", ".", "focal_fuse", "=", "FocalFuseAttention", "(", "in_channels", "=", "out_channels", ")", "\n", "\n", "if", "refine", "is", "True", ":", "\n", "\n", "            ", "self", ".", "rgb_refine", "=", "FocalGuidedRefine", "(", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "rgb_refine", "=", "None", "\n", "\n", "", "if", "nl", "is", "True", ":", "\n", "            ", "self", ".", "nl", "=", "NONLocalBlock2D", "(", "in_channels", "=", "out_channels", ",", "inter_channels", "=", "out_channels", "//", "4", ",", "sub_sample", "=", "False", ",", "bn_layer", "=", "True", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "nl", "=", "None", "\n", "\n", "", "self", ".", "decoding1", "=", "BasicConv2d", "(", "in_planes", "=", "3", "*", "out_channels", ",", "out_planes", "=", "out_channels", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ")", "\n", "\n", "self", ".", "decoding2", "=", "BasicConv2d", "(", "in_planes", "=", "out_channels", ",", "out_planes", "=", "out_channels", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.decoder_module.forward": [[50, 94], ["decoder.decoder_module.rgb_skip", "decoder.decoder_module.rgb_skip", "decoder.decoder_module.rgb_refine", "decoder.decoder_module.focal_fuse", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "decoder.decoder_module.decoding1", "decoder.decoder_module.decoding2", "decoder.decoder_module.rgb_skip", "decoder.decoder_module.rgb_skip", "decoder.decoder_module.focal_fuse", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "decoder.decoder_module.decoding1", "decoder.decoder_module.decoding2", "decoder.decoder_module.nl", "torch.upsample.size", "decoder.decoder_module.size", "torch.upsample", "torch.upsample", "torch.upsample", "decoder.decoder_module.nl", "torch.upsample.size", "decoder.decoder_module.size", "torch.upsample", "torch.upsample", "torch.upsample", "decoder.decoder_module.size", "decoder.decoder_module.size", "decoder.decoder_module.size", "decoder.decoder_module.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "rgb_enc_fea", ",", "focal_enc_fea", ",", "dec_fea", ")", ":", "\n", "\n", "        ", "if", "self", ".", "rgb_refine", "is", "not", "None", ":", "\n", "\n", "            ", "rgb_enc_fea", "=", "self", ".", "rgb_skip", "(", "rgb_enc_fea", ")", "\n", "focal_enc_fea", "=", "self", ".", "rgb_skip", "(", "focal_enc_fea", ")", "\n", "\n", "refine_rgb_feature", ",", "sim_matrix", "=", "self", ".", "rgb_refine", "(", "rgb_enc_fea", ",", "focal_enc_fea", ")", "\n", "\n", "if", "self", ".", "nl", "is", "not", "None", ":", "\n", "                ", "focal_enc_fea", "=", "self", ".", "nl", "(", "focal_enc_fea", ")", "\n", "", "focal_enc_fea", "=", "self", ".", "focal_fuse", "(", "focal_enc_fea", ")", "\n", "\n", "if", "dec_fea", ".", "size", "(", "2", ")", "!=", "rgb_enc_fea", ".", "size", "(", "2", ")", ":", "\n", "                ", "dec_fea", "=", "F", ".", "upsample", "(", "dec_fea", ",", "size", "=", "[", "rgb_enc_fea", ".", "size", "(", "2", ")", ",", "rgb_enc_fea", ".", "size", "(", "3", ")", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "", "dec_fea", "=", "torch", ".", "cat", "(", "[", "refine_rgb_feature", ",", "focal_enc_fea", ",", "dec_fea", "]", ",", "dim", "=", "1", ")", "\n", "\n", "output", "=", "self", ".", "decoding1", "(", "dec_fea", ")", "\n", "output", "=", "self", ".", "decoding2", "(", "output", ")", "\n", "\n", "return", "output", ",", "sim_matrix", "\n", "\n", "\n", "", "else", ":", "\n", "\n", "            ", "rgb_enc_fea", "=", "self", ".", "rgb_skip", "(", "rgb_enc_fea", ")", "\n", "focal_enc_fea", "=", "self", ".", "rgb_skip", "(", "focal_enc_fea", ")", "\n", "\n", "\n", "if", "self", ".", "nl", "is", "not", "None", ":", "\n", "                ", "focal_enc_fea", "=", "self", ".", "nl", "(", "focal_enc_fea", ")", "\n", "", "focal_enc_fea", "=", "self", ".", "focal_fuse", "(", "focal_enc_fea", ")", "\n", "\n", "if", "dec_fea", ".", "size", "(", "2", ")", "!=", "rgb_enc_fea", ".", "size", "(", "2", ")", ":", "\n", "                ", "dec_fea", "=", "F", ".", "upsample", "(", "dec_fea", ",", "size", "=", "[", "rgb_enc_fea", ".", "size", "(", "2", ")", ",", "rgb_enc_fea", ".", "size", "(", "3", ")", "]", ",", "mode", "=", "'bilinear'", ",", "\n", "align_corners", "=", "True", ")", "\n", "\n", "", "dec_fea", "=", "torch", ".", "cat", "(", "[", "rgb_enc_fea", ",", "focal_enc_fea", ",", "dec_fea", "]", ",", "dim", "=", "1", ")", "\n", "\n", "output", "=", "self", ".", "decoding1", "(", "dec_fea", ")", "\n", "output", "=", "self", ".", "decoding2", "(", "output", ")", "\n", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.FocalGuidedRefine.__init__": [[97, 106], ["torch.Module.__init__", "convgru.ConvGRUCell", "utils.BasicConv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "FocalGuidedRefine", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gru", "=", "ConvGRUCell", "(", "input_channels", "=", "64", ",", "hidden_channels", "=", "64", ",", "kernel_size", "=", "3", ")", "\n", "self", ".", "fuse", "=", "BasicConv2d", "(", "in_planes", "=", "128", ",", "out_planes", "=", "64", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "interchannel", "=", "8", "\n", "self", ".", "g", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "self", ".", "interchannel", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ")", ",", "\n", "nn", ".", "ReLU", "(", ")", ",", "\n", "nn", ".", "Conv2d", "(", "in_channels", "=", "self", ".", "interchannel", ",", "out_channels", "=", "self", ".", "interchannel", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.FocalGuidedRefine.forward": [[108, 126], ["range", "decoder.FocalGuidedRefine.g", "refine_rgb.view.view.view", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "torch.matmul", "decoder.FocalGuidedRefine.fuse", "decoder.FocalGuidedRefine.gru", "refine_rgb.view.view.permute", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "rgb_feature", ",", "focal_features", ")", ":", "\n", "        ", "focal_name", "=", "focal_features", ".", "shape", "[", "0", "]", "\n", "\n", "hidden", "=", "None", "\n", "for", "i", "in", "range", "(", "focal_name", ")", ":", "\n", "            ", "focal_fea", "=", "focal_features", "[", "i", ":", "i", "+", "1", ",", ":", ",", ":", ",", ":", "]", "\n", "rgb_focal_fuse", "=", "self", ".", "fuse", "(", "torch", ".", "cat", "(", "(", "focal_fea", ",", "rgb_feature", ")", ",", "dim", "=", "1", ")", ")", "\n", "\n", "hidden", "=", "self", ".", "gru", "(", "rgb_focal_fuse", ",", "hidden", ")", "\n", "\n", "\n", "", "refine_rgb", "=", "hidden", "\n", "refine_rgb", "=", "self", ".", "g", "(", "refine_rgb", ")", "\n", "refine_rgb", "=", "refine_rgb", ".", "view", "(", "1", ",", "self", ".", "interchannel", ",", "-", "1", ")", "\n", "\n", "sim_matrix", "=", "torch", ".", "matmul", "(", "refine_rgb", ".", "permute", "(", "0", ",", "2", ",", "1", ")", ",", "refine_rgb", ")", "\n", "\n", "return", "hidden", ",", "sim_matrix", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.Decoder.__init__": [[138, 151], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "decoder.decoder_module", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "decoder.decoder_module", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "decoder.decoder_module", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Decoder", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "predict5", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "decoder4", "=", "decoder_module", "(", "512", ",", "64", ",", "nl", "=", "True", ",", "refine", "=", "False", ")", "\n", "self", ".", "predict4", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "decoder3", "=", "decoder_module", "(", "256", ",", "64", ",", "nl", "=", "True", ",", "refine", "=", "False", ")", "\n", "self", ".", "predict3", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "decoder2", "=", "decoder_module", "(", "128", ",", "64", ",", "nl", "=", "True", ",", "refine", "=", "True", ")", "\n", "self", ".", "predict2", "=", "nn", ".", "Conv2d", "(", "in_channels", "=", "64", ",", "out_channels", "=", "1", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.decoder.Decoder.forward": [[153, 175], ["decoder.Decoder.predict5", "torch.upsample", "torch.upsample", "torch.upsample", "decoder.Decoder.decoder4", "decoder.Decoder.predict4", "torch.upsample", "torch.upsample", "torch.upsample", "decoder.Decoder.decoder3", "decoder.Decoder.predict3", "torch.upsample", "torch.upsample", "torch.upsample", "decoder.Decoder.decoder2", "decoder.Decoder.predict2", "torch.upsample", "torch.upsample", "torch.upsample"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "afterfuse", ",", "rgb_for_decoder", ",", "focal_for_decoder", ")", ":", "\n", "\n", "        ", "rgb_encoder_conv4", ",", "rgb_encoder_conv3", ",", "rgb_encoder_conv2", ",", "rgb_encoder_conv1", "=", "rgb_for_decoder", "\n", "focal_encoder_conv4", ",", "focal_encoder_conv3", ",", "focal_encoder_conv2", ",", "focal_encoder_conv1", "=", "focal_for_decoder", "\n", "\n", "pred5", "=", "self", ".", "predict5", "(", "afterfuse", ")", "\n", "pred5", "=", "F", ".", "upsample", "(", "pred5", ",", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "dec_4", "=", "self", ".", "decoder4", "(", "rgb_encoder_conv4", ",", "focal_encoder_conv4", ",", "afterfuse", ")", "\n", "pred4", "=", "self", ".", "predict4", "(", "dec_4", ")", "\n", "pred4", "=", "F", ".", "upsample", "(", "pred4", ",", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "dec_3", "=", "self", ".", "decoder3", "(", "rgb_encoder_conv3", ",", "focal_encoder_conv3", ",", "dec_4", ")", "\n", "pred3", "=", "self", ".", "predict3", "(", "dec_3", ")", "\n", "pred3", "=", "F", ".", "upsample", "(", "pred3", ",", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "dec_2", ",", "sim", "=", "self", ".", "decoder2", "(", "rgb_encoder_conv2", ",", "focal_encoder_conv2", ",", "dec_3", ")", "\n", "pred2", "=", "self", ".", "predict2", "(", "dec_2", ")", "\n", "pred2", "=", "F", ".", "upsample", "(", "pred2", ",", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "\n", "return", "[", "pred2", ",", "pred3", ",", "pred4", ",", "pred5", "]", ",", "sim", "", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.utils.BasicConv2d.__init__": [[7, 14], ["torch.nn.Module.__init__", "torch.nn.Conv2d", "torch.nn.BatchNorm2d", "torch.nn.ReLU"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_planes", ",", "out_planes", ",", "kernel_size", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "dilation", "=", "1", ")", ":", "\n", "        ", "super", "(", "BasicConv2d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv", "=", "nn", ".", "Conv2d", "(", "in_planes", ",", "out_planes", ",", "\n", "kernel_size", "=", "kernel_size", ",", "stride", "=", "stride", ",", "\n", "padding", "=", "padding", ",", "dilation", "=", "dilation", ",", "bias", "=", "False", ")", "\n", "self", ".", "bn", "=", "nn", ".", "BatchNorm2d", "(", "out_planes", ")", "\n", "self", ".", "relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.utils.BasicConv2d.forward": [[15, 20], ["utils.BasicConv2d.conv", "utils.BasicConv2d.bn", "utils.BasicConv2d.relu"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "conv", "(", "x", ")", "\n", "x", "=", "self", ".", "bn", "(", "x", ")", "\n", "x", "=", "self", ".", "relu", "(", "x", ")", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.utils.decoder_module.__init__": [[23, 33], ["torch.nn.Module.__init__", "utils.BasicConv2d", "utils.BasicConv2d", "utils.BasicConv2d"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ")", ":", "\n", "        ", "super", "(", "decoder_module", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "skip", "=", "BasicConv2d", "(", "in_planes", "=", "in_channels", ",", "out_planes", "=", "out_channels", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ")", "\n", "\n", "self", ".", "decoding1", "=", "BasicConv2d", "(", "in_planes", "=", "2", "*", "out_channels", ",", "out_planes", "=", "out_channels", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ")", "\n", "\n", "self", ".", "decoding2", "=", "BasicConv2d", "(", "in_planes", "=", "out_channels", ",", "out_planes", "=", "out_channels", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "\n", "padding", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.utils.decoder_module.forward": [[34, 46], ["utils.decoder_module.skip", "torch.cat", "utils.decoder_module.decoding1", "utils.decoder_module.decoding2", "torch.nn.functional.upsample.size", "utils.decoder_module.size", "torch.nn.functional.upsample", "utils.decoder_module.size", "utils.decoder_module.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "enc_fea", ",", "dec_fea", ")", ":", "\n", "        ", "enc_fea", "=", "self", ".", "skip", "(", "enc_fea", ")", "\n", "\n", "if", "dec_fea", ".", "size", "(", "2", ")", "!=", "enc_fea", ".", "size", "(", "2", ")", ":", "\n", "            ", "dec_fea", "=", "F", ".", "upsample", "(", "dec_fea", ",", "size", "=", "[", "enc_fea", ".", "size", "(", "2", ")", ",", "enc_fea", ".", "size", "(", "3", ")", "]", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "", "dec_fea", "=", "torch", ".", "cat", "(", "[", "enc_fea", ",", "dec_fea", "]", ",", "dim", "=", "1", ")", "\n", "\n", "output", "=", "self", ".", "decoding1", "(", "dec_fea", ")", "\n", "output", "=", "self", ".", "decoding2", "(", "output", ")", "\n", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.utils.CALayer.__init__": [[49, 59], ["torch.nn.Module.__init__", "torch.nn.AdaptiveAvgPool2d", "torch.nn.Sequential", "torch.nn.Conv2d", "torch.nn.ReLU", "torch.nn.Conv2d", "torch.nn.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "reduction", "=", "8", ")", ":", "\n", "        ", "super", "(", "CALayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# global average pooling: feature --> point", "\n", "self", ".", "avg_pool", "=", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", "\n", "# feature channel downscale and upscale --> channel weight", "\n", "self", ".", "conv_du", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Conv2d", "(", "channel", ",", "channel", "//", "reduction", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", "\n", "nn", ".", "Conv2d", "(", "channel", "//", "reduction", ",", "channel", ",", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.utils.CALayer.forward": [[61, 65], ["utils.CALayer.avg_pool", "utils.CALayer.conv_du"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "y", "=", "self", ".", "avg_pool", "(", "x", ")", "\n", "y", "=", "self", ".", "conv_du", "(", "y", ")", "\n", "return", "x", "*", "y", "\n", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.FocalNet.__init__": [[23, 98], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "backbone.FocalNet._initialize_weights"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__", "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet._initialize_weights"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "FocalNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "# conv1", "\n", "self", ".", "conv1_1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn1_1", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu1_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv1_2", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn1_2", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu1_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool1", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/2    2 layers", "\n", "\n", "# conv2", "\n", "self", ".", "conv2_1", "=", "nn", ".", "Conv2d", "(", "64", ",", "128", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn2_1", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu2_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv2_2", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn2_2", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu2_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool2", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/4   2 layers", "\n", "\n", "# conv3", "\n", "self", ".", "conv3_1", "=", "nn", ".", "Conv2d", "(", "128", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_1", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv3_2", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_2", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv3_3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_3", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_3", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv3_4", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_4", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_4", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool3", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/8   4 layers", "\n", "\n", "# conv4", "\n", "self", ".", "conv4_1", "=", "nn", ".", "Conv2d", "(", "256", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_1", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv4_2", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_2", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv4_3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_3", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_3", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv4_4", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_4", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_4", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool4", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/16      4 layers", "\n", "\n", "# conv5", "\n", "self", ".", "conv5_1", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_1", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv5_2", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_2", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv5_3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_3", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_3", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv5_4", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_4", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_4", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "# 1/32    4 layers", "\n", "\n", "# conv5 add", "\n", "self", ".", "conv5_c", "=", "nn", ".", "Conv2d", "(", "512", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "# conv4 add", "\n", "self", ".", "conv4_c", "=", "nn", ".", "Conv2d", "(", "512", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "# conv3 add", "\n", "self", ".", "conv3_c", "=", "nn", ".", "Conv2d", "(", "256", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "_initialize_weights", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.FocalNet._initialize_weights": [[99, 110], ["backbone.FocalNet.modules", "isinstance", "isinstance", "torch.init.normal", "torch.init.normal", "torch.init.normal", "backbone.get_upsampling_weight", "m.weight.data.copy_", "m.bias.data.zero_"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.get_upsampling_weight"], ["", "def", "_initialize_weights", "(", "self", ")", ":", "\n", "        ", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "# m.weight.data.zero_()", "\n", "                ", "nn", ".", "init", ".", "normal", "(", "m", ".", "weight", ".", "data", ",", "std", "=", "0.01", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "", "", "if", "isinstance", "(", "m", ",", "nn", ".", "ConvTranspose2d", ")", ":", "\n", "                ", "assert", "m", ".", "kernel_size", "[", "0", "]", "==", "m", ".", "kernel_size", "[", "1", "]", "\n", "initial_weight", "=", "get_upsampling_weight", "(", "m", ".", "in_channels", ",", "m", ".", "out_channels", ",", "m", ".", "kernel_size", "[", "0", "]", ")", "\n", "m", ".", "weight", ".", "data", ".", "copy_", "(", "initial_weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.FocalNet.forward": [[111, 159], ["backbone.FocalNet.relu1_1", "backbone.FocalNet.relu1_2", "backbone.FocalNet.pool1", "backbone.FocalNet.relu2_1", "backbone.FocalNet.relu2_2", "backbone.FocalNet.pool2", "backbone.FocalNet.relu3_1", "backbone.FocalNet.relu3_2", "backbone.FocalNet.relu3_3", "backbone.FocalNet.relu3_4", "backbone.FocalNet.pool3", "backbone.FocalNet.relu4_1", "backbone.FocalNet.relu4_2", "backbone.FocalNet.relu4_3", "backbone.FocalNet.relu4_4", "backbone.FocalNet.pool4", "backbone.FocalNet.relu5_1", "backbone.FocalNet.relu5_2", "backbone.FocalNet.relu5_3", "backbone.FocalNet.relu5_4", "backbone.FocalNet.conv5_c", "torch.upsample", "torch.upsample", "torch.upsample", "backbone.FocalNet.conv4_c", "torch.upsample", "torch.upsample", "torch.upsample", "backbone.FocalNet.conv3_c", "backbone.FocalNet.bn1_1", "backbone.FocalNet.bn1_2", "backbone.FocalNet.bn2_1", "backbone.FocalNet.bn2_2", "backbone.FocalNet.bn3_1", "backbone.FocalNet.bn3_2", "backbone.FocalNet.bn3_3", "backbone.FocalNet.bn3_4", "backbone.FocalNet.bn4_1", "backbone.FocalNet.bn4_2", "backbone.FocalNet.bn4_3", "backbone.FocalNet.bn4_4", "backbone.FocalNet.bn5_1", "backbone.FocalNet.bn5_2", "backbone.FocalNet.bn5_3", "backbone.FocalNet.bn5_4", "backbone.FocalNet.conv1_1", "backbone.FocalNet.conv1_2", "backbone.FocalNet.conv2_1", "backbone.FocalNet.conv2_2", "backbone.FocalNet.conv3_1", "backbone.FocalNet.conv3_2", "backbone.FocalNet.conv3_3", "backbone.FocalNet.conv3_4", "backbone.FocalNet.conv4_1", "backbone.FocalNet.conv4_2", "backbone.FocalNet.conv4_3", "backbone.FocalNet.conv4_4", "backbone.FocalNet.conv5_1", "backbone.FocalNet.conv5_2", "backbone.FocalNet.conv5_3", "backbone.FocalNet.conv5_4"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "h", "=", "x", "\n", "\n", "h", "=", "self", ".", "relu1_1", "(", "self", ".", "bn1_1", "(", "self", ".", "conv1_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu1_2", "(", "self", ".", "bn1_2", "(", "self", ".", "conv1_2", "(", "h", ")", ")", ")", "\n", "h_nopool1", "=", "h", "\n", "h", "=", "self", ".", "pool1", "(", "h", ")", "\n", "# pool1 = h", "\n", "\n", "\n", "h", "=", "self", ".", "relu2_1", "(", "self", ".", "bn2_1", "(", "self", ".", "conv2_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu2_2", "(", "self", ".", "bn2_2", "(", "self", ".", "conv2_2", "(", "h", ")", ")", ")", "\n", "h_nopool2", "=", "h", "\n", "h", "=", "self", ".", "pool2", "(", "h", ")", "\n", "# pool2 = h", "\n", "\n", "h", "=", "self", ".", "relu3_1", "(", "self", ".", "bn3_1", "(", "self", ".", "conv3_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu3_2", "(", "self", ".", "bn3_2", "(", "self", ".", "conv3_2", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu3_3", "(", "self", ".", "bn3_3", "(", "self", ".", "conv3_3", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu3_4", "(", "self", ".", "bn3_4", "(", "self", ".", "conv3_4", "(", "h", ")", ")", ")", "\n", "h_nopool3", "=", "h", "\n", "h", "=", "self", ".", "pool3", "(", "h", ")", "\n", "# pool3 = h", "\n", "\n", "h", "=", "self", ".", "relu4_1", "(", "self", ".", "bn4_1", "(", "self", ".", "conv4_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu4_2", "(", "self", ".", "bn4_2", "(", "self", ".", "conv4_2", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu4_3", "(", "self", ".", "bn4_3", "(", "self", ".", "conv4_3", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu4_4", "(", "self", ".", "bn4_4", "(", "self", ".", "conv4_4", "(", "h", ")", ")", ")", "\n", "h_nopool4", "=", "h", "\n", "h", "=", "self", ".", "pool4", "(", "h", ")", "\n", "\n", "h", "=", "self", ".", "relu5_1", "(", "self", ".", "bn5_1", "(", "self", ".", "conv5_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu5_2", "(", "self", ".", "bn5_2", "(", "self", ".", "conv5_2", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu5_3", "(", "self", ".", "bn5_3", "(", "self", ".", "conv5_3", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu5_4", "(", "self", ".", "bn5_4", "(", "self", ".", "conv5_4", "(", "h", ")", ")", ")", "\n", "\n", "# conv5, conv4 add", "\n", "h", "=", "self", ".", "conv5_c", "(", "h", ")", "\n", "h", "=", "F", ".", "upsample", "(", "h", ",", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "\n", "h_nopool4", "=", "self", ".", "conv4_c", "(", "h_nopool4", ")", "\n", "h", "=", "h", "+", "h_nopool4", "\n", "\n", "# conv4, conv3 add", "\n", "h", "=", "F", ".", "upsample", "(", "h", ",", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "\n", "h_nopool3", "=", "self", ".", "conv3_c", "(", "h_nopool3", ")", "\n", "h", "=", "h", "+", "h_nopool3", "\n", "\n", "return", "h", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.FocalNet.copy_params_from_vgg19_bn_focal": [[161, 197], ["zip", "isinstance", "isinstance", "isinstance", "isinstance", "l1.weight.size", "l2.weight.size", "l1.bias.size", "l2.bias.size", "l1.weight.size", "l2.weight.size", "l1.bias.size", "l2.bias.size"], "methods", ["None"], ["", "def", "copy_params_from_vgg19_bn_focal", "(", "self", ",", "vgg19_bn", ")", ":", "\n", "        ", "features", "=", "[", "\n", "self", ".", "conv1_1", ",", "self", ".", "bn1_1", ",", "self", ".", "relu1_1", ",", "\n", "self", ".", "conv1_2", ",", "self", ".", "bn1_2", ",", "self", ".", "relu1_2", ",", "\n", "self", ".", "pool1", ",", "\n", "self", ".", "conv2_1", ",", "self", ".", "bn2_1", ",", "self", ".", "relu2_1", ",", "\n", "self", ".", "conv2_2", ",", "self", ".", "bn2_2", ",", "self", ".", "relu2_2", ",", "\n", "self", ".", "pool2", ",", "\n", "self", ".", "conv3_1", ",", "self", ".", "bn3_1", ",", "self", ".", "relu3_1", ",", "\n", "self", ".", "conv3_2", ",", "self", ".", "bn3_2", ",", "self", ".", "relu3_2", ",", "\n", "self", ".", "conv3_3", ",", "self", ".", "bn3_3", ",", "self", ".", "relu3_3", ",", "\n", "self", ".", "conv3_4", ",", "self", ".", "bn3_4", ",", "self", ".", "relu3_4", ",", "\n", "self", ".", "pool3", ",", "\n", "self", ".", "conv4_1", ",", "self", ".", "bn4_1", ",", "self", ".", "relu4_1", ",", "\n", "self", ".", "conv4_2", ",", "self", ".", "bn4_2", ",", "self", ".", "relu4_2", ",", "\n", "self", ".", "conv4_3", ",", "self", ".", "bn4_3", ",", "self", ".", "relu4_3", ",", "\n", "self", ".", "conv4_4", ",", "self", ".", "bn4_4", ",", "self", ".", "relu4_4", ",", "\n", "self", ".", "pool4", ",", "\n", "self", ".", "conv5_1", ",", "self", ".", "bn5_1", ",", "self", ".", "relu5_1", ",", "\n", "self", ".", "conv5_2", ",", "self", ".", "bn5_2", ",", "self", ".", "relu5_2", ",", "\n", "self", ".", "conv5_3", ",", "self", ".", "bn5_3", ",", "self", ".", "relu5_3", ",", "\n", "self", ".", "conv5_4", ",", "self", ".", "bn5_4", ",", "self", ".", "relu5_4", ",", "\n", "# self.conv6,", "\n", "# self.conv7,", "\n", "]", "\n", "for", "l1", ",", "l2", "in", "zip", "(", "vgg19_bn", ".", "features", ",", "features", ")", ":", "\n", "            ", "if", "isinstance", "(", "l1", ",", "nn", ".", "Conv2d", ")", "and", "isinstance", "(", "l2", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "assert", "l1", ".", "weight", ".", "size", "(", ")", "==", "l2", ".", "weight", ".", "size", "(", ")", "\n", "assert", "l1", ".", "bias", ".", "size", "(", ")", "==", "l2", ".", "bias", ".", "size", "(", ")", "\n", "l2", ".", "weight", ".", "data", "=", "l1", ".", "weight", ".", "data", "\n", "l2", ".", "bias", ".", "data", "=", "l1", ".", "bias", ".", "data", "\n", "", "if", "isinstance", "(", "l1", ",", "nn", ".", "BatchNorm2d", ")", "and", "isinstance", "(", "l2", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "assert", "l1", ".", "weight", ".", "size", "(", ")", "==", "l2", ".", "weight", ".", "size", "(", ")", "\n", "assert", "l1", ".", "bias", ".", "size", "(", ")", "==", "l2", ".", "bias", ".", "size", "(", ")", "\n", "l2", ".", "weight", ".", "data", "=", "l1", ".", "weight", ".", "data", "\n", "l2", ".", "bias", ".", "data", "=", "l1", ".", "bias", ".", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__": [[200, 274], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "backbone.RGBNet._initialize_weights"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.__init__", "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet._initialize_weights"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "RGBNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# conv1", "\n", "self", ".", "conv1_1", "=", "nn", ".", "Conv2d", "(", "3", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn1_1", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu1_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv1_2", "=", "nn", ".", "Conv2d", "(", "64", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn1_2", "=", "nn", ".", "BatchNorm2d", "(", "64", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu1_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool1", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/2    2 layers", "\n", "\n", "# conv2", "\n", "self", ".", "conv2_1", "=", "nn", ".", "Conv2d", "(", "64", ",", "128", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn2_1", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu2_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv2_2", "=", "nn", ".", "Conv2d", "(", "128", ",", "128", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn2_2", "=", "nn", ".", "BatchNorm2d", "(", "128", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu2_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool2", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/4   2 layers", "\n", "\n", "# conv3", "\n", "self", ".", "conv3_1", "=", "nn", ".", "Conv2d", "(", "128", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_1", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv3_2", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_2", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv3_3", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_3", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_3", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv3_4", "=", "nn", ".", "Conv2d", "(", "256", ",", "256", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn3_4", "=", "nn", ".", "BatchNorm2d", "(", "256", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu3_4", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool3", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/8   4 layers", "\n", "\n", "# conv4", "\n", "self", ".", "conv4_1", "=", "nn", ".", "Conv2d", "(", "256", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_1", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv4_2", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_2", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv4_3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_3", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_3", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv4_4", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn4_4", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu4_4", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "pool4", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "stride", "=", "2", ",", "ceil_mode", "=", "True", ")", "# 1/16      4 layers", "\n", "\n", "# conv5", "\n", "self", ".", "conv5_1", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_1", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv5_2", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_2", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_2", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv5_3", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_3", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_3", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "self", ".", "conv5_4", "=", "nn", ".", "Conv2d", "(", "512", ",", "512", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "bn5_4", "=", "nn", ".", "BatchNorm2d", "(", "512", ",", "eps", "=", "1e-05", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ")", "\n", "self", ".", "relu5_4", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "# 1/32    4 layers", "\n", "\n", "# conv5 add", "\n", "self", ".", "conv5_c", "=", "nn", ".", "Conv2d", "(", "512", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "# conv4 add", "\n", "self", ".", "conv4_c", "=", "nn", ".", "Conv2d", "(", "512", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "# conv3 add", "\n", "self", ".", "conv3_c", "=", "nn", ".", "Conv2d", "(", "256", ",", "64", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "_initialize_weights", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet._initialize_weights": [[275, 286], ["backbone.RGBNet.modules", "isinstance", "isinstance", "torch.init.normal", "torch.init.normal", "torch.init.normal", "backbone.get_upsampling_weight", "m.weight.data.copy_", "m.bias.data.zero_"], "methods", ["home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.get_upsampling_weight"], ["", "def", "_initialize_weights", "(", "self", ")", ":", "\n", "        ", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "# m.weight.data.zero_()", "\n", "                ", "nn", ".", "init", ".", "normal", "(", "m", ".", "weight", ".", "data", ",", "std", "=", "0.01", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                    ", "m", ".", "bias", ".", "data", ".", "zero_", "(", ")", "\n", "", "", "if", "isinstance", "(", "m", ",", "nn", ".", "ConvTranspose2d", ")", ":", "\n", "                ", "assert", "m", ".", "kernel_size", "[", "0", "]", "==", "m", ".", "kernel_size", "[", "1", "]", "\n", "initial_weight", "=", "get_upsampling_weight", "(", "m", ".", "in_channels", ",", "m", ".", "out_channels", ",", "m", ".", "kernel_size", "[", "0", "]", ")", "\n", "m", ".", "weight", ".", "data", ".", "copy_", "(", "initial_weight", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.forward": [[287, 336], ["backbone.RGBNet.relu1_1", "backbone.RGBNet.relu1_2", "backbone.RGBNet.pool1", "backbone.RGBNet.relu2_1", "backbone.RGBNet.relu2_2", "backbone.RGBNet.pool2", "backbone.RGBNet.relu3_1", "backbone.RGBNet.relu3_2", "backbone.RGBNet.relu3_3", "backbone.RGBNet.relu3_4", "backbone.RGBNet.pool3", "backbone.RGBNet.relu4_1", "backbone.RGBNet.relu4_2", "backbone.RGBNet.relu4_3", "backbone.RGBNet.relu4_4", "backbone.RGBNet.pool4", "backbone.RGBNet.relu5_1", "backbone.RGBNet.relu5_2", "backbone.RGBNet.relu5_3", "backbone.RGBNet.relu5_4", "backbone.RGBNet.conv5_c", "torch.upsample", "torch.upsample", "torch.upsample", "backbone.RGBNet.conv4_c", "torch.upsample", "torch.upsample", "torch.upsample", "backbone.RGBNet.conv3_c", "backbone.RGBNet.bn1_1", "backbone.RGBNet.bn1_2", "backbone.RGBNet.bn2_1", "backbone.RGBNet.bn2_2", "backbone.RGBNet.bn3_1", "backbone.RGBNet.bn3_2", "backbone.RGBNet.bn3_3", "backbone.RGBNet.bn3_4", "backbone.RGBNet.bn4_1", "backbone.RGBNet.bn4_2", "backbone.RGBNet.bn4_3", "backbone.RGBNet.bn4_4", "backbone.RGBNet.bn5_1", "backbone.RGBNet.bn5_2", "backbone.RGBNet.bn5_3", "backbone.RGBNet.bn5_4", "backbone.RGBNet.conv1_1", "backbone.RGBNet.conv1_2", "backbone.RGBNet.conv2_1", "backbone.RGBNet.conv2_2", "backbone.RGBNet.conv3_1", "backbone.RGBNet.conv3_2", "backbone.RGBNet.conv3_3", "backbone.RGBNet.conv3_4", "backbone.RGBNet.conv4_1", "backbone.RGBNet.conv4_2", "backbone.RGBNet.conv4_3", "backbone.RGBNet.conv4_4", "backbone.RGBNet.conv5_1", "backbone.RGBNet.conv5_2", "backbone.RGBNet.conv5_3", "backbone.RGBNet.conv5_4"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "h", "=", "x", "\n", "\n", "h", "=", "self", ".", "relu1_1", "(", "self", ".", "bn1_1", "(", "self", ".", "conv1_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu1_2", "(", "self", ".", "bn1_2", "(", "self", ".", "conv1_2", "(", "h", ")", ")", ")", "\n", "h_nopool1", "=", "h", "\n", "h", "=", "self", ".", "pool1", "(", "h", ")", "\n", "# pool1 = h", "\n", "lowlevel_feature", "=", "h", "\n", "\n", "h", "=", "self", ".", "relu2_1", "(", "self", ".", "bn2_1", "(", "self", ".", "conv2_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu2_2", "(", "self", ".", "bn2_2", "(", "self", ".", "conv2_2", "(", "h", ")", ")", ")", "\n", "h_nopool2", "=", "h", "\n", "h", "=", "self", ".", "pool2", "(", "h", ")", "\n", "# pool2 = h", "\n", "\n", "h", "=", "self", ".", "relu3_1", "(", "self", ".", "bn3_1", "(", "self", ".", "conv3_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu3_2", "(", "self", ".", "bn3_2", "(", "self", ".", "conv3_2", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu3_3", "(", "self", ".", "bn3_3", "(", "self", ".", "conv3_3", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu3_4", "(", "self", ".", "bn3_4", "(", "self", ".", "conv3_4", "(", "h", ")", ")", ")", "\n", "h_nopool3", "=", "h", "\n", "h", "=", "self", ".", "pool3", "(", "h", ")", "\n", "# pool3 = h", "\n", "\n", "h", "=", "self", ".", "relu4_1", "(", "self", ".", "bn4_1", "(", "self", ".", "conv4_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu4_2", "(", "self", ".", "bn4_2", "(", "self", ".", "conv4_2", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu4_3", "(", "self", ".", "bn4_3", "(", "self", ".", "conv4_3", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu4_4", "(", "self", ".", "bn4_4", "(", "self", ".", "conv4_4", "(", "h", ")", ")", ")", "\n", "h_nopool4", "=", "h", "\n", "h", "=", "self", ".", "pool4", "(", "h", ")", "\n", "\n", "h", "=", "self", ".", "relu5_1", "(", "self", ".", "bn5_1", "(", "self", ".", "conv5_1", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu5_2", "(", "self", ".", "bn5_2", "(", "self", ".", "conv5_2", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu5_3", "(", "self", ".", "bn5_3", "(", "self", ".", "conv5_3", "(", "h", ")", ")", ")", "\n", "h", "=", "self", ".", "relu5_4", "(", "self", ".", "bn5_4", "(", "self", ".", "conv5_4", "(", "h", ")", ")", ")", "\n", "\n", "# conv5, conv4 add", "\n", "h", "=", "self", ".", "conv5_c", "(", "h", ")", "\n", "h", "=", "F", ".", "upsample", "(", "h", ",", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "\n", "h_nopool4", "=", "self", ".", "conv4_c", "(", "h_nopool4", ")", "\n", "h", "=", "h", "+", "h_nopool4", "\n", "\n", "# conv4, conv3 add", "\n", "h", "=", "F", ".", "upsample", "(", "h", ",", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "\n", "h_nopool3", "=", "self", ".", "conv3_c", "(", "h_nopool3", ")", "\n", "h", "=", "h", "+", "h_nopool3", "\n", "\n", "\n", "return", "lowlevel_feature", ",", "h", "\n", "\n"]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.RGBNet.copy_params_from_vgg19_bn": [[338, 374], ["zip", "isinstance", "isinstance", "isinstance", "isinstance", "l1.weight.size", "l2.weight.size", "l1.bias.size", "l2.bias.size", "l1.weight.size", "l2.weight.size", "l1.bias.size", "l2.bias.size"], "methods", ["None"], ["", "def", "copy_params_from_vgg19_bn", "(", "self", ",", "vgg19_bn", ")", ":", "\n", "        ", "features", "=", "[", "\n", "self", ".", "conv1_1", ",", "self", ".", "bn1_1", ",", "self", ".", "relu1_1", ",", "\n", "self", ".", "conv1_2", ",", "self", ".", "bn1_2", ",", "self", ".", "relu1_2", ",", "\n", "self", ".", "pool1", ",", "\n", "self", ".", "conv2_1", ",", "self", ".", "bn2_1", ",", "self", ".", "relu2_1", ",", "\n", "self", ".", "conv2_2", ",", "self", ".", "bn2_2", ",", "self", ".", "relu2_2", ",", "\n", "self", ".", "pool2", ",", "\n", "self", ".", "conv3_1", ",", "self", ".", "bn3_1", ",", "self", ".", "relu3_1", ",", "\n", "self", ".", "conv3_2", ",", "self", ".", "bn3_2", ",", "self", ".", "relu3_2", ",", "\n", "self", ".", "conv3_3", ",", "self", ".", "bn3_3", ",", "self", ".", "relu3_3", ",", "\n", "self", ".", "conv3_4", ",", "self", ".", "bn3_4", ",", "self", ".", "relu3_4", ",", "\n", "self", ".", "pool3", ",", "\n", "self", ".", "conv4_1", ",", "self", ".", "bn4_1", ",", "self", ".", "relu4_1", ",", "\n", "self", ".", "conv4_2", ",", "self", ".", "bn4_2", ",", "self", ".", "relu4_2", ",", "\n", "self", ".", "conv4_3", ",", "self", ".", "bn4_3", ",", "self", ".", "relu4_3", ",", "\n", "self", ".", "conv4_4", ",", "self", ".", "bn4_4", ",", "self", ".", "relu4_4", ",", "\n", "self", ".", "pool4", ",", "\n", "self", ".", "conv5_1", ",", "self", ".", "bn5_1", ",", "self", ".", "relu5_1", ",", "\n", "self", ".", "conv5_2", ",", "self", ".", "bn5_2", ",", "self", ".", "relu5_2", ",", "\n", "self", ".", "conv5_3", ",", "self", ".", "bn5_3", ",", "self", ".", "relu5_3", ",", "\n", "self", ".", "conv5_4", ",", "self", ".", "bn5_4", ",", "self", ".", "relu5_4", ",", "\n", "# self.conv6,", "\n", "# self.conv7,", "\n", "]", "\n", "for", "l1", ",", "l2", "in", "zip", "(", "vgg19_bn", ".", "features", ",", "features", ")", ":", "\n", "            ", "if", "isinstance", "(", "l1", ",", "nn", ".", "Conv2d", ")", "and", "isinstance", "(", "l2", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "assert", "l1", ".", "weight", ".", "size", "(", ")", "==", "l2", ".", "weight", ".", "size", "(", ")", "\n", "assert", "l1", ".", "bias", ".", "size", "(", ")", "==", "l2", ".", "bias", ".", "size", "(", ")", "\n", "l2", ".", "weight", ".", "data", "=", "l1", ".", "weight", ".", "data", "\n", "l2", ".", "bias", ".", "data", "=", "l1", ".", "bias", ".", "data", "\n", "", "if", "isinstance", "(", "l1", ",", "nn", ".", "BatchNorm2d", ")", "and", "isinstance", "(", "l2", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "assert", "l1", ".", "weight", ".", "size", "(", ")", "==", "l2", ".", "weight", ".", "size", "(", ")", "\n", "assert", "l1", ".", "bias", ".", "size", "(", ")", "==", "l2", ".", "bias", ".", "size", "(", ")", "\n", "l2", ".", "weight", ".", "data", "=", "l1", ".", "weight", ".", "data", "\n", "l2", ".", "bias", ".", "data", "=", "l1", ".", "bias", ".", "data", "\n", "", "", "", "", ""]], "home.repos.pwc.inspect_result.wangbo-zhao_2021iccv-dlglrg.models.backbone.get_upsampling_weight": [[6, 20], ["numpy.zeros", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy().float", "torch.from_numpy", "torch.from_numpy", "torch.from_numpy", "abs", "abs", "range", "range"], "function", ["None"], ["def", "get_upsampling_weight", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ")", ":", "\n", "    ", "\"\"\"Make a 2D bilinear kernel suitable for upsampling\"\"\"", "\n", "factor", "=", "(", "kernel_size", "+", "1", ")", "//", "2", "\n", "if", "kernel_size", "%", "2", "==", "1", ":", "\n", "        ", "center", "=", "factor", "-", "1", "\n", "", "else", ":", "\n", "        ", "center", "=", "factor", "-", "0.5", "\n", "", "og", "=", "np", ".", "ogrid", "[", ":", "kernel_size", ",", ":", "kernel_size", "]", "\n", "filt", "=", "(", "1", "-", "abs", "(", "og", "[", "0", "]", "-", "center", ")", "/", "factor", ")", "*", "(", "1", "-", "abs", "(", "og", "[", "1", "]", "-", "center", ")", "/", "factor", ")", "\n", "weight", "=", "np", ".", "zeros", "(", "(", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "kernel_size", ")", ",", "\n", "dtype", "=", "np", ".", "float64", ")", "\n", "weight", "[", "range", "(", "in_channels", ")", ",", "range", "(", "out_channels", ")", ",", ":", ",", ":", "]", "=", "filt", "\n", "return", "torch", ".", "from_numpy", "(", "weight", ")", ".", "float", "(", ")", "\n", "\n"]]}