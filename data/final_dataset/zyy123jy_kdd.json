{"home.repos.pwc.inspect_result.zyy123jy_kdd.None.test_model.test_model": [[15, 110], ["numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.isnan", "numpy.isnan", "numpy.isnan", "numpy.array", "numpy.size", "numpy.size", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.reshape", "range", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "numpy.array", "print", "print", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "tensorflow.placeholder", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.models.Normal", "edward.KLqp", "ed.KLqp.run", "abs", "abs", "tensorflow.reduce_sum", "tensorflow.reduce_sum", "abs", "tensorflow.reduce_sum", "tensorflow.count_nonzero", "tensorflow.count_nonzero", "tensorflow.count_nonzero", "numpy.savetxt", "numpy.savetxt", "numpy.savetxt", "print", "print", "print", "print", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "pandas.read_csv", "tensorflow.sigmoid", "tensorflow.sigmoid", "tensorflow.sigmoid", "tensorflow.sigmoid", "tensorflow.sigmoid", "tensorflow.sigmoid", "tf.reduce_sum.eval", "tf.count_nonzero.eval", "tf.reduce_sum.eval", "tf.count_nonzero.eval", "tf.reduce_sum.eval", "tf.count_nonzero.eval", "tensorflow.Variable", "tensorflow.nn.softplus", "tensorflow.Variable", "tensorflow.nn.softplus", "tensorflow.Variable", "tensorflow.nn.softplus", "tensorflow.Variable", "tensorflow.nn.softplus", "tensorflow.matmul", "tensorflow.ones", "tensorflow.matmul", "tensorflow.ones", "tensorflow.matmul", "tensorflow.ones", "tensorflow.matmul", "tensorflow.ones", "tensorflow.random_normal", "tensorflow.Variable", "tensorflow.random_normal", "tensorflow.Variable", "tensorflow.random_normal", "tensorflow.Variable", "tensorflow.random_normal", "tensorflow.Variable", "tensorflow.abs", "tensorflow.abs", "tensorflow.abs", "tensorflow.ones", "tensorflow.ones", "tensorflow.ones", "str", "str", "str", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "tensorflow.random_normal", "str", "str", "str"], "function", ["None"], ["def", "test_model", "(", ")", ":", "\n", "    ", "X_test", "=", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./X_test.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ")", "\n", "Y1_test", "=", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./Y1_test.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ")", "\n", "Y2_test", "=", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./Y2_test.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ")", "\n", "Y5_test", "=", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./Y5_test.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ")", "\n", "T_test", "=", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./T_test.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ")", "\n", "\n", "Y1_test", "=", "np", ".", "array", "(", "Y1_test", ")", "/", "mmse_scale", "\n", "where_are_NaNs", "=", "np", ".", "isnan", "(", "Y1_test", ")", "\n", "Y1_test", "[", "where_are_NaNs", "]", "=", "0", "\n", "\n", "Y2_test", "=", "np", ".", "array", "(", "Y2_test", ")", "/", "adas_scale", "\n", "where_are_NaNs", "=", "np", ".", "isnan", "(", "Y2_test", ")", "\n", "Y2_test", "[", "where_are_NaNs", "]", "=", "0", "\n", "\n", "Y5_test", "=", "np", ".", "array", "(", "Y5_test", ")", "/", "cd_scale", "\n", "where_are_NaNs", "=", "np", ".", "isnan", "(", "Y5_test", ")", "\n", "Y5_test", "[", "where_are_NaNs", "]", "=", "0", "\n", "Mask_T", "=", "(", "T_test", ">", "0", ")", "*", "1", "\n", "T_test", "=", "np", ".", "array", "(", "Mask_T", "*", "(", "T_test", "-", "base_age", ")", "/", "time_scale", ")", "\n", "Me", "=", "2", "\n", "Md", "=", "5", "\n", "D", "=", "np", ".", "size", "(", "X_test", ",", "1", ")", "\n", "Ne", "=", "np", ".", "size", "(", "X_test", ",", "0", ")", "\n", "a0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./a0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "Md", ")", ")", "\n", "b0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./b0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "1", ")", ")", "\n", "w0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./w0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "D", ",", "1", ")", ")", "\n", "v0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./v0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "D", ",", "1", ")", ")", "\n", "h0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./h0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "Md", ")", ")", "\n", "c0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./c0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "Md", ")", ")", "\n", "sigma_y0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./sigma_y0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "Md", ")", ")", "\n", "sigma_s0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./sigma_s0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "Md", ")", ")", "\n", "sigma_q0", "=", "np", ".", "reshape", "(", "np", ".", "array", "(", "pd", ".", "read_csv", "(", "'./sigma_q0.txt'", ",", "sep", "=", "\",\"", ",", "header", "=", "None", ")", ",", "dtype", "=", "'f'", ")", ",", "(", "Md", ")", ")", "\n", "\n", "past_visit", "=", "4", "\n", "for", "iter_tt", "in", "range", "(", "0", ",", "past_visit", ")", ":", "\n", "            ", "Me", "=", "iter_tt", "\n", "print", "(", "\"known time points\"", ")", "\n", "print", "(", "Me", ")", "\n", "Xt", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "Ne", ",", "D", "]", ")", "\n", "Tt", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "Ne", ",", "Me", "]", ")", "\n", "Maskt", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "Md", "-", "2", ",", "Ne", ",", "Me", "]", ")", "\n", "Yt1", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "Ne", ",", "Me", "]", ")", "\n", "Yt2", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "Ne", ",", "Me", "]", ")", "\n", "Yt5", "=", "tf", ".", "placeholder", "(", "tf", ".", "float32", ",", "[", "Ne", ",", "Me", "]", ")", "\n", "# models   ", "\n", "s1", "=", "Normal", "(", "loc", "=", "tf", ".", "matmul", "(", "Xt", ",", "w0", ")", "+", "b0", ",", "scale", "=", "sigma_s0", "[", "0", "]", "*", "tf", ".", "ones", "(", "[", "Ne", ",", "1", "]", ",", "tf", ".", "float32", ")", ")", "\n", "q11", "=", "Normal", "(", "loc", "=", "tf", ".", "matmul", "(", "Xt", ",", "v0", ")", "+", "a0", "[", "0", "]", ",", "scale", "=", "sigma_q0", "[", "0", "]", "*", "tf", ".", "ones", "(", "[", "Ne", ",", "1", "]", ",", "tf", ".", "float32", ")", ")", "\n", "q12", "=", "Normal", "(", "loc", "=", "tf", ".", "matmul", "(", "Xt", ",", "v0", ")", "+", "a0", "[", "1", "]", ",", "scale", "=", "sigma_q0", "[", "1", "]", "*", "tf", ".", "ones", "(", "[", "Ne", ",", "1", "]", ",", "tf", ".", "float32", ")", ")", "\n", "q15", "=", "Normal", "(", "loc", "=", "tf", ".", "matmul", "(", "Xt", ",", "v0", ")", "+", "a0", "[", "4", "]", ",", "scale", "=", "sigma_q0", "[", "4", "]", "*", "tf", ".", "ones", "(", "[", "Ne", ",", "1", "]", ",", "tf", ".", "float32", ")", ")", "\n", "\n", "q_s1", "=", "Normal", "(", "loc", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ",", "\n", "scale", "=", "tf", ".", "nn", ".", "softplus", "(", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ")", ")", "\n", "q_q11", "=", "Normal", "(", "loc", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ",", "\n", "scale", "=", "tf", ".", "nn", ".", "softplus", "(", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ")", ")", "\n", "q_q22", "=", "Normal", "(", "loc", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ",", "\n", "scale", "=", "tf", ".", "nn", ".", "softplus", "(", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ")", ")", "\n", "q_q55", "=", "Normal", "(", "loc", "=", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ",", "\n", "scale", "=", "tf", ".", "nn", ".", "softplus", "(", "tf", ".", "Variable", "(", "tf", ".", "random_normal", "(", "[", "Ne", ",", "1", "]", ")", ")", ")", ")", "\n", "\n", "Zp1", "=", "tf", ".", "sigmoid", "(", "tf", ".", "abs", "(", "s1", ")", "*", "(", "Tt", "-", "q11", ")", ")", "*", "Maskt", "[", "0", ",", ":", ",", ":", "]", "\n", "Zp2", "=", "tf", ".", "sigmoid", "(", "tf", ".", "abs", "(", "s1", ")", "*", "(", "Tt", "-", "q12", ")", ")", "*", "Maskt", "[", "1", ",", ":", ",", ":", "]", "\n", "Zp5", "=", "tf", ".", "sigmoid", "(", "tf", ".", "abs", "(", "s1", ")", "*", "(", "Tt", "-", "q15", ")", ")", "*", "Maskt", "[", "2", ",", ":", ",", ":", "]", "\n", "Yt1", "=", "Normal", "(", "loc", "=", "(", "-", "c0", "[", "0", "]", "*", "Zp1", "+", "h0", "[", "0", "]", ")", "*", "Maskt", "[", "0", ",", ":", ",", ":", "]", ",", "scale", "=", "sigma_y0", "[", "0", "]", "*", "tf", ".", "ones", "(", "[", "Ne", ",", "Me", "]", ",", "tf", ".", "float32", ")", ")", "\n", "Yt2", "=", "Normal", "(", "loc", "=", "(", "c0", "[", "1", "]", "*", "Zp2", "+", "h0", "[", "1", "]", ")", "*", "Maskt", "[", "1", ",", ":", ",", ":", "]", ",", "scale", "=", "sigma_y0", "[", "1", "]", "*", "tf", ".", "ones", "(", "[", "Ne", ",", "Me", "]", ",", "tf", ".", "float32", ")", ")", "\n", "Yt5", "=", "Normal", "(", "loc", "=", "(", "c0", "[", "4", "]", "*", "Zp5", "+", "h0", "[", "4", "]", ")", "*", "Maskt", "[", "2", ",", ":", ",", ":", "]", ",", "scale", "=", "sigma_y0", "[", "4", "]", "*", "tf", ".", "ones", "(", "[", "Ne", ",", "Me", "]", ",", "tf", ".", "float32", ")", ")", "\n", "data", "=", "{", "Xt", ":", "X_test", ",", "Tt", ":", "T_test", "[", ":", ",", "0", ":", "Me", "]", ",", "Maskt", ":", "Mask_test", "[", ":", ",", ":", ",", "0", ":", "Me", "]", ",", "Yt1", ":", "Y_test1", "[", ":", ",", "0", ":", "Me", "]", ",", "\n", "Yt2", ":", "Y_test2", "[", ":", ",", "0", ":", "Me", "]", ",", "Yt5", ":", "Y_test5", "[", ":", ",", "0", ":", "Me", "]", "}", "\n", "inference", "=", "ed", ".", "KLqp", "(", "{", "s1", ":", "q_s1", ",", "q11", ":", "q_q11", ",", "q12", ":", "q_q22", ",", "q15", ":", "q_q55", "}", ",", "data", ")", "\n", "inference", ".", "run", "(", "n_iter", "=", "50000", ")", "\n", "zhat1", "=", "Mask_test", "[", "0", ",", ":", ",", ":", "]", "*", "(", "tf", ".", "sigmoid", "(", "(", "T_test", "-", "q_q11", ")", "*", "q_s1", ")", ")", "\n", "Yhat1", "=", "-", "c0", "[", "0", "]", "*", "zhat1", "+", "h0", "[", "0", "]", "\n", "zhat2", "=", "Mask_test", "[", "1", ",", ":", ",", ":", "]", "*", "tf", ".", "sigmoid", "(", "(", "T_test", "-", "q_q22", ")", "*", "q_s1", ")", "\n", "Yhat2", "=", "c0", "[", "1", "]", "*", "zhat2", "+", "h0", "[", "1", "]", "\n", "zhat5", "=", "Mask_test", "[", "2", ",", ":", ",", ":", "]", "*", "tf", ".", "sigmoid", "(", "(", "T_test", "-", "q_q55", ")", "*", "q_s1", ")", "\n", "Yhat5", "=", "c0", "[", "4", "]", "*", "zhat5", "+", "h0", "[", "4", "]", "\n", "err1", "=", "(", "abs", "(", "Mask_test", "[", "0", ",", ":", ",", "Me", ":", "Mt", "]", "*", "(", "Y_test1", "[", ":", ",", "Me", ":", "Mt", "]", "-", "Yhat1", "[", ":", ",", "Me", ":", "Mt", "]", ")", ")", ")", "\n", "err2", "=", "(", "abs", "(", "Mask_test", "[", "1", ",", ":", ",", "Me", ":", "Mt", "]", "*", "(", "Y_test2", "[", ":", ",", "Me", ":", "Mt", "]", "-", "Yhat2", "[", ":", ",", "Me", ":", "Mt", "]", ")", ")", ")", "\n", "err11", "=", "tf", ".", "reduce_sum", "(", "err1", ")", "\n", "err22", "=", "tf", ".", "reduce_sum", "(", "err2", ")", "\n", "err5", "=", "(", "abs", "(", "Mask_test", "[", "2", ",", ":", ",", "Me", ":", "Mt", "]", "*", "(", "Y_test5", "[", ":", ",", "Me", ":", "Mt", "]", "-", "Yhat5", "[", ":", ",", "Me", ":", "Mt", "]", ")", ")", ")", "\n", "err55", "=", "tf", ".", "reduce_sum", "(", "err5", ")", "\n", "n1", "=", "tf", ".", "count_nonzero", "(", "Mask_test", "[", "0", ",", ":", ",", "Me", ":", "Mt", "]", ")", "\n", "n2", "=", "tf", ".", "count_nonzero", "(", "Mask_test", "[", "1", ",", ":", ",", "Me", ":", "Mt", "]", ")", "\n", "n5", "=", "tf", ".", "count_nonzero", "(", "Mask_test", "[", "2", ",", ":", ",", "Me", ":", "Mt", "]", ")", "\n", "E1", "[", "iter", ",", "iter_tt", "]", "=", "err11", ".", "eval", "(", ")", "/", "n1", ".", "eval", "(", ")", "\n", "E2", "[", "iter", ",", "iter_tt", "]", "=", "err22", ".", "eval", "(", ")", "/", "n2", ".", "eval", "(", ")", "\n", "E5", "[", "iter", ",", "iter_tt", "]", "=", "err55", ".", "eval", "(", ")", "/", "n5", ".", "eval", "(", ")", "\n", "np", ".", "savetxt", "(", "'./result/'", "+", "str", "(", "iter", ")", "+", "str", "(", "iter_tt", ")", "+", "\"E1.txt\"", ",", "E1", ",", "delimiter", "=", "\",\"", ")", "\n", "np", ".", "savetxt", "(", "'./result/'", "+", "str", "(", "iter", ")", "+", "str", "(", "iter_tt", ")", "+", "\"E2.txt\"", ",", "E2", ",", "delimiter", "=", "\",\"", ")", "\n", "np", ".", "savetxt", "(", "'./result/'", "+", "str", "(", "iter", ")", "+", "str", "(", "iter_tt", ")", "+", "\"E5.txt\"", ",", "E5", ",", "delimiter", "=", "\",\"", ")", "\n", "print", "(", "\"Mean absolute error on test data:\"", ")", "\n", "print", "(", "E1", ")", "\n", "print", "(", "E2", ")", "\n", "print", "(", "E5", ")", "\n", "", "", ""]]}