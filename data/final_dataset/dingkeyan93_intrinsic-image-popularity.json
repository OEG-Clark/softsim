{"home.repos.pwc.inspect_result.dingkeyan93_intrinsic-image-popularity.None.test.prepare_image": [[9, 19], ["torchvision.Compose", "transforms.Compose.", "image.convert.unsqueeze", "image.convert.to", "image.convert.convert", "torchvision.Resize", "torchvision.ToTensor"], "function", ["None"], ["def", "prepare_image", "(", "image", ")", ":", "\n", "    ", "if", "image", ".", "mode", "!=", "'RGB'", ":", "\n", "        ", "image", "=", "image", ".", "convert", "(", "\"RGB\"", ")", "\n", "", "Transform", "=", "transforms", ".", "Compose", "(", "[", "\n", "transforms", ".", "Resize", "(", "[", "224", ",", "224", "]", ")", ",", "\n", "transforms", ".", "ToTensor", "(", ")", ",", "\n", "]", ")", "\n", "image", "=", "Transform", "(", "image", ")", "\n", "image", "=", "image", ".", "unsqueeze", "(", "0", ")", "\n", "return", "image", ".", "to", "(", "device", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.dingkeyan93_intrinsic-image-popularity.None.test.predict": [[20, 25], ["test.prepare_image", "print", "torch.no_grad", "model", "model.item"], "function", ["home.repos.pwc.inspect_result.dingkeyan93_intrinsic-image-popularity.None.test.prepare_image"], ["", "def", "predict", "(", "image", ",", "model", ")", ":", "\n", "    ", "image", "=", "prepare_image", "(", "image", ")", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "preds", "=", "model", "(", "image", ")", "\n", "", "print", "(", "r'Popularity score: %.2f'", "%", "preds", ".", "item", "(", ")", ")", "\n", "\n"]]}