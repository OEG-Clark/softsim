{"home.repos.pwc.inspect_result.Nandan91_ULSAM.None.ulsam.SubSpace.__init__": [[27, 44], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.Softmax", "torch.Softmax"], "methods", ["home.repos.pwc.inspect_result.Nandan91_ULSAM.None.ulsam.ULSAM.__init__"], ["def", "__init__", "(", "self", ",", "nin", ":", "int", ")", "->", "None", ":", "\n", "        ", "super", "(", "SubSpace", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "conv_dws", "=", "nn", ".", "Conv2d", "(", "\n", "nin", ",", "nin", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "groups", "=", "nin", "\n", ")", "\n", "self", ".", "bn_dws", "=", "nn", ".", "BatchNorm2d", "(", "nin", ",", "momentum", "=", "0.9", ")", "\n", "self", ".", "relu_dws", "=", "nn", ".", "ReLU", "(", "inplace", "=", "False", ")", "\n", "\n", "self", ".", "maxpool", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "conv_point", "=", "nn", ".", "Conv2d", "(", "\n", "nin", ",", "1", ",", "kernel_size", "=", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "groups", "=", "1", "\n", ")", "\n", "self", ".", "bn_point", "=", "nn", ".", "BatchNorm2d", "(", "1", ",", "momentum", "=", "0.9", ")", "\n", "self", ".", "relu_point", "=", "nn", ".", "ReLU", "(", "inplace", "=", "False", ")", "\n", "\n", "self", ".", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.Nandan91_ULSAM.None.ulsam.SubSpace.forward": [[45, 67], ["ulsam.SubSpace.conv_dws", "ulsam.SubSpace.bn_dws", "ulsam.SubSpace.relu_dws", "ulsam.SubSpace.maxpool", "ulsam.SubSpace.conv_point", "ulsam.SubSpace.bn_point", "ulsam.SubSpace.relu_point", "ulsam.SubSpace.softmax", "torch.mul.view", "torch.mul.view", "torch.mul.expand", "torch.mul.expand", "torch.mul", "torch.mul", "torch.mul", "torch.mul", "torch.mul.view", "torch.mul.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ":", "torch", ".", "Tensor", ")", "->", "torch", ".", "Tensor", ":", "\n", "        ", "out", "=", "self", ".", "conv_dws", "(", "x", ")", "\n", "out", "=", "self", ".", "bn_dws", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_dws", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "maxpool", "(", "out", ")", "\n", "\n", "out", "=", "self", ".", "conv_point", "(", "out", ")", "\n", "out", "=", "self", ".", "bn_point", "(", "out", ")", "\n", "out", "=", "self", ".", "relu_point", "(", "out", ")", "\n", "\n", "m", ",", "n", ",", "p", ",", "q", "=", "out", ".", "shape", "\n", "out", "=", "self", ".", "softmax", "(", "out", ".", "view", "(", "m", ",", "n", ",", "-", "1", ")", ")", "\n", "out", "=", "out", ".", "view", "(", "m", ",", "n", ",", "p", ",", "q", ")", "\n", "\n", "out", "=", "out", ".", "expand", "(", "x", ".", "shape", "[", "0", "]", ",", "x", ".", "shape", "[", "1", "]", ",", "x", ".", "shape", "[", "2", "]", ",", "x", ".", "shape", "[", "3", "]", ")", "\n", "\n", "out", "=", "torch", ".", "mul", "(", "out", ",", "x", ")", "\n", "\n", "out", "=", "out", "+", "x", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.Nandan91_ULSAM.None.ulsam.ULSAM.__init__": [[101, 114], ["torch.Module.__init__", "torch.ModuleList", "torch.ModuleList", "ulsam.SubSpace", "int", "range"], "methods", ["home.repos.pwc.inspect_result.Nandan91_ULSAM.None.ulsam.ULSAM.__init__"], ["def", "__init__", "(", "self", ",", "nin", ":", "int", ",", "nout", ":", "int", ",", "h", ":", "int", ",", "w", ":", "int", ",", "num_splits", ":", "int", ")", "->", "None", ":", "\n", "        ", "super", "(", "ULSAM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "assert", "nin", "%", "num_splits", "==", "0", "\n", "\n", "self", ".", "nin", "=", "nin", "\n", "self", ".", "nout", "=", "nout", "\n", "self", ".", "h", "=", "h", "\n", "self", ".", "w", "=", "w", "\n", "self", ".", "num_splits", "=", "num_splits", "\n", "\n", "self", ".", "subspaces", "=", "nn", ".", "ModuleList", "(", "\n", "[", "SubSpace", "(", "int", "(", "self", ".", "nin", "/", "self", ".", "num_splits", ")", ")", "for", "i", "in", "range", "(", "self", ".", "num_splits", ")", "]", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.Nandan91_ULSAM.None.ulsam.ULSAM.forward": [[116, 129], ["int", "torch.chunk", "torch.chunk", "torch.chunk", "torch.chunk", "enumerate", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat.append", "torch.cat.append"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ":", "torch", ".", "Tensor", ")", "->", "torch", ".", "Tensor", ":", "\n", "        ", "group_size", "=", "int", "(", "self", ".", "nin", "/", "self", ".", "num_splits", ")", "\n", "\n", "# split at batch dimension", "\n", "sub_feat", "=", "torch", ".", "chunk", "(", "x", ",", "self", ".", "num_splits", ",", "dim", "=", "1", ")", "\n", "\n", "out", "=", "[", "]", "\n", "for", "idx", ",", "l", "in", "enumerate", "(", "self", ".", "subspaces", ")", ":", "\n", "            ", "out", ".", "append", "(", "self", ".", "subspaces", "[", "idx", "]", "(", "sub_feat", "[", "idx", "]", ")", ")", "\n", "\n", "", "out", "=", "torch", ".", "cat", "(", "out", ",", "dim", "=", "1", ")", "\n", "\n", "return", "out", "\n", "\n"]]}