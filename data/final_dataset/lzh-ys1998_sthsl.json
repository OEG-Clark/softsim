{"home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.__init__": [[11, 18], ["DataHandler.DataHandler.DataHandler", "model.STHSL", "engine.trainer.model.to", "torch.Adam", "torch.Adam", "engine.trainer.model.parameters"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "device", ")", ":", "\n", "        ", "self", ".", "handler", "=", "DataHandler", "(", ")", "\n", "self", ".", "model", "=", "STHSL", "(", ")", "\n", "self", ".", "model", ".", "to", "(", "device", ")", "\n", "self", ".", "optimizer", "=", "optim", ".", "Adam", "(", "self", ".", "model", ".", "parameters", "(", ")", ",", "lr", "=", "args", ".", "lr", ",", "weight_decay", "=", "args", ".", "weight_decay", ")", "\n", "self", ".", "loss", "=", "utils", ".", "cal_loss_r", "\n", "self", ".", "metrics", "=", "utils", ".", "cal_metrics_r", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.sampleTrainBatch": [[19, 35], ["numpy.transpose", "range", "numpy.concatenate", "numpy.expand_dims", "feat_list.append", "engine.trainer.handler.zScore"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zScore"], ["", "def", "sampleTrainBatch", "(", "self", ",", "batIds", ",", "st", ",", "ed", ")", ":", "\n", "        ", "batch", "=", "ed", "-", "st", "\n", "idx", "=", "batIds", "[", "0", ":", "batch", "]", "\n", "label", "=", "self", ".", "handler", ".", "trnT", "[", ":", ",", "idx", ",", ":", "]", "\n", "label", "=", "np", ".", "transpose", "(", "label", ",", "[", "1", ",", "0", ",", "2", "]", ")", "\n", "retLabels", "=", "(", "label", ">=", "0", ")", "*", "1", "\n", "mask", "=", "retLabels", "\n", "retLabels", "=", "label", "\n", "\n", "feat_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "batch", ")", ":", "\n", "            ", "feat_one", "=", "self", ".", "handler", ".", "trnT", "[", ":", ",", "idx", "[", "i", "]", "-", "args", ".", "temporalRange", ":", "idx", "[", "i", "]", ",", ":", "]", "\n", "feat_one", "=", "np", ".", "expand_dims", "(", "feat_one", ",", "axis", "=", "0", ")", "\n", "feat_list", ".", "append", "(", "feat_one", ")", "\n", "", "feat_batch", "=", "np", ".", "concatenate", "(", "feat_list", ",", "axis", "=", "0", ")", "\n", "return", "self", ".", "handler", ".", "zScore", "(", "feat_batch", ")", ",", "retLabels", ",", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.sampTestBatch": [[36, 56], ["numpy.transpose", "range", "numpy.concatenate", "numpy.expand_dims", "feat_list.append", "engine.trainer.handler.zScore", "numpy.concatenate"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zScore"], ["", "def", "sampTestBatch", "(", "self", ",", "batIds", ",", "st", ",", "ed", ",", "tstTensor", ",", "inpTensor", ")", ":", "\n", "        ", "batch", "=", "ed", "-", "st", "\n", "idx", "=", "batIds", "[", "0", ":", "batch", "]", "\n", "label", "=", "tstTensor", "[", ":", ",", "idx", ",", ":", "]", "\n", "label", "=", "np", ".", "transpose", "(", "label", ",", "[", "1", ",", "0", ",", "2", "]", ")", "\n", "retLabels", "=", "label", "\n", "mask", "=", "1", "*", "(", "label", ">", "0", ")", "\n", "\n", "feat_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "batch", ")", ":", "\n", "            ", "if", "idx", "[", "i", "]", "-", "args", ".", "temporalRange", "<", "0", ":", "\n", "                ", "temT", "=", "inpTensor", "[", ":", ",", "idx", "[", "i", "]", "-", "args", ".", "temporalRange", ":", ",", ":", "]", "\n", "temT2", "=", "tstTensor", "[", ":", ",", ":", "idx", "[", "i", "]", ",", ":", "]", "\n", "feat_one", "=", "np", ".", "concatenate", "(", "[", "temT", ",", "temT2", "]", ",", "axis", "=", "1", ")", "\n", "", "else", ":", "\n", "                ", "feat_one", "=", "tstTensor", "[", ":", ",", "idx", "[", "i", "]", "-", "args", ".", "temporalRange", ":", "idx", "[", "i", "]", ",", ":", "]", "\n", "", "feat_one", "=", "np", ".", "expand_dims", "(", "feat_one", ",", "axis", "=", "0", ")", "\n", "feat_list", ".", "append", "(", "feat_one", ")", "\n", "", "feats", "=", "np", ".", "concatenate", "(", "feat_list", ",", "axis", "=", "0", ")", "\n", "return", "self", ".", "handler", ".", "zScore", "(", "feats", ")", ",", "retLabels", ",", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.train": [[58, 96], ["engine.trainer.model.train", "numpy.random.permutation", "len", "int", "range", "list", "numpy.ceil", "min", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "engine.trainer.sampleTrainBatch", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "engine.trainer.optimizer.zero_grad", "numpy.random.permutation", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "engine.trainer.model", "engine.trainer.handler.zInverse", "engine.trainer.handler.zInverse", "loss.backward", "engine.trainer.optimizer.step", "print", "loss.item", "range", "engine.trainer.loss", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "engine.trainer.loss", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "utils.Informax_loss", "utils.infoNCEloss"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.train", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.sampleTrainBatch", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zInverse", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zInverse", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.Informax_loss", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.infoNCEloss"], ["", "def", "train", "(", "self", ")", ":", "\n", "        ", "self", ".", "model", ".", "train", "(", ")", "\n", "ids", "=", "np", ".", "random", ".", "permutation", "(", "list", "(", "range", "(", "args", ".", "temporalRange", ",", "args", ".", "trnDays", ")", ")", ")", "\n", "epochLoss", ",", "epochPreLoss", ",", "epochAcc", "=", "[", "0", "]", "*", "3", "\n", "num", "=", "len", "(", "ids", ")", "\n", "steps", "=", "int", "(", "np", ".", "ceil", "(", "num", "/", "args", ".", "batch", ")", ")", "\n", "for", "i", "in", "range", "(", "steps", ")", ":", "\n", "            ", "st", "=", "i", "*", "args", ".", "batch", "\n", "ed", "=", "min", "(", "(", "i", "+", "1", ")", "*", "args", ".", "batch", ",", "num", ")", "\n", "batIds", "=", "ids", "[", "st", ":", "ed", "]", "\n", "bt", "=", "ed", "-", "st", "\n", "\n", "Infomax_L1", "=", "torch", ".", "ones", "(", "bt", ",", "args", ".", "offNum", ",", "args", ".", "areaNum", ")", "\n", "Infomax_L2", "=", "torch", ".", "zeros", "(", "bt", ",", "args", ".", "offNum", ",", "args", ".", "areaNum", ")", "\n", "Infomax_labels", "=", "torch", ".", "Tensor", "(", "torch", ".", "cat", "(", "(", "Infomax_L1", ",", "Infomax_L2", ")", ",", "-", "1", ")", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "\n", "tem", "=", "self", ".", "sampleTrainBatch", "(", "batIds", ",", "st", ",", "ed", ")", "\n", "feats", ",", "labels", ",", "mask", "=", "tem", "\n", "mask", "=", "torch", ".", "Tensor", "(", "mask", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "self", ".", "optimizer", ".", "zero_grad", "(", ")", "\n", "\n", "idx", "=", "np", ".", "random", ".", "permutation", "(", "args", ".", "areaNum", ")", "\n", "DGI_feats", "=", "torch", ".", "Tensor", "(", "feats", "[", ":", ",", "idx", ",", ":", ",", ":", "]", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "feats", "=", "torch", ".", "Tensor", "(", "feats", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "labels", "=", "torch", ".", "Tensor", "(", "labels", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "\n", "out_local", ",", "eb_local", ",", "eb_global", ",", "Infomax_pred", ",", "out_global", "=", "self", ".", "model", "(", "feats", ",", "DGI_feats", ")", "\n", "out_local", "=", "self", ".", "handler", ".", "zInverse", "(", "out_local", ")", "\n", "out_global", "=", "self", ".", "handler", ".", "zInverse", "(", "out_global", ")", "\n", "loss", "=", "(", "utils", ".", "Informax_loss", "(", "Infomax_pred", ",", "Infomax_labels", ")", "*", "args", ".", "ir", ")", "+", "(", "utils", ".", "infoNCEloss", "(", "eb_global", ",", "eb_local", ")", "*", "args", ".", "cr", ")", "+", "self", ".", "loss", "(", "out_local", ",", "labels", ",", "mask", ")", "+", "self", ".", "loss", "(", "out_global", ",", "labels", ",", "mask", ")", "\n", "\n", "loss", ".", "backward", "(", ")", "\n", "self", ".", "optimizer", ".", "step", "(", ")", "\n", "print", "(", "'Step %d/%d: preLoss = %.4f         '", "%", "(", "i", ",", "steps", ",", "loss", ")", ",", "end", "=", "'\\r'", ")", "\n", "epochLoss", "+=", "loss", "\n", "", "epochLoss", "=", "epochLoss", "/", "steps", "\n", "return", "epochLoss", ",", "loss", ".", "item", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.eval": [[98, 220], ["engine.trainer.model.eval", "len", "int", "range", "dict", "numpy.array", "numpy.array", "numpy.ceil", "min", "numpy.random.permutation", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "torch.Tensor().to", "engine.trainer.model", "range", "numpy.sqrt", "numpy.sqrt", "range", "numpy.sqrt", "numpy.sqrt", "numpy.sqrt", "numpy.sqrt", "list", "list", "numpy.zeros", "numpy.zeros", "numpy.zeros", "numpy.zeros", "numpy.zeros", "numpy.zeros", "engine.trainer.sampTestBatch", "engine.trainer.sampTestBatch", "engine.trainer.handler.zInverse", "utils.cal_metrics_r_mask", "utils.cal_metrics_r_mask", "utils.cal_metrics_r_mask", "utils.cal_metrics_r_mask", "engine.trainer.metrics", "print", "engine.trainer.metrics", "print", "numpy.sqrt", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sqrt", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "range", "range", "range", "range", "range", "range", "range", "range", "numpy.concatenate", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "engine.trainer.cpu().detach().numpy", "engine.trainer.cpu().detach().numpy", "engine.trainer.cpu().detach().numpy", "engine.trainer.cpu().detach().numpy", "engine.trainer.cpu().detach().numpy", "engine.trainer.cpu().detach().numpy", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "engine.trainer.cpu().detach", "engine.trainer.cpu().detach", "engine.trainer.cpu().detach", "engine.trainer.cpu().detach", "engine.trainer.cpu().detach", "engine.trainer.cpu().detach", "engine.trainer.cpu", "engine.trainer.cpu", "engine.trainer.cpu", "engine.trainer.cpu", "engine.trainer.cpu", "engine.trainer.cpu"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.eval", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.sampTestBatch", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.sampTestBatch", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zInverse", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask"], ["", "def", "eval", "(", "self", ",", "iseval", ",", "isSparsity", ")", ":", "\n", "        ", "self", ".", "model", ".", "eval", "(", ")", "\n", "if", "iseval", ":", "\n", "            ", "ids", "=", "np", ".", "array", "(", "list", "(", "range", "(", "self", ".", "handler", ".", "valT", ".", "shape", "[", "1", "]", ")", ")", ")", "\n", "", "else", ":", "\n", "            ", "ids", "=", "np", ".", "array", "(", "list", "(", "range", "(", "self", ".", "handler", ".", "tstT", ".", "shape", "[", "1", "]", ")", ")", ")", "\n", "", "epochLoss", ",", "epochPreLoss", ",", "=", "[", "0", "]", "*", "2", "\n", "\n", "num", "=", "len", "(", "ids", ")", "\n", "if", "isSparsity", ":", "\n", "            ", "epochSqLoss1", ",", "epochAbsLoss1", ",", "epochTstNum1", ",", "epochApeLoss1", ",", "epochPosNums1", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss2", ",", "epochAbsLoss2", ",", "epochTstNum2", ",", "epochApeLoss2", ",", "epochPosNums2", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss3", ",", "epochAbsLoss3", ",", "epochTstNum3", ",", "epochApeLoss3", ",", "epochPosNums3", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss4", ",", "epochAbsLoss4", ",", "epochTstNum4", ",", "epochApeLoss4", ",", "epochPosNums4", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss", ",", "epochAbsLoss", ",", "epochTstNum", ",", "epochApeLoss", ",", "epochPosNums", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "", "else", ":", "\n", "            ", "epochSqLoss", ",", "epochAbsLoss", ",", "epochTstNum", ",", "epochApeLoss", ",", "epochPosNums", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "\n", "", "steps", "=", "int", "(", "np", ".", "ceil", "(", "num", "/", "args", ".", "batch", ")", ")", "\n", "for", "i", "in", "range", "(", "steps", ")", ":", "\n", "            ", "st", "=", "i", "*", "args", ".", "batch", "\n", "ed", "=", "min", "(", "(", "i", "+", "1", ")", "*", "args", ".", "batch", ",", "num", ")", "\n", "batIds", "=", "ids", "[", "st", ":", "ed", "]", "\n", "\n", "if", "iseval", ":", "\n", "                ", "tem", "=", "self", ".", "sampTestBatch", "(", "batIds", ",", "st", ",", "ed", ",", "self", ".", "handler", ".", "valT", ",", "self", ".", "handler", ".", "trnT", ")", "\n", "", "else", ":", "\n", "                ", "tem", "=", "self", ".", "sampTestBatch", "(", "batIds", ",", "st", ",", "ed", ",", "self", ".", "handler", ".", "tstT", ",", "np", ".", "concatenate", "(", "[", "self", ".", "handler", ".", "trnT", ",", "self", ".", "handler", ".", "valT", "]", ",", "axis", "=", "1", ")", ")", "\n", "", "feats", ",", "labels", ",", "mask", "=", "tem", "\n", "idx", "=", "np", ".", "random", ".", "permutation", "(", "args", ".", "areaNum", ")", "\n", "shuf_feats", "=", "feats", "[", ":", ",", "idx", ",", ":", ",", ":", "]", "\n", "feats", "=", "torch", ".", "Tensor", "(", "feats", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "shuf_feats", "=", "torch", ".", "Tensor", "(", "shuf_feats", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "out_local", ",", "eb_local", ",", "eb_global", ",", "DGI_pred", ",", "out_global", "=", "self", ".", "model", "(", "feats", ",", "shuf_feats", ")", "\n", "\n", "if", "isSparsity", ":", "\n", "                ", "output", "=", "self", ".", "handler", ".", "zInverse", "(", "out_global", ")", "\n", "_", ",", "sqLoss1", ",", "absLoss1", ",", "tstNums1", ",", "apeLoss1", ",", "posNums1", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "self", ".", "handler", ".", "mask1", ")", "\n", "_", ",", "sqLoss2", ",", "absLoss2", ",", "tstNums2", ",", "apeLoss2", ",", "posNums2", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "self", ".", "handler", ".", "mask2", ")", "\n", "_", ",", "sqLoss3", ",", "absLoss3", ",", "tstNums3", ",", "apeLoss3", ",", "posNums3", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "self", ".", "handler", ".", "mask3", ")", "\n", "_", ",", "sqLoss4", ",", "absLoss4", ",", "tstNums4", ",", "apeLoss4", ",", "posNums4", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "self", ".", "handler", ".", "mask4", ")", "\n", "\n", "loss", ",", "sqLoss", ",", "absLoss", ",", "tstNums", ",", "apeLoss", ",", "posNums", "=", "self", ".", "metrics", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ")", "\n", "epochSqLoss", "+=", "sqLoss", "\n", "epochAbsLoss", "+=", "absLoss", "\n", "epochTstNum", "+=", "tstNums", "\n", "epochApeLoss", "+=", "apeLoss", "\n", "epochPosNums", "+=", "posNums", "\n", "\n", "epochSqLoss1", "+=", "sqLoss1", "\n", "epochAbsLoss1", "+=", "absLoss1", "\n", "epochTstNum1", "+=", "tstNums1", "\n", "epochApeLoss1", "+=", "apeLoss1", "\n", "epochPosNums1", "+=", "posNums1", "\n", "\n", "epochSqLoss2", "+=", "sqLoss2", "\n", "epochAbsLoss2", "+=", "absLoss2", "\n", "epochTstNum2", "+=", "tstNums2", "\n", "epochApeLoss2", "+=", "apeLoss2", "\n", "epochPosNums2", "+=", "posNums2", "\n", "\n", "epochSqLoss3", "+=", "sqLoss3", "\n", "epochAbsLoss3", "+=", "absLoss3", "\n", "epochTstNum3", "+=", "tstNums3", "\n", "epochApeLoss3", "+=", "apeLoss3", "\n", "epochPosNums3", "+=", "posNums3", "\n", "\n", "epochSqLoss4", "+=", "sqLoss4", "\n", "epochAbsLoss4", "+=", "absLoss4", "\n", "epochTstNum4", "+=", "tstNums4", "\n", "epochApeLoss4", "+=", "apeLoss4", "\n", "epochPosNums4", "+=", "posNums4", "\n", "epochLoss", "+=", "loss", "\n", "print", "(", "'Step %d/%d: loss = %.2f, regLoss = %.2f         '", "%", "(", "i", ",", "steps", ",", "loss", ",", "loss", ")", ",", "end", "=", "'\\r'", ")", "\n", "", "else", ":", "\n", "                ", "loss", ",", "sqLoss", ",", "absLoss", ",", "tstNums", ",", "apeLoss", ",", "posNums", "=", "self", ".", "metrics", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ")", "\n", "epochSqLoss", "+=", "sqLoss", "\n", "epochAbsLoss", "+=", "absLoss", "\n", "epochTstNum", "+=", "tstNums", "\n", "epochApeLoss", "+=", "apeLoss", "\n", "epochPosNums", "+=", "posNums", "\n", "epochLoss", "+=", "loss", "\n", "print", "(", "'Step %d/%d: loss = %.2f, regLoss = %.2f         '", "%", "(", "i", ",", "steps", ",", "loss", ",", "loss", ")", ",", "end", "=", "'\\r'", ")", "\n", "", "", "epochLoss", "=", "epochLoss", "/", "steps", "\n", "ret", "=", "dict", "(", ")", "\n", "\n", "if", "isSparsity", "==", "False", ":", "\n", "            ", "for", "i", "in", "range", "(", "args", ".", "offNum", ")", ":", "\n", "                ", "ret", "[", "'RMSE_%d'", "%", "i", "]", "=", "np", ".", "sqrt", "(", "epochSqLoss", "[", "i", "]", "/", "epochTstNum", "[", "i", "]", ")", "\n", "ret", "[", "'MAE_%d'", "%", "i", "]", "=", "epochAbsLoss", "[", "i", "]", "/", "epochTstNum", "[", "i", "]", "\n", "ret", "[", "'MAPE_%d'", "%", "i", "]", "=", "epochApeLoss", "[", "i", "]", "/", "epochPosNums", "[", "i", "]", "\n", "", "ret", "[", "'RMSE'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss", ")", "/", "np", ".", "sum", "(", "epochTstNum", ")", ")", "\n", "ret", "[", "'MAE'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss", ")", "/", "np", ".", "sum", "(", "epochTstNum", ")", "\n", "ret", "[", "'MAPE'", "]", "=", "np", ".", "sum", "(", "epochApeLoss", ")", "/", "np", ".", "sum", "(", "epochPosNums", ")", "\n", "ret", "[", "'epochLoss'", "]", "=", "epochLoss", "\n", "", "else", ":", "\n", "            ", "ret", "[", "'RMSE'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss", ")", "/", "np", ".", "sum", "(", "epochTstNum", ")", ")", "\n", "ret", "[", "'MAE'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss", ")", "/", "np", ".", "sum", "(", "epochTstNum", ")", "\n", "ret", "[", "'MAPE'", "]", "=", "np", ".", "sum", "(", "epochApeLoss", ")", "/", "np", ".", "sum", "(", "epochPosNums", ")", "\n", "for", "i", "in", "range", "(", "args", ".", "offNum", ")", ":", "\n", "                ", "ret", "[", "'RMSE_%d'", "%", "i", "]", "=", "np", ".", "sqrt", "(", "epochSqLoss", "[", "i", "]", "/", "epochTstNum", "[", "i", "]", ")", "\n", "ret", "[", "'MAE_%d'", "%", "i", "]", "=", "epochAbsLoss", "[", "i", "]", "/", "epochTstNum", "[", "i", "]", "\n", "ret", "[", "'MAPE_%d'", "%", "i", "]", "=", "epochApeLoss", "[", "i", "]", "/", "epochPosNums", "[", "i", "]", "\n", "\n", "", "ret", "[", "'RMSE_mask_1'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss1", ")", "/", "np", ".", "sum", "(", "epochTstNum1", ")", ")", "\n", "ret", "[", "'MAE_mask_1'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss1", ")", "/", "np", ".", "sum", "(", "epochTstNum1", ")", "\n", "ret", "[", "'MAPE_mask_1'", "]", "=", "np", ".", "sum", "(", "epochApeLoss1", ")", "/", "np", ".", "sum", "(", "epochPosNums1", ")", "\n", "\n", "ret", "[", "'RMSE_mask_2'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss2", ")", "/", "np", ".", "sum", "(", "epochTstNum2", ")", ")", "\n", "ret", "[", "'MAE_mask_2'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss2", ")", "/", "np", ".", "sum", "(", "epochTstNum2", ")", "\n", "ret", "[", "'MAPE_mask_2'", "]", "=", "np", ".", "sum", "(", "epochApeLoss2", ")", "/", "np", ".", "sum", "(", "epochPosNums2", ")", "\n", "\n", "ret", "[", "'RMSE_mask_3'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss3", ")", "/", "np", ".", "sum", "(", "epochTstNum3", ")", ")", "\n", "ret", "[", "'MAE_mask_3'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss3", ")", "/", "np", ".", "sum", "(", "epochTstNum3", ")", "\n", "ret", "[", "'MAPE_mask_3'", "]", "=", "np", ".", "sum", "(", "epochApeLoss3", ")", "/", "np", ".", "sum", "(", "epochPosNums3", ")", "\n", "\n", "ret", "[", "'RMSE_mask_4'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss4", ")", "/", "np", ".", "sum", "(", "epochTstNum4", ")", ")", "\n", "ret", "[", "'MAE_mask_4'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss4", ")", "/", "np", ".", "sum", "(", "epochTstNum4", ")", "\n", "ret", "[", "'MAPE_mask_4'", "]", "=", "np", ".", "sum", "(", "epochApeLoss4", ")", "/", "np", ".", "sum", "(", "epochPosNums4", ")", "\n", "ret", "[", "'epochLoss'", "]", "=", "epochLoss", "\n", "\n", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.sampleTestBatch": [[222, 242], ["numpy.transpose", "range", "numpy.concatenate", "numpy.expand_dims", "feat_list.append", "handler.zScore", "numpy.concatenate"], "function", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zScore"], ["", "", "def", "sampleTestBatch", "(", "batIds", ",", "st", ",", "ed", ",", "tstTensor", ",", "inpTensor", ",", "handler", ")", ":", "\n", "    ", "batch", "=", "ed", "-", "st", "\n", "idx", "=", "batIds", "[", "0", ":", "batch", "]", "\n", "label", "=", "tstTensor", "[", ":", ",", "idx", ",", ":", "]", "\n", "label", "=", "np", ".", "transpose", "(", "label", ",", "[", "1", ",", "0", ",", "2", "]", ")", "\n", "retLabels", "=", "label", "\n", "mask", "=", "handler", ".", "tstLocs", "*", "(", "label", ">", "0", ")", "\n", "\n", "feat_list", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "batch", ")", ":", "\n", "        ", "if", "idx", "[", "i", "]", "-", "args", ".", "temporalRange", "<", "0", ":", "\n", "            ", "temT", "=", "inpTensor", "[", ":", ",", "idx", "[", "i", "]", "-", "args", ".", "temporalRange", ":", ",", ":", "]", "\n", "temT2", "=", "tstTensor", "[", ":", ",", ":", "idx", "[", "i", "]", ",", ":", "]", "\n", "feat_one", "=", "np", ".", "concatenate", "(", "[", "temT", ",", "temT2", "]", ",", "axis", "=", "1", ")", "\n", "", "else", ":", "\n", "            ", "feat_one", "=", "tstTensor", "[", ":", ",", "idx", "[", "i", "]", "-", "args", ".", "temporalRange", ":", "idx", "[", "i", "]", ",", ":", "]", "\n", "", "feat_one", "=", "np", ".", "expand_dims", "(", "feat_one", ",", "axis", "=", "0", ")", "\n", "feat_list", ".", "append", "(", "feat_one", ")", "\n", "", "feats", "=", "np", ".", "concatenate", "(", "feat_list", ",", "axis", "=", "0", ")", "\n", "return", "handler", ".", "zScore", "(", "feats", ")", ",", "retLabels", ",", "mask", ",", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.test": [[244, 337], ["numpy.array", "len", "int", "range", "dict", "numpy.sqrt", "range", "numpy.sqrt", "numpy.sqrt", "numpy.sqrt", "numpy.sqrt", "list", "numpy.zeros", "numpy.zeros", "numpy.zeros", "numpy.zeros", "numpy.zeros", "numpy.ceil", "min", "engine.sampleTestBatch", "torch.Tensor().to", "torch.Tensor().to", "numpy.random.permutation", "model", "handler.zInverse", "utils.cal_metrics_r_mask", "utils.cal_metrics_r_mask", "utils.cal_metrics_r_mask", "utils.cal_metrics_r_mask", "utils.cal_metrics_r", "print", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sqrt", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "range", "range", "range", "range", "range", "range", "numpy.concatenate", "handler.zInverse.cpu().detach().numpy", "handler.zInverse.cpu().detach().numpy", "handler.zInverse.cpu().detach().numpy", "handler.zInverse.cpu().detach().numpy", "handler.zInverse.cpu().detach().numpy", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "torch.Tensor", "torch.Tensor", "handler.zInverse.cpu().detach", "handler.zInverse.cpu().detach", "handler.zInverse.cpu().detach", "handler.zInverse.cpu().detach", "handler.zInverse.cpu().detach", "handler.zInverse.cpu", "handler.zInverse.cpu", "handler.zInverse.cpu", "handler.zInverse.cpu", "handler.zInverse.cpu"], "function", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.sampleTestBatch", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zInverse", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r"], ["", "def", "test", "(", "model", ",", "handler", ")", ":", "\n", "    ", "ids", "=", "np", ".", "array", "(", "list", "(", "range", "(", "handler", ".", "tstT", ".", "shape", "[", "1", "]", ")", ")", ")", "\n", "epochLoss", ",", "epochPreLoss", ",", "=", "[", "0", "]", "*", "2", "\n", "epochSqLoss1", ",", "epochAbsLoss1", ",", "epochTstNum1", ",", "epochApeLoss1", ",", "epochPosNums1", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss2", ",", "epochAbsLoss2", ",", "epochTstNum2", ",", "epochApeLoss2", ",", "epochPosNums2", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss3", ",", "epochAbsLoss3", ",", "epochTstNum3", ",", "epochApeLoss3", ",", "epochPosNums3", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss4", ",", "epochAbsLoss4", ",", "epochTstNum4", ",", "epochApeLoss4", ",", "epochPosNums4", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "epochSqLoss", ",", "epochAbsLoss", ",", "epochTstNum", ",", "epochApeLoss", ",", "epochPosNums", "=", "[", "np", ".", "zeros", "(", "4", ")", "for", "i", "in", "range", "(", "5", ")", "]", "\n", "num", "=", "len", "(", "ids", ")", "\n", "\n", "steps", "=", "int", "(", "np", ".", "ceil", "(", "num", "/", "args", ".", "batch", ")", ")", "\n", "for", "i", "in", "range", "(", "steps", ")", ":", "\n", "        ", "st", "=", "i", "*", "args", ".", "batch", "\n", "ed", "=", "min", "(", "(", "i", "+", "1", ")", "*", "args", ".", "batch", ",", "num", ")", "\n", "batIds", "=", "ids", "[", "st", ":", "ed", "]", "\n", "\n", "tem", "=", "sampleTestBatch", "(", "batIds", ",", "st", ",", "ed", ",", "handler", ".", "tstT", ",", "np", ".", "concatenate", "(", "[", "handler", ".", "trnT", ",", "handler", ".", "valT", "]", ",", "axis", "=", "1", ")", ",", "handler", ")", "\n", "feats", ",", "labels", ",", "mask", "=", "tem", "\n", "feats", "=", "torch", ".", "Tensor", "(", "feats", ")", ".", "to", "(", "args", ".", "device", ")", "\n", "idx", "=", "np", ".", "random", ".", "permutation", "(", "args", ".", "areaNum", ")", "\n", "shuf_feats", "=", "feats", "[", ":", ",", "idx", ",", ":", ",", ":", "]", "\n", "\n", "out_local", ",", "eb_local", ",", "eb_global", ",", "DGI_pred", ",", "out_global", "=", "model", "(", "feats", ",", "shuf_feats", ")", "\n", "output", "=", "handler", ".", "zInverse", "(", "out_global", ")", "\n", "\n", "_", ",", "sqLoss1", ",", "absLoss1", ",", "tstNums1", ",", "apeLoss1", ",", "posNums1", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "handler", ".", "mask1", ")", "\n", "_", ",", "sqLoss2", ",", "absLoss2", ",", "tstNums2", ",", "apeLoss2", ",", "posNums2", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "handler", ".", "mask2", ")", "\n", "_", ",", "sqLoss3", ",", "absLoss3", ",", "tstNums3", ",", "apeLoss3", ",", "posNums3", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "handler", ".", "mask3", ")", "\n", "_", ",", "sqLoss4", ",", "absLoss4", ",", "tstNums4", ",", "apeLoss4", ",", "posNums4", "=", "utils", ".", "cal_metrics_r_mask", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ",", "handler", ".", "mask4", ")", "\n", "\n", "loss", ",", "sqLoss", ",", "absLoss", ",", "tstNums", ",", "apeLoss", ",", "posNums", "=", "utils", ".", "cal_metrics_r", "(", "output", ".", "cpu", "(", ")", ".", "detach", "(", ")", ".", "numpy", "(", ")", ",", "labels", ",", "mask", ")", "\n", "epochSqLoss", "+=", "sqLoss", "\n", "epochAbsLoss", "+=", "absLoss", "\n", "epochTstNum", "+=", "tstNums", "\n", "epochApeLoss", "+=", "apeLoss", "\n", "epochPosNums", "+=", "posNums", "\n", "\n", "epochSqLoss1", "+=", "sqLoss1", "\n", "epochAbsLoss1", "+=", "absLoss1", "\n", "epochTstNum1", "+=", "tstNums1", "\n", "epochApeLoss1", "+=", "apeLoss1", "\n", "epochPosNums1", "+=", "posNums1", "\n", "\n", "epochSqLoss2", "+=", "sqLoss2", "\n", "epochAbsLoss2", "+=", "absLoss2", "\n", "epochTstNum2", "+=", "tstNums2", "\n", "epochApeLoss2", "+=", "apeLoss2", "\n", "epochPosNums2", "+=", "posNums2", "\n", "\n", "epochSqLoss3", "+=", "sqLoss3", "\n", "epochAbsLoss3", "+=", "absLoss3", "\n", "epochTstNum3", "+=", "tstNums3", "\n", "epochApeLoss3", "+=", "apeLoss3", "\n", "epochPosNums3", "+=", "posNums3", "\n", "\n", "epochSqLoss4", "+=", "sqLoss4", "\n", "epochAbsLoss4", "+=", "absLoss4", "\n", "epochTstNum4", "+=", "tstNums4", "\n", "epochApeLoss4", "+=", "apeLoss4", "\n", "epochPosNums4", "+=", "posNums4", "\n", "\n", "epochLoss", "+=", "loss", "\n", "print", "(", "'Step %d/%d: loss = %.2f, regLoss = %.2f         '", "%", "(", "i", ",", "steps", ",", "loss", ",", "loss", ")", ",", "end", "=", "'\\r'", ")", "\n", "", "ret", "=", "dict", "(", ")", "\n", "\n", "ret", "[", "'RMSE'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss", ")", "/", "np", ".", "sum", "(", "epochTstNum", ")", ")", "\n", "ret", "[", "'MAE'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss", ")", "/", "np", ".", "sum", "(", "epochTstNum", ")", "\n", "ret", "[", "'MAPE'", "]", "=", "np", ".", "sum", "(", "epochApeLoss", ")", "/", "np", ".", "sum", "(", "epochPosNums", ")", "\n", "\n", "for", "i", "in", "range", "(", "args", ".", "offNum", ")", ":", "\n", "        ", "ret", "[", "'RMSE_%d'", "%", "i", "]", "=", "np", ".", "sqrt", "(", "epochSqLoss", "[", "i", "]", "/", "epochTstNum", "[", "i", "]", ")", "\n", "ret", "[", "'MAE_%d'", "%", "i", "]", "=", "epochAbsLoss", "[", "i", "]", "/", "epochTstNum", "[", "i", "]", "\n", "ret", "[", "'MAPE_%d'", "%", "i", "]", "=", "epochApeLoss", "[", "i", "]", "/", "epochPosNums", "[", "i", "]", "\n", "\n", "\n", "", "ret", "[", "'RMSE_mask_1'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss1", ")", "/", "np", ".", "sum", "(", "epochTstNum1", ")", ")", "\n", "ret", "[", "'MAE_mask_1'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss1", ")", "/", "np", ".", "sum", "(", "epochTstNum1", ")", "\n", "ret", "[", "'MAPE_mask_1'", "]", "=", "np", ".", "sum", "(", "epochApeLoss1", ")", "/", "np", ".", "sum", "(", "epochPosNums1", ")", "\n", "\n", "ret", "[", "'RMSE_mask_2'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss2", ")", "/", "np", ".", "sum", "(", "epochTstNum2", ")", ")", "\n", "ret", "[", "'MAE_mask_2'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss2", ")", "/", "np", ".", "sum", "(", "epochTstNum2", ")", "\n", "ret", "[", "'MAPE_mask_2'", "]", "=", "np", ".", "sum", "(", "epochApeLoss2", ")", "/", "np", ".", "sum", "(", "epochPosNums2", ")", "\n", "\n", "ret", "[", "'RMSE_mask_3'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss3", ")", "/", "np", ".", "sum", "(", "epochTstNum3", ")", ")", "\n", "ret", "[", "'MAE_mask_3'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss3", ")", "/", "np", ".", "sum", "(", "epochTstNum3", ")", "\n", "ret", "[", "'MAPE_mask_3'", "]", "=", "np", ".", "sum", "(", "epochApeLoss3", ")", "/", "np", ".", "sum", "(", "epochPosNums3", ")", "\n", "\n", "ret", "[", "'RMSE_mask_4'", "]", "=", "np", ".", "sqrt", "(", "np", ".", "sum", "(", "epochSqLoss4", ")", "/", "np", ".", "sum", "(", "epochTstNum4", ")", ")", "\n", "ret", "[", "'MAE_mask_4'", "]", "=", "np", ".", "sum", "(", "epochAbsLoss4", ")", "/", "np", ".", "sum", "(", "epochTstNum4", ")", "\n", "ret", "[", "'MAPE_mask_4'", "]", "=", "np", ".", "sum", "(", "epochApeLoss4", ")", "/", "np", ".", "sum", "(", "epochPosNums4", ")", "\n", "ret", "[", "'epochLoss'", "]", "=", "epochLoss", "\n", "\n", "return", "ret", "", "", ""]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.__init__": [[6, 37], ["print", "numpy.reshape", "numpy.reshape", "numpy.reshape", "numpy.mean", "numpy.std", "DataHandler.DataHandler.getSparsity", "DataHandler.DataHandler.getTestAreas", "print", "print", "open", "pickle.load", "open", "pickle.load", "open", "pickle.load", "numpy.sum", "numpy.reshape"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.getSparsity", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.getTestAreas"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "if", "args", ".", "data", "==", "'NYC'", ":", "\n", "            ", "predir", "=", "'Datasets/NYC_crime/'", "\n", "", "elif", "args", ".", "data", "==", "'CHI'", ":", "\n", "            ", "predir", "=", "'Datasets/CHI_crime/'", "\n", "", "else", ":", "\n", "            ", "predir", "=", "None", "\n", "", "self", ".", "predir", "=", "predir", "\n", "with", "open", "(", "predir", "+", "'trn.pkl'", ",", "'rb'", ")", "as", "fs", ":", "\n", "            ", "trnT", "=", "pickle", ".", "load", "(", "fs", ")", "\n", "", "with", "open", "(", "predir", "+", "'val.pkl'", ",", "'rb'", ")", "as", "fs", ":", "\n", "            ", "valT", "=", "pickle", ".", "load", "(", "fs", ")", "\n", "", "with", "open", "(", "predir", "+", "'tst.pkl'", ",", "'rb'", ")", "as", "fs", ":", "\n", "            ", "tstT", "=", "pickle", ".", "load", "(", "fs", ")", "\n", "", "print", "(", "\"self.predir\"", ",", "self", ".", "predir", ")", "\n", "args", ".", "row", ",", "args", ".", "col", ",", "_", ",", "args", ".", "offNum", "=", "trnT", ".", "shape", "\n", "args", ".", "areaNum", "=", "args", ".", "row", "*", "args", ".", "col", "\n", "args", ".", "trnDays", "=", "trnT", ".", "shape", "[", "2", "]", "\n", "args", ".", "valDays", "=", "valT", ".", "shape", "[", "2", "]", "\n", "args", ".", "tstDays", "=", "tstT", ".", "shape", "[", "2", "]", "\n", "args", ".", "decay_step", "=", "args", ".", "trnDays", "//", "args", ".", "batch", "\n", "\n", "self", ".", "trnT", "=", "np", ".", "reshape", "(", "trnT", ",", "[", "args", ".", "areaNum", ",", "-", "1", ",", "args", ".", "offNum", "]", ")", "\n", "self", ".", "valT", "=", "np", ".", "reshape", "(", "valT", ",", "[", "args", ".", "areaNum", ",", "-", "1", ",", "args", ".", "offNum", "]", ")", "\n", "self", ".", "tstT", "=", "np", ".", "reshape", "(", "tstT", ",", "[", "args", ".", "areaNum", ",", "-", "1", ",", "args", ".", "offNum", "]", ")", "\n", "self", ".", "mean", "=", "np", ".", "mean", "(", "trnT", ")", "\n", "self", ".", "std", "=", "np", ".", "std", "(", "trnT", ")", "\n", "self", ".", "mask1", ",", "self", ".", "mask2", ",", "self", ".", "mask3", ",", "self", ".", "mask4", "=", "self", ".", "getSparsity", "(", ")", "\n", "self", ".", "getTestAreas", "(", ")", "\n", "print", "(", "'Row:'", ",", "args", ".", "row", ",", "', Col:'", ",", "args", ".", "col", ")", "\n", "print", "(", "'Sparsity:'", ",", "np", ".", "sum", "(", "trnT", "!=", "0", ")", "/", "np", ".", "reshape", "(", "trnT", ",", "[", "-", "1", "]", ")", ".", "shape", "[", "0", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zScore": [[38, 40], ["None"], "methods", ["None"], ["", "def", "zScore", "(", "self", ",", "data", ")", ":", "\n", "        ", "return", "(", "data", "-", "self", ".", "mean", ")", "/", "self", ".", "std", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.zInverse": [[41, 43], ["None"], "methods", ["None"], ["", "def", "zInverse", "(", "self", ",", "data", ")", ":", "\n", "        ", "return", "data", "*", "self", ".", "std", "+", "self", ".", "mean", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.getSparsity": [[44, 68], ["print", "numpy.zeros", "range", "numpy.zeros_like", "numpy.zeros_like", "numpy.zeros_like", "numpy.zeros_like", "range", "range", "range", "numpy.sum"], "methods", ["None"], ["", "def", "getSparsity", "(", "self", ")", ":", "\n", "        ", "data", "=", "self", ".", "tstT", "\n", "print", "(", "data", ".", "shape", ")", "\n", "day", "=", "data", ".", "shape", "[", "1", "]", "\n", "mask", "=", "1", "*", "(", "data", ">", "0", ")", "\n", "p1", "=", "np", ".", "zeros", "(", "[", "data", ".", "shape", "[", "0", "]", ",", "data", ".", "shape", "[", "2", "]", "]", ")", "\n", "for", "cate", "in", "range", "(", "4", ")", ":", "\n", "            ", "for", "region", "in", "range", "(", "mask", ".", "shape", "[", "0", "]", ")", ":", "\n", "                ", "p1", "[", "region", ",", "cate", "]", "=", "np", ".", "sum", "(", "mask", "[", "region", ",", ":", ",", "cate", "]", ",", "axis", "=", "0", ")", "/", "day", "\n", "", "", "mask1", "=", "np", ".", "zeros_like", "(", "p1", ")", "\n", "mask2", "=", "np", ".", "zeros_like", "(", "p1", ")", "\n", "mask3", "=", "np", ".", "zeros_like", "(", "p1", ")", "\n", "mask4", "=", "np", ".", "zeros_like", "(", "p1", ")", "\n", "for", "cate1", "in", "range", "(", "4", ")", ":", "\n", "            ", "for", "region1", "in", "range", "(", "mask", ".", "shape", "[", "0", "]", ")", ":", "\n", "                ", "if", "p1", "[", "region1", ",", "cate1", "]", ">", "0", "and", "p1", "[", "region1", ",", "cate1", "]", "<=", "0.25", ":", "\n", "                    ", "mask1", "[", "region1", ",", "cate1", "]", "=", "1", "\n", "", "elif", "p1", "[", "region1", ",", "cate1", "]", ">", "0.25", "and", "p1", "[", "region1", ",", "cate1", "]", "<=", "0.5", ":", "\n", "                    ", "mask2", "[", "region1", ",", "cate1", "]", "=", "1", "\n", "", "elif", "p1", "[", "region1", ",", "cate1", "]", ">", "0.5", "and", "p1", "[", "region1", ",", "cate1", "]", "<=", "0.75", ":", "\n", "                    ", "mask3", "[", "region1", ",", "cate1", "]", "=", "1", "\n", "", "elif", "p1", "[", "region1", ",", "cate1", "]", ">", "0.75", "and", "p1", "[", "region1", ",", "cate1", "]", "<=", "1", ":", "\n", "                    ", "mask4", "[", "region1", ",", "cate1", "]", "=", "1", "\n", "", "", "", "return", "mask1", ",", "mask2", ",", "mask3", ",", "mask4", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.DataHandler.DataHandler.getTestAreas": [[69, 73], ["numpy.sum"], "methods", ["None"], ["", "def", "getTestAreas", "(", "self", ")", ":", "\n", "        ", "posTimes", "=", "np", ".", "sum", "(", "1", "*", "(", "self", ".", "trnT", "!=", "0", ")", ",", "axis", "=", "1", ")", "\n", "percent", "=", "posTimes", "/", "args", ".", "trnDays", "\n", "self", ".", "tstLocs", "=", "(", "percent", ">", "-", "1", ")", "*", "1", "", "", "", ""]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.train.main": [[8, 48], ["utils.seed_torch", "torch.device", "engine.trainer", "print", "dict", "range", "print", "time.time", "engine.trainer.train", "print", "print", "print", "time.time", "train_time.append", "utils.makePrint", "engine.trainer.eval", "engine.trainer.eval", "torch.save", "print", "engine.trainer.model.state_dict", "print", "utils.makePrint", "time.time", "str", "round", "str", "round", "str"], "function", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.seed_torch", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.train", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.makePrint", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.eval", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.eval", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.makePrint"], ["def", "main", "(", ")", ":", "\n", "    ", "seed_torch", "(", ")", "\n", "device", "=", "torch", ".", "device", "(", "'cuda:0'", ")", "\n", "engine", "=", "trainer", "(", "device", ")", "\n", "print", "(", "\"start training...\"", ",", "flush", "=", "True", ")", "\n", "train_time", "=", "[", "]", "\n", "bestRes", "=", "None", "\n", "eval_bestRes", "=", "dict", "(", ")", "\n", "eval_bestRes", "[", "'RMSE'", "]", ",", "eval_bestRes", "[", "'MAE'", "]", ",", "eval_bestRes", "[", "'MAPE'", "]", "=", "1e6", ",", "1e6", ",", "1e6", "\n", "update", "=", "False", "\n", "\n", "for", "i", "in", "range", "(", "1", ",", "args", ".", "epoch", "+", "1", ")", ":", "\n", "        ", "t1", "=", "time", ".", "time", "(", ")", "\n", "metrics", ",", "metrics1", "=", "engine", ".", "train", "(", ")", "\n", "print", "(", "f'Epoch {i:2d} Training Time {time.time() - t1:.3f}s'", ")", "\n", "ret", "=", "'Epoch %d/%d, %s %.4f,  %s %.4f'", "%", "(", "i", ",", "args", ".", "epoch", ",", "'Train Loss = '", ",", "metrics", ",", "'preLoss = '", ",", "metrics1", ")", "\n", "print", "(", "ret", ")", "\n", "\n", "test", "=", "(", "i", "%", "args", ".", "tstEpoch", "==", "0", ")", "\n", "if", "test", ":", "\n", "            ", "res_eval", "=", "engine", ".", "eval", "(", "True", ",", "True", ")", "\n", "val_metrics", "=", "res_eval", "[", "'RMSE'", "]", "+", "res_eval", "[", "'MAE'", "]", "\n", "val_best_metrics", "=", "eval_bestRes", "[", "'RMSE'", "]", "+", "eval_bestRes", "[", "'MAE'", "]", "\n", "if", "(", "val_metrics", ")", "<", "(", "val_best_metrics", ")", ":", "\n", "                ", "print", "(", "'%s %.4f, %s %.4f'", "%", "(", "'Val metrics decrease from'", ",", "val_best_metrics", ",", "'to'", ",", "val_metrics", ")", ")", "\n", "eval_bestRes", "[", "'RMSE'", "]", "=", "res_eval", "[", "'RMSE'", "]", "\n", "eval_bestRes", "[", "'MAE'", "]", "=", "res_eval", "[", "'MAE'", "]", "\n", "update", "=", "True", "\n", "", "reses", "=", "engine", ".", "eval", "(", "False", ",", "True", ")", "\n", "torch", ".", "save", "(", "engine", ".", "model", ".", "state_dict", "(", ")", ",", "\n", "args", ".", "save", "+", "args", ".", "data", "+", "\"/\"", "+", "\"_epoch_\"", "+", "str", "(", "i", ")", "+", "\"_MAE_\"", "+", "str", "(", "round", "(", "reses", "[", "'MAE'", "]", ",", "2", ")", ")", "+", "\"_MAPE_\"", "+", "str", "(", "\n", "round", "(", "reses", "[", "'MAPE'", "]", ",", "2", ")", ")", "+", "\".pth\"", ")", "\n", "if", "update", ":", "\n", "                ", "print", "(", "makePrint", "(", "'Test'", ",", "i", ",", "reses", ")", ")", "\n", "bestRes", "=", "reses", "\n", "update", "=", "False", "\n", "", "", "print", "(", ")", "\n", "t2", "=", "time", ".", "time", "(", ")", "\n", "train_time", ".", "append", "(", "t2", "-", "t1", ")", "\n", "", "print", "(", "makePrint", "(", "'Best'", ",", "args", ".", "epoch", ",", "bestRes", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.Params.parse_args": [[3, 26], ["argparse.ArgumentParser", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.add_argument", "argparse.ArgumentParser.parse_args"], "function", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.Params.parse_args"], ["def", "parse_args", "(", ")", ":", "\n", "    ", "parser", "=", "argparse", ".", "ArgumentParser", "(", "description", "=", "'Model Params'", ")", "\n", "parser", ".", "add_argument", "(", "'--lr'", ",", "default", "=", "1e-3", ",", "type", "=", "float", ",", "help", "=", "'learning rate'", ")", "\n", "parser", ".", "add_argument", "(", "'--weight_decay'", ",", "default", "=", "1e-4", ",", "type", "=", "float", ",", "help", "=", "'weight_decay'", ")", "\n", "parser", ".", "add_argument", "(", "'--cr'", ",", "default", "=", "0.8", ",", "type", "=", "float", ",", "help", "=", "'contrastive loss rate'", ")", "\n", "parser", ".", "add_argument", "(", "'--ir'", ",", "default", "=", "1", ",", "type", "=", "float", ",", "help", "=", "'infomax loss rate'", ")", "\n", "parser", ".", "add_argument", "(", "'--t'", ",", "default", "=", "0.05", ",", "type", "=", "float", ",", "help", "=", "'temperature'", ")", "\n", "parser", ".", "add_argument", "(", "'--batch'", ",", "default", "=", "16", ",", "type", "=", "int", ",", "help", "=", "'batch size'", ")", "\n", "parser", ".", "add_argument", "(", "'--epoch'", ",", "default", "=", "25", ",", "type", "=", "int", ",", "help", "=", "'number of epochs'", ")", "\n", "parser", ".", "add_argument", "(", "'--latdim'", ",", "default", "=", "16", ",", "type", "=", "int", ",", "help", "=", "'embedding size'", ")", "\n", "parser", ".", "add_argument", "(", "'--temporalRange'", ",", "default", "=", "30", ",", "type", "=", "int", ",", "help", "=", "'number of hops for temporal features'", ")", "\n", "parser", ".", "add_argument", "(", "'--cateNum'", ",", "default", "=", "4", ",", "type", "=", "int", ",", "help", "=", "'number of categories'", ")", "\n", "parser", ".", "add_argument", "(", "'--data'", ",", "default", "=", "'NYC'", ",", "type", "=", "str", ",", "help", "=", "'name of dataset'", ")", "\n", "parser", ".", "add_argument", "(", "'--kernelSize'", ",", "default", "=", "3", ",", "type", "=", "int", ",", "help", "=", "'size of kernel'", ")", "\n", "parser", ".", "add_argument", "(", "'--border'", ",", "default", "=", "0.5", ",", "type", "=", "float", ",", "help", "=", "'border line for pos and neg predictions'", ")", "\n", "parser", ".", "add_argument", "(", "'--hyperNum'", ",", "default", "=", "128", ",", "type", "=", "int", ",", "help", "=", "'number of hyper edges'", ")", "\n", "parser", ".", "add_argument", "(", "'--dropRateL'", ",", "default", "=", "0.2", ",", "type", "=", "float", ",", "help", "=", "'drop rate for local encoder'", ")", "\n", "parser", ".", "add_argument", "(", "'--dropRateG'", ",", "default", "=", "0.1", ",", "type", "=", "float", ",", "help", "=", "'drop rate for global encoder'", ")", "\n", "parser", ".", "add_argument", "(", "'--device'", ",", "type", "=", "str", ",", "default", "=", "'cuda:0'", ",", "help", "=", "'cuda device'", ")", "\n", "parser", ".", "add_argument", "(", "'--tstEpoch'", ",", "default", "=", "1", ",", "type", "=", "int", ",", "help", "=", "'number of epoch to test while training'", ")", "\n", "parser", ".", "add_argument", "(", "'--save'", ",", "type", "=", "str", ",", "default", "=", "'./Save/'", ",", "help", "=", "'save path'", ")", "\n", "parser", ".", "add_argument", "(", "'--checkpoint'", ",", "type", "=", "str", ",", "default", "=", "'./Save/NYC/'", ",", "help", "=", "'test path'", ")", "\n", "return", "parser", ".", "parse_args", "(", ")", "\n", "", "args", "=", "parse_args", "(", ")", ""]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.test.main": [[8, 21], ["torch.device", "DataHandler.DataHandler", "model.STHSL", "model.STHSL.to", "model.STHSL.load_state_dict", "model.STHSL.eval", "print", "print", "torch.load", "torch.no_grad", "engine.test", "train.makePrint"], "function", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.trainer.eval", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.engine.test", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.makePrint"], ["def", "main", "(", ")", ":", "\n", "    ", "device", "=", "torch", ".", "device", "(", "args", ".", "device", ")", "\n", "handler", "=", "DataHandler", "(", ")", "\n", "model", "=", "STHSL", "(", ")", "\n", "model", ".", "to", "(", "device", ")", "\n", "model", ".", "load_state_dict", "(", "torch", ".", "load", "(", "args", ".", "checkpoint", ")", ")", "\n", "model", ".", "eval", "(", ")", "\n", "print", "(", "'model load successfully'", ")", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "reses", "=", "test", "(", "model", ",", "handler", ")", "\n", "\n", "", "print", "(", "makePrint", "(", "'Best'", ",", "args", ".", "epoch", ",", "reses", ")", ")", "\n", "", "if", "__name__", "==", "\"__main__\"", ":", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.spa_cnn_local.__init__": [[8, 16], ["torch.Module.__init__", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Dropout", "torch.Dropout", "torch.LeakyReLU", "torch.LeakyReLU", "int", "int", "int", "int", "int", "int", "int", "int"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ",", "input_dim", ",", "output_dim", ",", ")", ":", "\n", "        ", "super", "(", "spa_cnn_local", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "spaConv1", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "kernel_size", "=", "[", "args", ".", "kernelSize", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "stride", "=", "1", ",", "padding", "=", "[", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "spaConv2", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "kernel_size", "=", "[", "args", ".", "kernelSize", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "stride", "=", "1", ",", "padding", "=", "[", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "spaConv3", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "kernel_size", "=", "[", "args", ".", "kernelSize", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "stride", "=", "1", ",", "padding", "=", "[", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "spaConv4", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "kernel_size", "=", "[", "args", ".", "kernelSize", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "stride", "=", "1", ",", "padding", "=", "[", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "drop", "=", "nn", ".", "Dropout", "(", "args", ".", "dropRateL", ")", "\n", "self", ".", "act_lr", "=", "nn", ".", "LeakyReLU", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.spa_cnn_local.forward": [[17, 24], ["model.spa_cnn_local.drop", "model.spa_cnn_local.drop", "model.spa_cnn_local.drop", "model.spa_cnn_local.drop", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "model.spa_cnn_local.act_lr", "model.spa_cnn_local.spaConv1", "model.spa_cnn_local.spaConv2", "model.spa_cnn_local.spaConv3", "model.spa_cnn_local.spaConv4"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "embeds", ")", ":", "\n", "        ", "cate_1", "=", "self", ".", "drop", "(", "self", ".", "spaConv1", "(", "embeds", ")", ")", "\n", "cate_2", "=", "self", ".", "drop", "(", "self", ".", "spaConv2", "(", "embeds", ")", ")", "\n", "cate_3", "=", "self", ".", "drop", "(", "self", ".", "spaConv3", "(", "embeds", ")", ")", "\n", "cate_4", "=", "self", ".", "drop", "(", "self", ".", "spaConv4", "(", "embeds", ")", ")", "\n", "spa_cate", "=", "torch", ".", "cat", "(", "[", "cate_1", ",", "cate_2", ",", "cate_3", ",", "cate_4", "]", ",", "dim", "=", "-", "1", ")", "\n", "return", "self", ".", "act_lr", "(", "spa_cate", "+", "embeds", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.tem_cnn_local.__init__": [[27, 35], ["torch.Module.__init__", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.Conv3d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Dropout", "torch.Dropout", "int", "int", "int", "int"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ",", "input_dim", ",", "output_dim", ")", ":", "\n", "        ", "super", "(", "tem_cnn_local", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "temConv1", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "stride", "=", "[", "1", ",", "1", ",", "1", "]", ",", "kernel_size", "=", "[", "1", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "padding", "=", "[", "0", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "temConv2", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "stride", "=", "[", "1", ",", "1", ",", "1", "]", ",", "kernel_size", "=", "[", "1", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "padding", "=", "[", "0", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "temConv3", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "stride", "=", "[", "1", ",", "1", ",", "1", "]", ",", "kernel_size", "=", "[", "1", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "padding", "=", "[", "0", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "temConv4", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "stride", "=", "[", "1", ",", "1", ",", "1", "]", ",", "kernel_size", "=", "[", "1", ",", "args", ".", "kernelSize", ",", "args", ".", "cateNum", "]", ",", "padding", "=", "[", "0", ",", "int", "(", "(", "args", ".", "kernelSize", "-", "1", ")", "/", "2", ")", ",", "0", "]", ")", "\n", "self", ".", "act_lr", "=", "nn", ".", "LeakyReLU", "(", ")", "\n", "self", ".", "drop", "=", "nn", ".", "Dropout", "(", "args", ".", "dropRateL", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.tem_cnn_local.forward": [[36, 43], ["model.tem_cnn_local.drop", "model.tem_cnn_local.drop", "model.tem_cnn_local.drop", "model.tem_cnn_local.drop", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "model.tem_cnn_local.act_lr", "model.tem_cnn_local.temConv1", "model.tem_cnn_local.temConv2", "model.tem_cnn_local.temConv3", "model.tem_cnn_local.temConv4"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "embeds", ")", ":", "\n", "        ", "cate_1", "=", "self", ".", "drop", "(", "self", ".", "temConv1", "(", "embeds", ")", ")", "\n", "cate_2", "=", "self", ".", "drop", "(", "self", ".", "temConv2", "(", "embeds", ")", ")", "\n", "cate_3", "=", "self", ".", "drop", "(", "self", ".", "temConv3", "(", "embeds", ")", ")", "\n", "cate_4", "=", "self", ".", "drop", "(", "self", ".", "temConv4", "(", "embeds", ")", ")", "\n", "tem_cate", "=", "torch", ".", "cat", "(", "[", "cate_1", ",", "cate_2", ",", "cate_3", ",", "cate_4", "]", ",", "dim", "=", "-", "1", ")", "\n", "return", "self", ".", "act_lr", "(", "tem_cate", "+", "embeds", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Hypergraph.__init__": [[48, 53], ["torch.Module.__init__", "torch.Parameter", "torch.Parameter", "torch.Conv3d", "torch.Conv3d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.randn", "torch.randn", "torch.randn", "torch.randn"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Hypergraph", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "adj", "=", "nn", ".", "Parameter", "(", "torch", ".", "Tensor", "(", "torch", ".", "randn", "(", "[", "args", ".", "temporalRange", ",", "args", ".", "hyperNum", ",", "args", ".", "areaNum", "*", "args", ".", "cateNum", "]", ")", ")", ",", "requires_grad", "=", "True", ")", "\n", "self", ".", "Conv", "=", "nn", ".", "Conv3d", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ",", "kernel_size", "=", "1", ")", "\n", "self", ".", "act1", "=", "nn", ".", "LeakyReLU", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Hypergraph.forward": [[54, 62], ["adj.transpose", "embeds.transpose().contiguous().view", "model.Hypergraph.act1", "model.Hypergraph.act1", "retEmbeds.view().transpose.view().transpose.view().transpose", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "embeds.transpose().contiguous", "retEmbeds.view().transpose.view().transpose.view", "embeds.transpose"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "embeds", ")", ":", "\n", "        ", "adj", "=", "self", ".", "adj", "\n", "tpadj", "=", "adj", ".", "transpose", "(", "2", ",", "1", ")", "\n", "embeds_cate", "=", "embeds", ".", "transpose", "(", "2", ",", "3", ")", ".", "contiguous", "(", ")", ".", "view", "(", "embeds", ".", "shape", "[", "0", "]", ",", "args", ".", "latdim", ",", "args", ".", "temporalRange", ",", "-", "1", ")", "\n", "hyperEmbeds", "=", "self", ".", "act1", "(", "torch", ".", "einsum", "(", "'thn,bdtn->bdth'", ",", "adj", ",", "embeds_cate", ")", ")", "\n", "retEmbeds", "=", "self", ".", "act1", "(", "torch", ".", "einsum", "(", "'tnh,bdth->bdtn'", ",", "tpadj", ",", "hyperEmbeds", ")", ")", "\n", "retEmbeds", "=", "retEmbeds", ".", "view", "(", "embeds", ".", "shape", "[", "0", "]", ",", "args", ".", "latdim", ",", "args", ".", "temporalRange", ",", "args", ".", "areaNum", ",", "args", ".", "cateNum", ")", ".", "transpose", "(", "2", ",", "3", ")", "\n", "return", "retEmbeds", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.AvgReadout.__init__": [[65, 67], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "AvgReadout", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.AvgReadout.forward": [[68, 70], ["torch.mean", "torch.mean", "torch.mean", "torch.mean"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "embeds", ")", ":", "\n", "        ", "return", "torch", ".", "mean", "(", "embeds", ",", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Discriminator.__init__": [[73, 79], ["torch.Module.__init__", "torch.Bilinear", "torch.Bilinear", "model.Discriminator.modules", "model.Discriminator.weights_init"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__", "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Discriminator.weights_init"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Discriminator", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "f_k", "=", "nn", ".", "Bilinear", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ",", "1", ")", "\n", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "self", ".", "weights_init", "(", "m", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Discriminator.weights_init": [[80, 85], ["isinstance", "torch.nn.init.xavier_uniform_", "torch.nn.init.xavier_uniform_", "torch.nn.init.xavier_uniform_", "torch.nn.init.xavier_uniform_", "m.bias.data.fill_"], "methods", ["None"], ["", "", "def", "weights_init", "(", "self", ",", "m", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Bilinear", ")", ":", "\n", "            ", "torch", ".", "nn", ".", "init", ".", "xavier_uniform_", "(", "m", ".", "weight", ".", "data", ")", "\n", "if", "m", ".", "bias", "is", "not", "None", ":", "\n", "                ", "m", ".", "bias", ".", "data", ".", "fill_", "(", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Discriminator.forward": [[86, 96], ["torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "score.transpose().contiguous.transpose().contiguous.expand_as", "score.transpose().contiguous.transpose().contiguous.transpose().contiguous", "h_pos.transpose().contiguous.transpose().contiguous.transpose().contiguous", "h_neg.transpose().contiguous.transpose().contiguous.transpose().contiguous", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "model.Discriminator.f_k", "model.Discriminator.f_k", "score.transpose().contiguous.transpose().contiguous.transpose", "h_pos.transpose().contiguous.transpose().contiguous.transpose", "h_neg.transpose().contiguous.transpose().contiguous.transpose", "torch.squeeze.mean", "torch.squeeze.mean", "torch.squeeze.mean", "torch.squeeze.mean"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "score", ",", "h_pos", ",", "h_neg", ")", ":", "\n", "        ", "score", "=", "torch", ".", "unsqueeze", "(", "score", ",", "2", ")", "\n", "score", "=", "score", ".", "expand_as", "(", "h_pos", ")", "\n", "score", "=", "score", ".", "transpose", "(", "1", ",", "4", ")", ".", "contiguous", "(", ")", "\n", "h_pos", "=", "h_pos", ".", "transpose", "(", "1", ",", "4", ")", ".", "contiguous", "(", ")", "\n", "h_neg", "=", "h_neg", ".", "transpose", "(", "1", ",", "4", ")", ".", "contiguous", "(", ")", "\n", "sc_pos", "=", "torch", ".", "squeeze", "(", "self", ".", "f_k", "(", "h_pos", ",", "score", ")", ",", "-", "1", ")", "\n", "sc_neg", "=", "torch", ".", "squeeze", "(", "self", ".", "f_k", "(", "h_neg", ",", "score", ")", ",", "-", "1", ")", "\n", "logits", "=", "torch", ".", "cat", "(", "(", "sc_pos", ".", "mean", "(", "-", "1", ")", ",", "sc_neg", ".", "mean", "(", "-", "1", ")", ")", ",", "dim", "=", "2", ")", "\n", "return", "logits", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Hypergraph_Infomax.__init__": [[99, 105], ["torch.Module.__init__", "model.Hypergraph", "model.AvgReadout", "torch.Sigmoid", "torch.Sigmoid", "model.Discriminator"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Hypergraph_Infomax", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "Hypergraph", "=", "Hypergraph", "(", ")", "\n", "self", ".", "readout", "=", "AvgReadout", "(", ")", "\n", "self", ".", "sigm", "=", "nn", ".", "Sigmoid", "(", ")", "\n", "self", ".", "disc", "=", "Discriminator", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Hypergraph_Infomax.forward": [[106, 113], ["model.Hypergraph_Infomax.Hypergraph", "model.Hypergraph_Infomax.readout", "model.Hypergraph_Infomax.sigm", "model.Hypergraph_Infomax.Hypergraph", "model.Hypergraph_Infomax.disc"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "eb_pos", ",", "eb_neg", ")", ":", "\n", "        ", "h_pos", "=", "self", ".", "Hypergraph", "(", "eb_pos", ")", "\n", "c", "=", "self", ".", "readout", "(", "h_pos", ")", "\n", "score", "=", "self", ".", "sigm", "(", "c", ")", "\n", "h_neg", "=", "self", ".", "Hypergraph", "(", "eb_neg", ")", "\n", "ret", "=", "self", ".", "disc", "(", "score", ",", "h_pos", ",", "h_neg", ")", "\n", "return", "h_pos", ",", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.tem_cnn_global.__init__": [[116, 122], ["torch.Module.__init__", "torch.Conv3d", "torch.Conv3d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Dropout", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ",", "input_dim", ",", "output_dim", ",", "kernel_size", ")", ":", "\n", "        ", "super", "(", "tem_cnn_global", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "kernel_size", "=", "kernel_size", "\n", "self", ".", "temConv", "=", "nn", ".", "Conv3d", "(", "input_dim", ",", "output_dim", ",", "kernel_size", "=", "[", "1", ",", "kernel_size", ",", "1", "]", ",", "stride", "=", "1", ",", "padding", "=", "[", "0", ",", "0", ",", "0", "]", ")", "\n", "self", ".", "act", "=", "nn", ".", "LeakyReLU", "(", ")", "\n", "self", ".", "drop", "=", "nn", ".", "Dropout", "(", "args", ".", "dropRateG", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.tem_cnn_global.forward": [[123, 127], ["model.tem_cnn_global.temConv", "model.tem_cnn_global.drop", "model.tem_cnn_global.act"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "embeds", ")", ":", "\n", "        ", "ret_flow", "=", "self", ".", "temConv", "(", "embeds", ")", "\n", "ret_drop", "=", "self", ".", "drop", "(", "ret_flow", ")", "\n", "return", "self", ".", "act", "(", "ret_drop", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Transform_3d.__init__": [[130, 134], ["torch.Module.__init__", "torch.BatchNorm3d", "torch.BatchNorm3d", "torch.Conv3d", "torch.Conv3d"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Transform_3d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "BN", "=", "nn", ".", "BatchNorm3d", "(", "args", ".", "latdim", ")", "\n", "self", ".", "Conv1", "=", "nn", ".", "Conv3d", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ",", "kernel_size", "=", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.Transform_3d.forward": [[135, 139], ["model.Transform_3d.BN", "model.Transform_3d.Conv1"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "embeds", ")", ":", "\n", "        ", "embeds_BN", "=", "self", ".", "BN", "(", "embeds", ")", "\n", "embeds1", "=", "self", ".", "Conv1", "(", "embeds_BN", ")", "\n", "return", "embeds1", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__": [[142, 162], ["torch.Module.__init__", "torch.Conv3d", "torch.Conv3d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "model.spa_cnn_local", "model.spa_cnn_local", "model.tem_cnn_local", "model.tem_cnn_local", "model.Hypergraph_Infomax", "model.tem_cnn_global", "model.tem_cnn_global", "model.tem_cnn_global", "model.tem_cnn_global", "model.Transform_3d", "model.Transform_3d"], "methods", ["home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "STHSL", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "dimConv_in", "=", "nn", ".", "Conv3d", "(", "1", ",", "args", ".", "latdim", ",", "kernel_size", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", "\n", "self", ".", "dimConv_local", "=", "nn", ".", "Conv2d", "(", "args", ".", "latdim", ",", "1", ",", "kernel_size", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", "\n", "self", ".", "dimConv_global", "=", "nn", ".", "Conv2d", "(", "args", ".", "latdim", ",", "1", ",", "kernel_size", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", "\n", "\n", "self", ".", "spa_cnn_local1", "=", "spa_cnn_local", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ")", "\n", "self", ".", "spa_cnn_local2", "=", "spa_cnn_local", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ")", "\n", "self", ".", "tem_cnn_local1", "=", "tem_cnn_local", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ")", "\n", "self", ".", "tem_cnn_local2", "=", "tem_cnn_local", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ")", "\n", "\n", "self", ".", "Hypergraph_Infomax", "=", "Hypergraph_Infomax", "(", ")", "\n", "self", ".", "tem_cnn_global1", "=", "tem_cnn_global", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ",", "9", ")", "\n", "self", ".", "tem_cnn_global2", "=", "tem_cnn_global", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ",", "9", ")", "\n", "self", ".", "tem_cnn_global3", "=", "tem_cnn_global", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ",", "9", ")", "\n", "self", ".", "tem_cnn_global4", "=", "tem_cnn_global", "(", "args", ".", "latdim", ",", "args", ".", "latdim", ",", "6", ")", "\n", "\n", "self", ".", "local_tra", "=", "Transform_3d", "(", ")", "\n", "self", ".", "global_tra", "=", "Transform_3d", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.model.STHSL.forward": [[164, 186], ["model.STHSL.dimConv_in", "model.STHSL.dimConv_in", "model.STHSL.permute().contiguous().view", "model.STHSL.spa_cnn_local1", "model.STHSL.spa_cnn_local2", "spa_local2.view().permute.view().permute.view().permute", "model.STHSL.tem_cnn_local1", "model.STHSL.tem_cnn_local2", "model.STHSL.mean", "model.STHSL.local_tra", "model.STHSL.dimConv_local().squeeze", "model.STHSL.Hypergraph_Infomax", "model.STHSL.tem_cnn_global1", "model.STHSL.tem_cnn_global2", "model.STHSL.tem_cnn_global3", "model.STHSL.tem_cnn_global4", "model.STHSL.squeeze", "model.STHSL.global_tra", "model.STHSL.dimConv_global().squeeze", "embeds_true.unsqueeze", "neg.unsqueeze", "model.STHSL.permute().contiguous", "spa_local2.view().permute.view().permute.view", "model.STHSL.dimConv_local", "model.STHSL.dimConv_global", "model.STHSL.permute"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "embeds_true", ",", "neg", ")", ":", "\n", "        ", "embeds_in_global", "=", "self", ".", "dimConv_in", "(", "embeds_true", ".", "unsqueeze", "(", "1", ")", ")", "\n", "DGI_neg", "=", "self", ".", "dimConv_in", "(", "neg", ".", "unsqueeze", "(", "1", ")", ")", "\n", "embeds_in_local", "=", "embeds_in_global", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ",", "4", ")", ".", "contiguous", "(", ")", ".", "view", "(", "-", "1", ",", "args", ".", "latdim", ",", "args", ".", "row", ",", "args", ".", "col", ",", "4", ")", "\n", "spa_local1", "=", "self", ".", "spa_cnn_local1", "(", "embeds_in_local", ")", "\n", "spa_local2", "=", "self", ".", "spa_cnn_local2", "(", "spa_local1", ")", "\n", "spa_local2", "=", "spa_local2", ".", "view", "(", "-", "1", ",", "args", ".", "temporalRange", ",", "args", ".", "latdim", ",", "args", ".", "areaNum", ",", "args", ".", "cateNum", ")", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ",", "4", ")", "\n", "tem_local1", "=", "self", ".", "tem_cnn_local1", "(", "spa_local2", ")", "\n", "tem_local2", "=", "self", ".", "tem_cnn_local2", "(", "tem_local1", ")", "\n", "eb_local", "=", "tem_local2", ".", "mean", "(", "3", ")", "\n", "eb_tra_local", "=", "self", ".", "local_tra", "(", "tem_local2", ")", "\n", "out_local", "=", "self", ".", "dimConv_local", "(", "eb_local", ")", ".", "squeeze", "(", "1", ")", "\n", "\n", "hy_embeds", ",", "Infomax_pred", "=", "self", ".", "Hypergraph_Infomax", "(", "embeds_in_global", ",", "DGI_neg", ")", "\n", "tem_global1", "=", "self", ".", "tem_cnn_global1", "(", "hy_embeds", ")", "\n", "tem_global2", "=", "self", ".", "tem_cnn_global2", "(", "tem_global1", ")", "\n", "tem_global3", "=", "self", ".", "tem_cnn_global3", "(", "tem_global2", ")", "\n", "tem_global4", "=", "self", ".", "tem_cnn_global4", "(", "tem_global3", ")", "\n", "eb_global", "=", "tem_global4", ".", "squeeze", "(", "3", ")", "\n", "eb_tra_global", "=", "self", ".", "global_tra", "(", "tem_global4", ")", "\n", "out_global", "=", "self", ".", "dimConv_global", "(", "eb_global", ")", ".", "squeeze", "(", "1", ")", "\n", "return", "out_local", ",", "eb_tra_local", ",", "eb_tra_global", ",", "Infomax_pred", ",", "out_global", "", "", "", ""]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_loss_r": [[7, 10], ["torch.sum", "torch.sum", "torch.sum", "torch.sum", "torch.square", "torch.square"], "function", ["None"], ["def", "cal_loss_r", "(", "preds", ",", "labels", ",", "mask", ")", ":", "\n", "    ", "loss", "=", "torch", ".", "sum", "(", "torch", ".", "square", "(", "preds", "-", "labels", ")", "*", "mask", ")", "/", "torch", ".", "sum", "(", "mask", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r": [[11, 20], ["numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.greater", "numpy.sum", "numpy.sum", "numpy.square", "numpy.square", "numpy.abs", "numpy.abs"], "function", ["None"], ["", "def", "cal_metrics_r", "(", "preds", ",", "labels", ",", "mask", ")", ":", "\n", "    ", "loss", "=", "np", ".", "sum", "(", "np", ".", "square", "(", "preds", "-", "labels", ")", "*", "mask", ")", "/", "np", ".", "sum", "(", "mask", ")", "\n", "sqLoss", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "np", ".", "square", "(", "preds", "-", "labels", ")", "*", "mask", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "absLoss", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "np", ".", "abs", "(", "preds", "-", "labels", ")", "*", "mask", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "tstNums", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "mask", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "posMask", "=", "mask", "*", "np", ".", "greater", "(", "labels", ",", "0.5", ")", "\n", "apeLoss", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "np", ".", "abs", "(", "preds", "-", "labels", ")", "/", "(", "labels", "+", "1e-8", ")", "*", "posMask", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "posNums", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "posMask", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "return", "loss", ",", "sqLoss", ",", "absLoss", ",", "tstNums", ",", "apeLoss", ",", "posNums", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.cal_metrics_r_mask": [[21, 30], ["numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.greater", "numpy.sum", "numpy.sum", "numpy.square", "numpy.square", "numpy.abs", "numpy.abs"], "function", ["None"], ["", "def", "cal_metrics_r_mask", "(", "preds", ",", "labels", ",", "mask", ",", "mask_sparsity", ")", ":", "\n", "    ", "loss", "=", "np", ".", "sum", "(", "np", ".", "square", "(", "preds", "-", "labels", ")", "*", "mask", ")", "/", "np", ".", "sum", "(", "mask", ")", "\n", "sqLoss", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "np", ".", "square", "(", "preds", "-", "labels", ")", "*", "mask", "*", "mask_sparsity", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "absLoss", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "np", ".", "abs", "(", "preds", "-", "labels", ")", "*", "mask", "*", "mask_sparsity", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "tstNums", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "mask", "*", "mask_sparsity", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "posMask", "=", "mask", "*", "mask_sparsity", "*", "np", ".", "greater", "(", "labels", ",", "0.5", ")", "\n", "apeLoss", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "np", ".", "abs", "(", "preds", "-", "labels", ")", "/", "(", "labels", "+", "1e-8", ")", "*", "posMask", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "posNums", "=", "np", ".", "sum", "(", "np", ".", "sum", "(", "posMask", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "return", "loss", ",", "sqLoss", ",", "absLoss", ",", "tstNums", ",", "apeLoss", ",", "posNums", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.Informax_loss": [[31, 35], ["torch.nn.BCEWithLogitsLoss", "torch.nn.BCEWithLogitsLoss", "torch.nn.BCEWithLogitsLoss."], "function", ["None"], ["", "def", "Informax_loss", "(", "DGI_pred", ",", "DGI_labels", ")", ":", "\n", "    ", "BCE_loss", "=", "torch", ".", "nn", ".", "BCEWithLogitsLoss", "(", ")", "\n", "loss", "=", "BCE_loss", "(", "DGI_pred", ",", "DGI_labels", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.infoNCEloss": [[36, 50], ["F.normalize.expand_as", "F.normalize.permute", "F.normalize.permute", "torch.normalize", "torch.normalize", "torch.sum", "torch.sum", "torch.matmul", "torch.matmul", "torch.exp", "torch.exp", "torch.sum", "torch.sum", "torch.mean", "torch.mean", "torch.mul", "torch.mul", "F.normalize.transpose", "torch.div", "torch.div", "torch.exp", "torch.exp", "torch.div", "torch.div", "torch.log", "torch.log", "torch.div", "torch.div"], "function", ["None"], ["", "def", "infoNCEloss", "(", "q", ",", "k", ")", ":", "\n", "    ", "T", "=", "args", ".", "t", "\n", "q", "=", "q", ".", "expand_as", "(", "k", ")", "\n", "q", "=", "q", ".", "permute", "(", "0", ",", "3", ",", "4", ",", "2", ",", "1", ")", "\n", "k", "=", "k", ".", "permute", "(", "0", ",", "3", ",", "4", ",", "2", ",", "1", ")", "\n", "q", "=", "F", ".", "normalize", "(", "q", ",", "dim", "=", "-", "1", ")", "\n", "k", "=", "F", ".", "normalize", "(", "k", ",", "dim", "=", "-", "1", ")", "\n", "\n", "pos_sim", "=", "torch", ".", "sum", "(", "torch", ".", "mul", "(", "q", ",", "k", ")", ",", "dim", "=", "-", "1", ")", "\n", "neg_sim", "=", "torch", ".", "matmul", "(", "q", ",", "k", ".", "transpose", "(", "-", "1", ",", "-", "2", ")", ")", "\n", "pos", "=", "torch", ".", "exp", "(", "torch", ".", "div", "(", "pos_sim", ",", "T", ")", ")", "\n", "neg", "=", "torch", ".", "sum", "(", "torch", ".", "exp", "(", "torch", ".", "div", "(", "neg_sim", ",", "T", ")", ")", ",", "dim", "=", "-", "1", ")", "\n", "denominator", "=", "neg", "+", "pos", "\n", "return", "torch", ".", "mean", "(", "-", "torch", ".", "log", "(", "torch", ".", "div", "(", "pos", ",", "denominator", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.seed_torch": [[52, 57], ["random.seed", "numpy.random.seed", "torch.manual_seed", "torch.manual_seed", "torch.cuda.manual_seed", "torch.cuda.manual_seed"], "function", ["None"], ["", "def", "seed_torch", "(", "seed", "=", "523", ")", ":", "\n", "    ", "random", ".", "seed", "(", "seed", ")", "\n", "np", ".", "random", ".", "seed", "(", "seed", ")", "\n", "torch", ".", "manual_seed", "(", "seed", ")", "\n", "torch", ".", "cuda", ".", "manual_seed", "(", "seed", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.lzh-ys1998_sthsl.None.utils.makePrint": [[58, 65], ["None"], "function", ["None"], ["", "def", "makePrint", "(", "name", ",", "ep", ",", "reses", ")", ":", "\n", "    ", "ret", "=", "'Epoch %d/%d, %s: '", "%", "(", "ep", ",", "args", ".", "epoch", ",", "name", ")", "\n", "for", "metric", "in", "reses", ":", "\n", "        ", "val", "=", "reses", "[", "metric", "]", "\n", "ret", "+=", "'%s = %.4f, '", "%", "(", "metric", ",", "val", ")", "\n", "", "ret", "=", "ret", "[", ":", "-", "2", "]", "+", "'  '", "\n", "return", "ret", "", "", ""]]}