{"home.repos.pwc.inspect_result.szhaofelicia_EchoChamberInEcommerce.None.bic.kmeans_clustering": [[12, 16], ["sklearn.cluster.KMeans().fit", "sklearn.cluster.KMeans"], "function", ["None"], ["def", "kmeans_clustering", "(", "x", ",", "k", ")", ":", "\n", "\t", "clustering", "=", "KMeans", "(", "n_clusters", "=", "k", ",", "random_state", "=", "0", ")", ".", "fit", "(", "x", ")", "\n", "y", "=", "clustering", ".", "labels_", "\n", "return", "clustering", ",", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.szhaofelicia_EchoChamberInEcommerce.None.bic.compute_bic": [[18, 57], ["numpy.bincount", "sum", "numpy.sum", "numpy.log", "sum", "range", "range", "scipy.spatial.distance.cdist", "numpy.log", "numpy.log", "numpy.log", "numpy.where"], "function", ["None"], ["", "def", "compute_bic", "(", "kmeans", ",", "X", ")", ":", "\n", "    ", "\"\"\"\n    Computes the BIC metric for a given clusters\n\n    Inputs:\n    -----------------------------------------\n    kmeans:  List of clustering object from scikit learn\n\n    X     : Multidimentional data points\n\n    Output:\n    -----------------------------------------\n    List of BIC value\n\n    Reference:\n    -----------------------------------------\n    https://stats.stackexchange.com/questions/90769/using-bic-to-estimate-the-number-of-k-in-kmeans?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\n    \"\"\"", "\n", "# assign centers and labels", "\n", "centers", "=", "[", "kmeans", ".", "cluster_centers_", "]", "\n", "labels", "=", "kmeans", ".", "labels_", "\n", "#number of clusters", "\n", "m", "=", "kmeans", ".", "n_clusters", "\n", "# size of the clusters", "\n", "n", "=", "np", ".", "bincount", "(", "labels", ")", "\n", "#size of data set", "\n", "N", ",", "d", "=", "X", ".", "shape", "\n", "\n", "#compute variance for all clusters beforehand", "\n", "cl_var", "=", "(", "1.0", "/", "(", "N", "-", "m", ")", "/", "d", ")", "*", "sum", "(", "[", "sum", "(", "distance", ".", "cdist", "(", "X", "[", "np", ".", "where", "(", "labels", "==", "i", ")", "]", ",", "[", "centers", "[", "0", "]", "[", "i", "]", "]", ",", "\n", "'euclidean'", ")", "**", "2", ")", "for", "i", "in", "range", "(", "m", ")", "]", ")", "\n", "const_term", "=", "0.5", "*", "m", "*", "np", ".", "log", "(", "N", ")", "*", "(", "d", "+", "1", ")", "\n", "\n", "BIC", "=", "np", ".", "sum", "(", "[", "n", "[", "i", "]", "*", "np", ".", "log", "(", "n", "[", "i", "]", ")", "-", "\n", "n", "[", "i", "]", "*", "np", ".", "log", "(", "N", ")", "-", "\n", "(", "(", "n", "[", "i", "]", "*", "d", ")", "/", "2", ")", "*", "np", ".", "log", "(", "2", "*", "np", ".", "pi", "*", "cl_var", ")", "-", "\n", "(", "(", "n", "[", "i", "]", "-", "1", ")", "*", "d", "/", "2", ")", "for", "i", "in", "range", "(", "m", ")", "]", ")", "-", "const_term", "\n", "\n", "return", "(", "BIC", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.szhaofelicia_EchoChamberInEcommerce.None.ari.kmeans_clustering": [[16, 20], ["sklearn.cluster.KMeans().fit", "sklearn.cluster.KMeans"], "function", ["None"], ["def", "kmeans_clustering", "(", "x", ",", "k", ")", ":", "\n", "\t", "clustering", "=", "KMeans", "(", "n_clusters", "=", "k", ",", "random_state", "=", "0", ")", ".", "fit", "(", "x", ")", "\n", "y", "=", "clustering", ".", "labels_", "\n", "return", "clustering", ",", "y", "\n", "\n"]], "home.repos.pwc.inspect_result.szhaofelicia_EchoChamberInEcommerce.None.ch.kmeans_clustering": [[16, 20], ["sklearn.cluster.KMeans().fit", "sklearn.cluster.KMeans"], "function", ["None"], ["def", "kmeans_clustering", "(", "x", ",", "k", ")", ":", "\n", "\t", "clustering", "=", "KMeans", "(", "n_clusters", "=", "k", ",", "random_state", "=", "0", ")", ".", "fit", "(", "x", ")", "\n", "y", "=", "clustering", ".", "labels_", "\n", "return", "clustering", ",", "y", "\n", "\n"]]}