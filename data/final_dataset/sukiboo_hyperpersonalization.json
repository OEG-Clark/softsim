{"home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.synthetic_gaussian_mapping.SyntheticGaussianMapping.__init__": [[8, 12], ["synthetic_gaussian_mapping.SyntheticGaussianMapping.__dict__.update", "synthetic_gaussian_mapping.SyntheticGaussianMapping.initialize_weights", "numpy.exp"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.synthetic_gaussian_mapping.SyntheticGaussianMapping.initialize_weights"], ["def", "__init__", "(", "self", ",", "params_map", ")", ":", "\n", "        ", "self", ".", "__dict__", ".", "update", "(", "params_map", ")", "\n", "self", ".", "initialize_weights", "(", ")", "\n", "self", ".", "activation", "=", "lambda", "z", ":", "np", ".", "exp", "(", "-", "z", "**", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.synthetic_gaussian_mapping.SyntheticGaussianMapping.initialize_weights": [[13, 21], ["numpy.random.seed", "range", "len", "numpy.random.randn"], "methods", ["None"], ["", "def", "initialize_weights", "(", "self", ")", ":", "\n", "        ", "'''initialize the network from normal distribution'''", "\n", "np", ".", "random", ".", "seed", "(", "self", ".", "seed", ")", "\n", "self", ".", "dims", "=", "[", "self", ".", "dim_in", ",", "*", "self", ".", "dim_layers", ",", "self", ".", "dim_out", "]", "\n", "self", ".", "num_layers", "=", "len", "(", "self", ".", "dims", ")", "-", "1", "\n", "self", ".", "weights", "=", "{", "}", "\n", "for", "l", "in", "range", "(", "self", ".", "num_layers", ")", ":", "\n", "            ", "self", ".", "weights", "[", "l", "]", "=", "np", ".", "random", ".", "randn", "(", "self", ".", "dims", "[", "l", "]", "+", "1", ",", "self", ".", "dims", "[", "l", "+", "1", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.synthetic_gaussian_mapping.SyntheticGaussianMapping.propagate": [[22, 32], ["numpy.array", "range", "numpy.concatenate", "synthetic_gaussian_mapping.SyntheticGaussianMapping.activation", "numpy.tanh", "numpy.ones", "numpy.matmul", "numpy.matmul"], "methods", ["None"], ["", "", "def", "propagate", "(", "self", ",", "x", ")", ":", "\n", "        ", "'''propagate input through the network'''", "\n", "z", "=", "np", ".", "array", "(", "x", ",", "ndmin", "=", "2", ")", "\n", "for", "l", "in", "range", "(", "self", ".", "num_layers", ")", ":", "\n", "            ", "z", "=", "np", ".", "concatenate", "(", "[", "np", ".", "ones", "(", "(", "z", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ",", "z", "]", ",", "axis", "=", "1", ")", "\n", "if", "l", "<", "self", ".", "num_layers", "-", "1", ":", "\n", "                ", "z", "=", "self", ".", "activation", "(", "np", ".", "matmul", "(", "z", ",", "self", ".", "weights", "[", "l", "]", ")", ")", "\n", "", "else", ":", "\n", "                ", "z", "=", "np", ".", "tanh", "(", "np", ".", "matmul", "(", "z", ",", "self", ".", "weights", "[", "l", "]", ")", ")", "\n", "", "", "return", "z", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.__init__": [[20, 26], ["run_experiments.ExperimentDataGenerator.__dict__.update", "run_experiments.ExperimentDataGenerator.configure"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.configure"], ["def", "__init__", "(", "self", ",", "params_exp", ",", "params_env", ",", "params_rl", ")", ":", "\n", "        ", "self", ".", "__dict__", ".", "update", "(", "params_exp", ")", "\n", "self", ".", "params_env", "=", "params_env", "\n", "self", ".", "params_rl", "=", "params_rl", "\n", "self", ".", "params_cluster", "=", "{", "'K'", ":", "params_env", "[", "'num_a'", "]", ",", "'timesteps'", ":", "self", ".", "timesteps", "}", "\n", "self", ".", "configure", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.configure": [[27, 38], ["numpy.random.seed", "numpy.random.randint", "numpy.random.randint", "run_experiments.ExperimentDataGenerator.params_rl.update", "str", "str"], "methods", ["None"], ["", "def", "configure", "(", "self", ")", ":", "\n", "        ", "'''configure parameters and fix random seeds for reproducibility'''", "\n", "np", ".", "random", ".", "seed", "(", "self", ".", "seed", ")", "\n", "self", ".", "exp_seeds", "=", "np", ".", "random", ".", "randint", "(", "1e+09", ",", "size", "=", "self", ".", "num_exp", ")", "\n", "self", ".", "seed_rl", "=", "np", ".", "random", ".", "randint", "(", "1e+09", ")", "\n", "self", ".", "data", "=", "{", "}", "\n", "self", ".", "params_rl", ".", "update", "(", "{", "'learn_steps'", ":", "self", ".", "timesteps", ",", "'seed'", ":", "self", ".", "seed_rl", "}", ")", "\n", "self", ".", "save_name", "=", "f'exp_{self.params_env[\"num_a\"]}_{self.params_env[\"dim_s\"]}_'", "+", "f'{self.params_env[\"dim_a\"]}_{self.params_env[\"dim_feature\"]}_'", "+", "'-'", ".", "join", "(", "str", "(", "n", ")", "for", "n", "in", "self", ".", "params_env", "[", "'r_arch'", "]", ")", "+", "'_'", "+", "'-'", ".", "join", "(", "str", "(", "n", ")", "for", "n", "in", "self", ".", "params_rl", "[", "'net_arch'", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.setup_environment": [[39, 46], ["run_experiments.ExperimentDataGenerator.params_env.update", "bandit_environment.GymHyperpersonalizationEnv", "run_experiments.ExperimentDataGenerator.env.get_r_stats"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.get_r_stats"], ["", "def", "setup_environment", "(", "self", ",", "seed", ")", ":", "\n", "        ", "'''setup the hyperpersonalization task with the given seed'''", "\n", "self", ".", "params_env", ".", "update", "(", "{", "'seed'", ":", "seed", "}", ")", "\n", "self", ".", "env", "=", "GymHyperpersonalizationEnv", "(", "self", ".", "params_env", ")", "\n", "r_avg", ",", "r_min", ",", "r_max", "=", "self", ".", "env", ".", "get_r_stats", "(", "steps", "=", "self", ".", "timesteps", ")", "\n", "data", "=", "{", "'AVG'", ":", "r_avg", ",", "'MIN'", ":", "r_min", ",", "'MAX'", ":", "r_max", "}", "\n", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.run_experiments": [[47, 67], ["range", "run_experiments.ExperimentDataGenerator.process_exp_data", "print", "run_experiments.ExperimentDataGenerator.setup_environment", "online_rl.OnlineRL().run_simulations", "run_experiments.ExperimentDataGenerator.data[].update", "bandit_environment.GymStateClusteringEnv", "online_rl.OnlineRL().run_simulations", "run_experiments.ExperimentDataGenerator.data[].update", "run_experiments.ExperimentDataGenerator.save_variables", "run_experiments.ExperimentDataGenerator.plot_exp_data", "online_rl.OnlineRL", "online_rl.OnlineRL", "online_rl.OnlineRL().run_simulations.items"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.process_exp_data", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.setup_environment", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.OnlineRL.run_simulations", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.OnlineRL.run_simulations", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.save_variables", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.plot_exp_data"], ["", "def", "run_experiments", "(", "self", ",", "save", "=", "True", ",", "plot", "=", "True", ")", ":", "\n", "        ", "'''compute and save/plot experiment results'''", "\n", "for", "exp", "in", "range", "(", "self", ".", "num_exp", ")", ":", "\n", "            ", "print", "(", "f'running experiment {exp+1}/{self.num_exp}...'", ")", "\n", "# get environment stats", "\n", "data_env", "=", "self", ".", "setup_environment", "(", "seed", "=", "self", ".", "exp_seeds", "[", "exp", "]", ")", "\n", "self", ".", "data", "[", "exp", "]", "=", "data_env", "\n", "# rl on full environment", "\n", "data_rl", "=", "OnlineRL", "(", "self", ".", "env", ",", "self", ".", "params_rl", ")", ".", "run_simulations", "(", ")", "\n", "self", ".", "data", "[", "exp", "]", ".", "update", "(", "data_rl", ")", "\n", "# rl on clustered environment", "\n", "self", ".", "env_cl", "=", "GymStateClusteringEnv", "(", "self", ".", "params_env", ",", "self", ".", "params_cluster", ")", "\n", "data_rl_cl", "=", "OnlineRL", "(", "self", ".", "env_cl", ",", "self", ".", "params_rl", ")", ".", "run_simulations", "(", ")", "\n", "data_rl_cl", "=", "{", "k", "+", "' + K-means'", ":", "v", "for", "k", ",", "v", "in", "data_rl_cl", ".", "items", "(", ")", "}", "\n", "self", ".", "data", "[", "exp", "]", ".", "update", "(", "data_rl_cl", ")", "\n", "", "if", "save", ":", "\n", "            ", "self", ".", "save_variables", "(", ")", "\n", "", "self", ".", "process_exp_data", "(", ")", "\n", "if", "plot", ":", "\n", "            ", "self", ".", "plot_exp_data", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.process_exp_data": [[68, 77], ["range", "pandas.DataFrame", "df.drop.drop.sub", "df.drop.drop.div", "df.drop.drop.drop", "run_experiments.ExperimentDataGenerator.exp_data.append"], "methods", ["None"], ["", "", "def", "process_exp_data", "(", "self", ")", ":", "\n", "        ", "'''create the list of dataframes with normalized experiment results'''", "\n", "self", ".", "exp_data", "=", "[", "]", "\n", "for", "exp", "in", "range", "(", "self", ".", "num_exp", ")", ":", "\n", "            ", "df", "=", "pd", ".", "DataFrame", "(", "self", ".", "data", "[", "exp", "]", ")", "\n", "df", "=", "df", ".", "sub", "(", "df", "[", "'AVG'", "]", ",", "axis", "=", "0", ")", "\n", "df", "=", "df", ".", "div", "(", "df", "[", "'MAX'", "]", ",", "axis", "=", "0", ")", "\n", "df", "=", "df", ".", "drop", "(", "[", "'AVG'", ",", "'MIN'", ",", "'MAX'", "]", ",", "axis", "=", "1", ")", "\n", "self", ".", "exp_data", ".", "append", "(", "df", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.plot_exp_data": [[78, 89], ["df.sort_index.sort_index.rolling().mean", "df.sort_index.sort_index.sort_index", "df.sort_index.sort_index.plot", "matplotlib.legend", "matplotlib.tight_layout", "os.makedirs", "matplotlib.savefig", "matplotlib.show", "sum", "df.sort_index.sort_index.rolling"], "methods", ["None"], ["", "", "def", "plot_exp_data", "(", "self", ")", ":", "\n", "        ", "'''plot normalized results of the experiments'''", "\n", "df", "=", "sum", "(", "self", ".", "exp_data", ")", "/", "self", ".", "num_exp", "\n", "df", "=", "df", ".", "rolling", "(", "100", ")", ".", "mean", "(", ")", "\n", "df", "=", "df", ".", "sort_index", "(", "axis", "=", "1", ")", "\n", "df", ".", "plot", "(", "figsize", "=", "(", "8", ",", "4.2", ")", ",", "linewidth", "=", "3", ",", "alpha", "=", ".75", ")", "\n", "plt", ".", "legend", "(", "loc", "=", "'lower right'", ")", "\n", "plt", ".", "tight_layout", "(", ")", "\n", "os", ".", "makedirs", "(", "'./images/'", ",", "exist_ok", "=", "True", ")", "\n", "plt", ".", "savefig", "(", "'./images/'", "+", "self", ".", "save_name", "+", "'.pdf'", ",", "format", "=", "'pdf'", ")", "\n", "plt", ".", "show", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.save_variables": [[90, 95], ["os.makedirs", "open", "dill.dump"], "methods", ["None"], ["", "def", "save_variables", "(", "self", ")", ":", "\n", "        ", "'''save class variables to a file'''", "\n", "os", ".", "makedirs", "(", "'./save/'", ",", "exist_ok", "=", "True", ")", "\n", "with", "open", "(", "'./save/'", "+", "self", ".", "save_name", "+", "'.pkl'", ",", "'wb'", ")", "as", "save_file", ":", "\n", "            ", "pickle", ".", "dump", "(", "self", ".", "__dict__", ",", "save_file", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.load_variables": [[96, 105], ["run_experiments.ExperimentDataGenerator.process_exp_data", "run_experiments.ExperimentDataGenerator.plot_exp_data", "open", "run_experiments.ExperimentDataGenerator.__dict__.update", "NameError", "dill.load"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.process_exp_data", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.run_experiments.ExperimentDataGenerator.plot_exp_data"], ["", "", "def", "load_variables", "(", "self", ",", "save_name", ")", ":", "\n", "        ", "'''load class variables from a file'''", "\n", "try", ":", "\n", "            ", "with", "open", "(", "'./save/'", "+", "save_name", ",", "'rb'", ")", "as", "save_file", ":", "\n", "                ", "self", ".", "__dict__", ".", "update", "(", "pickle", ".", "load", "(", "save_file", ")", ")", "\n", "", "self", ".", "process_exp_data", "(", ")", "\n", "self", ".", "plot_exp_data", "(", ")", "\n", "", "except", ":", "\n", "            ", "raise", "NameError", "(", "f'\\ncannot load file {save_name}...'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.Callback.__init__": [[13, 17], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.__init__"], ["def", "__init__", "(", "self", ",", "data", ",", "max_timestep", ")", ":", "\n", "        ", "super", "(", "Callback", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "data", "=", "data", "\n", "self", ".", "max_timestep", "=", "max_timestep", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.Callback._on_step": [[18, 24], ["online_rl.Callback.data.append"], "methods", ["None"], ["", "def", "_on_step", "(", "self", ")", ":", "\n", "        ", "t", "=", "self", ".", "num_timesteps", "\n", "if", "t", "<=", "self", ".", "max_timestep", ":", "\n", "            ", "r", "=", "self", ".", "locals", "[", "'infos'", "]", "[", "0", "]", "[", "'episode'", "]", "[", "'r'", "]", "\n", "self", ".", "data", ".", "append", "(", "r", ")", "\n", "", "return", "True", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.OnlineRL.__init__": [[29, 34], ["online_rl.OnlineRL.__dict__.update"], "methods", ["None"], ["def", "__init__", "(", "self", ",", "env", ",", "params_rl", ")", ":", "\n", "        ", "self", ".", "__dict__", ".", "update", "(", "params_rl", ")", "\n", "self", ".", "env", "=", "env", "\n", "self", ".", "data", "=", "{", "}", "\n", "self", ".", "policy_kwargs", "=", "{", "'net_arch'", ":", "self", ".", "net_arch", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.OnlineRL.set_random_seed": [[35, 40], ["numpy.random.seed", "torch.manual_seed", "online_rl.OnlineRL.env.reset_env"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.reset_env"], ["", "def", "set_random_seed", "(", "self", ",", "seed", ")", ":", "\n", "        ", "'''fix random seed for reproducibility'''", "\n", "np", ".", "random", ".", "seed", "(", "seed", ")", "\n", "torch", ".", "manual_seed", "(", "seed", ")", "\n", "self", ".", "env", ".", "reset_env", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.OnlineRL.run_simulations": [[41, 53], ["numpy.random.seed", "numpy.random.randint", "print", "numpy.mean", "online_rl.OnlineRL.set_random_seed", "data_alg.append", "online_rl.OnlineRL.train_agent"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.set_random_seed", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.OnlineRL.train_agent"], ["", "def", "run_simulations", "(", "self", ")", ":", "\n", "        ", "'''train agents on simulated environment'''", "\n", "np", ".", "random", ".", "seed", "(", "self", ".", "seed", ")", "\n", "seed_list", "=", "np", ".", "random", ".", "randint", "(", "1e+09", ",", "size", "=", "self", ".", "num_sim", ")", "\n", "for", "alg", "in", "self", ".", "algos", ":", "\n", "            ", "print", "(", "f'  training {alg}-agent...'", ")", "\n", "data_alg", "=", "[", "]", "\n", "for", "seed", "in", "seed_list", ":", "\n", "                ", "self", ".", "set_random_seed", "(", "seed", ")", "\n", "data_alg", ".", "append", "(", "self", ".", "train_agent", "(", "alg", ")", ")", "\n", "", "self", ".", "data", "[", "alg", "]", "=", "np", ".", "mean", "(", "data_alg", ",", "axis", "=", "0", ")", "\n", "", "return", "self", ".", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.online_rl.OnlineRL.train_agent": [[54, 68], ["stable_baselines3.PPO.learn", "stable_baselines3.A2C", "stable_baselines3.DQN", "online_rl.Callback", "stable_baselines3.PPO", "NameError"], "methods", ["None"], ["", "def", "train_agent", "(", "self", ",", "alg", ")", ":", "\n", "        ", "'''train an rl agent with a specified algorithm'''", "\n", "if", "alg", "==", "'A2C'", ":", "\n", "            ", "agent", "=", "sb3", ".", "A2C", "(", "'MlpPolicy'", ",", "self", ".", "env", ",", "verbose", "=", "0", ",", "policy_kwargs", "=", "self", ".", "policy_kwargs", ")", "\n", "", "elif", "alg", "==", "'DQN'", ":", "\n", "            ", "agent", "=", "sb3", ".", "DQN", "(", "'MlpPolicy'", ",", "self", ".", "env", ",", "verbose", "=", "0", ",", "policy_kwargs", "=", "self", ".", "policy_kwargs", ")", "\n", "", "elif", "alg", "==", "'PPO'", ":", "\n", "            ", "agent", "=", "sb3", ".", "PPO", "(", "'MlpPolicy'", ",", "self", ".", "env", ",", "verbose", "=", "0", ",", "policy_kwargs", "=", "self", ".", "policy_kwargs", ")", "\n", "", "else", ":", "\n", "            ", "raise", "NameError", "(", "f'\\nalgorithm {alg} is not implemented...'", ")", "\n", "", "data", "=", "[", "]", "\n", "agent", ".", "learn", "(", "self", ".", "learn_steps", ",", "\n", "callback", "=", "Callback", "(", "data", "=", "data", ",", "max_timestep", "=", "self", ".", "learn_steps", ")", ")", "\n", "return", "data", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.__init__": [[21, 26], ["bandit_environment.HyperpersonalizationEnv.__dict__.update", "bandit_environment.HyperpersonalizationEnv.set_random_seed", "bandit_environment.HyperpersonalizationEnv.sample_actions", "bandit_environment.HyperpersonalizationEnv.create_reward_function"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.set_random_seed", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.sample_actions", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.create_reward_function"], ["def", "__init__", "(", "self", ",", "params_env", ")", ":", "\n", "        ", "self", ".", "__dict__", ".", "update", "(", "params_env", ")", "\n", "self", ".", "set_random_seed", "(", ")", "\n", "self", ".", "sample_actions", "(", ")", "\n", "self", ".", "create_reward_function", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.set_random_seed": [[27, 35], ["numpy.random.seed", "numpy.random.default_rng", "numpy.random.default_rng", "numpy.random.default_rng"], "methods", ["None"], ["", "def", "set_random_seed", "(", "self", ",", "seed", "=", "None", ")", ":", "\n", "        ", "'''fix random seed for reproducibility'''", "\n", "if", "seed", "is", "not", "None", ":", "\n", "            ", "self", ".", "seed", "=", "seed", "\n", "", "np", ".", "random", ".", "seed", "(", "seed", ")", "\n", "self", ".", "rng_s", "=", "np", ".", "random", ".", "default_rng", "(", "seed", "=", "self", ".", "seed", ")", "\n", "self", ".", "rng_a", "=", "np", ".", "random", ".", "default_rng", "(", "seed", "=", "self", ".", "seed", "+", "1", ")", "\n", "self", ".", "rng_r", "=", "np", ".", "random", ".", "default_rng", "(", "seed", "=", "self", ".", "seed", "+", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_state": [[36, 40], ["bandit_environment.HyperpersonalizationEnv.rng_s.uniform"], "methods", ["None"], ["", "def", "get_state", "(", "self", ",", "num_s", "=", "1", ")", ":", "\n", "        ", "'''generate observed states'''", "\n", "S", "=", "self", ".", "rng_s", ".", "uniform", "(", "self", ".", "s_low", ",", "self", ".", "s_high", ",", "(", "num_s", ",", "self", ".", "dim_s", ")", ")", "\n", "return", "S", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.sample_actions": [[41, 44], ["bandit_environment.HyperpersonalizationEnv.rng_a.uniform"], "methods", ["None"], ["", "def", "sample_actions", "(", "self", ")", ":", "\n", "        ", "'''generate the set of available actions'''", "\n", "self", ".", "A", "=", "self", ".", "rng_a", ".", "uniform", "(", "self", ".", "a_low", ",", "self", ".", "a_high", ",", "(", "self", ".", "num_a", ",", "self", ".", "dim_a", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.create_state_embedding": [[45, 51], ["synthetic_gaussian_mapping.SyntheticGaussianMapping", "bandit_environment.HyperpersonalizationEnv.rng_r.integers", "bandit_environment.HyperpersonalizationEnv.feature_map_s.propagate"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.synthetic_gaussian_mapping.SyntheticGaussianMapping.propagate"], ["", "def", "create_state_embedding", "(", "self", ")", ":", "\n", "        ", "'''generate state feature map'''", "\n", "self", ".", "params_s", "=", "{", "'dim_in'", ":", "self", ".", "dim_s", ",", "'dim_layers'", ":", "self", ".", "r_arch", ",", "\n", "'dim_out'", ":", "self", ".", "dim_feature", ",", "'seed'", ":", "self", ".", "rng_r", ".", "integers", "(", "1e+09", ")", "}", "\n", "self", ".", "feature_map_s", "=", "SyntheticGaussianMapping", "(", "self", ".", "params_s", ")", "\n", "self", ".", "feature_s", "=", "lambda", "s", ":", "self", ".", "feature_map_s", ".", "propagate", "(", "s", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.create_action_embedding": [[52, 58], ["synthetic_gaussian_mapping.SyntheticGaussianMapping", "bandit_environment.HyperpersonalizationEnv.rng_r.integers", "bandit_environment.HyperpersonalizationEnv.feature_map_a.propagate"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.synthetic_gaussian_mapping.SyntheticGaussianMapping.propagate"], ["", "def", "create_action_embedding", "(", "self", ")", ":", "\n", "        ", "'''generate action feature map'''", "\n", "self", ".", "params_a", "=", "{", "'dim_in'", ":", "self", ".", "dim_a", ",", "'dim_layers'", ":", "self", ".", "r_arch", ",", "\n", "'dim_out'", ":", "self", ".", "dim_feature", ",", "'seed'", ":", "self", ".", "rng_r", ".", "integers", "(", "1e+09", ")", "}", "\n", "self", ".", "feature_map_a", "=", "SyntheticGaussianMapping", "(", "self", ".", "params_a", ")", "\n", "self", ".", "feature_a", "=", "lambda", "a", ":", "self", ".", "feature_map_a", ".", "propagate", "(", "a", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.feature_relevance": [[59, 65], ["numpy.linalg.norm", "numpy.linalg.norm", "numpy.matmul", "numpy.matmul"], "methods", ["None"], ["", "def", "feature_relevance", "(", "self", ",", "s", ",", "a", ")", ":", "\n", "        ", "'''measure feature relevance in the latent feature space'''", "\n", "norm_s", "=", "np", ".", "linalg", ".", "norm", "(", "s", ",", "axis", "=", "1", ",", "keepdims", "=", "True", ")", "\n", "norm_a", "=", "np", ".", "linalg", ".", "norm", "(", "a", ",", "axis", "=", "1", ",", "keepdims", "=", "True", ")", "\n", "cosine_sim", "=", "np", ".", "matmul", "(", "s", ",", "a", ".", "T", ")", "/", "np", ".", "matmul", "(", "norm_s", ",", "norm_a", ".", "T", ")", "\n", "return", "cosine_sim", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.create_reward_function": [[66, 71], ["bandit_environment.HyperpersonalizationEnv.create_state_embedding", "bandit_environment.HyperpersonalizationEnv.create_action_embedding", "bandit_environment.HyperpersonalizationEnv.feature_relevance", "bandit_environment.HyperpersonalizationEnv.feature_s", "bandit_environment.HyperpersonalizationEnv.feature_a"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.create_state_embedding", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.create_action_embedding", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.feature_relevance"], ["", "def", "create_reward_function", "(", "self", ")", ":", "\n", "        ", "'''reward function of the environment'''", "\n", "self", ".", "create_state_embedding", "(", ")", "\n", "self", ".", "create_action_embedding", "(", ")", "\n", "self", ".", "r", "=", "lambda", "s", ",", "a", ":", "self", ".", "feature_relevance", "(", "self", ".", "feature_s", "(", "s", ")", ",", "self", ".", "feature_a", "(", "a", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_r_vals": [[72, 79], ["bandit_environment.HyperpersonalizationEnv.r", "bandit_environment.HyperpersonalizationEnv.mean", "bandit_environment.HyperpersonalizationEnv.min", "bandit_environment.HyperpersonalizationEnv.max"], "methods", ["None"], ["", "def", "get_r_vals", "(", "self", ",", "s", ")", ":", "\n", "        ", "'''compute the average, minimum, and maximum reward values for a given state'''", "\n", "r_vals", "=", "self", ".", "r", "(", "s", ",", "self", ".", "A", ")", "\n", "r_avg", "=", "r_vals", ".", "mean", "(", "axis", "=", "1", ")", "\n", "r_min", "=", "r_vals", ".", "min", "(", "axis", "=", "1", ")", "\n", "r_max", "=", "r_vals", ".", "max", "(", "axis", "=", "1", ")", "\n", "return", "r_avg", ",", "r_min", ",", "r_max", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.visualize_reward_distribution": [[80, 90], ["pandas.DataFrame", "pandas.DataFrame.plot.bar", "pd.DataFrame.plot.bar.set_xlabel", "pd.DataFrame.plot.bar.set_ylabel", "os.makedirs", "matplotlib.savefig", "matplotlib.show", "numpy.random.randn", "bandit_environment.HyperpersonalizationEnv.r"], "methods", ["None"], ["", "def", "visualize_reward_distribution", "(", "self", ",", "num_s", "=", "5", ",", "num_a", "=", "10", ")", ":", "\n", "        ", "'''visualize reward distribution across the available actions'''", "\n", "S", "=", "np", ".", "random", ".", "randn", "(", "num_s", ",", "self", ".", "dim_s", ")", "/", "100", "\n", "R", "=", "pd", ".", "DataFrame", "(", "self", ".", "r", "(", "S", ",", "self", ".", "A", "[", ":", "num_a", "]", ")", ".", "T", ")", "\n", "ax", "=", "R", ".", "plot", ".", "bar", "(", "figsize", "=", "(", "8", ",", "5", ")", ",", "width", "=", ".8", ",", "rot", "=", "0", ",", "legend", "=", "None", ")", "\n", "ax", ".", "set_xlabel", "(", "'available actions'", ")", "\n", "ax", ".", "set_ylabel", "(", "'reward'", ")", "\n", "os", ".", "makedirs", "(", "'./images/'", ",", "exist_ok", "=", "True", ")", "\n", "plt", ".", "savefig", "(", "'./images/reward_distribution.pdf'", ",", "format", "=", "'pdf'", ")", "\n", "plt", ".", "show", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.visualize_reward_correlation": [[91, 107], ["bandit_environment.HyperpersonalizationEnv.get_state", "bandit_environment.HyperpersonalizationEnv.r", "numpy.zeros", "range", "matplotlib.subplots", "ax.bar", "ax.set_title", "ax.set_xlabel", "os.makedirs", "matplotlib.savefig", "matplotlib.show", "sklearn.cluster.KMeans().fit", "scipy.stats.pearsonr", "numpy.arange", "numpy.where", "scipy.spatial.distance.pdist", "scipy.spatial.distance.pdist", "sklearn.cluster.KMeans", "numpy.mean"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_state"], ["", "def", "visualize_reward_correlation", "(", "self", ",", "num_s", "=", "100000", ")", ":", "\n", "        ", "'''visualize reward correlations across different clusters'''", "\n", "S", "=", "self", ".", "get_state", "(", "num_s", "=", "num_s", ")", "\n", "R", "=", "self", ".", "r", "(", "S", ",", "self", ".", "A", ")", "\n", "clusters", "=", "KMeans", "(", "n_clusters", "=", "self", ".", "num_a", ")", ".", "fit", "(", "S", ")", ".", "labels_", "\n", "corr", "=", "np", ".", "zeros", "(", "shape", "=", "(", "2", ",", "self", ".", "num_a", ")", ")", "\n", "for", "k", "in", "range", "(", "self", ".", "num_a", ")", ":", "\n", "            ", "k_ind", "=", "np", ".", "where", "(", "clusters", "==", "k", ")", "[", "0", "]", "\n", "corr", "[", ":", ",", "k", "]", "=", "pearsonr", "(", "pdist", "(", "S", "[", "k_ind", "]", ")", ",", "pdist", "(", "R", "[", "k_ind", "]", ")", ")", "\n", "", "fig", ",", "ax", "=", "plt", ".", "subplots", "(", "figsize", "=", "(", "8", ",", "5", ")", ")", "\n", "ax", ".", "bar", "(", "np", ".", "arange", "(", "1", ",", "self", ".", "num_a", "+", "1", ")", ",", "corr", "[", "0", "]", ",", "width", "=", "1.", ")", "\n", "ax", ".", "set_title", "(", "f'Pearson correlation (p = {np.mean(corr[1]):.2e})'", ")", "\n", "ax", ".", "set_xlabel", "(", "'state space clusters'", ")", "\n", "os", ".", "makedirs", "(", "'./images/'", ",", "exist_ok", "=", "True", ")", "\n", "plt", ".", "savefig", "(", "'./images/reward_correlation.pdf'", ",", "format", "=", "'pdf'", ")", "\n", "plt", ".", "show", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.__init__": [[112, 118], ["gym.Env.__init__", "bandit_environment.HyperpersonalizationEnv", "gym.spaces.Discrete", "gym.spaces.Box"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.__init__"], ["def", "__init__", "(", "self", ",", "params_env", ")", ":", "\n", "        ", "super", "(", "GymHyperpersonalizationEnv", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "env", "=", "HyperpersonalizationEnv", "(", "params_env", ")", "\n", "self", ".", "action_space", "=", "gym", ".", "spaces", ".", "Discrete", "(", "self", ".", "env", ".", "num_a", ")", "\n", "self", ".", "observation_space", "=", "gym", ".", "spaces", ".", "Box", "(", "low", "=", "self", ".", "env", ".", "s_low", ",", "high", "=", "self", ".", "env", ".", "s_high", ",", "\n", "shape", "=", "(", "self", ".", "env", ".", "dim_s", ",", ")", ",", "dtype", "=", "np", ".", "float", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.reset_env": [[119, 122], ["bandit_environment.GymHyperpersonalizationEnv.env.set_random_seed"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.set_random_seed"], ["", "def", "reset_env", "(", "self", ")", ":", "\n", "        ", "'''re-seed the environment'''", "\n", "self", ".", "env", ".", "set_random_seed", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.step": [[123, 130], ["bandit_environment.GymHyperpersonalizationEnv.env.r().item", "bandit_environment.GymHyperpersonalizationEnv.env.r"], "methods", ["None"], ["", "def", "step", "(", "self", ",", "action_index", ")", ":", "\n", "        ", "'''given an observed state take an action and receive reward'''", "\n", "self", ".", "action", "=", "self", ".", "env", ".", "A", "[", "action_index", "]", "\n", "self", ".", "reward", "=", "self", ".", "env", ".", "r", "(", "self", ".", "state", ",", "self", ".", "action", ")", ".", "item", "(", ")", "\n", "done", "=", "True", "\n", "info", "=", "{", "}", "\n", "return", "self", ".", "state", ",", "self", ".", "reward", ",", "done", ",", "info", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.reset": [[131, 135], ["bandit_environment.GymHyperpersonalizationEnv.env.get_state().flatten", "bandit_environment.GymHyperpersonalizationEnv.env.get_state"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_state"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "'''observe a new state'''", "\n", "self", ".", "state", "=", "self", ".", "env", ".", "get_state", "(", ")", ".", "flatten", "(", ")", "\n", "return", "self", ".", "state", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.get_r_stats": [[136, 142], ["bandit_environment.GymHyperpersonalizationEnv.env.get_state", "bandit_environment.GymHyperpersonalizationEnv.env.get_r_vals", "bandit_environment.GymHyperpersonalizationEnv.reset_env"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_state", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_r_vals", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.reset_env"], ["", "def", "get_r_stats", "(", "self", ",", "steps", ")", ":", "\n", "        ", "'''compute the average, minimum, and maximum reward values'''", "\n", "S", "=", "self", ".", "env", ".", "get_state", "(", "steps", ")", "\n", "stats", "=", "self", ".", "env", ".", "get_r_vals", "(", "S", ")", "\n", "self", ".", "reset_env", "(", ")", "\n", "return", "stats", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.__init__": [[147, 153], ["bandit_environment.GymHyperpersonalizationEnv.__init__", "bandit_environment.GymStateClusteringEnv.__dict__.update", "gym.spaces.Discrete", "gym.spaces.Discrete", "bandit_environment.GymStateClusteringEnv.cluster_state_space"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.__init__", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.cluster_state_space"], ["def", "__init__", "(", "self", ",", "params_env", ",", "params_cluster", ")", ":", "\n", "        ", "GymHyperpersonalizationEnv", ".", "__init__", "(", "self", ",", "params_env", ")", "\n", "self", ".", "__dict__", ".", "update", "(", "params_cluster", ")", "\n", "self", ".", "action_space", "=", "gym", ".", "spaces", ".", "Discrete", "(", "self", ".", "env", ".", "num_a", ")", "\n", "self", ".", "observation_space", "=", "gym", ".", "spaces", ".", "Discrete", "(", "self", ".", "K", ")", "\n", "self", ".", "cluster_state_space", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.cluster_state_space": [[154, 159], ["bandit_environment.GymStateClusteringEnv.env.get_state", "sklearn.cluster.KMeans().fit", "bandit_environment.GymStateClusteringEnv.reset_env", "sklearn.cluster.KMeans"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_state", "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymHyperpersonalizationEnv.reset_env"], ["", "def", "cluster_state_space", "(", "self", ")", ":", "\n", "        ", "'''cluster the state space'''", "\n", "S", "=", "self", ".", "env", ".", "get_state", "(", "self", ".", "timesteps", ")", "\n", "self", ".", "clustering", "=", "KMeans", "(", "n_clusters", "=", "self", ".", "K", ")", ".", "fit", "(", "S", ")", "\n", "self", ".", "reset_env", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.step": [[160, 167], ["bandit_environment.GymStateClusteringEnv.env.r().item", "bandit_environment.GymStateClusteringEnv.env.r"], "methods", ["None"], ["", "def", "step", "(", "self", ",", "action_index", ")", ":", "\n", "        ", "'''given an observed state take an action and receive reward'''", "\n", "self", ".", "action", "=", "self", ".", "env", ".", "A", "[", "action_index", "]", "\n", "self", ".", "reward", "=", "self", ".", "env", ".", "r", "(", "self", ".", "state_vector", ",", "self", ".", "action", ")", ".", "item", "(", ")", "\n", "done", "=", "True", "\n", "info", "=", "{", "}", "\n", "return", "self", ".", "state", ",", "self", ".", "reward", ",", "done", ",", "info", "\n", "\n"]], "home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.GymStateClusteringEnv.reset": [[168, 173], ["bandit_environment.GymStateClusteringEnv.env.get_state", "bandit_environment.GymStateClusteringEnv.clustering.predict().item", "bandit_environment.GymStateClusteringEnv.clustering.predict"], "methods", ["home.repos.pwc.inspect_result.sukiboo_hyperpersonalization.None.bandit_environment.HyperpersonalizationEnv.get_state"], ["", "def", "reset", "(", "self", ")", ":", "\n", "        ", "'''observe a new state'''", "\n", "self", ".", "state_vector", "=", "self", ".", "env", ".", "get_state", "(", ")", "\n", "self", ".", "state", "=", "self", ".", "clustering", ".", "predict", "(", "self", ".", "state_vector", ")", ".", "item", "(", ")", "\n", "return", "self", ".", "state", "\n", "\n"]]}