{"home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.model_loader": [[73, 87], ["args.test_model_name.lower", "args.test_model_name.lower"], "function", ["None"], ["def", "model_loader", "(", ")", ":", "\n", "    ", "model", "=", "{", "'eegnet'", ":", "EEGNet", ",", "\n", "'eegnet_dropout'", ":", "EEGNet_Dropout", ",", "\n", "'eegnet_adf'", ":", "EEGNet_adf", ",", "\n", "'eegnet_dropout_adf'", ":", "EEGNet_dropout_adf", "\n", "}", "\n", "\n", "params", "=", "{", "'eegnet'", ":", "[", "args", ".", "p", "]", ",", "\n", "'eegnet_dropout'", ":", "[", "args", ".", "p", "]", ",", "\n", "'eegnet_adf'", ":", "[", "args", ".", "noise_variance", ",", "args", ".", "min_variance", "]", ",", "\n", "'eegnet_dropout_adf'", ":", "[", "args", ".", "p", ",", "args", ".", "noise_variance", ",", "args", ".", "min_variance", "]", "\n", "}", "\n", "\n", "return", "model", "[", "args", ".", "test_model_name", ".", "lower", "(", ")", "]", "(", "*", "params", "[", "args", ".", "test_model_name", ".", "lower", "(", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.set_training_mode_for_dropout": [[110, 121], ["net.modules", "m.__class__.__name__.startswith", "m.train", "m.eval"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.train"], ["", "def", "set_training_mode_for_dropout", "(", "net", ",", "training", "=", "True", ")", ":", "\n", "    ", "\"\"\"Set Dropout mode to train or eval.\"\"\"", "\n", "\n", "for", "m", "in", "net", ".", "modules", "(", ")", ":", "\n", "#        print(m.__class__.__name__)", "\n", "        ", "if", "m", ".", "__class__", ".", "__name__", ".", "startswith", "(", "'Dropout'", ")", ":", "\n", "            ", "if", "training", "==", "True", ":", "\n", "                ", "m", ".", "train", "(", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "eval", "(", ")", "\n", "", "", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.one_hot_pred_from_label": [[122, 129], ["torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "labels.size", "labels.size"], "function", ["None"], ["", "def", "one_hot_pred_from_label", "(", "y_pred", ",", "labels", ")", ":", "\n", "    ", "y_true", "=", "torch", ".", "zeros_like", "(", "y_pred", ")", "\n", "ones", "=", "torch", ".", "ones_like", "(", "y_pred", ")", "\n", "indexes", "=", "[", "l", "for", "l", "in", "labels", "]", "\n", "y_true", "[", "torch", ".", "arange", "(", "labels", ".", "size", "(", "0", ")", ")", ",", "indexes", "]", "=", "ones", "[", "torch", ".", "arange", "(", "labels", ".", "size", "(", "0", ")", ")", ",", "indexes", "]", "\n", "\n", "return", "y_true", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.compute_log_likelihood": [[130, 135], ["torch.distributions.normal.Normal", "torch.distributions.normal.Normal", "torch.distributions.normal.Normal", "torch.distributions.normal.Normal.log_prob", "torch.mean", "torch.mean", "torch.mean"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean"], ["", "def", "compute_log_likelihood", "(", "y_pred", ",", "y_true", ",", "sigma", ")", ":", "\n", "    ", "dist", "=", "torch", ".", "distributions", ".", "normal", ".", "Normal", "(", "loc", "=", "y_pred", ",", "scale", "=", "sigma", ")", "\n", "log_likelihood", "=", "dist", ".", "log_prob", "(", "y_true", ")", "\n", "log_likelihood", "=", "torch", ".", "mean", "(", "log_likelihood", ",", "dim", "=", "1", ")", "\n", "return", "log_likelihood", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.compute_brier_score": [[136, 143], ["torch.mean", "torch.mean", "torch.mean"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean"], ["", "def", "compute_brier_score", "(", "y_pred", ",", "y_true", ")", ":", "\n", "    ", "\"\"\"Brier score implementation follows \n    https://papers.nips.cc/paper/7219-simple-and-scalable-predictive-uncertainty-estimation-using-deep-ensembles.pdf.\n    The lower the Brier score is for a set of predictions, the better the predictions are calibrated.\"\"\"", "\n", "\n", "brier_score", "=", "torch", ".", "mean", "(", "(", "y_true", "-", "y_pred", ")", "**", "2", ",", "1", ")", "\n", "return", "brier_score", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.compute_preds": [[144, 184], ["torch.Softmax", "contrib.adf.Softmax", "set_training_mode_for_dropout.eval", "eval_vis.set_training_mode_for_dropout", "eval_vis.compute_preds.keep_variance"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.set_training_mode_for_dropout", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.keep_variance"], ["", "def", "compute_preds", "(", "net", ",", "inputs", ",", "use_adf", "=", "False", ",", "use_mcdo", "=", "False", ")", ":", "\n", "\n", "    ", "model_variance", "=", "None", "\n", "data_variance", "=", "None", "\n", "\n", "def", "keep_variance", "(", "x", ",", "min_variance", ")", ":", "\n", "        ", "return", "x", "+", "min_variance", "\n", "\n", "", "keep_variance_fn", "=", "lambda", "x", ":", "keep_variance", "(", "x", ",", "min_variance", "=", "args", ".", "min_variance", ")", "\n", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "1", ")", "\n", "adf_softmax", "=", "adf", ".", "Softmax", "(", "dim", "=", "1", ",", "keep_variance_fn", "=", "keep_variance_fn", ")", "\n", "\n", "net", ".", "eval", "(", ")", "\n", "if", "use_mcdo", ":", "\n", "        ", "net", "=", "set_training_mode_for_dropout", "(", "net", ",", "True", ")", "\n", "outputs", "=", "[", "net", "(", "inputs", ")", "for", "i", "in", "range", "(", "args", ".", "num_samples", ")", "]", "\n", "\n", "if", "use_adf", ":", "\n", "            ", "outputs", "=", "[", "adf_softmax", "(", "*", "outs", ")", "for", "outs", "in", "outputs", "]", "\n", "outputs_mean", "=", "[", "mean", "for", "(", "mean", ",", "var", ")", "in", "outputs", "]", "\n", "data_variance", "=", "[", "var", "for", "(", "mean", ",", "var", ")", "in", "outputs", "]", "\n", "data_variance", "=", "torch", ".", "stack", "(", "data_variance", ")", "\n", "data_variance", "=", "torch", ".", "mean", "(", "data_variance", ",", "dim", "=", "0", ")", "\n", "", "else", ":", "\n", "            ", "outputs_mean", "=", "[", "softmax", "(", "outs", ")", "for", "outs", "in", "outputs", "]", "\n", "\n", "", "outputs_mean", "=", "torch", ".", "stack", "(", "outputs_mean", ")", "\n", "model_variance", "=", "torch", ".", "var", "(", "outputs_mean", ",", "dim", "=", "0", ")", "\n", "# Compute MCDO prediction", "\n", "outputs_mean", "=", "torch", ".", "mean", "(", "outputs_mean", ",", "dim", "=", "0", ")", "\n", "", "else", ":", "\n", "        ", "outputs", "=", "net", "(", "inputs", ")", "\n", "if", "adf", ":", "\n", "            ", "outputs_mean", ",", "data_variance", "=", "adf_softmax", "(", "*", "outputs", ")", "\n", "", "else", ":", "\n", "            ", "outputs_mean", "=", "outputs", "\n", "\n", "", "", "net", "=", "set_training_mode_for_dropout", "(", "net", ",", "False", ")", "\n", "\n", "return", "outputs_mean", ",", "data_variance", ",", "model_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.occlusion_channel": [[187, 219], ["torch.autograd.Variable", "net.eval", "range", "numpy.zeros", "numpy.zeros", "enumerate", "net", "[].data.numpy", "len", "len", "max", "min", "inputs.clone", "eval_vis.compute_preds", "torch.autograd.Variable", "int", "int", "output[].cpu().max", "output[].cpu"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.compute_preds"], ["", "def", "occlusion_channel", "(", "net", ",", "inputs", ",", "target_class", "=", "None", ",", "size", "=", "1", ",", "stride", "=", "1", ",", "use_adf", "=", "False", ",", "use_mcdo", "=", "False", ")", ":", "\n", "\n", "    ", "X", "=", "Variable", "(", "inputs", "[", "None", "]", ",", "requires_grad", "=", "False", ")", "\n", "net", ".", "eval", "(", ")", "\n", "if", "target_class", "is", "None", ":", "\n", "        ", "output", "=", "net", "(", "X", ")", "\n", "target_class", "=", "output", "[", "0", "]", ".", "cpu", "(", ")", ".", "max", "(", "0", ")", "[", "1", "]", ".", "data", ".", "numpy", "(", ")", "\n", "", "height", "=", "inputs", ".", "shape", "[", "2", "]", "\n", "ys", "=", "range", "(", "0", ",", "height", ",", "stride", ")", "\n", "relevance_map", "=", "np", ".", "zeros", "(", "(", "len", "(", "ys", ")", ")", ")", "\n", "uncertainty_map", "=", "np", ".", "zeros", "(", "(", "len", "(", "ys", ")", ")", ")", "\n", "for", "i_y", ",", "y", "in", "enumerate", "(", "ys", ")", ":", "\n", "        ", "y_from", "=", "max", "(", "y", "-", "int", "(", "size", "/", "2", ")", ",", "0", ")", "\n", "y_to", "=", "min", "(", "y", "+", "int", "(", "size", "/", "2", ")", ",", "height", ")", "\n", "\n", "inputs_occluded", "=", "inputs", ".", "clone", "(", ")", "\n", "inputs_occluded", "[", ":", ",", ":", ",", "y_from", ":", "y_to", "]", "=", "0", "\n", "\n", "outputs_variance", "=", "None", "\n", "outputs_mean", ",", "data_variance", ",", "model_variance", "=", "compute_preds", "(", "net", ",", "Variable", "(", "inputs_occluded", "[", "None", "]", ",", "requires_grad", "=", "False", ")", ",", "use_adf", ",", "use_mcdo", ")", "\n", "\n", "if", "data_variance", "is", "not", "None", "and", "model_variance", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "data_variance", "+", "model_variance", "\n", "", "elif", "data_variance", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "data_variance", "\n", "", "elif", "model_variance", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "model_variance", "\n", "\n", "", "relevance_map", "[", "i_y", "]", "=", "outputs_mean", ".", "data", "[", "0", ",", "target_class", "]", "\n", "uncertainty_map", "[", "i_y", "]", "=", "outputs_variance", ".", "data", "[", "0", ",", "target_class", "]", "\n", "\n", "", "return", "relevance_map", ",", "uncertainty_map", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval_vis.evaluate": [[221, 375], ["net.eval", "print", "print", "scipy.io.savemat", "numpy.mean", "numpy.mean", "numpy.mean", "numpy.mean", "numpy.mean", "numpy.mean", "numpy.mean", "numpy.mean", "print", "print", "print", "print", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "eval_vis.evaluate.multiclass_roc_auc_score"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean"], ["", "def", "evaluate", "(", "net", ",", "use_adf", "=", "False", ",", "use_mcdo", "=", "False", ")", ":", "\n", "\n", "    ", "def", "multiclass_roc_auc_score", "(", "y_test", ",", "y_pred", ",", "average", "=", "\"macro\"", ")", ":", "\n", "        ", "lb", "=", "LabelBinarizer", "(", ")", "\n", "lb", ".", "fit", "(", "y_test", ")", "\n", "y_test", "=", "lb", ".", "transform", "(", "y_test", ")", "\n", "y_pred", "=", "lb", ".", "transform", "(", "y_pred", ")", "\n", "return", "roc_auc_score", "(", "y_test", ",", "y_pred", ",", "average", "=", "average", ")", "\n", "\n", "\n", "", "def", "ece_score", "(", "logits", ",", "labels", ",", "n_bins", "=", "30", ")", ":", "\n", "        ", "confidences", ",", "predictions", "=", "torch", ".", "max", "(", "logits", ",", "1", ")", "\n", "ece", "=", "torch", ".", "zeros", "(", "1", ",", "device", "=", "logits", ".", "device", ")", "\n", "accuracies", "=", "predictions", ".", "eq", "(", "labels", ")", "\n", "bin_boundaries", "=", "torch", ".", "linspace", "(", "0", ",", "1", ",", "n_bins", "+", "1", ")", "\n", "bin_lowers", "=", "bin_boundaries", "[", ":", "-", "1", "]", "\n", "bin_uppers", "=", "bin_boundaries", "[", "1", ":", "]", "\n", "\n", "for", "bin_lower", ",", "bin_upper", "in", "zip", "(", "bin_lowers", ",", "bin_uppers", ")", ":", "\n", "            ", "in_bin", "=", "confidences", ".", "gt", "(", "bin_lower", ".", "item", "(", ")", ")", "*", "confidences", ".", "le", "(", "bin_upper", ".", "item", "(", ")", ")", "\n", "prop_in_bin", "=", "in_bin", ".", "float", "(", ")", ".", "mean", "(", ")", "\n", "if", "prop_in_bin", ".", "item", "(", ")", ">", "0", ":", "\n", "                ", "accuracy_in_bin", "=", "accuracies", "[", "in_bin", "]", ".", "float", "(", ")", ".", "mean", "(", ")", "\n", "avg_confidence_in_bin", "=", "confidences", "[", "in_bin", "]", ".", "mean", "(", ")", "\n", "ece", "+=", "torch", ".", "abs", "(", "avg_confidence_in_bin", "-", "accuracy_in_bin", ")", "*", "prop_in_bin", "\n", "\n", "", "", "return", "ece", "\n", "\n", "\n", "", "net", ".", "eval", "(", ")", "\n", "test_loss", "=", "0", "\n", "correct", "=", "0", "\n", "brier_score", "=", "0", "\n", "neg_log_likelihood", "=", "0", "\n", "auc", "=", "0", "\n", "ece", "=", "0", "\n", "total", "=", "0", "\n", "outputs_variance", "=", "None", "\n", "print", "(", "\"use adf\"", ")", "\n", "print", "(", "use_adf", ")", "\n", "\n", "pred", "=", "[", "]", "\n", "label", "=", "[", "]", "\n", "ece_l", "=", "[", "]", "\n", "mean_l", "=", "[", "]", "\n", "acc_l", "=", "[", "]", "\n", "nll_l", "=", "[", "]", "\n", "brier_l", "=", "[", "]", "\n", "\n", "store_r_c0", "=", "[", "]", "\n", "store_u_c0", "=", "[", "]", "\n", "store_r_c1", "=", "[", "]", "\n", "store_u_c1", "=", "[", "]", "\n", "store_r_c2", "=", "[", "]", "\n", "store_u_c2", "=", "[", "]", "\n", "store_r_c3", "=", "[", "]", "\n", "store_u_c3", "=", "[", "]", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "for", "batch_idx", ",", "(", "inputs", ",", "targets", ")", "in", "enumerate", "(", "testloader", ")", ":", "\n", "\n", "            ", "mean_l", ".", "append", "(", "torch", ".", "mean", "(", "inputs", ")", ")", "\n", "inputs", ",", "targets", "=", "inputs", ".", "to", "(", "device", ")", ",", "targets", ".", "to", "(", "device", ")", "\n", "\n", "outputs_mean", ",", "data_variance", ",", "model_variance", "=", "compute_preds", "(", "net", ",", "inputs", ",", "use_adf", ",", "use_mcdo", ")", "\n", "\n", "num_per_batch", "=", "inputs", ".", "shape", "[", "0", "]", "\n", "for", "j", "in", "range", "(", "int", "(", "num_per_batch", ")", ")", ":", "\n", "                ", "rele_map", ",", "unc_map", "=", "occlusion_channel", "(", "net", ",", "inputs", "[", "j", ",", ":", ",", ":", ",", ":", "]", ",", "target_class", "=", "None", ",", "size", "=", "1", ",", "stride", "=", "1", ",", "use_adf", "=", "use_adf", ",", "use_mcdo", "=", "use_mcdo", ")", "\n", "if", "j", "%", "4", "==", "0", ":", "\n", "                    ", "store_r_c0", ".", "append", "(", "rele_map", ")", "\n", "store_u_c0", ".", "append", "(", "unc_map", ")", "\n", "", "elif", "j", "%", "4", "==", "1", ":", "\n", "                    ", "store_r_c1", ".", "append", "(", "rele_map", ")", "\n", "store_u_c1", ".", "append", "(", "unc_map", ")", "\n", "", "elif", "j", "%", "4", "==", "2", ":", "\n", "                    ", "store_r_c2", ".", "append", "(", "rele_map", ")", "\n", "store_u_c2", ".", "append", "(", "unc_map", ")", "\n", "", "elif", "j", "%", "4", "==", "3", ":", "\n", "                    ", "store_r_c3", ".", "append", "(", "rele_map", ")", "\n", "store_u_c3", ".", "append", "(", "unc_map", ")", "\n", "\n", "", "", "if", "data_variance", "is", "not", "None", "and", "model_variance", "is", "not", "None", ":", "\n", "                ", "outputs_variance", "=", "data_variance", "+", "model_variance", "\n", "", "elif", "data_variance", "is", "not", "None", ":", "\n", "                ", "outputs_variance", "=", "data_variance", "\n", "", "elif", "model_variance", "is", "not", "None", ":", "\n", "                ", "outputs_variance", "=", "model_variance", "+", "args", ".", "tau", "\n", "\n", "", "one_hot_targets", "=", "one_hot_pred_from_label", "(", "outputs_mean", ",", "targets", ")", "\n", "\n", "# Compute negative log-likelihood (if variance estimate available)", "\n", "if", "outputs_variance", "is", "not", "None", ":", "\n", "                ", "batch_log_likelihood", "=", "compute_log_likelihood", "(", "outputs_mean", ",", "one_hot_targets", ",", "outputs_variance", ")", "\n", "batch_neg_log_likelihood", "=", "-", "batch_log_likelihood", "\n", "# Sum along batch dimension", "\n", "neg_log_likelihood", "+=", "torch", ".", "sum", "(", "batch_neg_log_likelihood", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "\n", "nll_l", ".", "append", "(", "torch", ".", "sum", "(", "batch_neg_log_likelihood", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "/", "targets", ".", "size", "(", "0", ")", ")", "\n", "\n", "# Compute brier score", "\n", "", "batch_brier_score", "=", "compute_brier_score", "(", "outputs_mean", ",", "one_hot_targets", ")", "\n", "# Sum along batch dimension", "\n", "brier_score", "+=", "torch", ".", "sum", "(", "batch_brier_score", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "\n", "brier_l", ".", "append", "(", "torch", ".", "sum", "(", "batch_brier_score", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "/", "targets", ".", "size", "(", "0", ")", ")", "\n", "# Compute loss", "\n", "loss", "=", "criterion", "(", "outputs_mean", ",", "targets", ")", "\n", "test_loss", "+=", "loss", ".", "item", "(", ")", "\n", "\n", "ece_l", ".", "append", "(", "ece_score", "(", "outputs_mean", ",", "targets", ")", ".", "item", "(", ")", ")", "\n", "\n", "# Compute predictions and numer of correct predictions", "\n", "_", ",", "predicted", "=", "outputs_mean", ".", "max", "(", "1", ")", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "acc_l", ".", "append", "(", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "/", "targets", ".", "size", "(", "0", ")", ")", "\n", "\n", "pred", ".", "append", "(", "predicted", ")", "\n", "label", ".", "append", "(", "targets", ")", "\n", "\n", "if", "args", ".", "show_bar", "and", "args", ".", "verbose", ":", "\n", "                ", "progress_bar", "(", "batch_idx", ",", "len", "(", "testloader", ")", ",", "'Loss: %.3f | Acc: %.3f%% (%d/%d)'", "\n", "%", "(", "test_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", ",", "correct", ",", "total", ")", ")", "\n", "\n", "", "", "", "mat", "=", "{", "'nll'", ":", "nll_l", ",", "'acc'", ":", "acc_l", ",", "'brier'", ":", "brier_l", ",", "'ece'", ":", "ece_l", "}", "\n", "savemat", "(", "'data.mat'", ",", "mat", ")", "\n", "\n", "\n", "map_r_c0_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_r_c0", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "map_r_c1_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_r_c1", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "map_r_c2_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_r_c2", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "map_r_c3_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_r_c3", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "\n", "\n", "map_u_c0_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_u_c0", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "map_u_c1_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_u_c1", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "map_u_c2_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_u_c2", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "map_u_c3_avg", "=", "np", ".", "mean", "(", "np", ".", "stack", "(", "store_u_c3", ",", "axis", "=", "0", ")", ",", "axis", "=", "0", ")", "\n", "\n", "print", "(", "\"map_r_c0_avg shape\"", ")", "\n", "print", "(", "map_r_c0_avg", ")", "\n", "print", "(", "\"map_u_c0_avg\"", ")", "\n", "print", "(", "map_u_c0_avg", ")", "\n", "\n", "accuracy", "=", "100.", "*", "correct", "/", "total", "\n", "brier_score", "=", "brier_score", "/", "total", "\n", "neg_log_likelihood", "=", "neg_log_likelihood", "/", "total", "\n", "auc", "=", "auc", "/", "total", "\n", "pred", "=", "torch", ".", "cat", "(", "pred", ",", "dim", "=", "0", ")", "\n", "label", "=", "torch", ".", "cat", "(", "label", ",", "dim", "=", "0", ")", "\n", "auc", "=", "multiclass_roc_auc_score", "(", "pred", ",", "label", ")", "\n", "ece", "=", "sum", "(", "ece_l", ")", "/", "len", "(", "ece_l", ")", "\n", "print", "(", "\"input mean\"", ")", "\n", "print", "(", "sum", "(", "mean_l", ")", "/", "len", "(", "mean_l", ")", ")", "\n", "return", "accuracy", ",", "brier_score", ",", "neg_log_likelihood", ",", "auc", ",", "ece", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.model_loader": [[72, 86], ["args.test_model_name.lower", "args.test_model_name.lower"], "function", ["None"], ["def", "model_loader", "(", ")", ":", "\n", "    ", "model", "=", "{", "'eegnet'", ":", "EEGNet", ",", "\n", "'eegnet_dropout'", ":", "EEGNet_Dropout", ",", "\n", "'eegnet_adf'", ":", "EEGNet_adf", ",", "\n", "'eegnet_dropout_adf'", ":", "EEGNet_dropout_adf", "\n", "}", "\n", "\n", "params", "=", "{", "'eegnet'", ":", "[", "args", ".", "p", "]", ",", "\n", "'eegnet_dropout'", ":", "[", "args", ".", "p", "]", ",", "\n", "'eegnet_adf'", ":", "[", "args", ".", "noise_variance", ",", "args", ".", "min_variance", "]", ",", "\n", "'eegnet_dropout_adf'", ":", "[", "args", ".", "p", ",", "args", ".", "noise_variance", ",", "args", ".", "min_variance", "]", "\n", "}", "\n", "\n", "return", "model", "[", "args", ".", "test_model_name", ".", "lower", "(", ")", "]", "(", "*", "params", "[", "args", ".", "test_model_name", ".", "lower", "(", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.set_training_mode_for_dropout": [[109, 120], ["net.modules", "m.__class__.__name__.startswith", "m.train", "m.eval"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.train"], ["", "def", "set_training_mode_for_dropout", "(", "net", ",", "training", "=", "True", ")", ":", "\n", "    ", "\"\"\"Set Dropout mode to train or eval.\"\"\"", "\n", "\n", "for", "m", "in", "net", ".", "modules", "(", ")", ":", "\n", "#        print(m.__class__.__name__)", "\n", "        ", "if", "m", ".", "__class__", ".", "__name__", ".", "startswith", "(", "'Dropout'", ")", ":", "\n", "            ", "if", "training", "==", "True", ":", "\n", "                ", "m", ".", "train", "(", ")", "\n", "", "else", ":", "\n", "                ", "m", ".", "eval", "(", ")", "\n", "", "", "", "return", "net", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.one_hot_pred_from_label": [[121, 128], ["torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "labels.size", "labels.size"], "function", ["None"], ["", "def", "one_hot_pred_from_label", "(", "y_pred", ",", "labels", ")", ":", "\n", "    ", "y_true", "=", "torch", ".", "zeros_like", "(", "y_pred", ")", "\n", "ones", "=", "torch", ".", "ones_like", "(", "y_pred", ")", "\n", "indexes", "=", "[", "l", "for", "l", "in", "labels", "]", "\n", "y_true", "[", "torch", ".", "arange", "(", "labels", ".", "size", "(", "0", ")", ")", ",", "indexes", "]", "=", "ones", "[", "torch", ".", "arange", "(", "labels", ".", "size", "(", "0", ")", ")", ",", "indexes", "]", "\n", "\n", "return", "y_true", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.compute_log_likelihood": [[129, 134], ["torch.distributions.normal.Normal", "torch.distributions.normal.Normal", "torch.distributions.normal.Normal", "torch.distributions.normal.Normal.log_prob", "torch.mean", "torch.mean", "torch.mean"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean"], ["", "def", "compute_log_likelihood", "(", "y_pred", ",", "y_true", ",", "sigma", ")", ":", "\n", "    ", "dist", "=", "torch", ".", "distributions", ".", "normal", ".", "Normal", "(", "loc", "=", "y_pred", ",", "scale", "=", "sigma", ")", "\n", "log_likelihood", "=", "dist", ".", "log_prob", "(", "y_true", ")", "\n", "log_likelihood", "=", "torch", ".", "mean", "(", "log_likelihood", ",", "dim", "=", "1", ")", "\n", "return", "log_likelihood", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.compute_brier_score": [[135, 142], ["torch.mean", "torch.mean", "torch.mean"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean"], ["", "def", "compute_brier_score", "(", "y_pred", ",", "y_true", ")", ":", "\n", "    ", "\"\"\"Brier score implementation follows \n    https://papers.nips.cc/paper/7219-simple-and-scalable-predictive-uncertainty-estimation-using-deep-ensembles.pdf.\n    The lower the Brier score is for a set of predictions, the better the predictions are calibrated.\"\"\"", "\n", "\n", "brier_score", "=", "torch", ".", "mean", "(", "(", "y_true", "-", "y_pred", ")", "**", "2", ",", "1", ")", "\n", "return", "brier_score", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.compute_preds": [[143, 183], ["torch.Softmax", "contrib.adf.Softmax", "set_training_mode_for_dropout.eval", "eval.set_training_mode_for_dropout", "eval.compute_preds.keep_variance"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.set_training_mode_for_dropout", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.keep_variance"], ["", "def", "compute_preds", "(", "net", ",", "inputs", ",", "use_adf", "=", "False", ",", "use_mcdo", "=", "False", ")", ":", "\n", "\n", "    ", "model_variance", "=", "None", "\n", "data_variance", "=", "None", "\n", "\n", "def", "keep_variance", "(", "x", ",", "min_variance", ")", ":", "\n", "        ", "return", "x", "+", "min_variance", "\n", "\n", "", "keep_variance_fn", "=", "lambda", "x", ":", "keep_variance", "(", "x", ",", "min_variance", "=", "args", ".", "min_variance", ")", "\n", "softmax", "=", "nn", ".", "Softmax", "(", "dim", "=", "1", ")", "\n", "adf_softmax", "=", "adf", ".", "Softmax", "(", "dim", "=", "1", ",", "keep_variance_fn", "=", "keep_variance_fn", ")", "\n", "\n", "net", ".", "eval", "(", ")", "\n", "if", "use_mcdo", ":", "\n", "        ", "net", "=", "set_training_mode_for_dropout", "(", "net", ",", "True", ")", "\n", "outputs", "=", "[", "net", "(", "inputs", ")", "for", "i", "in", "range", "(", "args", ".", "num_samples", ")", "]", "\n", "\n", "if", "use_adf", ":", "\n", "            ", "outputs", "=", "[", "adf_softmax", "(", "*", "outs", ")", "for", "outs", "in", "outputs", "]", "\n", "outputs_mean", "=", "[", "mean", "for", "(", "mean", ",", "var", ")", "in", "outputs", "]", "\n", "data_variance", "=", "[", "var", "for", "(", "mean", ",", "var", ")", "in", "outputs", "]", "\n", "data_variance", "=", "torch", ".", "stack", "(", "data_variance", ")", "\n", "data_variance", "=", "torch", ".", "mean", "(", "data_variance", ",", "dim", "=", "0", ")", "\n", "", "else", ":", "\n", "            ", "outputs_mean", "=", "[", "softmax", "(", "outs", ")", "for", "outs", "in", "outputs", "]", "\n", "\n", "", "outputs_mean", "=", "torch", ".", "stack", "(", "outputs_mean", ")", "\n", "model_variance", "=", "torch", ".", "var", "(", "outputs_mean", ",", "dim", "=", "0", ")", "\n", "# Compute MCDO prediction", "\n", "outputs_mean", "=", "torch", ".", "mean", "(", "outputs_mean", ",", "dim", "=", "0", ")", "\n", "", "else", ":", "\n", "        ", "outputs", "=", "net", "(", "inputs", ")", "\n", "if", "adf", ":", "\n", "            ", "outputs_mean", ",", "data_variance", "=", "adf_softmax", "(", "*", "outputs", ")", "\n", "", "else", ":", "\n", "            ", "outputs_mean", "=", "outputs", "\n", "\n", "", "", "net", "=", "set_training_mode_for_dropout", "(", "net", ",", "False", ")", "\n", "\n", "return", "outputs_mean", ",", "data_variance", ",", "model_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.eval.evaluate": [[185, 308], ["net.eval", "print", "print", "scipy.io.savemat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "eval.evaluate.multiclass_roc_auc_score"], "function", ["None"], ["", "def", "evaluate", "(", "net", ",", "use_adf", "=", "False", ",", "use_mcdo", "=", "False", ")", ":", "\n", "\n", "    ", "def", "multiclass_roc_auc_score", "(", "y_test", ",", "y_pred", ",", "average", "=", "\"macro\"", ")", ":", "\n", "        ", "lb", "=", "LabelBinarizer", "(", ")", "\n", "lb", ".", "fit", "(", "y_test", ")", "\n", "y_test", "=", "lb", ".", "transform", "(", "y_test", ")", "\n", "y_pred", "=", "lb", ".", "transform", "(", "y_pred", ")", "\n", "return", "roc_auc_score", "(", "y_test", ",", "y_pred", ",", "average", "=", "average", ")", "\n", "\n", "\n", "", "def", "ece_score", "(", "logits", ",", "labels", ",", "n_bins", "=", "30", ")", ":", "\n", "        ", "confidences", ",", "predictions", "=", "torch", ".", "max", "(", "logits", ",", "1", ")", "\n", "ece", "=", "torch", ".", "zeros", "(", "1", ",", "device", "=", "logits", ".", "device", ")", "\n", "accuracies", "=", "predictions", ".", "eq", "(", "labels", ")", "\n", "bin_boundaries", "=", "torch", ".", "linspace", "(", "0", ",", "1", ",", "n_bins", "+", "1", ")", "\n", "bin_lowers", "=", "bin_boundaries", "[", ":", "-", "1", "]", "\n", "bin_uppers", "=", "bin_boundaries", "[", "1", ":", "]", "\n", "\n", "for", "bin_lower", ",", "bin_upper", "in", "zip", "(", "bin_lowers", ",", "bin_uppers", ")", ":", "\n", "            ", "in_bin", "=", "confidences", ".", "gt", "(", "bin_lower", ".", "item", "(", ")", ")", "*", "confidences", ".", "le", "(", "bin_upper", ".", "item", "(", ")", ")", "\n", "prop_in_bin", "=", "in_bin", ".", "float", "(", ")", ".", "mean", "(", ")", "\n", "if", "prop_in_bin", ".", "item", "(", ")", ">", "0", ":", "\n", "                ", "accuracy_in_bin", "=", "accuracies", "[", "in_bin", "]", ".", "float", "(", ")", ".", "mean", "(", ")", "\n", "avg_confidence_in_bin", "=", "confidences", "[", "in_bin", "]", ".", "mean", "(", ")", "\n", "ece", "+=", "torch", ".", "abs", "(", "avg_confidence_in_bin", "-", "accuracy_in_bin", ")", "*", "prop_in_bin", "\n", "\n", "", "", "return", "ece", "\n", "\n", "\n", "", "net", ".", "eval", "(", ")", "\n", "test_loss", "=", "0", "\n", "correct", "=", "0", "\n", "brier_score", "=", "0", "\n", "neg_log_likelihood", "=", "0", "\n", "auc", "=", "0", "\n", "ece", "=", "0", "\n", "total", "=", "0", "\n", "outputs_variance", "=", "None", "\n", "print", "(", "\"use adf\"", ")", "\n", "print", "(", "use_adf", ")", "\n", "\n", "pred", "=", "[", "]", "\n", "label", "=", "[", "]", "\n", "ece_l", "=", "[", "]", "\n", "mean_l", "=", "[", "]", "\n", "acc_l", "=", "[", "]", "\n", "nll_l", "=", "[", "]", "\n", "brier_l", "=", "[", "]", "\n", "\n", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "for", "batch_idx", ",", "(", "inputs", ",", "targets", ")", "in", "enumerate", "(", "testloader", ")", ":", "\n", "\n", "            ", "mean_l", ".", "append", "(", "torch", ".", "mean", "(", "inputs", ")", ")", "\n", "inputs", ",", "targets", "=", "inputs", ".", "to", "(", "device", ")", ",", "targets", ".", "to", "(", "device", ")", "\n", "\n", "outputs_mean", ",", "data_variance", ",", "model_variance", "=", "compute_preds", "(", "net", ",", "inputs", ",", "use_adf", ",", "use_mcdo", ")", "\n", "#print(\"outputs_mean\")", "\n", "#print(outputs_mean.shape)", "\n", "if", "data_variance", "is", "not", "None", "and", "model_variance", "is", "not", "None", ":", "\n", "                ", "outputs_variance", "=", "data_variance", "+", "model_variance", "\n", "#                print(\"outputs_variance\")", "\n", "#                print(outputs_variance)", "\n", "", "elif", "data_variance", "is", "not", "None", ":", "\n", "                ", "outputs_variance", "=", "data_variance", "\n", "", "elif", "model_variance", "is", "not", "None", ":", "\n", "                ", "outputs_variance", "=", "model_variance", "+", "args", ".", "tau", "\n", "#print(\"model variance\")", "\n", "#print(model_variance.shape)", "\n", "\n", "", "one_hot_targets", "=", "one_hot_pred_from_label", "(", "outputs_mean", ",", "targets", ")", "\n", "\n", "# Compute negative log-likelihood (if variance estimate available)", "\n", "if", "outputs_variance", "is", "not", "None", ":", "\n", "                ", "batch_log_likelihood", "=", "compute_log_likelihood", "(", "outputs_mean", ",", "one_hot_targets", ",", "outputs_variance", ")", "\n", "batch_neg_log_likelihood", "=", "-", "batch_log_likelihood", "\n", "# Sum along batch dimension", "\n", "neg_log_likelihood", "+=", "torch", ".", "sum", "(", "batch_neg_log_likelihood", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "\n", "nll_l", ".", "append", "(", "torch", ".", "sum", "(", "batch_neg_log_likelihood", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "/", "targets", ".", "size", "(", "0", ")", ")", "\n", "\n", "# Compute brier score", "\n", "", "batch_brier_score", "=", "compute_brier_score", "(", "outputs_mean", ",", "one_hot_targets", ")", "\n", "# Sum along batch dimension", "\n", "brier_score", "+=", "torch", ".", "sum", "(", "batch_brier_score", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "\n", "brier_l", ".", "append", "(", "torch", ".", "sum", "(", "batch_brier_score", ",", "0", ")", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "item", "(", ")", "/", "targets", ".", "size", "(", "0", ")", ")", "\n", "# Compute loss", "\n", "loss", "=", "criterion", "(", "outputs_mean", ",", "targets", ")", "\n", "test_loss", "+=", "loss", ".", "item", "(", ")", "\n", "\n", "\n", "ece_l", ".", "append", "(", "ece_score", "(", "outputs_mean", ",", "targets", ")", ".", "item", "(", ")", ")", "\n", "\n", "\n", "# Compute predictions and numer of correct predictions", "\n", "_", ",", "predicted", "=", "outputs_mean", ".", "max", "(", "1", ")", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "acc_l", ".", "append", "(", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "/", "targets", ".", "size", "(", "0", ")", ")", "\n", "\n", "\n", "pred", ".", "append", "(", "predicted", ")", "\n", "label", ".", "append", "(", "targets", ")", "\n", "\n", "if", "args", ".", "show_bar", "and", "args", ".", "verbose", ":", "\n", "                ", "progress_bar", "(", "batch_idx", ",", "len", "(", "testloader", ")", ",", "'Loss: %.3f | Acc: %.3f%% (%d/%d)'", "\n", "%", "(", "test_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", ",", "correct", ",", "total", ")", ")", "\n", "\n", "", "", "", "mat", "=", "{", "'nll'", ":", "nll_l", ",", "'acc'", ":", "acc_l", ",", "'brier'", ":", "brier_l", ",", "'ece'", ":", "ece_l", "}", "\n", "savemat", "(", "'data.mat'", ",", "mat", ")", "\n", "\n", "\n", "\n", "accuracy", "=", "100.", "*", "correct", "/", "total", "\n", "brier_score", "=", "brier_score", "/", "total", "\n", "neg_log_likelihood", "=", "neg_log_likelihood", "/", "total", "\n", "auc", "=", "auc", "/", "total", "\n", "pred", "=", "torch", ".", "cat", "(", "pred", ",", "dim", "=", "0", ")", "\n", "label", "=", "torch", ".", "cat", "(", "label", ",", "dim", "=", "0", ")", "\n", "auc", "=", "multiclass_roc_auc_score", "(", "pred", ",", "label", ")", "\n", "ece", "=", "sum", "(", "ece_l", ")", "/", "len", "(", "ece_l", ")", "\n", "print", "(", "\"input mean\"", ")", "\n", "print", "(", "sum", "(", "mean_l", ")", "/", "len", "(", "mean_l", ")", ")", "\n", "return", "accuracy", ",", "brier_score", ",", "neg_log_likelihood", ",", "auc", ",", "ece", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.SoftmaxHeteroscedasticLoss.__init__": [[109, 113], ["super().__init__", "contrib.adf.Softmax", "train.keep_variance"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.keep_variance"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "SoftmaxHeteroscedasticLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "keep_variance_fn", "=", "lambda", "x", ":", "keep_variance", "(", "x", ",", "min_variance", "=", "args", ".", "min_variance", ")", "\n", "self", ".", "adf_softmax", "=", "adf", ".", "Softmax", "(", "dim", "=", "1", ",", "keep_variance_fn", "=", "keep_variance_fn", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.SoftmaxHeteroscedasticLoss.forward": [[114, 120], ["train.SoftmaxHeteroscedasticLoss.adf_softmax", "train.one_hot_pred_from_label", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log", "torch.log"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.one_hot_pred_from_label", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean"], ["", "def", "forward", "(", "self", ",", "outputs", ",", "targets", ",", "eps", "=", "1e-5", ")", ":", "\n", "        ", "mean", ",", "var", "=", "self", ".", "adf_softmax", "(", "*", "outputs", ")", "\n", "targets", "=", "one_hot_pred_from_label", "(", "mean", ",", "targets", ")", "\n", "\n", "precision", "=", "1", "/", "(", "var", "+", "eps", ")", "\n", "return", "torch", ".", "mean", "(", "0.5", "*", "precision", "*", "(", "targets", "-", "mean", ")", "**", "2", "+", "0.5", "*", "torch", ".", "log", "(", "var", "+", "eps", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.model_loader": [[61, 73], ["args.model_name.lower", "args.model_name.lower"], "function", ["None"], ["def", "model_loader", "(", ")", ":", "\n", "    ", "model", "=", "{", "'eegnet'", ":", "EEGNet", ",", "\n", "'eegnet_dropout'", ":", "EEGNet_Dropout", ",", "\n", "'eegnet_adf'", ":", "EEGNet_adf", "\n", "}", "\n", "\n", "params", "=", "{", "'eegnet'", ":", "[", "args", ".", "p", "]", ",", "\n", "'eegnet_dropout'", ":", "[", "args", ".", "p", "]", ",", "\n", "'eegnet_adf'", ":", "[", "]", "\n", "}", "\n", "\n", "return", "model", "[", "args", ".", "model_name", ".", "lower", "(", ")", "]", "(", "*", "params", "[", "args", ".", "model_name", ".", "lower", "(", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.one_hot_pred_from_label": [[95, 102], ["torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "labels.size", "labels.size"], "function", ["None"], ["", "def", "one_hot_pred_from_label", "(", "y_pred", ",", "labels", ")", ":", "\n", "    ", "y_true", "=", "torch", ".", "zeros_like", "(", "y_pred", ")", "\n", "ones", "=", "torch", ".", "ones_like", "(", "y_pred", ")", "\n", "indexes", "=", "[", "l", "for", "l", "in", "labels", "]", "\n", "y_true", "[", "torch", ".", "arange", "(", "labels", ".", "size", "(", "0", ")", ")", ",", "indexes", "]", "=", "ones", "[", "torch", ".", "arange", "(", "labels", ".", "size", "(", "0", ")", ")", ",", "indexes", "]", "\n", "\n", "return", "y_true", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.keep_variance": [[103, 105], ["None"], "function", ["None"], ["", "def", "keep_variance", "(", "x", ",", "min_variance", ")", ":", "\n", "        ", "return", "x", "+", "min_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.train": [[130, 160], ["print", "net.train", "enumerate", "optimizer.zero_grad", "net", "args.model_name.lower().endswith", "criterion.backward", "optimizer.step", "criterion.item", "outputs_mean.max", "targets.size", "predicted.eq().sum().item", "inputs.to", "targets.to", "criterion", "criterion", "utils.progress_bar", "args.model_name.lower", "predicted.eq().sum", "len", "predicted.eq"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.train", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.lgamma_function.lgamma_function.LogGammaFunction.backward", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.progress_bar"], ["def", "train", "(", "epoch", ",", "net", ")", ":", "\n", "    ", "print", "(", "'\\nEpoch: {} '", ".", "format", "(", "epoch", ")", ")", "\n", "net", ".", "train", "(", ")", "\n", "train_loss", "=", "0", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "for", "batch_idx", ",", "(", "inputs", ",", "targets", ")", "in", "enumerate", "(", "trainloader", ")", ":", "\n", "        ", "inputs", ",", "targets", "=", "inputs", ".", "to", "(", "device", ")", ",", "targets", ".", "to", "(", "device", ")", "\n", "optimizer", ".", "zero_grad", "(", ")", "\n", "outputs", "=", "net", "(", "inputs", ")", "\n", "if", "args", ".", "model_name", ".", "lower", "(", ")", ".", "endswith", "(", "'adf'", ")", ":", "\n", "            ", "outputs_mean", ",", "outputs_var", "=", "outputs", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "outputs_mean", ",", "_", "=", "outputs", "\n", "", "else", ":", "\n", "            ", "outputs_mean", "=", "outputs", "\n", "loss", "=", "criterion", "(", "outputs_mean", ",", "targets", ")", "\n", "\n", "# print(loss)", "\n", "", "loss", ".", "backward", "(", ")", "\n", "optimizer", ".", "step", "(", ")", "\n", "\n", "train_loss", "+=", "loss", ".", "item", "(", ")", "\n", "_", ",", "predicted", "=", "outputs_mean", ".", "max", "(", "1", ")", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "\n", "if", "args", ".", "show_bar", ":", "\n", "            ", "progress_bar", "(", "batch_idx", ",", "len", "(", "trainloader", ")", ",", "'Loss: %.3f | Acc: %.3f%% (%d/%d)'", "\n", "%", "(", "train_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", ",", "correct", ",", "total", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.train.test": [[161, 217], ["net.eval", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "enumerate", "print", "torch.save", "torch.save", "torch.save", "torch.save", "print", "torch.save", "torch.save", "torch.save", "torch.save", "net", "args.model_name.lower().endswith", "criterion.item", "outputs_mean.max", "targets.size", "predicted.eq().sum().item", "net.state_dict", "os.path.isdir", "os.path.isdir", "os.mkdir", "os.mkdir", "net.state_dict", "os.path.isdir", "os.path.isdir", "os.mkdir", "os.mkdir", "inputs.to", "targets.to", "criterion", "criterion", "utils.progress_bar", "args.model_name.lower", "predicted.eq().sum", "len", "predicted.eq"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.progress_bar"], ["", "", "", "def", "test", "(", "epoch", ",", "net", ")", ":", "\n", "    ", "global", "best_acc", "\n", "net", ".", "eval", "(", ")", "\n", "test_loss", "=", "0", "\n", "correct", "=", "0", "\n", "total", "=", "0", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "for", "batch_idx", ",", "(", "inputs", ",", "targets", ")", "in", "enumerate", "(", "testloader", ")", ":", "\n", "            ", "inputs", ",", "targets", "=", "inputs", ".", "to", "(", "device", ")", ",", "targets", ".", "to", "(", "device", ")", "\n", "outputs", "=", "net", "(", "inputs", ")", "\n", "if", "args", ".", "model_name", ".", "lower", "(", ")", ".", "endswith", "(", "'adf'", ")", ":", "\n", "                ", "outputs_mean", ",", "outputs_var", "=", "outputs", "\n", "loss", "=", "criterion", "(", "outputs", ",", "targets", ")", "\n", "outputs_mean", ",", "_", "=", "outputs", "\n", "", "else", ":", "\n", "                ", "outputs_mean", "=", "outputs", "\n", "loss", "=", "criterion", "(", "outputs_mean", ",", "targets", ")", "\n", "\n", "", "test_loss", "+=", "loss", ".", "item", "(", ")", "\n", "_", ",", "predicted", "=", "outputs_mean", ".", "max", "(", "1", ")", "\n", "total", "+=", "targets", ".", "size", "(", "0", ")", "\n", "correct", "+=", "predicted", ".", "eq", "(", "targets", ")", ".", "sum", "(", ")", ".", "item", "(", ")", "\n", "\n", "if", "args", ".", "show_bar", ":", "\n", "                ", "progress_bar", "(", "batch_idx", ",", "len", "(", "testloader", ")", ",", "'Loss: %.3f | Acc: %.3f%% (%d/%d)'", "\n", "%", "(", "test_loss", "/", "(", "batch_idx", "+", "1", ")", ",", "100.", "*", "correct", "/", "total", ",", "correct", ",", "total", ")", ")", "\n", "\n", "# Save checkpoint.", "\n", "", "", "", "acc", "=", "100.", "*", "correct", "/", "total", "\n", "if", "acc", ">", "best_acc", ":", "\n", "        ", "print", "(", "'\\nSaving..'", ")", "\n", "state", "=", "{", "\n", "'net'", ":", "net", ".", "state_dict", "(", ")", ",", "\n", "'acc'", ":", "acc", ",", "\n", "'epoch'", ":", "epoch", ",", "\n", "}", "\n", "if", "not", "os", ".", "path", ".", "isdir", "(", "'checkpoint'", ")", ":", "\n", "            ", "os", ".", "mkdir", "(", "'checkpoint'", ")", "\n", "\n", "", "torch", ".", "save", "(", "state", ",", "'./checkpoint/ckpt_{}.pth'", ".", "format", "(", "args", ".", "model_name", ")", ")", "\n", "best_acc", "=", "acc", "\n", "\n", "# Save checkpoint.", "\n", "", "acc", "=", "100.", "*", "correct", "/", "total", "\n", "if", "acc", ">", "best_acc", ":", "\n", "        ", "print", "(", "'\\nSaving..'", ")", "\n", "state", "=", "{", "\n", "'net'", ":", "net", ".", "state_dict", "(", ")", ",", "\n", "'acc'", ":", "acc", ",", "\n", "'epoch'", ":", "epoch", ",", "\n", "}", "\n", "if", "not", "os", ".", "path", ".", "isdir", "(", "'checkpoint'", ")", ":", "\n", "            ", "os", ".", "mkdir", "(", "'checkpoint'", ")", "\n", "\n", "", "torch", ".", "save", "(", "state", ",", "'./checkpoint/ckpt_{}.pth'", ".", "format", "(", "args", ".", "model_name", ")", ")", "\n", "best_acc", "=", "acc", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.get_mean_and_std": [[15, 28], ["torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torch.utils.data.DataLoader", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "print", "torch.zeros.div_", "torch.zeros.div_", "range", "len", "len", "inputs[].mean", "inputs[].std"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean"], ["def", "get_mean_and_std", "(", "dataset", ")", ":", "\n", "    ", "'''Compute the mean and std value of dataset.'''", "\n", "dataloader", "=", "torch", ".", "utils", ".", "data", ".", "DataLoader", "(", "dataset", ",", "batch_size", "=", "1", ",", "shuffle", "=", "True", ",", "num_workers", "=", "2", ")", "\n", "mean", "=", "torch", ".", "zeros", "(", "3", ")", "\n", "std", "=", "torch", ".", "zeros", "(", "3", ")", "\n", "print", "(", "'==> Computing mean and std..'", ")", "\n", "for", "inputs", ",", "targets", "in", "dataloader", ":", "\n", "        ", "for", "i", "in", "range", "(", "3", ")", ":", "\n", "            ", "mean", "[", "i", "]", "+=", "inputs", "[", ":", ",", "i", ",", ":", ",", ":", "]", ".", "mean", "(", ")", "\n", "std", "[", "i", "]", "+=", "inputs", "[", ":", ",", "i", ",", ":", ",", ":", "]", ".", "std", "(", ")", "\n", "", "", "mean", ".", "div_", "(", "len", "(", "dataset", ")", ")", "\n", "std", ".", "div_", "(", "len", "(", "dataset", ")", ")", "\n", "return", "mean", ",", "std", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.init_params": [[29, 43], ["net.modules", "isinstance", "torch.kaiming_normal", "isinstance", "torch.constant", "torch.constant", "torch.constant", "isinstance", "torch.normal", "torch.constant"], "function", ["None"], ["", "def", "init_params", "(", "net", ")", ":", "\n", "    ", "'''Init layer parameters.'''", "\n", "for", "m", "in", "net", ".", "modules", "(", ")", ":", "\n", "        ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "            ", "init", ".", "kaiming_normal", "(", "m", ".", "weight", ",", "mode", "=", "'fan_out'", ")", "\n", "if", "m", ".", "bias", ":", "\n", "                ", "init", ".", "constant", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "            ", "init", ".", "constant", "(", "m", ".", "weight", ",", "1", ")", "\n", "init", ".", "constant", "(", "m", ".", "bias", ",", "0", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "Linear", ")", ":", "\n", "            ", "init", ".", "normal", "(", "m", ".", "weight", ",", "std", "=", "1e-3", ")", "\n", "if", "m", ".", "bias", ":", "\n", "                ", "init", ".", "constant", "(", "m", ".", "bias", ",", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.progress_bar": [[52, 94], ["int", "sys.stdout.write", "range", "sys.stdout.write", "range", "sys.stdout.write", "time.time", "L.append", "L.append", "sys.stdout.write", "range", "range", "sys.stdout.write", "sys.stdout.flush", "time.time", "int", "sys.stdout.write", "sys.stdout.write", "L.append", "sys.stdout.write", "sys.stdout.write", "sys.stdout.write", "sys.stdout.write", "utils.format_time", "utils.format_time", "len", "int", "int"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.format_time", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.format_time"], ["def", "progress_bar", "(", "current", ",", "total", ",", "msg", "=", "None", ")", ":", "\n", "    ", "global", "last_time", ",", "begin_time", "\n", "if", "current", "==", "0", ":", "\n", "        ", "begin_time", "=", "time", ".", "time", "(", ")", "# Reset for new bar.", "\n", "\n", "", "cur_len", "=", "int", "(", "TOTAL_BAR_LENGTH", "*", "current", "/", "total", ")", "\n", "rest_len", "=", "int", "(", "TOTAL_BAR_LENGTH", "-", "cur_len", ")", "-", "1", "\n", "\n", "sys", ".", "stdout", ".", "write", "(", "' ['", ")", "\n", "for", "i", "in", "range", "(", "cur_len", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'='", ")", "\n", "", "sys", ".", "stdout", ".", "write", "(", "'>'", ")", "\n", "for", "i", "in", "range", "(", "rest_len", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'.'", ")", "\n", "", "sys", ".", "stdout", ".", "write", "(", "']'", ")", "\n", "\n", "cur_time", "=", "time", ".", "time", "(", ")", "\n", "step_time", "=", "cur_time", "-", "last_time", "\n", "last_time", "=", "cur_time", "\n", "tot_time", "=", "cur_time", "-", "begin_time", "\n", "\n", "L", "=", "[", "]", "\n", "L", ".", "append", "(", "'  Step: %s'", "%", "format_time", "(", "step_time", ")", ")", "\n", "L", ".", "append", "(", "' | Tot: %s'", "%", "format_time", "(", "tot_time", ")", ")", "\n", "if", "msg", ":", "\n", "        ", "L", ".", "append", "(", "' | '", "+", "msg", ")", "\n", "\n", "", "msg", "=", "''", ".", "join", "(", "L", ")", "\n", "sys", ".", "stdout", ".", "write", "(", "msg", ")", "\n", "for", "i", "in", "range", "(", "term_width", "-", "int", "(", "TOTAL_BAR_LENGTH", ")", "-", "len", "(", "msg", ")", "-", "3", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "' '", ")", "\n", "\n", "# Go back to the center of the bar.", "\n", "", "for", "i", "in", "range", "(", "term_width", "-", "int", "(", "TOTAL_BAR_LENGTH", "/", "2", ")", "+", "2", ")", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'\\b'", ")", "\n", "", "sys", ".", "stdout", ".", "write", "(", "' %d/%d '", "%", "(", "current", "+", "1", ",", "total", ")", ")", "\n", "\n", "if", "current", "<", "total", "-", "1", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'\\r'", ")", "\n", "", "else", ":", "\n", "        ", "sys", ".", "stdout", ".", "write", "(", "'\\n'", ")", "\n", "", "sys", ".", "stdout", ".", "flush", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.None.utils.format_time": [[95, 126], ["int", "int", "int", "int", "int", "str", "str", "str", "str", "str"], "function", ["None"], ["", "def", "format_time", "(", "seconds", ")", ":", "\n", "    ", "days", "=", "int", "(", "seconds", "/", "3600", "/", "24", ")", "\n", "seconds", "=", "seconds", "-", "days", "*", "3600", "*", "24", "\n", "hours", "=", "int", "(", "seconds", "/", "3600", ")", "\n", "seconds", "=", "seconds", "-", "hours", "*", "3600", "\n", "minutes", "=", "int", "(", "seconds", "/", "60", ")", "\n", "seconds", "=", "seconds", "-", "minutes", "*", "60", "\n", "secondsf", "=", "int", "(", "seconds", ")", "\n", "seconds", "=", "seconds", "-", "secondsf", "\n", "millis", "=", "int", "(", "seconds", "*", "1000", ")", "\n", "\n", "f", "=", "''", "\n", "i", "=", "1", "\n", "if", "days", ">", "0", ":", "\n", "        ", "f", "+=", "str", "(", "days", ")", "+", "'D'", "\n", "i", "+=", "1", "\n", "", "if", "hours", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "hours", ")", "+", "'h'", "\n", "i", "+=", "1", "\n", "", "if", "minutes", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "minutes", ")", "+", "'m'", "\n", "i", "+=", "1", "\n", "", "if", "secondsf", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "secondsf", ")", "+", "'s'", "\n", "i", "+=", "1", "\n", "", "if", "millis", ">", "0", "and", "i", "<=", "2", ":", "\n", "        ", "f", "+=", "str", "(", "millis", ")", "+", "'ms'", "\n", "i", "+=", "1", "\n", "", "if", "f", "==", "''", ":", "\n", "        ", "f", "=", "'0ms'", "\n", "", "return", "f", "\n", "", ""]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.dataset_loader_BCI_IV_c.DatasetLoader_BCI_IV_subjects.__init__": [[15, 102], ["scipy.loadmat", "scipy.loadmat", "scipy.loadmat", "scipy.loadmat", "data[].ravel", "data[].ravel", "numpy.transpose", "numpy.transpose", "dataset_loader_BCI_IV_c.DatasetLoader_BCI_IV_subjects.__init__.segment_dataset"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "setname", ",", "args", ",", "train_aug", "=", "False", ")", ":", "\n", "\n", "        ", "subject_id", "=", "8", "\n", "data_folder", "=", "'./data'", "\n", "data", "=", "sio", ".", "loadmat", "(", "data_folder", "+", "\"/cross_sub/cross_subject_data_\"", "+", "str", "(", "subject_id", ")", "+", "\".mat\"", ")", "\n", "test_X", "=", "data", "[", "\"test_x\"", "]", "[", ":", ",", ":", ",", "750", ":", "1500", "]", "# [trials, channels, time length]", "\n", "train_X", "=", "data", "[", "\"train_x\"", "]", "[", ":", ",", ":", ",", "750", ":", "1500", "]", "\n", "\n", "test_y", "=", "data", "[", "\"test_y\"", "]", ".", "ravel", "(", ")", "\n", "train_y", "=", "data", "[", "\"train_y\"", "]", ".", "ravel", "(", ")", "\n", "\n", "train_y", "-=", "1", "\n", "test_y", "-=", "1", "\n", "window_size", "=", "400", "\n", "step", "=", "50", "\n", "n_channel", "=", "22", "\n", "\n", "def", "windows", "(", "data", ",", "size", ",", "step", ")", ":", "\n", "            ", "start", "=", "0", "\n", "while", "(", "(", "start", "+", "size", ")", "<", "data", ".", "shape", "[", "0", "]", ")", ":", "\n", "                ", "yield", "int", "(", "start", ")", ",", "int", "(", "start", "+", "size", ")", "\n", "start", "+=", "step", "\n", "\n", "", "", "def", "segment_signal_without_transition", "(", "data", ",", "window_size", ",", "step", ")", ":", "\n", "            ", "segments", "=", "[", "]", "\n", "for", "(", "start", ",", "end", ")", "in", "windows", "(", "data", ",", "window_size", ",", "step", ")", ":", "\n", "                ", "if", "(", "len", "(", "data", "[", "start", ":", "end", "]", ")", "==", "window_size", ")", ":", "\n", "                    ", "segments", "=", "segments", "+", "[", "data", "[", "start", ":", "end", "]", "]", "\n", "", "", "return", "np", ".", "array", "(", "segments", ")", "\n", "\n", "\n", "", "def", "segment_dataset", "(", "X", ",", "window_size", ",", "step", ")", ":", "\n", "            ", "win_x", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "X", ".", "shape", "[", "0", "]", ")", ":", "\n", "                ", "win_x", "=", "win_x", "+", "[", "segment_signal_without_transition", "(", "X", "[", "i", "]", ",", "window_size", ",", "step", ")", "]", "\n", "", "win_x", "=", "np", ".", "array", "(", "win_x", ")", "\n", "return", "win_x", "\n", "\n", "", "train_raw_x", "=", "np", ".", "transpose", "(", "train_X", ",", "[", "0", ",", "2", ",", "1", "]", ")", "\n", "test_raw_x", "=", "np", ".", "transpose", "(", "test_X", ",", "[", "0", ",", "2", ",", "1", "]", ")", "\n", "\n", "train_win_x", "=", "segment_dataset", "(", "train_raw_x", ",", "window_size", ",", "step", ")", "\n", "test_win_x", "=", "segment_dataset", "(", "test_raw_x", ",", "window_size", ",", "step", ")", "\n", "train_win_y", "=", "train_y", "\n", "test_win_y", "=", "test_y", "\n", "\n", "expand_factor", "=", "train_win_x", ".", "shape", "[", "1", "]", "\n", "\n", "train_x", "=", "np", ".", "reshape", "(", "train_win_x", ",", "(", "-", "1", ",", "train_win_x", ".", "shape", "[", "2", "]", ",", "train_win_x", ".", "shape", "[", "3", "]", ")", ")", "\n", "test_x", "=", "np", ".", "reshape", "(", "test_win_x", ",", "(", "-", "1", ",", "test_win_x", ".", "shape", "[", "2", "]", ",", "test_win_x", ".", "shape", "[", "3", "]", ")", ")", "\n", "train_y", "=", "np", ".", "repeat", "(", "train_y", ",", "expand_factor", ")", "\n", "test_y", "=", "np", ".", "repeat", "(", "test_y", ",", "expand_factor", ")", "\n", "\n", "\n", "train_x", "=", "np", ".", "reshape", "(", "train_x", ",", "[", "train_x", ".", "shape", "[", "0", "]", ",", "1", ",", "train_x", ".", "shape", "[", "1", "]", ",", "train_x", ".", "shape", "[", "2", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "train_y", "=", "np", ".", "reshape", "(", "train_y", ",", "[", "train_y", ".", "shape", "[", "0", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "\n", "test_x", "=", "np", ".", "reshape", "(", "test_x", ",", "[", "test_x", ".", "shape", "[", "0", "]", ",", "1", ",", "test_x", ".", "shape", "[", "1", "]", ",", "test_x", ".", "shape", "[", "2", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "test_y", "=", "np", ".", "reshape", "(", "test_y", ",", "[", "test_y", ".", "shape", "[", "0", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "\n", "test_x", "=", "test_x", "[", "2000", ":", ",", ":", ",", ":", ",", ":", "]", "\n", "test_y", "=", "test_y", "[", "2000", ":", "]", "\n", "\n", "val_x", "=", "test_x", "[", ":", "2000", ",", ":", ",", ":", ",", ":", "]", "\n", "val_y", "=", "test_y", "[", ":", "2000", "]", "\n", "\n", "train_win_x", "=", "train_win_x", ".", "astype", "(", "'float32'", ")", "\n", "test_win_x", "=", "test_win_x", "[", "500", ":", ",", ":", ",", ":", ",", ":", "]", ".", "astype", "(", "'float32'", ")", "\n", "test_win_y", "=", "test_win_y", "[", "500", ":", "]", "\n", "val_win_x", "=", "test_win_x", "[", ":", "500", ",", ":", ",", ":", ",", ":", "]", ".", "astype", "(", "'float32'", ")", "\n", "val_win_y", "=", "test_win_y", "[", ":", "500", "]", "\n", "\n", "self", ".", "X_val", "=", "val_win_x", "\n", "self", ".", "y_val", "=", "val_win_y", "\n", "\n", "if", "setname", "==", "'train'", ":", "\n", "            ", "self", ".", "data", "=", "train_win_x", "\n", "self", ".", "label", "=", "train_win_y", "\n", "", "elif", "setname", "==", "'val'", ":", "\n", "            ", "self", ".", "data", "=", "val_win_x", "\n", "self", ".", "label", "=", "val_win_y", "\n", "", "elif", "setname", "==", "'test'", ":", "\n", "            ", "self", ".", "data", "=", "test_win_x", "\n", "self", ".", "label", "=", "test_win_y", "\n", "\n", "", "self", ".", "label", "=", "self", ".", "label", ".", "astype", "(", "int", ")", "\n", "self", ".", "num_class", "=", "4", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.dataset_loader_BCI_IV_c.DatasetLoader_BCI_IV_subjects.__len__": [[103, 105], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "data", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.dataset_loader_BCI_IV_c.DatasetLoader_BCI_IV_subjects.__getitem__": [[106, 109], ["None"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "i", ")", ":", "\n", "        ", "data", ",", "label", "=", "self", ".", "data", "[", "i", "]", ",", "self", ".", "label", "[", "i", "]", "\n", "return", "data", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.samplers.CategoriesSampler.__init__": [[13, 24], ["numpy.array", "range", "numpy.argwhere().reshape", "torch.from_numpy", "samplers.CategoriesSampler.m_ind.append", "numpy.argwhere"], "methods", ["None"], ["def", "__init__", "(", "self", ",", "label", ",", "n_batch", ",", "n_cls", ",", "n_per", ")", ":", "\n", "        ", "self", ".", "n_batch", "=", "n_batch", "\n", "self", ".", "n_cls", "=", "n_cls", "\n", "self", ".", "n_per", "=", "n_per", "\n", "\n", "label", "=", "np", ".", "array", "(", "label", ")", "\n", "self", ".", "m_ind", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "n_cls", ")", ":", "\n", "            ", "ind", "=", "np", ".", "argwhere", "(", "label", "==", "i", ")", ".", "reshape", "(", "-", "1", ")", "\n", "ind", "=", "torch", ".", "from_numpy", "(", "ind", ")", "\n", "self", ".", "m_ind", ".", "append", "(", "ind", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.samplers.CategoriesSampler.__len__": [[25, 27], ["None"], "methods", ["None"], ["", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "n_batch", "\n", "", "def", "__iter__", "(", "self", ")", ":", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.samplers.CategoriesSampler.__iter__": [[27, 36], ["range", "range", "torch.stack().t().reshape", "torch.stack().t().reshape.append", "torch.randperm", "torch.stack().t", "len", "torch.stack"], "methods", ["None"], ["", "def", "__iter__", "(", "self", ")", ":", "\n", "        ", "for", "i_batch", "in", "range", "(", "self", ".", "n_batch", ")", ":", "\n", "            ", "batch", "=", "[", "]", "\n", "for", "c", "in", "range", "(", "self", ".", "n_cls", ")", ":", "\n", "                ", "l", "=", "self", ".", "m_ind", "[", "c", "]", "\n", "pos", "=", "torch", ".", "randperm", "(", "len", "(", "l", ")", ")", "[", ":", "self", ".", "n_per", "]", "\n", "batch", ".", "append", "(", "l", "[", "pos", "]", ")", "\n", "", "batch", "=", "torch", ".", "stack", "(", "batch", ")", ".", "t", "(", ")", ".", "reshape", "(", "-", "1", ")", "\n", "yield", "batch", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.dataset_loader_BCI_IV_i.DatasetLoader_BCI_IV_subjects.__init__": [[15, 107], ["scipy.loadmat", "scipy.loadmat", "scipy.loadmat", "scipy.loadmat", "data[].ravel", "data[].ravel", "numpy.transpose", "numpy.transpose", "dataset_loader_BCI_IV_i.DatasetLoader_BCI_IV_subjects.__init__.segment_dataset"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "setname", ",", "args", ",", "train_aug", "=", "False", ")", ":", "\n", "\n", "        ", "data_folder", "=", "'./data'", "\n", "data", "=", "sio", ".", "loadmat", "(", "data_folder", "+", "\"/intra_sub/intra_subject_data.mat\"", ")", "\n", "test_X", "=", "data", "[", "\"test_x\"", "]", "[", ":", ",", ":", ",", "750", ":", "1500", "]", "# [trials, channels, time length]", "\n", "train_X", "=", "data", "[", "\"train_x\"", "]", "[", ":", ",", ":", ",", "750", ":", "1500", "]", "\n", "\n", "test_y", "=", "data", "[", "\"test_y\"", "]", ".", "ravel", "(", ")", "\n", "train_y", "=", "data", "[", "\"train_y\"", "]", ".", "ravel", "(", ")", "\n", "\n", "train_y", "-=", "1", "\n", "test_y", "-=", "1", "\n", "window_size", "=", "400", "\n", "step", "=", "50", "\n", "n_channel", "=", "22", "\n", "\n", "def", "windows", "(", "data", ",", "size", ",", "step", ")", ":", "\n", "            ", "start", "=", "0", "\n", "while", "(", "(", "start", "+", "size", ")", "<", "data", ".", "shape", "[", "0", "]", ")", ":", "\n", "                ", "yield", "int", "(", "start", ")", ",", "int", "(", "start", "+", "size", ")", "\n", "start", "+=", "step", "\n", "\n", "", "", "def", "segment_signal_without_transition", "(", "data", ",", "window_size", ",", "step", ")", ":", "\n", "            ", "segments", "=", "[", "]", "\n", "for", "(", "start", ",", "end", ")", "in", "windows", "(", "data", ",", "window_size", ",", "step", ")", ":", "\n", "                ", "if", "(", "len", "(", "data", "[", "start", ":", "end", "]", ")", "==", "window_size", ")", ":", "\n", "                    ", "segments", "=", "segments", "+", "[", "data", "[", "start", ":", "end", "]", "]", "\n", "", "", "return", "np", ".", "array", "(", "segments", ")", "\n", "\n", "", "def", "segment_dataset", "(", "X", ",", "window_size", ",", "step", ")", ":", "\n", "            ", "win_x", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "X", ".", "shape", "[", "0", "]", ")", ":", "\n", "                ", "win_x", "=", "win_x", "+", "[", "segment_signal_without_transition", "(", "X", "[", "i", "]", ",", "window_size", ",", "step", ")", "]", "\n", "", "win_x", "=", "np", ".", "array", "(", "win_x", ")", "\n", "return", "win_x", "\n", "\n", "", "train_raw_x", "=", "np", ".", "transpose", "(", "train_X", ",", "[", "0", ",", "2", ",", "1", "]", ")", "\n", "test_raw_x", "=", "np", ".", "transpose", "(", "test_X", ",", "[", "0", ",", "2", ",", "1", "]", ")", "\n", "\n", "train_win_x", "=", "segment_dataset", "(", "train_raw_x", ",", "window_size", ",", "step", ")", "\n", "test_win_x", "=", "segment_dataset", "(", "test_raw_x", ",", "window_size", ",", "step", ")", "\n", "train_win_y", "=", "train_y", "\n", "test_win_y", "=", "test_y", "\n", "\n", "expand_factor", "=", "train_win_x", ".", "shape", "[", "1", "]", "\n", "\n", "train_x", "=", "np", ".", "reshape", "(", "train_win_x", ",", "(", "-", "1", ",", "train_win_x", ".", "shape", "[", "2", "]", ",", "train_win_x", ".", "shape", "[", "3", "]", ")", ")", "\n", "test_x", "=", "np", ".", "reshape", "(", "test_win_x", ",", "(", "-", "1", ",", "test_win_x", ".", "shape", "[", "2", "]", ",", "test_win_x", ".", "shape", "[", "3", "]", ")", ")", "\n", "train_y", "=", "np", ".", "repeat", "(", "train_y", ",", "expand_factor", ")", "\n", "test_y", "=", "np", ".", "repeat", "(", "test_y", ",", "expand_factor", ")", "\n", "\n", "\n", "train_x", "=", "np", ".", "reshape", "(", "train_x", ",", "[", "train_x", ".", "shape", "[", "0", "]", ",", "1", ",", "train_x", ".", "shape", "[", "1", "]", ",", "train_x", ".", "shape", "[", "2", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "train_y", "=", "np", ".", "reshape", "(", "train_y", ",", "[", "train_y", ".", "shape", "[", "0", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "\n", "test_x", "=", "np", ".", "reshape", "(", "test_x", ",", "[", "test_x", ".", "shape", "[", "0", "]", ",", "1", ",", "test_x", ".", "shape", "[", "1", "]", ",", "test_x", ".", "shape", "[", "2", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "test_y", "=", "np", ".", "reshape", "(", "test_y", ",", "[", "test_y", ".", "shape", "[", "0", "]", "]", ")", ".", "astype", "(", "'float32'", ")", "\n", "\n", "val_x", "=", "test_x", "[", ":", "3000", ",", ":", ",", ":", ",", ":", "]", "\n", "val_y", "=", "test_y", "[", ":", "3000", "]", "\n", "\n", "test_x", "=", "test_x", "[", ":", "3000", ",", ":", ",", ":", ",", ":", "]", "\n", "test_y", "=", "test_y", "[", ":", "3000", "]", "\n", "\n", "train_win_x", "=", "train_win_x", ".", "astype", "(", "'float32'", ")", "\n", "test_win_x", "=", "test_win_x", "[", "500", ":", ",", ":", ",", ":", ",", ":", "]", ".", "astype", "(", "'float32'", ")", "\n", "test_win_y", "=", "test_win_y", "[", "500", ":", "]", "\n", "val_win_x", "=", "test_win_x", "[", ":", "500", ",", ":", ",", ":", ",", ":", "]", ".", "astype", "(", "'float32'", ")", "\n", "val_win_y", "=", "test_win_y", "[", ":", "500", "]", "\n", "\n", "self", ".", "X_val", "=", "val_win_x", "\n", "self", ".", "y_val", "=", "val_win_y", "\n", "\n", "\n", "print", "(", "\"train_x shape\"", ")", "\n", "print", "(", "train_x", ".", "shape", ")", "\n", "print", "(", "\"val_x shape\"", ")", "\n", "print", "(", "val_x", ".", "shape", ")", "\n", "print", "(", "\"test_x shape\"", ")", "\n", "print", "(", "test_x", ".", "shape", ")", "\n", "if", "setname", "==", "'train'", ":", "\n", "            ", "self", ".", "data", "=", "np", ".", "concatenate", "(", "(", "val_x", ",", "train_x", ")", ",", "axis", "=", "0", ")", "\n", "self", ".", "label", "=", "np", ".", "concatenate", "(", "(", "val_y", ",", "train_y", ")", ",", "axis", "=", "0", ")", "\n", "#elif setname == 'val':", "\n", "#    self.data = val_x", "\n", "#    self.label=val_y", "\n", "", "elif", "setname", "==", "'test'", ":", "\n", "            ", "self", ".", "data", "=", "test_x", "\n", "self", ".", "label", "=", "test_y", "\n", "\n", "", "self", ".", "label", "=", "self", ".", "label", ".", "astype", "(", "int", ")", "\n", "self", ".", "num_class", "=", "4", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.dataset_loader_BCI_IV_i.DatasetLoader_BCI_IV_subjects.__len__": [[108, 110], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "data", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.dataset_loader_BCI_IV_i.DatasetLoader_BCI_IV_subjects.__getitem__": [[111, 114], ["None"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "i", ")", ":", "\n", "        ", "data", ",", "label", "=", "self", ".", "data", "[", "i", "]", ",", "self", ".", "label", "[", "i", "]", "\n", "return", "data", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.data_preprocessing_intra_subject.data_gen": [[13, 80], ["range", "tuple", "tuple", "numpy.concatenate", "numpy.concatenate", "len", "numpy.zeros", "numpy.zeros", "scipy.loadmat", "scipy.loadmat", "range", "np.concatenate.append", "np.concatenate.append", "range", "np.concatenate.append", "np.concatenate.append", "range", "range", "str", "str", "numpy.transpose", "int", "numpy.transpose", "int", "int", "int", "int", "int"], "function", ["None"], ["def", "data_gen", "(", "subject_list", ")", ":", "\n", "\n", "    ", "PATH", "=", "'../data/'", "\n", "NO_channels", "=", "22", "\n", "NO_tests", "=", "6", "*", "48", "\n", "Window_Length", "=", "7", "*", "250", "\n", "\n", "data", "=", "[", "]", "\n", "label", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "subject_list", ")", ")", ":", "\n", "        ", "subject", "=", "subject_list", "[", "i", "]", "\n", "class_return", "=", "np", ".", "zeros", "(", "NO_tests", ")", "\n", "data_return", "=", "np", ".", "zeros", "(", "(", "NO_tests", ",", "NO_channels", ",", "Window_Length", ")", ")", "\n", "\n", "NO_valid_trial", "=", "0", "\n", "\n", "a", "=", "sio", ".", "loadmat", "(", "PATH", "+", "'A0'", "+", "str", "(", "subject", ")", "+", "'E.mat'", ")", "\n", "b", "=", "sio", ".", "loadmat", "(", "PATH", "+", "'A0'", "+", "str", "(", "subject", ")", "+", "'T.mat'", ")", "\n", "a_data", "=", "a", "[", "'data'", "]", "\n", "for", "ii", "in", "range", "(", "0", ",", "a_data", ".", "size", ")", ":", "\n", "            ", "a_data1", "=", "a_data", "[", "0", ",", "ii", "]", "\n", "a_data2", "=", "[", "a_data1", "[", "0", ",", "0", "]", "]", "\n", "a_data3", "=", "a_data2", "[", "0", "]", "\n", "a_X", "=", "a_data3", "[", "0", "]", "\n", "a_trial", "=", "a_data3", "[", "1", "]", "\n", "a_y", "=", "a_data3", "[", "2", "]", "\n", "a_fs", "=", "a_data3", "[", "3", "]", "\n", "a_classes", "=", "a_data3", "[", "4", "]", "\n", "a_artifacts", "=", "a_data3", "[", "5", "]", "\n", "a_gender", "=", "a_data3", "[", "6", "]", "\n", "a_age", "=", "a_data3", "[", "7", "]", "\n", "for", "trial", "in", "range", "(", "0", ",", "a_trial", ".", "size", ")", ":", "\n", "                ", "if", "(", "a_artifacts", "[", "trial", "]", "==", "0", ")", ":", "\n", "                    ", "data_return", "[", "NO_valid_trial", ",", ":", ",", ":", "]", "=", "np", ".", "transpose", "(", "a_X", "[", "int", "(", "a_trial", "[", "trial", "]", ")", ":", "(", "int", "(", "a_trial", "[", "trial", "]", ")", "+", "Window_Length", ")", ",", ":", "22", "]", ")", "\n", "class_return", "[", "NO_valid_trial", "]", "=", "int", "(", "a_y", "[", "trial", "]", ")", "\n", "NO_valid_trial", "+=", "1", "\n", "", "", "", "data", ".", "append", "(", "data_return", "[", "0", ":", "NO_valid_trial", ",", ":", ",", ":", "]", ")", "\n", "label", ".", "append", "(", "class_return", "[", "0", ":", "NO_valid_trial", "]", ")", "\n", "\n", "NO_valid_trial", "=", "0", "\n", "b_data", "=", "b", "[", "'data'", "]", "\n", "for", "ii", "in", "range", "(", "0", ",", "b_data", ".", "size", ")", ":", "\n", "            ", "b_data1", "=", "b_data", "[", "0", ",", "ii", "]", "\n", "b_data2", "=", "[", "b_data1", "[", "0", ",", "0", "]", "]", "\n", "b_data3", "=", "b_data2", "[", "0", "]", "\n", "b_X", "=", "b_data3", "[", "0", "]", "\n", "b_trial", "=", "b_data3", "[", "1", "]", "\n", "b_y", "=", "b_data3", "[", "2", "]", "\n", "b_fs", "=", "b_data3", "[", "3", "]", "\n", "b_classes", "=", "b_data3", "[", "4", "]", "\n", "b_artifacts", "=", "b_data3", "[", "5", "]", "\n", "b_gender", "=", "b_data3", "[", "6", "]", "\n", "b_age", "=", "b_data3", "[", "7", "]", "\n", "for", "trial", "in", "range", "(", "0", ",", "b_trial", ".", "size", ")", ":", "\n", "                ", "if", "(", "b_artifacts", "[", "trial", "]", "==", "0", ")", ":", "\n", "                    ", "data_return", "[", "NO_valid_trial", ",", ":", ",", ":", "]", "=", "np", ".", "transpose", "(", "b_X", "[", "int", "(", "b_trial", "[", "trial", "]", ")", ":", "(", "int", "(", "b_trial", "[", "trial", "]", ")", "+", "Window_Length", ")", ",", ":", "22", "]", ")", "\n", "class_return", "[", "NO_valid_trial", "]", "=", "int", "(", "b_y", "[", "trial", "]", ")", "\n", "NO_valid_trial", "+=", "1", "\n", "", "", "", "data", ".", "append", "(", "data_return", "[", "0", ":", "NO_valid_trial", ",", ":", ",", ":", "]", ")", "\n", "label", ".", "append", "(", "class_return", "[", "0", ":", "NO_valid_trial", "]", ")", "\n", "#print(data_return.shape)", "\n", "", "data", "=", "tuple", "(", "data", ")", "\n", "label", "=", "tuple", "(", "label", ")", "\n", "data", "=", "np", ".", "concatenate", "(", "data", ",", "axis", "=", "0", ")", "\n", "label", "=", "np", ".", "concatenate", "(", "label", ",", "axis", "=", "0", ")", "\n", "\n", "return", "data", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.data_preprocessing_intra_subject.data_gen_train": [[84, 128], ["range", "tuple", "tuple", "numpy.concatenate", "numpy.concatenate", "len", "numpy.zeros", "numpy.zeros", "scipy.loadmat", "range", "np.concatenate.append", "np.concatenate.append", "range", "str", "numpy.transpose", "int", "int", "int"], "function", ["None"], ["", "def", "data_gen_train", "(", "subject_list", ")", ":", "\n", "\n", "    ", "PATH", "=", "'../data/'", "\n", "NO_channels", "=", "22", "\n", "NO_tests", "=", "6", "*", "48", "\n", "Window_Length", "=", "7", "*", "250", "\n", "\n", "data", "=", "[", "]", "\n", "label", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "subject_list", ")", ")", ":", "\n", "        ", "subject", "=", "subject_list", "[", "i", "]", "\n", "class_return", "=", "np", ".", "zeros", "(", "NO_tests", ")", "\n", "data_return", "=", "np", ".", "zeros", "(", "(", "NO_tests", ",", "NO_channels", ",", "Window_Length", ")", ")", "\n", "\n", "NO_valid_trial", "=", "0", "\n", "\n", "a", "=", "sio", ".", "loadmat", "(", "PATH", "+", "'A0'", "+", "str", "(", "subject", ")", "+", "'T.mat'", ")", "\n", "a_data", "=", "a", "[", "'data'", "]", "\n", "for", "ii", "in", "range", "(", "0", ",", "a_data", ".", "size", ")", ":", "\n", "            ", "a_data1", "=", "a_data", "[", "0", ",", "ii", "]", "\n", "a_data2", "=", "[", "a_data1", "[", "0", ",", "0", "]", "]", "\n", "a_data3", "=", "a_data2", "[", "0", "]", "\n", "a_X", "=", "a_data3", "[", "0", "]", "\n", "a_trial", "=", "a_data3", "[", "1", "]", "\n", "a_y", "=", "a_data3", "[", "2", "]", "\n", "a_fs", "=", "a_data3", "[", "3", "]", "\n", "a_classes", "=", "a_data3", "[", "4", "]", "\n", "a_artifacts", "=", "a_data3", "[", "5", "]", "\n", "a_gender", "=", "a_data3", "[", "6", "]", "\n", "a_age", "=", "a_data3", "[", "7", "]", "\n", "for", "trial", "in", "range", "(", "0", ",", "a_trial", ".", "size", ")", ":", "\n", "                ", "if", "(", "a_artifacts", "[", "trial", "]", "==", "0", ")", ":", "\n", "                    ", "data_return", "[", "NO_valid_trial", ",", ":", ",", ":", "]", "=", "np", ".", "transpose", "(", "a_X", "[", "int", "(", "a_trial", "[", "trial", "]", ")", ":", "(", "int", "(", "a_trial", "[", "trial", "]", ")", "+", "Window_Length", ")", ",", ":", "22", "]", ")", "\n", "class_return", "[", "NO_valid_trial", "]", "=", "int", "(", "a_y", "[", "trial", "]", ")", "\n", "NO_valid_trial", "+=", "1", "\n", "", "", "", "data", ".", "append", "(", "data_return", "[", "0", ":", "NO_valid_trial", ",", ":", ",", ":", "]", ")", "\n", "label", ".", "append", "(", "class_return", "[", "0", ":", "NO_valid_trial", "]", ")", "\n", "\n", "", "data", "=", "tuple", "(", "data", ")", "\n", "label", "=", "tuple", "(", "label", ")", "\n", "data", "=", "np", ".", "concatenate", "(", "data", ",", "axis", "=", "0", ")", "\n", "label", "=", "np", ".", "concatenate", "(", "label", ",", "axis", "=", "0", ")", "\n", "\n", "return", "data", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.data_preprocessing_intra_subject.data_gen_eval": [[132, 176], ["range", "tuple", "tuple", "numpy.concatenate", "numpy.concatenate", "len", "numpy.zeros", "numpy.zeros", "scipy.loadmat", "range", "np.concatenate.append", "np.concatenate.append", "range", "str", "numpy.transpose", "int", "int", "int"], "function", ["None"], ["", "def", "data_gen_eval", "(", "subject_list", ")", ":", "\n", "\n", "    ", "PATH", "=", "'../data/'", "\n", "NO_channels", "=", "22", "\n", "NO_tests", "=", "6", "*", "48", "\n", "Window_Length", "=", "7", "*", "250", "\n", "\n", "data", "=", "[", "]", "\n", "label", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "subject_list", ")", ")", ":", "\n", "        ", "subject", "=", "subject_list", "[", "i", "]", "\n", "class_return", "=", "np", ".", "zeros", "(", "NO_tests", ")", "\n", "data_return", "=", "np", ".", "zeros", "(", "(", "NO_tests", ",", "NO_channels", ",", "Window_Length", ")", ")", "\n", "\n", "NO_valid_trial", "=", "0", "\n", "\n", "a", "=", "sio", ".", "loadmat", "(", "PATH", "+", "'A0'", "+", "str", "(", "subject", ")", "+", "'E.mat'", ")", "\n", "a_data", "=", "a", "[", "'data'", "]", "\n", "for", "ii", "in", "range", "(", "0", ",", "a_data", ".", "size", ")", ":", "\n", "            ", "a_data1", "=", "a_data", "[", "0", ",", "ii", "]", "\n", "a_data2", "=", "[", "a_data1", "[", "0", ",", "0", "]", "]", "\n", "a_data3", "=", "a_data2", "[", "0", "]", "\n", "a_X", "=", "a_data3", "[", "0", "]", "\n", "a_trial", "=", "a_data3", "[", "1", "]", "\n", "a_y", "=", "a_data3", "[", "2", "]", "\n", "a_fs", "=", "a_data3", "[", "3", "]", "\n", "a_classes", "=", "a_data3", "[", "4", "]", "\n", "a_artifacts", "=", "a_data3", "[", "5", "]", "\n", "a_gender", "=", "a_data3", "[", "6", "]", "\n", "a_age", "=", "a_data3", "[", "7", "]", "\n", "for", "trial", "in", "range", "(", "0", ",", "a_trial", ".", "size", ")", ":", "\n", "                ", "if", "(", "a_artifacts", "[", "trial", "]", "==", "0", ")", ":", "\n", "                    ", "data_return", "[", "NO_valid_trial", ",", ":", ",", ":", "]", "=", "np", ".", "transpose", "(", "a_X", "[", "int", "(", "a_trial", "[", "trial", "]", ")", ":", "(", "int", "(", "a_trial", "[", "trial", "]", ")", "+", "Window_Length", ")", ",", ":", "22", "]", ")", "\n", "class_return", "[", "NO_valid_trial", "]", "=", "int", "(", "a_y", "[", "trial", "]", ")", "\n", "NO_valid_trial", "+=", "1", "\n", "", "", "", "data", ".", "append", "(", "data_return", "[", "0", ":", "NO_valid_trial", ",", ":", ",", ":", "]", ")", "\n", "label", ".", "append", "(", "class_return", "[", "0", ":", "NO_valid_trial", "]", ")", "\n", "\n", "", "data", "=", "tuple", "(", "data", ")", "\n", "label", "=", "tuple", "(", "label", ")", "\n", "data", "=", "np", ".", "concatenate", "(", "data", ",", "axis", "=", "0", ")", "\n", "label", "=", "np", ".", "concatenate", "(", "label", ",", "axis", "=", "0", ")", "\n", "\n", "return", "data", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.dataloader.data_preprocessing_cross_subject.data_gen": [[13, 80], ["range", "tuple", "tuple", "numpy.concatenate", "numpy.concatenate", "len", "numpy.zeros", "numpy.zeros", "scipy.loadmat", "scipy.loadmat", "range", "range", "range", "np.concatenate.append", "np.concatenate.append", "range", "np.concatenate.append", "np.concatenate.append", "str", "str", "numpy.transpose", "int", "numpy.transpose", "int", "int", "int", "int", "int"], "function", ["None"], ["def", "data_gen", "(", "subject_list", ")", ":", "\n", "\n", "    ", "PATH", "=", "'../data/'", "\n", "NO_channels", "=", "22", "\n", "NO_tests", "=", "6", "*", "48", "\n", "Window_Length", "=", "7", "*", "250", "\n", "\n", "data", "=", "[", "]", "\n", "label", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "len", "(", "subject_list", ")", ")", ":", "\n", "        ", "subject", "=", "subject_list", "[", "i", "]", "\n", "class_return", "=", "np", ".", "zeros", "(", "NO_tests", ")", "\n", "data_return", "=", "np", ".", "zeros", "(", "(", "NO_tests", ",", "NO_channels", ",", "Window_Length", ")", ")", "\n", "\n", "NO_valid_trial", "=", "0", "\n", "\n", "a", "=", "sio", ".", "loadmat", "(", "PATH", "+", "'A0'", "+", "str", "(", "subject", ")", "+", "'T.mat'", ")", "\n", "b", "=", "sio", ".", "loadmat", "(", "PATH", "+", "'A0'", "+", "str", "(", "subject", ")", "+", "'E.mat'", ")", "\n", "a_data", "=", "a", "[", "'data'", "]", "\n", "for", "ii", "in", "range", "(", "0", ",", "a_data", ".", "size", ")", ":", "\n", "            ", "a_data1", "=", "a_data", "[", "0", ",", "ii", "]", "\n", "a_data2", "=", "[", "a_data1", "[", "0", ",", "0", "]", "]", "\n", "a_data3", "=", "a_data2", "[", "0", "]", "\n", "a_X", "=", "a_data3", "[", "0", "]", "\n", "a_trial", "=", "a_data3", "[", "1", "]", "\n", "a_y", "=", "a_data3", "[", "2", "]", "\n", "a_fs", "=", "a_data3", "[", "3", "]", "\n", "a_classes", "=", "a_data3", "[", "4", "]", "\n", "a_artifacts", "=", "a_data3", "[", "5", "]", "\n", "a_gender", "=", "a_data3", "[", "6", "]", "\n", "a_age", "=", "a_data3", "[", "7", "]", "\n", "for", "trial", "in", "range", "(", "0", ",", "a_trial", ".", "size", ")", ":", "\n", "                ", "if", "(", "a_artifacts", "[", "trial", "]", "==", "0", ")", ":", "\n", "                    ", "data_return", "[", "NO_valid_trial", ",", ":", ",", ":", "]", "=", "np", ".", "transpose", "(", "a_X", "[", "int", "(", "a_trial", "[", "trial", "]", ")", ":", "(", "int", "(", "a_trial", "[", "trial", "]", ")", "+", "Window_Length", ")", ",", ":", "22", "]", ")", "\n", "class_return", "[", "NO_valid_trial", "]", "=", "int", "(", "a_y", "[", "trial", "]", ")", "\n", "NO_valid_trial", "+=", "1", "\n", "", "", "data", ".", "append", "(", "data_return", "[", "0", ":", "NO_valid_trial", ",", ":", ",", ":", "]", ")", "\n", "label", ".", "append", "(", "class_return", "[", "0", ":", "NO_valid_trial", "]", ")", "\n", "\n", "", "NO_valid_trial", "=", "0", "\n", "b_data", "=", "b", "[", "'data'", "]", "\n", "for", "ii", "in", "range", "(", "0", ",", "b_data", ".", "size", ")", ":", "\n", "            ", "b_data1", "=", "b_data", "[", "0", ",", "ii", "]", "\n", "b_data2", "=", "[", "b_data1", "[", "0", ",", "0", "]", "]", "\n", "b_data3", "=", "b_data2", "[", "0", "]", "\n", "b_X", "=", "b_data3", "[", "0", "]", "\n", "b_trial", "=", "b_data3", "[", "1", "]", "\n", "b_y", "=", "b_data3", "[", "2", "]", "\n", "b_fs", "=", "b_data3", "[", "3", "]", "\n", "b_classes", "=", "b_data3", "[", "4", "]", "\n", "b_artifacts", "=", "b_data3", "[", "5", "]", "\n", "b_gender", "=", "b_data3", "[", "6", "]", "\n", "b_age", "=", "b_data3", "[", "7", "]", "\n", "for", "trial", "in", "range", "(", "0", ",", "b_trial", ".", "size", ")", ":", "\n", "                ", "if", "(", "b_artifacts", "[", "trial", "]", "==", "0", ")", ":", "\n", "                    ", "data_return", "[", "NO_valid_trial", ",", ":", ",", ":", "]", "=", "np", ".", "transpose", "(", "b_X", "[", "int", "(", "b_trial", "[", "trial", "]", ")", ":", "(", "int", "(", "b_trial", "[", "trial", "]", ")", "+", "Window_Length", ")", ",", ":", "22", "]", ")", "\n", "class_return", "[", "NO_valid_trial", "]", "=", "int", "(", "b_y", "[", "trial", "]", ")", "\n", "NO_valid_trial", "+=", "1", "\n", "", "", "data", ".", "append", "(", "data_return", "[", "0", ":", "NO_valid_trial", ",", ":", ",", ":", "]", ")", "\n", "label", ".", "append", "(", "class_return", "[", "0", ":", "NO_valid_trial", "]", ")", "\n", "#print(data_return.shape)", "\n", "", "", "data", "=", "tuple", "(", "data", ")", "\n", "label", "=", "tuple", "(", "label", ")", "\n", "data", "=", "np", ".", "concatenate", "(", "data", ",", "axis", "=", "0", ")", "\n", "label", "=", "np", ".", "concatenate", "(", "label", ",", "axis", "=", "0", ")", "\n", "\n", "return", "data", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.AvgPool2d.__init__": [[22, 25], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "AvgPool2d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.AvgPool2d.forward": [[26, 39], ["torch.nn.functional.avg_pool2d", "torch.nn.functional.avg_pool2d", "torch.nn.functional.avg_pool2d", "torch.nn.functional.avg_pool2d", "adf.AvgPool2d._keep_variance_fn", "inputs_mean.size", "inputs_mean.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ",", "kernel_size", ")", ":", "\n", "        ", "outputs_mean", "=", "F", ".", "avg_pool2d", "(", "inputs_mean", ",", "kernel_size", ")", "\n", "outputs_variance", "=", "F", ".", "avg_pool2d", "(", "inputs_variance", ",", "kernel_size", ")", "\n", "outputs_variance", "=", "outputs_variance", "/", "(", "inputs_mean", ".", "size", "(", "2", ")", "*", "inputs_mean", ".", "size", "(", "3", ")", ")", "\n", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "\n", "# TODO: avg pooling means that every neuron is multiplied by the same ", "\n", "#       weight, that is 1/number of neurons in the channel ", "\n", "#      outputs_variance*1/(H*W) should be enough already", "\n", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Softmax.__init__": [[42, 46], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "dim", "=", "1", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "Softmax", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "dim", "=", "dim", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Softmax.forward": [[47, 70], ["torch.exp", "torch.exp", "torch.exp", "torch.exp", "torch.exp", "torch.exp", "torch.exp", "torch.exp", "constant.unsqueeze.unsqueeze.unsqueeze", "torch.sum", "torch.sum", "torch.sum", "torch.sum", "adf.Softmax._keep_variance_fn", "torch.exp", "torch.exp", "torch.exp", "torch.exp"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "features_mean", ",", "features_variance", ",", "eps", "=", "1e-5", ")", ":", "\n", "        ", "\"\"\"Softmax function applied to a multivariate Gaussian distribution.\n        It works under the assumption that features_mean and features_variance \n        are the parameters of a the indepent gaussians that contribute to the \n        multivariate gaussian. \n        Mean and variance of the log-normal distribution are computed following\n        https://en.wikipedia.org/wiki/Log-normal_distribution.\"\"\"", "\n", "\n", "log_gaussian_mean", "=", "features_mean", "+", "0.5", "*", "features_variance", "\n", "log_gaussian_variance", "=", "2", "*", "log_gaussian_mean", "\n", "\n", "log_gaussian_mean", "=", "torch", ".", "exp", "(", "log_gaussian_mean", ")", "\n", "log_gaussian_variance", "=", "torch", ".", "exp", "(", "log_gaussian_variance", ")", "\n", "log_gaussian_variance", "=", "log_gaussian_variance", "*", "(", "torch", ".", "exp", "(", "features_variance", ")", "-", "1", ")", "\n", "\n", "constant", "=", "torch", ".", "sum", "(", "log_gaussian_mean", ",", "dim", "=", "self", ".", "dim", ")", "+", "eps", "\n", "constant", "=", "constant", ".", "unsqueeze", "(", "self", ".", "dim", ")", "\n", "outputs_mean", "=", "log_gaussian_mean", "/", "constant", "\n", "outputs_variance", "=", "log_gaussian_variance", "/", "(", "constant", "**", "2", ")", "\n", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.permute.__init__": [[73, 76], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "order", ")", ":", "\n", "        ", "super", "(", "permute", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "order", "=", "order", "\n", "", "def", "forward", "(", "self", ",", "features_mean", ",", "features_variance", ")", ":", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.permute.forward": [[76, 80], ["features_mean.permute.permute.permute", "features_variance.permute.permute.permute"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "features_mean", ",", "features_variance", ")", ":", "\n", "        ", "features_mean", "=", "features_mean", ".", "permute", "(", "*", "self", ".", "order", ")", "\n", "features_variance", "=", "features_variance", ".", "permute", "(", "*", "self", ".", "order", ")", "\n", "return", "features_mean", ",", "features_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.ReLU.__init__": [[83, 86], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "ReLU", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.ReLU.forward": [[87, 98], ["torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "contrib.math.normpdf", "contrib.math.normcdf", "adf.ReLU._keep_variance_fn"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normpdf", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normcdf"], ["", "def", "forward", "(", "self", ",", "features_mean", ",", "features_variance", ")", ":", "\n", "        ", "features_stddev", "=", "torch", ".", "sqrt", "(", "features_variance", ")", "\n", "div", "=", "features_mean", "/", "features_stddev", "\n", "pdf", "=", "normpdf", "(", "div", ")", "\n", "cdf", "=", "normcdf", "(", "div", ")", "\n", "outputs_mean", "=", "features_mean", "*", "cdf", "+", "features_stddev", "*", "pdf", "\n", "outputs_variance", "=", "(", "features_mean", "**", "2", "+", "features_variance", ")", "*", "cdf", "+", "features_mean", "*", "features_stddev", "*", "pdf", "-", "outputs_mean", "**", "2", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.LeakyReLU.__init__": [[101, 105], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "negative_slope", "=", "0.01", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "LeakyReLU", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "self", ".", "_negative_slope", "=", "negative_slope", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.LeakyReLU.forward": [[106, 128], ["torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "contrib.math.normpdf", "contrib.math.normcdf", "adf.LeakyReLU._keep_variance_fn"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normpdf", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normcdf"], ["", "def", "forward", "(", "self", ",", "features_mean", ",", "features_variance", ")", ":", "\n", "        ", "features_stddev", "=", "torch", ".", "sqrt", "(", "features_variance", ")", "\n", "div", "=", "features_mean", "/", "features_stddev", "\n", "pdf", "=", "normpdf", "(", "div", ")", "\n", "cdf", "=", "normcdf", "(", "div", ")", "\n", "negative_cdf", "=", "1.0", "-", "cdf", "\n", "mu_cdf", "=", "features_mean", "*", "cdf", "\n", "stddev_pdf", "=", "features_stddev", "*", "pdf", "\n", "squared_mean_variance", "=", "features_mean", "**", "2", "+", "features_variance", "\n", "mean_stddev_pdf", "=", "features_mean", "*", "stddev_pdf", "\n", "mean_r", "=", "mu_cdf", "+", "stddev_pdf", "\n", "variance_r", "=", "squared_mean_variance", "*", "cdf", "+", "mean_stddev_pdf", "-", "mean_r", "**", "2", "\n", "mean_n", "=", "-", "features_mean", "*", "negative_cdf", "+", "stddev_pdf", "\n", "variance_n", "=", "squared_mean_variance", "*", "negative_cdf", "-", "mean_stddev_pdf", "-", "mean_n", "**", "2", "\n", "covxy", "=", "-", "mean_r", "*", "mean_n", "\n", "outputs_mean", "=", "mean_r", "-", "self", ".", "_negative_slope", "*", "mean_n", "\n", "outputs_variance", "=", "variance_r", "+", "self", ".", "_negative_slope", "*", "self", ".", "_negative_slope", "*", "variance_n", "-", "2.0", "*", "self", ".", "_negative_slope", "*", "covxy", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Dropout.__init__": [[132, 139], ["torch.Module.__init__", "ValueError"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["def", "__init__", "(", "self", ",", "p", ":", "float", "=", "0.5", ",", "keep_variance_fn", "=", "None", ",", "inplace", "=", "False", ")", ":", "\n", "        ", "super", "(", "Dropout", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "self", ".", "inplace", "=", "inplace", "\n", "if", "p", "<", "0", "or", "p", ">", "1", ":", "\n", "            ", "raise", "ValueError", "(", "\"dropout probability has to be between 0 and 1, \"", "\"but got {}\"", ".", "format", "(", "p", ")", ")", "\n", "", "self", ".", "p", "=", "p", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Dropout.forward": [[140, 156], ["torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.ones_like", "torch.nn.functional.dropout2d", "torch.nn.functional.dropout2d", "adf.Dropout._keep_variance_fn", "adf.Dropout._keep_variance_fn"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "if", "self", ".", "training", ":", "\n", "            ", "binary_mask", "=", "torch", ".", "ones_like", "(", "inputs_mean", ")", "\n", "binary_mask", "=", "F", ".", "dropout2d", "(", "binary_mask", ",", "self", ".", "p", ",", "self", ".", "training", ",", "self", ".", "inplace", ")", "\n", "\n", "outputs_mean", "=", "inputs_mean", "*", "binary_mask", "\n", "outputs_variance", "=", "inputs_variance", "*", "binary_mask", "**", "2", "\n", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "                ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n", "", "outputs_variance", "=", "inputs_variance", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "inputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.ZeroPad2d.__init__": [[159, 164], ["torch.Module.__init__", "torch.ZeroPad2d", "torch.ZeroPad2d"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "tup", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "ZeroPad2d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "tup", "=", "tup", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "self", ".", "pad2d", "=", "nn", ".", "ZeroPad2d", "(", "self", ".", "tup", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.ZeroPad2d.forward": [[165, 171], ["adf.ZeroPad2d.pad2d", "adf.ZeroPad2d.pad2d", "adf.ZeroPad2d._keep_variance_fn"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "outputs_mean", "=", "self", ".", "pad2d", "(", "inputs_mean", ")", "\n", "outputs_variance", "=", "self", ".", "pad2d", "(", "inputs_variance", ")", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d_2.__init__": [[174, 177], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "MaxPool2d_2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d_2._max_pool_internal": [[178, 191], ["torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "contrib.math.normpdf", "contrib.math.normcdf", "adf.MaxPool2d_2._keep_variance_fn"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normpdf", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normcdf"], ["", "def", "_max_pool_internal", "(", "self", ",", "mu_a", ",", "mu_b", ",", "var_a", ",", "var_b", ")", ":", "\n", "        ", "stddev", "=", "torch", ".", "sqrt", "(", "var_a", "+", "var_b", ")", "\n", "ab", "=", "mu_a", "-", "mu_b", "\n", "alpha", "=", "ab", "/", "stddev", "\n", "pdf", "=", "normpdf", "(", "alpha", ")", "\n", "cdf", "=", "normcdf", "(", "alpha", ")", "\n", "z_mu", "=", "stddev", "*", "pdf", "+", "ab", "*", "cdf", "+", "mu_b", "\n", "z_var", "=", "(", "(", "mu_a", "+", "mu_b", ")", "*", "stddev", "*", "pdf", "+", "\n", "(", "mu_a", "**", "2", "+", "var_a", ")", "*", "cdf", "+", "\n", "(", "mu_b", "**", "2", "+", "var_b", ")", "*", "(", "1.0", "-", "cdf", ")", "-", "z_mu", "**", "2", ")", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "z_var", "=", "self", ".", "_keep_variance_fn", "(", "z_var", ")", "\n", "", "return", "z_mu", ",", "z_var", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d_2._max_pool_1x2": [[192, 204], ["adf.MaxPool2d_2._max_pool_internal"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_internal"], ["", "def", "_max_pool_1x2", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "mu_a", "=", "inputs_mean", "[", ":", ",", ":", ",", ":", ",", "0", ":", ":", "2", "]", "\n", "mu_b", "=", "inputs_mean", "[", ":", ",", ":", ",", ":", ",", "1", ":", ":", "2", "]", "\n", "var_a", "=", "inputs_variance", "[", ":", ",", ":", ",", ":", ",", "0", ":", ":", "2", "]", "\n", "var_b", "=", "inputs_variance", "[", ":", ",", ":", ",", ":", ",", "1", ":", ":", "2", "]", "\n", "if", "mu_a", ".", "shape", "[", "3", "]", "!=", "mu_b", ".", "shape", "[", "3", "]", ":", "\n", "            ", "mu_a", "=", "mu_a", "[", ":", ",", ":", ",", ":", ",", ":", "-", "1", "]", "\n", "var_a", "=", "var_a", "[", ":", ",", ":", ",", ":", ",", ":", "-", "1", "]", "\n", "\n", "", "outputs_mean", ",", "outputs_variance", "=", "self", ".", "_max_pool_internal", "(", "\n", "mu_a", ",", "mu_b", ",", "var_a", ",", "var_b", ")", "\n", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d_2._max_pool_2x1": [[205, 213], ["adf.MaxPool2d_2._max_pool_internal"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_internal"], ["", "def", "_max_pool_2x1", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "mu_a", "=", "inputs_mean", "[", ":", ",", ":", ",", "0", ":", ":", "2", ",", ":", "]", "\n", "mu_b", "=", "inputs_mean", "[", ":", ",", ":", ",", "1", ":", ":", "2", ",", ":", "]", "\n", "var_a", "=", "inputs_variance", "[", ":", ",", ":", ",", "0", ":", ":", "2", ",", ":", "]", "\n", "var_b", "=", "inputs_variance", "[", ":", ",", ":", ",", "1", ":", ":", "2", ",", ":", "]", "\n", "outputs_mean", ",", "outputs_variance", "=", "self", ".", "_max_pool_internal", "(", "\n", "mu_a", ",", "mu_b", ",", "var_a", ",", "var_b", ")", "\n", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d_2.forward": [[214, 219], ["adf.MaxPool2d_2._max_pool_1x2", "adf.MaxPool2d_2._max_pool_2x1", "adf.MaxPool2d_2._max_pool_1x2"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_1x2", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_2x1", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_1x2"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "z_mean", ",", "z_variance", "=", "self", ".", "_max_pool_1x2", "(", "inputs_mean", ",", "inputs_variance", ")", "\n", "outputs_mean", ",", "outputs_variance", "=", "self", ".", "_max_pool_2x1", "(", "z_mean", ",", "z_variance", ")", "\n", "outputs_mean", ",", "outputs_variance", "=", "self", ".", "_max_pool_1x2", "(", "outputs_mean", ",", "outputs_variance", ")", "\n", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d.__init__": [[221, 224], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "MaxPool2d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_internal": [[225, 238], ["torch.sqrt", "torch.sqrt", "torch.sqrt", "torch.sqrt", "contrib.math.normpdf", "contrib.math.normcdf", "adf.MaxPool2d._keep_variance_fn"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normpdf", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normcdf"], ["", "def", "_max_pool_internal", "(", "self", ",", "mu_a", ",", "mu_b", ",", "var_a", ",", "var_b", ")", ":", "\n", "        ", "stddev", "=", "torch", ".", "sqrt", "(", "var_a", "+", "var_b", ")", "\n", "ab", "=", "mu_a", "-", "mu_b", "\n", "alpha", "=", "ab", "/", "stddev", "\n", "pdf", "=", "normpdf", "(", "alpha", ")", "\n", "cdf", "=", "normcdf", "(", "alpha", ")", "\n", "z_mu", "=", "stddev", "*", "pdf", "+", "ab", "*", "cdf", "+", "mu_b", "\n", "z_var", "=", "(", "(", "mu_a", "+", "mu_b", ")", "*", "stddev", "*", "pdf", "+", "\n", "(", "mu_a", "**", "2", "+", "var_a", ")", "*", "cdf", "+", "\n", "(", "mu_b", "**", "2", "+", "var_b", ")", "*", "(", "1.0", "-", "cdf", ")", "-", "z_mu", "**", "2", ")", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "z_var", "=", "self", ".", "_keep_variance_fn", "(", "z_var", ")", "\n", "", "return", "z_mu", ",", "z_var", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_1x2": [[239, 251], ["adf.MaxPool2d._max_pool_internal"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_internal"], ["", "def", "_max_pool_1x2", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "mu_a", "=", "inputs_mean", "[", ":", ",", ":", ",", ":", ",", "0", ":", ":", "2", "]", "\n", "mu_b", "=", "inputs_mean", "[", ":", ",", ":", ",", ":", ",", "1", ":", ":", "2", "]", "\n", "var_a", "=", "inputs_variance", "[", ":", ",", ":", ",", ":", ",", "0", ":", ":", "2", "]", "\n", "var_b", "=", "inputs_variance", "[", ":", ",", ":", ",", ":", ",", "1", ":", ":", "2", "]", "\n", "if", "mu_a", ".", "shape", "[", "3", "]", "!=", "mu_b", ".", "shape", "[", "3", "]", ":", "\n", "            ", "mu_a", "=", "mu_a", "[", ":", ",", ":", ",", ":", ",", ":", "-", "1", "]", "\n", "var_a", "=", "var_a", "[", ":", ",", ":", ",", ":", ",", ":", "-", "1", "]", "\n", "\n", "", "outputs_mean", ",", "outputs_variance", "=", "self", ".", "_max_pool_internal", "(", "\n", "mu_a", ",", "mu_b", ",", "var_a", ",", "var_b", ")", "\n", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_2x1": [[252, 260], ["adf.MaxPool2d._max_pool_internal"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_internal"], ["", "def", "_max_pool_2x1", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "mu_a", "=", "inputs_mean", "[", ":", ",", ":", ",", "0", ":", ":", "2", ",", ":", "]", "\n", "mu_b", "=", "inputs_mean", "[", ":", ",", ":", ",", "1", ":", ":", "2", ",", ":", "]", "\n", "var_a", "=", "inputs_variance", "[", ":", ",", ":", ",", "0", ":", ":", "2", ",", ":", "]", "\n", "var_b", "=", "inputs_variance", "[", ":", ",", ":", ",", "1", ":", ":", "2", ",", ":", "]", "\n", "outputs_mean", ",", "outputs_variance", "=", "self", ".", "_max_pool_internal", "(", "\n", "mu_a", ",", "mu_b", ",", "var_a", ",", "var_b", ")", "\n", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d.forward": [[261, 265], ["adf.MaxPool2d._max_pool_1x2", "adf.MaxPool2d._max_pool_2x1"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_1x2", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.MaxPool2d._max_pool_2x1"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "z_mean", ",", "z_variance", "=", "self", ".", "_max_pool_1x2", "(", "inputs_mean", ",", "inputs_variance", ")", "\n", "outputs_mean", ",", "outputs_variance", "=", "self", ".", "_max_pool_2x1", "(", "z_mean", ",", "z_variance", ")", "\n", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Linear.__init__": [[269, 279], ["torch.Module.__init__", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "adf.Linear.register_parameter", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_features", ",", "out_features", ",", "bias", "=", "True", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "Linear", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "self", ".", "in_features", "=", "in_features", "\n", "self", ".", "out_features", "=", "out_features", "\n", "self", ".", "weight", "=", "Parameter", "(", "torch", ".", "Tensor", "(", "out_features", ",", "in_features", ")", ")", "\n", "if", "bias", ":", "\n", "            ", "self", ".", "bias", "=", "Parameter", "(", "torch", ".", "Tensor", "(", "out_features", ")", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "register_parameter", "(", "'bias'", ",", "None", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Linear.forward": [[280, 286], ["torch.nn.functional.linear", "torch.nn.functional.linear", "torch.nn.functional.linear", "torch.nn.functional.linear", "adf.Linear._keep_variance_fn"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "outputs_mean", "=", "F", ".", "linear", "(", "inputs_mean", ",", "self", ".", "weight", ",", "self", ".", "bias", ")", "\n", "outputs_variance", "=", "F", ".", "linear", "(", "inputs_variance", ",", "self", ".", "weight", "**", "2", ",", "None", ")", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.BatchNorm2d.__init__": [[292, 316], ["torch.Module.__init__", "adf.BatchNorm2d.reset_parameters", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "torch.nn.parameter.Parameter", "adf.BatchNorm2d.register_parameter", "adf.BatchNorm2d.register_parameter", "adf.BatchNorm2d.register_buffer", "adf.BatchNorm2d.register_buffer", "adf.BatchNorm2d.register_buffer", "adf.BatchNorm2d.register_parameter", "adf.BatchNorm2d.register_parameter", "adf.BatchNorm2d.register_parameter", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.ones", "torch.ones", "torch.ones", "torch.ones", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.BatchNorm2d.reset_parameters"], ["def", "__init__", "(", "self", ",", "num_features", ",", "eps", "=", "1e-5", ",", "momentum", "=", "0.1", ",", "affine", "=", "True", ",", "\n", "track_running_stats", "=", "True", ",", "keep_variance_fn", "=", "None", ")", ":", "\n", "        ", "super", "(", "BatchNorm2d", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "self", ".", "num_features", "=", "num_features", "\n", "self", ".", "eps", "=", "eps", "\n", "self", ".", "momentum", "=", "momentum", "\n", "self", ".", "affine", "=", "affine", "\n", "self", ".", "track_running_stats", "=", "track_running_stats", "\n", "if", "self", ".", "affine", ":", "\n", "            ", "self", ".", "weight", "=", "Parameter", "(", "torch", ".", "Tensor", "(", "num_features", ")", ")", "\n", "self", ".", "bias", "=", "Parameter", "(", "torch", ".", "Tensor", "(", "num_features", ")", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "register_parameter", "(", "'weight'", ",", "None", ")", "\n", "self", ".", "register_parameter", "(", "'bias'", ",", "None", ")", "\n", "", "if", "self", ".", "track_running_stats", ":", "\n", "            ", "self", ".", "register_buffer", "(", "'running_mean'", ",", "torch", ".", "zeros", "(", "num_features", ")", ")", "\n", "self", ".", "register_buffer", "(", "'running_var'", ",", "torch", ".", "ones", "(", "num_features", ")", ")", "\n", "self", ".", "register_buffer", "(", "'num_batches_tracked'", ",", "torch", ".", "tensor", "(", "0", ",", "dtype", "=", "torch", ".", "long", ")", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "register_parameter", "(", "'running_mean'", ",", "None", ")", "\n", "self", ".", "register_parameter", "(", "'running_var'", ",", "None", ")", "\n", "self", ".", "register_parameter", "(", "'num_batches_tracked'", ",", "None", ")", "\n", "", "self", ".", "reset_parameters", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.BatchNorm2d.reset_running_stats": [[317, 322], ["adf.BatchNorm2d.running_mean.zero_", "adf.BatchNorm2d.running_var.fill_", "adf.BatchNorm2d.num_batches_tracked.zero_"], "methods", ["None"], ["", "def", "reset_running_stats", "(", "self", ")", ":", "\n", "        ", "if", "self", ".", "track_running_stats", ":", "\n", "            ", "self", ".", "running_mean", ".", "zero_", "(", ")", "\n", "self", ".", "running_var", ".", "fill_", "(", "1", ")", "\n", "self", ".", "num_batches_tracked", ".", "zero_", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.BatchNorm2d.reset_parameters": [[323, 328], ["adf.BatchNorm2d.reset_running_stats", "torch.init.uniform_", "torch.init.uniform_", "torch.init.zeros_", "torch.init.zeros_"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.BatchNorm2d.reset_running_stats"], ["", "", "def", "reset_parameters", "(", "self", ")", ":", "\n", "        ", "self", ".", "reset_running_stats", "(", ")", "\n", "if", "self", ".", "affine", ":", "\n", "            ", "nn", ".", "init", ".", "uniform_", "(", "self", ".", "weight", ")", "\n", "nn", ".", "init", ".", "zeros_", "(", "self", ".", "bias", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.BatchNorm2d._check_input_dim": [[329, 331], ["None"], "methods", ["None"], ["", "", "def", "_check_input_dim", "(", "self", ",", "input", ")", ":", "\n", "        ", "raise", "NotImplementedError", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.BatchNorm2d.forward": [[332, 364], ["torch.nn.functional.batch_norm", "torch.nn.functional.batch_norm", "adf.BatchNorm2d.weight.unsqueeze().unsqueeze().unsqueeze", "adf.BatchNorm2d._keep_variance_fn", "adf.BatchNorm2d.weight.unsqueeze().unsqueeze", "float", "adf.BatchNorm2d.weight.unsqueeze"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "\n", "# exponential_average_factor is self.momentum set to", "\n", "# (when it is available) only so that if gets updated", "\n", "# in ONNX graph when this node is exported to ONNX.", "\n", "        ", "if", "self", ".", "momentum", "is", "None", ":", "\n", "            ", "exponential_average_factor", "=", "0.0", "\n", "", "else", ":", "\n", "            ", "exponential_average_factor", "=", "self", ".", "momentum", "\n", "\n", "", "if", "self", ".", "training", "and", "self", ".", "track_running_stats", ":", "\n", "            ", "if", "self", ".", "num_batches_tracked", "is", "not", "None", ":", "\n", "                ", "self", ".", "num_batches_tracked", "+=", "1", "\n", "if", "self", ".", "momentum", "is", "None", ":", "# use cumulative moving average", "\n", "                    ", "exponential_average_factor", "=", "1.0", "/", "float", "(", "self", ".", "num_batches_tracked", ")", "\n", "", "else", ":", "# use exponential moving average", "\n", "                    ", "exponential_average_factor", "=", "self", ".", "momentum", "\n", "\n", "", "", "", "outputs_mean", "=", "F", ".", "batch_norm", "(", "\n", "inputs_mean", ",", "self", ".", "running_mean", ",", "self", ".", "running_var", ",", "self", ".", "weight", ",", "self", ".", "bias", ",", "\n", "self", ".", "training", "or", "not", "self", ".", "track_running_stats", ",", "\n", "exponential_average_factor", ",", "self", ".", "eps", ")", "\n", "outputs_variance", "=", "inputs_variance", "\n", "weight", "=", "(", "(", "self", ".", "weight", ".", "unsqueeze", "(", "0", ")", ")", ".", "unsqueeze", "(", "2", ")", ")", ".", "unsqueeze", "(", "3", ")", "\n", "outputs_variance", "=", "outputs_variance", "*", "weight", "**", "2", "\n", "\"\"\"\n        for i in range(outputs_variance.size(1)):\n            outputs_variance[:,i,:,:]=outputs_variance[:,i,:,:].clone()*self.weight[i]**2\n        \"\"\"", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Conv2d.__init__": [[367, 378], ["torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.conv._ConvNd.__init__", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "\n", "padding", "=", "0", ",", "dilation", "=", "1", ",", "groups", "=", "1", ",", "bias", "=", "True", ",", "\n", "keep_variance_fn", "=", "None", ",", "padding_mode", "=", "'zeros'", ")", ":", "\n", "        ", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "kernel_size", "=", "_pair", "(", "kernel_size", ")", "\n", "stride", "=", "_pair", "(", "stride", ")", "\n", "padding", "=", "_pair", "(", "padding", ")", "\n", "dilation", "=", "_pair", "(", "dilation", ")", "\n", "super", "(", "Conv2d", ",", "self", ")", ".", "__init__", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "padding", ",", "dilation", ",", "\n", "False", ",", "_pair", "(", "0", ")", ",", "groups", ",", "bias", ",", "padding_mode", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Conv2d.forward": [[379, 387], ["torch.nn.functional.conv2d", "torch.nn.functional.conv2d", "torch.nn.functional.conv2d", "torch.nn.functional.conv2d", "adf.Conv2d._keep_variance_fn"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ")", ":", "\n", "        ", "outputs_mean", "=", "F", ".", "conv2d", "(", "\n", "inputs_mean", ",", "self", ".", "weight", ",", "self", ".", "bias", ",", "self", ".", "stride", ",", "self", ".", "padding", ",", "self", ".", "dilation", ",", "self", ".", "groups", ")", "\n", "outputs_variance", "=", "F", ".", "conv2d", "(", "\n", "inputs_variance", ",", "self", ".", "weight", "**", "2", ",", "None", ",", "self", ".", "stride", ",", "self", ".", "padding", ",", "self", ".", "dilation", ",", "self", ".", "groups", ")", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.ConvTranspose2d.__init__": [[390, 402], ["torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.utils._pair", "torch.nn.modules.conv._ConvTransposeMixin.__init__"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", "=", "1", ",", "\n", "padding", "=", "0", ",", "output_padding", "=", "0", ",", "groups", "=", "1", ",", "bias", "=", "True", ",", "dilation", "=", "1", ",", "\n", "keep_variance_fn", "=", "None", ",", "padding_mode", "=", "'zeros'", ")", ":", "\n", "        ", "self", ".", "_keep_variance_fn", "=", "keep_variance_fn", "\n", "kernel_size", "=", "_pair", "(", "kernel_size", ")", "\n", "stride", "=", "_pair", "(", "stride", ")", "\n", "padding", "=", "_pair", "(", "padding", ")", "\n", "dilation", "=", "_pair", "(", "dilation", ")", "\n", "output_padding", "=", "_pair", "(", "output_padding", ")", "\n", "super", "(", "ConvTranspose2d", ",", "self", ")", ".", "__init__", "(", "\n", "in_channels", ",", "out_channels", ",", "kernel_size", ",", "stride", ",", "padding", ",", "dilation", ",", "\n", "True", ",", "output_padding", ",", "groups", ",", "bias", ",", "padding_mode", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.ConvTranspose2d.forward": [[403, 414], ["adf.ConvTranspose2d._output_padding", "torch.nn.functional.conv_transpose2d", "torch.nn.functional.conv_transpose2d", "torch.nn.functional.conv_transpose2d", "torch.nn.functional.conv_transpose2d", "adf.ConvTranspose2d._keep_variance_fn"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs_mean", ",", "inputs_variance", ",", "output_size", "=", "None", ")", ":", "\n", "        ", "output_padding", "=", "self", ".", "_output_padding", "(", "inputs_mean", ",", "output_size", ",", "self", ".", "stride", ",", "self", ".", "padding", ",", "self", ".", "kernel_size", ")", "\n", "outputs_mean", "=", "F", ".", "conv_transpose2d", "(", "\n", "inputs_mean", ",", "self", ".", "weight", ",", "self", ".", "bias", ",", "self", ".", "stride", ",", "self", ".", "padding", ",", "\n", "output_padding", ",", "self", ".", "groups", ",", "self", ".", "dilation", ")", "\n", "outputs_variance", "=", "F", ".", "conv_transpose2d", "(", "\n", "inputs_variance", ",", "self", ".", "weight", "**", "2", ",", "None", ",", "self", ".", "stride", ",", "self", ".", "padding", ",", "\n", "output_padding", ",", "self", ".", "groups", ",", "self", ".", "dilation", ")", "\n", "if", "self", ".", "_keep_variance_fn", "is", "not", "None", ":", "\n", "            ", "outputs_variance", "=", "self", ".", "_keep_variance_fn", "(", "outputs_variance", ")", "\n", "", "return", "outputs_mean", ",", "outputs_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.__init__": [[425, 433], ["torch.Module.__init__", "isinstance", "args[].items", "enumerate", "len", "adf.Sequential.add_module", "adf.Sequential.add_module", "str"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "*", "args", ")", ":", "\n", "        ", "super", "(", "Sequential", ",", "self", ")", ".", "__init__", "(", ")", "\n", "if", "len", "(", "args", ")", "==", "1", "and", "isinstance", "(", "args", "[", "0", "]", ",", "OrderedDict", ")", ":", "\n", "            ", "for", "key", ",", "module", "in", "args", "[", "0", "]", ".", "items", "(", ")", ":", "\n", "                ", "self", ".", "add_module", "(", "key", ",", "module", ")", "\n", "", "", "else", ":", "\n", "            ", "for", "idx", ",", "module", "in", "enumerate", "(", "args", ")", ":", "\n", "                ", "self", ".", "add_module", "(", "str", "(", "idx", ")", ",", "module", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential._get_item_by_idx": [[434, 442], ["len", "operator.index", "next", "IndexError", "itertools.islice"], "methods", ["None"], ["", "", "", "def", "_get_item_by_idx", "(", "self", ",", "iterator", ",", "idx", ")", ":", "\n", "        ", "\"\"\"Get the idx-th item of the iterator\"\"\"", "\n", "size", "=", "len", "(", "self", ")", "\n", "idx", "=", "operator", ".", "index", "(", "idx", ")", "\n", "if", "not", "-", "size", "<=", "idx", "<", "size", ":", "\n", "            ", "raise", "IndexError", "(", "'index {} is out of range'", ".", "format", "(", "idx", ")", ")", "\n", "", "idx", "%=", "size", "\n", "return", "next", "(", "islice", "(", "iterator", ",", "idx", ",", "None", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.__getitem__": [[443, 448], ["isinstance", "adf.Sequential", "adf.Sequential._get_item_by_idx", "collections.OrderedDict", "adf.Sequential._modules.values", "list", "adf.Sequential._modules.items"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential._get_item_by_idx"], ["", "def", "__getitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "if", "isinstance", "(", "idx", ",", "slice", ")", ":", "\n", "            ", "return", "Sequential", "(", "OrderedDict", "(", "list", "(", "self", ".", "_modules", ".", "items", "(", ")", ")", "[", "idx", "]", ")", ")", "\n", "", "else", ":", "\n", "            ", "return", "self", ".", "_get_item_by_idx", "(", "self", ".", "_modules", ".", "values", "(", ")", ",", "idx", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.__setitem__": [[449, 452], ["adf.Sequential._get_item_by_idx", "setattr", "adf.Sequential._modules.keys"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential._get_item_by_idx"], ["", "", "def", "__setitem__", "(", "self", ",", "idx", ",", "module", ")", ":", "\n", "        ", "key", "=", "self", ".", "_get_item_by_idx", "(", "self", ".", "_modules", ".", "keys", "(", ")", ",", "idx", ")", "\n", "return", "setattr", "(", "self", ",", "key", ",", "module", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.__delitem__": [[453, 460], ["isinstance", "adf.Sequential._get_item_by_idx", "delattr", "list", "delattr", "adf.Sequential._modules.keys", "adf.Sequential._modules.keys"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential._get_item_by_idx"], ["", "def", "__delitem__", "(", "self", ",", "idx", ")", ":", "\n", "        ", "if", "isinstance", "(", "idx", ",", "slice", ")", ":", "\n", "            ", "for", "key", "in", "list", "(", "self", ".", "_modules", ".", "keys", "(", ")", ")", "[", "idx", "]", ":", "\n", "                ", "delattr", "(", "self", ",", "key", ")", "\n", "", "", "else", ":", "\n", "            ", "key", "=", "self", ".", "_get_item_by_idx", "(", "self", ".", "_modules", ".", "keys", "(", ")", ",", "idx", ")", "\n", "delattr", "(", "self", ",", "key", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.__len__": [[461, 463], ["len"], "methods", ["None"], ["", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "_modules", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.__dir__": [[464, 468], ["torch.Module.__dir__", "key.isdigit"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.__dir__"], ["", "def", "__dir__", "(", "self", ")", ":", "\n", "        ", "keys", "=", "super", "(", "Sequential", ",", "self", ")", ".", "__dir__", "(", ")", "\n", "keys", "=", "[", "key", "for", "key", "in", "keys", "if", "not", "key", ".", "isdigit", "(", ")", "]", "\n", "return", "keys", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.Sequential.forward": [[469, 474], ["adf.Sequential._modules.values", "module"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs", ",", "inputs_variance", ")", ":", "\n", "        ", "for", "module", "in", "self", ".", "_modules", ".", "values", "(", ")", ":", "\n", "            ", "inputs", ",", "inputs_variance", "=", "module", "(", "inputs", ",", "inputs_variance", ")", "\n", "\n", "", "return", "inputs", ",", "inputs_variance", "\n", "", "", ""]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.adf.concatenate_as": [[416, 422], ["torch.cat", "torch.cat", "torch.cat", "torch.cat", "contrib.interpolation.resize2D_as", "contrib.interpolation.resize2D_as"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.resize2D_as", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.resize2D_as"], ["", "", "def", "concatenate_as", "(", "tensor_list", ",", "tensor_as", ",", "dim", ",", "mode", "=", "\"bilinear\"", ")", ":", "\n", "    ", "means", "=", "[", "resize2D_as", "(", "x", "[", "0", "]", ",", "tensor_as", "[", "0", "]", ",", "mode", "=", "mode", ")", "for", "x", "in", "tensor_list", "]", "\n", "variances", "=", "[", "resize2D_as", "(", "x", "[", "1", "]", ",", "tensor_as", "[", "0", "]", ",", "mode", "=", "mode", ")", "for", "x", "in", "tensor_list", "]", "\n", "means", "=", "torch", ".", "cat", "(", "means", ",", "dim", "=", "dim", ")", "\n", "variances", "=", "torch", ".", "cat", "(", "variances", ",", "dim", "=", "dim", ")", "\n", "return", "means", ",", "variances", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.Meshgrid.__init__": [[19, 27], ["torch.nn.Module.__init__", "interpolation.Meshgrid.register_buffer", "interpolation.Meshgrid.register_buffer", "interpolation.Meshgrid.register_buffer", "interpolation.Meshgrid.register_buffer", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros", "torch.zeros"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "Meshgrid", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "width", "=", "0", "\n", "self", ".", "height", "=", "0", "\n", "self", ".", "register_buffer", "(", "\"xx\"", ",", "torch", ".", "zeros", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"yy\"", ",", "torch", ".", "zeros", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"rangex\"", ",", "torch", ".", "zeros", "(", "1", ",", "1", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"rangey\"", ",", "torch", ".", "zeros", "(", "1", ",", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.Meshgrid._compute_meshgrid": [[28, 33], ["torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "interpolation.Meshgrid.rangex.repeat().contiguous", "interpolation.Meshgrid.rangey.repeat().t().contiguous", "interpolation.Meshgrid.rangex.repeat", "interpolation.Meshgrid.rangey.repeat().t", "interpolation.Meshgrid.rangey.repeat"], "methods", ["None"], ["", "def", "_compute_meshgrid", "(", "self", ",", "width", ",", "height", ")", ":", "\n", "        ", "torch", ".", "arange", "(", "0", ",", "width", ",", "out", "=", "self", ".", "rangex", ")", "\n", "torch", ".", "arange", "(", "0", ",", "height", ",", "out", "=", "self", ".", "rangey", ")", "\n", "self", ".", "xx", "=", "self", ".", "rangex", ".", "repeat", "(", "height", ",", "1", ")", ".", "contiguous", "(", ")", "\n", "self", ".", "yy", "=", "self", ".", "rangey", ".", "repeat", "(", "width", ",", "1", ")", ".", "t", "(", ")", ".", "contiguous", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.Meshgrid.forward": [[34, 40], ["interpolation.Meshgrid._compute_meshgrid"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.Meshgrid._compute_meshgrid"], ["", "def", "forward", "(", "self", ",", "width", ",", "height", ")", ":", "\n", "        ", "if", "self", ".", "width", "!=", "width", "or", "self", ".", "height", "!=", "height", ":", "\n", "            ", "self", ".", "_compute_meshgrid", "(", "width", "=", "width", ",", "height", "=", "height", ")", "\n", "self", ".", "width", "=", "width", "\n", "self", ".", "height", "=", "height", "\n", "", "return", "self", ".", "xx", ",", "self", ".", "yy", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.BatchSub2Ind.__init__": [[43, 46], ["torch.nn.Module.__init__", "interpolation.BatchSub2Ind.register_buffer", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "BatchSub2Ind", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "register_buffer", "(", "\"_offsets\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.BatchSub2Ind.forward": [[47, 58], ["row_sub.size", "torch.arange", "torch.arange", "torch.arange", "torch.arange", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "interpolation.BatchSub2Ind._offsets.view", "interpolation.BatchSub2Ind._offsets.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "shape", ",", "row_sub", ",", "col_sub", ",", "out", "=", "None", ")", ":", "\n", "        ", "batch_size", "=", "row_sub", ".", "size", "(", "0", ")", "\n", "height", ",", "width", "=", "shape", "\n", "ind", "=", "row_sub", "*", "width", "+", "col_sub", "\n", "torch", ".", "arange", "(", "batch_size", ",", "out", "=", "self", ".", "_offsets", ")", "\n", "self", ".", "_offsets", "*=", "(", "height", "*", "width", ")", "\n", "\n", "if", "out", "is", "None", ":", "\n", "            ", "return", "torch", ".", "add", "(", "ind", ",", "self", ".", "_offsets", ".", "view", "(", "-", "1", ",", "1", ",", "1", ")", ")", "\n", "", "else", ":", "\n", "            ", "torch", ".", "add", "(", "ind", ",", "self", ".", "_offsets", ".", "view", "(", "-", "1", ",", "1", ",", "1", ")", ",", "out", "=", "out", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.Interp2.__init__": [[61, 79], ["torch.nn.Module.__init__", "interpolation.BatchSub2Ind", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "interpolation.Interp2.register_buffer", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.LongTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "clamp", "=", "False", ")", ":", "\n", "        ", "super", "(", "Interp2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_clamp", "=", "clamp", "\n", "self", ".", "_batch_sub2ind", "=", "BatchSub2Ind", "(", ")", "\n", "self", ".", "register_buffer", "(", "\"_x0\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_x1\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_y0\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_y1\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_i00\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_i01\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_i10\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_i11\"", ",", "torch", ".", "LongTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_v00\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_v01\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_v10\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_v11\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_x\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_y\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.Interp2.forward": [[80, 142], ["v.size", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "torch.clamp", "interpolation.Interp2._batch_sub2ind", "interpolation.Interp2._batch_sub2ind", "interpolation.Interp2._batch_sub2ind", "interpolation.Interp2._batch_sub2ind", "_bchw2bhwc().contiguous().view", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.index_select", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "torch.unsqueeze", "xq.clamp_", "yq.clamp_", "torch.floor().long", "torch.floor().long", "torch.floor().long", "torch.floor().long", "torch.floor().long", "torch.floor().long", "torch.floor().long", "torch.floor().long", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "torch.add", "interpolation._bhwc2bchw", "_bchw2bhwc().contiguous", "interpolation.Interp2._i00.view", "interpolation.Interp2._i01.view", "interpolation.Interp2._i10.view", "interpolation.Interp2._i11.view", "interpolation.Interp2._x0.float", "interpolation.Interp2._y0.float", "u.view", "interpolation.Interp2.forward._reshape"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation._bhwc2bchw"], ["", "def", "forward", "(", "self", ",", "v", ",", "xq", ",", "yq", ")", ":", "\n", "        ", "batch_size", ",", "channels", ",", "height", ",", "width", "=", "v", ".", "size", "(", ")", "\n", "\n", "# clamp if wanted", "\n", "if", "self", ".", "_clamp", ":", "\n", "            ", "xq", ".", "clamp_", "(", "0", ",", "width", "-", "1", ")", "\n", "yq", ".", "clamp_", "(", "0", ",", "height", "-", "1", ")", "\n", "\n", "# ------------------------------------------------------------------", "\n", "# Find neighbors", "\n", "#", "\n", "# x0 = torch.floor(xq).long(),          x0.clamp_(0, width - 1)", "\n", "# x1 = x0 + 1,                          x1.clamp_(0, width - 1)", "\n", "# y0 = torch.floor(yq).long(),          y0.clamp_(0, height - 1)", "\n", "# y1 = y0 + 1,                          y1.clamp_(0, height - 1)", "\n", "#", "\n", "# ------------------------------------------------------------------", "\n", "", "torch", ".", "clamp", "(", "torch", ".", "floor", "(", "xq", ")", ".", "long", "(", ")", ",", "0", ",", "width", "-", "1", ",", "out", "=", "self", ".", "_x0", ")", "\n", "torch", ".", "clamp", "(", "torch", ".", "floor", "(", "yq", ")", ".", "long", "(", ")", ",", "0", ",", "height", "-", "1", ",", "out", "=", "self", ".", "_y0", ")", "\n", "\n", "torch", ".", "clamp", "(", "torch", ".", "add", "(", "self", ".", "_x0", ",", "1", ")", ",", "0", ",", "width", "-", "1", ",", "out", "=", "self", ".", "_x1", ")", "\n", "torch", ".", "clamp", "(", "torch", ".", "add", "(", "self", ".", "_y0", ",", "1", ")", ",", "0", ",", "height", "-", "1", ",", "out", "=", "self", ".", "_y1", ")", "\n", "\n", "# batch_sub2ind", "\n", "self", ".", "_batch_sub2ind", "(", "[", "height", ",", "width", "]", ",", "self", ".", "_y0", ",", "self", ".", "_x0", ",", "out", "=", "self", ".", "_i00", ")", "\n", "self", ".", "_batch_sub2ind", "(", "[", "height", ",", "width", "]", ",", "self", ".", "_y0", ",", "self", ".", "_x1", ",", "out", "=", "self", ".", "_i01", ")", "\n", "self", ".", "_batch_sub2ind", "(", "[", "height", ",", "width", "]", ",", "self", ".", "_y1", ",", "self", ".", "_x0", ",", "out", "=", "self", ".", "_i10", ")", "\n", "self", ".", "_batch_sub2ind", "(", "[", "height", ",", "width", "]", ",", "self", ".", "_y1", ",", "self", ".", "_x1", ",", "out", "=", "self", ".", "_i11", ")", "\n", "\n", "# reshape", "\n", "v_flat", "=", "_bchw2bhwc", "(", "v", ")", ".", "contiguous", "(", ")", ".", "view", "(", "-", "1", ",", "channels", ")", "\n", "torch", ".", "index_select", "(", "v_flat", ",", "dim", "=", "0", ",", "index", "=", "self", ".", "_i00", ".", "view", "(", "-", "1", ")", ",", "out", "=", "self", ".", "_v00", ")", "\n", "torch", ".", "index_select", "(", "v_flat", ",", "dim", "=", "0", ",", "index", "=", "self", ".", "_i01", ".", "view", "(", "-", "1", ")", ",", "out", "=", "self", ".", "_v01", ")", "\n", "torch", ".", "index_select", "(", "v_flat", ",", "dim", "=", "0", ",", "index", "=", "self", ".", "_i10", ".", "view", "(", "-", "1", ")", ",", "out", "=", "self", ".", "_v10", ")", "\n", "torch", ".", "index_select", "(", "v_flat", ",", "dim", "=", "0", ",", "index", "=", "self", ".", "_i11", ".", "view", "(", "-", "1", ")", ",", "out", "=", "self", ".", "_v11", ")", "\n", "\n", "# local_coords", "\n", "torch", ".", "add", "(", "xq", ",", "-", "self", ".", "_x0", ".", "float", "(", ")", ",", "out", "=", "self", ".", "_x", ")", "\n", "torch", ".", "add", "(", "yq", ",", "-", "self", ".", "_y0", ".", "float", "(", ")", ",", "out", "=", "self", ".", "_y", ")", "\n", "\n", "# weights", "\n", "w00", "=", "torch", ".", "unsqueeze", "(", "(", "1.0", "-", "self", ".", "_y", ")", "*", "(", "1.0", "-", "self", ".", "_x", ")", ",", "dim", "=", "1", ")", "\n", "w01", "=", "torch", ".", "unsqueeze", "(", "(", "1.0", "-", "self", ".", "_y", ")", "*", "self", ".", "_x", ",", "dim", "=", "1", ")", "\n", "w10", "=", "torch", ".", "unsqueeze", "(", "self", ".", "_y", "*", "(", "1.0", "-", "self", ".", "_x", ")", ",", "dim", "=", "1", ")", "\n", "w11", "=", "torch", ".", "unsqueeze", "(", "self", ".", "_y", "*", "self", ".", "_x", ",", "dim", "=", "1", ")", "\n", "\n", "def", "_reshape", "(", "u", ")", ":", "\n", "            ", "return", "_bhwc2bchw", "(", "u", ".", "view", "(", "batch_size", ",", "height", ",", "width", ",", "channels", ")", ")", "\n", "\n", "# values", "\n", "", "values", "=", "_reshape", "(", "self", ".", "_v00", ")", "*", "w00", "+", "_reshape", "(", "self", ".", "_v01", ")", "*", "w01", "+", "_reshape", "(", "self", ".", "_v10", ")", "*", "w10", "+", "_reshape", "(", "self", ".", "_v11", ")", "*", "w11", "\n", "\n", "if", "self", ".", "_clamp", ":", "\n", "            ", "return", "values", "\n", "", "else", ":", "\n", "#  find_invalid", "\n", "            ", "invalid", "=", "(", "(", "xq", "<", "0", ")", "|", "(", "xq", ">=", "width", ")", "|", "(", "yq", "<", "0", ")", "|", "(", "yq", ">=", "height", ")", ")", ".", "unsqueeze", "(", "dim", "=", "1", ")", ".", "float", "(", ")", "\n", "# maskout invalid", "\n", "transformed", "=", "invalid", "*", "torch", ".", "zeros_like", "(", "values", ")", "+", "(", "1.0", "-", "invalid", ")", "*", "values", "\n", "\n", "", "return", "transformed", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.InverseWarpImage.__init__": [[164, 169], ["torch.nn.Module.__init__", "interpolation.Meshgrid", "interpolation.Interp2"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "clamp", "=", "True", ")", ":", "\n", "        ", "super", "(", "InverseWarpImage", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_meshgrid", "=", "Meshgrid", "(", ")", "\n", "self", ".", "_interp2", "=", "Interp2", "(", "clamp", "=", "clamp", ")", "\n", "self", ".", "_clamp", "=", "clamp", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.InverseWarpImage.forward": [[170, 177], ["interpolation.InverseWarpImage._meshgrid", "interpolation.InverseWarpImage._interp2", "image.size", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze", "torch.squeeze"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "image", ",", "u", ",", "v", ")", ":", "\n", "        ", "height", ",", "width", "=", "image", ".", "size", "(", ")", "[", "2", ":", "]", "\n", "xx", ",", "yy", "=", "self", ".", "_meshgrid", "(", "width", "=", "width", ",", "height", "=", "height", ")", "\n", "xq", "=", "xx", "+", "torch", ".", "squeeze", "(", "u", ",", "dim", "=", "1", ")", "\n", "yq", "=", "yy", "+", "torch", ".", "squeeze", "(", "v", ",", "dim", "=", "1", ")", "\n", "\n", "return", "self", ".", "_interp2", "(", "image", ",", "xq", ",", "yq", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation._bchw2bhwc": [[10, 12], ["tensor.transpose().transpose", "tensor.transpose"], "function", ["None"], ["def", "_bchw2bhwc", "(", "tensor", ")", ":", "\n", "    ", "return", "tensor", ".", "transpose", "(", "1", ",", "2", ")", ".", "transpose", "(", "2", ",", "3", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation._bhwc2bchw": [[14, 16], ["tensor.transpose().transpose", "tensor.transpose"], "function", ["None"], ["", "def", "_bhwc2bchw", "(", "tensor", ")", ":", "\n", "    ", "return", "tensor", ".", "transpose", "(", "2", ",", "3", ")", ".", "transpose", "(", "1", ",", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.resize2D": [[144, 156], ["all", "inputs.size", "inputs.size", "any", "torch.adaptive_avg_pool2d", "torch.upsample"], "function", ["None"], ["", "", "def", "resize2D", "(", "inputs", ",", "size_targets", ",", "mode", "=", "\"bilinear\"", ")", ":", "\n", "    ", "size_inputs", "=", "[", "inputs", ".", "size", "(", "2", ")", ",", "inputs", ".", "size", "(", "3", ")", "]", "\n", "\n", "if", "all", "(", "[", "size_inputs", "==", "size_targets", "]", ")", ":", "\n", "        ", "return", "inputs", "# nothing to do", "\n", "", "elif", "any", "(", "[", "size_targets", "<", "size_inputs", "]", ")", ":", "\n", "        ", "resized", "=", "tf", ".", "adaptive_avg_pool2d", "(", "inputs", ",", "size_targets", ")", "# downscaling", "\n", "", "else", ":", "\n", "        ", "resized", "=", "tf", ".", "upsample", "(", "inputs", ",", "size", "=", "size_targets", ",", "mode", "=", "mode", ")", "# upsampling", "\n", "\n", "# correct scaling", "\n", "", "return", "resized", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.resize2D_as": [[158, 161], ["interpolation.resize2D", "output_as.size", "output_as.size"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.interpolation.resize2D"], ["", "def", "resize2D_as", "(", "inputs", ",", "output_as", ",", "mode", "=", "\"bilinear\"", ")", ":", "\n", "    ", "size_targets", "=", "[", "output_as", ".", "size", "(", "2", ")", ",", "output_as", ".", "size", "(", "3", ")", "]", "\n", "return", "resize2D", "(", "inputs", ",", "size_targets", ",", "mode", "=", "mode", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normcdf": [[11, 14], ["isinstance", "stddev.reciprocal", "torch.erf", "numpy.sqrt"], "function", ["None"], ["def", "normcdf", "(", "value", ",", "mu", "=", "0.0", ",", "stddev", "=", "1.0", ")", ":", "\n", "    ", "sinv", "=", "(", "1.0", "/", "stddev", ")", "if", "isinstance", "(", "stddev", ",", "Number", ")", "else", "stddev", ".", "reciprocal", "(", ")", "\n", "return", "0.5", "*", "(", "1.0", "+", "torch", ".", "erf", "(", "(", "value", "-", "mu", ")", "*", "sinv", "/", "np", ".", "sqrt", "(", "2.0", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math._normal_log_pdf": [[16, 20], ["isinstance", "numpy.log", "torch.log", "numpy.log", "numpy.sqrt"], "function", ["None"], ["", "def", "_normal_log_pdf", "(", "value", ",", "mu", ",", "stddev", ")", ":", "\n", "    ", "var", "=", "(", "stddev", "**", "2", ")", "\n", "log_scale", "=", "np", ".", "log", "(", "stddev", ")", "if", "isinstance", "(", "stddev", ",", "Number", ")", "else", "torch", ".", "log", "(", "stddev", ")", "\n", "return", "-", "(", "(", "value", "-", "mu", ")", "**", "2", ")", "/", "(", "2.0", "*", "var", ")", "-", "log_scale", "-", "np", ".", "log", "(", "np", ".", "sqrt", "(", "2.0", "*", "np", ".", "pi", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math.normpdf": [[23, 25], ["torch.exp", "math._normal_log_pdf"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.math._normal_log_pdf"], ["", "def", "normpdf", "(", "value", ",", "mu", "=", "0.0", ",", "stddev", "=", "1.0", ")", ":", "\n", "    ", "return", "torch", ".", "exp", "(", "_normal_log_pdf", "(", "value", ",", "mu", ",", "stddev", ")", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.SmoothOneHot.__init__": [[11, 18], ["torch.Module.__init__", "distributions.SmoothOneHot.register_buffer", "distributions.SmoothOneHot.register_buffer", "distributions.SmoothOneHot.register_buffer", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "label_smoothing", ",", "random_off_targets", "=", "False", ")", ":", "\n", "        ", "super", "(", "SmoothOneHot", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "register_buffer", "(", "\"_one_hot\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_ones\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "register_buffer", "(", "\"_noise\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "self", ".", "_label_smoothing", "=", "label_smoothing", "\n", "self", ".", "_random_off_targets", "=", "random_off_targets", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.SmoothOneHot.forward": [[19, 71], ["indices.size", "distributions.SmoothOneHot._one_hot.resize_().fill_", "distributions.SmoothOneHot._ones.resize_().fill_", "distributions.SmoothOneHot._one_hot.scatter_", "indices.size", "distributions.SmoothOneHot._one_hot.resize_().fill_", "distributions.SmoothOneHot._ones.resize_().fill_", "distributions.SmoothOneHot._one_hot.scatter_", "distributions.SmoothOneHot._noise.resize_().uniform_", "indices.view", "indices.view", "distributions.SmoothOneHot._noise.sum", "distributions.SmoothOneHot._one_hot.resize_", "distributions.SmoothOneHot._ones.resize_", "distributions.SmoothOneHot._one_hot.resize_", "distributions.SmoothOneHot._ones.resize_", "distributions.SmoothOneHot._noise.resize_"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "indices", ",", "num_classes", ")", ":", "\n", "        ", "if", "not", "self", ".", "_random_off_targets", ":", "\n", "# construct one hot", "\n", "            ", "batch_size", "=", "indices", ".", "size", "(", "0", ")", "\n", "self", ".", "_one_hot", ".", "resize_", "(", "batch_size", ",", "num_classes", ")", ".", "fill_", "(", "0.0", ")", "\n", "self", ".", "_ones", ".", "resize_", "(", "batch_size", ",", "num_classes", ")", ".", "fill_", "(", "1.0", ")", "\n", "self", ".", "_one_hot", ".", "scatter_", "(", "1", ",", "indices", ".", "view", "(", "-", "1", ",", "1", ")", ",", "self", ".", "_ones", ")", "\n", "one_hot_labels", "=", "self", ".", "_one_hot", "\n", "# label smoothing", "\n", "smooth_positives", "=", "1.0", "-", "self", ".", "_label_smoothing", "\n", "smooth_negatives", "=", "self", ".", "_label_smoothing", "/", "num_classes", "\n", "return", "one_hot_labels", "*", "smooth_positives", "+", "smooth_negatives", "\n", "", "else", ":", "\n", "# construct one hot", "\n", "            ", "batch_size", "=", "indices", ".", "size", "(", "0", ")", "\n", "self", ".", "_one_hot", ".", "resize_", "(", "batch_size", ",", "num_classes", ")", ".", "fill_", "(", "0.0", ")", "\n", "self", ".", "_ones", ".", "resize_", "(", "batch_size", ",", "num_classes", ")", ".", "fill_", "(", "1.0", ")", "\n", "self", ".", "_one_hot", ".", "scatter_", "(", "1", ",", "indices", ".", "view", "(", "-", "1", ",", "1", ")", ",", "self", ".", "_ones", ")", "\n", "positive_labels", "=", "self", ".", "_one_hot", "\n", "smooth_positives", "=", "1.0", "-", "self", ".", "_label_smoothing", "\n", "smooth_negatives", "=", "self", ".", "_label_smoothing", "\n", "positive_labels", "=", "positive_labels", "*", "smooth_positives", "\n", "\n", "negative_labels", "=", "1.0", "-", "self", ".", "_one_hot", "\n", "self", ".", "_noise", ".", "resize_", "(", "batch_size", ",", "num_classes", ")", ".", "uniform_", "(", "1e-1", ",", "1.0", ")", "\n", "self", ".", "_noise", "=", "self", ".", "_noise", "*", "negative_labels", "\n", "self", ".", "_noise", "=", "smooth_negatives", "*", "self", ".", "_noise", "/", "self", ".", "_noise", ".", "sum", "(", "dim", "=", "1", ",", "keepdim", "=", "True", ")", "\n", "one_hot_labels", "=", "positive_labels", "+", "self", ".", "_noise", "\n", "return", "one_hot_labels", "\n", "\n", "# label smoothing", "\n", "# smooth_positives = 1.0 - self._label_smoothing", "\n", "# sum_negatives = self._label_smoothing", "\n", "\n", "# self._noise.resize_(batch_size, num_classes).random_(1e-5, 1-3)", "\n", "# self._noise = self._noise / self._noise.sum()", "\n", "# torch.random()", "\n", "\n", "# batch_size = indices.size(0)", "\n", "# self._one_hot.resize_(batch_size, num_classes).fill_(0.0)", "\n", "# self._ones.resize_(batch_size, num_classes).fill_(1.0)", "\n", "# self._one_hot.scatter_(1, indices.view(-1,1), self._ones)", "\n", "\n", "# torch.rand(1e-5, smooth_negatives)", "\n", "# offsets = torch.from_numpy(np.random.randint(low=1, high=num_classes, size=[batch_size])).cuda()", "\n", "# false_indices = torch.fmod((indices + offsets).float(), float(num_classes)).long()", "\n", "# self._ones.resize_(batch_size, num_classes).fill_(smooth_negatives)", "\n", "# self._one_hot.scatter_(1, false_indices.view(-1,1), self._ones)", "\n", "\n", "# one_hot_labels = self._one_hot * 1.0", "\n", "\n", "return", "one_hot_labels", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.__init__": [[74, 79], ["torch.Module.__init__", "distributions.SmoothOneHot", "distributions.Dirichlet.register_buffer", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor", "torch.FloatTensor"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "argmax_smoothing", "=", "1e-5", ",", "random_off_targets", "=", "False", ")", ":", "\n", "        ", "super", "(", "Dirichlet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "_onehot", "=", "SmoothOneHot", "(", "\n", "label_smoothing", "=", "argmax_smoothing", ",", "random_off_targets", "=", "random_off_targets", ")", "\n", "self", ".", "register_buffer", "(", "\"_range\"", ",", "torch", ".", "FloatTensor", "(", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.forward": [[80, 83], ["torch.distributions.dirichlet.Dirichlet", "torch.distributions.dirichlet.Dirichlet", "torch.distributions.dirichlet.Dirichlet.log_prob", "torch.distributions.dirichlet.Dirichlet.log_prob"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "alpha", ",", "value", ")", ":", "\n", "        ", "dirichlet", "=", "TorchDirichlet", "(", "alpha", ")", "\n", "return", "dirichlet", ".", "log_prob", "(", "value", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.contrib.distributions.Dirichlet.mean": [[84, 86], ["alpha.sum"], "methods", ["None"], ["", "def", "mean", "(", "self", ",", "alpha", ")", ":", "\n", "        ", "return", "alpha", "/", "alpha", ".", "sum", "(", "-", "1", ",", "keepdim", "=", "True", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.lgamma_function.lgamma_function.LogGammaFunction.forward": [[12, 20], ["lgamma_function.LogGammaFunction.save_for_backward", "inputs.clone", "torch.from_numpy().cuda", "torch.from_numpy", "scipy.special.gammaln().astype", "torch.from_numpy", "scipy.special.gammaln().astype", "scipy.special.gammaln", "inputs.numpy().astype", "scipy.special.gammaln", "inputs.cpu().numpy().astype", "inputs.numpy", "inputs.cpu().numpy", "inputs.cpu"], "methods", ["None"], ["    ", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "        ", "self", ".", "save_for_backward", "(", "inputs", ")", "\n", "outputs", "=", "inputs", ".", "clone", "(", ")", "\n", "if", "inputs", ".", "is_cuda", ":", "\n", "            ", "outputs", "[", ":", "]", "=", "torch", ".", "from_numpy", "(", "gammaln", "(", "inputs", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "astype", "(", "np", ".", "float64", ")", ")", ".", "astype", "(", "np", ".", "float32", ")", ")", ".", "cuda", "(", ")", "\n", "", "else", ":", "\n", "            ", "outputs", "[", ":", "]", "=", "torch", ".", "from_numpy", "(", "gammaln", "(", "inputs", ".", "numpy", "(", ")", ".", "astype", "(", "np", ".", "float64", ")", ")", ".", "astype", "(", "np", ".", "float32", ")", ")", "\n", "", "return", "outputs", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.lgamma_function.lgamma_function.LogGammaFunction.backward": [[21, 30], ["grad_output.clone", "torch.from_numpy().cuda", "torch.from_numpy", "scipy.special.digamma().astype", "torch.from_numpy", "scipy.special.digamma().astype", "scipy.special.digamma", "inputs.numpy().astype", "scipy.special.digamma", "inputs.cpu().numpy().astype", "inputs.numpy", "inputs.cpu().numpy", "inputs.cpu"], "methods", ["None"], ["", "def", "backward", "(", "self", ",", "grad_output", ")", ":", "\n", "        ", "inputs", "=", "self", ".", "saved_tensors", "[", "0", "]", "\n", "grad", "=", "grad_output", ".", "clone", "(", ")", "\n", "if", "grad_output", ".", "is_cuda", ":", "\n", "            ", "grad", "[", ":", "]", "=", "torch", ".", "from_numpy", "(", "digamma", "(", "inputs", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "astype", "(", "np", ".", "float64", ")", ")", ".", "astype", "(", "np", ".", "float32", ")", ")", ".", "cuda", "(", ")", "\n", "", "else", ":", "\n", "            ", "grad", "[", ":", "]", "=", "torch", ".", "from_numpy", "(", "digamma", "(", "inputs", ".", "numpy", "(", ")", ".", "astype", "(", "np", ".", "float64", ")", ")", ".", "astype", "(", "np", ".", "float32", ")", ")", "\n", "", "grad_input", "=", "grad_output", "*", "grad", "\n", "return", "grad_input", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.lgamma_function.lgamma_function.lgamma": [[32, 34], ["lgamma_function.LogGammaFunction"], "function", ["None"], ["", "", "def", "lgamma", "(", "inputs", ")", ":", "\n", "    ", "return", "LogGammaFunction", "(", ")", "(", "inputs", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.lgamma_function.lgamma_function.lbeta": [[36, 42], ["torch.sum", "torch.sum", "lgamma_function.lgamma", "lgamma_function.lgamma"], "function", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.lgamma_function.lgamma_function.lgamma", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.lgamma_function.lgamma_function.lgamma"], ["", "def", "lbeta", "(", "inputs", ")", ":", "\n", "    ", "log_prod_gamma_x", "=", "torch", ".", "sum", "(", "lgamma", "(", "inputs", ")", ",", "dim", "=", "-", "1", ",", "keepdim", "=", "True", ")", "\n", "sum_x", "=", "torch", ".", "sum", "(", "inputs", ",", "dim", "=", "-", "1", ",", "keepdim", "=", "True", ")", "\n", "log_gamma_sum_x", "=", "lgamma", "(", "sum_x", ")", "\n", "result", "=", "log_prod_gamma_x", "-", "log_gamma_sum_x", "\n", "return", "result", "\n", "", ""]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_adf.EEGNet_adf.__init__": [[23, 44], ["torch.Module.__init__", "contrib.adf.ReLU", "contrib.adf.Conv2d", "contrib.adf.BatchNorm2d", "contrib.adf.ZeroPad2d", "contrib.adf.Conv2d", "contrib.adf.BatchNorm2d", "contrib.adf.MaxPool2d", "contrib.adf.ZeroPad2d", "contrib.adf.Conv2d", "contrib.adf.BatchNorm2d", "contrib.adf.MaxPool2d_2", "contrib.adf.Linear", "eegnet_adf.keep_variance"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.keep_variance"], ["    ", "def", "__init__", "(", "self", ",", "noise_variance", "=", "1e-2", ",", "min_variance", "=", "1e-3", ",", "initialize_msra", "=", "False", ")", ":", "\n", "        ", "super", "(", "EEGNet_adf", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "keep_variance_fn", "=", "lambda", "x", ":", "keep_variance", "(", "x", ",", "min_variance", "=", "min_variance", ")", "\n", "self", ".", "_noise_variance", "=", "noise_variance", "\n", "self", ".", "ReLU", "=", "adf", ".", "ReLU", "(", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "#self.permute=adf.permute((0,3,1,2))", "\n", "self", ".", "conv1", "=", "adf", ".", "Conv2d", "(", "1", ",", "16", ",", "(", "1", ",", "22", ")", ",", "padding", "=", "0", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "batchnorm1", "=", "adf", ".", "BatchNorm2d", "(", "16", ",", "False", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "# Layer 2", "\n", "self", ".", "padding1", "=", "adf", ".", "ZeroPad2d", "(", "(", "16", ",", "17", ",", "0", ",", "1", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "conv2", "=", "adf", ".", "Conv2d", "(", "1", ",", "4", ",", "(", "2", ",", "32", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "batchnorm2", "=", "adf", ".", "BatchNorm2d", "(", "4", ",", "False", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "pooling2", "=", "adf", ".", "MaxPool2d", "(", ")", "\n", "\n", "# Layer 3", "\n", "self", ".", "padding2", "=", "adf", ".", "ZeroPad2d", "(", "(", "2", ",", "1", ",", "4", ",", "3", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "conv3", "=", "adf", ".", "Conv2d", "(", "4", ",", "4", ",", "(", "8", ",", "4", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "batchnorm3", "=", "adf", ".", "BatchNorm2d", "(", "4", ",", "False", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "pooling3", "=", "adf", ".", "MaxPool2d_2", "(", ")", "\n", "self", ".", "linear", "=", "adf", ".", "Linear", "(", "4", "*", "2", "*", "25", ",", "4", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_adf.EEGNet_adf.forward": [[45, 77], ["eegnet_adf.EEGNet_adf.ReLU", "eegnet_adf.EEGNet_adf.batchnorm1", "x[].permute", "x[].permute", "eegnet_adf.EEGNet_adf.padding1", "eegnet_adf.EEGNet_adf.ReLU", "eegnet_adf.EEGNet_adf.batchnorm2", "eegnet_adf.EEGNet_adf.pooling2", "eegnet_adf.EEGNet_adf.pooling2", "eegnet_adf.EEGNet_adf.padding2", "eegnet_adf.EEGNet_adf.ReLU", "eegnet_adf.EEGNet_adf.batchnorm3", "eegnet_adf.EEGNet_adf.pooling3", "x[].view", "x[].view", "eegnet_adf.EEGNet_adf.linear", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "eegnet_adf.EEGNet_adf.conv1", "eegnet_adf.EEGNet_adf.conv2", "eegnet_adf.EEGNet_adf.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "inputs_mean", "=", "x", "\n", "inputs_variance", "=", "torch", ".", "zeros_like", "(", "inputs_mean", ")", "+", "self", ".", "_noise_variance", "\n", "x", "=", "inputs_mean", ",", "inputs_variance", "\n", "\n", "x", "=", "self", ".", "ReLU", "(", "*", "self", ".", "conv1", "(", "*", "x", ")", ")", "\n", "x", "=", "self", ".", "batchnorm1", "(", "*", "x", ")", "\n", "#x = self.permute(*x)", "\n", "x_mean", "=", "x", "[", "0", "]", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "x_var", "=", "x", "[", "1", "]", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "x", "=", "x_mean", ",", "x_var", "\n", "# Layer 2", "\n", "x", "=", "self", ".", "padding1", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "ReLU", "(", "*", "self", ".", "conv2", "(", "*", "x", ")", ")", "\n", "x", "=", "self", ".", "batchnorm2", "(", "*", "x", ")", "\n", "\n", "x", "=", "self", ".", "pooling2", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "pooling2", "(", "*", "x", ")", "\n", "\n", "# Layer 3", "\n", "x", "=", "self", ".", "padding2", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "ReLU", "(", "*", "self", ".", "conv3", "(", "*", "x", ")", ")", "\n", "x", "=", "self", ".", "batchnorm3", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "pooling3", "(", "*", "x", ")", "\n", "\n", "x_mean", "=", "x", "[", "0", "]", ".", "view", "(", "-", "1", ",", "4", "*", "2", "*", "25", ")", "\n", "x_var", "=", "x", "[", "1", "]", ".", "view", "(", "-", "1", ",", "4", "*", "2", "*", "25", ")", "\n", "x", "=", "x_mean", ",", "x_var", "\n", "x", "=", "self", ".", "linear", "(", "*", "x", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_adf.keep_variance": [[18, 20], ["None"], "function", ["None"], ["def", "keep_variance", "(", "x", ",", "min_variance", ")", ":", "\n", "    ", "return", "x", "+", "min_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.EEGNet_dropout_adf.__init__": [[23, 49], ["torch.Module.__init__", "contrib.adf.ReLU", "contrib.adf.Conv2d", "contrib.adf.BatchNorm2d", "contrib.adf.ZeroPad2d", "contrib.adf.Conv2d", "contrib.adf.BatchNorm2d", "contrib.adf.MaxPool2d", "contrib.adf.ZeroPad2d", "contrib.adf.Conv2d", "contrib.adf.BatchNorm2d", "contrib.adf.MaxPool2d_2", "contrib.adf.Linear", "print", "print", "contrib.adf.Dropout", "eegnet_dropout_adf.keep_variance"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__", "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.keep_variance"], ["    ", "def", "__init__", "(", "self", ",", "p", "=", "0.2", ",", "noise_variance", "=", "1e-2", ",", "min_variance", "=", "1e-3", ",", "initialize_msra", "=", "False", ")", ":", "\n", "        ", "super", "(", "EEGNet_dropout_adf", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "keep_variance_fn", "=", "lambda", "x", ":", "keep_variance", "(", "x", ",", "min_variance", "=", "min_variance", ")", "\n", "self", ".", "_noise_variance", "=", "noise_variance", "\n", "self", ".", "ReLU", "=", "adf", ".", "ReLU", "(", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "#self.permute=adf.permute((0,3,1,2))", "\n", "self", ".", "conv1", "=", "adf", ".", "Conv2d", "(", "1", ",", "16", ",", "(", "1", ",", "22", ")", ",", "padding", "=", "0", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "batchnorm1", "=", "adf", ".", "BatchNorm2d", "(", "16", ",", "False", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "# Layer 2", "\n", "self", ".", "padding1", "=", "adf", ".", "ZeroPad2d", "(", "(", "16", ",", "17", ",", "0", ",", "1", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "conv2", "=", "adf", ".", "Conv2d", "(", "1", ",", "4", ",", "(", "2", ",", "32", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "batchnorm2", "=", "adf", ".", "BatchNorm2d", "(", "4", ",", "False", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "pooling2", "=", "adf", ".", "MaxPool2d", "(", ")", "\n", "\n", "# Layer 3", "\n", "self", ".", "padding2", "=", "adf", ".", "ZeroPad2d", "(", "(", "2", ",", "1", ",", "4", ",", "3", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "conv3", "=", "adf", ".", "Conv2d", "(", "4", ",", "4", ",", "(", "8", ",", "4", ")", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "batchnorm3", "=", "adf", ".", "BatchNorm2d", "(", "4", ",", "False", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "self", ".", "pooling3", "=", "adf", ".", "MaxPool2d_2", "(", ")", "\n", "self", ".", "linear", "=", "adf", ".", "Linear", "(", "4", "*", "2", "*", "25", ",", "4", ",", "keep_variance_fn", "=", "self", ".", "keep_variance_fn", ")", "\n", "\n", "print", "(", "\"drop out rate\"", ")", "\n", "print", "(", "p", ")", "\n", "\n", "self", ".", "dropout", "=", "adf", ".", "Dropout", "(", "p", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.EEGNet_dropout_adf.forward": [[50, 82], ["eegnet_dropout_adf.EEGNet_dropout_adf.dropout", "eegnet_dropout_adf.EEGNet_dropout_adf.batchnorm1", "x[].permute", "x[].permute", "eegnet_dropout_adf.EEGNet_dropout_adf.padding1", "eegnet_dropout_adf.EEGNet_dropout_adf.dropout", "eegnet_dropout_adf.EEGNet_dropout_adf.batchnorm2", "eegnet_dropout_adf.EEGNet_dropout_adf.pooling2", "eegnet_dropout_adf.EEGNet_dropout_adf.pooling2", "eegnet_dropout_adf.EEGNet_dropout_adf.padding2", "eegnet_dropout_adf.EEGNet_dropout_adf.dropout", "eegnet_dropout_adf.EEGNet_dropout_adf.batchnorm3", "eegnet_dropout_adf.EEGNet_dropout_adf.pooling3", "x[].view", "x[].view", "eegnet_dropout_adf.EEGNet_dropout_adf.linear", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "torch.zeros_like", "eegnet_dropout_adf.EEGNet_dropout_adf.ReLU", "eegnet_dropout_adf.EEGNet_dropout_adf.ReLU", "eegnet_dropout_adf.EEGNet_dropout_adf.ReLU", "eegnet_dropout_adf.EEGNet_dropout_adf.conv1", "eegnet_dropout_adf.EEGNet_dropout_adf.conv2", "eegnet_dropout_adf.EEGNet_dropout_adf.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "\n", "        ", "inputs_mean", "=", "x", "\n", "inputs_variance", "=", "torch", ".", "zeros_like", "(", "inputs_mean", ")", "+", "self", ".", "_noise_variance", "\n", "x", "=", "inputs_mean", ",", "inputs_variance", "\n", "\n", "x", "=", "self", ".", "dropout", "(", "*", "self", ".", "ReLU", "(", "*", "self", ".", "conv1", "(", "*", "x", ")", ")", ")", "\n", "x", "=", "self", ".", "batchnorm1", "(", "*", "x", ")", "\n", "#x = self.permute(*x)", "\n", "x_mean", "=", "x", "[", "0", "]", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "x_var", "=", "x", "[", "1", "]", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "x", "=", "x_mean", ",", "x_var", "\n", "# Layer 2", "\n", "x", "=", "self", ".", "padding1", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "dropout", "(", "*", "self", ".", "ReLU", "(", "*", "self", ".", "conv2", "(", "*", "x", ")", ")", ")", "\n", "x", "=", "self", ".", "batchnorm2", "(", "*", "x", ")", "\n", "\n", "x", "=", "self", ".", "pooling2", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "pooling2", "(", "*", "x", ")", "\n", "\n", "# Layer 3", "\n", "x", "=", "self", ".", "padding2", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "dropout", "(", "*", "self", ".", "ReLU", "(", "*", "self", ".", "conv3", "(", "*", "x", ")", ")", ")", "\n", "x", "=", "self", ".", "batchnorm3", "(", "*", "x", ")", "\n", "x", "=", "self", ".", "pooling3", "(", "*", "x", ")", "\n", "\n", "x_mean", "=", "x", "[", "0", "]", ".", "view", "(", "-", "1", ",", "4", "*", "2", "*", "25", ")", "\n", "x_var", "=", "x", "[", "1", "]", ".", "view", "(", "-", "1", ",", "4", "*", "2", "*", "25", ")", "\n", "x", "=", "x_mean", ",", "x_var", "\n", "x", "=", "self", ".", "linear", "(", "*", "x", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models_adf.eegnet_dropout_adf.keep_variance": [[18, 20], ["None"], "function", ["None"], ["def", "keep_variance", "(", "x", ",", "min_variance", ")", ":", "\n", "    ", "return", "x", "+", "min_variance", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet.EEGNet.__init__": [[20, 40], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "print", "print"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "mtl", "=", "True", ")", ":", "\n", "        ", "super", "(", "EEGNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "Conv2d", "=", "nn", ".", "Conv2d", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "1", ",", "16", ",", "(", "1", ",", "22", ")", ",", "padding", "=", "0", ")", "\n", "self", ".", "batchnorm1", "=", "nn", ".", "BatchNorm2d", "(", "16", ",", "False", ")", "\n", "# Layer 2", "\n", "self", ".", "padding1", "=", "nn", ".", "ZeroPad2d", "(", "(", "16", ",", "17", ",", "0", ",", "1", ")", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "1", ",", "4", ",", "(", "2", ",", "32", ")", ")", "\n", "self", ".", "batchnorm2", "=", "nn", ".", "BatchNorm2d", "(", "4", ",", "False", ")", "\n", "self", ".", "pooling2", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ")", "\n", "\n", "# Layer 3", "\n", "self", ".", "padding2", "=", "nn", ".", "ZeroPad2d", "(", "(", "2", ",", "1", ",", "4", ",", "3", ")", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "4", ",", "4", ",", "(", "8", ",", "4", ")", ")", "\n", "self", ".", "batchnorm3", "=", "nn", ".", "BatchNorm2d", "(", "4", ",", "False", ")", "\n", "self", ".", "pooling3", "=", "nn", ".", "MaxPool2d", "(", "(", "2", ",", "4", ")", ")", "\n", "self", ".", "linear", "=", "nn", ".", "Linear", "(", "4", "*", "2", "*", "25", ",", "4", ")", "\n", "\n", "print", "(", "\"test mtl\"", ")", "\n", "print", "(", "mtl", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet.EEGNet.forward": [[41, 62], ["torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "eegnet.EEGNet.batchnorm1", "eegnet.EEGNet.permute", "eegnet.EEGNet.padding1", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "eegnet.EEGNet.batchnorm2", "eegnet.EEGNet.pooling2", "eegnet.EEGNet.padding2", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "eegnet.EEGNet.batchnorm3", "eegnet.EEGNet.pooling3", "eegnet.EEGNet.view", "eegnet.EEGNet.linear", "eegnet.EEGNet.conv1", "eegnet.EEGNet.conv2", "eegnet.EEGNet.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "F", ".", "relu", "(", "self", ".", "conv1", "(", "x", ")", ")", "\n", "x", "=", "self", ".", "batchnorm1", "(", "x", ")", "\n", "x", "=", "x", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "\n", "# Layer 2", "\n", "x", "=", "self", ".", "padding1", "(", "x", ")", "\n", "x", "=", "F", ".", "relu", "(", "self", ".", "conv2", "(", "x", ")", ")", "\n", "x", "=", "self", ".", "batchnorm2", "(", "x", ")", "\n", "x", "=", "self", ".", "pooling2", "(", "x", ")", "\n", "\n", "# Layer 3", "\n", "x", "=", "self", ".", "padding2", "(", "x", ")", "\n", "x", "=", "F", ".", "relu", "(", "self", ".", "conv3", "(", "x", ")", ")", "\n", "x", "=", "self", ".", "batchnorm3", "(", "x", ")", "\n", "x", "=", "self", ".", "pooling3", "(", "x", ")", "\n", "\n", "x", "=", "x", ".", "view", "(", "-", "1", ",", "4", "*", "2", "*", "25", ")", "\n", "x", "=", "self", ".", "linear", "(", "x", ")", "\n", "\n", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__": [[20, 38], ["torch.Module.__init__", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.ZeroPad2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Linear", "torch.Dropout2d", "torch.Dropout2d", "torch.Dropout2d", "torch.Dropout2d", "torch.Dropout2d", "torch.Dropout2d"], "methods", ["home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.__init__"], ["    ", "def", "__init__", "(", "self", ",", "p", "=", "0.2", ")", ":", "\n", "        ", "super", "(", "EEGNet_Dropout", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "Conv2d", "=", "nn", ".", "Conv2d", "\n", "self", ".", "conv1", "=", "nn", ".", "Conv2d", "(", "1", ",", "16", ",", "(", "1", ",", "22", ")", ",", "padding", "=", "0", ")", "\n", "self", ".", "batchnorm1", "=", "nn", ".", "BatchNorm2d", "(", "16", ",", "False", ")", "\n", "# Layer 2", "\n", "self", ".", "padding1", "=", "nn", ".", "ZeroPad2d", "(", "(", "16", ",", "17", ",", "0", ",", "1", ")", ")", "\n", "self", ".", "conv2", "=", "nn", ".", "Conv2d", "(", "1", ",", "4", ",", "(", "2", ",", "32", ")", ")", "\n", "self", ".", "batchnorm2", "=", "nn", ".", "BatchNorm2d", "(", "4", ",", "False", ")", "\n", "self", ".", "pooling2", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ")", "\n", "\n", "# Layer 3", "\n", "self", ".", "padding2", "=", "nn", ".", "ZeroPad2d", "(", "(", "2", ",", "1", ",", "4", ",", "3", ")", ")", "\n", "self", ".", "conv3", "=", "nn", ".", "Conv2d", "(", "4", ",", "4", ",", "(", "8", ",", "4", ")", ")", "\n", "self", ".", "batchnorm3", "=", "nn", ".", "BatchNorm2d", "(", "4", ",", "False", ")", "\n", "self", ".", "pooling3", "=", "nn", ".", "MaxPool2d", "(", "(", "2", ",", "4", ")", ")", "\n", "self", ".", "linear", "=", "nn", ".", "Linear", "(", "4", "*", "2", "*", "25", ",", "4", ")", "\n", "self", ".", "dropout", "=", "nn", ".", "Dropout2d", "(", "p", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.tiehangd_ue-eeg.models.eegnet_dropout.EEGNet_Dropout.forward": [[39, 57], ["eegnet_dropout.EEGNet_Dropout.dropout", "eegnet_dropout.EEGNet_Dropout.batchnorm1", "eegnet_dropout.EEGNet_Dropout.permute", "eegnet_dropout.EEGNet_Dropout.padding1", "eegnet_dropout.EEGNet_Dropout.dropout", "eegnet_dropout.EEGNet_Dropout.batchnorm2", "eegnet_dropout.EEGNet_Dropout.pooling2", "eegnet_dropout.EEGNet_Dropout.padding2", "eegnet_dropout.EEGNet_Dropout.dropout", "eegnet_dropout.EEGNet_Dropout.batchnorm3", "eegnet_dropout.EEGNet_Dropout.pooling3", "eegnet_dropout.EEGNet_Dropout.view", "eegnet_dropout.EEGNet_Dropout.linear", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "torch.relu", "eegnet_dropout.EEGNet_Dropout.conv1", "eegnet_dropout.EEGNet_Dropout.conv2", "eegnet_dropout.EEGNet_Dropout.conv3"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "x", "=", "self", ".", "dropout", "(", "F", ".", "relu", "(", "self", ".", "conv1", "(", "x", ")", ")", ")", "\n", "x", "=", "self", ".", "batchnorm1", "(", "x", ")", "\n", "x", "=", "x", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "# Layer 2", "\n", "x", "=", "self", ".", "padding1", "(", "x", ")", "\n", "x", "=", "self", ".", "dropout", "(", "F", ".", "relu", "(", "self", ".", "conv2", "(", "x", ")", ")", ")", "\n", "x", "=", "self", ".", "batchnorm2", "(", "x", ")", "\n", "x", "=", "self", ".", "pooling2", "(", "x", ")", "\n", "# Layer 3", "\n", "x", "=", "self", ".", "padding2", "(", "x", ")", "\n", "x", "=", "self", ".", "dropout", "(", "F", ".", "relu", "(", "self", ".", "conv3", "(", "x", ")", ")", ")", "\n", "x", "=", "self", ".", "batchnorm3", "(", "x", ")", "\n", "x", "=", "self", ".", "pooling3", "(", "x", ")", "\n", "x", "=", "x", ".", "view", "(", "-", "1", ",", "4", "*", "2", "*", "25", ")", "\n", "x", "=", "self", ".", "linear", "(", "x", ")", "\n", "\n", "return", "x", "\n", "\n"]]}