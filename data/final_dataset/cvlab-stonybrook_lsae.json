{"home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.get_N": [[32, 43], ["numpy.zeros"], "function", ["None"], ["def", "get_N", "(", "W", ",", "H", ")", ":", "\n", "    ", "\"\"\"N that maps from unnormalized to normalized coordinates\"\"\"", "\n", "N", "=", "np", ".", "zeros", "(", "(", "3", ",", "3", ")", ",", "dtype", "=", "np", ".", "float64", ")", "\n", "N", "[", "0", ",", "0", "]", "=", "2.0", "/", "W", "\n", "N", "[", "0", ",", "1", "]", "=", "0", "\n", "N", "[", "1", ",", "1", "]", "=", "2.0", "/", "H", "\n", "N", "[", "1", ",", "0", "]", "=", "0", "\n", "N", "[", "0", ",", "-", "1", "]", "=", "-", "1.0", "\n", "N", "[", "1", ",", "-", "1", "]", "=", "-", "1.0", "\n", "N", "[", "-", "1", ",", "-", "1", "]", "=", "1.0", "\n", "return", "N", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.get_N_inv": [[45, 50], ["train_lsae.get_N", "numpy.linalg.inv"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.get_N"], ["", "def", "get_N_inv", "(", "W", ",", "H", ")", ":", "\n", "    ", "\"\"\"N that maps from normalized to unnormalized coordinates\"\"\"", "\n", "# TODO: do this analytically maybe?", "\n", "N", "=", "get_N", "(", "W", ",", "H", ")", "\n", "return", "np", ".", "linalg", ".", "inv", "(", "N", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.cvt_MToTheta": [[51, 77], ["numpy.concatenate", "train_lsae.get_N", "train_lsae.get_N_inv", "numpy.linalg.inv", "numpy.zeros"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.get_N", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.get_N_inv"], ["", "def", "cvt_MToTheta", "(", "M", ",", "w", ",", "h", ")", ":", "\n", "    ", "\"\"\"convert affine warp matrix `M` compatible with `opencv.warpAffine` to `theta` matrix\n    compatible with `torch.F.affine_grid`\n    Note:\n    M works with `opencv.warpAffine`.\n    To transform a set of bounding box corner points using `opencv.perspectiveTransform`, M^-1 is required\n    Parameters\n    ----------\n    M : np.ndarray\n        affine warp matrix shaped [2, 3]\n    w : int\n        width of image\n    h : int\n        height of image\n    Returns\n    -------\n    np.ndarray\n        theta tensor for `torch.F.affine_grid`, shaped [2, 3]\n    \"\"\"", "\n", "M_aug", "=", "np", ".", "concatenate", "(", "[", "M", ",", "np", ".", "zeros", "(", "(", "1", ",", "3", ")", ")", "]", ",", "axis", "=", "0", ")", "\n", "M_aug", "[", "-", "1", ",", "-", "1", "]", "=", "1.0", "\n", "N", "=", "get_N", "(", "w", ",", "h", ")", "\n", "N_inv", "=", "get_N_inv", "(", "w", ",", "h", ")", "\n", "theta", "=", "N", "@", "M_aug", "@", "N_inv", "\n", "theta", "=", "np", ".", "linalg", ".", "inv", "(", "theta", ")", "\n", "return", "theta", "[", ":", "2", ",", ":", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.data_sampler": [[78, 87], ["torch.utils.data.distributed.DistributedSampler", "torch.utils.data.RandomSampler", "torch.utils.data.SequentialSampler"], "function", ["None"], ["", "def", "data_sampler", "(", "dataset", ",", "shuffle", ",", "distributed", ")", ":", "\n", "    ", "if", "distributed", ":", "\n", "        ", "return", "data", ".", "distributed", ".", "DistributedSampler", "(", "dataset", ",", "shuffle", "=", "shuffle", ")", "\n", "\n", "", "if", "shuffle", ":", "\n", "        ", "return", "data", ".", "RandomSampler", "(", "dataset", ")", "\n", "\n", "", "else", ":", "\n", "        ", "return", "data", ".", "SequentialSampler", "(", "dataset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.requires_grad": [[89, 92], ["model.parameters"], "function", ["None"], ["", "", "def", "requires_grad", "(", "model", ",", "flag", "=", "True", ")", ":", "\n", "    ", "for", "p", "in", "model", ".", "parameters", "(", ")", ":", "\n", "        ", "p", ".", "requires_grad", "=", "flag", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.accumulate": [[94, 100], ["dict", "dict", "dict.keys", "model1.named_parameters", "model2.named_parameters", "par1[].data.mul_().add_", "par1[].data.mul_"], "function", ["None"], ["", "", "def", "accumulate", "(", "model1", ",", "model2", ",", "decay", "=", "0.999", ")", ":", "\n", "    ", "par1", "=", "dict", "(", "model1", ".", "named_parameters", "(", ")", ")", "\n", "par2", "=", "dict", "(", "model2", ".", "named_parameters", "(", ")", ")", "\n", "\n", "for", "k", "in", "par1", ".", "keys", "(", ")", ":", "\n", "        ", "par1", "[", "k", "]", ".", "data", ".", "mul_", "(", "decay", ")", ".", "add_", "(", "par2", "[", "k", "]", ".", "data", ",", "alpha", "=", "1", "-", "decay", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.sample_data": [[102, 106], ["None"], "function", ["None"], ["", "", "def", "sample_data", "(", "loader", ")", ":", "\n", "    ", "while", "True", ":", "\n", "        ", "for", "batch", "in", "loader", ":", "\n", "            ", "yield", "batch", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.d_logistic_loss": [[108, 113], ["torch.nn.functional.softplus", "torch.nn.functional.softplus", "F.softplus.mean", "F.softplus.mean"], "function", ["None"], ["", "", "", "def", "d_logistic_loss", "(", "real_pred", ",", "fake_pred", ")", ":", "\n", "    ", "real_loss", "=", "F", ".", "softplus", "(", "-", "real_pred", ")", "\n", "fake_loss", "=", "F", ".", "softplus", "(", "fake_pred", ")", "\n", "\n", "return", "real_loss", ".", "mean", "(", ")", "+", "fake_loss", ".", "mean", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.d_r1_loss": [[115, 125], ["torch.autograd.grad", "grad_real_list[].pow().reshape().sum().mean", "len", "real_pred.sum", "grad_real_list[].pow().reshape().sum", "grad_real.pow().reshape().sum().mean", "grad_real_list[].pow().reshape", "grad_real.pow().reshape().sum", "grad_real_list[].pow", "grad_real.pow().reshape", "grad_real.pow"], "function", ["None"], ["", "def", "d_r1_loss", "(", "real_pred", ",", "real_img", ")", ":", "\n", "    ", "grad_real_list", "=", "autograd", ".", "grad", "(", "\n", "outputs", "=", "real_pred", ".", "sum", "(", ")", ",", "inputs", "=", "real_img", ",", "create_graph", "=", "True", "\n", ")", "\n", "grad_penalty", "=", "grad_real_list", "[", "0", "]", ".", "pow", "(", "2", ")", ".", "reshape", "(", "grad_real_list", "[", "0", "]", ".", "shape", "[", "0", "]", ",", "-", "1", ")", ".", "sum", "(", "1", ")", ".", "mean", "(", ")", "\n", "if", "len", "(", "grad_real_list", ")", ">", "1", ":", "\n", "        ", "for", "grad_real", "in", "grad_real_list", "[", "1", ":", "]", ":", "\n", "            ", "grad_penalty", "+=", "grad_real", ".", "pow", "(", "2", ")", ".", "reshape", "(", "grad_real", ".", "shape", "[", "0", "]", ",", "-", "1", ")", ".", "sum", "(", "1", ")", ".", "mean", "(", ")", "\n", "\n", "", "", "return", "grad_penalty", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.g_nonsaturating_loss": [[127, 131], ["torch.nn.functional.softplus().mean", "torch.nn.functional.softplus"], "function", ["None"], ["", "def", "g_nonsaturating_loss", "(", "fake_pred", ")", ":", "\n", "    ", "loss", "=", "F", ".", "softplus", "(", "-", "fake_pred", ")", ".", "mean", "(", ")", "\n", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.set_grad_none": [[133, 137], ["model.named_parameters"], "function", ["None"], ["", "def", "set_grad_none", "(", "model", ",", "targets", ")", ":", "\n", "    ", "for", "n", ",", "p", "in", "model", ".", "named_parameters", "(", ")", ":", "\n", "        ", "if", "n", "in", "targets", ":", "\n", "            ", "p", ".", "grad", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.differential_crop_w_random_rotation": [[138, 159], ["range", "torch.stack().to", "torch.stack().to", "torch.nn.functional.affine_grid", "torch.nn.functional.grid_sample", "random.uniform", "cv2.getRotationMatrix2D", "train_lsae.cvt_MToTheta", "torch.stack().to.append", "image.size", "F.affine_grid.float", "math.cos", "torch.from_numpy", "torch.from_numpy", "torch.stack", "torch.stack", "math.sin", "abs", "abs"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.affine_grid", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.cvt_MToTheta"], ["", "", "", "def", "differential_crop_w_random_rotation", "(", "image", ",", "max_angle", ")", ":", "\n", "    ", "\"\"\"\n    max_angle defines the maximum rotation angles from [-max_angle, max_angle]\n    \"\"\"", "\n", "thetas", "=", "[", "]", "\n", "N", ",", "D", ",", "H", ",", "W", "=", "image", ".", "shape", "\n", "for", "i", "in", "range", "(", "N", ")", ":", "\n", "        ", "angle", "=", "random", ".", "uniform", "(", "-", "max_angle", ",", "max_angle", ")", "\n", "# angle = 60", "\n", "center", "=", "(", "W", "//", "2", ",", "H", "//", "2", ")", "\n", "scale", "=", "math", ".", "cos", "(", "math", ".", "pi", "*", "abs", "(", "angle", ")", "/", "180", ")", "+", "math", ".", "sin", "(", "math", ".", "pi", "*", "abs", "(", "angle", ")", "/", "180", ")", "*", "H", "/", "W", "\n", "# scale = 1.6", "\n", "# print(scale)", "\n", "affine_trans", "=", "cv2", ".", "getRotationMatrix2D", "(", "center", ",", "angle", ",", "scale", ")", "\n", "theta", "=", "cvt_MToTheta", "(", "affine_trans", ",", "W", ",", "H", ")", "\n", "thetas", ".", "append", "(", "torch", ".", "from_numpy", "(", "theta", ")", ")", "\n", "", "thetas", "=", "torch", ".", "stack", "(", "thetas", ")", ".", "to", "(", "image", ".", "device", ")", "\n", "grid", "=", "F", ".", "affine_grid", "(", "thetas", ",", "image", ".", "size", "(", ")", ",", "align_corners", "=", "False", ")", "\n", "rotated", "=", "F", ".", "grid_sample", "(", "image", ",", "grid", ".", "float", "(", ")", ",", "align_corners", "=", "False", ")", "\n", "\n", "return", "rotated", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.raw_patchify_image": [[160, 215], ["torch.zeros", "torch.zeros", "mask.squeeze.squeeze", "int", "int", "int", "int", "range", "torch.cat", "torch.cat", "train_lsae.differential_crop_w_random_rotation", "torch.nonzero", "torch.nonzero", "range", "torch.rand", "torch.rand", "torch.nonzero.size", "torch.nonzero", "torch.nonzero", "random.randrange", "indices[].tolist", "train_lsae.raw_patchify_image.compute_corner"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.differential_crop_w_random_rotation"], ["", "def", "raw_patchify_image", "(", "img", ",", "n_crop", ",", "mask", "=", "None", ",", "min_size", "=", "1", "/", "16", ",", "max_size", "=", "1", "/", "8", ",", "max_angle", "=", "60", ")", ":", "\n", "    ", "batch", ",", "channel", ",", "height", ",", "width", "=", "img", ".", "shape", "\n", "\n", "def", "compute_corner", "(", "cent_x", ",", "cent_y", ",", "c_w", ",", "c_h", ")", ":", "\n", "        ", "c_x", "=", "cent_x", "-", "c_w", "//", "2", "\n", "c_y", "=", "cent_y", "-", "c_h", "//", "2", "\n", "return", "c_x", ",", "c_y", "\n", "\n", "", "default_mask", "=", "torch", ".", "zeros", "(", "batch", ",", "height", ",", "width", ")", "\n", "default_mask", "[", ":", ",", "height", "//", "4", ":", "3", "*", "height", "//", "4", ",", "width", "//", "4", ":", "3", "*", "width", "//", "4", "]", "=", "1", "\n", "\n", "if", "mask", "is", "None", ":", "\n", "        ", "mask", "=", "default_mask", "\n", "", "mask", "=", "mask", ".", "squeeze", "(", ")", "\n", "\n", "crop_size", "=", "torch", ".", "rand", "(", "batch", ",", "n_crop", ")", "*", "(", "max_size", "-", "min_size", ")", "+", "min_size", "\n", "target_h", "=", "int", "(", "height", "*", "max_size", ")", "\n", "target_w", "=", "int", "(", "width", "*", "max_size", ")", "\n", "crop_h", "=", "(", "crop_size", "*", "height", ")", ".", "type", "(", "torch", ".", "int64", ")", ".", "tolist", "(", ")", "\n", "crop_w", "=", "(", "crop_size", "*", "width", ")", ".", "type", "(", "torch", ".", "int64", ")", ".", "tolist", "(", ")", "\n", "min_h", "=", "int", "(", "height", "*", "min_size", ")", "\n", "min_w", "=", "int", "(", "width", "*", "min_size", ")", "\n", "\n", "patches", "=", "[", "]", "\n", "for", "b", "in", "range", "(", "batch", ")", ":", "\n", "        ", "indices", "=", "torch", ".", "nonzero", "(", "mask", "[", "b", "]", ")", "# [height, width]", "\n", "if", "indices", ".", "size", "(", "0", ")", "==", "0", ":", "\n", "            ", "indices", "=", "torch", ".", "nonzero", "(", "default_mask", "[", "b", "]", ")", "\n", "", "for", "_", "in", "range", "(", "n_crop", ")", ":", "\n", "# random sample origin", "\n", "            ", "ind", "=", "random", ".", "randrange", "(", "0", ",", "indices", ".", "size", "(", "0", ")", ")", "\n", "cent_y", ",", "cent_x", "=", "indices", "[", "ind", "]", ".", "tolist", "(", ")", "\n", "# random sample crop size", "\n", "crop_ratio", "=", "random", ".", "uniform", "(", "0", ",", "1", ")", "*", "(", "max_size", "-", "min_size", ")", "+", "min_size", "\n", "c_h", ",", "c_w", "=", "int", "(", "height", "*", "crop_ratio", ")", ",", "int", "(", "width", "*", "crop_ratio", ")", "\n", "# recompute corners and area", "\n", "c_x", ",", "c_y", "=", "compute_corner", "(", "cent_x", ",", "cent_y", ",", "c_w", ",", "c_h", ")", "\n", "# clip the coordinates", "\n", "if", "c_y", "<", "0", ":", "\n", "                ", "c_y", "=", "0", "\n", "", "if", "c_x", "<", "0", ":", "\n", "                ", "c_x", "=", "0", "\n", "", "if", "c_y", "+", "c_h", ">=", "height", ":", "\n", "                ", "c_y", "=", "height", "-", "c_h", "-", "1", "\n", "", "if", "c_x", "+", "c_w", ">=", "width", ":", "\n", "                ", "c_x", "=", "width", "-", "c_w", "-", "1", "\n", "\n", "", "init_patch", "=", "img", "[", "b", ",", ":", ",", "c_y", ":", "c_y", "+", "c_h", ",", "c_x", ":", "c_x", "+", "c_w", "]", ".", "view", "(", "1", ",", "channel", ",", "c_h", ",", "c_w", ")", "\n", "intp_patch", "=", "F", ".", "interpolate", "(", "init_patch", ",", "size", "=", "(", "target_h", ",", "target_w", ")", ",", "mode", "=", "\"bilinear\"", ",", "align_corners", "=", "False", ")", "\n", "patches", ".", "append", "(", "intp_patch", ")", "\n", "# patches shape: [batch*n_crop, channel, target_h, target_w]", "\n", "", "", "patches", "=", "torch", ".", "cat", "(", "patches", ",", "dim", "=", "0", ")", "\n", "rotated", "=", "differential_crop_w_random_rotation", "(", "patches", ",", "max_angle", ")", "\n", "\n", "return", "rotated", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.sample_patches": [[216, 266], ["feat_list[].size", "enumerate", "mask.squeeze.squeeze", "channels.append", "spt_dims.append", "range", "range", "torch.stack", "torch.stack", "scale_feats.append", "feat.size", "feat.size", "torch.nonzero", "torch.nonzero", "range", "batch_coords.append", "range", "torch.nonzero.size", "torch.nonzero", "torch.nonzero", "random.randrange", "indices[].tolist", "normed_coords.append", "torch.stack.append", "torch.ones", "torch.ones", "torch.nonzero.size", "min", "min", "int", "int"], "function", ["None"], ["", "def", "sample_patches", "(", "feat_list", ",", "n_crop", ",", "mask", "=", "None", ",", "coords", "=", "None", ",", "inv", "=", "False", ")", ":", "\n", "    ", "if", "inv", "and", "mask", "is", "not", "None", ":", "\n", "        ", "mask", "=", "1", "-", "mask", "\n", "", "if", "mask", "is", "not", "None", ":", "\n", "        ", "mask", "=", "mask", ".", "squeeze", "(", ")", "\n", "\n", "\n", "# collect info", "\n", "", "batchSize", "=", "feat_list", "[", "0", "]", ".", "size", "(", "0", ")", "\n", "channels", "=", "[", "]", "\n", "spt_dims", "=", "[", "]", "\n", "for", "feat", "in", "feat_list", ":", "\n", "        ", "assert", "(", "feat", ".", "size", "(", "0", ")", "==", "batchSize", ")", ",", "\"Batch size of features should be consistent\"", "\n", "channels", ".", "append", "(", "feat", ".", "size", "(", "1", ")", ")", "\n", "spt_dims", ".", "append", "(", "feat", ".", "shape", "[", "2", ":", "]", ")", "\n", "\n", "", "if", "coords", "is", "None", ":", "\n", "# sample coords from mask", "\n", "        ", "batch_coords", "=", "[", "]", "\n", "for", "b", "in", "range", "(", "batchSize", ")", ":", "\n", "# height and width of mask", "\n", "            ", "h", ",", "w", "=", "mask", "[", "b", "]", ".", "shape", "\n", "# get valid candidates from mask", "\n", "indices", "=", "torch", ".", "nonzero", "(", "mask", "[", "b", "]", ")", "\n", "if", "indices", ".", "size", "(", "0", ")", "==", "0", ":", "\n", "                ", "indices", "=", "torch", ".", "nonzero", "(", "torch", ".", "ones", "(", "h", ",", "w", ")", ")", "\n", "# sample points", "\n", "", "normed_coords", "=", "[", "]", "\n", "for", "_", "in", "range", "(", "n_crop", ")", ":", "\n", "                ", "ind", "=", "random", ".", "randrange", "(", "0", ",", "indices", ".", "size", "(", "0", ")", ")", "\n", "cent_y", ",", "cent_x", "=", "indices", "[", "ind", "]", ".", "tolist", "(", ")", "\n", "normed_coords", ".", "append", "(", "(", "cent_y", "/", "h", ",", "cent_x", "/", "w", ")", ")", "\n", "", "batch_coords", ".", "append", "(", "normed_coords", ")", "\n", "", "", "else", ":", "\n", "        ", "batch_coords", "=", "coords", "\n", "\n", "# extract features according to sampled points", "\n", "", "scale_feats", "=", "[", "]", "\n", "for", "i", ",", "feat", "in", "enumerate", "(", "feat_list", ")", ":", "\n", "        ", "h", ",", "w", "=", "spt_dims", "[", "i", "]", "\n", "sampled_feats", "=", "[", "]", "\n", "for", "b", "in", "range", "(", "batchSize", ")", ":", "\n", "            ", "for", "j", "in", "range", "(", "n_crop", ")", ":", "\n", "                ", "cent_y", ",", "cent_x", "=", "min", "(", "h", "-", "1", ",", "int", "(", "batch_coords", "[", "b", "]", "[", "j", "]", "[", "0", "]", "*", "h", ")", ")", ",", "min", "(", "w", "-", "1", ",", "int", "(", "batch_coords", "[", "b", "]", "[", "j", "]", "[", "1", "]", "*", "w", ")", ")", "\n", "sampled_feats", ".", "append", "(", "feat", "[", "b", ",", ":", ",", "cent_y", ",", "cent_x", "]", ")", "\n", "# [batchSize*n_crop, channel]", "\n", "", "", "sampled_feats", "=", "torch", ".", "stack", "(", "sampled_feats", ",", "dim", "=", "0", ")", "\n", "scale_feats", ".", "append", "(", "sampled_feats", ")", "\n", "\n", "", "return", "scale_feats", ",", "batch_coords", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.train": [[267, 535], ["functools.partial", "train_lsae.sample_data", "train_lsae.sample_data", "model.PatchNCELoss", "range", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "stylegan2.distributed.get_rank", "tqdm.tqdm", "os.path.exists", "os.makedirs", "os.path.exists", "os.makedirs", "next", "real_img.to.to", "train_lsae.requires_grad", "train_lsae.requires_grad", "train_lsae.requires_grad", "train_lsae.requires_grad", "train_lsae.requires_grad", "real_img.to.chunk", "real_msk.chunk", "encoder", "encoder", "generator", "generator", "discriminator", "discriminator", "train_lsae.d_logistic_loss", "functools.partial.", "functools.partial.", "functools.partial.", "cooccur", "cooccur", "train_lsae.d_logistic_loss", "d_optim.zero_grad", "d_optim.step", "train_lsae.requires_grad", "train_lsae.requires_grad", "train_lsae.requires_grad", "train_lsae.requires_grad", "train_lsae.requires_grad", "encoder", "encoder", "generator", "generator", "torch.nn.functional.l1_loss", "discriminator", "train_lsae.g_nonsaturating_loss", "functools.partial.", "functools.partial.", "cooccur", "train_lsae.g_nonsaturating_loss", "encoder", "train_lsae.sample_patches", "train_lsae.sample_patches", "str_projectors", "str_projectors", "len", "zip", "g_optim.zero_grad", "g_optim.step", "train_lsae.accumulate", "train_lsae.accumulate", "stylegan2.distributed.reduce_loss_dict", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "print", "torch.cat", "torch.cat", "discriminator", "train_lsae.d_r1_loss", "cooccur", "train_lsae.d_r1_loss", "d_optim.zero_grad", "r1_loss_sum.backward", "d_optim.step", "real_img1.detach", "torch.cat", "torch.cat", "stylegan2.distributed.get_rank", "tqdm.tqdm.set_description", "model.PatchNCELoss.", "torch.nn.functional.mse_loss", "torch.nn.functional.mse_loss", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "wandb.log", "torch.save", "torch.save", "structure1.detach", "texture2.detach", "torch.no_grad", "torch.no_grad", "next", "real_img.to.to", "real_img.to.chunk", "e_ema.eval", "g_ema.eval", "e_ema", "e_ema", "g_ema", "g_ema", "torch.cat", "torch.cat", "torchvision.utils.save_image", "e_module.state_dict", "g_module.state_dict", "s_module.state_dict", "d_module.state_dict", "c_module.state_dict", "e_ema.state_dict", "g_ema.state_dict", "g_optim.state_dict", "d_optim.state_dict", "str().zfill", "str().zfill", "str", "str"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.sample_data", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.sample_data", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_rank", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_logistic_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_logistic_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.g_nonsaturating_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.g_nonsaturating_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.sample_patches", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_lsae.sample_patches", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.accumulate", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.accumulate", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_r1_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_r1_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.backward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_rank", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save"], ["", "def", "train", "(", "\n", "args", ",", "\n", "loaders", ",", "\n", "encoder", ",", "\n", "generator", ",", "\n", "str_projectors", ",", "\n", "discriminator", ",", "\n", "cooccur", ",", "\n", "g_optim", ",", "\n", "d_optim", ",", "\n", "e_ema", ",", "\n", "g_ema", ",", "\n", "device", ",", "\n", ")", ":", "\n", "    ", "patchify_image", "=", "partial", "(", "raw_patchify_image", ",", "min_size", "=", "args", ".", "min_patch", ",", "max_size", "=", "args", ".", "max_patch", ")", "\n", "\n", "loader", "=", "sample_data", "(", "loaders", "[", "0", "]", ")", "\n", "ts_loader", "=", "sample_data", "(", "loaders", "[", "1", "]", ")", "\n", "\n", "patchnce_loss", "=", "PatchNCELoss", "(", "nce_T", "=", "0.07", ",", "batch", "=", "args", ".", "batch", "//", "2", ")", "\n", "\n", "pbar", "=", "range", "(", "args", ".", "iter", ")", "\n", "\n", "if", "get_rank", "(", ")", "==", "0", ":", "\n", "        ", "pbar", "=", "tqdm", "(", "pbar", ",", "initial", "=", "args", ".", "start_iter", ",", "dynamic_ncols", "=", "True", ",", "smoothing", "=", "0.01", ")", "\n", "\n", "", "d_loss_val", "=", "0", "\n", "r1_loss", "=", "torch", ".", "tensor", "(", "0.0", ",", "device", "=", "device", ")", "\n", "cooccur_r1_loss", "=", "torch", ".", "tensor", "(", "0.0", ",", "device", "=", "device", ")", "\n", "feat_recon_loss", "=", "torch", ".", "tensor", "(", "0.0", ",", "device", "=", "device", ")", "\n", "g_loss_val", "=", "0", "\n", "loss_dict", "=", "{", "}", "\n", "\n", "# create output folders", "\n", "if", "args", ".", "proj_name", "!=", "\"\"", ":", "\n", "        ", "sample_dir", "=", "f\"outputs/sample-{args.proj_name}\"", "\n", "ckpt_dir", "=", "f\"outputs/ckpt-{args.proj_name}\"", "\n", "", "else", ":", "\n", "        ", "sample_dir", "=", "\"outputs/sample\"", "\n", "ckpt_dir", "=", "\"outputs/ckpt\"", "\n", "", "if", "not", "os", ".", "path", ".", "exists", "(", "sample_dir", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "sample_dir", ")", "\n", "", "if", "not", "os", ".", "path", ".", "exists", "(", "ckpt_dir", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "ckpt_dir", ")", "\n", "\n", "", "if", "args", ".", "distributed", ":", "\n", "        ", "e_module", "=", "encoder", ".", "module", "\n", "g_module", "=", "generator", ".", "module", "\n", "s_module", "=", "str_projectors", ".", "module", "\n", "d_module", "=", "discriminator", ".", "module", "\n", "c_module", "=", "cooccur", ".", "module", "\n", "\n", "", "else", ":", "\n", "        ", "e_module", "=", "encoder", "\n", "g_module", "=", "generator", "\n", "s_module", "=", "str_projectors", "\n", "d_module", "=", "discriminator", "\n", "c_module", "=", "cooccur", "\n", "\n", "", "accum", "=", "0.5", "**", "(", "32", "/", "(", "10", "*", "1000", ")", ")", "\n", "\n", "for", "idx", "in", "pbar", ":", "\n", "        ", "i", "=", "idx", "+", "args", ".", "start_iter", "\n", "\n", "if", "i", ">", "args", ".", "iter", ":", "\n", "            ", "print", "(", "\"Done!\"", ")", "\n", "\n", "break", "\n", "\n", "", "real_img", ",", "real_msk", ",", "_", "=", "next", "(", "loader", ")", "\n", "real_img", "=", "real_img", ".", "to", "(", "device", ")", "\n", "\n", "requires_grad", "(", "encoder", ",", "False", ")", "\n", "requires_grad", "(", "generator", ",", "False", ")", "\n", "requires_grad", "(", "str_projectors", ",", "False", ")", "\n", "requires_grad", "(", "discriminator", ",", "True", ")", "\n", "requires_grad", "(", "cooccur", ",", "True", ")", "\n", "\n", "real_img1", ",", "real_img2", "=", "real_img", ".", "chunk", "(", "2", ",", "dim", "=", "0", ")", "\n", "real_msk1", ",", "real_msk2", "=", "real_msk", ".", "chunk", "(", "2", ",", "dim", "=", "0", ")", "\n", "\n", "structure1", ",", "texture1", "=", "encoder", "(", "real_img1", ",", "multi_tex", "=", "False", ")", "\n", "_", ",", "texture2", "=", "encoder", "(", "real_img2", ",", "run_str", "=", "False", ",", "multi_tex", "=", "False", ")", "\n", "\n", "# image adversarial loss", "\n", "fake_img1", "=", "generator", "(", "structure1", ",", "texture1", ")", "\n", "fake_img2", "=", "generator", "(", "structure1", ",", "texture2", ")", "\n", "fake_pred", "=", "discriminator", "(", "torch", ".", "cat", "(", "(", "fake_img1", ",", "fake_img2", ")", ",", "0", ")", ")", "\n", "real_pred", "=", "discriminator", "(", "real_img", ")", "\n", "d_loss", "=", "d_logistic_loss", "(", "real_pred", ",", "fake_pred", ")", "\n", "\n", "# texture adversarial loss", "\n", "fake_patch", "=", "patchify_image", "(", "fake_img2", ",", "args", ".", "n_crop", ",", "mask", "=", "real_msk1", ")", "\n", "real_patch", "=", "patchify_image", "(", "real_img2", ",", "args", ".", "n_crop", ",", "mask", "=", "real_msk2", ")", "\n", "ref_patch", "=", "patchify_image", "(", "real_img2", ",", "args", ".", "ref_crop", "*", "args", ".", "n_crop", ",", "mask", "=", "real_msk2", ")", "\n", "fake_patch_pred", ",", "ref_input", "=", "cooccur", "(", "\n", "fake_patch", ",", "args", ".", "n_crop", ",", "reference", "=", "ref_patch", ",", "ref_batch", "=", "args", ".", "ref_crop", "\n", ")", "\n", "real_patch_pred", ",", "_", "=", "cooccur", "(", "real_patch", ",", "args", ".", "n_crop", ",", "ref_input", "=", "ref_input", ")", "\n", "cooccur_loss", "=", "d_logistic_loss", "(", "real_patch_pred", ",", "fake_patch_pred", ")", "\n", "\n", "loss_dict", "[", "\"d\"", "]", "=", "d_loss", "\n", "loss_dict", "[", "\"cooccur\"", "]", "=", "cooccur_loss", "\n", "\n", "d_optim", ".", "zero_grad", "(", ")", "\n", "(", "d_loss", "+", "cooccur_loss", ")", ".", "backward", "(", ")", "\n", "d_optim", ".", "step", "(", ")", "\n", "\n", "d_regularize", "=", "i", "%", "args", ".", "d_reg_every", "==", "0", "\n", "\n", "if", "d_regularize", ":", "\n", "            ", "real_img", ".", "requires_grad", "=", "True", "\n", "real_pred", "=", "discriminator", "(", "real_img", ")", "\n", "r1_loss", "=", "d_r1_loss", "(", "real_pred", ",", "real_img", ")", "\n", "\n", "real_patch", ".", "requires_grad", "=", "True", "\n", "real_patch_pred", ",", "_", "=", "cooccur", "(", "real_patch", ",", "args", ".", "n_crop", ",", "reference", "=", "ref_patch", ",", "ref_batch", "=", "args", ".", "ref_crop", ")", "\n", "cooccur_r1_loss", "=", "d_r1_loss", "(", "real_patch_pred", ",", "real_patch", ")", "\n", "\n", "d_optim", ".", "zero_grad", "(", ")", "\n", "\n", "r1_loss_sum", "=", "args", ".", "r1", "/", "2", "*", "r1_loss", "*", "args", ".", "d_reg_every", "\n", "r1_loss_sum", "+=", "args", ".", "cooccur_r1", "/", "2", "*", "cooccur_r1_loss", "*", "args", ".", "d_reg_every", "\n", "r1_loss_sum", "+=", "0", "*", "real_pred", "[", "0", ",", "0", "]", "+", "0", "*", "real_patch_pred", "[", "0", ",", "0", "]", "\n", "r1_loss_sum", ".", "backward", "(", ")", "\n", "\n", "d_optim", ".", "step", "(", ")", "\n", "# real_img.requires_grad = False", "\n", "\n", "", "loss_dict", "[", "\"r1\"", "]", "=", "r1_loss", "\n", "loss_dict", "[", "\"cooccur_r1\"", "]", "=", "cooccur_r1_loss", "\n", "\n", "requires_grad", "(", "encoder", ",", "True", ")", "\n", "requires_grad", "(", "generator", ",", "True", ")", "\n", "requires_grad", "(", "str_projectors", ",", "True", ")", "\n", "requires_grad", "(", "discriminator", ",", "False", ")", "\n", "requires_grad", "(", "cooccur", ",", "False", ")", "\n", "\n", "structure1_list", ",", "texture1", "=", "encoder", "(", "real_img1", ",", "multi_str", "=", "True", ",", "multi_tex", "=", "False", ")", "\n", "_", ",", "texture2", "=", "encoder", "(", "real_img2", ",", "run_str", "=", "False", ",", "multi_tex", "=", "False", ")", "\n", "structure1", "=", "structure1_list", "[", "-", "1", "]", "\n", "\n", "fake_img1", "=", "generator", "(", "structure1", ",", "texture1", ")", "\n", "fake_img2", "=", "generator", "(", "structure1", ",", "texture2", ")", "\n", "\n", "# reconstruction loss", "\n", "recon_loss", "=", "F", ".", "l1_loss", "(", "fake_img1", ",", "real_img1", ".", "detach", "(", ")", ")", "\n", "\n", "# image adversarial loss", "\n", "fake_pred", "=", "discriminator", "(", "torch", ".", "cat", "(", "(", "fake_img1", ",", "fake_img2", ")", ",", "0", ")", ")", "\n", "g_loss", "=", "g_nonsaturating_loss", "(", "fake_pred", ")", "\n", "\n", "# texture adversarial loss", "\n", "fake_patch", "=", "patchify_image", "(", "fake_img2", ",", "args", ".", "n_crop", ",", "mask", "=", "real_msk1", ")", "\n", "ref_patch", "=", "patchify_image", "(", "real_img2", ",", "args", ".", "ref_crop", "*", "args", ".", "n_crop", ",", "mask", "=", "real_msk2", ")", "\n", "fake_patch_pred", ",", "_", "=", "cooccur", "(", "fake_patch", ",", "args", ".", "n_crop", ",", "reference", "=", "ref_patch", ",", "ref_batch", "=", "args", ".", "ref_crop", ")", "\n", "g_cooccur_loss", "=", "g_nonsaturating_loss", "(", "fake_patch_pred", ")", "\n", "\n", "# Patch NCE loss", "\n", "# re-encode", "\n", "fake_structure1_list", ",", "fake_texture2", "=", "encoder", "(", "fake_img2", ",", "multi_str", "=", "True", ",", "multi_tex", "=", "False", ")", "\n", "fake_patch_vectors", ",", "coords", "=", "sample_patches", "(", "fake_structure1_list", "[", ":", "-", "1", "]", ",", "args", ".", "n_crop", ",", "mask", "=", "real_msk1", ",", "inv", "=", "True", ")", "\n", "real_patch_vectors", ",", "_", "=", "sample_patches", "(", "structure1_list", "[", ":", "-", "1", "]", ",", "args", ".", "n_crop", ",", "coords", "=", "coords", ")", "\n", "str_qs", "=", "str_projectors", "(", "fake_patch_vectors", ")", "\n", "str_ks", "=", "str_projectors", "(", "real_patch_vectors", ")", "\n", "## compute loss", "\n", "g_pnce_loss", "=", "0", "\n", "num_scales", "=", "len", "(", "str_qs", ")", "\n", "for", "str_q", ",", "str_k", "in", "zip", "(", "str_qs", ",", "str_ks", ")", ":", "\n", "            ", "g_pnce_loss", "+=", "patchnce_loss", "(", "str_q", ",", "str_k", ")", "/", "num_scales", "\n", "# g_pnce_loss += patchnce_loss(str_k, str_k)", "\n", "\n", "# feature reconstruction loss", "\n", "", "feat_recon_loss", "=", "0.5", "*", "F", ".", "mse_loss", "(", "fake_structure1_list", "[", "-", "1", "]", ",", "structure1", ".", "detach", "(", ")", ")", "+", "0.5", "*", "F", ".", "mse_loss", "(", "fake_texture2", ",", "texture2", ".", "detach", "(", ")", ")", "\n", "\n", "loss_dict", "[", "\"recon\"", "]", "=", "recon_loss", "\n", "loss_dict", "[", "\"g\"", "]", "=", "g_loss", "\n", "loss_dict", "[", "\"g_cooccur\"", "]", "=", "g_cooccur_loss", "\n", "loss_dict", "[", "\"g_pnce\"", "]", "=", "g_pnce_loss", "\n", "loss_dict", "[", "\"feat_recon\"", "]", "=", "feat_recon_loss", "\n", "\n", "\n", "g_optim", ".", "zero_grad", "(", ")", "\n", "(", "recon_loss", "+", "0.5", "*", "g_loss", "+", "g_pnce_loss", "+", "g_cooccur_loss", "+", "0.5", "*", "feat_recon_loss", ")", ".", "backward", "(", ")", "#  + 10*", "\n", "g_optim", ".", "step", "(", ")", "\n", "\n", "accumulate", "(", "e_ema", ",", "e_module", ",", "accum", ")", "\n", "accumulate", "(", "g_ema", ",", "g_module", ",", "accum", ")", "\n", "\n", "loss_reduced", "=", "reduce_loss_dict", "(", "loss_dict", ")", "\n", "\n", "d_loss_val", "=", "loss_reduced", "[", "\"d\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "cooccur_val", "=", "loss_reduced", "[", "\"cooccur\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "recon_val", "=", "loss_reduced", "[", "\"recon\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "g_loss_val", "=", "loss_reduced", "[", "\"g\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "g_cooccur_val", "=", "loss_reduced", "[", "\"g_cooccur\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "g_pnce_val", "=", "loss_reduced", "[", "\"g_pnce\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "feat_recon_val", "=", "loss_reduced", "[", "\"feat_recon\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "r1_val", "=", "loss_reduced", "[", "\"r1\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "cooccur_r1_val", "=", "loss_reduced", "[", "\"cooccur_r1\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "\n", "\n", "if", "get_rank", "(", ")", "==", "0", ":", "\n", "            ", "pbar", ".", "set_description", "(", "\n", "(", "\n", "f\"d: {d_loss_val:.4f}; c: {cooccur_val:.4f} g: {g_loss_val:.4f}; g_cooccur: {g_cooccur_val:.4f}; \"", "\n", "f\"recon: {recon_val:.4f}; feat_recon: {feat_recon_val:.4f}; pnce: {g_pnce_val:.4f}; \"", "\n", "f\"r1: {r1_val:.4f}; r1_cooccur: {cooccur_r1_val:.4f}\"", "\n", ")", "\n", ")", "\n", "\n", "if", "wandb", "and", "args", ".", "wandb", "and", "i", "%", "10", "==", "0", ":", "\n", "                ", "wandb", ".", "log", "(", "\n", "{", "\n", "\"Generator\"", ":", "g_loss_val", ",", "\n", "\"Discriminator\"", ":", "d_loss_val", ",", "\n", "\"Cooccur\"", ":", "cooccur_val", ",", "\n", "\"Recon\"", ":", "recon_val", ",", "\n", "\"Feat Recon\"", ":", "feat_recon_val", ",", "\n", "\"Generator Cooccur\"", ":", "g_cooccur_val", ",", "\n", "\"R1\"", ":", "r1_val", ",", "\n", "\"Cooccur R1\"", ":", "cooccur_r1_val", ",", "\n", "\"PNCE\"", ":", "g_pnce_val", ",", "\n", "}", ",", "\n", "step", "=", "i", ",", "\n", ")", "\n", "\n", "", "if", "i", "%", "200", "==", "0", ":", "\n", "                ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "# read test image", "\n", "                    ", "real_img", ",", "_", ",", "_", "=", "next", "(", "ts_loader", ")", "\n", "real_img", "=", "real_img", ".", "to", "(", "device", ")", "\n", "real_img1", ",", "real_img2", "=", "real_img", ".", "chunk", "(", "2", ",", "dim", "=", "0", ")", "\n", "\n", "e_ema", ".", "eval", "(", ")", "\n", "g_ema", ".", "eval", "(", ")", "\n", "\n", "structure1", ",", "texture1", "=", "e_ema", "(", "real_img1", ",", "multi_tex", "=", "False", ")", "\n", "_", ",", "texture2", "=", "e_ema", "(", "real_img2", ",", "run_str", "=", "False", ",", "multi_tex", "=", "False", ")", "\n", "\n", "fake_img1", "=", "g_ema", "(", "structure1", ",", "texture1", ")", "\n", "fake_img2", "=", "g_ema", "(", "structure1", ",", "texture2", ")", "\n", "\n", "sample", "=", "torch", ".", "cat", "(", "(", "real_img1", ",", "fake_img1", ",", "fake_img2", ",", "real_img2", ")", ",", "0", ")", "\n", "\n", "utils", ".", "save_image", "(", "\n", "sample", ",", "\n", "f\"{sample_dir}/{str(i).zfill(6)}.png\"", ",", "\n", "nrow", "=", "sample", ".", "shape", "[", "0", "]", "//", "4", ",", "\n", "normalize", "=", "True", ",", "\n", "range", "=", "(", "-", "1", ",", "1", ")", ",", "\n", ")", "\n", "\n", "", "", "if", "i", "%", "10000", "==", "0", ":", "\n", "                ", "torch", ".", "save", "(", "\n", "{", "\n", "\"e\"", ":", "e_module", ".", "state_dict", "(", ")", ",", "\n", "\"g\"", ":", "g_module", ".", "state_dict", "(", ")", ",", "\n", "\"s\"", ":", "s_module", ".", "state_dict", "(", ")", ",", "\n", "\"d\"", ":", "d_module", ".", "state_dict", "(", ")", ",", "\n", "\"cooccur\"", ":", "c_module", ".", "state_dict", "(", ")", ",", "\n", "\"e_ema\"", ":", "e_ema", ".", "state_dict", "(", ")", ",", "\n", "\"g_ema\"", ":", "g_ema", ".", "state_dict", "(", ")", ",", "\n", "\"g_optim\"", ":", "g_optim", ".", "state_dict", "(", ")", ",", "\n", "\"d_optim\"", ":", "d_optim", ".", "state_dict", "(", ")", ",", "\n", "\"args\"", ":", "args", ",", "\n", "}", ",", "\n", "f\"{ckpt_dir}/{str(i).zfill(6)}.pt\"", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.CXR14Dataset.__init__": [[18, 33], ["open", "f.readlines", "line.strip().split", "os.path.join", "torch.tensor", "dataset.CXR14Dataset.image_list.append", "dataset.CXR14Dataset.label_list.append", "list", "line.strip", "map"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data_root", ",", "listfile", ",", "transform", ",", "gray", "=", "False", ")", ":", "\n", "        ", "self", ".", "image_list", "=", "[", "]", "\n", "self", ".", "label_list", "=", "[", "]", "\n", "with", "open", "(", "listfile", ")", "as", "f", ":", "\n", "            ", "lines", "=", "f", ".", "readlines", "(", ")", "\n", "for", "line", "in", "lines", ":", "\n", "                ", "items", "=", "line", ".", "strip", "(", ")", ".", "split", "(", ")", "\n", "# pdb.set_trace()", "\n", "image_path", "=", "os", ".", "path", ".", "join", "(", "data_root", ",", "items", "[", "0", "]", ")", "\n", "label", "=", "torch", ".", "tensor", "(", "list", "(", "map", "(", "int", ",", "items", "[", "1", ":", "]", ")", ")", ",", "dtype", "=", "torch", ".", "float32", ")", "\n", "self", ".", "image_list", ".", "append", "(", "image_path", ")", "\n", "self", ".", "label_list", ".", "append", "(", "label", ")", "\n", "\n", "", "", "self", ".", "transform", "=", "transform", "\n", "self", ".", "gray", "=", "gray", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.CXR14Dataset.__len__": [[34, 36], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "image_list", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.CXR14Dataset.__getitem__": [[37, 47], ["PIL.Image.open", "dataset.CXR14Dataset.transform", "image.convert.convert.convert", "image.convert.convert.convert"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "image", "=", "Image", ".", "open", "(", "self", ".", "image_list", "[", "index", "]", ")", "\n", "if", "self", ".", "gray", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'L'", ")", "\n", "", "else", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'RGB'", ")", "\n", "", "label", "=", "self", ".", "label_list", "[", "index", "]", "\n", "image", "=", "self", ".", "transform", "(", "image", ")", "\n", "\n", "return", "image", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.IM100Dataset.__init__": [[49, 63], ["open", "f.readlines", "line.strip().split", "os.path.join", "int", "dataset.IM100Dataset.image_list.append", "dataset.IM100Dataset.label_list.append", "line.strip"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data_root", ",", "listfile", ",", "transform", ",", "gray", "=", "False", ")", ":", "\n", "        ", "self", ".", "image_list", "=", "[", "]", "\n", "self", ".", "label_list", "=", "[", "]", "\n", "with", "open", "(", "listfile", ")", "as", "f", ":", "\n", "            ", "lines", "=", "f", ".", "readlines", "(", ")", "\n", "for", "line", "in", "lines", ":", "\n", "                ", "items", "=", "line", ".", "strip", "(", ")", ".", "split", "(", ")", "\n", "image_path", "=", "os", ".", "path", ".", "join", "(", "data_root", ",", "items", "[", "0", "]", ")", "\n", "label", "=", "int", "(", "items", "[", "1", "]", ")", "\n", "self", ".", "image_list", ".", "append", "(", "image_path", ")", "\n", "self", ".", "label_list", ".", "append", "(", "label", ")", "\n", "\n", "", "", "self", ".", "transform", "=", "transform", "\n", "self", ".", "gray", "=", "gray", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.IM100Dataset.__len__": [[64, 66], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "image_list", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.IM100Dataset.__getitem__": [[67, 77], ["PIL.Image.open", "dataset.IM100Dataset.transform", "image.convert.convert.convert", "image.convert.convert.convert"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "image", "=", "Image", ".", "open", "(", "self", ".", "image_list", "[", "index", "]", ")", "\n", "if", "self", ".", "gray", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'L'", ")", "\n", "", "else", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'RGB'", ")", "\n", "", "label", "=", "self", ".", "label_list", "[", "index", "]", "\n", "image", "=", "self", ".", "transform", "(", "image", ")", "\n", "\n", "return", "image", ",", "label", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.MaskedCXR14Dataset.__init__": [[79, 106], ["print", "open", "f.readlines", "tqdm.tqdm.tqdm", "range", "line.strip().split", "os.path.join", "os.path.join", "dataset.MaskedCXR14Dataset.image_list.append", "dataset.MaskedCXR14Dataset.mask_list.append", "len", "torch.tensor", "dataset.MaskedCXR14Dataset.label_list.append", "len", "line.strip", "list", "map"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data_root", ",", "mask_root", ",", "listfile", ",", "transform", ",", "gray", "=", "False", ",", "nolabel", "=", "False", ")", ":", "\n", "        ", "self", ".", "image_list", "=", "[", "]", "\n", "self", ".", "mask_list", "=", "[", "]", "\n", "self", ".", "label_list", "=", "[", "]", "\n", "self", ".", "nolabel", "=", "nolabel", "\n", "with", "open", "(", "listfile", ")", "as", "f", ":", "\n", "            ", "lines", "=", "f", ".", "readlines", "(", ")", "\n", "for", "i", "in", "tqdm", "(", "range", "(", "len", "(", "lines", ")", ")", ")", ":", "\n", "                ", "line", "=", "lines", "[", "i", "]", "\n", "items", "=", "line", ".", "strip", "(", ")", ".", "split", "(", ")", "\n", "# pdb.set_trace()", "\n", "image_path", "=", "os", ".", "path", ".", "join", "(", "data_root", ",", "items", "[", "0", "]", ")", "\n", "mask_path", "=", "os", ".", "path", ".", "join", "(", "mask_root", ",", "'mask_'", "+", "items", "[", "0", "]", ")", "\n", "if", "not", "nolabel", ":", "\n", "                    ", "label", "=", "torch", ".", "tensor", "(", "list", "(", "map", "(", "int", ",", "items", "[", "1", ":", "]", ")", ")", ",", "dtype", "=", "torch", ".", "float32", ")", "\n", "# mask_array = cv2.imread(mask_path, cv2.IMREAD_GRAYSCALE)", "\n", "# mask_ratio = np.count_nonzero(mask_array) / mask_array.size", "\n", "# # pdb.set_trace()", "\n", "# if mask_ratio > 0.1:", "\n", "", "self", ".", "image_list", ".", "append", "(", "image_path", ")", "\n", "self", ".", "mask_list", ".", "append", "(", "mask_path", ")", "\n", "if", "not", "nolabel", ":", "\n", "                    ", "self", ".", "label_list", ".", "append", "(", "label", ")", "\n", "\n", "", "", "", "self", ".", "transform", "=", "transform", "\n", "self", ".", "gray", "=", "gray", "\n", "print", "(", "f\"Length of dataset is {len(self)}\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.MaskedCXR14Dataset.__len__": [[107, 110], ["len", "len", "len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "assert", "(", "len", "(", "self", ".", "image_list", ")", "==", "len", "(", "self", ".", "mask_list", ")", ")", ",", "\"Image, mask and label list should be of same length\"", "\n", "return", "len", "(", "self", ".", "image_list", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.MaskedCXR14Dataset.__getitem__": [[111, 127], ["PIL.Image.open", "PIL.Image.open", "mask.convert.convert.convert", "PIL.ImageChops.multiply", "dataset.MaskedCXR14Dataset.transform", "image.convert.convert.convert", "image.convert.convert.convert"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "image", "=", "Image", ".", "open", "(", "self", ".", "image_list", "[", "index", "]", ")", "\n", "if", "self", ".", "gray", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'L'", ")", "\n", "", "else", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'RGB'", ")", "\n", "", "mask", "=", "Image", ".", "open", "(", "self", ".", "mask_list", "[", "index", "]", ")", "\n", "mask", "=", "mask", ".", "convert", "(", "'RGB'", ")", "\n", "masked_img", "=", "ImageChops", ".", "multiply", "(", "image", ",", "mask", ")", "\n", "image", "=", "self", ".", "transform", "(", "masked_img", ")", "\n", "\n", "if", "not", "self", ".", "nolabel", ":", "\n", "            ", "label", "=", "self", ".", "label_list", "[", "index", "]", "\n", "return", "image", ",", "label", "\n", "", "else", ":", "\n", "            ", "return", "image", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.CXR14maskDataset.__init__": [[129, 157], ["torchvision.transforms.Compose", "print", "open", "f.readlines", "tqdm.tqdm.tqdm", "range", "line.strip().split", "os.path.join", "os.path.join", "dataset.CXR14maskDataset.image_list.append", "dataset.CXR14maskDataset.mask_list.append", "torchvision.transforms.ToTensor", "len", "torch.tensor", "dataset.CXR14maskDataset.label_list.append", "len", "line.strip", "list", "map"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ",", "data_root", ",", "mask_root", ",", "listfile", ",", "transform", ",", "gray", "=", "False", ",", "nolabel", "=", "False", ")", ":", "\n", "        ", "self", ".", "image_list", "=", "[", "]", "\n", "self", ".", "mask_list", "=", "[", "]", "\n", "self", ".", "label_list", "=", "[", "]", "\n", "self", ".", "nolabel", "=", "nolabel", "\n", "with", "open", "(", "listfile", ")", "as", "f", ":", "\n", "            ", "lines", "=", "f", ".", "readlines", "(", ")", "\n", "for", "i", "in", "tqdm", "(", "range", "(", "len", "(", "lines", ")", ")", ")", ":", "\n", "                ", "line", "=", "lines", "[", "i", "]", "\n", "items", "=", "line", ".", "strip", "(", ")", ".", "split", "(", ")", "\n", "# pdb.set_trace()", "\n", "image_path", "=", "os", ".", "path", ".", "join", "(", "data_root", ",", "items", "[", "0", "]", ")", "\n", "mask_path", "=", "os", ".", "path", ".", "join", "(", "mask_root", ",", "'mask_'", "+", "items", "[", "0", "]", ")", "\n", "if", "not", "nolabel", ":", "\n", "                    ", "label", "=", "torch", ".", "tensor", "(", "list", "(", "map", "(", "int", ",", "items", "[", "1", ":", "]", ")", ")", ",", "dtype", "=", "torch", ".", "float32", ")", "\n", "# mask_array = cv2.imread(mask_path, cv2.IMREAD_GRAYSCALE)", "\n", "# mask_ratio = np.count_nonzero(mask_array) / mask_array.size", "\n", "# # pdb.set_trace()", "\n", "# if mask_ratio > 0.1:", "\n", "", "self", ".", "image_list", ".", "append", "(", "image_path", ")", "\n", "self", ".", "mask_list", ".", "append", "(", "mask_path", ")", "\n", "if", "not", "nolabel", ":", "\n", "                    ", "self", ".", "label_list", ".", "append", "(", "label", ")", "\n", "\n", "", "", "", "self", ".", "transform", "=", "transform", "\n", "self", ".", "mask_transform", "=", "transforms", ".", "Compose", "(", "[", "transforms", ".", "ToTensor", "(", ")", "]", ")", "\n", "self", ".", "gray", "=", "gray", "\n", "print", "(", "f\"Length of dataset is {len(self)}\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.CXR14maskDataset.__len__": [[158, 161], ["len", "len", "len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "assert", "(", "len", "(", "self", ".", "image_list", ")", "==", "len", "(", "self", ".", "mask_list", ")", ")", ",", "\"Image, mask and label list should be of same length\"", "\n", "return", "len", "(", "self", ".", "image_list", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.CXR14maskDataset.__getitem__": [[162, 178], ["PIL.Image.open", "PIL.Image.open", "dataset.CXR14maskDataset.convert", "dataset.CXR14maskDataset.transform", "dataset.CXR14maskDataset.mask_transform", "image.convert.convert.convert", "image.convert.convert.convert"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "image", "=", "Image", ".", "open", "(", "self", ".", "image_list", "[", "index", "]", ")", "\n", "if", "self", ".", "gray", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'L'", ")", "\n", "", "else", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'RGB'", ")", "\n", "", "mask", "=", "Image", ".", "open", "(", "self", ".", "mask_list", "[", "index", "]", ")", "\n", "mask", "=", "mask", ".", "convert", "(", "'L'", ")", "\n", "image", "=", "self", ".", "transform", "(", "image", ")", "\n", "mask", "=", "self", ".", "mask_transform", "(", "mask", ")", "\n", "\n", "if", "not", "self", ".", "nolabel", ":", "\n", "            ", "label", "=", "self", ".", "label_list", "[", "index", "]", "\n", "return", "image", ",", "mask", ",", "label", "\n", "", "else", ":", "\n", "            ", "return", "image", ",", "mask", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.SeqDataset.__init__": [[180, 192], ["dataset.SeqDataset.parse_dataset", "list", "sklearn.model_selection.train_test_split", "dataset.SeqDataset.pid2dates.keys"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.SeqDataset.parse_dataset"], ["    ", "def", "__init__", "(", "self", ",", "data_root", ",", "transform", ",", "length", "=", "2", ",", "phase", "=", "'train'", ")", ":", "\n", "        ", "self", ".", "data_root", "=", "data_root", "\n", "self", ".", "transform", "=", "transform", "\n", "self", ".", "length", "=", "length", "\n", "self", ".", "phase", "=", "phase", "\n", "self", ".", "pid2dates", "=", "self", ".", "parse_dataset", "(", ")", "\n", "self", ".", "all_keys", "=", "list", "(", "self", ".", "pid2dates", ".", "keys", "(", ")", ")", "\n", "tr_keys", ",", "ts_keys", "=", "train_test_split", "(", "self", ".", "all_keys", ",", "train_size", "=", "0.8", ",", "shuffle", "=", "False", ")", "\n", "if", "phase", "==", "'train'", ":", "\n", "            ", "self", ".", "keys", "=", "tr_keys", "\n", "", "else", ":", "\n", "            ", "self", ".", "keys", "=", "ts_keys", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.SeqDataset.parse_dataset": [[193, 214], ["os.listdir", "pid2dates.keys", "print", "[].split", "pid2dates[].append", "pid2dates.pop", "int", "del_keys.append", "len", "len", "len", "file.split"], "methods", ["None"], ["", "", "def", "parse_dataset", "(", "self", ")", ":", "\n", "        ", "pid2dates", "=", "{", "}", "\n", "files", "=", "os", ".", "listdir", "(", "self", ".", "data_root", ")", "\n", "for", "file", "in", "files", ":", "\n", "            ", "items", "=", "file", ".", "split", "(", "'.'", ")", "[", "0", "]", ".", "split", "(", "'_'", ")", "\n", "pid", ",", "date", "=", "items", "[", "0", "]", ",", "int", "(", "items", "[", "1", "]", ")", "\n", "if", "pid", "not", "in", "pid2dates", ":", "\n", "                ", "pid2dates", "[", "pid", "]", "=", "[", "]", "\n", "", "pid2dates", "[", "pid", "]", ".", "append", "(", "date", ")", "\n", "# select sequences", "\n", "", "del_keys", "=", "[", "]", "\n", "for", "key", "in", "pid2dates", ".", "keys", "(", ")", ":", "\n", "            ", "dates", "=", "pid2dates", "[", "key", "]", "\n", "if", "len", "(", "dates", ")", "==", "1", "or", "len", "(", "dates", ")", "<", "self", ".", "length", ":", "\n", "                ", "del_keys", ".", "append", "(", "key", ")", "\n", "", "else", ":", "\n", "                ", "pid2dates", "[", "key", "]", "=", "dates", "[", "-", "self", ".", "length", ":", "]", "\n", "", "", "for", "key", "in", "del_keys", ":", "\n", "            ", "pid2dates", ".", "pop", "(", "key", ")", "\n", "", "print", "(", "f\"There are {len(pid2dates)} patients\"", ")", "\n", "return", "pid2dates", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.SeqDataset.__len__": [[215, 217], ["len"], "methods", ["None"], ["", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "keys", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.dataset.SeqDataset.__getitem__": [[218, 231], ["torch.cat", "os.path.join", "PIL.Image.open", "dataset.SeqDataset.convert", "dataset.SeqDataset.transform", "torch.cat.append"], "methods", ["None"], ["", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "key", "=", "self", ".", "keys", "[", "index", "]", "\n", "\n", "images", "=", "[", "]", "\n", "dates", "=", "self", ".", "pid2dates", "[", "key", "]", "\n", "for", "date", "in", "dates", ":", "\n", "            ", "image_path", "=", "os", ".", "path", ".", "join", "(", "self", ".", "data_root", ",", "f\"{key}_{date:03d}_0.png\"", ")", "\n", "image", "=", "Image", ".", "open", "(", "image_path", ")", "\n", "image", "=", "image", ".", "convert", "(", "'RGB'", ")", "\n", "image", "=", "self", ".", "transform", "(", "image", ")", "\n", "images", ".", "append", "(", "image", ")", "\n", "", "images", "=", "torch", ".", "cat", "(", "images", ",", "dim", "=", "0", ")", "\n", "return", "images", ",", "key", ",", "dates", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.EqualConvTranspose2d.__init__": [[14, 32], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.randn", "math.sqrt", "torch.nn.Parameter", "torch.zeros"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "in_channel", ",", "out_channel", ",", "kernel_size", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "weight", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "randn", "(", "in_channel", ",", "out_channel", ",", "kernel_size", ",", "kernel_size", ")", "\n", ")", "\n", "self", ".", "scale", "=", "1", "/", "math", ".", "sqrt", "(", "in_channel", "*", "kernel_size", "**", "2", ")", "\n", "\n", "self", ".", "stride", "=", "stride", "\n", "self", ".", "padding", "=", "padding", "\n", "\n", "if", "bias", ":", "\n", "            ", "self", ".", "bias", "=", "nn", ".", "Parameter", "(", "torch", ".", "zeros", "(", "out_channel", ")", ")", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "bias", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.EqualConvTranspose2d.forward": [[33, 43], ["torch.nn.functional.conv_transpose2d"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "F", ".", "conv_transpose2d", "(", "\n", "input", ",", "\n", "self", ".", "weight", "*", "self", ".", "scale", ",", "\n", "bias", "=", "self", ".", "bias", ",", "\n", "stride", "=", "self", ".", "stride", ",", "\n", "padding", "=", "self", ".", "padding", ",", "\n", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.EqualConvTranspose2d.__repr__": [[44, 47], ["None"], "methods", ["None"], ["", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "(", "\n", "f\"{self.__class__.__name__}({self.weight.shape[0]}, {self.weight.shape[1]},\"", "\n", "f\" {self.weight.shape[2]}, stride={self.stride}, padding={self.padding})\"", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.ConvLayer.__init__": [[52, 133], ["torch.nn.Sequential.__init__", "layers.append", "layers.append", "layers.append", "layers.append", "stylegan2.model.Blur", "model.EqualConvTranspose2d", "stylegan2.model.Blur", "stylegan2.model.EqualConv2d", "layers.append", "layers.append", "len", "len", "stylegan2.op.FusedLeakyReLU", "stylegan2.model.ScaledLeakyReLU", "layers.append", "ValueError", "torch.nn.ReflectionPad2d"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "kernel_size", ",", "\n", "upsample", "=", "False", ",", "\n", "downsample", "=", "False", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "bias", "=", "True", ",", "\n", "activate", "=", "True", ",", "\n", "padding", "=", "\"zero\"", ",", "\n", ")", ":", "\n", "        ", "layers", "=", "[", "]", "\n", "\n", "self", ".", "padding", "=", "0", "\n", "stride", "=", "1", "\n", "\n", "if", "downsample", ":", "\n", "            ", "factor", "=", "2", "\n", "p", "=", "(", "len", "(", "blur_kernel", ")", "-", "factor", ")", "+", "(", "kernel_size", "-", "1", ")", "\n", "pad0", "=", "(", "p", "+", "1", ")", "//", "2", "\n", "pad1", "=", "p", "//", "2", "\n", "\n", "layers", ".", "append", "(", "Blur", "(", "blur_kernel", ",", "pad", "=", "(", "pad0", ",", "pad1", ")", ")", ")", "\n", "\n", "stride", "=", "2", "\n", "\n", "", "if", "upsample", ":", "\n", "            ", "layers", ".", "append", "(", "\n", "EqualConvTranspose2d", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "kernel_size", ",", "\n", "padding", "=", "0", ",", "\n", "stride", "=", "2", ",", "\n", "bias", "=", "bias", "and", "not", "activate", ",", "\n", ")", "\n", ")", "\n", "\n", "factor", "=", "2", "\n", "p", "=", "(", "len", "(", "blur_kernel", ")", "-", "factor", ")", "-", "(", "kernel_size", "-", "1", ")", "\n", "pad0", "=", "(", "p", "+", "1", ")", "//", "2", "+", "factor", "-", "1", "\n", "pad1", "=", "p", "//", "2", "+", "1", "\n", "\n", "layers", ".", "append", "(", "Blur", "(", "blur_kernel", ",", "pad", "=", "(", "pad0", ",", "pad1", ")", ")", ")", "\n", "\n", "", "else", ":", "\n", "            ", "if", "not", "downsample", ":", "\n", "                ", "if", "padding", "==", "\"zero\"", ":", "\n", "                    ", "self", ".", "padding", "=", "(", "kernel_size", "-", "1", ")", "//", "2", "\n", "\n", "", "elif", "padding", "==", "\"reflect\"", ":", "\n", "                    ", "padding", "=", "(", "kernel_size", "-", "1", ")", "//", "2", "\n", "\n", "if", "padding", ">", "0", ":", "\n", "                        ", "layers", ".", "append", "(", "nn", ".", "ReflectionPad2d", "(", "padding", ")", ")", "\n", "\n", "", "self", ".", "padding", "=", "0", "\n", "\n", "", "elif", "padding", "!=", "\"valid\"", ":", "\n", "                    ", "raise", "ValueError", "(", "'Padding should be \"zero\", \"reflect\", or \"valid\"'", ")", "\n", "\n", "", "", "layers", ".", "append", "(", "\n", "EqualConv2d", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "kernel_size", ",", "\n", "padding", "=", "self", ".", "padding", ",", "\n", "stride", "=", "stride", ",", "\n", "bias", "=", "bias", "and", "not", "activate", ",", "\n", ")", "\n", ")", "\n", "\n", "", "if", "activate", ":", "\n", "            ", "if", "bias", ":", "\n", "                ", "layers", ".", "append", "(", "FusedLeakyReLU", "(", "out_channel", ")", ")", "\n", "\n", "", "else", ":", "\n", "                ", "layers", ".", "append", "(", "ScaledLeakyReLU", "(", "0.2", ")", ")", "\n", "\n", "", "", "super", "(", ")", ".", "__init__", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.StyledResBlock.__init__": [[136, 165], ["torch.nn.Module.__init__", "stylegan2.model.StyledConv", "stylegan2.model.StyledConv", "model.ConvLayer"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "in_channel", ",", "out_channel", ",", "style_dim", ",", "upsample", ",", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "StyledConv", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "3", ",", "\n", "style_dim", ",", "\n", "upsample", "=", "upsample", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", ")", "\n", "\n", "self", ".", "conv2", "=", "StyledConv", "(", "out_channel", ",", "out_channel", ",", "3", ",", "style_dim", ")", "\n", "\n", "if", "upsample", "or", "in_channel", "!=", "out_channel", ":", "\n", "            ", "self", ".", "skip", "=", "ConvLayer", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "1", ",", "\n", "upsample", "=", "upsample", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", "bias", "=", "False", ",", "\n", "activate", "=", "False", ",", "\n", ")", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "skip", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.StyledResBlock.forward": [[166, 177], ["model.StyledResBlock.conv1", "model.StyledResBlock.conv2", "model.StyledResBlock.skip", "math.sqrt"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "input", ",", "style", ",", "noise", "=", "None", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv1", "(", "input", ",", "style", ",", "noise", ")", "\n", "out", "=", "self", ".", "conv2", "(", "out", ",", "style", ",", "noise", ")", "\n", "\n", "if", "self", ".", "skip", "is", "not", "None", ":", "\n", "            ", "skip", "=", "self", ".", "skip", "(", "input", ")", "\n", "\n", "", "else", ":", "\n", "            ", "skip", "=", "input", "\n", "\n", "", "return", "(", "out", "+", "skip", ")", "/", "math", ".", "sqrt", "(", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.ResBlock.__init__": [[180, 214], ["torch.nn.Module.__init__", "model.ConvLayer", "model.ConvLayer", "model.ConvLayer"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "downsample", ",", "\n", "padding", "=", "\"zero\"", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "ConvLayer", "(", "in_channel", ",", "out_channel", ",", "3", ",", "padding", "=", "padding", ")", "\n", "\n", "self", ".", "conv2", "=", "ConvLayer", "(", "\n", "out_channel", ",", "\n", "out_channel", ",", "\n", "3", ",", "\n", "downsample", "=", "downsample", ",", "\n", "padding", "=", "padding", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", ")", "\n", "\n", "if", "downsample", "or", "in_channel", "!=", "out_channel", ":", "\n", "            ", "self", ".", "skip", "=", "ConvLayer", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "1", ",", "\n", "downsample", "=", "downsample", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", "bias", "=", "False", ",", "\n", "activate", "=", "False", ",", "\n", ")", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "skip", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.ResBlock.forward": [[215, 228], ["model.ResBlock.conv1", "model.ResBlock.conv2", "model.ResBlock.skip", "math.sqrt"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv1", "(", "input", ")", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "\n", "if", "self", ".", "skip", "is", "not", "None", ":", "\n", "            ", "skip", "=", "self", ".", "skip", "(", "input", ")", "\n", "\n", "", "else", ":", "\n", "            ", "skip", "=", "input", "\n", "\n", "# print(out.shape)", "\n", "\n", "", "return", "(", "out", "+", "skip", ")", "/", "math", ".", "sqrt", "(", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Stem.__init__": [[230, 240], ["torch.nn.Module.__init__", "model.ConvLayer", "model.ConvLayer"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "gray", "=", "False", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "if", "gray", ":", "\n", "            ", "self", ".", "stem", "=", "ConvLayer", "(", "1", ",", "channel", ",", "3", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "stem", "=", "ConvLayer", "(", "3", ",", "channel", ",", "3", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Stem.forward": [[241, 245], ["model.Stem.stem"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.StrBranch.__init__": [[247, 274], ["torch.nn.Module.__init__", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "torch.nn.Sequential", "scale1.append", "scale2.append", "scale3.append", "model.ConvLayer", "model.ConvLayer", "model.ResBlock", "model.ResBlock", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "0", ",", "1", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale2", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n", "scale3", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ",", "4", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n", "self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "1", ")", ",", "ConvLayer", "(", "ch", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.StrBranch.forward": [[276, 286], ["model.StrBranch.scale1", "model.StrBranch.scale2", "model.StrBranch.scale3", "model.StrBranch.structure"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "multi_out", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n", "scale3", "=", "self", ".", "scale3", "(", "scale2", ")", "\n", "structure", "=", "self", ".", "structure", "(", "scale3", ")", "\n", "\n", "if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "structure", "\n", "", "else", ":", "\n", "            ", "return", "structure", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarStrBranch.__init__": [[288, 315], ["torch.nn.Module.__init__", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "torch.nn.Sequential", "scale1.append", "scale2.append", "scale3.append", "model.ConvLayer", "model.ConvLayer", "model.ResBlock", "model.ResBlock", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "0", ",", "1", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale2", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n", "scale3", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ",", "3", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n", "self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "1", ")", ",", "ConvLayer", "(", "ch", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarStrBranch.forward": [[317, 327], ["model.CifarStrBranch.scale1", "model.CifarStrBranch.scale2", "model.CifarStrBranch.scale3", "model.CifarStrBranch.structure"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "multi_out", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n", "scale3", "=", "self", ".", "scale3", "(", "scale2", ")", "\n", "structure", "=", "self", ".", "structure", "(", "scale3", ")", "\n", "\n", "if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "structure", "\n", "", "else", ":", "\n", "            ", "return", "structure", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.TexBranch.__init__": [[329, 359], ["torch.nn.Module.__init__", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "torch.nn.Sequential", "scale1.append", "scale2.append", "scale3.append", "model.ConvLayer", "model.ConvLayer", "torch.nn.AdaptiveAvgPool2d", "model.ConvLayer", "model.ResBlock", "model.ResBlock", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "texture_channel", "=", "8", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "0", ",", "1", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale2", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n", "scale3", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ",", "4", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n", "self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "ch", "*", "4", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "4", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.TexBranch.forward": [[361, 371], ["model.TexBranch.scale1", "model.TexBranch.scale2", "model.TexBranch.scale3", "torch.flatten", "model.TexBranch.texture"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "multi_out", "=", "True", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n", "scale3", "=", "self", ".", "scale3", "(", "scale2", ")", "\n", "texture", "=", "torch", ".", "flatten", "(", "self", ".", "texture", "(", "scale3", ")", ",", "1", ")", "\n", "\n", "if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "texture", "\n", "", "else", ":", "\n", "            ", "return", "texture", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarTexBranch.__init__": [[373, 402], ["torch.nn.Module.__init__", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "range", "torch.nn.Sequential", "torch.nn.Sequential", "scale1.append", "scale2.append", "scale3.append", "model.ConvLayer", "torch.nn.AdaptiveAvgPool2d", "model.ConvLayer", "model.ResBlock", "model.ResBlock", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "texture_channel", "=", "128", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "0", ",", "1", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale2", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n", "scale3", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ",", "3", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n", "self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "2", ",", "downsample", "=", "False", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarTexBranch.forward": [[404, 414], ["model.CifarTexBranch.scale1", "model.CifarTexBranch.scale2", "model.CifarTexBranch.scale3", "torch.flatten", "model.CifarTexBranch.texture"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "multi_out", "=", "True", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n", "scale3", "=", "self", ".", "scale3", "(", "scale2", ")", "\n", "texture", "=", "torch", ".", "flatten", "(", "self", ".", "texture", "(", "scale3", ")", ",", "1", ")", "\n", "\n", "if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "texture", "\n", "", "else", ":", "\n", "            ", "return", "texture", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.PyramidEncoder.__init__": [[416, 422], ["torch.nn.Module.__init__", "model.Stem", "model.StrBranch", "model.TexBranch"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ",", "texture_channel", "=", "2048", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "stem", "=", "Stem", "(", "channel", ",", "gray", "=", "gray", ")", "\n", "self", ".", "str_branch", "=", "StrBranch", "(", "channel", ",", "structure_channel", ")", "\n", "self", ".", "tex_branch", "=", "TexBranch", "(", "channel", ",", "texture_channel", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.PyramidEncoder.forward": [[423, 432], ["model.PyramidEncoder.stem", "model.PyramidEncoder.str_branch", "model.PyramidEncoder.tex_branch"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "run_str", "=", "True", ",", "run_tex", "=", "True", ",", "multi_str", "=", "False", ",", "multi_tex", "=", "True", ")", ":", "\n", "        ", "structures", "=", "None", "\n", "textures", "=", "None", "\n", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "if", "run_str", ":", "\n", "            ", "structures", "=", "self", ".", "str_branch", "(", "out", ",", "multi_out", "=", "multi_str", ")", "\n", "", "if", "run_tex", ":", "\n", "            ", "textures", "=", "self", ".", "tex_branch", "(", "out", ",", "multi_out", "=", "multi_tex", ")", "\n", "", "return", "structures", ",", "textures", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarPyramidEncoder.__init__": [[434, 440], ["torch.nn.Module.__init__", "model.Stem", "model.CifarStrBranch", "model.CifarTexBranch"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ",", "texture_channel", "=", "128", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "stem", "=", "Stem", "(", "channel", ",", "gray", "=", "gray", ")", "\n", "self", ".", "str_branch", "=", "CifarStrBranch", "(", "channel", ",", "structure_channel", ")", "\n", "self", ".", "tex_branch", "=", "CifarTexBranch", "(", "channel", ",", "texture_channel", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarPyramidEncoder.forward": [[441, 450], ["model.CifarPyramidEncoder.stem", "model.CifarPyramidEncoder.str_branch", "model.CifarPyramidEncoder.tex_branch"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "run_str", "=", "True", ",", "run_tex", "=", "True", ",", "multi_str", "=", "False", ",", "multi_tex", "=", "True", ")", ":", "\n", "        ", "structures", "=", "None", "\n", "textures", "=", "None", "\n", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "if", "run_str", ":", "\n", "            ", "structures", "=", "self", ".", "str_branch", "(", "out", ",", "multi_out", "=", "multi_str", ")", "\n", "", "if", "run_tex", ":", "\n", "            ", "textures", "=", "self", ".", "tex_branch", "(", "out", ",", "multi_out", "=", "multi_tex", ")", "\n", "", "return", "structures", ",", "textures", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Encoder.__init__": [[452, 480], ["torch.nn.Module.__init__", "range", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "model.ConvLayer", "stem.append", "model.ConvLayer", "model.ConvLayer", "model.ConvLayer", "model.ConvLayer", "torch.nn.AdaptiveAvgPool2d", "model.ConvLayer", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "2048", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "stem", "=", "[", "ConvLayer", "(", "3", ",", "channel", ",", "1", ")", "]", "\n", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "1", ",", "5", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "stem", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "\n", "", "self", ".", "stem", "=", "nn", ".", "Sequential", "(", "*", "stem", ")", "\n", "\n", "self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "1", ")", ",", "ConvLayer", "(", "ch", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n", "\n", "self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "ch", "*", "4", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "4", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Encoder.forward": [[482, 489], ["model.Encoder.stem", "model.Encoder.structure", "torch.flatten", "model.Encoder.texture"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "\n", "structure", "=", "self", ".", "structure", "(", "out", ")", "\n", "texture", "=", "torch", ".", "flatten", "(", "self", ".", "texture", "(", "out", ")", ",", "1", ")", "\n", "\n", "return", "structure", ",", "texture", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.LightEncoder.__init__": [[491, 519], ["torch.nn.Module.__init__", "range", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "model.ConvLayer", "stem.append", "model.ConvLayer", "model.ConvLayer", "model.ConvLayer", "model.ConvLayer", "torch.nn.AdaptiveAvgPool2d", "model.ConvLayer", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "1024", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "stem", "=", "[", "ConvLayer", "(", "3", ",", "channel", ",", "1", ")", "]", "\n", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "1", ",", "5", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "stem", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "\n", "", "self", ".", "stem", "=", "nn", ".", "Sequential", "(", "*", "stem", ")", "\n", "\n", "self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "//", "4", ",", "1", ")", ",", "ConvLayer", "(", "ch", "//", "4", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n", "\n", "self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.LightEncoder.forward": [[521, 528], ["model.LightEncoder.stem", "model.LightEncoder.structure", "torch.flatten", "model.LightEncoder.texture"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "\n", "structure", "=", "self", ".", "structure", "(", "out", ")", "\n", "texture", "=", "torch", ".", "flatten", "(", "self", ".", "texture", "(", "out", ")", ",", "1", ")", "\n", "\n", "return", "structure", ",", "texture", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Generator.__init__": [[530, 558], ["torch.nn.Module.__init__", "torch.nn.ModuleList", "zip", "model.Generator.layers.append", "model.ConvLayer", "model.ConvLayer", "model.StyledResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "2048", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "gray", "=", "False", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gray", "=", "gray", "\n", "\n", "ch_multiplier", "=", "(", "4", ",", "8", ",", "12", ",", "16", ",", "16", ",", "16", ",", "8", ",", "4", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n", "for", "ch_mul", ",", "up", "in", "zip", "(", "ch_multiplier", ",", "upsample", ")", ":", "\n", "            ", "self", ".", "layers", ".", "append", "(", "\n", "StyledResBlock", "(", "\n", "in_ch", ",", "channel", "*", "ch_mul", ",", "texture_channel", ",", "up", ",", "blur_kernel", "\n", ")", "\n", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "", "if", "gray", ":", "\n", "            ", "self", ".", "to_img", "=", "ConvLayer", "(", "in_ch", ",", "1", ",", "1", ",", "activate", "=", "False", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "3", ",", "1", ",", "activate", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Generator.forward": [[559, 573], ["zip", "layer", "model.Generator.to_img", "model.Generator.to_rgb", "len"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "structure", ",", "texture", ",", "noises", "=", "None", ")", ":", "\n", "        ", "if", "noises", "is", "None", ":", "\n", "            ", "noises", "=", "[", "None", "]", "*", "len", "(", "self", ".", "layers", ")", "\n", "\n", "", "out", "=", "structure", "\n", "for", "layer", ",", "noise", "in", "zip", "(", "self", ".", "layers", ",", "noises", ")", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "texture", ",", "noise", ")", "\n", "\n", "", "if", "self", ".", "gray", ":", "\n", "            ", "out", "=", "self", ".", "to_img", "(", "out", ")", "\n", "", "else", ":", "\n", "            ", "out", "=", "self", ".", "to_rgb", "(", "out", ")", "\n", "\n", "", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarGenerator.__init__": [[575, 603], ["torch.nn.Module.__init__", "torch.nn.ModuleList", "zip", "model.CifarGenerator.layers.append", "model.ConvLayer", "model.ConvLayer", "model.StyledResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "128", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "gray", "=", "False", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gray", "=", "gray", "\n", "\n", "ch_multiplier", "=", "(", "2", ",", "4", ",", "6", ",", "8", ",", "8", ",", "4", ",", "2", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n", "for", "ch_mul", ",", "up", "in", "zip", "(", "ch_multiplier", ",", "upsample", ")", ":", "\n", "            ", "self", ".", "layers", ".", "append", "(", "\n", "StyledResBlock", "(", "\n", "in_ch", ",", "channel", "*", "ch_mul", ",", "texture_channel", ",", "up", ",", "blur_kernel", "\n", ")", "\n", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "", "if", "gray", ":", "\n", "            ", "self", ".", "to_img", "=", "ConvLayer", "(", "in_ch", ",", "1", ",", "1", ",", "activate", "=", "False", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "3", ",", "1", ",", "activate", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarGenerator.forward": [[604, 618], ["zip", "layer", "model.CifarGenerator.to_img", "model.CifarGenerator.to_rgb", "len"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "structure", ",", "texture", ",", "noises", "=", "None", ")", ":", "\n", "        ", "if", "noises", "is", "None", ":", "\n", "            ", "noises", "=", "[", "None", "]", "*", "len", "(", "self", ".", "layers", ")", "\n", "\n", "", "out", "=", "structure", "\n", "for", "layer", ",", "noise", "in", "zip", "(", "self", ".", "layers", ",", "noises", ")", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "texture", ",", "noise", ")", "\n", "\n", "", "if", "self", ".", "gray", ":", "\n", "            ", "out", "=", "self", ".", "to_img", "(", "out", ")", "\n", "", "else", ":", "\n", "            ", "out", "=", "self", ".", "to_rgb", "(", "out", ")", "\n", "\n", "", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.OldGenerator.__init__": [[620, 647], ["torch.nn.Module.__init__", "torch.nn.ModuleList", "zip", "model.OldGenerator.layers.append", "model.ConvLayer", "model.ConvLayer", "model.StyledResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "2048", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "gray", "=", "False", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "ch_multiplier", "=", "(", "4", ",", "8", ",", "12", ",", "16", ",", "16", ",", "16", ",", "8", ",", "4", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n", "for", "ch_mul", ",", "up", "in", "zip", "(", "ch_multiplier", ",", "upsample", ")", ":", "\n", "            ", "self", ".", "layers", ".", "append", "(", "\n", "StyledResBlock", "(", "\n", "in_ch", ",", "channel", "*", "ch_mul", ",", "texture_channel", ",", "up", ",", "blur_kernel", "\n", ")", "\n", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "", "if", "gray", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "1", ",", "1", ",", "activate", "=", "False", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "3", ",", "1", ",", "activate", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.OldGenerator.forward": [[648, 659], ["zip", "model.OldGenerator.to_rgb", "layer", "len"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "structure", ",", "texture", ",", "noises", "=", "None", ")", ":", "\n", "        ", "if", "noises", "is", "None", ":", "\n", "            ", "noises", "=", "[", "None", "]", "*", "len", "(", "self", ".", "layers", ")", "\n", "\n", "", "out", "=", "structure", "\n", "for", "layer", ",", "noise", "in", "zip", "(", "self", ".", "layers", ",", "noises", ")", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "texture", ",", "noise", ")", "\n", "\n", "", "out", "=", "self", ".", "to_rgb", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.AugGenerator.__init__": [[661, 687], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.nn.init.normal_", "torch.nn.ModuleList", "zip", "model.ConvLayer", "torch.empty", "model.AugGenerator.layers.append", "model.StyledResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "1024", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "ch_multiplier", "=", "(", "4", ",", "8", ",", "12", ",", "16", ",", "16", ",", "16", ",", "8", ",", "4", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "blank_style", "=", "nn", ".", "Parameter", "(", "torch", ".", "empty", "(", "1", ",", "texture_channel", ")", ")", "\n", "nn", ".", "init", ".", "normal_", "(", "self", ".", "blank_style", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n", "for", "ch_mul", ",", "up", "in", "zip", "(", "ch_multiplier", ",", "upsample", ")", ":", "\n", "            ", "self", ".", "layers", ".", "append", "(", "\n", "StyledResBlock", "(", "\n", "in_ch", ",", "channel", "*", "ch_mul", ",", "texture_channel", ",", "up", ",", "blur_kernel", "\n", ")", "\n", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "3", ",", "1", ",", "activate", "=", "False", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.AugGenerator.forward": [[688, 705], ["structure.size", "zip", "model.AugGenerator.to_rgb", "model.AugGenerator.blank_style.repeat", "layer", "len"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "structure", ",", "texture", "=", "None", ",", "noises", "=", "None", ")", ":", "\n", "        ", "if", "noises", "is", "None", ":", "\n", "            ", "noises", "=", "[", "None", "]", "*", "len", "(", "self", ".", "layers", ")", "\n", "\n", "", "batch_size", "=", "structure", ".", "size", "(", "0", ")", "\n", "if", "texture", "is", "None", ":", "\n", "            ", "final_style", "=", "self", ".", "blank_style", ".", "repeat", "(", "batch_size", ",", "1", ")", "\n", "", "else", ":", "\n", "            ", "final_style", "=", "self", ".", "blank_style", "+", "texture", "\n", "\n", "", "out", "=", "structure", "\n", "for", "layer", ",", "noise", "in", "zip", "(", "self", ".", "layers", ",", "noises", ")", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "final_style", ",", "noise", ")", "\n", "\n", "", "out", "=", "self", ".", "to_rgb", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Discriminator.__init__": [[708, 745], ["torch.nn.Module.__init__", "int", "range", "torch.nn.Sequential", "model.ConvLayer", "torch.nn.Sequential", "math.log", "convs.append", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "model.ConvLayer", "model.ConvLayer", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "size", ",", "channel_multiplier", "=", "1", ",", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "channels", "=", "{", "\n", "4", ":", "512", ",", "\n", "8", ":", "512", ",", "\n", "16", ":", "512", ",", "\n", "32", ":", "512", ",", "\n", "64", ":", "256", "*", "channel_multiplier", ",", "\n", "128", ":", "128", "*", "channel_multiplier", ",", "\n", "256", ":", "64", "*", "channel_multiplier", ",", "\n", "512", ":", "32", "*", "channel_multiplier", ",", "\n", "1024", ":", "16", "*", "channel_multiplier", ",", "\n", "}", "\n", "\n", "if", "gray", ":", "\n", "            ", "convs", "=", "[", "ConvLayer", "(", "1", ",", "channels", "[", "size", "]", ",", "1", ")", "]", "\n", "", "else", ":", "\n", "            ", "convs", "=", "[", "ConvLayer", "(", "3", ",", "channels", "[", "size", "]", ",", "1", ")", "]", "\n", "\n", "", "log_size", "=", "int", "(", "math", ".", "log", "(", "size", ",", "2", ")", ")", "\n", "\n", "in_channel", "=", "channels", "[", "size", "]", "\n", "\n", "for", "i", "in", "range", "(", "log_size", ",", "2", ",", "-", "1", ")", ":", "\n", "            ", "out_channel", "=", "channels", "[", "2", "**", "(", "i", "-", "1", ")", "]", "\n", "\n", "convs", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "out_channel", ",", "downsample", "=", "True", ")", ")", "\n", "\n", "in_channel", "=", "out_channel", "\n", "\n", "", "self", ".", "convs", "=", "nn", ".", "Sequential", "(", "*", "convs", ")", "\n", "\n", "self", ".", "final_conv", "=", "ConvLayer", "(", "in_channel", ",", "channels", "[", "4", "]", ",", "3", ")", "\n", "self", ".", "final_linear", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "channels", "[", "4", "]", "*", "4", "*", "4", ",", "channels", "[", "4", "]", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channels", "[", "4", "]", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Discriminator.forward": [[747, 755], ["model.Discriminator.convs", "model.Discriminator.final_conv", "model.Discriminator.view", "model.Discriminator.final_linear"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "convs", "(", "input", ")", "\n", "out", "=", "self", ".", "final_conv", "(", "out", ")", "\n", "\n", "out", "=", "out", ".", "view", "(", "out", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "out", "=", "self", ".", "final_linear", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarDiscriminator.__init__": [[757, 791], ["torch.nn.Module.__init__", "int", "range", "torch.nn.Sequential", "model.ConvLayer", "torch.nn.Sequential", "math.log", "convs.append", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "model.ConvLayer", "model.ConvLayer", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "size", ",", "channel_multiplier", "=", "1", ",", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "channels", "=", "{", "\n", "4", ":", "128", ",", "\n", "8", ":", "64", ",", "\n", "16", ":", "64", ",", "\n", "32", ":", "32", "*", "channel_multiplier", ",", "\n", "64", ":", "32", "*", "channel_multiplier", ",", "\n", "128", ":", "32", "*", "channel_multiplier", ",", "\n", "}", "\n", "\n", "if", "gray", ":", "\n", "            ", "convs", "=", "[", "ConvLayer", "(", "1", ",", "channels", "[", "size", "]", ",", "1", ")", "]", "\n", "", "else", ":", "\n", "            ", "convs", "=", "[", "ConvLayer", "(", "3", ",", "channels", "[", "size", "]", ",", "1", ")", "]", "\n", "\n", "", "log_size", "=", "int", "(", "math", ".", "log", "(", "size", ",", "2", ")", ")", "\n", "\n", "in_channel", "=", "channels", "[", "size", "]", "\n", "\n", "for", "i", "in", "range", "(", "log_size", ",", "2", ",", "-", "1", ")", ":", "\n", "            ", "out_channel", "=", "channels", "[", "2", "**", "(", "i", "-", "1", ")", "]", "\n", "\n", "convs", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "out_channel", ",", "downsample", "=", "True", ")", ")", "\n", "\n", "in_channel", "=", "out_channel", "\n", "\n", "", "self", ".", "convs", "=", "nn", ".", "Sequential", "(", "*", "convs", ")", "\n", "\n", "self", ".", "final_conv", "=", "ConvLayer", "(", "in_channel", ",", "channels", "[", "4", "]", ",", "3", ")", "\n", "self", ".", "final_linear", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "channels", "[", "4", "]", "*", "4", "*", "4", ",", "channels", "[", "4", "]", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channels", "[", "4", "]", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CifarDiscriminator.forward": [[793, 801], ["model.CifarDiscriminator.convs", "model.CifarDiscriminator.final_conv", "model.CifarDiscriminator.view", "model.CifarDiscriminator.final_linear"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "convs", "(", "input", ")", "\n", "out", "=", "self", ".", "final_conv", "(", "out", ")", "\n", "\n", "out", "=", "out", ".", "view", "(", "out", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "out", "=", "self", ".", "final_linear", "(", "out", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CooccurDiscriminator.__init__": [[803, 841], ["torch.nn.Module.__init__", "zip", "encoder.append", "torch.nn.Sequential", "torch.nn.Sequential", "model.ConvLayer", "encoder.append", "model.ConvLayer", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "size", "=", "256", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "encoder", "=", "[", "ConvLayer", "(", "3", ",", "channel", ",", "1", ")", "]", "\n", "\n", "if", "size", ">=", "32", ":", "\n", "            ", "ch_multiplier", "=", "(", "2", ",", "4", ",", "8", ",", "12", ",", "12", ",", "24", ")", "\n", "downsample", "=", "(", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "False", ")", "\n", "", "elif", "size", "==", "16", ":", "\n", "            ", "ch_multiplier", "=", "(", "2", ",", "4", ",", "8", ",", "12", ",", "24", ")", "\n", "downsample", "=", "(", "True", ",", "True", ",", "True", ",", "True", ",", "False", ")", "\n", "", "elif", "size", "==", "8", ":", "\n", "            ", "ch_multiplier", "=", "(", "2", ",", "4", ",", "8", ",", "12", ")", "\n", "downsample", "=", "(", "True", ",", "True", ",", "True", ",", "False", ")", "\n", "", "in_ch", "=", "channel", "\n", "for", "ch_mul", ",", "down", "in", "zip", "(", "ch_multiplier", ",", "downsample", ")", ":", "\n", "            ", "encoder", ".", "append", "(", "ResBlock", "(", "in_ch", ",", "channel", "*", "ch_mul", ",", "down", ")", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "", "if", "size", ">", "511", ":", "\n", "            ", "k_size", "=", "3", "\n", "feat_size", "=", "2", "*", "2", "\n", "\n", "", "else", ":", "\n", "            ", "k_size", "=", "2", "\n", "feat_size", "=", "1", "*", "1", "\n", "\n", "", "encoder", ".", "append", "(", "ConvLayer", "(", "in_ch", ",", "channel", "*", "12", ",", "k_size", ",", "padding", "=", "\"valid\"", ")", ")", "\n", "\n", "self", ".", "encoder", "=", "nn", ".", "Sequential", "(", "*", "encoder", ")", "\n", "\n", "self", ".", "linear", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "\n", "channel", "*", "12", "*", "2", "*", "feat_size", ",", "channel", "*", "32", ",", "activation", "=", "\"fused_lrelu\"", "\n", ")", ",", "\n", "EqualLinear", "(", "channel", "*", "32", ",", "channel", "*", "32", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channel", "*", "32", ",", "channel", "*", "16", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channel", "*", "16", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.CooccurDiscriminator.forward": [[843, 858], ["model.CooccurDiscriminator.encoder", "torch.cat", "torch.flatten", "model.CooccurDiscriminator.linear", "model.CooccurDiscriminator.encoder", "ref_input.mean.mean.view", "ref_input.mean.mean.mean"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "input", ",", "reference", "=", "None", ",", "ref_batch", "=", "None", ",", "ref_input", "=", "None", ")", ":", "\n", "# print(input.shape)", "\n", "        ", "out_input", "=", "self", ".", "encoder", "(", "input", ")", "\n", "\n", "if", "ref_input", "is", "None", ":", "\n", "            ", "ref_input", "=", "self", ".", "encoder", "(", "reference", ")", "\n", "_", ",", "channel", ",", "height", ",", "width", "=", "ref_input", ".", "shape", "\n", "ref_input", "=", "ref_input", ".", "view", "(", "-", "1", ",", "ref_batch", ",", "channel", ",", "height", ",", "width", ")", "\n", "ref_input", "=", "ref_input", ".", "mean", "(", "1", ")", "\n", "\n", "", "out", "=", "torch", ".", "cat", "(", "(", "out_input", ",", "ref_input", ")", ",", "1", ")", "\n", "out", "=", "torch", ".", "flatten", "(", "out", ",", "1", ")", "\n", "out", "=", "self", ".", "linear", "(", "out", ")", "\n", "\n", "return", "out", ",", "ref_input", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Cooccurv2Discriminator.__init__": [[866, 913], ["torch.nn.Module.__init__", "zip", "encoder.append", "encoder.append", "torch.nn.Sequential", "torch.nn.Sequential", "encoder.append", "model.ConvLayer", "torch.nn.AdaptiveAvgPool2d", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "torch.nn.Sequential", "model.ConvLayer", "model.ConvLayer", "model.ResBlock", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "ValueError"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "channel", ",", "size", "=", "256", ",", "sup", "=", "False", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "sup", "=", "sup", "\n", "if", "gray", ":", "\n", "            ", "encoder", "=", "[", "ConvLayer", "(", "1", ",", "channel", ",", "1", ")", "]", "\n", "", "else", ":", "\n", "            ", "encoder", "=", "[", "ConvLayer", "(", "3", ",", "channel", ",", "1", ")", "]", "\n", "\n", "", "if", "size", ">=", "32", ":", "\n", "            ", "ch_multiplier", "=", "(", "2", ",", "4", ",", "8", ",", "12", ",", "24", ")", "\n", "downsample", "=", "(", "True", ",", "True", ",", "True", ",", "True", ",", "False", ")", "\n", "", "elif", "size", "==", "16", ":", "\n", "            ", "ch_multiplier", "=", "(", "2", ",", "4", ",", "8", ",", "12", ")", "\n", "downsample", "=", "(", "True", ",", "True", ",", "True", ",", "False", ")", "\n", "", "elif", "size", "==", "8", ":", "\n", "            ", "ch_multiplier", "=", "(", "2", ",", "4", ",", "8", ")", "\n", "downsample", "=", "(", "True", ",", "True", ",", "False", ")", "\n", "", "else", ":", "\n", "            ", "raise", "ValueError", "(", "f\"Unsupported input size {size} for Cooccurv2Discriminator\"", ")", "\n", "\n", "", "in_ch", "=", "channel", "\n", "for", "ch_mul", ",", "down", "in", "zip", "(", "ch_multiplier", ",", "downsample", ")", ":", "\n", "            ", "encoder", ".", "append", "(", "ResBlock", "(", "in_ch", ",", "channel", "*", "ch_mul", ",", "down", ")", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "# last conv layer", "\n", "", "k_size", "=", "3", "if", "size", ">=", "256", "else", "1", "\n", "encoder", ".", "append", "(", "ConvLayer", "(", "in_ch", ",", "channel", "*", "12", ",", "k_size", ",", "padding", "=", "\"valid\"", ")", ")", "\n", "\n", "# Average pool over spatial dimension", "\n", "encoder", ".", "append", "(", "nn", ".", "AdaptiveAvgPool2d", "(", "(", "1", ",", "1", ")", ")", ")", "\n", "\n", "self", ".", "encoder", "=", "nn", ".", "Sequential", "(", "*", "encoder", ")", "\n", "\n", "self", ".", "linear", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "\n", "channel", "*", "12", "*", "2", ",", "channel", "*", "32", ",", "activation", "=", "\"fused_lrelu\"", "\n", ")", ",", "\n", "EqualLinear", "(", "channel", "*", "32", ",", "channel", "*", "32", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channel", "*", "32", ",", "channel", "*", "16", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channel", "*", "16", ",", "1", ")", ",", "\n", ")", "\n", "\n", "if", "sup", ":", "\n", "            ", "self", ".", "cls_fc", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "channel", "*", "12", ",", "channel", "*", "16", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channel", "*", "16", ",", "14", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.Cooccurv2Discriminator.forward": [[915, 940], ["model.Cooccurv2Discriminator.encoder", "torch.cat", "torch.flatten", "model.Cooccurv2Discriminator.linear", "model.Cooccurv2Discriminator.view().max", "model.Cooccurv2Discriminator.encoder", "ref_input.view.view.view", "ref_input.view.view.max", "model.Cooccurv2Discriminator.cls_fc", "model.Cooccurv2Discriminator.view", "torch.flatten"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "input", ",", "n_crop", ",", "reference", "=", "None", ",", "ref_batch", "=", "None", ",", "ref_input", "=", "None", ")", ":", "\n", "        ", "ref_pred", "=", "None", "\n", "# [batch*n_crop, channel, h, w]", "\n", "out_input", "=", "self", ".", "encoder", "(", "input", ")", "\n", "_", ",", "channel", ",", "height", ",", "width", "=", "out_input", ".", "shape", "\n", "# [batch, channel, h, w]", "\n", "out_input", "=", "out_input", ".", "view", "(", "-", "1", ",", "n_crop", ",", "channel", ",", "height", ",", "width", ")", ".", "max", "(", "1", ")", "[", "0", "]", "\n", "\n", "# [batch, channel, h, w]", "\n", "if", "ref_input", "is", "None", ":", "\n", "            ", "ref_input", "=", "self", ".", "encoder", "(", "reference", ")", "\n", "_", ",", "channel", ",", "height", ",", "width", "=", "ref_input", ".", "shape", "\n", "ref_input", "=", "ref_input", ".", "view", "(", "-", "1", ",", "n_crop", "*", "ref_batch", ",", "channel", ",", "height", ",", "width", ")", "\n", "ref_input", "=", "ref_input", ".", "max", "(", "1", ")", "[", "0", "]", "\n", "if", "self", ".", "sup", ":", "\n", "                ", "ref_pred", "=", "self", ".", "cls_fc", "(", "torch", ".", "flatten", "(", "ref_input", ",", "1", ")", ")", "\n", "\n", "", "", "out", "=", "torch", ".", "cat", "(", "(", "out_input", ",", "ref_input", ")", ",", "1", ")", "\n", "out", "=", "torch", ".", "flatten", "(", "out", ",", "1", ")", "\n", "out", "=", "self", ".", "linear", "(", "out", ")", "\n", "\n", "if", "ref_pred", "is", "not", "None", ":", "\n", "            ", "return", "out", ",", "ref_input", ",", "ref_pred", "\n", "", "else", ":", "\n", "            ", "return", "out", ",", "ref_input", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.PatchDiscriminator.__init__": [[947, 966], ["torch.nn.Module.__init__", "torch.nn.ModuleList", "torch.nn.Sequential", "isinstance", "len", "len", "torch.nn.Sequential", "model.PatchDiscriminator.encoder.append", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "len", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear", "len"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "channels", ",", "weights", "=", "1", ",", "code_dim", "=", "512", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "if", "not", "isinstance", "(", "weights", ",", "(", "tuple", ",", "list", ")", ")", ":", "\n", "            ", "weights", "=", "[", "weights", "]", "*", "len", "(", "channels", ")", "\n", "", "assert", "(", "len", "(", "weights", ")", "==", "len", "(", "channels", ")", ")", "\n", "self", ".", "weights", "=", "weights", "\n", "\n", "self", ".", "encoder", "=", "nn", ".", "ModuleList", "(", ")", "\n", "for", "channel", "in", "channels", ":", "\n", "            ", "enc", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "channel", ",", "code_dim", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "code_dim", ",", "code_dim", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", ")", "\n", "self", ".", "encoder", ".", "append", "(", "enc", ")", "\n", "\n", "", "self", ".", "linear", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "code_dim", "*", "len", "(", "channels", ")", "*", "2", ",", "code_dim", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "code_dim", ",", "code_dim", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "code_dim", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.PatchDiscriminator.forward": [[968, 992], ["enumerate", "torch.cat", "torch.cat", "model.PatchDiscriminator.linear", "torch.cat.append", "torch.cat.view().max", "enumerate", "torch.cat", "torch.cat.append", "torch.cat.view().max", "torch.cat.view", "torch.cat.view"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs", ",", "n_crop", ",", "references", "=", "None", ",", "ref_inputs", "=", "None", ")", ":", "\n", "# encode inputs", "\n", "        ", "out_inputs", "=", "[", "]", "\n", "for", "i", ",", "input", "in", "enumerate", "(", "inputs", ")", ":", "\n", "            ", "out_inputs", ".", "append", "(", "self", ".", "weights", "[", "i", "]", "*", "self", ".", "encoder", "[", "i", "]", "(", "input", ")", ")", "\n", "# [batch*n_crop, 1536]", "\n", "", "out_inputs", "=", "torch", ".", "cat", "(", "out_inputs", ",", "1", ")", "\n", "_", ",", "channel", "=", "out_inputs", ".", "shape", "\n", "# [batch, channel]", "\n", "out_inputs", "=", "out_inputs", ".", "view", "(", "-", "1", ",", "n_crop", ",", "channel", ")", ".", "max", "(", "1", ")", "[", "0", "]", "\n", "\n", "# [batch*n_crop, channel]", "\n", "if", "ref_inputs", "is", "None", ":", "\n", "            ", "ref_inputs", "=", "[", "]", "\n", "for", "i", ",", "ref", "in", "enumerate", "(", "references", ")", ":", "\n", "                ", "ref_inputs", ".", "append", "(", "self", ".", "weights", "[", "i", "]", "*", "self", ".", "encoder", "[", "i", "]", "(", "ref", ")", ")", "\n", "", "ref_inputs", "=", "torch", ".", "cat", "(", "ref_inputs", ",", "1", ")", "\n", "_", ",", "channel", "=", "ref_inputs", ".", "shape", "\n", "ref_inputs", "=", "ref_inputs", ".", "view", "(", "-", "1", ",", "n_crop", ",", "channel", ")", ".", "max", "(", "1", ")", "[", "0", "]", "\n", "\n", "", "out", "=", "torch", ".", "cat", "(", "(", "out_inputs", ",", "ref_inputs", ")", ",", "1", ")", "\n", "out", "=", "self", ".", "linear", "(", "out", ")", "\n", "\n", "return", "out", ",", "ref_inputs", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.MultiProjectors.__init__": [[994, 1006], ["torch.nn.Module.__init__", "torch.nn.ModuleList", "torch.nn.Sequential", "model.MultiProjectors.projectors.append", "stylegan2.model.EqualLinear", "stylegan2.model.EqualLinear"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channels", ",", "use_mlp", "=", "True", ",", "norm", "=", "True", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "use_mlp", "=", "use_mlp", "\n", "self", ".", "norm", "=", "norm", "\n", "\n", "self", ".", "projectors", "=", "nn", ".", "ModuleList", "(", ")", "\n", "for", "channel", "in", "channels", ":", "\n", "            ", "proj", "=", "nn", ".", "Sequential", "(", "\n", "EqualLinear", "(", "channel", ",", "channel", "//", "2", ",", "activation", "=", "\"fused_lrelu\"", ")", ",", "\n", "EqualLinear", "(", "channel", "//", "2", ",", "channel", ")", "\n", ")", "\n", "self", ".", "projectors", ".", "append", "(", "proj", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.MultiProjectors.forward": [[1007, 1024], ["enumerate", "projected.append", "feat.pow().sum().pow", "normed_projected.append", "feat.div", "feat.pow().sum", "feat.pow"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "feats", ")", ":", "\n", "        ", "if", "self", ".", "use_mlp", ":", "\n", "            ", "projected", "=", "[", "]", "\n", "for", "i", ",", "feat", "in", "enumerate", "(", "feats", ")", ":", "\n", "                ", "projected", ".", "append", "(", "self", ".", "projectors", "[", "i", "]", "(", "feat", ")", ")", "\n", "", "", "else", ":", "\n", "            ", "projected", "=", "feats", "\n", "\n", "", "if", "self", ".", "norm", ":", "\n", "            ", "normed_projected", "=", "[", "]", "\n", "for", "feat", "in", "projected", ":", "\n", "# l2 norm after projection", "\n", "                ", "norm", "=", "feat", ".", "pow", "(", "2", ")", ".", "sum", "(", "1", ",", "keepdim", "=", "True", ")", ".", "pow", "(", "1.", "/", "2", ")", "\n", "normed_projected", ".", "append", "(", "feat", ".", "div", "(", "norm", "+", "1e-7", ")", ")", "\n", "", "return", "normed_projected", "\n", "", "else", ":", "\n", "            ", "return", "projected", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.PatchNCELoss.__init__": [[1026, 1032], ["torch.nn.Module.__init__", "torch.nn.CrossEntropyLoss", "packaging.version.parse", "packaging.version.parse"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "nce_T", ",", "batch", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "nce_T", "=", "nce_T", "\n", "self", ".", "batch", "=", "batch", "\n", "self", ".", "cross_entropy_loss", "=", "torch", ".", "nn", ".", "CrossEntropyLoss", "(", "reduction", "=", "'mean'", ")", "\n", "self", ".", "mask_dtype", "=", "torch", ".", "uint8", "if", "version", ".", "parse", "(", "torch", ".", "__version__", ")", "<", "version", ".", "parse", "(", "'1.2.0'", ")", "else", "torch", ".", "bool", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.model.PatchNCELoss.forward": [[1033, 1063], ["feat_k.view.view.detach", "torch.bmm", "l_pos.view.view.view", "feat_q.view.view.view", "feat_k.view.view.view", "feat_q.view.view.size", "torch.bmm", "torch.bmm.masked_fill_", "torch.bmm.view", "model.PatchNCELoss.cross_entropy_loss", "feat_q.view.view.view", "feat_k.view.view.view", "feat_k.view.view.transpose", "torch.eye", "torch.cat", "torch.zeros", "out.size"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "feat_q", ",", "feat_k", ")", ":", "\n", "        ", "batchSize", "=", "feat_q", ".", "shape", "[", "0", "]", "\n", "dim", "=", "feat_q", ".", "shape", "[", "1", "]", "\n", "feat_k", "=", "feat_k", ".", "detach", "(", ")", "\n", "\n", "# pos logit", "\n", "l_pos", "=", "torch", ".", "bmm", "(", "feat_q", ".", "view", "(", "batchSize", ",", "1", ",", "-", "1", ")", ",", "feat_k", ".", "view", "(", "batchSize", ",", "-", "1", ",", "1", ")", ")", "\n", "l_pos", "=", "l_pos", ".", "view", "(", "batchSize", ",", "1", ")", "\n", "\n", "# neg logit", "\n", "batch_dim_for_bmm", "=", "self", ".", "batch", "\n", "# reshape features to batch size", "\n", "feat_q", "=", "feat_q", ".", "view", "(", "batch_dim_for_bmm", ",", "-", "1", ",", "dim", ")", "\n", "feat_k", "=", "feat_k", ".", "view", "(", "batch_dim_for_bmm", ",", "-", "1", ",", "dim", ")", "\n", "npatches", "=", "feat_q", ".", "size", "(", "1", ")", "\n", "l_neg_curbatch", "=", "torch", ".", "bmm", "(", "feat_q", ",", "feat_k", ".", "transpose", "(", "2", ",", "1", ")", ")", "\n", "\n", "# diagonal entries are similarity between same features, and hence meaningless.", "\n", "# just fill the diagonal with very small number, which is exp(-10) and almost zero", "\n", "diagonal", "=", "torch", ".", "eye", "(", "npatches", ",", "device", "=", "feat_q", ".", "device", ",", "dtype", "=", "self", ".", "mask_dtype", ")", "[", "None", ",", ":", ",", ":", "]", "\n", "l_neg_curbatch", ".", "masked_fill_", "(", "diagonal", ",", "-", "10.0", ")", "\n", "l_neg", "=", "l_neg_curbatch", ".", "view", "(", "-", "1", ",", "npatches", ")", "\n", "\n", "out", "=", "torch", ".", "cat", "(", "(", "l_pos", ",", "l_neg", ")", ",", "dim", "=", "1", ")", "/", "self", ".", "nce_T", "\n", "\n", "loss", "=", "self", ".", "cross_entropy_loss", "(", "out", ",", "torch", ".", "zeros", "(", "out", ".", "size", "(", "0", ")", ",", "dtype", "=", "torch", ".", "long", ",", "\n", "device", "=", "feat_q", ".", "device", ")", ")", "\n", "# pdb.set_trace()", "\n", "\n", "return", "loss", "", "", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.Classifier.__init__": [[30, 46], ["torch.nn.Module.__init__", "model.PyramidEncoder", "torch.nn.Linear", "torch.nn.Linear", "print", "scipy.truncnorm", "torch.as_tensor", "torch.as_tensor", "torch.as_tensor", "torch.as_tensor", "values.view.view.view", "train_texencoder_cxr14.Classifier.encoder.load_state_dict", "scipy.truncnorm.rvs", "train_texencoder_cxr14.Classifier.fc.weight.size", "torch.no_grad", "torch.no_grad", "torch.no_grad", "torch.no_grad", "train_texencoder_cxr14.Classifier.fc.weight.copy_", "train_texencoder_cxr14.Classifier.fc.weight.numel"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "out_dim", ",", "enc_state_dict", "=", "None", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "encoder", "=", "PyramidEncoder", "(", "channel", ",", "gray", "=", "gray", ")", "\n", "self", ".", "fc", "=", "nn", ".", "Linear", "(", "2048", ",", "out_dim", ")", "\n", "# init encoder", "\n", "if", "enc_state_dict", "is", "not", "None", ":", "\n", "            ", "self", ".", "encoder", ".", "load_state_dict", "(", "enc_state_dict", ")", "\n", "# requires_grad(self.encoder, False)", "\n", "# self.encoder.eval()", "\n", "", "print", "(", "\"loaded\"", ")", "\n", "# init fc", "\n", "X", "=", "stats", ".", "truncnorm", "(", "-", "2", ",", "2", ",", "scale", "=", "0.1", ")", "\n", "values", "=", "torch", ".", "as_tensor", "(", "X", ".", "rvs", "(", "self", ".", "fc", ".", "weight", ".", "numel", "(", ")", ")", ",", "dtype", "=", "self", ".", "fc", ".", "weight", ".", "dtype", ")", "\n", "values", "=", "values", ".", "view", "(", "self", ".", "fc", ".", "weight", ".", "size", "(", ")", ")", "\n", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "            ", "self", ".", "fc", ".", "weight", ".", "copy_", "(", "values", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.Classifier.forward": [[47, 53], ["train_texencoder_cxr14.Classifier.encoder", "train_texencoder_cxr14.Classifier.fc"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "data", ")", ":", "\n", "# with torch.no_grad():", "\n", "# code, _ = self.encoder(data, run_tex=False, multi_str=False)", "\n", "        ", "_", ",", "code", "=", "self", ".", "encoder", "(", "data", ",", "run_str", "=", "False", ",", "multi_tex", "=", "False", ")", "\n", "# code = code.flatten(start_dim=1)", "\n", "return", "self", ".", "fc", "(", "code", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.data_sampler": [[54, 63], ["torch.utils.data.distributed.DistributedSampler", "torch.utils.data.RandomSampler", "torch.utils.data.SequentialSampler"], "function", ["None"], ["", "", "def", "data_sampler", "(", "dataset", ",", "shuffle", ",", "distributed", ")", ":", "\n", "    ", "if", "distributed", ":", "\n", "        ", "return", "data", ".", "distributed", ".", "DistributedSampler", "(", "dataset", ",", "shuffle", "=", "shuffle", ")", "\n", "\n", "", "if", "shuffle", ":", "\n", "        ", "return", "data", ".", "RandomSampler", "(", "dataset", ")", "\n", "\n", "", "else", ":", "\n", "        ", "return", "data", ".", "SequentialSampler", "(", "dataset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.requires_grad": [[65, 68], ["model.parameters"], "function", ["None"], ["", "", "def", "requires_grad", "(", "model", ",", "flag", "=", "True", ")", ":", "\n", "    ", "for", "p", "in", "model", ".", "parameters", "(", ")", ":", "\n", "        ", "p", ".", "requires_grad", "=", "flag", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.sample_data": [[69, 73], ["None"], "function", ["None"], ["", "", "def", "sample_data", "(", "loader", ")", ":", "\n", "    ", "while", "True", ":", "\n", "        ", "for", "batch", "in", "loader", ":", "\n", "            ", "yield", "batch", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.bce_loss": [[74, 79], ["torch.nn.functional.binary_cross_entropy_with_logits"], "function", ["None"], ["", "", "", "def", "bce_loss", "(", "pred", ",", "label", ")", ":", "\n", "    ", "loss", "=", "F", ".", "binary_cross_entropy_with_logits", "(", "pred", ",", "label", ",", "None", ",", "\n", "pos_weight", "=", "None", ",", "\n", "reduction", "=", "'mean'", ")", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.adjust_learning_rate": [[80, 90], ["math.pow"], "function", ["None"], ["", "def", "adjust_learning_rate", "(", "optimizer", ",", "init_lr", ",", "iter", ",", "lr_steps", ")", ":", "\n", "    ", "nexp", "=", "0", "\n", "for", "step", "in", "lr_steps", ":", "\n", "        ", "if", "iter", "<", "step", ":", "\n", "            ", "break", "\n", "", "else", ":", "\n", "            ", "nexp", "+=", "1", "\n", "", "", "lr", "=", "init_lr", "*", "math", ".", "pow", "(", "10", ",", "-", "nexp", ")", "\n", "for", "param_group", "in", "optimizer", ".", "param_groups", ":", "\n", "        ", "param_group", "[", "'lr'", "]", "=", "lr", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.compute_avg_auc": [[91, 114], ["range", "numpy.array().mean", "AUROCs.append", "print", "ValueError", "sklearn.metrics.roc_auc_score", "numpy.array", "isinstance", "sklearn.metrics.roc_auc_score", "isinstance", "Exception"], "function", ["None"], ["", "", "def", "compute_avg_auc", "(", "gt", ",", "pred", ",", "verbose", "=", "False", ")", ":", "\n", "    ", "AUROCs", "=", "[", "]", "\n", "if", "pred", ".", "ndim", "==", "2", ":", "\n", "        ", "n_classes", "=", "pred", ".", "shape", "[", "1", "]", "\n", "", "elif", "pred", ".", "ndim", "==", "1", ":", "\n", "        ", "n_classes", "=", "1", "\n", "", "else", ":", "\n", "        ", "raise", "ValueError", "(", "\"Prediction shape wrong\"", ")", "\n", "", "for", "i", "in", "range", "(", "n_classes", ")", ":", "\n", "        ", "try", ":", "\n", "            ", "auc", "=", "roc_auc_score", "(", "gt", "[", ":", ",", "i", "]", ",", "pred", "[", ":", ",", "i", "]", ")", "\n", "", "except", "(", "IndexError", ",", "ValueError", ")", "as", "error", ":", "\n", "            ", "if", "isinstance", "(", "error", ",", "IndexError", ")", ":", "\n", "                ", "auc", "=", "roc_auc_score", "(", "gt_np", ",", "pred_np", ")", "\n", "", "elif", "isinstance", "(", "error", ",", "ValueError", ")", ":", "\n", "                ", "auc", "=", "0", "\n", "", "else", ":", "\n", "                ", "raise", "Exception", "(", "\"Unexpected Error\"", ")", "\n", "", "", "AUROCs", ".", "append", "(", "auc", ")", "\n", "", "if", "verbose", ":", "\n", "        ", "print", "(", "AUROCs", ")", "\n", "", "AUROC_avg", "=", "np", ".", "array", "(", "AUROCs", ")", ".", "mean", "(", ")", "\n", "return", "AUROC_avg", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.train": [[115, 218], ["train_texencoder_cxr14.sample_data", "range", "tqdm.tqdm", "os.path.exists", "os.makedirs", "train_texencoder_cxr14.adjust_learning_rate", "next", "real_img.to.to", "label.to.to", "classifier.train", "train_texencoder_cxr14.requires_grad", "classifier", "train_texencoder_cxr14.bce_loss", "c_optim.zero_grad", "bce_loss.backward", "c_optim.step", "loss_dict[].mean().item", "tqdm.tqdm.set_description", "print", "wandb.log", "numpy.concatenate", "numpy.concatenate", "torch.save", "torch.save", "loss_dict[].mean", "torch.no_grad", "torch.no_grad", "train_texencoder_cxr14.compute_avg_auc", "train_texencoder_cxr14.compute_avg_auc", "img.to.to", "label.to.to", "classifier.eval", "classifier", "torch.sigmoid", "torch.sigmoid", "scores_list.append", "labels_list.append", "c_module.state_dict", "c_optim.state_dict", "torch.sigmoid.cpu().data.numpy", "label.to.cpu().data.numpy", "str().zfill", "str", "torch.sigmoid.cpu", "label.to.cpu"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.sample_data", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.adjust_learning_rate", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.train", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.bce_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.backward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.compute_avg_auc", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.None.train_texencoder_cxr14.compute_avg_auc"], ["", "def", "train", "(", "\n", "args", ",", "\n", "tr_loader", ",", "\n", "ts_loader", ",", "\n", "classifier", ",", "\n", "c_optim", ",", "\n", "device", ",", "\n", ")", ":", "\n", "    ", "tr_loader", "=", "sample_data", "(", "tr_loader", ")", "\n", "\n", "pbar", "=", "range", "(", "args", ".", "iter", ")", "\n", "pbar", "=", "tqdm", "(", "pbar", ",", "initial", "=", "args", ".", "start_iter", ",", "dynamic_ncols", "=", "True", ",", "smoothing", "=", "0.01", ")", "\n", "\n", "# define the global variables", "\n", "avg_auc", "=", "0", "\n", "loss_dict", "=", "{", "}", "\n", "\n", "# create output folders", "\n", "if", "args", ".", "proj_name", "!=", "\"\"", ":", "\n", "        ", "ckpt_dir", "=", "f\"outputs/ckpt-{args.proj_name}\"", "\n", "", "else", ":", "\n", "        ", "ckpt_dir", "=", "\"outputs/ckpt\"", "\n", "", "if", "not", "os", ".", "path", ".", "exists", "(", "ckpt_dir", ")", ":", "\n", "        ", "os", ".", "makedirs", "(", "ckpt_dir", ")", "\n", "\n", "", "if", "args", ".", "distributed", ":", "\n", "        ", "c_module", "=", "classifier", ".", "module", "\n", "", "else", ":", "\n", "        ", "c_module", "=", "classifier", "\n", "\n", "", "for", "idx", "in", "pbar", ":", "\n", "        ", "i", "=", "idx", "+", "args", ".", "start_iter", "\n", "\n", "if", "i", ">", "args", ".", "iter", ":", "\n", "            ", "print", "(", "\"Done!\"", ")", "\n", "break", "\n", "\n", "", "adjust_learning_rate", "(", "c_optim", ",", "args", ".", "lr", ",", "i", ",", "args", ".", "lr_steps", ")", "\n", "\n", "real_img", ",", "label", "=", "next", "(", "tr_loader", ")", "\n", "real_img", "=", "real_img", ".", "to", "(", "device", ")", "\n", "label", "=", "label", ".", "to", "(", "device", ")", "\n", "\n", "##### classifier optim #####", "\n", "classifier", ".", "train", "(", ")", "\n", "requires_grad", "(", "classifier", ",", "True", ")", "\n", "\n", "cls_logits", "=", "classifier", "(", "real_img", ")", "\n", "\n", "# Minimize the loss of attr classification", "\n", "cls_loss", "=", "bce_loss", "(", "cls_logits", ",", "label", ")", "\n", "\n", "# attr classification loss", "\n", "loss_dict", "[", "\"cls\"", "]", "=", "cls_loss", "\n", "\n", "# update discriminator", "\n", "c_optim", ".", "zero_grad", "(", ")", "\n", "cls_loss", ".", "backward", "(", ")", "\n", "c_optim", ".", "step", "(", ")", "\n", "\n", "# loss_reduced = reduce_loss_dict(loss_dict)", "\n", "cls_loss_val", "=", "loss_dict", "[", "\"cls\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "\n", "if", "wandb", "and", "args", ".", "wandb", "and", "i", "%", "10", "==", "0", ":", "\n", "            ", "wandb", ".", "log", "(", "\n", "{", "\n", "\"cls_loss\"", ":", "cls_loss_val", ",", "\n", "\"avg_auc\"", ":", "avg_auc", ",", "\n", "}", ",", "\n", "step", "=", "i", ",", "\n", ")", "\n", "\n", "", "if", "i", "%", "200", "==", "0", ":", "\n", "            ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                ", "scores_list", "=", "[", "]", "\n", "labels_list", "=", "[", "]", "\n", "for", "img", ",", "label", "in", "ts_loader", ":", "\n", "                    ", "img", "=", "img", ".", "to", "(", "device", ")", "\n", "label", "=", "label", ".", "to", "(", "device", ")", "\n", "classifier", ".", "eval", "(", ")", "\n", "cls_logits", "=", "classifier", "(", "img", ")", "\n", "cls_scores", "=", "torch", ".", "sigmoid", "(", "cls_logits", ")", "\n", "scores_list", ".", "append", "(", "cls_scores", ".", "cpu", "(", ")", ".", "data", ".", "numpy", "(", ")", ")", "\n", "labels_list", ".", "append", "(", "label", ".", "cpu", "(", ")", ".", "data", ".", "numpy", "(", ")", ")", "\n", "", "", "scores_arr", "=", "np", ".", "concatenate", "(", "scores_list", ",", "axis", "=", "0", ")", "\n", "labels_arr", "=", "np", ".", "concatenate", "(", "labels_list", ",", "axis", "=", "0", ")", "\n", "if", "i", "%", "1000", "==", "0", ":", "\n", "                ", "avg_auc", "=", "compute_avg_auc", "(", "labels_arr", ",", "scores_arr", ",", "verbose", "=", "True", ")", "\n", "", "else", ":", "\n", "                ", "avg_auc", "=", "compute_avg_auc", "(", "labels_arr", ",", "scores_arr", ")", "\n", "# show information", "\n", "", "", "pbar", ".", "set_description", "(", "(", "f\"c: {cls_loss_val:.4f}; avg_auc: {avg_auc:.4f}; lr: {c_optim.param_groups[0]['lr']:.4f}\"", ")", ")", "\n", "\n", "if", "i", "%", "5000", "==", "0", ":", "\n", "            ", "torch", ".", "save", "(", "\n", "{", "\n", "\"c\"", ":", "c_module", ".", "state_dict", "(", ")", ",", "\n", "\"c_optim\"", ":", "c_optim", ".", "state_dict", "(", ")", ",", "\n", "\"args\"", ":", "args", ",", "\n", "\"avg_auc\"", ":", "avg_auc", ",", "\n", "\"iter\"", ":", "i", ",", "\n", "}", ",", "\n", "f\"{ckpt_dir}/{str(i).zfill(6)}.pt\"", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.projector.noise_regularize": [[16, 37], ["noise.mean.reshape", "noise.mean.mean", "torch.roll", "torch.roll"], "function", ["None"], ["def", "noise_regularize", "(", "noises", ")", ":", "\n", "    ", "loss", "=", "0", "\n", "\n", "for", "noise", "in", "noises", ":", "\n", "        ", "size", "=", "noise", ".", "shape", "[", "2", "]", "\n", "\n", "while", "True", ":", "\n", "            ", "loss", "=", "(", "\n", "loss", "\n", "+", "(", "noise", "*", "torch", ".", "roll", "(", "noise", ",", "shifts", "=", "1", ",", "dims", "=", "3", ")", ")", ".", "mean", "(", ")", ".", "pow", "(", "2", ")", "\n", "+", "(", "noise", "*", "torch", ".", "roll", "(", "noise", ",", "shifts", "=", "1", ",", "dims", "=", "2", ")", ")", ".", "mean", "(", ")", ".", "pow", "(", "2", ")", "\n", ")", "\n", "\n", "if", "size", "<=", "8", ":", "\n", "                ", "break", "\n", "\n", "", "noise", "=", "noise", ".", "reshape", "(", "[", "-", "1", ",", "1", ",", "size", "//", "2", ",", "2", ",", "size", "//", "2", ",", "2", "]", ")", "\n", "noise", "=", "noise", ".", "mean", "(", "[", "3", ",", "5", "]", ")", "\n", "size", "//=", "2", "\n", "\n", "", "", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.projector.noise_normalize_": [[39, 45], ["noise.mean", "noise.std", "noise.data.add_().div_", "noise.data.add_"], "function", ["None"], ["", "def", "noise_normalize_", "(", "noises", ")", ":", "\n", "    ", "for", "noise", "in", "noises", ":", "\n", "        ", "mean", "=", "noise", ".", "mean", "(", ")", "\n", "std", "=", "noise", ".", "std", "(", ")", "\n", "\n", "noise", ".", "data", ".", "add_", "(", "-", "mean", ")", ".", "div_", "(", "std", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.projector.get_lr": [[47, 53], ["min", "min", "math.cos"], "function", ["None"], ["", "", "def", "get_lr", "(", "t", ",", "initial_lr", ",", "rampdown", "=", "0.25", ",", "rampup", "=", "0.05", ")", ":", "\n", "    ", "lr_ramp", "=", "min", "(", "1", ",", "(", "1", "-", "t", ")", "/", "rampdown", ")", "\n", "lr_ramp", "=", "0.5", "-", "0.5", "*", "math", ".", "cos", "(", "lr_ramp", "*", "math", ".", "pi", ")", "\n", "lr_ramp", "=", "lr_ramp", "*", "min", "(", "1", ",", "t", "/", "rampup", ")", "\n", "\n", "return", "initial_lr", "*", "lr_ramp", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.projector.latent_noise": [[55, 59], ["torch.randn_like"], "function", ["None"], ["", "def", "latent_noise", "(", "latent", ",", "strength", ")", ":", "\n", "    ", "noise", "=", "torch", ".", "randn_like", "(", "latent", ")", "*", "strength", "\n", "\n", "return", "latent", "+", "noise", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.projector.make_image": [[61, 71], ["tensor.detach().clamp_().add().div_().mul().type().permute().to().numpy", "tensor.detach().clamp_().add().div_().mul().type().permute().to", "tensor.detach().clamp_().add().div_().mul().type().permute", "tensor.detach().clamp_().add().div_().mul().type", "tensor.detach().clamp_().add().div_().mul", "tensor.detach().clamp_().add().div_", "tensor.detach().clamp_().add", "tensor.detach().clamp_", "tensor.detach"], "function", ["None"], ["", "def", "make_image", "(", "tensor", ")", ":", "\n", "    ", "return", "(", "\n", "tensor", ".", "detach", "(", ")", "\n", ".", "clamp_", "(", "min", "=", "-", "1", ",", "max", "=", "1", ")", "\n", ".", "add", "(", "1", ")", "\n", ".", "div_", "(", "2", ")", "\n", ".", "mul", "(", "255", ")", "\n", ".", "type", "(", "torch", ".", "uint8", ")", "\n", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", ".", "to", "(", "\"cpu\"", ")", "\n", ".", "numpy", "(", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.translate_mat": [[25, 33], ["torch.eye().unsqueeze().repeat", "torch.stack", "torch.eye().unsqueeze", "torch.eye"], "function", ["None"], ["def", "translate_mat", "(", "t_x", ",", "t_y", ")", ":", "\n", "    ", "batch", "=", "t_x", ".", "shape", "[", "0", "]", "\n", "\n", "mat", "=", "torch", ".", "eye", "(", "3", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "translate", "=", "torch", ".", "stack", "(", "(", "t_x", ",", "t_y", ")", ",", "1", ")", "\n", "mat", "[", ":", ",", ":", "2", ",", "2", "]", "=", "translate", "\n", "\n", "return", "mat", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.rotate_mat": [[35, 45], ["torch.eye().unsqueeze().repeat", "torch.sin", "torch.cos", "torch.stack().view", "torch.eye().unsqueeze", "torch.stack", "torch.eye"], "function", ["None"], ["", "def", "rotate_mat", "(", "theta", ")", ":", "\n", "    ", "batch", "=", "theta", ".", "shape", "[", "0", "]", "\n", "\n", "mat", "=", "torch", ".", "eye", "(", "3", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "sin_t", "=", "torch", ".", "sin", "(", "theta", ")", "\n", "cos_t", "=", "torch", ".", "cos", "(", "theta", ")", "\n", "rot", "=", "torch", ".", "stack", "(", "(", "cos_t", ",", "-", "sin_t", ",", "sin_t", ",", "cos_t", ")", ",", "1", ")", ".", "view", "(", "batch", ",", "2", ",", "2", ")", "\n", "mat", "[", ":", ",", ":", "2", ",", ":", "2", "]", "=", "rot", "\n", "\n", "return", "mat", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.scale_mat": [[47, 55], ["torch.eye().unsqueeze().repeat", "torch.eye().unsqueeze", "torch.eye"], "function", ["None"], ["", "def", "scale_mat", "(", "s_x", ",", "s_y", ")", ":", "\n", "    ", "batch", "=", "s_x", ".", "shape", "[", "0", "]", "\n", "\n", "mat", "=", "torch", ".", "eye", "(", "3", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "mat", "[", ":", ",", "0", ",", "0", "]", "=", "s_x", "\n", "mat", "[", ":", ",", "1", ",", "1", "]", "=", "s_y", "\n", "\n", "return", "mat", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.translate3d_mat": [[57, 65], ["torch.eye().unsqueeze().repeat", "torch.stack", "torch.eye().unsqueeze", "torch.eye"], "function", ["None"], ["", "def", "translate3d_mat", "(", "t_x", ",", "t_y", ",", "t_z", ")", ":", "\n", "    ", "batch", "=", "t_x", ".", "shape", "[", "0", "]", "\n", "\n", "mat", "=", "torch", ".", "eye", "(", "4", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "translate", "=", "torch", ".", "stack", "(", "(", "t_x", ",", "t_y", ",", "t_z", ")", ",", "1", ")", "\n", "mat", "[", ":", ",", ":", "3", ",", "3", "]", "=", "translate", "\n", "\n", "return", "mat", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.rotate3d_mat": [[67, 86], ["torch.eye().unsqueeze", "torch.tensor().unsqueeze", "torch.tensor", "torch.sin().view", "torch.cos().view", "torch.eye().unsqueeze().repeat", "torch.eye", "torch.tensor", "torch.sin", "torch.cos", "torch.eye().unsqueeze", "torch.tensor.unsqueeze", "torch.eye"], "function", ["None"], ["", "def", "rotate3d_mat", "(", "axis", ",", "theta", ")", ":", "\n", "    ", "batch", "=", "theta", ".", "shape", "[", "0", "]", "\n", "\n", "u_x", ",", "u_y", ",", "u_z", "=", "axis", "\n", "\n", "eye", "=", "torch", ".", "eye", "(", "3", ")", ".", "unsqueeze", "(", "0", ")", "\n", "cross", "=", "torch", ".", "tensor", "(", "[", "(", "0", ",", "-", "u_z", ",", "u_y", ")", ",", "(", "u_z", ",", "0", ",", "-", "u_x", ")", ",", "(", "-", "u_y", ",", "u_x", ",", "0", ")", "]", ")", ".", "unsqueeze", "(", "0", ")", "\n", "outer", "=", "torch", ".", "tensor", "(", "axis", ")", "\n", "outer", "=", "(", "outer", ".", "unsqueeze", "(", "1", ")", "*", "outer", ")", ".", "unsqueeze", "(", "0", ")", "\n", "\n", "sin_t", "=", "torch", ".", "sin", "(", "theta", ")", ".", "view", "(", "-", "1", ",", "1", ",", "1", ")", "\n", "cos_t", "=", "torch", ".", "cos", "(", "theta", ")", ".", "view", "(", "-", "1", ",", "1", ",", "1", ")", "\n", "\n", "rot", "=", "cos_t", "*", "eye", "+", "sin_t", "*", "cross", "+", "(", "1", "-", "cos_t", ")", "*", "outer", "\n", "\n", "eye_4", "=", "torch", ".", "eye", "(", "4", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "eye_4", "[", ":", ",", ":", "3", ",", ":", "3", "]", "=", "rot", "\n", "\n", "return", "eye_4", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.scale3d_mat": [[88, 97], ["torch.eye().unsqueeze().repeat", "torch.eye().unsqueeze", "torch.eye"], "function", ["None"], ["", "def", "scale3d_mat", "(", "s_x", ",", "s_y", ",", "s_z", ")", ":", "\n", "    ", "batch", "=", "s_x", ".", "shape", "[", "0", "]", "\n", "\n", "mat", "=", "torch", ".", "eye", "(", "4", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "mat", "[", ":", ",", "0", ",", "0", "]", "=", "s_x", "\n", "mat", "[", ":", ",", "1", ",", "1", "]", "=", "s_y", "\n", "mat", "[", ":", ",", "2", ",", "2", "]", "=", "s_z", "\n", "\n", "return", "mat", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.luma_flip_mat": [[99, 107], ["torch.eye().unsqueeze().repeat", "torch.tensor", "i.view", "torch.eye().unsqueeze", "torch.ger", "torch.eye"], "function", ["None"], ["", "def", "luma_flip_mat", "(", "axis", ",", "i", ")", ":", "\n", "    ", "batch", "=", "i", ".", "shape", "[", "0", "]", "\n", "\n", "eye", "=", "torch", ".", "eye", "(", "4", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "axis", "=", "torch", ".", "tensor", "(", "axis", "+", "(", "0", ",", ")", ")", "\n", "flip", "=", "2", "*", "torch", ".", "ger", "(", "axis", ",", "axis", ")", "*", "i", ".", "view", "(", "-", "1", ",", "1", ",", "1", ")", "\n", "\n", "return", "eye", "-", "flip", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.saturation_mat": [[109, 118], ["torch.eye().unsqueeze().repeat", "torch.tensor", "torch.ger", "torch.eye().unsqueeze", "i.view", "torch.eye"], "function", ["None"], ["", "def", "saturation_mat", "(", "axis", ",", "i", ")", ":", "\n", "    ", "batch", "=", "i", ".", "shape", "[", "0", "]", "\n", "\n", "eye", "=", "torch", ".", "eye", "(", "4", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "batch", ",", "1", ",", "1", ")", "\n", "axis", "=", "torch", ".", "tensor", "(", "axis", "+", "(", "0", ",", ")", ")", "\n", "axis", "=", "torch", ".", "ger", "(", "axis", ",", "axis", ")", "\n", "saturate", "=", "axis", "+", "(", "eye", "-", "axis", ")", "*", "i", ".", "view", "(", "-", "1", ",", "1", ",", "1", ")", "\n", "\n", "return", "saturate", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.lognormal_sample": [[120, 122], ["torch.empty().log_normal_", "torch.empty"], "function", ["None"], ["", "def", "lognormal_sample", "(", "size", ",", "mean", "=", "0", ",", "std", "=", "1", ")", ":", "\n", "    ", "return", "torch", ".", "empty", "(", "size", ")", ".", "log_normal_", "(", "mean", "=", "mean", ",", "std", "=", "std", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.category_sample": [[124, 129], ["torch.tensor", "torch.randint", "len"], "function", ["None"], ["", "def", "category_sample", "(", "size", ",", "categories", ")", ":", "\n", "    ", "category", "=", "torch", ".", "tensor", "(", "categories", ")", "\n", "sample", "=", "torch", ".", "randint", "(", "high", "=", "len", "(", "categories", ")", ",", "size", "=", "(", "size", ",", ")", ")", "\n", "\n", "return", "category", "[", "sample", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.uniform_sample": [[131, 133], ["torch.empty().uniform_", "torch.empty", "math.pi", "math.pi", "math.pi"], "function", ["None"], ["", "def", "uniform_sample", "(", "size", ",", "low", ",", "high", ")", ":", "\n", "    ", "return", "torch", ".", "empty", "(", "size", ")", ".", "uniform_", "(", "low", ",", "high", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.normal_sample": [[135, 137], ["torch.empty().normal_", "torch.empty"], "function", ["None"], ["", "def", "normal_sample", "(", "size", ",", "mean", "=", "0", ",", "std", "=", "1", ")", ":", "\n", "    ", "return", "torch", ".", "empty", "(", "size", ")", ".", "normal_", "(", "mean", ",", "std", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.bernoulli_sample": [[139, 141], ["torch.empty().bernoulli_", "torch.empty"], "function", ["None"], ["", "def", "bernoulli_sample", "(", "size", ",", "p", ")", ":", "\n", "    ", "return", "torch", ".", "empty", "(", "size", ")", ".", "bernoulli_", "(", "p", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply": [[143, 149], ["bernoulli_sample().view", "non_leaking.bernoulli_sample"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.bernoulli_sample"], ["", "def", "random_mat_apply", "(", "p", ",", "transform", ",", "prev", ",", "eye", ")", ":", "\n", "    ", "size", "=", "transform", ".", "shape", "[", "0", "]", "\n", "select", "=", "bernoulli_sample", "(", "size", ",", "p", ")", ".", "view", "(", "size", ",", "1", ",", "1", ")", "\n", "select_transform", "=", "select", "*", "transform", "+", "(", "1", "-", "select", ")", "*", "eye", "\n", "\n", "return", "select_transform", "@", "prev", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.sample_affine": [[151, 208], ["torch.eye().unsqueeze().repeat", "non_leaking.category_sample", "non_leaking.scale_mat", "non_leaking.random_mat_apply", "non_leaking.category_sample", "non_leaking.rotate_mat", "non_leaking.random_mat_apply", "non_leaking.uniform_sample", "non_leaking.translate_mat", "non_leaking.random_mat_apply", "non_leaking.lognormal_sample", "non_leaking.scale_mat", "non_leaking.random_mat_apply", "non_leaking.uniform_sample", "non_leaking.rotate_mat", "non_leaking.random_mat_apply", "non_leaking.lognormal_sample", "non_leaking.scale_mat", "non_leaking.random_mat_apply", "non_leaking.uniform_sample", "non_leaking.rotate_mat", "non_leaking.random_mat_apply", "non_leaking.normal_sample", "non_leaking.translate_mat", "non_leaking.random_mat_apply", "torch.ones", "torch.round", "torch.round", "math.sqrt", "torch.eye().unsqueeze", "math.log", "math.log", "torch.eye"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.category_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.scale_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.category_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.rotate_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.uniform_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.translate_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.lognormal_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.scale_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.uniform_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.rotate_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.lognormal_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.scale_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.uniform_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.rotate_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.normal_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.translate_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply"], ["", "def", "sample_affine", "(", "p", ",", "size", ",", "height", ",", "width", ")", ":", "\n", "    ", "G", "=", "torch", ".", "eye", "(", "3", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "size", ",", "1", ",", "1", ")", "\n", "eye", "=", "G", "\n", "\n", "# flip", "\n", "param", "=", "category_sample", "(", "size", ",", "(", "0", ",", "1", ")", ")", "\n", "Gc", "=", "scale_mat", "(", "1", "-", "2.0", "*", "param", ",", "torch", ".", "ones", "(", "size", ")", ")", "\n", "G", "=", "random_mat_apply", "(", "p", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('flip', G, scale_mat(1 - 2.0 * param, torch.ones(size)), sep='\\n')", "\n", "\n", "# 90 rotate", "\n", "param", "=", "category_sample", "(", "size", ",", "(", "0", ",", "3", ")", ")", "\n", "Gc", "=", "rotate_mat", "(", "-", "math", ".", "pi", "/", "2", "*", "param", ")", "\n", "G", "=", "random_mat_apply", "(", "p", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('90 rotate', G, rotate_mat(-math.pi / 2 * param), sep='\\n')", "\n", "\n", "# integer translate", "\n", "param", "=", "uniform_sample", "(", "size", ",", "-", "0.125", ",", "0.125", ")", "\n", "param_height", "=", "torch", ".", "round", "(", "param", "*", "height", ")", "/", "height", "\n", "param_width", "=", "torch", ".", "round", "(", "param", "*", "width", ")", "/", "width", "\n", "Gc", "=", "translate_mat", "(", "param_width", ",", "param_height", ")", "\n", "G", "=", "random_mat_apply", "(", "p", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('integer translate', G, translate_mat(param_width, param_height), sep='\\n')", "\n", "\n", "# isotropic scale", "\n", "param", "=", "lognormal_sample", "(", "size", ",", "std", "=", "0.2", "*", "math", ".", "log", "(", "2", ")", ")", "\n", "Gc", "=", "scale_mat", "(", "param", ",", "param", ")", "\n", "G", "=", "random_mat_apply", "(", "p", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('isotropic scale', G, scale_mat(param, param), sep='\\n')", "\n", "\n", "p_rot", "=", "1", "-", "math", ".", "sqrt", "(", "1", "-", "p", ")", "\n", "\n", "# pre-rotate", "\n", "param", "=", "uniform_sample", "(", "size", ",", "-", "math", ".", "pi", ",", "math", ".", "pi", ")", "\n", "Gc", "=", "rotate_mat", "(", "-", "param", ")", "\n", "G", "=", "random_mat_apply", "(", "p_rot", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('pre-rotate', G, rotate_mat(-param), sep='\\n')", "\n", "\n", "# anisotropic scale", "\n", "param", "=", "lognormal_sample", "(", "size", ",", "std", "=", "0.2", "*", "math", ".", "log", "(", "2", ")", ")", "\n", "Gc", "=", "scale_mat", "(", "param", ",", "1", "/", "param", ")", "\n", "G", "=", "random_mat_apply", "(", "p", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('anisotropic scale', G, scale_mat(param, 1 / param), sep='\\n')", "\n", "\n", "# post-rotate", "\n", "param", "=", "uniform_sample", "(", "size", ",", "-", "math", ".", "pi", ",", "math", ".", "pi", ")", "\n", "Gc", "=", "rotate_mat", "(", "-", "param", ")", "\n", "G", "=", "random_mat_apply", "(", "p_rot", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('post-rotate', G, rotate_mat(-param), sep='\\n')", "\n", "\n", "# fractional translate", "\n", "param", "=", "normal_sample", "(", "size", ",", "std", "=", "0.125", ")", "\n", "Gc", "=", "translate_mat", "(", "param", ",", "param", ")", "\n", "G", "=", "random_mat_apply", "(", "p", ",", "Gc", ",", "G", ",", "eye", ")", "\n", "# print('fractional translate', G, translate_mat(param, param), sep='\\n')", "\n", "\n", "return", "G", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.sample_color": [[210, 242], ["torch.eye().unsqueeze().repeat", "non_leaking.normal_sample", "non_leaking.translate3d_mat", "non_leaking.random_mat_apply", "non_leaking.lognormal_sample", "non_leaking.scale3d_mat", "non_leaking.random_mat_apply", "non_leaking.category_sample", "non_leaking.luma_flip_mat", "non_leaking.random_mat_apply", "non_leaking.uniform_sample", "non_leaking.rotate3d_mat", "non_leaking.random_mat_apply", "non_leaking.lognormal_sample", "non_leaking.saturation_mat", "non_leaking.random_mat_apply", "math.sqrt", "torch.eye().unsqueeze", "math.log", "math.log", "torch.eye"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.normal_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.translate3d_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.lognormal_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.scale3d_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.category_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.luma_flip_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.uniform_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.rotate3d_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.lognormal_sample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.saturation_mat", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_mat_apply"], ["", "def", "sample_color", "(", "p", ",", "size", ")", ":", "\n", "    ", "C", "=", "torch", ".", "eye", "(", "4", ")", ".", "unsqueeze", "(", "0", ")", ".", "repeat", "(", "size", ",", "1", ",", "1", ")", "\n", "eye", "=", "C", "\n", "axis_val", "=", "1", "/", "math", ".", "sqrt", "(", "3", ")", "\n", "axis", "=", "(", "axis_val", ",", "axis_val", ",", "axis_val", ")", "\n", "\n", "# brightness", "\n", "param", "=", "normal_sample", "(", "size", ",", "std", "=", "0.2", ")", "\n", "Cc", "=", "translate3d_mat", "(", "param", ",", "param", ",", "param", ")", "\n", "C", "=", "random_mat_apply", "(", "p", ",", "Cc", ",", "C", ",", "eye", ")", "\n", "\n", "# contrast", "\n", "param", "=", "lognormal_sample", "(", "size", ",", "std", "=", "0.5", "*", "math", ".", "log", "(", "2", ")", ")", "\n", "Cc", "=", "scale3d_mat", "(", "param", ",", "param", ",", "param", ")", "\n", "C", "=", "random_mat_apply", "(", "p", ",", "Cc", ",", "C", ",", "eye", ")", "\n", "\n", "# luma flip", "\n", "param", "=", "category_sample", "(", "size", ",", "(", "0", ",", "1", ")", ")", "\n", "Cc", "=", "luma_flip_mat", "(", "axis", ",", "param", ")", "\n", "C", "=", "random_mat_apply", "(", "p", ",", "Cc", ",", "C", ",", "eye", ")", "\n", "\n", "# hue rotation", "\n", "param", "=", "uniform_sample", "(", "size", ",", "-", "math", ".", "pi", ",", "math", ".", "pi", ")", "\n", "Cc", "=", "rotate3d_mat", "(", "axis", ",", "param", ")", "\n", "C", "=", "random_mat_apply", "(", "p", ",", "Cc", ",", "C", ",", "eye", ")", "\n", "\n", "# saturation", "\n", "param", "=", "lognormal_sample", "(", "size", ",", "std", "=", "1", "*", "math", ".", "log", "(", "2", ")", ")", "\n", "Cc", "=", "saturation_mat", "(", "axis", ",", "param", ")", "\n", "C", "=", "random_mat_apply", "(", "p", ",", "Cc", ",", "C", ",", "eye", ")", "\n", "\n", "return", "C", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.make_grid": [[244, 252], ["torch.empty", "torch.linspace", "torch.linspace().unsqueeze", "torch.linspace"], "function", ["None"], ["", "def", "make_grid", "(", "shape", ",", "x0", ",", "x1", ",", "y0", ",", "y1", ",", "device", ")", ":", "\n", "    ", "n", ",", "c", ",", "h", ",", "w", "=", "shape", "\n", "grid", "=", "torch", ".", "empty", "(", "n", ",", "h", ",", "w", ",", "3", ",", "device", "=", "device", ")", "\n", "grid", "[", ":", ",", ":", ",", ":", ",", "0", "]", "=", "torch", ".", "linspace", "(", "x0", ",", "x1", ",", "w", ",", "device", "=", "device", ")", "\n", "grid", "[", ":", ",", ":", ",", ":", ",", "1", "]", "=", "torch", ".", "linspace", "(", "y0", ",", "y1", ",", "h", ",", "device", "=", "device", ")", ".", "unsqueeze", "(", "-", "1", ")", "\n", "grid", "[", ":", ",", ":", ",", ":", ",", "2", "]", "=", "1", "\n", "\n", "return", "grid", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.affine_grid": [[254, 257], ["grid.view", "mat.transpose"], "function", ["None"], ["", "def", "affine_grid", "(", "grid", ",", "mat", ")", ":", "\n", "    ", "n", ",", "h", ",", "w", ",", "_", "=", "grid", ".", "shape", "\n", "return", "(", "grid", ".", "view", "(", "n", ",", "h", "*", "w", ",", "3", ")", "@", "mat", ".", "transpose", "(", "1", ",", "2", ")", ")", ".", "view", "(", "n", ",", "h", ",", "w", ",", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.get_padding": [[259, 286], ["torch.tensor", "torch.tensor().t", "torch.tensor", "extreme.max", "extreme.min"], "function", ["None"], ["", "def", "get_padding", "(", "G", ",", "height", ",", "width", ")", ":", "\n", "    ", "extreme", "=", "(", "\n", "G", "[", ":", ",", ":", "2", ",", ":", "]", "\n", "@", "torch", ".", "tensor", "(", "[", "(", "-", "1.0", ",", "-", "1", ",", "1", ")", ",", "(", "-", "1", ",", "1", ",", "1", ")", ",", "(", "1", ",", "-", "1", ",", "1", ")", ",", "(", "1", ",", "1", ",", "1", ")", "]", ")", ".", "t", "(", ")", "\n", ")", "\n", "\n", "size", "=", "torch", ".", "tensor", "(", "(", "width", ",", "height", ")", ")", "\n", "\n", "pad_low", "=", "(", "\n", "(", "(", "extreme", ".", "min", "(", "-", "1", ")", ".", "values", "+", "1", ")", "*", "size", ")", "\n", ".", "clamp", "(", "max", "=", "0", ")", "\n", ".", "abs", "(", ")", "\n", ".", "ceil", "(", ")", "\n", ".", "max", "(", "0", ")", "\n", ".", "values", ".", "to", "(", "torch", ".", "int64", ")", "\n", ".", "tolist", "(", ")", "\n", ")", "\n", "pad_high", "=", "(", "\n", "(", "extreme", ".", "max", "(", "-", "1", ")", ".", "values", "*", "size", "-", "size", ")", "\n", ".", "clamp", "(", "min", "=", "0", ")", "\n", ".", "ceil", "(", ")", "\n", ".", "max", "(", "0", ")", "\n", ".", "values", ".", "to", "(", "torch", ".", "int64", ")", "\n", ".", "tolist", "(", ")", "\n", ")", "\n", "\n", "return", "pad_low", "[", "0", "]", ",", "pad_high", "[", "0", "]", ",", "pad_low", "[", "1", "]", ",", "pad_high", "[", "1", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.try_sample_affine_and_pad": [[288, 314], ["non_leaking.get_padding", "non_leaking.sample_affine", "torch.inverse", "torch.nn.functional.pad"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.get_padding", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.sample_affine"], ["", "def", "try_sample_affine_and_pad", "(", "img", ",", "p", ",", "pad_k", ",", "G", "=", "None", ")", ":", "\n", "    ", "batch", ",", "_", ",", "height", ",", "width", "=", "img", ".", "shape", "\n", "\n", "G_try", "=", "G", "\n", "\n", "while", "True", ":", "\n", "        ", "if", "G", "is", "None", ":", "\n", "            ", "G_try", "=", "sample_affine", "(", "p", ",", "batch", ",", "height", ",", "width", ")", "\n", "\n", "", "pad_x1", ",", "pad_x2", ",", "pad_y1", ",", "pad_y2", "=", "get_padding", "(", "\n", "torch", ".", "inverse", "(", "G_try", ")", ",", "height", ",", "width", "\n", ")", "\n", "\n", "try", ":", "\n", "            ", "img_pad", "=", "F", ".", "pad", "(", "\n", "img", ",", "\n", "(", "pad_x1", "+", "pad_k", ",", "pad_x2", "+", "pad_k", ",", "pad_y1", "+", "pad_k", ",", "pad_y2", "+", "pad_k", ")", ",", "\n", "mode", "=", "\"reflect\"", ",", "\n", ")", "\n", "\n", "", "except", "RuntimeError", ":", "\n", "            ", "continue", "\n", "\n", "", "break", "\n", "\n", "", "return", "img_pad", ",", "G_try", ",", "(", "pad_x1", ",", "pad_x2", ",", "pad_y1", ",", "pad_y2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_apply_affine": [[316, 372], ["len", "torch.as_tensor", "torch.ger().to", "torch.flip", "non_leaking.try_sample_affine_and_pad", "op.upfirdn2d", "make_grid().to", "non_leaking.affine_grid", "torch.nn.functional.grid_sample", "op.upfirdn2d", "[].to", "torch.tensor", "torch.ger", "non_leaking.make_grid", "torch.tensor", "torch.inverse"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.try_sample_affine_and_pad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.affine_grid", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.make_grid"], ["", "def", "random_apply_affine", "(", "img", ",", "p", ",", "G", "=", "None", ",", "antialiasing_kernel", "=", "SYM6", ")", ":", "\n", "    ", "kernel", "=", "antialiasing_kernel", "\n", "len_k", "=", "len", "(", "kernel", ")", "\n", "pad_k", "=", "(", "len_k", "+", "1", ")", "//", "2", "\n", "\n", "kernel", "=", "torch", ".", "as_tensor", "(", "kernel", ")", "\n", "kernel", "=", "torch", ".", "ger", "(", "kernel", ",", "kernel", ")", ".", "to", "(", "img", ")", "\n", "kernel_flip", "=", "torch", ".", "flip", "(", "kernel", ",", "(", "0", ",", "1", ")", ")", "\n", "\n", "img_pad", ",", "G", ",", "(", "pad_x1", ",", "pad_x2", ",", "pad_y1", ",", "pad_y2", ")", "=", "try_sample_affine_and_pad", "(", "\n", "img", ",", "p", ",", "pad_k", ",", "G", "\n", ")", "\n", "\n", "p_ux1", "=", "pad_x1", "\n", "p_ux2", "=", "pad_x2", "+", "1", "\n", "p_uy1", "=", "pad_y1", "\n", "p_uy2", "=", "pad_y2", "+", "1", "\n", "w_p", "=", "img_pad", ".", "shape", "[", "3", "]", "-", "len_k", "+", "1", "\n", "h_p", "=", "img_pad", ".", "shape", "[", "2", "]", "-", "len_k", "+", "1", "\n", "h_o", "=", "img", ".", "shape", "[", "2", "]", "\n", "w_o", "=", "img", ".", "shape", "[", "3", "]", "\n", "\n", "img_2x", "=", "upfirdn2d", "(", "img_pad", ",", "kernel_flip", ",", "up", "=", "2", ")", "\n", "\n", "grid", "=", "make_grid", "(", "\n", "img_2x", ".", "shape", ",", "\n", "-", "2", "*", "p_ux1", "/", "w_o", "-", "1", ",", "\n", "2", "*", "(", "w_p", "-", "p_ux1", ")", "/", "w_o", "-", "1", ",", "\n", "-", "2", "*", "p_uy1", "/", "h_o", "-", "1", ",", "\n", "2", "*", "(", "h_p", "-", "p_uy1", ")", "/", "h_o", "-", "1", ",", "\n", "device", "=", "img_2x", ".", "device", ",", "\n", ")", ".", "to", "(", "img_2x", ")", "\n", "grid", "=", "affine_grid", "(", "grid", ",", "torch", ".", "inverse", "(", "G", ")", "[", ":", ",", ":", "2", ",", ":", "]", ".", "to", "(", "img_2x", ")", ")", "\n", "grid", "=", "grid", "*", "torch", ".", "tensor", "(", "\n", "[", "w_o", "/", "w_p", ",", "h_o", "/", "h_p", "]", ",", "device", "=", "grid", ".", "device", "\n", ")", "+", "torch", ".", "tensor", "(", "\n", "[", "(", "w_o", "+", "2", "*", "p_ux1", ")", "/", "w_p", "-", "1", ",", "(", "h_o", "+", "2", "*", "p_uy1", ")", "/", "h_p", "-", "1", "]", ",", "device", "=", "grid", ".", "device", "\n", ")", "\n", "\n", "img_affine", "=", "F", ".", "grid_sample", "(", "\n", "img_2x", ",", "grid", ",", "mode", "=", "\"bilinear\"", ",", "align_corners", "=", "False", ",", "padding_mode", "=", "\"zeros\"", "\n", ")", "\n", "\n", "img_down", "=", "upfirdn2d", "(", "img_affine", ",", "kernel", ",", "down", "=", "2", ")", "\n", "\n", "end_y", "=", "-", "pad_y2", "-", "1", "\n", "if", "end_y", "==", "0", ":", "\n", "        ", "end_y", "=", "img_down", ".", "shape", "[", "2", "]", "\n", "\n", "", "end_x", "=", "-", "pad_x2", "-", "1", "\n", "if", "end_x", "==", "0", ":", "\n", "        ", "end_x", "=", "img_down", ".", "shape", "[", "3", "]", "\n", "\n", "", "img", "=", "img_down", "[", ":", ",", ":", ",", "pad_y1", ":", "end_y", ",", "pad_x1", ":", "end_x", "]", "\n", "\n", "return", "img", ",", "G", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.apply_color": [[374, 383], ["img.permute.permute", "mat[].transpose().view", "mat[].view", "img.permute.permute", "mat[].transpose"], "function", ["None"], ["", "def", "apply_color", "(", "img", ",", "mat", ")", ":", "\n", "    ", "batch", "=", "img", ".", "shape", "[", "0", "]", "\n", "img", "=", "img", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "mat_mul", "=", "mat", "[", ":", ",", ":", "3", ",", ":", "3", "]", ".", "transpose", "(", "1", ",", "2", ")", ".", "view", "(", "batch", ",", "1", ",", "3", ",", "3", ")", "\n", "mat_add", "=", "mat", "[", ":", ",", ":", "3", ",", "3", "]", ".", "view", "(", "batch", ",", "1", ",", "1", ",", "3", ")", "\n", "img", "=", "img", "@", "mat_mul", "+", "mat_add", "\n", "img", "=", "img", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "\n", "return", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_apply_color": [[385, 392], ["non_leaking.apply_color", "non_leaking.sample_color", "sample_color.to"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.apply_color", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.sample_color"], ["", "def", "random_apply_color", "(", "img", ",", "p", ",", "C", "=", "None", ")", ":", "\n", "    ", "if", "C", "is", "None", ":", "\n", "        ", "C", "=", "sample_color", "(", "p", ",", "img", ".", "shape", "[", "0", "]", ")", "\n", "\n", "", "img", "=", "apply_color", "(", "img", ",", "C", ".", "to", "(", "img", ")", ")", "\n", "\n", "return", "img", ",", "C", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.augment": [[394, 399], ["non_leaking.random_apply_affine", "non_leaking.random_apply_color"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_apply_affine", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.random_apply_color"], ["", "def", "augment", "(", "img", ",", "p", ",", "transform_matrix", "=", "(", "None", ",", "None", ")", ")", ":", "\n", "    ", "img", ",", "G", "=", "random_apply_affine", "(", "img", ",", "p", ",", "transform_matrix", "[", "0", "]", ")", "\n", "img", ",", "C", "=", "random_apply_color", "(", "img", ",", "p", ",", "transform_matrix", "[", "1", "]", ")", "\n", "\n", "return", "img", ",", "(", "G", ",", "C", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.generate.generate": [[7, 22], ["torch.no_grad", "g_ema.eval", "tqdm.tqdm", "range", "torch.randn", "g_ema", "torchvision.utils.save_image", "str().zfill", "str"], "function", ["None"], ["def", "generate", "(", "args", ",", "g_ema", ",", "device", ",", "mean_latent", ")", ":", "\n", "\n", "    ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "g_ema", ".", "eval", "(", ")", "\n", "for", "i", "in", "tqdm", "(", "range", "(", "args", ".", "pics", ")", ")", ":", "\n", "           ", "sample_z", "=", "torch", ".", "randn", "(", "args", ".", "sample", ",", "args", ".", "latent", ",", "device", "=", "device", ")", "\n", "\n", "sample", ",", "_", "=", "g_ema", "(", "[", "sample_z", "]", ",", "truncation", "=", "args", ".", "truncation", ",", "truncation_latent", "=", "mean_latent", ")", "\n", "\n", "utils", ".", "save_image", "(", "\n", "sample", ",", "\n", "f'sample/{str(i).zfill(6)}.png'", ",", "\n", "nrow", "=", "1", ",", "\n", "normalize", "=", "True", ",", "\n", "range", "=", "(", "-", "1", ",", "1", ")", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_rank": [[9, 17], ["torch.distributed.get_rank", "torch.distributed.is_available", "torch.distributed.is_initialized"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_rank"], ["def", "get_rank", "(", ")", ":", "\n", "    ", "if", "not", "dist", ".", "is_available", "(", ")", ":", "\n", "        ", "return", "0", "\n", "\n", "", "if", "not", "dist", ".", "is_initialized", "(", ")", ":", "\n", "        ", "return", "0", "\n", "\n", "", "return", "dist", ".", "get_rank", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.synchronize": [[19, 32], ["torch.distributed.get_world_size", "torch.distributed.barrier", "torch.distributed.is_available", "torch.distributed.is_initialized"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_world_size"], ["", "def", "synchronize", "(", ")", ":", "\n", "    ", "if", "not", "dist", ".", "is_available", "(", ")", ":", "\n", "        ", "return", "\n", "\n", "", "if", "not", "dist", ".", "is_initialized", "(", ")", ":", "\n", "        ", "return", "\n", "\n", "", "world_size", "=", "dist", ".", "get_world_size", "(", ")", "\n", "\n", "if", "world_size", "==", "1", ":", "\n", "        ", "return", "\n", "\n", "", "dist", ".", "barrier", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_world_size": [[34, 42], ["torch.distributed.get_world_size", "torch.distributed.is_available", "torch.distributed.is_initialized"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_world_size"], ["", "def", "get_world_size", "(", ")", ":", "\n", "    ", "if", "not", "dist", ".", "is_available", "(", ")", ":", "\n", "        ", "return", "1", "\n", "\n", "", "if", "not", "dist", ".", "is_initialized", "(", ")", ":", "\n", "        ", "return", "1", "\n", "\n", "", "return", "dist", ".", "get_world_size", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.reduce_sum": [[44, 55], ["tensor.clone.clone", "torch.distributed.all_reduce", "torch.distributed.is_available", "torch.distributed.is_initialized"], "function", ["None"], ["", "def", "reduce_sum", "(", "tensor", ")", ":", "\n", "    ", "if", "not", "dist", ".", "is_available", "(", ")", ":", "\n", "        ", "return", "tensor", "\n", "\n", "", "if", "not", "dist", ".", "is_initialized", "(", ")", ":", "\n", "        ", "return", "tensor", "\n", "\n", "", "tensor", "=", "tensor", ".", "clone", "(", ")", "\n", "dist", ".", "all_reduce", "(", "tensor", ",", "op", "=", "dist", ".", "ReduceOp", ".", "SUM", ")", "\n", "\n", "return", "tensor", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.gather_grad": [[57, 67], ["distributed.get_world_size", "torch.distributed.all_reduce", "param.grad.data.div_"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_world_size"], ["", "def", "gather_grad", "(", "params", ")", ":", "\n", "    ", "world_size", "=", "get_world_size", "(", ")", "\n", "\n", "if", "world_size", "==", "1", ":", "\n", "        ", "return", "\n", "\n", "", "for", "param", "in", "params", ":", "\n", "        ", "if", "param", ".", "grad", "is", "not", "None", ":", "\n", "            ", "dist", ".", "all_reduce", "(", "param", ".", "grad", ".", "data", ",", "op", "=", "dist", ".", "ReduceOp", ".", "SUM", ")", "\n", "param", ".", "grad", ".", "data", ".", "div_", "(", "world_size", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.all_gather": [[69, 102], ["distributed.get_world_size", "pickle.dumps", "torch.ByteStorage.from_buffer", "torch.ByteTensor().to", "torch.IntTensor().to", "torch.distributed.all_gather", "max", "torch.distributed.all_gather", "zip", "torch.IntTensor().to", "int", "tensor_list.append", "torch.ByteTensor().to", "torch.cat", "data_list.append", "torch.ByteTensor", "torch.IntTensor", "range", "size.item", "torch.ByteTensor().to", "torch.cat.cpu().numpy().tobytes", "pickle.loads", "torch.IntTensor", "torch.ByteTensor", "torch.cat.numel", "torch.ByteTensor", "torch.cat.cpu().numpy", "torch.cat.cpu"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_world_size", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.all_gather", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.all_gather"], ["", "", "", "def", "all_gather", "(", "data", ")", ":", "\n", "    ", "world_size", "=", "get_world_size", "(", ")", "\n", "\n", "if", "world_size", "==", "1", ":", "\n", "        ", "return", "[", "data", "]", "\n", "\n", "", "buffer", "=", "pickle", ".", "dumps", "(", "data", ")", "\n", "storage", "=", "torch", ".", "ByteStorage", ".", "from_buffer", "(", "buffer", ")", "\n", "tensor", "=", "torch", ".", "ByteTensor", "(", "storage", ")", ".", "to", "(", "'cuda'", ")", "\n", "\n", "local_size", "=", "torch", ".", "IntTensor", "(", "[", "tensor", ".", "numel", "(", ")", "]", ")", ".", "to", "(", "'cuda'", ")", "\n", "size_list", "=", "[", "torch", ".", "IntTensor", "(", "[", "0", "]", ")", ".", "to", "(", "'cuda'", ")", "for", "_", "in", "range", "(", "world_size", ")", "]", "\n", "dist", ".", "all_gather", "(", "size_list", ",", "local_size", ")", "\n", "size_list", "=", "[", "int", "(", "size", ".", "item", "(", ")", ")", "for", "size", "in", "size_list", "]", "\n", "max_size", "=", "max", "(", "size_list", ")", "\n", "\n", "tensor_list", "=", "[", "]", "\n", "for", "_", "in", "size_list", ":", "\n", "        ", "tensor_list", ".", "append", "(", "torch", ".", "ByteTensor", "(", "size", "=", "(", "max_size", ",", ")", ")", ".", "to", "(", "'cuda'", ")", ")", "\n", "\n", "", "if", "local_size", "!=", "max_size", ":", "\n", "        ", "padding", "=", "torch", ".", "ByteTensor", "(", "size", "=", "(", "max_size", "-", "local_size", ",", ")", ")", ".", "to", "(", "'cuda'", ")", "\n", "tensor", "=", "torch", ".", "cat", "(", "(", "tensor", ",", "padding", ")", ",", "0", ")", "\n", "\n", "", "dist", ".", "all_gather", "(", "tensor_list", ",", "tensor", ")", "\n", "\n", "data_list", "=", "[", "]", "\n", "\n", "for", "size", ",", "tensor", "in", "zip", "(", "size_list", ",", "tensor_list", ")", ":", "\n", "        ", "buffer", "=", "tensor", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "tobytes", "(", ")", "[", ":", "size", "]", "\n", "data_list", ".", "append", "(", "pickle", ".", "loads", "(", "buffer", ")", ")", "\n", "\n", "", "return", "data_list", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.reduce_loss_dict": [[104, 127], ["distributed.get_world_size", "torch.no_grad", "sorted", "torch.stack", "torch.distributed.reduce", "loss_dict.keys", "keys.append", "torch.stack.append", "torch.distributed.get_rank", "zip"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_world_size", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_rank"], ["", "def", "reduce_loss_dict", "(", "loss_dict", ")", ":", "\n", "    ", "world_size", "=", "get_world_size", "(", ")", "\n", "\n", "if", "world_size", "<", "2", ":", "\n", "        ", "return", "loss_dict", "\n", "\n", "", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "        ", "keys", "=", "[", "]", "\n", "losses", "=", "[", "]", "\n", "\n", "for", "k", "in", "sorted", "(", "loss_dict", ".", "keys", "(", ")", ")", ":", "\n", "            ", "keys", ".", "append", "(", "k", ")", "\n", "losses", ".", "append", "(", "loss_dict", "[", "k", "]", ")", "\n", "\n", "", "losses", "=", "torch", ".", "stack", "(", "losses", ",", "0", ")", "\n", "dist", ".", "reduce", "(", "losses", ",", "dst", "=", "0", ")", "\n", "\n", "if", "dist", ".", "get_rank", "(", ")", "==", "0", ":", "\n", "            ", "losses", "/=", "world_size", "\n", "\n", "", "reduced_losses", "=", "{", "k", ":", "v", "for", "k", ",", "v", "in", "zip", "(", "keys", ",", "losses", ")", "}", "\n", "\n", "", "return", "reduced_losses", "\n", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.InceptionV3.__init__": [[31, 128], ["torch.Module.__init__", "sorted", "max", "torch.ModuleList", "torch.ModuleList", "torch.ModuleList", "models.inception_v3.InceptionV3.blocks.append", "models.inception_v3.InceptionV3.parameters", "inception.fid_inception_v3", "torchvision.models.inception_v3", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "models.inception_v3.InceptionV3.blocks.append", "models.inception_v3.InceptionV3.blocks.append", "models.inception_v3.InceptionV3.blocks.append", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.AdaptiveAvgPool2d", "torch.Sequential", "torch.Sequential", "torch.Sequential"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.fid_inception_v3"], ["def", "__init__", "(", "self", ",", "\n", "output_blocks", "=", "[", "DEFAULT_BLOCK_INDEX", "]", ",", "\n", "resize_input", "=", "True", ",", "\n", "normalize_input", "=", "True", ",", "\n", "requires_grad", "=", "False", ",", "\n", "use_fid_inception", "=", "True", ")", ":", "\n", "        ", "\"\"\"Build pretrained InceptionV3\n\n        Parameters\n        ----------\n        output_blocks : list of int\n            Indices of blocks to return features of. Possible values are:\n                - 0: corresponds to output of first max pooling\n                - 1: corresponds to output of second max pooling\n                - 2: corresponds to output which is fed to aux classifier\n                - 3: corresponds to output of final average pooling\n        resize_input : bool\n            If true, bilinearly resizes input to width and height 299 before\n            feeding input to model. As the network without fully connected\n            layers is fully convolutional, it should be able to handle inputs\n            of arbitrary size, so resizing might not be strictly needed\n        normalize_input : bool\n            If true, scales the input from range (0, 1) to the range the\n            pretrained Inception network expects, namely (-1, 1)\n        requires_grad : bool\n            If true, parameters of the model require gradients. Possibly useful\n            for finetuning the network\n        use_fid_inception : bool\n            If true, uses the pretrained Inception model used in Tensorflow's\n            FID implementation. If false, uses the pretrained Inception model\n            available in torchvision. The FID Inception model has different\n            weights and a slightly different structure from torchvision's\n            Inception model. If you want to compute FID scores, you are\n            strongly advised to set this parameter to true to get comparable\n            results.\n        \"\"\"", "\n", "super", "(", "InceptionV3", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "resize_input", "=", "resize_input", "\n", "self", ".", "normalize_input", "=", "normalize_input", "\n", "self", ".", "output_blocks", "=", "sorted", "(", "output_blocks", ")", "\n", "self", ".", "last_needed_block", "=", "max", "(", "output_blocks", ")", "\n", "\n", "assert", "self", ".", "last_needed_block", "<=", "3", ",", "'Last possible output block index is 3'", "\n", "\n", "self", ".", "blocks", "=", "nn", ".", "ModuleList", "(", ")", "\n", "\n", "if", "use_fid_inception", ":", "\n", "            ", "inception", "=", "fid_inception_v3", "(", ")", "\n", "", "else", ":", "\n", "            ", "inception", "=", "models", ".", "inception_v3", "(", "pretrained", "=", "True", ")", "\n", "\n", "# Block 0: input to maxpool1", "\n", "", "block0", "=", "[", "\n", "inception", ".", "Conv2d_1a_3x3", ",", "\n", "inception", ".", "Conv2d_2a_3x3", ",", "\n", "inception", ".", "Conv2d_2b_3x3", ",", "\n", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "]", "\n", "self", ".", "blocks", ".", "append", "(", "nn", ".", "Sequential", "(", "*", "block0", ")", ")", "\n", "\n", "# Block 1: maxpool1 to maxpool2", "\n", "if", "self", ".", "last_needed_block", ">=", "1", ":", "\n", "            ", "block1", "=", "[", "\n", "inception", ".", "Conv2d_3b_1x1", ",", "\n", "inception", ".", "Conv2d_4a_3x3", ",", "\n", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "\n", "]", "\n", "self", ".", "blocks", ".", "append", "(", "nn", ".", "Sequential", "(", "*", "block1", ")", ")", "\n", "\n", "# Block 2: maxpool2 to aux classifier", "\n", "", "if", "self", ".", "last_needed_block", ">=", "2", ":", "\n", "            ", "block2", "=", "[", "\n", "inception", ".", "Mixed_5b", ",", "\n", "inception", ".", "Mixed_5c", ",", "\n", "inception", ".", "Mixed_5d", ",", "\n", "inception", ".", "Mixed_6a", ",", "\n", "inception", ".", "Mixed_6b", ",", "\n", "inception", ".", "Mixed_6c", ",", "\n", "inception", ".", "Mixed_6d", ",", "\n", "inception", ".", "Mixed_6e", ",", "\n", "]", "\n", "self", ".", "blocks", ".", "append", "(", "nn", ".", "Sequential", "(", "*", "block2", ")", ")", "\n", "\n", "# Block 3: aux classifier to final avgpool", "\n", "", "if", "self", ".", "last_needed_block", ">=", "3", ":", "\n", "            ", "block3", "=", "[", "\n", "inception", ".", "Mixed_7a", ",", "\n", "inception", ".", "Mixed_7b", ",", "\n", "inception", ".", "Mixed_7c", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "output_size", "=", "(", "1", ",", "1", ")", ")", "\n", "]", "\n", "self", ".", "blocks", ".", "append", "(", "nn", ".", "Sequential", "(", "*", "block3", ")", ")", "\n", "\n", "", "for", "param", "in", "self", ".", "parameters", "(", ")", ":", "\n", "            ", "param", ".", "requires_grad", "=", "requires_grad", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.InceptionV3.forward": [[129, 164], ["enumerate", "torch.interpolate", "torch.interpolate", "torch.interpolate", "block", "outp.append"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "inp", ")", ":", "\n", "        ", "\"\"\"Get Inception feature maps\n\n        Parameters\n        ----------\n        inp : torch.autograd.Variable\n            Input tensor of shape Bx3xHxW. Values are expected to be in\n            range (0, 1)\n\n        Returns\n        -------\n        List of torch.autograd.Variable, corresponding to the selected output\n        block, sorted ascending by index\n        \"\"\"", "\n", "outp", "=", "[", "]", "\n", "x", "=", "inp", "\n", "\n", "if", "self", ".", "resize_input", ":", "\n", "            ", "x", "=", "F", ".", "interpolate", "(", "x", ",", "\n", "size", "=", "(", "299", ",", "299", ")", ",", "\n", "mode", "=", "'bilinear'", ",", "\n", "align_corners", "=", "False", ")", "\n", "\n", "", "if", "self", ".", "normalize_input", ":", "\n", "            ", "x", "=", "2", "*", "x", "-", "1", "# Scale from range (0, 1) to range (-1, 1)", "\n", "\n", "", "for", "idx", ",", "block", "in", "enumerate", "(", "self", ".", "blocks", ")", ":", "\n", "            ", "x", "=", "block", "(", "x", ")", "\n", "if", "idx", "in", "self", ".", "output_blocks", ":", "\n", "                ", "outp", ".", "append", "(", "x", ")", "\n", "\n", "", "if", "idx", "==", "self", ".", "last_needed_block", ":", "\n", "                ", "break", "\n", "\n", "", "", "return", "outp", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionA.__init__": [[195, 197], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ",", "pool_features", ")", ":", "\n", "        ", "super", "(", "FIDInceptionA", ",", "self", ")", ".", "__init__", "(", "in_channels", ",", "pool_features", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionA.forward": [[198, 216], ["inception.FIDInceptionA.branch1x1", "inception.FIDInceptionA.branch5x5_1", "inception.FIDInceptionA.branch5x5_2", "inception.FIDInceptionA.branch3x3dbl_1", "inception.FIDInceptionA.branch3x3dbl_2", "inception.FIDInceptionA.branch3x3dbl_3", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "inception.FIDInceptionA.branch_pool", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "branch1x1", "=", "self", ".", "branch1x1", "(", "x", ")", "\n", "\n", "branch5x5", "=", "self", ".", "branch5x5_1", "(", "x", ")", "\n", "branch5x5", "=", "self", ".", "branch5x5_2", "(", "branch5x5", ")", "\n", "\n", "branch3x3dbl", "=", "self", ".", "branch3x3dbl_1", "(", "x", ")", "\n", "branch3x3dbl", "=", "self", ".", "branch3x3dbl_2", "(", "branch3x3dbl", ")", "\n", "branch3x3dbl", "=", "self", ".", "branch3x3dbl_3", "(", "branch3x3dbl", ")", "\n", "\n", "# Patch: Tensorflow's average pool does not use the padded zero's in", "\n", "# its average calculation", "\n", "branch_pool", "=", "F", ".", "avg_pool2d", "(", "x", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "count_include_pad", "=", "False", ")", "\n", "branch_pool", "=", "self", ".", "branch_pool", "(", "branch_pool", ")", "\n", "\n", "outputs", "=", "[", "branch1x1", ",", "branch5x5", ",", "branch3x3dbl", ",", "branch_pool", "]", "\n", "return", "torch", ".", "cat", "(", "outputs", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionC.__init__": [[220, 222], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ",", "channels_7x7", ")", ":", "\n", "        ", "super", "(", "FIDInceptionC", ",", "self", ")", ".", "__init__", "(", "in_channels", ",", "channels_7x7", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionC.forward": [[223, 244], ["inception.FIDInceptionC.branch1x1", "inception.FIDInceptionC.branch7x7_1", "inception.FIDInceptionC.branch7x7_2", "inception.FIDInceptionC.branch7x7_3", "inception.FIDInceptionC.branch7x7dbl_1", "inception.FIDInceptionC.branch7x7dbl_2", "inception.FIDInceptionC.branch7x7dbl_3", "inception.FIDInceptionC.branch7x7dbl_4", "inception.FIDInceptionC.branch7x7dbl_5", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "inception.FIDInceptionC.branch_pool", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "branch1x1", "=", "self", ".", "branch1x1", "(", "x", ")", "\n", "\n", "branch7x7", "=", "self", ".", "branch7x7_1", "(", "x", ")", "\n", "branch7x7", "=", "self", ".", "branch7x7_2", "(", "branch7x7", ")", "\n", "branch7x7", "=", "self", ".", "branch7x7_3", "(", "branch7x7", ")", "\n", "\n", "branch7x7dbl", "=", "self", ".", "branch7x7dbl_1", "(", "x", ")", "\n", "branch7x7dbl", "=", "self", ".", "branch7x7dbl_2", "(", "branch7x7dbl", ")", "\n", "branch7x7dbl", "=", "self", ".", "branch7x7dbl_3", "(", "branch7x7dbl", ")", "\n", "branch7x7dbl", "=", "self", ".", "branch7x7dbl_4", "(", "branch7x7dbl", ")", "\n", "branch7x7dbl", "=", "self", ".", "branch7x7dbl_5", "(", "branch7x7dbl", ")", "\n", "\n", "# Patch: Tensorflow's average pool does not use the padded zero's in", "\n", "# its average calculation", "\n", "branch_pool", "=", "F", ".", "avg_pool2d", "(", "x", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "count_include_pad", "=", "False", ")", "\n", "branch_pool", "=", "self", ".", "branch_pool", "(", "branch_pool", ")", "\n", "\n", "outputs", "=", "[", "branch1x1", ",", "branch7x7", ",", "branch7x7dbl", ",", "branch_pool", "]", "\n", "return", "torch", ".", "cat", "(", "outputs", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionE_1.__init__": [[248, 250], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ")", ":", "\n", "        ", "super", "(", "FIDInceptionE_1", ",", "self", ")", ".", "__init__", "(", "in_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionE_1.forward": [[251, 277], ["inception.FIDInceptionE_1.branch1x1", "inception.FIDInceptionE_1.branch3x3_1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "inception.FIDInceptionE_1.branch3x3dbl_1", "inception.FIDInceptionE_1.branch3x3dbl_2", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.avg_pool2d", "torch.avg_pool2d", "torch.avg_pool2d", "inception.FIDInceptionE_1.branch_pool", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "inception.FIDInceptionE_1.branch3x3_2a", "inception.FIDInceptionE_1.branch3x3_2b", "inception.FIDInceptionE_1.branch3x3dbl_3a", "inception.FIDInceptionE_1.branch3x3dbl_3b"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "branch1x1", "=", "self", ".", "branch1x1", "(", "x", ")", "\n", "\n", "branch3x3", "=", "self", ".", "branch3x3_1", "(", "x", ")", "\n", "branch3x3", "=", "[", "\n", "self", ".", "branch3x3_2a", "(", "branch3x3", ")", ",", "\n", "self", ".", "branch3x3_2b", "(", "branch3x3", ")", ",", "\n", "]", "\n", "branch3x3", "=", "torch", ".", "cat", "(", "branch3x3", ",", "1", ")", "\n", "\n", "branch3x3dbl", "=", "self", ".", "branch3x3dbl_1", "(", "x", ")", "\n", "branch3x3dbl", "=", "self", ".", "branch3x3dbl_2", "(", "branch3x3dbl", ")", "\n", "branch3x3dbl", "=", "[", "\n", "self", ".", "branch3x3dbl_3a", "(", "branch3x3dbl", ")", ",", "\n", "self", ".", "branch3x3dbl_3b", "(", "branch3x3dbl", ")", ",", "\n", "]", "\n", "branch3x3dbl", "=", "torch", ".", "cat", "(", "branch3x3dbl", ",", "1", ")", "\n", "\n", "# Patch: Tensorflow's average pool does not use the padded zero's in", "\n", "# its average calculation", "\n", "branch_pool", "=", "F", ".", "avg_pool2d", "(", "x", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ",", "\n", "count_include_pad", "=", "False", ")", "\n", "branch_pool", "=", "self", ".", "branch_pool", "(", "branch_pool", ")", "\n", "\n", "outputs", "=", "[", "branch1x1", ",", "branch3x3", ",", "branch3x3dbl", ",", "branch_pool", "]", "\n", "return", "torch", ".", "cat", "(", "outputs", ",", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionE_2.__init__": [[281, 283], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "in_channels", ")", ":", "\n", "        ", "super", "(", "FIDInceptionE_2", ",", "self", ")", ".", "__init__", "(", "in_channels", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.FIDInceptionE_2.forward": [[284, 311], ["inception.FIDInceptionE_2.branch1x1", "inception.FIDInceptionE_2.branch3x3_1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "inception.FIDInceptionE_2.branch3x3dbl_1", "inception.FIDInceptionE_2.branch3x3dbl_2", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.max_pool2d", "torch.max_pool2d", "torch.max_pool2d", "inception.FIDInceptionE_2.branch_pool", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "inception.FIDInceptionE_2.branch3x3_2a", "inception.FIDInceptionE_2.branch3x3_2b", "inception.FIDInceptionE_2.branch3x3dbl_3a", "inception.FIDInceptionE_2.branch3x3dbl_3b"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "branch1x1", "=", "self", ".", "branch1x1", "(", "x", ")", "\n", "\n", "branch3x3", "=", "self", ".", "branch3x3_1", "(", "x", ")", "\n", "branch3x3", "=", "[", "\n", "self", ".", "branch3x3_2a", "(", "branch3x3", ")", ",", "\n", "self", ".", "branch3x3_2b", "(", "branch3x3", ")", ",", "\n", "]", "\n", "branch3x3", "=", "torch", ".", "cat", "(", "branch3x3", ",", "1", ")", "\n", "\n", "branch3x3dbl", "=", "self", ".", "branch3x3dbl_1", "(", "x", ")", "\n", "branch3x3dbl", "=", "self", ".", "branch3x3dbl_2", "(", "branch3x3dbl", ")", "\n", "branch3x3dbl", "=", "[", "\n", "self", ".", "branch3x3dbl_3a", "(", "branch3x3dbl", ")", ",", "\n", "self", ".", "branch3x3dbl_3b", "(", "branch3x3dbl", ")", ",", "\n", "]", "\n", "branch3x3dbl", "=", "torch", ".", "cat", "(", "branch3x3dbl", ",", "1", ")", "\n", "\n", "# Patch: The FID Inception model uses max pooling instead of average", "\n", "# pooling. This is likely an error in this specific Inception", "\n", "# implementation, as other Inception models use average pooling here", "\n", "# (which matches the description in the paper).", "\n", "branch_pool", "=", "F", ".", "max_pool2d", "(", "x", ",", "kernel_size", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", "\n", "branch_pool", "=", "self", ".", "branch_pool", "(", "branch_pool", ")", "\n", "\n", "outputs", "=", "[", "branch1x1", ",", "branch3x3", ",", "branch3x3dbl", ",", "branch_pool", "]", "\n", "return", "torch", ".", "cat", "(", "outputs", ",", "1", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.inception.fid_inception_v3": [[166, 191], ["torchvision.models.inception_v3", "inception.FIDInceptionA", "inception.FIDInceptionA", "inception.FIDInceptionA", "inception.FIDInceptionC", "inception.FIDInceptionC", "inception.FIDInceptionC", "inception.FIDInceptionC", "inception.FIDInceptionE_1", "inception.FIDInceptionE_2", "load_state_dict_from_url", "models.inception_v3.load_state_dict"], "function", ["None"], ["", "", "def", "fid_inception_v3", "(", ")", ":", "\n", "    ", "\"\"\"Build pretrained Inception model for FID computation\n\n    The Inception model for FID computation uses a different set of weights\n    and has a slightly different structure than torchvision's Inception.\n\n    This method first constructs torchvision's Inception and then patches the\n    necessary parts that are different in the FID Inception model.\n    \"\"\"", "\n", "inception", "=", "models", ".", "inception_v3", "(", "num_classes", "=", "1008", ",", "\n", "aux_logits", "=", "False", ",", "\n", "pretrained", "=", "False", ")", "\n", "inception", ".", "Mixed_5b", "=", "FIDInceptionA", "(", "192", ",", "pool_features", "=", "32", ")", "\n", "inception", ".", "Mixed_5c", "=", "FIDInceptionA", "(", "256", ",", "pool_features", "=", "64", ")", "\n", "inception", ".", "Mixed_5d", "=", "FIDInceptionA", "(", "288", ",", "pool_features", "=", "64", ")", "\n", "inception", ".", "Mixed_6b", "=", "FIDInceptionC", "(", "768", ",", "channels_7x7", "=", "128", ")", "\n", "inception", ".", "Mixed_6c", "=", "FIDInceptionC", "(", "768", ",", "channels_7x7", "=", "160", ")", "\n", "inception", ".", "Mixed_6d", "=", "FIDInceptionC", "(", "768", ",", "channels_7x7", "=", "160", ")", "\n", "inception", ".", "Mixed_6e", "=", "FIDInceptionC", "(", "768", ",", "channels_7x7", "=", "192", ")", "\n", "inception", ".", "Mixed_7b", "=", "FIDInceptionE_1", "(", "1280", ")", "\n", "inception", ".", "Mixed_7c", "=", "FIDInceptionE_2", "(", "2048", ")", "\n", "\n", "state_dict", "=", "load_state_dict_from_url", "(", "FID_WEIGHTS_URL", ",", "progress", "=", "True", ")", "\n", "inception", ".", "load_state_dict", "(", "state_dict", ")", "\n", "return", "inception", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.ppl.normalize": [[12, 14], ["torch.sqrt", "x.pow().sum", "x.pow"], "function", ["None"], ["def", "normalize", "(", "x", ")", ":", "\n", "    ", "return", "x", "/", "torch", ".", "sqrt", "(", "x", ".", "pow", "(", "2", ")", ".", "sum", "(", "-", "1", ",", "keepdim", "=", "True", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.ppl.slerp": [[16, 25], ["ppl.normalize", "ppl.normalize", "ppl.normalize", "ppl.normalize", "torch.acos", "torch.cos", "torch.sin"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.ppl.normalize", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.ppl.normalize", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.ppl.normalize", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.ppl.normalize"], ["", "def", "slerp", "(", "a", ",", "b", ",", "t", ")", ":", "\n", "    ", "a", "=", "normalize", "(", "a", ")", "\n", "b", "=", "normalize", "(", "b", ")", "\n", "d", "=", "(", "a", "*", "b", ")", ".", "sum", "(", "-", "1", ",", "keepdim", "=", "True", ")", "\n", "p", "=", "t", "*", "torch", ".", "acos", "(", "d", ")", "\n", "c", "=", "normalize", "(", "b", "-", "d", "*", "a", ")", "\n", "d", "=", "a", "*", "torch", ".", "cos", "(", "p", ")", "+", "c", "*", "torch", ".", "sin", "(", "p", ")", "\n", "\n", "return", "normalize", "(", "d", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.ppl.lerp": [[27, 29], ["None"], "function", ["None"], ["", "def", "lerp", "(", "a", ",", "b", ",", "t", ")", ":", "\n", "    ", "return", "a", "+", "(", "b", "-", "a", ")", "*", "t", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.data_sampler": [[33, 42], ["torch.utils.data.distributed.DistributedSampler", "torch.utils.data.RandomSampler", "torch.utils.data.SequentialSampler"], "function", ["None"], ["def", "data_sampler", "(", "dataset", ",", "shuffle", ",", "distributed", ")", ":", "\n", "    ", "if", "distributed", ":", "\n", "        ", "return", "data", ".", "distributed", ".", "DistributedSampler", "(", "dataset", ",", "shuffle", "=", "shuffle", ")", "\n", "\n", "", "if", "shuffle", ":", "\n", "        ", "return", "data", ".", "RandomSampler", "(", "dataset", ")", "\n", "\n", "", "else", ":", "\n", "        ", "return", "data", ".", "SequentialSampler", "(", "dataset", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad": [[44, 47], ["model.parameters"], "function", ["None"], ["", "", "def", "requires_grad", "(", "model", ",", "flag", "=", "True", ")", ":", "\n", "    ", "for", "p", "in", "model", ".", "parameters", "(", ")", ":", "\n", "        ", "p", ".", "requires_grad", "=", "flag", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.accumulate": [[49, 55], ["dict", "dict", "dict.keys", "model1.named_parameters", "model2.named_parameters", "par1[].data.mul_().add_", "par1[].data.mul_"], "function", ["None"], ["", "", "def", "accumulate", "(", "model1", ",", "model2", ",", "decay", "=", "0.999", ")", ":", "\n", "    ", "par1", "=", "dict", "(", "model1", ".", "named_parameters", "(", ")", ")", "\n", "par2", "=", "dict", "(", "model2", ".", "named_parameters", "(", ")", ")", "\n", "\n", "for", "k", "in", "par1", ".", "keys", "(", ")", ":", "\n", "        ", "par1", "[", "k", "]", ".", "data", ".", "mul_", "(", "decay", ")", ".", "add_", "(", "par2", "[", "k", "]", ".", "data", ",", "alpha", "=", "1", "-", "decay", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.sample_data": [[57, 61], ["None"], "function", ["None"], ["", "", "def", "sample_data", "(", "loader", ")", ":", "\n", "    ", "while", "True", ":", "\n", "        ", "for", "batch", "in", "loader", ":", "\n", "            ", "yield", "batch", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_logistic_loss": [[63, 68], ["torch.nn.functional.softplus", "torch.nn.functional.softplus", "F.softplus.mean", "F.softplus.mean"], "function", ["None"], ["", "", "", "def", "d_logistic_loss", "(", "real_pred", ",", "fake_pred", ")", ":", "\n", "    ", "real_loss", "=", "F", ".", "softplus", "(", "-", "real_pred", ")", "\n", "fake_loss", "=", "F", ".", "softplus", "(", "fake_pred", ")", "\n", "\n", "return", "real_loss", ".", "mean", "(", ")", "+", "fake_loss", ".", "mean", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_r1_loss": [[70, 77], ["torch.autograd.grad", "grad_real.pow().reshape().sum().mean", "real_pred.sum", "grad_real.pow().reshape().sum", "grad_real.pow().reshape", "grad_real.pow"], "function", ["None"], ["", "def", "d_r1_loss", "(", "real_pred", ",", "real_img", ")", ":", "\n", "    ", "grad_real", ",", "=", "autograd", ".", "grad", "(", "\n", "outputs", "=", "real_pred", ".", "sum", "(", ")", ",", "inputs", "=", "real_img", ",", "create_graph", "=", "True", "\n", ")", "\n", "grad_penalty", "=", "grad_real", ".", "pow", "(", "2", ")", ".", "reshape", "(", "grad_real", ".", "shape", "[", "0", "]", ",", "-", "1", ")", ".", "sum", "(", "1", ")", ".", "mean", "(", ")", "\n", "\n", "return", "grad_penalty", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.g_nonsaturating_loss": [[79, 83], ["torch.nn.functional.softplus().mean", "torch.nn.functional.softplus"], "function", ["None"], ["", "def", "g_nonsaturating_loss", "(", "fake_pred", ")", ":", "\n", "    ", "loss", "=", "F", ".", "softplus", "(", "-", "fake_pred", ")", ".", "mean", "(", ")", "\n", "\n", "return", "loss", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.g_path_regularize": [[85, 99], ["torch.autograd.grad", "torch.sqrt", "torch.sqrt", "torch.randn_like", "torch.randn_like", "math.sqrt", "grad.pow().sum().mean", "path_mean.detach", "grad.pow().sum", "torch.sqrt.mean", "grad.pow"], "function", ["None"], ["", "def", "g_path_regularize", "(", "fake_img", ",", "latents", ",", "mean_path_length", ",", "decay", "=", "0.01", ")", ":", "\n", "    ", "noise", "=", "torch", ".", "randn_like", "(", "fake_img", ")", "/", "math", ".", "sqrt", "(", "\n", "fake_img", ".", "shape", "[", "2", "]", "*", "fake_img", ".", "shape", "[", "3", "]", "\n", ")", "\n", "grad", ",", "=", "autograd", ".", "grad", "(", "\n", "outputs", "=", "(", "fake_img", "*", "noise", ")", ".", "sum", "(", ")", ",", "inputs", "=", "latents", ",", "create_graph", "=", "True", "\n", ")", "\n", "path_lengths", "=", "torch", ".", "sqrt", "(", "grad", ".", "pow", "(", "2", ")", ".", "sum", "(", "2", ")", ".", "mean", "(", "1", ")", ")", "\n", "\n", "path_mean", "=", "mean_path_length", "+", "decay", "*", "(", "path_lengths", ".", "mean", "(", ")", "-", "mean_path_length", ")", "\n", "\n", "path_penalty", "=", "(", "path_lengths", "-", "path_mean", ")", ".", "pow", "(", "2", ")", ".", "mean", "(", ")", "\n", "\n", "return", "path_penalty", ",", "path_mean", ".", "detach", "(", ")", ",", "path_lengths", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.make_noise": [[101, 108], ["torch.randn().unbind", "torch.randn().unbind", "torch.randn", "torch.randn", "torch.randn", "torch.randn"], "function", ["None"], ["", "def", "make_noise", "(", "batch", ",", "latent_dim", ",", "n_noise", ",", "device", ")", ":", "\n", "    ", "if", "n_noise", "==", "1", ":", "\n", "        ", "return", "torch", ".", "randn", "(", "batch", ",", "latent_dim", ",", "device", "=", "device", ")", "\n", "\n", "", "noises", "=", "torch", ".", "randn", "(", "n_noise", ",", "batch", ",", "latent_dim", ",", "device", "=", "device", ")", ".", "unbind", "(", "0", ")", "\n", "\n", "return", "noises", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.mixing_noise": [[110, 116], ["train.make_noise", "random.random", "train.make_noise"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Generator.make_noise", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Generator.make_noise"], ["", "def", "mixing_noise", "(", "batch", ",", "latent_dim", ",", "prob", ",", "device", ")", ":", "\n", "    ", "if", "prob", ">", "0", "and", "random", ".", "random", "(", ")", "<", "prob", ":", "\n", "        ", "return", "make_noise", "(", "batch", ",", "latent_dim", ",", "2", ",", "device", ")", "\n", "\n", "", "else", ":", "\n", "        ", "return", "[", "make_noise", "(", "batch", ",", "latent_dim", ",", "1", ",", "device", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.set_grad_none": [[118, 122], ["model.named_parameters"], "function", ["None"], ["", "", "def", "set_grad_none", "(", "model", ",", "targets", ")", ":", "\n", "    ", "for", "n", ",", "p", "in", "model", ".", "named_parameters", "(", ")", ":", "\n", "        ", "if", "n", "in", "targets", ":", "\n", "            ", "p", ".", "grad", "=", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.train": [[124, 336], ["train.sample_data", "range", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.tensor", "torch.randn", "torch.randn", "distributed.get_rank", "tqdm.tqdm", "next", "real_img.to.to", "train.requires_grad", "train.requires_grad", "train.mixing_noise", "generator", "discriminator", "discriminator", "train.d_logistic_loss", "discriminator.mean", "discriminator.mean", "discriminator.zero_grad", "d_logistic_loss.backward", "d_optim.step", "train.requires_grad", "train.requires_grad", "train.mixing_noise", "generator", "discriminator", "train.g_nonsaturating_loss", "generator.zero_grad", "g_nonsaturating_loss.backward", "g_optim.step", "torch.tensor.mean", "train.accumulate", "distributed.reduce_loss_dict", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "loss_reduced[].mean().item", "print", "non_leaking.augment", "non_leaking.augment", "torch.tensor", "torch.tensor", "distributed.reduce_sum", "discriminator", "train.d_r1_loss", "discriminator.zero_grad", "d_optim.step", "non_leaking.augment", "max", "train.mixing_noise", "generator", "train.g_path_regularize", "generator.zero_grad", "weighted_path_loss.backward", "g_optim.step", "distributed.get_rank", "tqdm.tqdm.set_description", "distributed.reduce_sum.tolist", "min", "distributed.reduce_sum.mul_", "distributed.reduce_sum().item", "distributed.get_world_size", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "loss_reduced[].mean", "wandb.log", "torch.save", "torch.save", "torch.sign().sum().item", "torch.sign().sum().item", "max", "torch.no_grad", "torch.no_grad", "g_ema.eval", "g_ema", "torchvision.utils.save_image", "distributed.reduce_sum", "g_module.state_dict", "d_module.state_dict", "g_ema.state_dict", "g_optim.state_dict", "d_optim.state_dict", "torch.sign().sum", "torch.sign().sum", "int", "str().zfill", "str().zfill", "torch.sign", "torch.sign", "str", "str"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.sample_data", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_rank", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.mixing_noise", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_logistic_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.backward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.requires_grad", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.mixing_noise", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.g_nonsaturating_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.backward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.accumulate", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.reduce_loss_dict", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.augment", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.augment", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.reduce_sum", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.d_r1_loss", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.non_leaking.augment", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.mixing_noise", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.train.g_path_regularize", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.backward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_rank", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.get_world_size", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.distributed.reduce_sum"], ["", "", "", "def", "train", "(", "args", ",", "loader", ",", "generator", ",", "discriminator", ",", "g_optim", ",", "d_optim", ",", "g_ema", ",", "device", ")", ":", "\n", "    ", "loader", "=", "sample_data", "(", "loader", ")", "\n", "\n", "pbar", "=", "range", "(", "args", ".", "iter", ")", "\n", "\n", "if", "get_rank", "(", ")", "==", "0", ":", "\n", "        ", "pbar", "=", "tqdm", "(", "pbar", ",", "initial", "=", "args", ".", "start_iter", ",", "dynamic_ncols", "=", "True", ",", "smoothing", "=", "0.01", ")", "\n", "\n", "", "mean_path_length", "=", "0", "\n", "\n", "d_loss_val", "=", "0", "\n", "r1_loss", "=", "torch", ".", "tensor", "(", "0.0", ",", "device", "=", "device", ")", "\n", "g_loss_val", "=", "0", "\n", "path_loss", "=", "torch", ".", "tensor", "(", "0.0", ",", "device", "=", "device", ")", "\n", "path_lengths", "=", "torch", ".", "tensor", "(", "0.0", ",", "device", "=", "device", ")", "\n", "mean_path_length_avg", "=", "0", "\n", "loss_dict", "=", "{", "}", "\n", "\n", "if", "args", ".", "distributed", ":", "\n", "        ", "g_module", "=", "generator", ".", "module", "\n", "d_module", "=", "discriminator", ".", "module", "\n", "\n", "", "else", ":", "\n", "        ", "g_module", "=", "generator", "\n", "d_module", "=", "discriminator", "\n", "\n", "", "accum", "=", "0.5", "**", "(", "32", "/", "(", "10", "*", "1000", ")", ")", "\n", "ada_augment", "=", "torch", ".", "tensor", "(", "[", "0.0", ",", "0.0", "]", ",", "device", "=", "device", ")", "\n", "ada_aug_p", "=", "args", ".", "augment_p", "if", "args", ".", "augment_p", ">", "0", "else", "0.0", "\n", "ada_aug_step", "=", "args", ".", "ada_target", "/", "args", ".", "ada_length", "\n", "r_t_stat", "=", "0", "\n", "\n", "sample_z", "=", "torch", ".", "randn", "(", "args", ".", "n_sample", ",", "args", ".", "latent", ",", "device", "=", "device", ")", "\n", "\n", "for", "idx", "in", "pbar", ":", "\n", "        ", "i", "=", "idx", "+", "args", ".", "start_iter", "\n", "\n", "if", "i", ">", "args", ".", "iter", ":", "\n", "            ", "print", "(", "\"Done!\"", ")", "\n", "\n", "break", "\n", "\n", "", "real_img", "=", "next", "(", "loader", ")", "\n", "real_img", "=", "real_img", ".", "to", "(", "device", ")", "\n", "\n", "requires_grad", "(", "generator", ",", "False", ")", "\n", "requires_grad", "(", "discriminator", ",", "True", ")", "\n", "\n", "noise", "=", "mixing_noise", "(", "args", ".", "batch", ",", "args", ".", "latent", ",", "args", ".", "mixing", ",", "device", ")", "\n", "fake_img", ",", "_", "=", "generator", "(", "noise", ")", "\n", "\n", "if", "args", ".", "augment", ":", "\n", "            ", "real_img_aug", ",", "_", "=", "augment", "(", "real_img", ",", "ada_aug_p", ")", "\n", "fake_img", ",", "_", "=", "augment", "(", "fake_img", ",", "ada_aug_p", ")", "\n", "\n", "", "else", ":", "\n", "            ", "real_img_aug", "=", "real_img", "\n", "\n", "", "fake_pred", "=", "discriminator", "(", "fake_img", ")", "\n", "real_pred", "=", "discriminator", "(", "real_img_aug", ")", "\n", "d_loss", "=", "d_logistic_loss", "(", "real_pred", ",", "fake_pred", ")", "\n", "\n", "loss_dict", "[", "\"d\"", "]", "=", "d_loss", "\n", "loss_dict", "[", "\"real_score\"", "]", "=", "real_pred", ".", "mean", "(", ")", "\n", "loss_dict", "[", "\"fake_score\"", "]", "=", "fake_pred", ".", "mean", "(", ")", "\n", "\n", "discriminator", ".", "zero_grad", "(", ")", "\n", "d_loss", ".", "backward", "(", ")", "\n", "d_optim", ".", "step", "(", ")", "\n", "\n", "if", "args", ".", "augment", "and", "args", ".", "augment_p", "==", "0", ":", "\n", "            ", "ada_augment", "+=", "torch", ".", "tensor", "(", "\n", "(", "torch", ".", "sign", "(", "real_pred", ")", ".", "sum", "(", ")", ".", "item", "(", ")", ",", "real_pred", ".", "shape", "[", "0", "]", ")", ",", "device", "=", "device", "\n", ")", "\n", "ada_augment", "=", "reduce_sum", "(", "ada_augment", ")", "\n", "\n", "if", "ada_augment", "[", "1", "]", ">", "255", ":", "\n", "                ", "pred_signs", ",", "n_pred", "=", "ada_augment", ".", "tolist", "(", ")", "\n", "\n", "r_t_stat", "=", "pred_signs", "/", "n_pred", "\n", "\n", "if", "r_t_stat", ">", "args", ".", "ada_target", ":", "\n", "                    ", "sign", "=", "1", "\n", "\n", "", "else", ":", "\n", "                    ", "sign", "=", "-", "1", "\n", "\n", "", "ada_aug_p", "+=", "sign", "*", "ada_aug_step", "*", "n_pred", "\n", "ada_aug_p", "=", "min", "(", "1", ",", "max", "(", "0", ",", "ada_aug_p", ")", ")", "\n", "ada_augment", ".", "mul_", "(", "0", ")", "\n", "\n", "", "", "d_regularize", "=", "i", "%", "args", ".", "d_reg_every", "==", "0", "\n", "\n", "if", "d_regularize", ":", "\n", "            ", "real_img", ".", "requires_grad", "=", "True", "\n", "real_pred", "=", "discriminator", "(", "real_img", ")", "\n", "r1_loss", "=", "d_r1_loss", "(", "real_pred", ",", "real_img", ")", "\n", "\n", "discriminator", ".", "zero_grad", "(", ")", "\n", "(", "args", ".", "r1", "/", "2", "*", "r1_loss", "*", "args", ".", "d_reg_every", "+", "0", "*", "real_pred", "[", "0", "]", ")", ".", "backward", "(", ")", "\n", "\n", "d_optim", ".", "step", "(", ")", "\n", "\n", "", "loss_dict", "[", "\"r1\"", "]", "=", "r1_loss", "\n", "\n", "requires_grad", "(", "generator", ",", "True", ")", "\n", "requires_grad", "(", "discriminator", ",", "False", ")", "\n", "\n", "noise", "=", "mixing_noise", "(", "args", ".", "batch", ",", "args", ".", "latent", ",", "args", ".", "mixing", ",", "device", ")", "\n", "fake_img", ",", "_", "=", "generator", "(", "noise", ")", "\n", "\n", "if", "args", ".", "augment", ":", "\n", "            ", "fake_img", ",", "_", "=", "augment", "(", "fake_img", ",", "ada_aug_p", ")", "\n", "\n", "", "fake_pred", "=", "discriminator", "(", "fake_img", ")", "\n", "g_loss", "=", "g_nonsaturating_loss", "(", "fake_pred", ")", "\n", "\n", "loss_dict", "[", "\"g\"", "]", "=", "g_loss", "\n", "\n", "generator", ".", "zero_grad", "(", ")", "\n", "g_loss", ".", "backward", "(", ")", "\n", "g_optim", ".", "step", "(", ")", "\n", "\n", "g_regularize", "=", "i", "%", "args", ".", "g_reg_every", "==", "0", "\n", "\n", "if", "g_regularize", ":", "\n", "            ", "path_batch_size", "=", "max", "(", "1", ",", "args", ".", "batch", "//", "args", ".", "path_batch_shrink", ")", "\n", "noise", "=", "mixing_noise", "(", "path_batch_size", ",", "args", ".", "latent", ",", "args", ".", "mixing", ",", "device", ")", "\n", "fake_img", ",", "latents", "=", "generator", "(", "noise", ",", "return_latents", "=", "True", ")", "\n", "\n", "path_loss", ",", "mean_path_length", ",", "path_lengths", "=", "g_path_regularize", "(", "\n", "fake_img", ",", "latents", ",", "mean_path_length", "\n", ")", "\n", "\n", "generator", ".", "zero_grad", "(", ")", "\n", "weighted_path_loss", "=", "args", ".", "path_regularize", "*", "args", ".", "g_reg_every", "*", "path_loss", "\n", "\n", "if", "args", ".", "path_batch_shrink", ":", "\n", "                ", "weighted_path_loss", "+=", "0", "*", "fake_img", "[", "0", ",", "0", ",", "0", ",", "0", "]", "\n", "\n", "", "weighted_path_loss", ".", "backward", "(", ")", "\n", "\n", "g_optim", ".", "step", "(", ")", "\n", "\n", "mean_path_length_avg", "=", "(", "\n", "reduce_sum", "(", "mean_path_length", ")", ".", "item", "(", ")", "/", "get_world_size", "(", ")", "\n", ")", "\n", "\n", "", "loss_dict", "[", "\"path\"", "]", "=", "path_loss", "\n", "loss_dict", "[", "\"path_length\"", "]", "=", "path_lengths", ".", "mean", "(", ")", "\n", "\n", "accumulate", "(", "g_ema", ",", "g_module", ",", "accum", ")", "\n", "\n", "loss_reduced", "=", "reduce_loss_dict", "(", "loss_dict", ")", "\n", "\n", "d_loss_val", "=", "loss_reduced", "[", "\"d\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "g_loss_val", "=", "loss_reduced", "[", "\"g\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "r1_val", "=", "loss_reduced", "[", "\"r1\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "path_loss_val", "=", "loss_reduced", "[", "\"path\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "real_score_val", "=", "loss_reduced", "[", "\"real_score\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "fake_score_val", "=", "loss_reduced", "[", "\"fake_score\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "path_length_val", "=", "loss_reduced", "[", "\"path_length\"", "]", ".", "mean", "(", ")", ".", "item", "(", ")", "\n", "\n", "if", "get_rank", "(", ")", "==", "0", ":", "\n", "            ", "pbar", ".", "set_description", "(", "\n", "(", "\n", "f\"d: {d_loss_val:.4f}; g: {g_loss_val:.4f}; r1: {r1_val:.4f}; \"", "\n", "f\"path: {path_loss_val:.4f}; mean path: {mean_path_length_avg:.4f}; \"", "\n", "f\"augment: {ada_aug_p:.4f}\"", "\n", ")", "\n", ")", "\n", "\n", "if", "wandb", "and", "args", ".", "wandb", ":", "\n", "                ", "wandb", ".", "log", "(", "\n", "{", "\n", "\"Generator\"", ":", "g_loss_val", ",", "\n", "\"Discriminator\"", ":", "d_loss_val", ",", "\n", "\"Augment\"", ":", "ada_aug_p", ",", "\n", "\"Rt\"", ":", "r_t_stat", ",", "\n", "\"R1\"", ":", "r1_val", ",", "\n", "\"Path Length Regularization\"", ":", "path_loss_val", ",", "\n", "\"Mean Path Length\"", ":", "mean_path_length", ",", "\n", "\"Real Score\"", ":", "real_score_val", ",", "\n", "\"Fake Score\"", ":", "fake_score_val", ",", "\n", "\"Path Length\"", ":", "path_length_val", ",", "\n", "}", "\n", ")", "\n", "\n", "", "if", "i", "%", "100", "==", "0", ":", "\n", "                ", "with", "torch", ".", "no_grad", "(", ")", ":", "\n", "                    ", "g_ema", ".", "eval", "(", ")", "\n", "sample", ",", "_", "=", "g_ema", "(", "[", "sample_z", "]", ")", "\n", "utils", ".", "save_image", "(", "\n", "sample", ",", "\n", "f\"sample/{str(i).zfill(6)}.png\"", ",", "\n", "nrow", "=", "int", "(", "args", ".", "n_sample", "**", "0.5", ")", ",", "\n", "normalize", "=", "True", ",", "\n", "range", "=", "(", "-", "1", ",", "1", ")", ",", "\n", ")", "\n", "\n", "", "", "if", "i", "%", "10000", "==", "0", ":", "\n", "                ", "torch", ".", "save", "(", "\n", "{", "\n", "\"g\"", ":", "g_module", ".", "state_dict", "(", ")", ",", "\n", "\"d\"", ":", "d_module", ".", "state_dict", "(", ")", ",", "\n", "\"g_ema\"", ":", "g_ema", ".", "state_dict", "(", ")", ",", "\n", "\"g_optim\"", ":", "g_optim", ".", "state_dict", "(", ")", ",", "\n", "\"d_optim\"", ":", "d_optim", ".", "state_dict", "(", ")", ",", "\n", "\"args\"", ":", "args", ",", "\n", "\"ada_aug_p\"", ":", "ada_aug_p", ",", "\n", "}", ",", "\n", "f\"checkpoint/{str(i).zfill(6)}.pt\"", ",", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.dataset.MultiResolutionDataset.__init__": [[9, 27], ["lmdb.open", "IOError", "dataset.MultiResolutionDataset.env.begin", "int", "txn.get().decode", "txn.get"], "methods", ["None"], ["from", "torch", ".", "utils", "import", "data", "\n", "from", "torch", ".", "utils", ".", "data", "import", "Dataset", "\n", "\n", "import", "cv2", "\n", "from", "tqdm", "import", "tqdm", "\n", "\n", "import", "pdb", "\n", "\n", "class", "CXR14Dataset", "(", "Dataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "data_root", ",", "listfile", ",", "transform", ",", "gray", "=", "False", ")", ":", "\n", "        ", "self", ".", "image_list", "=", "[", "]", "\n", "self", ".", "label_list", "=", "[", "]", "\n", "with", "open", "(", "listfile", ")", "as", "f", ":", "\n", "            ", "lines", "=", "f", ".", "readlines", "(", ")", "\n", "for", "line", "in", "lines", ":", "\n", "                ", "items", "=", "line", ".", "strip", "(", ")", ".", "split", "(", ")", "\n", "# pdb.set_trace()", "\n", "image_path", "=", "os", ".", "path", ".", "join", "(", "data_root", ",", "items", "[", "0", "]", ")", "\n", "label", "=", "torch", ".", "tensor", "(", "list", "(", "map", "(", "int", ",", "items", "[", "1", ":", "]", ")", ")", ",", "dtype", "=", "torch", ".", "float32", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.dataset.MultiResolutionDataset.__len__": [[28, 30], ["None"], "methods", ["None"], ["self", ".", "image_list", ".", "append", "(", "image_path", ")", "\n", "self", ".", "label_list", ".", "append", "(", "label", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.dataset.MultiResolutionDataset.__getitem__": [[31, 41], ["io.BytesIO", "PIL.Image.open", "dataset.MultiResolutionDataset.transform", "dataset.MultiResolutionDataset.env.begin", "txn.get", "str().zfill", "str"], "methods", ["None"], ["", "", "self", ".", "transform", "=", "transform", "\n", "self", ".", "gray", "=", "gray", "\n", "\n", "", "def", "__len__", "(", "self", ")", ":", "\n", "        ", "return", "len", "(", "self", ".", "image_list", ")", "\n", "\n", "", "def", "__getitem__", "(", "self", ",", "index", ")", ":", "\n", "        ", "image", "=", "Image", ".", "open", "(", "self", ".", "image_list", "[", "index", "]", ")", "\n", "if", "self", ".", "gray", ":", "\n", "            ", "image", "=", "image", ".", "convert", "(", "'L'", ")", "\n", "", "else", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.dataset.MultiResolutionFolderDataset.__init__": [[43, 49], ["os.listdir", "len"], "methods", ["None"], ["", "label", "=", "self", ".", "label_list", "[", "index", "]", "\n", "image", "=", "self", ".", "transform", "(", "image", ")", "\n", "\n", "return", "image", ",", "label", "\n", "\n", "", "", "class", "IM100Dataset", "(", "Dataset", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "data_root", ",", "listfile", ",", "transform", ",", "gray", "=", "False", ")", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.dataset.MultiResolutionFolderDataset.__len__": [[50, 52], ["None"], "methods", ["None"], ["        ", "self", ".", "image_list", "=", "[", "]", "\n", "self", ".", "label_list", "=", "[", "]", "\n", "with", "open", "(", "listfile", ")", "as", "f", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.dataset.MultiResolutionFolderDataset.__getitem__": [[53, 59], ["os.path.join", "PIL.Image.open", "dataset.MultiResolutionFolderDataset.transform"], "methods", ["None"], ["            ", "lines", "=", "f", ".", "readlines", "(", ")", "\n", "for", "line", "in", "lines", ":", "\n", "                ", "items", "=", "line", ".", "strip", "(", ")", ".", "split", "(", ")", "\n", "image_path", "=", "os", ".", "path", ".", "join", "(", "data_root", ",", "items", "[", "0", "]", ")", "\n", "label", "=", "int", "(", "items", "[", "1", "]", ")", "\n", "self", ".", "image_list", ".", "append", "(", "image_path", ")", "\n", "self", ".", "label_list", ".", "append", "(", "label", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.calc_inception.Inception3Feature.forward": [[19, 49], ["calc_inception.Inception3Feature.Conv2d_1a_3x3", "calc_inception.Inception3Feature.Conv2d_2a_3x3", "calc_inception.Inception3Feature.Conv2d_2b_3x3", "torch.nn.functional.max_pool2d", "calc_inception.Inception3Feature.Conv2d_3b_1x1", "calc_inception.Inception3Feature.Conv2d_4a_3x3", "torch.nn.functional.max_pool2d", "calc_inception.Inception3Feature.Mixed_5b", "calc_inception.Inception3Feature.Mixed_5c", "calc_inception.Inception3Feature.Mixed_5d", "calc_inception.Inception3Feature.Mixed_6a", "calc_inception.Inception3Feature.Mixed_6b", "calc_inception.Inception3Feature.Mixed_6c", "calc_inception.Inception3Feature.Mixed_6d", "calc_inception.Inception3Feature.Mixed_6e", "calc_inception.Inception3Feature.Mixed_7a", "calc_inception.Inception3Feature.Mixed_7b", "calc_inception.Inception3Feature.Mixed_7c", "torch.nn.functional.avg_pool2d", "torch.nn.functional.interpolate.view", "torch.nn.functional.interpolate"], "methods", ["None"], ["    ", "def", "forward", "(", "self", ",", "x", ")", ":", "\n", "        ", "if", "x", ".", "shape", "[", "2", "]", "!=", "299", "or", "x", ".", "shape", "[", "3", "]", "!=", "299", ":", "\n", "            ", "x", "=", "F", ".", "interpolate", "(", "x", ",", "size", "=", "(", "299", ",", "299", ")", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "True", ")", "\n", "\n", "", "x", "=", "self", ".", "Conv2d_1a_3x3", "(", "x", ")", "# 299 x 299 x 3", "\n", "x", "=", "self", ".", "Conv2d_2a_3x3", "(", "x", ")", "# 149 x 149 x 32", "\n", "x", "=", "self", ".", "Conv2d_2b_3x3", "(", "x", ")", "# 147 x 147 x 32", "\n", "x", "=", "F", ".", "max_pool2d", "(", "x", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "# 147 x 147 x 64", "\n", "\n", "x", "=", "self", ".", "Conv2d_3b_1x1", "(", "x", ")", "# 73 x 73 x 64", "\n", "x", "=", "self", ".", "Conv2d_4a_3x3", "(", "x", ")", "# 73 x 73 x 80", "\n", "x", "=", "F", ".", "max_pool2d", "(", "x", ",", "kernel_size", "=", "3", ",", "stride", "=", "2", ")", "# 71 x 71 x 192", "\n", "\n", "x", "=", "self", ".", "Mixed_5b", "(", "x", ")", "# 35 x 35 x 192", "\n", "x", "=", "self", ".", "Mixed_5c", "(", "x", ")", "# 35 x 35 x 256", "\n", "x", "=", "self", ".", "Mixed_5d", "(", "x", ")", "# 35 x 35 x 288", "\n", "\n", "x", "=", "self", ".", "Mixed_6a", "(", "x", ")", "# 35 x 35 x 288", "\n", "x", "=", "self", ".", "Mixed_6b", "(", "x", ")", "# 17 x 17 x 768", "\n", "x", "=", "self", ".", "Mixed_6c", "(", "x", ")", "# 17 x 17 x 768", "\n", "x", "=", "self", ".", "Mixed_6d", "(", "x", ")", "# 17 x 17 x 768", "\n", "x", "=", "self", ".", "Mixed_6e", "(", "x", ")", "# 17 x 17 x 768", "\n", "\n", "x", "=", "self", ".", "Mixed_7a", "(", "x", ")", "# 17 x 17 x 768", "\n", "x", "=", "self", ".", "Mixed_7b", "(", "x", ")", "# 8 x 8 x 1280", "\n", "x", "=", "self", ".", "Mixed_7c", "(", "x", ")", "# 8 x 8 x 2048", "\n", "\n", "x", "=", "F", ".", "avg_pool2d", "(", "x", ",", "kernel_size", "=", "8", ")", "# 8 x 8 x 2048", "\n", "\n", "return", "x", ".", "view", "(", "x", ".", "shape", "[", "0", "]", ",", "x", ".", "shape", "[", "1", "]", ")", "# 1 x 1 x 2048", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.calc_inception.load_patched_inception_v3": [[51, 58], ["inception.InceptionV3"], "function", ["None"], ["", "", "def", "load_patched_inception_v3", "(", ")", ":", "\n", "# inception = inception_v3(pretrained=True)", "\n", "# inception_feat = Inception3Feature()", "\n", "# inception_feat.load_state_dict(inception.state_dict())", "\n", "    ", "inception_feat", "=", "InceptionV3", "(", "[", "3", "]", ",", "normalize_input", "=", "False", ")", "\n", "\n", "return", "inception_feat", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.calc_inception.extract_features": [[60, 74], ["torch.no_grad", "tqdm.tqdm", "torch.cat", "img.to.to", "[].view", "feature_list.append", "[].view.to", "inception"], "function", ["None"], ["", "@", "torch", ".", "no_grad", "(", ")", "\n", "def", "extract_features", "(", "loader", ",", "inception", ",", "device", ")", ":", "\n", "    ", "pbar", "=", "tqdm", "(", "loader", ")", "\n", "\n", "feature_list", "=", "[", "]", "\n", "\n", "for", "img", "in", "pbar", ":", "\n", "        ", "img", "=", "img", ".", "to", "(", "device", ")", "\n", "feature", "=", "inception", "(", "img", ")", "[", "0", "]", ".", "view", "(", "img", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "feature_list", ".", "append", "(", "feature", ".", "to", "(", "'cpu'", ")", ")", "\n", "\n", "", "features", "=", "torch", ".", "cat", "(", "feature_list", ",", "0", ")", "\n", "\n", "return", "features", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.PixelNorm.__init__": [[15, 17], ["torch.nn.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["self", ",", "in_channel", ",", "out_channel", ",", "kernel_size", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.PixelNorm.forward": [[18, 20], ["torch.rsqrt", "torch.mean"], "methods", ["None"], ["\n", "self", ".", "weight", "=", "nn", ".", "Parameter", "(", "\n", "torch", ".", "randn", "(", "in_channel", ",", "out_channel", ",", "kernel_size", ",", "kernel_size", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Upsample.__init__": [[34, 47], ["torch.nn.Module.__init__", "model.Upsample.register_buffer", "model.make_kernel"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.make_kernel"], ["        ", "out", "=", "F", ".", "conv_transpose2d", "(", "\n", "input", ",", "\n", "self", ".", "weight", "*", "self", ".", "scale", ",", "\n", "bias", "=", "self", ".", "bias", ",", "\n", "stride", "=", "self", ".", "stride", ",", "\n", "padding", "=", "self", ".", "padding", ",", "\n", ")", "\n", "\n", "return", "out", "\n", "\n", "", "def", "__repr__", "(", "self", ")", ":", "\n", "        ", "return", "(", "\n", "f\"{self.__class__.__name__}({self.weight.shape[0]}, {self.weight.shape[1]},\"", "\n", "f\" {self.weight.shape[2]}, stride={self.stride}, padding={self.padding})\"", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Upsample.forward": [[48, 52], ["op.upfirdn2d"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d"], [")", "\n", "\n", "\n", "", "", "class", "ConvLayer", "(", "nn", ".", "Sequential", ")", ":", "\n", "    ", "def", "__init__", "(", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Downsample.__init__": [[55, 68], ["torch.nn.Module.__init__", "model.make_kernel", "model.Downsample.register_buffer"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.make_kernel"], ["out_channel", ",", "\n", "kernel_size", ",", "\n", "upsample", "=", "False", ",", "\n", "downsample", "=", "False", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "bias", "=", "True", ",", "\n", "activate", "=", "True", ",", "\n", "padding", "=", "\"zero\"", ",", "\n", ")", ":", "\n", "        ", "layers", "=", "[", "]", "\n", "\n", "self", ".", "padding", "=", "0", "\n", "stride", "=", "1", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Downsample.forward": [[69, 73], ["op.upfirdn2d"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d"], ["if", "downsample", ":", "\n", "            ", "factor", "=", "2", "\n", "p", "=", "(", "len", "(", "blur_kernel", ")", "-", "factor", ")", "+", "(", "kernel_size", "-", "1", ")", "\n", "pad0", "=", "(", "p", "+", "1", ")", "//", "2", "\n", "pad1", "=", "p", "//", "2", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Blur.__init__": [[76, 87], ["torch.nn.Module.__init__", "model.make_kernel", "model.Blur.register_buffer"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.make_kernel"], ["\n", "stride", "=", "2", "\n", "\n", "", "if", "upsample", ":", "\n", "            ", "layers", ".", "append", "(", "\n", "EqualConvTranspose2d", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "kernel_size", ",", "\n", "padding", "=", "0", ",", "\n", "stride", "=", "2", ",", "\n", "bias", "=", "bias", "and", "not", "activate", ",", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Blur.forward": [[88, 92], ["op.upfirdn2d"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d"], [")", "\n", ")", "\n", "\n", "factor", "=", "2", "\n", "p", "=", "(", "len", "(", "blur_kernel", ")", "-", "factor", ")", "-", "(", "kernel_size", "-", "1", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.EqualConv2d.__init__": [[95, 113], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.randn", "math.sqrt", "torch.nn.Parameter", "torch.zeros"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["\n", "layers", ".", "append", "(", "Blur", "(", "blur_kernel", ",", "pad", "=", "(", "pad0", ",", "pad1", ")", ")", ")", "\n", "\n", "", "else", ":", "\n", "            ", "if", "not", "downsample", ":", "\n", "                ", "if", "padding", "==", "\"zero\"", ":", "\n", "                    ", "self", ".", "padding", "=", "(", "kernel_size", "-", "1", ")", "//", "2", "\n", "\n", "", "elif", "padding", "==", "\"reflect\"", ":", "\n", "                    ", "padding", "=", "(", "kernel_size", "-", "1", ")", "//", "2", "\n", "\n", "if", "padding", ">", "0", ":", "\n", "                        ", "layers", ".", "append", "(", "nn", ".", "ReflectionPad2d", "(", "padding", ")", ")", "\n", "\n", "", "self", ".", "padding", "=", "0", "\n", "\n", "", "elif", "padding", "!=", "\"valid\"", ":", "\n", "                    ", "raise", "ValueError", "(", "'Padding should be \"zero\", \"reflect\", or \"valid\"'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.EqualConv2d.forward": [[114, 124], ["torch.nn.functional.conv2d"], "methods", ["None"], ["", "", "layers", ".", "append", "(", "\n", "EqualConv2d", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "kernel_size", ",", "\n", "padding", "=", "self", ".", "padding", ",", "\n", "stride", "=", "stride", ",", "\n", "bias", "=", "bias", "and", "not", "activate", ",", "\n", ")", "\n", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.EqualConv2d.__repr__": [[125, 128], ["None"], "methods", ["None"], ["", "if", "activate", ":", "\n", "            ", "if", "bias", ":", "\n", "                ", "layers", ".", "append", "(", "FusedLeakyReLU", "(", "out_channel", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.EqualLinear.__init__": [[133, 150], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.randn().div_", "torch.nn.Parameter", "torch.zeros().fill_", "math.sqrt", "torch.randn", "torch.zeros"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["\n", "\n", "", "", "class", "StyledResBlock", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "in_channel", ",", "out_channel", ",", "style_dim", ",", "upsample", ",", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "StyledConv", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "3", ",", "\n", "style_dim", ",", "\n", "upsample", "=", "upsample", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", ")", "\n", "\n", "self", ".", "conv2", "=", "StyledConv", "(", "out_channel", ",", "out_channel", ",", "3", ",", "style_dim", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.EqualLinear.forward": [[151, 162], ["torch.nn.functional.linear", "op.fused_leaky_relu", "torch.nn.functional.linear"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.fused_leaky_relu"], ["\n", "if", "upsample", "or", "in_channel", "!=", "out_channel", ":", "\n", "            ", "self", ".", "skip", "=", "ConvLayer", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "1", ",", "\n", "upsample", "=", "upsample", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", "bias", "=", "False", ",", "\n", "activate", "=", "False", ",", "\n", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.EqualLinear.__repr__": [[163, 166], ["None"], "methods", ["None"], ["", "else", ":", "\n", "            ", "self", ".", "skip", "=", "None", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "input", ",", "style", ",", "noise", "=", "None", ")", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ScaledLeakyReLU.__init__": [[170, 174], ["torch.nn.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["if", "self", ".", "skip", "is", "not", "None", ":", "\n", "            ", "skip", "=", "self", ".", "skip", "(", "input", ")", "\n", "\n", "", "else", ":", "\n", "            ", "skip", "=", "input", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ScaledLeakyReLU.forward": [[175, 179], ["torch.nn.functional.leaky_relu", "math.sqrt"], "methods", ["None"], ["\n", "", "return", "(", "out", "+", "skip", ")", "/", "math", ".", "sqrt", "(", "2", ")", "\n", "\n", "\n", "", "", "class", "ResBlock", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ModulatedConv2d.__init__": [[182, 229], ["torch.nn.Module.__init__", "torch.nn.Parameter", "model.EqualLinear", "model.Blur", "model.Blur", "math.sqrt", "torch.randn", "len", "len"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["in_channel", ",", "\n", "out_channel", ",", "\n", "downsample", ",", "\n", "padding", "=", "\"zero\"", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "conv1", "=", "ConvLayer", "(", "in_channel", ",", "out_channel", ",", "3", ",", "padding", "=", "padding", ")", "\n", "\n", "self", ".", "conv2", "=", "ConvLayer", "(", "\n", "out_channel", ",", "\n", "out_channel", ",", "\n", "3", ",", "\n", "downsample", "=", "downsample", ",", "\n", "padding", "=", "padding", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", ")", "\n", "\n", "if", "downsample", "or", "in_channel", "!=", "out_channel", ":", "\n", "            ", "self", ".", "skip", "=", "ConvLayer", "(", "\n", "in_channel", ",", "\n", "out_channel", ",", "\n", "1", ",", "\n", "downsample", "=", "downsample", ",", "\n", "blur_kernel", "=", "blur_kernel", ",", "\n", "bias", "=", "False", ",", "\n", "activate", "=", "False", ",", "\n", ")", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "skip", "=", "None", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "conv1", "(", "input", ")", "\n", "out", "=", "self", ".", "conv2", "(", "out", ")", "\n", "\n", "if", "self", ".", "skip", "is", "not", "None", ":", "\n", "            ", "skip", "=", "self", ".", "skip", "(", "input", ")", "\n", "\n", "", "else", ":", "\n", "            ", "skip", "=", "input", "\n", "\n", "# print(out.shape)", "\n", "\n", "", "return", "(", "out", "+", "skip", ")", "/", "math", ".", "sqrt", "(", "2", ")", "\n", "\n", "", "", "class", "Stem", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ModulatedConv2d.__repr__": [[230, 233], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "gray", "=", "False", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ModulatedConv2d.forward": [[236, 278], ["model.ModulatedConv2d.modulation().view", "weight.transpose().reshape.transpose().reshape.view", "torch.rsqrt", "input.view.view.view", "weight.transpose().reshape.transpose().reshape.view", "weight.transpose().reshape.transpose().reshape.transpose().reshape", "torch.nn.functional.conv_transpose2d", "out.view.view.view", "model.ModulatedConv2d.blur", "model.ModulatedConv2d.modulation", "torch.rsqrt.view", "model.ModulatedConv2d.blur", "input.view.view.view", "torch.nn.functional.conv2d", "out.view.view.view", "input.view.view.view", "torch.nn.functional.conv2d", "out.view.view.view", "weight.transpose().reshape.transpose().reshape.pow().sum", "weight.transpose().reshape.transpose().reshape.transpose", "weight.transpose().reshape.transpose().reshape.pow"], "methods", ["None"], ["if", "gray", ":", "\n", "            ", "self", ".", "stem", "=", "ConvLayer", "(", "1", ",", "channel", ",", "3", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "stem", "=", "ConvLayer", "(", "3", ",", "channel", ",", "3", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "\n", "return", "out", "\n", "\n", "", "", "class", "StrBranch", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "0", ",", "1", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale2", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n", "scale3", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ",", "4", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n", "self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "1", ")", ",", "ConvLayer", "(", "ch", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ",", "multi_out", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.NoiseInjection.__init__": [[281, 285], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.zeros"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["\n", "if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "structure", "\n", "", "else", ":", "\n", "            ", "return", "structure", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.NoiseInjection.forward": [[286, 292], ["image.new_empty().normal_", "image.new_empty"], "methods", ["None"], ["\n", "", "", "", "class", "CifarStrBranch", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ConstantInput.__init__": [[295, 299], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.randn"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ConstantInput.forward": [[300, 305], ["model.ConstantInput.input.repeat"], "methods", ["None"], ["for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale2", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.StyledConv.__init__": [[308, 334], ["torch.nn.Module.__init__", "model.ModulatedConv2d", "model.NoiseInjection", "op.FusedLeakyReLU"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n", "self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "1", ")", ",", "ConvLayer", "(", "ch", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ",", "multi_out", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n", "scale3", "=", "self", ".", "scale3", "(", "scale2", ")", "\n", "structure", "=", "self", ".", "structure", "(", "scale3", ")", "\n", "\n", "if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "structure", "\n", "", "else", ":", "\n", "            ", "return", "structure", "\n", "\n", "", "", "", "class", "TexBranch", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "texture_channel", "=", "8", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "0", ",", "1", ")", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.StyledConv.forward": [[335, 342], ["model.StyledConv.conv", "model.StyledConv.noise", "model.StyledConv.activate"], "methods", ["None"], ["            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ToRGB.__init__": [[345, 353], ["torch.nn.Module.__init__", "model.ModulatedConv2d", "torch.nn.Parameter", "model.Upsample", "torch.zeros"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n", "scale3", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ",", "4", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ToRGB.forward": [[354, 364], ["model.ToRGB.conv", "model.ToRGB.upsample"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.upsample"], ["self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "ch", "*", "4", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "4", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ",", "multi_out", "=", "True", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n", "scale3", "=", "self", ".", "scale3", "(", "scale2", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Generator.__init__": [[367, 451], ["torch.nn.Module.__init__", "range", "torch.nn.Sequential", "model.ConstantInput", "model.StyledConv", "model.ToRGB", "int", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.ModuleList", "torch.nn.Module", "range", "range", "model.PixelNorm", "layers.append", "math.log", "model.Generator.noises.register_buffer", "model.Generator.convs.append", "model.Generator.convs.append", "model.Generator.to_rgbs.append", "model.EqualLinear", "torch.randn", "model.StyledConv", "model.StyledConv", "model.ToRGB"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "texture", "\n", "", "else", ":", "\n", "            ", "return", "texture", "\n", "\n", "", "", "", "class", "CifarTexBranch", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "texture_channel", "=", "128", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "scale1", "=", "[", "]", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "0", ",", "1", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale1", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale1", "=", "nn", ".", "Sequential", "(", "*", "scale1", ")", "\n", "\n", "scale2", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "1", ",", "2", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale2", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale2", "=", "nn", ".", "Sequential", "(", "*", "scale2", ")", "\n", "\n", "scale3", "=", "[", "]", "\n", "for", "i", "in", "range", "(", "2", ",", "3", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "scale3", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "", "self", ".", "scale3", "=", "nn", ".", "Sequential", "(", "*", "scale3", ")", "\n", "\n", "self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "2", ",", "downsample", "=", "False", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ",", "multi_out", "=", "True", ")", ":", "\n", "        ", "scale1", "=", "self", ".", "scale1", "(", "input", ")", "\n", "scale2", "=", "self", ".", "scale2", "(", "scale1", ")", "\n", "scale3", "=", "self", ".", "scale3", "(", "scale2", ")", "\n", "texture", "=", "torch", ".", "flatten", "(", "self", ".", "texture", "(", "scale3", ")", ",", "1", ")", "\n", "\n", "if", "multi_out", ":", "\n", "            ", "return", "scale1", ",", "scale2", ",", "scale3", ",", "texture", "\n", "", "else", ":", "\n", "            ", "return", "texture", "\n", "\n", "", "", "", "class", "PyramidEncoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ",", "texture_channel", "=", "2048", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "stem", "=", "Stem", "(", "channel", ",", "gray", "=", "gray", ")", "\n", "self", ".", "str_branch", "=", "StrBranch", "(", "channel", ",", "structure_channel", ")", "\n", "self", ".", "tex_branch", "=", "TexBranch", "(", "channel", ",", "texture_channel", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ",", "run_str", "=", "True", ",", "run_tex", "=", "True", ",", "multi_str", "=", "False", ",", "multi_tex", "=", "True", ")", ":", "\n", "        ", "structures", "=", "None", "\n", "textures", "=", "None", "\n", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "if", "run_str", ":", "\n", "            ", "structures", "=", "self", ".", "str_branch", "(", "out", ",", "multi_out", "=", "multi_str", ")", "\n", "", "if", "run_tex", ":", "\n", "            ", "textures", "=", "self", ".", "tex_branch", "(", "out", ",", "multi_out", "=", "multi_tex", ")", "\n", "", "return", "structures", ",", "textures", "\n", "\n", "", "", "class", "CifarPyramidEncoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "self", ",", "channel", ",", "structure_channel", "=", "8", ",", "texture_channel", "=", "128", ",", "gray", "=", "False", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "stem", "=", "Stem", "(", "channel", ",", "gray", "=", "gray", ")", "\n", "self", ".", "str_branch", "=", "CifarStrBranch", "(", "channel", ",", "structure_channel", ")", "\n", "self", ".", "tex_branch", "=", "CifarTexBranch", "(", "channel", ",", "texture_channel", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ",", "run_str", "=", "True", ",", "run_tex", "=", "True", ",", "multi_str", "=", "False", ",", "multi_tex", "=", "True", ")", ":", "\n", "        ", "structures", "=", "None", "\n", "textures", "=", "None", "\n", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "if", "run_str", ":", "\n", "            ", "structures", "=", "self", ".", "str_branch", "(", "out", ",", "multi_out", "=", "multi_str", ")", "\n", "", "if", "run_tex", ":", "\n", "            ", "textures", "=", "self", ".", "tex_branch", "(", "out", ",", "multi_out", "=", "multi_tex", ")", "\n", "", "return", "structures", ",", "textures", "\n", "\n", "", "", "class", "Encoder", "(", "nn", ".", "Module", ")", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Generator.make_noise": [[452, 462], ["range", "torch.randn", "range", "noises.append", "torch.randn"], "methods", ["None"], ["    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "2048", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "stem", "=", "[", "ConvLayer", "(", "3", ",", "channel", ",", "1", ")", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Generator.mean_latent": [[463, 470], ["torch.randn", "model.Generator.style().mean", "model.Generator.style"], "methods", ["None"], ["in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "1", ",", "5", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "stem", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "\n", "", "self", ".", "stem", "=", "nn", ".", "Sequential", "(", "*", "stem", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Generator.get_latent": [[471, 473], ["model.Generator.style"], "methods", ["None"], ["self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "1", ")", ",", "ConvLayer", "(", "ch", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Generator.forward": [[474, 546], ["model.Generator.input", "model.Generator.conv1", "model.Generator.to_rgb1", "zip", "len", "styles[].unsqueeze().repeat", "styles[].unsqueeze().repeat", "torch.cat", "conv1", "conv2", "to_rgb", "model.Generator.style", "style_t.append", "styles[].unsqueeze().repeat", "random.randint", "getattr", "styles[].unsqueeze", "styles[].unsqueeze", "range", "styles[].unsqueeze"], "methods", ["None"], ["\n", "self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "ch", "*", "4", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "4", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "\n", "structure", "=", "self", ".", "structure", "(", "out", ")", "\n", "texture", "=", "torch", ".", "flatten", "(", "self", ".", "texture", "(", "out", ")", ",", "1", ")", "\n", "\n", "return", "structure", ",", "texture", "\n", "\n", "", "", "class", "LightEncoder", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "1024", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "stem", "=", "[", "ConvLayer", "(", "3", ",", "channel", ",", "1", ")", "]", "\n", "\n", "in_channel", "=", "channel", "\n", "for", "i", "in", "range", "(", "1", ",", "5", ")", ":", "\n", "            ", "ch", "=", "channel", "*", "(", "2", "**", "i", ")", "\n", "stem", ".", "append", "(", "ResBlock", "(", "in_channel", ",", "ch", ",", "downsample", "=", "True", ",", "padding", "=", "\"reflect\"", ")", ")", "\n", "in_channel", "=", "ch", "\n", "\n", "", "self", ".", "stem", "=", "nn", ".", "Sequential", "(", "*", "stem", ")", "\n", "\n", "self", ".", "structure", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", "//", "4", ",", "1", ")", ",", "ConvLayer", "(", "ch", "//", "4", ",", "structure_channel", ",", "1", ")", "\n", ")", "\n", "\n", "self", ".", "texture", "=", "nn", ".", "Sequential", "(", "\n", "ConvLayer", "(", "ch", ",", "ch", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "ConvLayer", "(", "ch", ",", "ch", "*", "2", ",", "3", ",", "downsample", "=", "True", ",", "padding", "=", "\"valid\"", ")", ",", "\n", "nn", ".", "AdaptiveAvgPool2d", "(", "1", ")", ",", "\n", "ConvLayer", "(", "ch", "*", "2", ",", "texture_channel", ",", "1", ")", ",", "\n", ")", "\n", "\n", "", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "out", "=", "self", ".", "stem", "(", "input", ")", "\n", "\n", "structure", "=", "self", ".", "structure", "(", "out", ")", "\n", "texture", "=", "torch", ".", "flatten", "(", "self", ".", "texture", "(", "out", ")", ",", "1", ")", "\n", "\n", "return", "structure", ",", "texture", "\n", "\n", "", "", "class", "Generator", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "2048", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "gray", "=", "False", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gray", "=", "gray", "\n", "\n", "ch_multiplier", "=", "(", "4", ",", "8", ",", "12", ",", "16", ",", "16", ",", "16", ",", "8", ",", "4", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n", "for", "ch_mul", ",", "up", "in", "zip", "(", "ch_multiplier", ",", "upsample", ")", ":", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ConvLayer.__init__": [[549, 595], ["layers.append", "torch.nn.Sequential.__init__", "layers.append", "model.EqualConv2d", "model.Blur", "layers.append", "layers.append", "len", "op.FusedLeakyReLU", "model.ScaledLeakyReLU"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["in_ch", ",", "channel", "*", "ch_mul", ",", "texture_channel", ",", "up", ",", "blur_kernel", "\n", ")", "\n", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "", "if", "gray", ":", "\n", "            ", "self", ".", "to_img", "=", "ConvLayer", "(", "in_ch", ",", "1", ",", "1", ",", "activate", "=", "False", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "3", ",", "1", ",", "activate", "=", "False", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "structure", ",", "texture", ",", "noises", "=", "None", ")", ":", "\n", "        ", "if", "noises", "is", "None", ":", "\n", "            ", "noises", "=", "[", "None", "]", "*", "len", "(", "self", ".", "layers", ")", "\n", "\n", "", "out", "=", "structure", "\n", "for", "layer", ",", "noise", "in", "zip", "(", "self", ".", "layers", ",", "noises", ")", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "texture", ",", "noise", ")", "\n", "\n", "", "if", "self", ".", "gray", ":", "\n", "            ", "out", "=", "self", ".", "to_img", "(", "out", ")", "\n", "", "else", ":", "\n", "            ", "out", "=", "self", ".", "to_rgb", "(", "out", ")", "\n", "\n", "", "return", "out", "\n", "\n", "", "", "class", "CifarGenerator", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "128", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "gray", "=", "False", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "self", ".", "gray", "=", "gray", "\n", "\n", "ch_multiplier", "=", "(", "2", ",", "4", ",", "6", ",", "8", ",", "8", ",", "4", ",", "2", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n", "for", "ch_mul", ",", "up", "in", "zip", "(", "ch_multiplier", ",", "upsample", ")", ":", "\n", "            ", "self", ".", "layers", ".", "append", "(", "\n", "StyledResBlock", "(", "\n", "in_ch", ",", "channel", "*", "ch_mul", ",", "texture_channel", ",", "up", ",", "blur_kernel", "\n", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ResBlock.__init__": [[598, 606], ["torch.nn.Module.__init__", "model.ConvLayer", "model.ConvLayer", "model.ConvLayer"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["\n", "", "if", "gray", ":", "\n", "            ", "self", ".", "to_img", "=", "ConvLayer", "(", "in_ch", ",", "1", ",", "1", ",", "activate", "=", "False", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "3", ",", "1", ",", "activate", "=", "False", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "structure", ",", "texture", ",", "noises", "=", "None", ")", ":", "\n", "        ", "if", "noises", "is", "None", ":", "\n", "            ", "noises", "=", "[", "None", "]", "*", "len", "(", "self", ".", "layers", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.ResBlock.forward": [[608, 616], ["model.ResBlock.conv1", "model.ResBlock.conv2", "model.ResBlock.skip", "math.sqrt"], "methods", ["None"], ["", "out", "=", "structure", "\n", "for", "layer", ",", "noise", "in", "zip", "(", "self", ".", "layers", ",", "noises", ")", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "texture", ",", "noise", ")", "\n", "\n", "", "if", "self", ".", "gray", ":", "\n", "            ", "out", "=", "self", ".", "to_img", "(", "out", ")", "\n", "", "else", ":", "\n", "            ", "out", "=", "self", ".", "to_rgb", "(", "out", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Discriminator.__init__": [[619, 656], ["torch.nn.Module.__init__", "int", "range", "torch.nn.Sequential", "model.ConvLayer", "torch.nn.Sequential", "model.ConvLayer", "math.log", "convs.append", "model.EqualLinear", "model.EqualLinear", "model.ResBlock"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["", "", "class", "OldGenerator", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "2048", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", "gray", "=", "False", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "ch_multiplier", "=", "(", "4", ",", "8", ",", "12", ",", "16", ",", "16", ",", "16", ",", "8", ",", "4", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n", "for", "ch_mul", ",", "up", "in", "zip", "(", "ch_multiplier", ",", "upsample", ")", ":", "\n", "            ", "self", ".", "layers", ".", "append", "(", "\n", "StyledResBlock", "(", "\n", "in_ch", ",", "channel", "*", "ch_mul", ",", "texture_channel", ",", "up", ",", "blur_kernel", "\n", ")", "\n", ")", "\n", "in_ch", "=", "channel", "*", "ch_mul", "\n", "\n", "", "if", "gray", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "1", ",", "1", ",", "activate", "=", "False", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "to_rgb", "=", "ConvLayer", "(", "in_ch", ",", "3", ",", "1", ",", "activate", "=", "False", ")", "\n", "\n", "", "", "def", "forward", "(", "self", ",", "structure", ",", "texture", ",", "noises", "=", "None", ")", ":", "\n", "        ", "if", "noises", "is", "None", ":", "\n", "            ", "noises", "=", "[", "None", "]", "*", "len", "(", "self", ".", "layers", ")", "\n", "\n", "", "out", "=", "structure", "\n", "for", "layer", ",", "noise", "in", "zip", "(", "self", ".", "layers", ",", "noises", ")", ":", "\n", "            ", "out", "=", "layer", "(", "out", ",", "texture", ",", "noise", ")", "\n", "\n", "", "out", "=", "self", ".", "to_rgb", "(", "out", ")", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.Discriminator.forward": [[658, 677], ["model.Discriminator.convs", "min", "model.Discriminator.view", "torch.sqrt", "stddev.repeat.repeat.mean().squeeze", "stddev.repeat.repeat.repeat", "torch.cat", "model.Discriminator.final_conv", "model.Discriminator.view", "model.Discriminator.final_linear", "stddev.repeat.repeat.var", "stddev.repeat.repeat.mean"], "methods", ["None"], ["return", "out", "\n", "\n", "", "", "class", "AugGenerator", "(", "nn", ".", "Module", ")", ":", "\n", "    ", "def", "__init__", "(", "\n", "self", ",", "\n", "channel", ",", "\n", "structure_channel", "=", "8", ",", "\n", "texture_channel", "=", "1024", ",", "\n", "blur_kernel", "=", "(", "1", ",", "3", ",", "3", ",", "1", ")", ",", "\n", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "ch_multiplier", "=", "(", "4", ",", "8", ",", "12", ",", "16", ",", "16", ",", "16", ",", "8", ",", "4", ")", "\n", "upsample", "=", "(", "False", ",", "False", ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ")", "\n", "\n", "self", ".", "blank_style", "=", "nn", ".", "Parameter", "(", "torch", ".", "empty", "(", "1", ",", "texture_channel", ")", ")", "\n", "nn", ".", "init", ".", "normal_", "(", "self", ".", "blank_style", ")", "\n", "\n", "self", ".", "layers", "=", "nn", ".", "ModuleList", "(", ")", "\n", "in_ch", "=", "structure_channel", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.model.make_kernel": [[22, 31], ["torch.tensor", "torch.tensor.sum"], "function", ["None"], ["self", ".", "scale", "=", "1", "/", "math", ".", "sqrt", "(", "in_channel", "*", "kernel_size", "**", "2", ")", "\n", "\n", "self", ".", "stride", "=", "stride", "\n", "self", ".", "padding", "=", "padding", "\n", "\n", "if", "bias", ":", "\n", "            ", "self", ".", "bias", "=", "nn", ".", "Parameter", "(", "torch", ".", "zeros", "(", "out_channel", ")", ")", "\n", "\n", "", "else", ":", "\n", "            ", "self", ".", "bias", "=", "None", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_modconv": [[14, 40], ["vars[].value().eval", "vars[].value().eval", "vars[].value().eval", "vars[].value().eval", "vars[].value().eval", "dic.items", "numpy.expand_dims", "vars[].value().eval.transpose", "numpy.array", "torch.from_numpy", "torch.flip", "vars[].value", "vars[].value", "vars[].value", "vars[].value", "vars[].value", "vars[].value().eval.transpose"], "function", ["None"], ["def", "convert_modconv", "(", "vars", ",", "source_name", ",", "target_name", ",", "flip", "=", "False", ")", ":", "\n", "    ", "weight", "=", "vars", "[", "source_name", "+", "\"/weight\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "mod_weight", "=", "vars", "[", "source_name", "+", "\"/mod_weight\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "mod_bias", "=", "vars", "[", "source_name", "+", "\"/mod_bias\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "noise", "=", "vars", "[", "source_name", "+", "\"/noise_strength\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "bias", "=", "vars", "[", "source_name", "+", "\"/bias\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "\n", "dic", "=", "{", "\n", "\"conv.weight\"", ":", "np", ".", "expand_dims", "(", "weight", ".", "transpose", "(", "(", "3", ",", "2", ",", "0", ",", "1", ")", ")", ",", "0", ")", ",", "\n", "\"conv.modulation.weight\"", ":", "mod_weight", ".", "transpose", "(", "(", "1", ",", "0", ")", ")", ",", "\n", "\"conv.modulation.bias\"", ":", "mod_bias", "+", "1", ",", "\n", "\"noise.weight\"", ":", "np", ".", "array", "(", "[", "noise", "]", ")", ",", "\n", "\"activate.bias\"", ":", "bias", ",", "\n", "}", "\n", "\n", "dic_torch", "=", "{", "}", "\n", "\n", "for", "k", ",", "v", "in", "dic", ".", "items", "(", ")", ":", "\n", "        ", "dic_torch", "[", "target_name", "+", "\".\"", "+", "k", "]", "=", "torch", ".", "from_numpy", "(", "v", ")", "\n", "\n", "", "if", "flip", ":", "\n", "        ", "dic_torch", "[", "target_name", "+", "\".conv.weight\"", "]", "=", "torch", ".", "flip", "(", "\n", "dic_torch", "[", "target_name", "+", "\".conv.weight\"", "]", ",", "[", "3", ",", "4", "]", "\n", ")", "\n", "\n", "", "return", "dic_torch", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_conv": [[42, 58], ["vars[].value().eval", "torch.from_numpy", "vars[].value().eval.transpose", "vars[].value().eval", "torch.from_numpy", "vars[].value", "vars[].value"], "function", ["None"], ["", "def", "convert_conv", "(", "vars", ",", "source_name", ",", "target_name", ",", "bias", "=", "True", ",", "start", "=", "0", ")", ":", "\n", "    ", "weight", "=", "vars", "[", "source_name", "+", "\"/weight\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "\n", "dic", "=", "{", "\"weight\"", ":", "weight", ".", "transpose", "(", "(", "3", ",", "2", ",", "0", ",", "1", ")", ")", "}", "\n", "\n", "if", "bias", ":", "\n", "        ", "dic", "[", "\"bias\"", "]", "=", "vars", "[", "source_name", "+", "\"/bias\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "\n", "", "dic_torch", "=", "{", "}", "\n", "\n", "dic_torch", "[", "target_name", "+", "f\".{start}.weight\"", "]", "=", "torch", ".", "from_numpy", "(", "dic", "[", "\"weight\"", "]", ")", "\n", "\n", "if", "bias", ":", "\n", "        ", "dic_torch", "[", "target_name", "+", "f\".{start + 1}.bias\"", "]", "=", "torch", ".", "from_numpy", "(", "dic", "[", "\"bias\"", "]", ")", "\n", "\n", "", "return", "dic_torch", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_torgb": [[60, 79], ["vars[].value().eval", "vars[].value().eval", "vars[].value().eval", "vars[].value().eval", "dic.items", "numpy.expand_dims", "vars[].value().eval.transpose", "vars[].value().eval.reshape", "torch.from_numpy", "vars[].value", "vars[].value", "vars[].value", "vars[].value", "vars[].value().eval.transpose"], "function", ["None"], ["", "def", "convert_torgb", "(", "vars", ",", "source_name", ",", "target_name", ")", ":", "\n", "    ", "weight", "=", "vars", "[", "source_name", "+", "\"/weight\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "mod_weight", "=", "vars", "[", "source_name", "+", "\"/mod_weight\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "mod_bias", "=", "vars", "[", "source_name", "+", "\"/mod_bias\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "bias", "=", "vars", "[", "source_name", "+", "\"/bias\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "\n", "dic", "=", "{", "\n", "\"conv.weight\"", ":", "np", ".", "expand_dims", "(", "weight", ".", "transpose", "(", "(", "3", ",", "2", ",", "0", ",", "1", ")", ")", ",", "0", ")", ",", "\n", "\"conv.modulation.weight\"", ":", "mod_weight", ".", "transpose", "(", "(", "1", ",", "0", ")", ")", ",", "\n", "\"conv.modulation.bias\"", ":", "mod_bias", "+", "1", ",", "\n", "\"bias\"", ":", "bias", ".", "reshape", "(", "(", "1", ",", "3", ",", "1", ",", "1", ")", ")", ",", "\n", "}", "\n", "\n", "dic_torch", "=", "{", "}", "\n", "\n", "for", "k", ",", "v", "in", "dic", ".", "items", "(", ")", ":", "\n", "        ", "dic_torch", "[", "target_name", "+", "\".\"", "+", "k", "]", "=", "torch", ".", "from_numpy", "(", "v", ")", "\n", "\n", "", "return", "dic_torch", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_dense": [[81, 93], ["vars[].value().eval", "vars[].value().eval", "dic.items", "vars[].value().eval.transpose", "torch.from_numpy", "vars[].value", "vars[].value"], "function", ["None"], ["", "def", "convert_dense", "(", "vars", ",", "source_name", ",", "target_name", ")", ":", "\n", "    ", "weight", "=", "vars", "[", "source_name", "+", "\"/weight\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "bias", "=", "vars", "[", "source_name", "+", "\"/bias\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", "\n", "dic", "=", "{", "\"weight\"", ":", "weight", ".", "transpose", "(", "(", "1", ",", "0", ")", ")", ",", "\"bias\"", ":", "bias", "}", "\n", "\n", "dic_torch", "=", "{", "}", "\n", "\n", "for", "k", ",", "v", "in", "dic", ".", "items", "(", ")", ":", "\n", "        ", "dic_torch", "[", "target_name", "+", "\".\"", "+", "k", "]", "=", "torch", ".", "from_numpy", "(", "v", ")", "\n", "\n", "", "return", "dic_torch", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update": [[95, 104], ["new.items", "KeyError", "ValueError"], "function", ["None"], ["", "def", "update", "(", "state_dict", ",", "new", ")", ":", "\n", "    ", "for", "k", ",", "v", "in", "new", ".", "items", "(", ")", ":", "\n", "        ", "if", "k", "not", "in", "state_dict", ":", "\n", "            ", "raise", "KeyError", "(", "k", "+", "\" is not found\"", ")", "\n", "\n", "", "if", "v", ".", "shape", "!=", "state_dict", "[", "k", "]", ".", "shape", ":", "\n", "            ", "raise", "ValueError", "(", "f\"Shape mismatch: {v.shape} vs {state_dict[k].shape}\"", ")", "\n", "\n", "", "state_dict", "[", "k", "]", "=", "v", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.discriminator_fill_statedict": [[106, 138], ["int", "convert_weight.update", "range", "convert_weight.update", "convert_weight.update", "convert_weight.update", "math.log", "convert_weight.convert_conv", "convert_weight.update", "convert_weight.update", "convert_weight.update", "convert_weight.convert_conv", "convert_weight.convert_dense", "convert_weight.convert_dense", "convert_weight.convert_conv", "convert_weight.convert_conv", "convert_weight.convert_conv"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_conv", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_conv", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_dense", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_dense", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_conv", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_conv", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_conv"], ["", "", "def", "discriminator_fill_statedict", "(", "statedict", ",", "vars", ",", "size", ")", ":", "\n", "    ", "log_size", "=", "int", "(", "math", ".", "log", "(", "size", ",", "2", ")", ")", "\n", "\n", "update", "(", "statedict", ",", "convert_conv", "(", "vars", ",", "f\"{size}x{size}/FromRGB\"", ",", "\"convs.0\"", ")", ")", "\n", "\n", "conv_i", "=", "1", "\n", "\n", "for", "i", "in", "range", "(", "log_size", "-", "2", ",", "0", ",", "-", "1", ")", ":", "\n", "        ", "reso", "=", "4", "*", "2", "**", "i", "\n", "update", "(", "\n", "statedict", ",", "\n", "convert_conv", "(", "vars", ",", "f\"{reso}x{reso}/Conv0\"", ",", "f\"convs.{conv_i}.conv1\"", ")", ",", "\n", ")", "\n", "update", "(", "\n", "statedict", ",", "\n", "convert_conv", "(", "\n", "vars", ",", "f\"{reso}x{reso}/Conv1_down\"", ",", "f\"convs.{conv_i}.conv2\"", ",", "start", "=", "1", "\n", ")", ",", "\n", ")", "\n", "update", "(", "\n", "statedict", ",", "\n", "convert_conv", "(", "\n", "vars", ",", "f\"{reso}x{reso}/Skip\"", ",", "f\"convs.{conv_i}.skip\"", ",", "start", "=", "1", ",", "bias", "=", "False", "\n", ")", ",", "\n", ")", "\n", "conv_i", "+=", "1", "\n", "\n", "", "update", "(", "statedict", ",", "convert_conv", "(", "vars", ",", "f\"4x4/Conv\"", ",", "\"final_conv\"", ")", ")", "\n", "update", "(", "statedict", ",", "convert_dense", "(", "vars", ",", "f\"4x4/Dense0\"", ",", "\"final_linear.0\"", ")", ")", "\n", "update", "(", "statedict", ",", "convert_dense", "(", "vars", ",", "f\"Output\"", ",", "\"final_linear.1\"", ")", ")", "\n", "\n", "return", "statedict", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.fill_statedict": [[140, 198], ["int", "range", "convert_weight.update", "convert_weight.update", "range", "convert_weight.update", "range", "range", "math.log", "convert_weight.update", "convert_weight.convert_torgb", "convert_weight.update", "convert_weight.convert_modconv", "convert_weight.update", "convert_weight.update", "convert_weight.update", "convert_weight.convert_dense", "torch.from_numpy", "convert_weight.convert_torgb", "convert_weight.convert_modconv", "convert_weight.convert_modconv", "vars[].value().eval", "torch.from_numpy", "vars[].value().eval", "vars[].value", "vars[].value"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_torgb", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_modconv", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.update", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_dense", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_torgb", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_modconv", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.convert_weight.convert_modconv"], ["", "def", "fill_statedict", "(", "state_dict", ",", "vars", ",", "size", ")", ":", "\n", "    ", "log_size", "=", "int", "(", "math", ".", "log", "(", "size", ",", "2", ")", ")", "\n", "\n", "for", "i", "in", "range", "(", "8", ")", ":", "\n", "        ", "update", "(", "state_dict", ",", "convert_dense", "(", "vars", ",", "f\"G_mapping/Dense{i}\"", ",", "f\"style.{i + 1}\"", ")", ")", "\n", "\n", "", "update", "(", "\n", "state_dict", ",", "\n", "{", "\n", "\"input.input\"", ":", "torch", ".", "from_numpy", "(", "\n", "vars", "[", "\"G_synthesis/4x4/Const/const\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", ")", "\n", "}", ",", "\n", ")", "\n", "\n", "update", "(", "state_dict", ",", "convert_torgb", "(", "vars", ",", "\"G_synthesis/4x4/ToRGB\"", ",", "\"to_rgb1\"", ")", ")", "\n", "\n", "for", "i", "in", "range", "(", "log_size", "-", "2", ")", ":", "\n", "        ", "reso", "=", "4", "*", "2", "**", "(", "i", "+", "1", ")", "\n", "update", "(", "\n", "state_dict", ",", "\n", "convert_torgb", "(", "vars", ",", "f\"G_synthesis/{reso}x{reso}/ToRGB\"", ",", "f\"to_rgbs.{i}\"", ")", ",", "\n", ")", "\n", "\n", "", "update", "(", "state_dict", ",", "convert_modconv", "(", "vars", ",", "\"G_synthesis/4x4/Conv\"", ",", "\"conv1\"", ")", ")", "\n", "\n", "conv_i", "=", "0", "\n", "\n", "for", "i", "in", "range", "(", "log_size", "-", "2", ")", ":", "\n", "        ", "reso", "=", "4", "*", "2", "**", "(", "i", "+", "1", ")", "\n", "update", "(", "\n", "state_dict", ",", "\n", "convert_modconv", "(", "\n", "vars", ",", "\n", "f\"G_synthesis/{reso}x{reso}/Conv0_up\"", ",", "\n", "f\"convs.{conv_i}\"", ",", "\n", "flip", "=", "True", ",", "\n", ")", ",", "\n", ")", "\n", "update", "(", "\n", "state_dict", ",", "\n", "convert_modconv", "(", "\n", "vars", ",", "f\"G_synthesis/{reso}x{reso}/Conv1\"", ",", "f\"convs.{conv_i + 1}\"", "\n", ")", ",", "\n", ")", "\n", "conv_i", "+=", "2", "\n", "\n", "", "for", "i", "in", "range", "(", "0", ",", "(", "log_size", "-", "2", ")", "*", "2", "+", "1", ")", ":", "\n", "        ", "update", "(", "\n", "state_dict", ",", "\n", "{", "\n", "f\"noises.noise_{i}\"", ":", "torch", ".", "from_numpy", "(", "\n", "vars", "[", "f\"G_synthesis/noise{i}\"", "]", ".", "value", "(", ")", ".", "eval", "(", ")", "\n", ")", "\n", "}", ",", "\n", ")", "\n", "\n", "", "return", "state_dict", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.fid.extract_feature_from_samples": [[14, 32], ["torch.no_grad", "tqdm.tqdm", "torch.cat", "torch.randn", "g", "[].view", "torch.cat.append", "[].view.to", "inception"], "function", ["None"], ["@", "torch", ".", "no_grad", "(", ")", "\n", "def", "extract_feature_from_samples", "(", "\n", "generator", ",", "inception", ",", "truncation", ",", "truncation_latent", ",", "batch_size", ",", "n_sample", ",", "device", "\n", ")", ":", "\n", "    ", "n_batch", "=", "n_sample", "//", "batch_size", "\n", "resid", "=", "n_sample", "-", "(", "n_batch", "*", "batch_size", ")", "\n", "batch_sizes", "=", "[", "batch_size", "]", "*", "n_batch", "+", "[", "resid", "]", "\n", "features", "=", "[", "]", "\n", "\n", "for", "batch", "in", "tqdm", "(", "batch_sizes", ")", ":", "\n", "        ", "latent", "=", "torch", ".", "randn", "(", "batch", ",", "512", ",", "device", "=", "device", ")", "\n", "img", ",", "_", "=", "g", "(", "[", "latent", "]", ",", "truncation", "=", "truncation", ",", "truncation_latent", "=", "truncation_latent", ")", "\n", "feat", "=", "inception", "(", "img", ")", "[", "0", "]", ".", "view", "(", "img", ".", "shape", "[", "0", "]", ",", "-", "1", ")", "\n", "features", ".", "append", "(", "feat", ".", "to", "(", "'cpu'", ")", ")", "\n", "\n", "", "features", "=", "torch", ".", "cat", "(", "features", ",", "0", ")", "\n", "\n", "return", "features", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.stylegan2.fid.calc_fid": [[34, 58], ["scipy.linalg.sqrtm", "numpy.iscomplexobj", "numpy.isfinite().all", "print", "scipy.linalg.sqrtm", "numpy.eye", "numpy.allclose", "numpy.max", "ValueError", "numpy.trace", "numpy.trace", "numpy.trace", "numpy.isfinite", "numpy.abs", "numpy.diagonal"], "function", ["None"], ["", "def", "calc_fid", "(", "sample_mean", ",", "sample_cov", ",", "real_mean", ",", "real_cov", ",", "eps", "=", "1e-6", ")", ":", "\n", "    ", "cov_sqrt", ",", "_", "=", "linalg", ".", "sqrtm", "(", "sample_cov", "@", "real_cov", ",", "disp", "=", "False", ")", "\n", "\n", "if", "not", "np", ".", "isfinite", "(", "cov_sqrt", ")", ".", "all", "(", ")", ":", "\n", "        ", "print", "(", "'product of cov matrices is singular'", ")", "\n", "offset", "=", "np", ".", "eye", "(", "sample_cov", ".", "shape", "[", "0", "]", ")", "*", "eps", "\n", "cov_sqrt", "=", "linalg", ".", "sqrtm", "(", "(", "sample_cov", "+", "offset", ")", "@", "(", "real_cov", "+", "offset", ")", ")", "\n", "\n", "", "if", "np", ".", "iscomplexobj", "(", "cov_sqrt", ")", ":", "\n", "        ", "if", "not", "np", ".", "allclose", "(", "np", ".", "diagonal", "(", "cov_sqrt", ")", ".", "imag", ",", "0", ",", "atol", "=", "1e-3", ")", ":", "\n", "            ", "m", "=", "np", ".", "max", "(", "np", ".", "abs", "(", "cov_sqrt", ".", "imag", ")", ")", "\n", "\n", "raise", "ValueError", "(", "f'Imaginary component {m}'", ")", "\n", "\n", "", "cov_sqrt", "=", "cov_sqrt", ".", "real", "\n", "\n", "", "mean_diff", "=", "sample_mean", "-", "real_mean", "\n", "mean_norm", "=", "mean_diff", "@", "mean_diff", "\n", "\n", "trace", "=", "np", ".", "trace", "(", "sample_cov", ")", "+", "np", ".", "trace", "(", "real_cov", ")", "-", "2", "*", "np", ".", "trace", "(", "cov_sqrt", ")", "\n", "\n", "fid", "=", "mean_norm", "+", "trace", "\n", "\n", "return", "fid", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.PNetLin.__init__": [[28, 63], ["torch.Module.__init__", "networks_basic.ScalingLayer", "len", "net_type", "networks_basic.NetLinLayer", "networks_basic.NetLinLayer", "networks_basic.NetLinLayer", "networks_basic.NetLinLayer", "networks_basic.NetLinLayer", "networks_basic.NetLinLayer", "networks_basic.NetLinLayer"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "pnet_type", "=", "'vgg'", ",", "pnet_rand", "=", "False", ",", "pnet_tune", "=", "False", ",", "use_dropout", "=", "True", ",", "spatial", "=", "False", ",", "version", "=", "'0.1'", ",", "lpips", "=", "True", ")", ":", "\n", "        ", "super", "(", "PNetLin", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "pnet_type", "=", "pnet_type", "\n", "self", ".", "pnet_tune", "=", "pnet_tune", "\n", "self", ".", "pnet_rand", "=", "pnet_rand", "\n", "self", ".", "spatial", "=", "spatial", "\n", "self", ".", "lpips", "=", "lpips", "\n", "self", ".", "version", "=", "version", "\n", "self", ".", "scaling_layer", "=", "ScalingLayer", "(", ")", "\n", "\n", "if", "(", "self", ".", "pnet_type", "in", "[", "'vgg'", ",", "'vgg16'", "]", ")", ":", "\n", "            ", "net_type", "=", "pn", ".", "vgg16", "\n", "self", ".", "chns", "=", "[", "64", ",", "128", ",", "256", ",", "512", ",", "512", "]", "\n", "", "elif", "(", "self", ".", "pnet_type", "==", "'alex'", ")", ":", "\n", "            ", "net_type", "=", "pn", ".", "alexnet", "\n", "self", ".", "chns", "=", "[", "64", ",", "192", ",", "384", ",", "256", ",", "256", "]", "\n", "", "elif", "(", "self", ".", "pnet_type", "==", "'squeeze'", ")", ":", "\n", "            ", "net_type", "=", "pn", ".", "squeezenet", "\n", "self", ".", "chns", "=", "[", "64", ",", "128", ",", "256", ",", "384", ",", "384", ",", "512", ",", "512", "]", "\n", "", "self", ".", "L", "=", "len", "(", "self", ".", "chns", ")", "\n", "\n", "self", ".", "net", "=", "net_type", "(", "pretrained", "=", "not", "self", ".", "pnet_rand", ",", "requires_grad", "=", "self", ".", "pnet_tune", ")", "\n", "\n", "if", "(", "lpips", ")", ":", "\n", "            ", "self", ".", "lin0", "=", "NetLinLayer", "(", "self", ".", "chns", "[", "0", "]", ",", "use_dropout", "=", "use_dropout", ")", "\n", "self", ".", "lin1", "=", "NetLinLayer", "(", "self", ".", "chns", "[", "1", "]", ",", "use_dropout", "=", "use_dropout", ")", "\n", "self", ".", "lin2", "=", "NetLinLayer", "(", "self", ".", "chns", "[", "2", "]", ",", "use_dropout", "=", "use_dropout", ")", "\n", "self", ".", "lin3", "=", "NetLinLayer", "(", "self", ".", "chns", "[", "3", "]", ",", "use_dropout", "=", "use_dropout", ")", "\n", "self", ".", "lin4", "=", "NetLinLayer", "(", "self", ".", "chns", "[", "4", "]", ",", "use_dropout", "=", "use_dropout", ")", "\n", "self", ".", "lins", "=", "[", "self", ".", "lin0", ",", "self", ".", "lin1", ",", "self", ".", "lin2", ",", "self", ".", "lin3", ",", "self", ".", "lin4", "]", "\n", "if", "(", "self", ".", "pnet_type", "==", "'squeeze'", ")", ":", "# 7 layers for squeezenet", "\n", "                ", "self", ".", "lin5", "=", "NetLinLayer", "(", "self", ".", "chns", "[", "5", "]", ",", "use_dropout", "=", "use_dropout", ")", "\n", "self", ".", "lin6", "=", "NetLinLayer", "(", "self", ".", "chns", "[", "6", "]", ",", "use_dropout", "=", "use_dropout", ")", "\n", "self", ".", "lins", "+=", "[", "self", ".", "lin5", ",", "self", ".", "lin6", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.PNetLin.forward": [[64, 93], ["range", "range", "networks_basic.PNetLin.net.forward", "networks_basic.PNetLin.net.forward", "networks_basic.PNetLin.scaling_layer", "networks_basic.PNetLin.scaling_layer", "lpips.normalize_tensor", "lpips.normalize_tensor", "networks_basic.upsample", "networks_basic.spatial_average", "networks_basic.upsample", "networks_basic.spatial_average", "networks_basic.PNetLin.lins[].model", "range", "networks_basic.PNetLin.lins[].model", "range", "diffs[].sum", "range", "diffs[].sum", "range"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.normalize_tensor", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.normalize_tensor", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.upsample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.spatial_average", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.upsample", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.spatial_average"], ["", "", "", "def", "forward", "(", "self", ",", "in0", ",", "in1", ",", "retPerLayer", "=", "False", ")", ":", "\n", "# v0.0 - original release had a bug, where input was not scaled", "\n", "        ", "in0_input", ",", "in1_input", "=", "(", "self", ".", "scaling_layer", "(", "in0", ")", ",", "self", ".", "scaling_layer", "(", "in1", ")", ")", "if", "self", ".", "version", "==", "'0.1'", "else", "(", "in0", ",", "in1", ")", "\n", "outs0", ",", "outs1", "=", "self", ".", "net", ".", "forward", "(", "in0_input", ")", ",", "self", ".", "net", ".", "forward", "(", "in1_input", ")", "\n", "feats0", ",", "feats1", ",", "diffs", "=", "{", "}", ",", "{", "}", ",", "{", "}", "\n", "\n", "for", "kk", "in", "range", "(", "self", ".", "L", ")", ":", "\n", "            ", "feats0", "[", "kk", "]", ",", "feats1", "[", "kk", "]", "=", "util", ".", "normalize_tensor", "(", "outs0", "[", "kk", "]", ")", ",", "util", ".", "normalize_tensor", "(", "outs1", "[", "kk", "]", ")", "\n", "diffs", "[", "kk", "]", "=", "(", "feats0", "[", "kk", "]", "-", "feats1", "[", "kk", "]", ")", "**", "2", "\n", "\n", "", "if", "(", "self", ".", "lpips", ")", ":", "\n", "            ", "if", "(", "self", ".", "spatial", ")", ":", "\n", "                ", "res", "=", "[", "upsample", "(", "self", ".", "lins", "[", "kk", "]", ".", "model", "(", "diffs", "[", "kk", "]", ")", ",", "out_H", "=", "in0", ".", "shape", "[", "2", "]", ")", "for", "kk", "in", "range", "(", "self", ".", "L", ")", "]", "\n", "", "else", ":", "\n", "                ", "res", "=", "[", "spatial_average", "(", "self", ".", "lins", "[", "kk", "]", ".", "model", "(", "diffs", "[", "kk", "]", ")", ",", "keepdim", "=", "True", ")", "for", "kk", "in", "range", "(", "self", ".", "L", ")", "]", "\n", "", "", "else", ":", "\n", "            ", "if", "(", "self", ".", "spatial", ")", ":", "\n", "                ", "res", "=", "[", "upsample", "(", "diffs", "[", "kk", "]", ".", "sum", "(", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ",", "out_H", "=", "in0", ".", "shape", "[", "2", "]", ")", "for", "kk", "in", "range", "(", "self", ".", "L", ")", "]", "\n", "", "else", ":", "\n", "                ", "res", "=", "[", "spatial_average", "(", "diffs", "[", "kk", "]", ".", "sum", "(", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ",", "keepdim", "=", "True", ")", "for", "kk", "in", "range", "(", "self", ".", "L", ")", "]", "\n", "\n", "", "", "val", "=", "res", "[", "0", "]", "\n", "for", "l", "in", "range", "(", "1", ",", "self", ".", "L", ")", ":", "\n", "            ", "val", "+=", "res", "[", "l", "]", "\n", "\n", "", "if", "(", "retPerLayer", ")", ":", "\n", "            ", "return", "(", "val", ",", "res", ")", "\n", "", "else", ":", "\n", "            ", "return", "val", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.ScalingLayer.__init__": [[95, 99], ["torch.Module.__init__", "networks_basic.ScalingLayer.register_buffer", "networks_basic.ScalingLayer.register_buffer", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "super", "(", "ScalingLayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "register_buffer", "(", "'shift'", ",", "torch", ".", "Tensor", "(", "[", "-", ".030", ",", "-", ".088", ",", "-", ".188", "]", ")", "[", "None", ",", ":", ",", "None", ",", "None", "]", ")", "\n", "self", ".", "register_buffer", "(", "'scale'", ",", "torch", ".", "Tensor", "(", "[", ".458", ",", ".448", ",", ".450", "]", ")", "[", "None", ",", ":", ",", "None", ",", "None", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.ScalingLayer.forward": [[100, 102], ["None"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inp", ")", ":", "\n", "        ", "return", "(", "inp", "-", "self", ".", "shift", ")", "/", "self", ".", "scale", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.NetLinLayer.__init__": [[106, 112], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Dropout", "torch.Dropout", "torch.Dropout"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "chn_in", ",", "chn_out", "=", "1", ",", "use_dropout", "=", "False", ")", ":", "\n", "        ", "super", "(", "NetLinLayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "layers", "=", "[", "nn", ".", "Dropout", "(", ")", ",", "]", "if", "(", "use_dropout", ")", "else", "[", "]", "\n", "layers", "+=", "[", "nn", ".", "Conv2d", "(", "chn_in", ",", "chn_out", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "False", ")", ",", "]", "\n", "self", ".", "model", "=", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.Dist2LogitLayer.__init__": [[116, 127], ["torch.Module.__init__", "torch.Sequential", "torch.Sequential", "torch.Sequential", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.LeakyReLU", "torch.LeakyReLU", "torch.LeakyReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["def", "__init__", "(", "self", ",", "chn_mid", "=", "32", ",", "use_sigmoid", "=", "True", ")", ":", "\n", "        ", "super", "(", "Dist2LogitLayer", ",", "self", ")", ".", "__init__", "(", ")", "\n", "\n", "layers", "=", "[", "nn", ".", "Conv2d", "(", "5", ",", "chn_mid", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", ",", "]", "\n", "layers", "+=", "[", "nn", ".", "LeakyReLU", "(", "0.2", ",", "True", ")", ",", "]", "\n", "layers", "+=", "[", "nn", ".", "Conv2d", "(", "chn_mid", ",", "chn_mid", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", ",", "]", "\n", "layers", "+=", "[", "nn", ".", "LeakyReLU", "(", "0.2", ",", "True", ")", ",", "]", "\n", "layers", "+=", "[", "nn", ".", "Conv2d", "(", "chn_mid", ",", "1", ",", "1", ",", "stride", "=", "1", ",", "padding", "=", "0", ",", "bias", "=", "True", ")", ",", "]", "\n", "if", "(", "use_sigmoid", ")", ":", "\n", "            ", "layers", "+=", "[", "nn", ".", "Sigmoid", "(", ")", ",", "]", "\n", "", "self", ".", "model", "=", "nn", ".", "Sequential", "(", "*", "layers", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.Dist2LogitLayer.forward": [[128, 130], ["networks_basic.Dist2LogitLayer.model.forward", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward"], ["", "def", "forward", "(", "self", ",", "d0", ",", "d1", ",", "eps", "=", "0.1", ")", ":", "\n", "        ", "return", "self", ".", "model", ".", "forward", "(", "torch", ".", "cat", "(", "(", "d0", ",", "d1", ",", "d0", "-", "d1", ",", "d0", "/", "(", "d1", "+", "eps", ")", ",", "d1", "/", "(", "d0", "+", "eps", ")", ")", ",", "dim", "=", "1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.BCERankingLoss.__init__": [[132, 137], ["torch.Module.__init__", "networks_basic.Dist2LogitLayer", "torch.nn.BCELoss", "torch.nn.BCELoss", "torch.nn.BCELoss", "torch.nn.BCELoss", "torch.nn.BCELoss", "torch.nn.BCELoss", "torch.nn.BCELoss", "torch.nn.BCELoss", "torch.nn.BCELoss"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "chn_mid", "=", "32", ")", ":", "\n", "        ", "super", "(", "BCERankingLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "net", "=", "Dist2LogitLayer", "(", "chn_mid", "=", "chn_mid", ")", "\n", "# self.parameters = list(self.net.parameters())", "\n", "self", ".", "loss", "=", "torch", ".", "nn", ".", "BCELoss", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.BCERankingLoss.forward": [[138, 142], ["networks_basic.BCERankingLoss.net.forward", "networks_basic.BCERankingLoss.loss"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward"], ["", "def", "forward", "(", "self", ",", "d0", ",", "d1", ",", "judge", ")", ":", "\n", "        ", "per", "=", "(", "judge", "+", "1.", ")", "/", "2.", "\n", "self", ".", "logit", "=", "self", ".", "net", ".", "forward", "(", "d0", ",", "d1", ")", "\n", "return", "self", ".", "loss", "(", "self", ".", "logit", ",", "per", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.FakeNet.__init__": [[145, 149], ["torch.Module.__init__"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "use_gpu", "=", "True", ",", "colorspace", "=", "'Lab'", ")", ":", "\n", "        ", "super", "(", "FakeNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "use_gpu", "=", "use_gpu", "\n", "self", ".", "colorspace", "=", "colorspace", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.L2.forward": [[152, 166], ["in0.size", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "in0.size", "lpips.l2().astype", "torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "ret_var.cuda.cuda.cuda", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "lpips.l2", "lpips.tensor2np", "lpips.tensor2np", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "lpips.tensor2tensorlab", "lpips.tensor2tensorlab", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean().view", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean", "torch.mean"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.l2", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2np", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2np", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2tensorlab", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2tensorlab"], ["    ", "def", "forward", "(", "self", ",", "in0", ",", "in1", ",", "retPerLayer", "=", "None", ")", ":", "\n", "        ", "assert", "(", "in0", ".", "size", "(", ")", "[", "0", "]", "==", "1", ")", "# currently only supports batchSize 1", "\n", "\n", "if", "(", "self", ".", "colorspace", "==", "'RGB'", ")", ":", "\n", "            ", "(", "N", ",", "C", ",", "X", ",", "Y", ")", "=", "in0", ".", "size", "(", ")", "\n", "value", "=", "torch", ".", "mean", "(", "torch", ".", "mean", "(", "torch", ".", "mean", "(", "(", "in0", "-", "in1", ")", "**", "2", ",", "dim", "=", "1", ")", ".", "view", "(", "N", ",", "1", ",", "X", ",", "Y", ")", ",", "dim", "=", "2", ")", ".", "view", "(", "N", ",", "1", ",", "1", ",", "Y", ")", ",", "dim", "=", "3", ")", ".", "view", "(", "N", ")", "\n", "return", "value", "\n", "", "elif", "(", "self", ".", "colorspace", "==", "'Lab'", ")", ":", "\n", "            ", "value", "=", "util", ".", "l2", "(", "util", ".", "tensor2np", "(", "util", ".", "tensor2tensorlab", "(", "in0", ".", "data", ",", "to_norm", "=", "False", ")", ")", ",", "\n", "util", ".", "tensor2np", "(", "util", ".", "tensor2tensorlab", "(", "in1", ".", "data", ",", "to_norm", "=", "False", ")", ")", ",", "range", "=", "100.", ")", ".", "astype", "(", "'float'", ")", "\n", "ret_var", "=", "Variable", "(", "torch", ".", "Tensor", "(", "(", "value", ",", ")", ")", ")", "\n", "if", "(", "self", ".", "use_gpu", ")", ":", "\n", "                ", "ret_var", "=", "ret_var", ".", "cuda", "(", ")", "\n", "", "return", "ret_var", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.DSSIM.forward": [[169, 181], ["torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable", "lpips.dssim().astype", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "torch.Tensor", "ret_var.cuda.cuda.cuda", "in0.size", "lpips.dssim().astype", "lpips.dssim", "lpips.dssim", "lpips.tensor2im", "lpips.tensor2im", "lpips.tensor2np", "lpips.tensor2np", "lpips.tensor2tensorlab", "lpips.tensor2tensorlab"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.dssim", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.dssim", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2im", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2im", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2np", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2np", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2tensorlab", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2tensorlab"], ["    ", "def", "forward", "(", "self", ",", "in0", ",", "in1", ",", "retPerLayer", "=", "None", ")", ":", "\n", "        ", "assert", "(", "in0", ".", "size", "(", ")", "[", "0", "]", "==", "1", ")", "# currently only supports batchSize 1", "\n", "\n", "if", "(", "self", ".", "colorspace", "==", "'RGB'", ")", ":", "\n", "            ", "value", "=", "util", ".", "dssim", "(", "1.", "*", "util", ".", "tensor2im", "(", "in0", ".", "data", ")", ",", "1.", "*", "util", ".", "tensor2im", "(", "in1", ".", "data", ")", ",", "range", "=", "255.", ")", ".", "astype", "(", "'float'", ")", "\n", "", "elif", "(", "self", ".", "colorspace", "==", "'Lab'", ")", ":", "\n", "            ", "value", "=", "util", ".", "dssim", "(", "util", ".", "tensor2np", "(", "util", ".", "tensor2tensorlab", "(", "in0", ".", "data", ",", "to_norm", "=", "False", ")", ")", ",", "\n", "util", ".", "tensor2np", "(", "util", ".", "tensor2tensorlab", "(", "in1", ".", "data", ",", "to_norm", "=", "False", ")", ")", ",", "range", "=", "100.", ")", ".", "astype", "(", "'float'", ")", "\n", "", "ret_var", "=", "Variable", "(", "torch", ".", "Tensor", "(", "(", "value", ",", ")", ")", ")", "\n", "if", "(", "self", ".", "use_gpu", ")", ":", "\n", "            ", "ret_var", "=", "ret_var", ".", "cuda", "(", ")", "\n", "", "return", "ret_var", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.spatial_average": [[17, 19], ["in_tens.mean"], "function", ["None"], ["def", "spatial_average", "(", "in_tens", ",", "keepdim", "=", "True", ")", ":", "\n", "    ", "return", "in_tens", ".", "mean", "(", "[", "2", ",", "3", "]", ",", "keepdim", "=", "keepdim", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.upsample": [[20, 25], ["torch.Upsample"], "function", ["None"], ["", "def", "upsample", "(", "in_tens", ",", "out_H", "=", "64", ")", ":", "# assumes scale factor is same for H and W", "\n", "    ", "in_H", "=", "in_tens", ".", "shape", "[", "2", "]", "\n", "scale_factor", "=", "1.", "*", "out_H", "/", "in_H", "\n", "\n", "return", "nn", ".", "Upsample", "(", "scale_factor", "=", "scale_factor", ",", "mode", "=", "'bilinear'", ",", "align_corners", "=", "False", ")", "(", "in_tens", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.print_network": [[182, 188], ["net.parameters", "print", "print", "param.numel"], "function", ["None"], ["", "", "def", "print_network", "(", "net", ")", ":", "\n", "    ", "num_params", "=", "0", "\n", "for", "param", "in", "net", ".", "parameters", "(", ")", ":", "\n", "        ", "num_params", "+=", "param", ".", "numel", "(", ")", "\n", "", "print", "(", "'Network'", ",", "net", ")", "\n", "print", "(", "'Total number of parameters: %d'", "%", "num_params", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.name": [[25, 27], ["None"], "methods", ["None"], ["    ", "def", "name", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "model_name", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.initialize": [[28, 108], ["base_model.BaseModel.initialize", "list", "networks_basic.PNetLin", "dist_model.DistModel.net.parameters", "networks_basic.BCERankingLoss", "list", "torch.optim.Adam", "dist_model.DistModel.net.eval", "dist_model.DistModel.net.to", "torch.nn.DataParallel", "print", "networks_basic.print_network", "print", "os.path.abspath", "print", "dist_model.DistModel.net.load_state_dict", "networks_basic.PNetLin", "dist_model.DistModel.rankLoss.net.parameters", "dist_model.DistModel.rankLoss.to", "os.path.join", "torch.load", "networks_basic.L2", "inspect.getfile", "networks_basic.DSSIM", "ValueError"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.initialize", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.networks_basic.print_network"], ["", "def", "initialize", "(", "self", ",", "model", "=", "'net-lin'", ",", "net", "=", "'alex'", ",", "colorspace", "=", "'Lab'", ",", "pnet_rand", "=", "False", ",", "pnet_tune", "=", "False", ",", "model_path", "=", "None", ",", "\n", "use_gpu", "=", "True", ",", "printNet", "=", "False", ",", "spatial", "=", "False", ",", "\n", "is_train", "=", "False", ",", "lr", "=", ".0001", ",", "beta1", "=", "0.5", ",", "version", "=", "'0.1'", ",", "gpu_ids", "=", "[", "0", "]", ")", ":", "\n", "        ", "'''\n        INPUTS\n            model - ['net-lin'] for linearly calibrated network\n                    ['net'] for off-the-shelf network\n                    ['L2'] for L2 distance in Lab colorspace\n                    ['SSIM'] for ssim in RGB colorspace\n            net - ['squeeze','alex','vgg']\n            model_path - if None, will look in weights/[NET_NAME].pth\n            colorspace - ['Lab','RGB'] colorspace to use for L2 and SSIM\n            use_gpu - bool - whether or not to use a GPU\n            printNet - bool - whether or not to print network architecture out\n            spatial - bool - whether to output an array containing varying distances across spatial dimensions\n            spatial_shape - if given, output spatial shape. if None then spatial shape is determined automatically via spatial_factor (see below).\n            spatial_factor - if given, specifies upsampling factor relative to the largest spatial extent of a convolutional layer. if None then resized to size of input images.\n            spatial_order - spline order of filter for upsampling in spatial mode, by default 1 (bilinear).\n            is_train - bool - [True] for training mode\n            lr - float - initial learning rate\n            beta1 - float - initial momentum term for adam\n            version - 0.1 for latest, 0.0 was original (with a bug)\n            gpu_ids - int array - [0] by default, gpus to use\n        '''", "\n", "BaseModel", ".", "initialize", "(", "self", ",", "use_gpu", "=", "use_gpu", ",", "gpu_ids", "=", "gpu_ids", ")", "\n", "\n", "self", ".", "model", "=", "model", "\n", "self", ".", "net", "=", "net", "\n", "self", ".", "is_train", "=", "is_train", "\n", "self", ".", "spatial", "=", "spatial", "\n", "self", ".", "gpu_ids", "=", "gpu_ids", "\n", "self", ".", "model_name", "=", "'%s [%s]'", "%", "(", "model", ",", "net", ")", "\n", "\n", "if", "(", "self", ".", "model", "==", "'net-lin'", ")", ":", "# pretrained net + linear layer", "\n", "            ", "self", ".", "net", "=", "networks", ".", "PNetLin", "(", "pnet_rand", "=", "pnet_rand", ",", "pnet_tune", "=", "pnet_tune", ",", "pnet_type", "=", "net", ",", "\n", "use_dropout", "=", "True", ",", "spatial", "=", "spatial", ",", "version", "=", "version", ",", "lpips", "=", "True", ")", "\n", "kw", "=", "{", "}", "\n", "if", "not", "use_gpu", ":", "\n", "                ", "kw", "[", "'map_location'", "]", "=", "'cpu'", "\n", "", "if", "(", "model_path", "is", "None", ")", ":", "\n", "                ", "import", "inspect", "\n", "model_path", "=", "os", ".", "path", ".", "abspath", "(", "os", ".", "path", ".", "join", "(", "inspect", ".", "getfile", "(", "self", ".", "initialize", ")", ",", "'..'", ",", "'weights/v%s/%s.pth'", "%", "(", "version", ",", "net", ")", ")", ")", "\n", "\n", "", "if", "(", "not", "is_train", ")", ":", "\n", "                ", "print", "(", "'Loading model from: %s'", "%", "model_path", ")", "\n", "self", ".", "net", ".", "load_state_dict", "(", "torch", ".", "load", "(", "model_path", ",", "**", "kw", ")", ",", "strict", "=", "False", ")", "\n", "\n", "", "", "elif", "(", "self", ".", "model", "==", "'net'", ")", ":", "# pretrained network", "\n", "            ", "self", ".", "net", "=", "networks", ".", "PNetLin", "(", "pnet_rand", "=", "pnet_rand", ",", "pnet_type", "=", "net", ",", "lpips", "=", "False", ")", "\n", "", "elif", "(", "self", ".", "model", "in", "[", "'L2'", ",", "'l2'", "]", ")", ":", "\n", "            ", "self", ".", "net", "=", "networks", ".", "L2", "(", "use_gpu", "=", "use_gpu", ",", "colorspace", "=", "colorspace", ")", "# not really a network, only for testing", "\n", "self", ".", "model_name", "=", "'L2'", "\n", "", "elif", "(", "self", ".", "model", "in", "[", "'DSSIM'", ",", "'dssim'", ",", "'SSIM'", ",", "'ssim'", "]", ")", ":", "\n", "            ", "self", ".", "net", "=", "networks", ".", "DSSIM", "(", "use_gpu", "=", "use_gpu", ",", "colorspace", "=", "colorspace", ")", "\n", "self", ".", "model_name", "=", "'SSIM'", "\n", "", "else", ":", "\n", "            ", "raise", "ValueError", "(", "\"Model [%s] not recognized.\"", "%", "self", ".", "model", ")", "\n", "\n", "", "self", ".", "parameters", "=", "list", "(", "self", ".", "net", ".", "parameters", "(", ")", ")", "\n", "\n", "if", "self", ".", "is_train", ":", "# training mode", "\n", "# extra network on top to go from distances (d0,d1) => predicted human judgment (h*)", "\n", "            ", "self", ".", "rankLoss", "=", "networks", ".", "BCERankingLoss", "(", ")", "\n", "self", ".", "parameters", "+=", "list", "(", "self", ".", "rankLoss", ".", "net", ".", "parameters", "(", ")", ")", "\n", "self", ".", "lr", "=", "lr", "\n", "self", ".", "old_lr", "=", "lr", "\n", "self", ".", "optimizer_net", "=", "torch", ".", "optim", ".", "Adam", "(", "self", ".", "parameters", ",", "lr", "=", "lr", ",", "betas", "=", "(", "beta1", ",", "0.999", ")", ")", "\n", "", "else", ":", "# test mode", "\n", "            ", "self", ".", "net", ".", "eval", "(", ")", "\n", "\n", "", "if", "(", "use_gpu", ")", ":", "\n", "            ", "self", ".", "net", ".", "to", "(", "gpu_ids", "[", "0", "]", ")", "\n", "self", ".", "net", "=", "torch", ".", "nn", ".", "DataParallel", "(", "self", ".", "net", ",", "device_ids", "=", "gpu_ids", ")", "\n", "if", "(", "self", ".", "is_train", ")", ":", "\n", "                ", "self", ".", "rankLoss", "=", "self", ".", "rankLoss", ".", "to", "(", "device", "=", "gpu_ids", "[", "0", "]", ")", "# just put this on GPU0", "\n", "\n", "", "", "if", "(", "printNet", ")", ":", "\n", "            ", "print", "(", "'---------- Networks initialized -------------'", ")", "\n", "networks", ".", "print_network", "(", "self", ".", "net", ")", "\n", "print", "(", "'-----------------------------------------------'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.forward": [[109, 118], ["dist_model.DistModel.net.forward"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward"], ["", "", "def", "forward", "(", "self", ",", "in0", ",", "in1", ",", "retPerLayer", "=", "False", ")", ":", "\n", "        ", "''' Function computes the distance between image patches in0 and in1\n        INPUTS\n            in0, in1 - torch.Tensor object of shape Nx3xXxY - image patch scaled to [-1,1]\n        OUTPUT\n            computed distances between in0 and in1\n        '''", "\n", "\n", "return", "self", ".", "net", ".", "forward", "(", "in0", ",", "in1", ",", "retPerLayer", "=", "retPerLayer", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.optimize_parameters": [[120, 126], ["dist_model.DistModel.forward_train", "dist_model.DistModel.optimizer_net.zero_grad", "dist_model.DistModel.backward_train", "dist_model.DistModel.optimizer_net.step", "dist_model.DistModel.clamp_weights"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.forward_train", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.backward_train", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.clamp_weights"], ["", "def", "optimize_parameters", "(", "self", ")", ":", "\n", "        ", "self", ".", "forward_train", "(", ")", "\n", "self", ".", "optimizer_net", ".", "zero_grad", "(", ")", "\n", "self", ".", "backward_train", "(", ")", "\n", "self", ".", "optimizer_net", ".", "step", "(", ")", "\n", "self", ".", "clamp_weights", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.clamp_weights": [[127, 131], ["dist_model.DistModel.net.modules", "hasattr", "torch.clamp"], "methods", ["None"], ["", "def", "clamp_weights", "(", "self", ")", ":", "\n", "        ", "for", "module", "in", "self", ".", "net", ".", "modules", "(", ")", ":", "\n", "            ", "if", "(", "hasattr", "(", "module", ",", "'weight'", ")", "and", "module", ".", "kernel_size", "==", "(", "1", ",", "1", ")", ")", ":", "\n", "                ", "module", ".", "weight", ".", "data", "=", "torch", ".", "clamp", "(", "module", ".", "weight", ".", "data", ",", "min", "=", "0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.set_input": [[132, 147], ["torch.autograd.Variable", "torch.autograd.Variable", "torch.autograd.Variable", "dist_model.DistModel.input_ref.to", "dist_model.DistModel.input_p0.to", "dist_model.DistModel.input_p1.to", "dist_model.DistModel.input_judge.to"], "methods", ["None"], ["", "", "", "def", "set_input", "(", "self", ",", "data", ")", ":", "\n", "        ", "self", ".", "input_ref", "=", "data", "[", "'ref'", "]", "\n", "self", ".", "input_p0", "=", "data", "[", "'p0'", "]", "\n", "self", ".", "input_p1", "=", "data", "[", "'p1'", "]", "\n", "self", ".", "input_judge", "=", "data", "[", "'judge'", "]", "\n", "\n", "if", "(", "self", ".", "use_gpu", ")", ":", "\n", "            ", "self", ".", "input_ref", "=", "self", ".", "input_ref", ".", "to", "(", "device", "=", "self", ".", "gpu_ids", "[", "0", "]", ")", "\n", "self", ".", "input_p0", "=", "self", ".", "input_p0", ".", "to", "(", "device", "=", "self", ".", "gpu_ids", "[", "0", "]", ")", "\n", "self", ".", "input_p1", "=", "self", ".", "input_p1", ".", "to", "(", "device", "=", "self", ".", "gpu_ids", "[", "0", "]", ")", "\n", "self", ".", "input_judge", "=", "self", ".", "input_judge", ".", "to", "(", "device", "=", "self", ".", "gpu_ids", "[", "0", "]", ")", "\n", "\n", "", "self", ".", "var_ref", "=", "Variable", "(", "self", ".", "input_ref", ",", "requires_grad", "=", "True", ")", "\n", "self", ".", "var_p0", "=", "Variable", "(", "self", ".", "input_p0", ",", "requires_grad", "=", "True", ")", "\n", "self", ".", "var_p1", "=", "Variable", "(", "self", ".", "input_p1", ",", "requires_grad", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.forward_train": [[148, 161], ["dist_model.DistModel.forward", "dist_model.DistModel.forward", "dist_model.DistModel.compute_accuracy", "torch.autograd.Variable().view", "dist_model.DistModel.rankLoss.forward", "dist_model.DistModel.d0.size", "torch.autograd.Variable"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.compute_accuracy", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward"], ["", "def", "forward_train", "(", "self", ")", ":", "# run forward pass", "\n", "# print(self.net.module.scaling_layer.shift)", "\n", "# print(torch.norm(self.net.module.net.slice1[0].weight).item(), torch.norm(self.net.module.lin0.model[1].weight).item())", "\n", "\n", "        ", "self", ".", "d0", "=", "self", ".", "forward", "(", "self", ".", "var_ref", ",", "self", ".", "var_p0", ")", "\n", "self", ".", "d1", "=", "self", ".", "forward", "(", "self", ".", "var_ref", ",", "self", ".", "var_p1", ")", "\n", "self", ".", "acc_r", "=", "self", ".", "compute_accuracy", "(", "self", ".", "d0", ",", "self", ".", "d1", ",", "self", ".", "input_judge", ")", "\n", "\n", "self", ".", "var_judge", "=", "Variable", "(", "1.", "*", "self", ".", "input_judge", ")", ".", "view", "(", "self", ".", "d0", ".", "size", "(", ")", ")", "\n", "\n", "self", ".", "loss_total", "=", "self", ".", "rankLoss", ".", "forward", "(", "self", ".", "d0", ",", "self", ".", "d1", ",", "self", ".", "var_judge", "*", "2.", "-", "1.", ")", "\n", "\n", "return", "self", ".", "loss_total", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.backward_train": [[162, 164], ["torch.mean().backward", "torch.mean"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.backward"], ["", "def", "backward_train", "(", "self", ")", ":", "\n", "        ", "torch", ".", "mean", "(", "self", ".", "loss_total", ")", ".", "backward", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.compute_accuracy": [[165, 170], ["judge.cpu().numpy().flatten", "judge.cpu().numpy", "judge.cpu"], "methods", ["None"], ["", "def", "compute_accuracy", "(", "self", ",", "d0", ",", "d1", ",", "judge", ")", ":", "\n", "        ", "''' d0, d1 are Variables, judge is a Tensor '''", "\n", "d1_lt_d0", "=", "(", "d1", "<", "d0", ")", ".", "cpu", "(", ")", ".", "data", ".", "numpy", "(", ")", ".", "flatten", "(", ")", "\n", "judge_per", "=", "judge", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "flatten", "(", ")", "\n", "return", "d1_lt_d0", "*", "judge_per", "+", "(", "1", "-", "d1_lt_d0", ")", "*", "(", "1", "-", "judge_per", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.get_current_errors": [[171, 179], ["collections.OrderedDict", "collections.OrderedDict.keys", "numpy.mean", "dist_model.DistModel.loss_total.data.cpu().numpy", "dist_model.DistModel.loss_total.data.cpu"], "methods", ["None"], ["", "def", "get_current_errors", "(", "self", ")", ":", "\n", "        ", "retDict", "=", "OrderedDict", "(", "[", "(", "'loss_total'", ",", "self", ".", "loss_total", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ")", ",", "\n", "(", "'acc_r'", ",", "self", ".", "acc_r", ")", "]", ")", "\n", "\n", "for", "key", "in", "retDict", ".", "keys", "(", ")", ":", "\n", "            ", "retDict", "[", "key", "]", "=", "np", ".", "mean", "(", "retDict", "[", "key", "]", ")", "\n", "\n", "", "return", "retDict", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.get_current_visuals": [[180, 194], ["lpips.tensor2im", "lpips.tensor2im", "lpips.tensor2im", "scipy.ndimage.zoom", "scipy.ndimage.zoom", "scipy.ndimage.zoom", "collections.OrderedDict", "dist_model.DistModel.var_ref.data.size"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2im", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2im", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2im"], ["", "def", "get_current_visuals", "(", "self", ")", ":", "\n", "        ", "zoom_factor", "=", "256", "/", "self", ".", "var_ref", ".", "data", ".", "size", "(", ")", "[", "2", "]", "\n", "\n", "ref_img", "=", "util", ".", "tensor2im", "(", "self", ".", "var_ref", ".", "data", ")", "\n", "p0_img", "=", "util", ".", "tensor2im", "(", "self", ".", "var_p0", ".", "data", ")", "\n", "p1_img", "=", "util", ".", "tensor2im", "(", "self", ".", "var_p1", ".", "data", ")", "\n", "\n", "ref_img_vis", "=", "zoom", "(", "ref_img", ",", "[", "zoom_factor", ",", "zoom_factor", ",", "1", "]", ",", "order", "=", "0", ")", "\n", "p0_img_vis", "=", "zoom", "(", "p0_img", ",", "[", "zoom_factor", ",", "zoom_factor", ",", "1", "]", ",", "order", "=", "0", ")", "\n", "p1_img_vis", "=", "zoom", "(", "p1_img", ",", "[", "zoom_factor", ",", "zoom_factor", ",", "1", "]", ",", "order", "=", "0", ")", "\n", "\n", "return", "OrderedDict", "(", "[", "(", "'ref'", ",", "ref_img_vis", ")", ",", "\n", "(", "'p0'", ",", "p0_img_vis", ")", ",", "\n", "(", "'p1'", ",", "p1_img_vis", ")", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.save": [[195, 201], ["dist_model.DistModel.save_network", "dist_model.DistModel.save_network", "dist_model.DistModel.save_network"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save_network", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save_network", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save_network"], ["", "def", "save", "(", "self", ",", "path", ",", "label", ")", ":", "\n", "        ", "if", "(", "self", ".", "use_gpu", ")", ":", "\n", "            ", "self", ".", "save_network", "(", "self", ".", "net", ".", "module", ",", "path", ",", "''", ",", "label", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "save_network", "(", "self", ".", "net", ",", "path", ",", "''", ",", "label", ")", "\n", "", "self", ".", "save_network", "(", "self", ".", "rankLoss", ".", "net", ",", "path", ",", "'rank'", ",", "label", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.DistModel.update_learning_rate": [[202, 211], ["print"], "methods", ["None"], ["", "def", "update_learning_rate", "(", "self", ",", "nepoch_decay", ")", ":", "\n", "        ", "lrd", "=", "self", ".", "lr", "/", "nepoch_decay", "\n", "lr", "=", "self", ".", "old_lr", "-", "lrd", "\n", "\n", "for", "param_group", "in", "self", ".", "optimizer_net", ".", "param_groups", ":", "\n", "            ", "param_group", "[", "'lr'", "]", "=", "lr", "\n", "\n", "", "print", "(", "'update lr [%s] decay: %f -> %f'", "%", "(", "type", ",", "self", ".", "old_lr", ",", "lr", ")", ")", "\n", "self", ".", "old_lr", "=", "lr", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.score_2afc_dataset": [[212, 246], ["tqdm.tqdm", "numpy.array", "numpy.array", "numpy.array", "data_loader.load_data", "func().data.cpu().numpy().flatten().tolist", "func().data.cpu().numpy().flatten().tolist", "data[].cpu().numpy().flatten().tolist", "numpy.mean", "dict", "func().data.cpu().numpy().flatten", "func().data.cpu().numpy().flatten", "data[].cpu().numpy().flatten", "func().data.cpu().numpy", "func().data.cpu().numpy", "data[].cpu().numpy", "func().data.cpu", "func().data.cpu", "data[].cpu", "func", "func"], "function", ["None"], ["", "", "def", "score_2afc_dataset", "(", "data_loader", ",", "func", ",", "name", "=", "''", ")", ":", "\n", "    ", "''' Function computes Two Alternative Forced Choice (2AFC) score using\n        distance function 'func' in dataset 'data_loader'\n    INPUTS\n        data_loader - CustomDatasetDataLoader object - contains a TwoAFCDataset inside\n        func - callable distance function - calling d=func(in0,in1) should take 2\n            pytorch tensors with shape Nx3xXxY, and return numpy array of length N\n    OUTPUTS\n        [0] - 2AFC score in [0,1], fraction of time func agrees with human evaluators\n        [1] - dictionary with following elements\n            d0s,d1s - N arrays containing distances between reference patch to perturbed patches \n            gts - N array in [0,1], preferred patch selected by human evaluators\n                (closer to \"0\" for left patch p0, \"1\" for right patch p1,\n                \"0.6\" means 60pct people preferred right patch, 40pct preferred left)\n            scores - N array in [0,1], corresponding to what percentage function agreed with humans\n    CONSTS\n        N - number of test triplets in data_loader\n    '''", "\n", "\n", "d0s", "=", "[", "]", "\n", "d1s", "=", "[", "]", "\n", "gts", "=", "[", "]", "\n", "\n", "for", "data", "in", "tqdm", "(", "data_loader", ".", "load_data", "(", ")", ",", "desc", "=", "name", ")", ":", "\n", "        ", "d0s", "+=", "func", "(", "data", "[", "'ref'", "]", ",", "data", "[", "'p0'", "]", ")", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "flatten", "(", ")", ".", "tolist", "(", ")", "\n", "d1s", "+=", "func", "(", "data", "[", "'ref'", "]", ",", "data", "[", "'p1'", "]", ")", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "flatten", "(", ")", ".", "tolist", "(", ")", "\n", "gts", "+=", "data", "[", "'judge'", "]", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "flatten", "(", ")", ".", "tolist", "(", ")", "\n", "\n", "", "d0s", "=", "np", ".", "array", "(", "d0s", ")", "\n", "d1s", "=", "np", ".", "array", "(", "d1s", ")", "\n", "gts", "=", "np", ".", "array", "(", "gts", ")", "\n", "scores", "=", "(", "d0s", "<", "d1s", ")", "*", "(", "1.", "-", "gts", ")", "+", "(", "d1s", "<", "d0s", ")", "*", "gts", "+", "(", "d1s", "==", "d0s", ")", "*", ".5", "\n", "\n", "return", "(", "np", ".", "mean", "(", "scores", ")", ",", "dict", "(", "d0s", "=", "d0s", ",", "d1s", "=", "d1s", ",", "gts", "=", "gts", ",", "scores", "=", "scores", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.dist_model.score_jnd_dataset": [[247, 285], ["tqdm.tqdm", "numpy.array", "numpy.array", "numpy.argsort", "numpy.cumsum", "numpy.cumsum", "lpips.voc_ap", "data_loader.load_data", "func().data.cpu().numpy().tolist", "data[].cpu().numpy().flatten().tolist", "numpy.sum", "dict", "func().data.cpu().numpy", "data[].cpu().numpy().flatten", "func().data.cpu", "data[].cpu().numpy", "data[].cpu", "func"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.voc_ap"], ["", "def", "score_jnd_dataset", "(", "data_loader", ",", "func", ",", "name", "=", "''", ")", ":", "\n", "    ", "''' Function computes JND score using distance function 'func' in dataset 'data_loader'\n    INPUTS\n        data_loader - CustomDatasetDataLoader object - contains a JNDDataset inside\n        func - callable distance function - calling d=func(in0,in1) should take 2\n            pytorch tensors with shape Nx3xXxY, and return pytorch array of length N\n    OUTPUTS\n        [0] - JND score in [0,1], mAP score (area under precision-recall curve)\n        [1] - dictionary with following elements\n            ds - N array containing distances between two patches shown to human evaluator\n            sames - N array containing fraction of people who thought the two patches were identical\n    CONSTS\n        N - number of test triplets in data_loader\n    '''", "\n", "\n", "ds", "=", "[", "]", "\n", "gts", "=", "[", "]", "\n", "\n", "for", "data", "in", "tqdm", "(", "data_loader", ".", "load_data", "(", ")", ",", "desc", "=", "name", ")", ":", "\n", "        ", "ds", "+=", "func", "(", "data", "[", "'p0'", "]", ",", "data", "[", "'p1'", "]", ")", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "tolist", "(", ")", "\n", "gts", "+=", "data", "[", "'same'", "]", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ".", "flatten", "(", ")", ".", "tolist", "(", ")", "\n", "\n", "", "sames", "=", "np", ".", "array", "(", "gts", ")", "\n", "ds", "=", "np", ".", "array", "(", "ds", ")", "\n", "\n", "sorted_inds", "=", "np", ".", "argsort", "(", "ds", ")", "\n", "ds_sorted", "=", "ds", "[", "sorted_inds", "]", "\n", "sames_sorted", "=", "sames", "[", "sorted_inds", "]", "\n", "\n", "TPs", "=", "np", ".", "cumsum", "(", "sames_sorted", ")", "\n", "FPs", "=", "np", ".", "cumsum", "(", "1", "-", "sames_sorted", ")", "\n", "FNs", "=", "np", ".", "sum", "(", "sames_sorted", ")", "-", "TPs", "\n", "\n", "precs", "=", "TPs", "/", "(", "TPs", "+", "FPs", ")", "\n", "recs", "=", "TPs", "/", "(", "TPs", "+", "FNs", ")", "\n", "score", "=", "util", ".", "voc_ap", "(", "recs", ",", "precs", ")", "\n", "\n", "return", "(", "score", ",", "dict", "(", "ds", "=", "ds", ",", "sames", "=", "sames", ")", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.squeezenet.__init__": [[7, 35], ["super().__init__", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "range", "range", "range", "range", "range", "range", "range", "torchvision.models.squeezenet1_1", "pretrained_networks.squeezenet.slice1.add_module", "pretrained_networks.squeezenet.slice2.add_module", "pretrained_networks.squeezenet.slice3.add_module", "pretrained_networks.squeezenet.slice4.add_module", "pretrained_networks.squeezenet.slice5.add_module", "pretrained_networks.squeezenet.slice6.add_module", "pretrained_networks.squeezenet.slice7.add_module", "pretrained_networks.squeezenet.parameters", "str", "str", "str", "str", "str", "str", "str"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "requires_grad", "=", "False", ",", "pretrained", "=", "True", ")", ":", "\n", "        ", "super", "(", "squeezenet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "pretrained_features", "=", "tv", ".", "squeezenet1_1", "(", "pretrained", "=", "pretrained", ")", ".", "features", "\n", "self", ".", "slice1", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice2", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice3", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice4", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice5", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice6", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice7", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "N_slices", "=", "7", "\n", "for", "x", "in", "range", "(", "2", ")", ":", "\n", "            ", "self", ".", "slice1", ".", "add_module", "(", "str", "(", "x", ")", ",", "pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "2", ",", "5", ")", ":", "\n", "            ", "self", ".", "slice2", ".", "add_module", "(", "str", "(", "x", ")", ",", "pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "5", ",", "8", ")", ":", "\n", "            ", "self", ".", "slice3", ".", "add_module", "(", "str", "(", "x", ")", ",", "pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "8", ",", "10", ")", ":", "\n", "            ", "self", ".", "slice4", ".", "add_module", "(", "str", "(", "x", ")", ",", "pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "10", ",", "11", ")", ":", "\n", "            ", "self", ".", "slice5", ".", "add_module", "(", "str", "(", "x", ")", ",", "pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "11", ",", "12", ")", ":", "\n", "            ", "self", ".", "slice6", ".", "add_module", "(", "str", "(", "x", ")", ",", "pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "12", ",", "13", ")", ":", "\n", "            ", "self", ".", "slice7", ".", "add_module", "(", "str", "(", "x", ")", ",", "pretrained_features", "[", "x", "]", ")", "\n", "", "if", "not", "requires_grad", ":", "\n", "            ", "for", "param", "in", "self", ".", "parameters", "(", ")", ":", "\n", "                ", "param", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.squeezenet.forward": [[36, 55], ["pretrained_networks.squeezenet.slice1", "pretrained_networks.squeezenet.slice2", "pretrained_networks.squeezenet.slice3", "pretrained_networks.squeezenet.slice4", "pretrained_networks.squeezenet.slice5", "pretrained_networks.squeezenet.slice6", "pretrained_networks.squeezenet.slice7", "collections.namedtuple", "collections.namedtuple."], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "X", ")", ":", "\n", "        ", "h", "=", "self", ".", "slice1", "(", "X", ")", "\n", "h_relu1", "=", "h", "\n", "h", "=", "self", ".", "slice2", "(", "h", ")", "\n", "h_relu2", "=", "h", "\n", "h", "=", "self", ".", "slice3", "(", "h", ")", "\n", "h_relu3", "=", "h", "\n", "h", "=", "self", ".", "slice4", "(", "h", ")", "\n", "h_relu4", "=", "h", "\n", "h", "=", "self", ".", "slice5", "(", "h", ")", "\n", "h_relu5", "=", "h", "\n", "h", "=", "self", ".", "slice6", "(", "h", ")", "\n", "h_relu6", "=", "h", "\n", "h", "=", "self", ".", "slice7", "(", "h", ")", "\n", "h_relu7", "=", "h", "\n", "vgg_outputs", "=", "namedtuple", "(", "\"SqueezeOutputs\"", ",", "[", "'relu1'", ",", "'relu2'", ",", "'relu3'", ",", "'relu4'", ",", "'relu5'", ",", "'relu6'", ",", "'relu7'", "]", ")", "\n", "out", "=", "vgg_outputs", "(", "h_relu1", ",", "h_relu2", ",", "h_relu3", ",", "h_relu4", ",", "h_relu5", ",", "h_relu6", ",", "h_relu7", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.alexnet.__init__": [[58, 80], ["super().__init__", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "range", "range", "range", "range", "range", "torchvision.models.alexnet", "pretrained_networks.alexnet.slice1.add_module", "pretrained_networks.alexnet.slice2.add_module", "pretrained_networks.alexnet.slice3.add_module", "pretrained_networks.alexnet.slice4.add_module", "pretrained_networks.alexnet.slice5.add_module", "pretrained_networks.alexnet.parameters", "str", "str", "str", "str", "str"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "requires_grad", "=", "False", ",", "pretrained", "=", "True", ")", ":", "\n", "        ", "super", "(", "alexnet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "alexnet_pretrained_features", "=", "tv", ".", "alexnet", "(", "pretrained", "=", "pretrained", ")", ".", "features", "\n", "self", ".", "slice1", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice2", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice3", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice4", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice5", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "N_slices", "=", "5", "\n", "for", "x", "in", "range", "(", "2", ")", ":", "\n", "            ", "self", ".", "slice1", ".", "add_module", "(", "str", "(", "x", ")", ",", "alexnet_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "2", ",", "5", ")", ":", "\n", "            ", "self", ".", "slice2", ".", "add_module", "(", "str", "(", "x", ")", ",", "alexnet_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "5", ",", "8", ")", ":", "\n", "            ", "self", ".", "slice3", ".", "add_module", "(", "str", "(", "x", ")", ",", "alexnet_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "8", ",", "10", ")", ":", "\n", "            ", "self", ".", "slice4", ".", "add_module", "(", "str", "(", "x", ")", ",", "alexnet_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "10", ",", "12", ")", ":", "\n", "            ", "self", ".", "slice5", ".", "add_module", "(", "str", "(", "x", ")", ",", "alexnet_pretrained_features", "[", "x", "]", ")", "\n", "", "if", "not", "requires_grad", ":", "\n", "            ", "for", "param", "in", "self", ".", "parameters", "(", ")", ":", "\n", "                ", "param", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.alexnet.forward": [[81, 96], ["pretrained_networks.alexnet.slice1", "pretrained_networks.alexnet.slice2", "pretrained_networks.alexnet.slice3", "pretrained_networks.alexnet.slice4", "pretrained_networks.alexnet.slice5", "collections.namedtuple", "collections.namedtuple."], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "X", ")", ":", "\n", "        ", "h", "=", "self", ".", "slice1", "(", "X", ")", "\n", "h_relu1", "=", "h", "\n", "h", "=", "self", ".", "slice2", "(", "h", ")", "\n", "h_relu2", "=", "h", "\n", "h", "=", "self", ".", "slice3", "(", "h", ")", "\n", "h_relu3", "=", "h", "\n", "h", "=", "self", ".", "slice4", "(", "h", ")", "\n", "h_relu4", "=", "h", "\n", "h", "=", "self", ".", "slice5", "(", "h", ")", "\n", "h_relu5", "=", "h", "\n", "alexnet_outputs", "=", "namedtuple", "(", "\"AlexnetOutputs\"", ",", "[", "'relu1'", ",", "'relu2'", ",", "'relu3'", ",", "'relu4'", ",", "'relu5'", "]", ")", "\n", "out", "=", "alexnet_outputs", "(", "h_relu1", ",", "h_relu2", ",", "h_relu3", ",", "h_relu4", ",", "h_relu5", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.vgg16.__init__": [[98, 120], ["super().__init__", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "torch.nn.Sequential", "range", "range", "range", "range", "range", "torchvision.models.vgg16", "pretrained_networks.vgg16.slice1.add_module", "pretrained_networks.vgg16.slice2.add_module", "pretrained_networks.vgg16.slice3.add_module", "pretrained_networks.vgg16.slice4.add_module", "pretrained_networks.vgg16.slice5.add_module", "pretrained_networks.vgg16.parameters", "str", "str", "str", "str", "str"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "requires_grad", "=", "False", ",", "pretrained", "=", "True", ")", ":", "\n", "        ", "super", "(", "vgg16", ",", "self", ")", ".", "__init__", "(", ")", "\n", "vgg_pretrained_features", "=", "tv", ".", "vgg16", "(", "pretrained", "=", "pretrained", ")", ".", "features", "\n", "self", ".", "slice1", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice2", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice3", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice4", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "slice5", "=", "torch", ".", "nn", ".", "Sequential", "(", ")", "\n", "self", ".", "N_slices", "=", "5", "\n", "for", "x", "in", "range", "(", "4", ")", ":", "\n", "            ", "self", ".", "slice1", ".", "add_module", "(", "str", "(", "x", ")", ",", "vgg_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "4", ",", "9", ")", ":", "\n", "            ", "self", ".", "slice2", ".", "add_module", "(", "str", "(", "x", ")", ",", "vgg_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "9", ",", "16", ")", ":", "\n", "            ", "self", ".", "slice3", ".", "add_module", "(", "str", "(", "x", ")", ",", "vgg_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "16", ",", "23", ")", ":", "\n", "            ", "self", ".", "slice4", ".", "add_module", "(", "str", "(", "x", ")", ",", "vgg_pretrained_features", "[", "x", "]", ")", "\n", "", "for", "x", "in", "range", "(", "23", ",", "30", ")", ":", "\n", "            ", "self", ".", "slice5", ".", "add_module", "(", "str", "(", "x", ")", ",", "vgg_pretrained_features", "[", "x", "]", ")", "\n", "", "if", "not", "requires_grad", ":", "\n", "            ", "for", "param", "in", "self", ".", "parameters", "(", ")", ":", "\n", "                ", "param", ".", "requires_grad", "=", "False", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.vgg16.forward": [[121, 136], ["pretrained_networks.vgg16.slice1", "pretrained_networks.vgg16.slice2", "pretrained_networks.vgg16.slice3", "pretrained_networks.vgg16.slice4", "pretrained_networks.vgg16.slice5", "collections.namedtuple", "collections.namedtuple."], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "X", ")", ":", "\n", "        ", "h", "=", "self", ".", "slice1", "(", "X", ")", "\n", "h_relu1_2", "=", "h", "\n", "h", "=", "self", ".", "slice2", "(", "h", ")", "\n", "h_relu2_2", "=", "h", "\n", "h", "=", "self", ".", "slice3", "(", "h", ")", "\n", "h_relu3_3", "=", "h", "\n", "h", "=", "self", ".", "slice4", "(", "h", ")", "\n", "h_relu4_3", "=", "h", "\n", "h", "=", "self", ".", "slice5", "(", "h", ")", "\n", "h_relu5_3", "=", "h", "\n", "vgg_outputs", "=", "namedtuple", "(", "\"VggOutputs\"", ",", "[", "'relu1_2'", ",", "'relu2_2'", ",", "'relu3_3'", ",", "'relu4_3'", ",", "'relu5_3'", "]", ")", "\n", "out", "=", "vgg_outputs", "(", "h_relu1_2", ",", "h_relu2_2", ",", "h_relu3_3", ",", "h_relu4_3", ",", "h_relu5_3", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.resnet.__init__": [[140, 162], ["super().__init__", "torchvision.models.resnet18", "torchvision.models.resnet34", "torchvision.models.resnet50", "torchvision.models.resnet101", "torchvision.models.resnet152"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "requires_grad", "=", "False", ",", "pretrained", "=", "True", ",", "num", "=", "18", ")", ":", "\n", "        ", "super", "(", "resnet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "if", "(", "num", "==", "18", ")", ":", "\n", "            ", "self", ".", "net", "=", "tv", ".", "resnet18", "(", "pretrained", "=", "pretrained", ")", "\n", "", "elif", "(", "num", "==", "34", ")", ":", "\n", "            ", "self", ".", "net", "=", "tv", ".", "resnet34", "(", "pretrained", "=", "pretrained", ")", "\n", "", "elif", "(", "num", "==", "50", ")", ":", "\n", "            ", "self", ".", "net", "=", "tv", ".", "resnet50", "(", "pretrained", "=", "pretrained", ")", "\n", "", "elif", "(", "num", "==", "101", ")", ":", "\n", "            ", "self", ".", "net", "=", "tv", ".", "resnet101", "(", "pretrained", "=", "pretrained", ")", "\n", "", "elif", "(", "num", "==", "152", ")", ":", "\n", "            ", "self", ".", "net", "=", "tv", ".", "resnet152", "(", "pretrained", "=", "pretrained", ")", "\n", "", "self", ".", "N_slices", "=", "5", "\n", "\n", "self", ".", "conv1", "=", "self", ".", "net", ".", "conv1", "\n", "self", ".", "bn1", "=", "self", ".", "net", ".", "bn1", "\n", "self", ".", "relu", "=", "self", ".", "net", ".", "relu", "\n", "self", ".", "maxpool", "=", "self", ".", "net", ".", "maxpool", "\n", "self", ".", "layer1", "=", "self", ".", "net", ".", "layer1", "\n", "self", ".", "layer2", "=", "self", ".", "net", ".", "layer2", "\n", "self", ".", "layer3", "=", "self", ".", "net", ".", "layer3", "\n", "self", ".", "layer4", "=", "self", ".", "net", ".", "layer4", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.pretrained_networks.resnet.forward": [[163, 182], ["pretrained_networks.resnet.conv1", "pretrained_networks.resnet.bn1", "pretrained_networks.resnet.relu", "pretrained_networks.resnet.maxpool", "pretrained_networks.resnet.layer1", "pretrained_networks.resnet.layer2", "pretrained_networks.resnet.layer3", "pretrained_networks.resnet.layer4", "collections.namedtuple", "collections.namedtuple."], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "X", ")", ":", "\n", "        ", "h", "=", "self", ".", "conv1", "(", "X", ")", "\n", "h", "=", "self", ".", "bn1", "(", "h", ")", "\n", "h", "=", "self", ".", "relu", "(", "h", ")", "\n", "h_relu1", "=", "h", "\n", "h", "=", "self", ".", "maxpool", "(", "h", ")", "\n", "h", "=", "self", ".", "layer1", "(", "h", ")", "\n", "h_conv2", "=", "h", "\n", "h", "=", "self", ".", "layer2", "(", "h", ")", "\n", "h_conv3", "=", "h", "\n", "h", "=", "self", ".", "layer3", "(", "h", ")", "\n", "h_conv4", "=", "h", "\n", "h", "=", "self", ".", "layer4", "(", "h", ")", "\n", "h_conv5", "=", "h", "\n", "\n", "outputs", "=", "namedtuple", "(", "\"Outputs\"", ",", "[", "'relu1'", ",", "'conv2'", ",", "'conv3'", ",", "'conv4'", ",", "'conv5'", "]", ")", "\n", "out", "=", "outputs", "(", "h_relu1", ",", "h_conv2", ",", "h_conv3", ",", "h_conv4", ",", "h_conv5", ")", "\n", "\n", "return", "out", "\n", "", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.PerceptualLoss.__init__": [[14, 25], ["super().__init__", "print", "lpips.dist_model.DistModel", "__init__.PerceptualLoss.model.initialize", "print", "print", "__init__.PerceptualLoss.model.name"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.initialize", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.name"], ["    ", "def", "__init__", "(", "self", ",", "model", "=", "'net-lin'", ",", "net", "=", "'alex'", ",", "colorspace", "=", "'rgb'", ",", "spatial", "=", "False", ",", "use_gpu", "=", "True", ",", "gpu_ids", "=", "[", "0", "]", ")", ":", "# VGG using our perceptually-learned weights (LPIPS metric)", "\n", "# def __init__(self, model='net', net='vgg', use_gpu=True): # \"default\" way of using VGG as a perceptual loss", "\n", "        ", "super", "(", "PerceptualLoss", ",", "self", ")", ".", "__init__", "(", ")", "\n", "print", "(", "'Setting up Perceptual loss...'", ")", "\n", "self", ".", "use_gpu", "=", "use_gpu", "\n", "self", ".", "spatial", "=", "spatial", "\n", "self", ".", "gpu_ids", "=", "gpu_ids", "\n", "self", ".", "model", "=", "dist_model", ".", "DistModel", "(", ")", "\n", "self", ".", "model", ".", "initialize", "(", "model", "=", "model", ",", "net", "=", "net", ",", "use_gpu", "=", "use_gpu", ",", "colorspace", "=", "colorspace", ",", "spatial", "=", "self", ".", "spatial", ",", "gpu_ids", "=", "gpu_ids", ")", "\n", "print", "(", "'...[%s] initialized'", "%", "self", ".", "model", ".", "name", "(", ")", ")", "\n", "print", "(", "'...Done'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.PerceptualLoss.forward": [[26, 41], ["__init__.PerceptualLoss.model.forward"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward"], ["", "def", "forward", "(", "self", ",", "pred", ",", "target", ",", "normalize", "=", "False", ")", ":", "\n", "        ", "\"\"\"\n        Pred and target are Variables.\n        If normalize is True, assumes the images are between [0,1] and then scales them between [-1,+1]\n        If normalize is False, assumes the images are already between [-1,+1]\n\n        Inputs pred and target are Nx3xHxW\n        Output pytorch Variable N long\n        \"\"\"", "\n", "\n", "if", "normalize", ":", "\n", "            ", "target", "=", "2", "*", "target", "-", "1", "\n", "pred", "=", "2", "*", "pred", "-", "1", "\n", "\n", "", "return", "self", ".", "model", ".", "forward", "(", "target", ",", "pred", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.normalize_tensor": [[42, 45], ["torch.sqrt", "torch.sum"], "function", ["None"], ["", "", "def", "normalize_tensor", "(", "in_feat", ",", "eps", "=", "1e-10", ")", ":", "\n", "    ", "norm_factor", "=", "torch", ".", "sqrt", "(", "torch", ".", "sum", "(", "in_feat", "**", "2", ",", "dim", "=", "1", ",", "keepdim", "=", "True", ")", ")", "\n", "return", "in_feat", "/", "(", "norm_factor", "+", "eps", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.l2": [[46, 48], ["numpy.mean"], "function", ["None"], ["", "def", "l2", "(", "p0", ",", "p1", ",", "range", "=", "255.", ")", ":", "\n", "    ", "return", ".5", "*", "np", ".", "mean", "(", "(", "p0", "/", "range", "-", "p1", "/", "range", ")", "**", "2", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.psnr": [[49, 51], ["numpy.log10", "numpy.mean"], "function", ["None"], ["", "def", "psnr", "(", "p0", ",", "p1", ",", "peak", "=", "255.", ")", ":", "\n", "    ", "return", "10", "*", "np", ".", "log10", "(", "peak", "**", "2", "/", "np", ".", "mean", "(", "(", "1.", "*", "p0", "-", "1.", "*", "p1", ")", "**", "2", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.dssim": [[52, 54], ["skimage.measure.compare_ssim"], "function", ["None"], ["", "def", "dssim", "(", "p0", ",", "p1", ",", "range", "=", "255.", ")", ":", "\n", "    ", "return", "(", "1", "-", "compare_ssim", "(", "p0", ",", "p1", ",", "data_range", "=", "range", ",", "multichannel", "=", "True", ")", ")", "/", "2.", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.rgb2lab": [[102, 105], ["color.rgb2lab"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.rgb2lab"], ["", "", "def", "rgb2lab", "(", "input", ")", ":", "\n", "    ", "from", "skimage", "import", "color", "\n", "return", "color", ".", "rgb2lab", "(", "input", "/", "255.", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2np": [[62, 65], ["tensor_obj[].cpu().float().numpy().transpose", "tensor_obj[].cpu().float().numpy", "tensor_obj[].cpu().float", "tensor_obj[].cpu"], "function", ["None"], ["", "def", "tensor2np", "(", "tensor_obj", ")", ":", "\n", "# change dimension of a tensor object into a numpy array", "\n", "    ", "return", "tensor_obj", "[", "0", "]", ".", "cpu", "(", ")", ".", "float", "(", ")", ".", "numpy", "(", ")", ".", "transpose", "(", "(", "1", ",", "2", ",", "0", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.np2tensor": [[66, 69], ["torch.Tensor", "np_obj[].transpose"], "function", ["None"], ["", "def", "np2tensor", "(", "np_obj", ")", ":", "\n", "# change dimenion of np array into tensor array", "\n", "    ", "return", "torch", ".", "Tensor", "(", "np_obj", "[", ":", ",", ":", ",", ":", ",", "np", ".", "newaxis", "]", ".", "transpose", "(", "(", "3", ",", "2", ",", "0", ",", "1", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2tensorlab": [[70, 83], ["__init__.tensor2im", "color.rgb2lab", "__init__.np2tensor"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2im", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.rgb2lab", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.np2tensor"], ["", "def", "tensor2tensorlab", "(", "image_tensor", ",", "to_norm", "=", "True", ",", "mc_only", "=", "False", ")", ":", "\n", "# image tensor to lab tensor", "\n", "    ", "from", "skimage", "import", "color", "\n", "\n", "img", "=", "tensor2im", "(", "image_tensor", ")", "\n", "img_lab", "=", "color", ".", "rgb2lab", "(", "img", ")", "\n", "if", "(", "mc_only", ")", ":", "\n", "        ", "img_lab", "[", ":", ",", ":", ",", "0", "]", "=", "img_lab", "[", ":", ",", ":", ",", "0", "]", "-", "50", "\n", "", "if", "(", "to_norm", "and", "not", "mc_only", ")", ":", "\n", "        ", "img_lab", "[", ":", ",", ":", ",", "0", "]", "=", "img_lab", "[", ":", ",", ":", ",", "0", "]", "-", "50", "\n", "img_lab", "=", "img_lab", "/", "100.", "\n", "\n", "", "return", "np2tensor", "(", "img_lab", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensorlab2tensor": [[84, 101], ["warnings.filterwarnings", "__init__.tensor2np", "numpy.clip", "color.rgb2lab", "__init__.np2tensor", "__init__.im2tensor", "color.lab2rgb", "rgb_back.astype", "numpy.isclose", "__init__.im2tensor", "lab.astype", "numpy.prod"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2np", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.rgb2lab", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.np2tensor", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.im2tensor", "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.im2tensor"], ["", "def", "tensorlab2tensor", "(", "lab_tensor", ",", "return_inbnd", "=", "False", ")", ":", "\n", "    ", "from", "skimage", "import", "color", "\n", "import", "warnings", "\n", "warnings", ".", "filterwarnings", "(", "\"ignore\"", ")", "\n", "\n", "lab", "=", "tensor2np", "(", "lab_tensor", ")", "*", "100.", "\n", "lab", "[", ":", ",", ":", ",", "0", "]", "=", "lab", "[", ":", ",", ":", ",", "0", "]", "+", "50", "\n", "\n", "rgb_back", "=", "255.", "*", "np", ".", "clip", "(", "color", ".", "lab2rgb", "(", "lab", ".", "astype", "(", "'float'", ")", ")", ",", "0", ",", "1", ")", "\n", "if", "(", "return_inbnd", ")", ":", "\n", "# convert back to lab, see if we match", "\n", "        ", "lab_back", "=", "color", ".", "rgb2lab", "(", "rgb_back", ".", "astype", "(", "'uint8'", ")", ")", "\n", "mask", "=", "1.", "*", "np", ".", "isclose", "(", "lab_back", ",", "lab", ",", "atol", "=", "2.", ")", "\n", "mask", "=", "np2tensor", "(", "np", ".", "prod", "(", "mask", ",", "axis", "=", "2", ")", "[", ":", ",", ":", ",", "np", ".", "newaxis", "]", ")", "\n", "return", "(", "im2tensor", "(", "rgb_back", ")", ",", "mask", ")", "\n", "", "else", ":", "\n", "        ", "return", "im2tensor", "(", "rgb_back", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2im": [[151, 156], ["image_tensor[].cpu().float().numpy", "image_tensor[].cpu().float().numpy.astype", "image_tensor[].cpu().float", "numpy.transpose", "image_tensor[].cpu"], "function", ["None"], ["", "def", "tensor2im", "(", "image_tensor", ",", "imtype", "=", "np", ".", "uint8", ",", "cent", "=", "1.", ",", "factor", "=", "255.", "/", "2.", ")", ":", "\n", "# def tensor2im(image_tensor, imtype=np.uint8, cent=1., factor=1.):", "\n", "    ", "image_numpy", "=", "image_tensor", "[", "0", "]", ".", "cpu", "(", ")", ".", "float", "(", ")", ".", "numpy", "(", ")", "\n", "image_numpy", "=", "(", "np", ".", "transpose", "(", "image_numpy", ",", "(", "1", ",", "2", ",", "0", ")", ")", "+", "cent", ")", "*", "factor", "\n", "return", "image_numpy", ".", "astype", "(", "imtype", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.im2tensor": [[157, 161], ["torch.Tensor", "[].transpose"], "function", ["None"], ["", "def", "im2tensor", "(", "image", ",", "imtype", "=", "np", ".", "uint8", ",", "cent", "=", "1.", ",", "factor", "=", "255.", "/", "2.", ")", ":", "\n", "# def im2tensor(image, imtype=np.uint8, cent=1., factor=1.):", "\n", "    ", "return", "torch", ".", "Tensor", "(", "(", "image", "/", "factor", "-", "cent", ")", "\n", "[", ":", ",", ":", ",", ":", ",", "np", ".", "newaxis", "]", ".", "transpose", "(", "(", "3", ",", "2", ",", "0", ",", "1", ")", ")", ")", "\n", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.tensor2vec": [[115, 117], ["vector_tensor.data.cpu().numpy", "vector_tensor.data.cpu"], "function", ["None"], ["", "def", "tensor2vec", "(", "vector_tensor", ")", ":", "\n", "    ", "return", "vector_tensor", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", "[", ":", ",", ":", ",", "0", ",", "0", "]", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.__init__.voc_ap": [[118, 150], ["numpy.arange", "numpy.concatenate", "numpy.concatenate", "range", "numpy.sum", "numpy.maximum", "numpy.where", "numpy.sum", "numpy.max"], "function", ["None"], ["", "def", "voc_ap", "(", "rec", ",", "prec", ",", "use_07_metric", "=", "False", ")", ":", "\n", "    ", "\"\"\" ap = voc_ap(rec, prec, [use_07_metric])\n    Compute VOC AP given precision and recall.\n    If use_07_metric is true, uses the\n    VOC 07 11 point method (default:False).\n    \"\"\"", "\n", "if", "use_07_metric", ":", "\n", "# 11 point metric", "\n", "        ", "ap", "=", "0.", "\n", "for", "t", "in", "np", ".", "arange", "(", "0.", ",", "1.1", ",", "0.1", ")", ":", "\n", "            ", "if", "np", ".", "sum", "(", "rec", ">=", "t", ")", "==", "0", ":", "\n", "                ", "p", "=", "0", "\n", "", "else", ":", "\n", "                ", "p", "=", "np", ".", "max", "(", "prec", "[", "rec", ">=", "t", "]", ")", "\n", "", "ap", "=", "ap", "+", "p", "/", "11.", "\n", "", "", "else", ":", "\n", "# correct AP calculation", "\n", "# first append sentinel values at the end", "\n", "        ", "mrec", "=", "np", ".", "concatenate", "(", "(", "[", "0.", "]", ",", "rec", ",", "[", "1.", "]", ")", ")", "\n", "mpre", "=", "np", ".", "concatenate", "(", "(", "[", "0.", "]", ",", "prec", ",", "[", "0.", "]", ")", ")", "\n", "\n", "# compute the precision envelope", "\n", "for", "i", "in", "range", "(", "mpre", ".", "size", "-", "1", ",", "0", ",", "-", "1", ")", ":", "\n", "            ", "mpre", "[", "i", "-", "1", "]", "=", "np", ".", "maximum", "(", "mpre", "[", "i", "-", "1", "]", ",", "mpre", "[", "i", "]", ")", "\n", "\n", "# to calculate area under PR curve, look for points", "\n", "# where X axis (recall) changes value", "\n", "", "i", "=", "np", ".", "where", "(", "mrec", "[", "1", ":", "]", "!=", "mrec", "[", ":", "-", "1", "]", ")", "[", "0", "]", "\n", "\n", "# and sum (\\Delta recall) * prec", "\n", "ap", "=", "np", ".", "sum", "(", "(", "mrec", "[", "i", "+", "1", "]", "-", "mrec", "[", "i", "]", ")", "*", "mpre", "[", "i", "+", "1", "]", ")", "\n", "", "return", "ap", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.__init__": [[9, 11], ["None"], "methods", ["None"], ["    ", "def", "__init__", "(", "self", ")", ":", "\n", "        ", "pass", ";", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.name": [[12, 14], ["None"], "methods", ["None"], ["", "def", "name", "(", "self", ")", ":", "\n", "        ", "return", "'BaseModel'", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.initialize": [[15, 18], ["None"], "methods", ["None"], ["", "def", "initialize", "(", "self", ",", "use_gpu", "=", "True", ",", "gpu_ids", "=", "[", "0", "]", ")", ":", "\n", "        ", "self", ".", "use_gpu", "=", "use_gpu", "\n", "self", ".", "gpu_ids", "=", "gpu_ids", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.forward": [[19, 21], ["None"], "methods", ["None"], ["", "def", "forward", "(", "self", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.get_image_paths": [[53, 55], ["None"], "methods", ["None"], ["", "def", "get_image_paths", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "image_paths", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.optimize_parameters": [[25, 27], ["None"], "methods", ["None"], ["", "def", "optimize_parameters", "(", "self", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.get_current_visuals": [[28, 30], ["None"], "methods", ["None"], ["", "def", "get_current_visuals", "(", "self", ")", ":", "\n", "        ", "return", "self", ".", "input", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.get_current_errors": [[31, 33], ["None"], "methods", ["None"], ["", "def", "get_current_errors", "(", "self", ")", ":", "\n", "        ", "return", "{", "}", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save": [[34, 36], ["None"], "methods", ["None"], ["", "def", "save", "(", "self", ",", "label", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save_network": [[38, 42], ["os.path.join", "torch.save", "network.state_dict"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save"], ["", "def", "save_network", "(", "self", ",", "network", ",", "path", ",", "network_label", ",", "epoch_label", ")", ":", "\n", "        ", "save_filename", "=", "'%s_net_%s.pth'", "%", "(", "epoch_label", ",", "network_label", ")", "\n", "save_path", "=", "os", ".", "path", ".", "join", "(", "path", ",", "save_filename", ")", "\n", "torch", ".", "save", "(", "network", ".", "state_dict", "(", ")", ",", "save_path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.load_network": [[44, 49], ["os.path.join", "print", "network.load_state_dict", "torch.load"], "methods", ["None"], ["", "def", "load_network", "(", "self", ",", "network", ",", "network_label", ",", "epoch_label", ")", ":", "\n", "        ", "save_filename", "=", "'%s_net_%s.pth'", "%", "(", "epoch_label", ",", "network_label", ")", "\n", "save_path", "=", "os", ".", "path", ".", "join", "(", "self", ".", "save_dir", ",", "save_filename", ")", "\n", "print", "(", "'Loading network from %s'", "%", "save_path", ")", "\n", "network", ".", "load_state_dict", "(", "torch", ".", "load", "(", "save_path", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.update_learning_rate": [[50, 52], ["None"], "methods", ["None"], ["", "def", "update_learning_rate", "(", ")", ":", "\n", "        ", "pass", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save_done": [[56, 59], ["numpy.save", "numpy.savetxt", "os.path.join", "os.path.join"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.lpips.base_model.BaseModel.save"], ["", "def", "save_done", "(", "self", ",", "flag", "=", "False", ")", ":", "\n", "        ", "np", ".", "save", "(", "os", ".", "path", ".", "join", "(", "self", ".", "save_dir", ",", "'done_flag'", ")", ",", "flag", ")", "\n", "np", ".", "savetxt", "(", "os", ".", "path", ".", "join", "(", "self", ".", "save_dir", ",", "'done_flag'", ")", ",", "[", "flag", ",", "]", ",", "fmt", "=", "'%i'", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLUFunctionBackward.forward": [[21, 41], ["ctx.save_for_backward", "grad_output.new_empty", "fused.fused_bias_act", "fused.fused_bias_act.sum().detach", "list", "range", "fused.fused_bias_act.sum"], "methods", ["None"], ["    ", "@", "staticmethod", "\n", "def", "forward", "(", "ctx", ",", "grad_output", ",", "out", ",", "negative_slope", ",", "scale", ")", ":", "\n", "        ", "ctx", ".", "save_for_backward", "(", "out", ")", "\n", "ctx", ".", "negative_slope", "=", "negative_slope", "\n", "ctx", ".", "scale", "=", "scale", "\n", "\n", "empty", "=", "grad_output", ".", "new_empty", "(", "0", ")", "\n", "\n", "grad_input", "=", "fused", ".", "fused_bias_act", "(", "\n", "grad_output", ",", "empty", ",", "out", ",", "3", ",", "1", ",", "negative_slope", ",", "scale", "\n", ")", "\n", "\n", "dim", "=", "[", "0", "]", "\n", "\n", "if", "grad_input", ".", "ndim", ">", "2", ":", "\n", "            ", "dim", "+=", "list", "(", "range", "(", "2", ",", "grad_input", ".", "ndim", ")", ")", "\n", "\n", "", "grad_bias", "=", "grad_input", ".", "sum", "(", "dim", ")", ".", "detach", "(", ")", "\n", "\n", "return", "grad_input", ",", "grad_bias", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLUFunctionBackward.backward": [[42, 50], ["fused.fused_bias_act"], "methods", ["None"], ["", "@", "staticmethod", "\n", "def", "backward", "(", "ctx", ",", "gradgrad_input", ",", "gradgrad_bias", ")", ":", "\n", "        ", "(", "out", ",", ")", "=", "ctx", ".", "saved_tensors", "\n", "gradgrad_out", "=", "fused", ".", "fused_bias_act", "(", "\n", "gradgrad_input", ",", "gradgrad_bias", ",", "out", ",", "3", ",", "1", ",", "ctx", ".", "negative_slope", ",", "ctx", ".", "scale", "\n", ")", "\n", "\n", "return", "gradgrad_out", ",", "None", ",", "None", ",", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLUFunction.forward": [[53, 62], ["input.new_empty", "fused.fused_bias_act", "ctx.save_for_backward"], "methods", ["None"], ["    ", "@", "staticmethod", "\n", "def", "forward", "(", "ctx", ",", "input", ",", "bias", ",", "negative_slope", ",", "scale", ")", ":", "\n", "        ", "empty", "=", "input", ".", "new_empty", "(", "0", ")", "\n", "out", "=", "fused", ".", "fused_bias_act", "(", "input", ",", "bias", ",", "empty", ",", "3", ",", "0", ",", "negative_slope", ",", "scale", ")", "\n", "ctx", ".", "save_for_backward", "(", "out", ")", "\n", "ctx", ".", "negative_slope", "=", "negative_slope", "\n", "ctx", ".", "scale", "=", "scale", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLUFunction.backward": [[63, 72], ["FusedLeakyReLUFunctionBackward.apply"], "methods", ["None"], ["", "@", "staticmethod", "\n", "def", "backward", "(", "ctx", ",", "grad_output", ")", ":", "\n", "        ", "(", "out", ",", ")", "=", "ctx", ".", "saved_tensors", "\n", "\n", "grad_input", ",", "grad_bias", "=", "FusedLeakyReLUFunctionBackward", ".", "apply", "(", "\n", "grad_output", ",", "out", ",", "ctx", ".", "negative_slope", ",", "ctx", ".", "scale", "\n", ")", "\n", "\n", "return", "grad_input", ",", "grad_bias", ",", "None", ",", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__": [[75, 81], ["torch.nn.Module.__init__", "torch.nn.Parameter", "torch.zeros"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.__init__"], ["    ", "def", "__init__", "(", "self", ",", "channel", ",", "negative_slope", "=", "0.2", ",", "scale", "=", "2", "**", "0.5", ")", ":", "\n", "        ", "super", "(", ")", ".", "__init__", "(", ")", "\n", "\n", "self", ".", "bias", "=", "nn", ".", "Parameter", "(", "torch", ".", "zeros", "(", "channel", ")", ")", "\n", "self", ".", "negative_slope", "=", "negative_slope", "\n", "self", ".", "scale", "=", "scale", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.FusedLeakyReLU.forward": [[82, 84], ["fused_act.fused_leaky_relu"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.fused_leaky_relu"], ["", "def", "forward", "(", "self", ",", "input", ")", ":", "\n", "        ", "return", "fused_leaky_relu", "(", "input", ",", "self", ".", "bias", ",", "self", ".", "negative_slope", ",", "self", ".", "scale", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.fused_act.fused_leaky_relu": [[86, 98], ["FusedLeakyReLUFunction.apply", "torch.nn.functional.leaky_relu", "bias.view"], "function", ["None"], ["", "", "def", "fused_leaky_relu", "(", "input", ",", "bias", ",", "negative_slope", "=", "0.2", ",", "scale", "=", "2", "**", "0.5", ")", ":", "\n", "    ", "if", "input", ".", "device", ".", "type", "==", "\"cpu\"", ":", "\n", "        ", "rest_dim", "=", "[", "1", "]", "*", "(", "input", ".", "ndim", "-", "bias", ".", "ndim", "-", "1", ")", "\n", "return", "(", "\n", "F", ".", "leaky_relu", "(", "\n", "input", "+", "bias", ".", "view", "(", "1", ",", "bias", ".", "shape", "[", "0", "]", ",", "*", "rest_dim", ")", ",", "negative_slope", "=", "0.2", "\n", ")", "\n", "*", "scale", "\n", ")", "\n", "\n", "", "else", ":", "\n", "        ", "return", "FusedLeakyReLUFunction", ".", "apply", "(", "input", ",", "bias", ",", "negative_slope", ",", "scale", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2dBackward.forward": [[20, 61], ["grad_output.reshape.reshape.reshape", "upfirdn2d_op.upfirdn2d", "grad_input.view.view.view", "ctx.save_for_backward"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d"], ["    ", "@", "staticmethod", "\n", "def", "forward", "(", "\n", "ctx", ",", "grad_output", ",", "kernel", ",", "grad_kernel", ",", "up", ",", "down", ",", "pad", ",", "g_pad", ",", "in_size", ",", "out_size", "\n", ")", ":", "\n", "\n", "        ", "up_x", ",", "up_y", "=", "up", "\n", "down_x", ",", "down_y", "=", "down", "\n", "g_pad_x0", ",", "g_pad_x1", ",", "g_pad_y0", ",", "g_pad_y1", "=", "g_pad", "\n", "\n", "grad_output", "=", "grad_output", ".", "reshape", "(", "-", "1", ",", "out_size", "[", "0", "]", ",", "out_size", "[", "1", "]", ",", "1", ")", "\n", "\n", "grad_input", "=", "upfirdn2d_op", ".", "upfirdn2d", "(", "\n", "grad_output", ",", "\n", "grad_kernel", ",", "\n", "down_x", ",", "\n", "down_y", ",", "\n", "up_x", ",", "\n", "up_y", ",", "\n", "g_pad_x0", ",", "\n", "g_pad_x1", ",", "\n", "g_pad_y0", ",", "\n", "g_pad_y1", ",", "\n", ")", "\n", "grad_input", "=", "grad_input", ".", "view", "(", "in_size", "[", "0", "]", ",", "in_size", "[", "1", "]", ",", "in_size", "[", "2", "]", ",", "in_size", "[", "3", "]", ")", "\n", "\n", "ctx", ".", "save_for_backward", "(", "kernel", ")", "\n", "\n", "pad_x0", ",", "pad_x1", ",", "pad_y0", ",", "pad_y1", "=", "pad", "\n", "\n", "ctx", ".", "up_x", "=", "up_x", "\n", "ctx", ".", "up_y", "=", "up_y", "\n", "ctx", ".", "down_x", "=", "down_x", "\n", "ctx", ".", "down_y", "=", "down_y", "\n", "ctx", ".", "pad_x0", "=", "pad_x0", "\n", "ctx", ".", "pad_x1", "=", "pad_x1", "\n", "ctx", ".", "pad_y0", "=", "pad_y0", "\n", "ctx", ".", "pad_y1", "=", "pad_y1", "\n", "ctx", ".", "in_size", "=", "in_size", "\n", "ctx", ".", "out_size", "=", "out_size", "\n", "\n", "return", "grad_input", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2dBackward.backward": [[62, 86], ["gradgrad_input.reshape.reshape.reshape", "upfirdn2d_op.upfirdn2d", "gradgrad_out.view.view.view"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d"], ["", "@", "staticmethod", "\n", "def", "backward", "(", "ctx", ",", "gradgrad_input", ")", ":", "\n", "        ", "kernel", ",", "=", "ctx", ".", "saved_tensors", "\n", "\n", "gradgrad_input", "=", "gradgrad_input", ".", "reshape", "(", "-", "1", ",", "ctx", ".", "in_size", "[", "2", "]", ",", "ctx", ".", "in_size", "[", "3", "]", ",", "1", ")", "\n", "\n", "gradgrad_out", "=", "upfirdn2d_op", ".", "upfirdn2d", "(", "\n", "gradgrad_input", ",", "\n", "kernel", ",", "\n", "ctx", ".", "up_x", ",", "\n", "ctx", ".", "up_y", ",", "\n", "ctx", ".", "down_x", ",", "\n", "ctx", ".", "down_y", ",", "\n", "ctx", ".", "pad_x0", ",", "\n", "ctx", ".", "pad_x1", ",", "\n", "ctx", ".", "pad_y0", ",", "\n", "ctx", ".", "pad_y1", ",", "\n", ")", "\n", "# gradgrad_out = gradgrad_out.view(ctx.in_size[0], ctx.out_size[0], ctx.out_size[1], ctx.in_size[3])", "\n", "gradgrad_out", "=", "gradgrad_out", ".", "view", "(", "\n", "ctx", ".", "in_size", "[", "0", "]", ",", "ctx", ".", "in_size", "[", "1", "]", ",", "ctx", ".", "out_size", "[", "0", "]", ",", "ctx", ".", "out_size", "[", "1", "]", "\n", ")", "\n", "\n", "return", "gradgrad_out", ",", "None", ",", "None", ",", "None", ",", "None", ",", "None", ",", "None", ",", "None", ",", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.forward": [[89, 125], ["input.reshape.reshape.reshape", "ctx.save_for_backward", "upfirdn2d_op.upfirdn2d", "out.view.view.view", "torch.flip"], "methods", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d"], ["    ", "@", "staticmethod", "\n", "def", "forward", "(", "ctx", ",", "input", ",", "kernel", ",", "up", ",", "down", ",", "pad", ")", ":", "\n", "        ", "up_x", ",", "up_y", "=", "up", "\n", "down_x", ",", "down_y", "=", "down", "\n", "pad_x0", ",", "pad_x1", ",", "pad_y0", ",", "pad_y1", "=", "pad", "\n", "\n", "kernel_h", ",", "kernel_w", "=", "kernel", ".", "shape", "\n", "batch", ",", "channel", ",", "in_h", ",", "in_w", "=", "input", ".", "shape", "\n", "ctx", ".", "in_size", "=", "input", ".", "shape", "\n", "\n", "input", "=", "input", ".", "reshape", "(", "-", "1", ",", "in_h", ",", "in_w", ",", "1", ")", "\n", "\n", "ctx", ".", "save_for_backward", "(", "kernel", ",", "torch", ".", "flip", "(", "kernel", ",", "[", "0", ",", "1", "]", ")", ")", "\n", "\n", "out_h", "=", "(", "in_h", "*", "up_y", "+", "pad_y0", "+", "pad_y1", "-", "kernel_h", ")", "//", "down_y", "+", "1", "\n", "out_w", "=", "(", "in_w", "*", "up_x", "+", "pad_x0", "+", "pad_x1", "-", "kernel_w", ")", "//", "down_x", "+", "1", "\n", "ctx", ".", "out_size", "=", "(", "out_h", ",", "out_w", ")", "\n", "\n", "ctx", ".", "up", "=", "(", "up_x", ",", "up_y", ")", "\n", "ctx", ".", "down", "=", "(", "down_x", ",", "down_y", ")", "\n", "ctx", ".", "pad", "=", "(", "pad_x0", ",", "pad_x1", ",", "pad_y0", ",", "pad_y1", ")", "\n", "\n", "g_pad_x0", "=", "kernel_w", "-", "pad_x0", "-", "1", "\n", "g_pad_y0", "=", "kernel_h", "-", "pad_y0", "-", "1", "\n", "g_pad_x1", "=", "in_w", "*", "up_x", "-", "out_w", "*", "down_x", "+", "pad_x0", "-", "up_x", "+", "1", "\n", "g_pad_y1", "=", "in_h", "*", "up_y", "-", "out_h", "*", "down_y", "+", "pad_y0", "-", "up_y", "+", "1", "\n", "\n", "ctx", ".", "g_pad", "=", "(", "g_pad_x0", ",", "g_pad_x1", ",", "g_pad_y0", ",", "g_pad_y1", ")", "\n", "\n", "out", "=", "upfirdn2d_op", ".", "upfirdn2d", "(", "\n", "input", ",", "kernel", ",", "up_x", ",", "up_y", ",", "down_x", ",", "down_y", ",", "pad_x0", ",", "pad_x1", ",", "pad_y0", ",", "pad_y1", "\n", ")", "\n", "# out = out.view(major, out_h, out_w, minor)", "\n", "out", "=", "out", ".", "view", "(", "-", "1", ",", "channel", ",", "out_h", ",", "out_w", ")", "\n", "\n", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.UpFirDn2d.backward": [[126, 143], ["UpFirDn2dBackward.apply"], "methods", ["None"], ["", "@", "staticmethod", "\n", "def", "backward", "(", "ctx", ",", "grad_output", ")", ":", "\n", "        ", "kernel", ",", "grad_kernel", "=", "ctx", ".", "saved_tensors", "\n", "\n", "grad_input", "=", "UpFirDn2dBackward", ".", "apply", "(", "\n", "grad_output", ",", "\n", "kernel", ",", "\n", "grad_kernel", ",", "\n", "ctx", ".", "up", ",", "\n", "ctx", ".", "down", ",", "\n", "ctx", ".", "pad", ",", "\n", "ctx", ".", "g_pad", ",", "\n", "ctx", ".", "in_size", ",", "\n", "ctx", ".", "out_size", ",", "\n", ")", "\n", "\n", "return", "grad_input", ",", "None", ",", "None", ",", "None", ",", "None", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d": [[145, 157], ["upfirdn2d.upfirdn2d_native", "UpFirDn2d.apply"], "function", ["home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d_native"], ["", "", "def", "upfirdn2d", "(", "input", ",", "kernel", ",", "up", "=", "1", ",", "down", "=", "1", ",", "pad", "=", "(", "0", ",", "0", ")", ")", ":", "\n", "    ", "if", "input", ".", "device", ".", "type", "==", "\"cpu\"", ":", "\n", "        ", "out", "=", "upfirdn2d_native", "(", "\n", "input", ",", "kernel", ",", "up", ",", "up", ",", "down", ",", "down", ",", "pad", "[", "0", "]", ",", "pad", "[", "1", "]", ",", "pad", "[", "0", "]", ",", "pad", "[", "1", "]", "\n", ")", "\n", "\n", "", "else", ":", "\n", "        ", "out", "=", "UpFirDn2d", ".", "apply", "(", "\n", "input", ",", "kernel", ",", "(", "up", ",", "up", ")", ",", "(", "down", ",", "down", ")", ",", "(", "pad", "[", "0", "]", ",", "pad", "[", "1", "]", ",", "pad", "[", "0", "]", ",", "pad", "[", "1", "]", ")", "\n", ")", "\n", "\n", "", "return", "out", "\n", "\n"]], "home.repos.pwc.inspect_result.cvlab-stonybrook_lsae.op.upfirdn2d.upfirdn2d_native": [[159, 201], ["input.reshape.reshape", "input.reshape.view", "torch.nn.functional.pad", "out.permute.view", "torch.nn.functional.pad", "out.permute.permute", "out.permute.reshape", "torch.flip().view", "torch.nn.functional.conv2d", "out.permute.reshape", "out.permute.permute", "out.permute.view", "max", "max", "max", "max", "torch.flip", "max", "max", "max", "max"], "function", ["None"], ["", "def", "upfirdn2d_native", "(", "\n", "input", ",", "kernel", ",", "up_x", ",", "up_y", ",", "down_x", ",", "down_y", ",", "pad_x0", ",", "pad_x1", ",", "pad_y0", ",", "pad_y1", "\n", ")", ":", "\n", "    ", "_", ",", "channel", ",", "in_h", ",", "in_w", "=", "input", ".", "shape", "\n", "input", "=", "input", ".", "reshape", "(", "-", "1", ",", "in_h", ",", "in_w", ",", "1", ")", "\n", "\n", "_", ",", "in_h", ",", "in_w", ",", "minor", "=", "input", ".", "shape", "\n", "kernel_h", ",", "kernel_w", "=", "kernel", ".", "shape", "\n", "\n", "out", "=", "input", ".", "view", "(", "-", "1", ",", "in_h", ",", "1", ",", "in_w", ",", "1", ",", "minor", ")", "\n", "out", "=", "F", ".", "pad", "(", "out", ",", "[", "0", ",", "0", ",", "0", ",", "up_x", "-", "1", ",", "0", ",", "0", ",", "0", ",", "up_y", "-", "1", "]", ")", "\n", "out", "=", "out", ".", "view", "(", "-", "1", ",", "in_h", "*", "up_y", ",", "in_w", "*", "up_x", ",", "minor", ")", "\n", "\n", "out", "=", "F", ".", "pad", "(", "\n", "out", ",", "[", "0", ",", "0", ",", "max", "(", "pad_x0", ",", "0", ")", ",", "max", "(", "pad_x1", ",", "0", ")", ",", "max", "(", "pad_y0", ",", "0", ")", ",", "max", "(", "pad_y1", ",", "0", ")", "]", "\n", ")", "\n", "out", "=", "out", "[", "\n", ":", ",", "\n", "max", "(", "-", "pad_y0", ",", "0", ")", ":", "out", ".", "shape", "[", "1", "]", "-", "max", "(", "-", "pad_y1", ",", "0", ")", ",", "\n", "max", "(", "-", "pad_x0", ",", "0", ")", ":", "out", ".", "shape", "[", "2", "]", "-", "max", "(", "-", "pad_x1", ",", "0", ")", ",", "\n", ":", ",", "\n", "]", "\n", "\n", "out", "=", "out", ".", "permute", "(", "0", ",", "3", ",", "1", ",", "2", ")", "\n", "out", "=", "out", ".", "reshape", "(", "\n", "[", "-", "1", ",", "1", ",", "in_h", "*", "up_y", "+", "pad_y0", "+", "pad_y1", ",", "in_w", "*", "up_x", "+", "pad_x0", "+", "pad_x1", "]", "\n", ")", "\n", "w", "=", "torch", ".", "flip", "(", "kernel", ",", "[", "0", ",", "1", "]", ")", ".", "view", "(", "1", ",", "1", ",", "kernel_h", ",", "kernel_w", ")", "\n", "out", "=", "F", ".", "conv2d", "(", "out", ",", "w", ")", "\n", "out", "=", "out", ".", "reshape", "(", "\n", "-", "1", ",", "\n", "minor", ",", "\n", "in_h", "*", "up_y", "+", "pad_y0", "+", "pad_y1", "-", "kernel_h", "+", "1", ",", "\n", "in_w", "*", "up_x", "+", "pad_x0", "+", "pad_x1", "-", "kernel_w", "+", "1", ",", "\n", ")", "\n", "out", "=", "out", ".", "permute", "(", "0", ",", "2", ",", "3", ",", "1", ")", "\n", "out", "=", "out", "[", ":", ",", ":", ":", "down_y", ",", ":", ":", "down_x", ",", ":", "]", "\n", "\n", "out_h", "=", "(", "in_h", "*", "up_y", "+", "pad_y0", "+", "pad_y1", "-", "kernel_h", ")", "//", "down_y", "+", "1", "\n", "out_w", "=", "(", "in_w", "*", "up_x", "+", "pad_x0", "+", "pad_x1", "-", "kernel_w", ")", "//", "down_x", "+", "1", "\n", "\n", "return", "out", ".", "view", "(", "-", "1", ",", "channel", ",", "out_h", ",", "out_w", ")", "\n", "", ""]]}