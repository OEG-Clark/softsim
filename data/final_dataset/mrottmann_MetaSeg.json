{"home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.probs_gt_save": [[39, 56], ["file_names.append", "os.path.dirname", "h5py.File", "h5py.File.create_dataset", "h5py.File.create_dataset", "h5py.File.create_dataset", "print", "h5py.File.close", "image_name.encode", "metaseg_io.get_save_path_probs_i", "os.path.exists", "os.makedirs", "metaseg_io.get_save_path_probs_i", "metaseg_io.get_save_path_probs_i"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_probs_i", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_probs_i", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_probs_i"], ["def", "probs_gt_save", "(", "probs", ",", "gt", ",", "image_name", ",", "i", ")", ":", "\n", "\n", "  ", "file_names", "=", "[", "]", "\n", "file_names", ".", "append", "(", "image_name", ".", "encode", "(", "'utf8'", ")", ")", "\n", "\n", "dump_dir", "=", "os", ".", "path", ".", "dirname", "(", "get_save_path_probs_i", "(", "i", ")", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "dump_dir", ")", ":", "\n", "    ", "os", ".", "makedirs", "(", "dump_dir", ")", "\n", "\n", "", "f", "=", "h5py", ".", "File", "(", "get_save_path_probs_i", "(", "i", ")", ",", "\"w\"", ")", "\n", "f", ".", "create_dataset", "(", "\"probabilities\"", ",", "data", "=", "probs", ")", "\n", "f", ".", "create_dataset", "(", "\"ground_truths\"", ",", "data", "=", "gt", ")", "\n", "f", ".", "create_dataset", "(", "\"file_names\"", ",", "data", "=", "file_names", ")", "\n", "\n", "print", "(", "\"file stored:\"", ",", "get_save_path_probs_i", "(", "i", ")", ")", "\n", "\n", "f", ".", "close", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.probs_gt_load": [[59, 68], ["h5py.File", "numpy.asarray", "numpy.asarray", "numpy.squeeze", "numpy.squeeze", "metaseg_io.get_save_path_probs_i", "[].decode"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_probs_i"], ["", "def", "probs_gt_load", "(", "i", ")", ":", "\n", "\n", "  ", "f_probs", "=", "h5py", ".", "File", "(", "get_save_path_probs_i", "(", "i", ")", ",", "\"r\"", ")", "\n", "probs", "=", "np", ".", "asarray", "(", "f_probs", "[", "'probabilities'", "]", ")", "\n", "gt", "=", "np", ".", "asarray", "(", "f_probs", "[", "'ground_truths'", "]", ")", "\n", "probs", "=", "np", ".", "squeeze", "(", "probs", ")", "\n", "gt", "=", "np", ".", "squeeze", "(", "gt", "[", "0", "]", ")", "\n", "\n", "return", "probs", ",", "gt", ",", "f_probs", "[", "'file_names'", "]", "[", "0", "]", ".", "decode", "(", "'utf8'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_dump": [[72, 81], ["metaseg_io.get_save_path_metrics_i", "os.path.dirname", "pickle.dump", "os.path.exists", "os.makedirs", "open"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_metrics_i"], ["", "def", "metrics_dump", "(", "metrics", ",", "i", ")", ":", "\n", "\n", "  ", "dump_path", "=", "get_save_path_metrics_i", "(", "i", ")", "\n", "dump_dir", "=", "os", ".", "path", ".", "dirname", "(", "dump_path", ")", "\n", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "dump_dir", ")", ":", "\n", "    ", "os", ".", "makedirs", "(", "dump_dir", ")", "\n", "\n", "", "pickle", ".", "dump", "(", "metrics", ",", "open", "(", "dump_path", ",", "\"wb\"", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_load": [[84, 90], ["metaseg_io.get_save_path_metrics_i", "pickle.load", "open"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_metrics_i"], ["", "def", "metrics_load", "(", "i", ")", ":", "\n", "\n", "  ", "read_path", "=", "get_save_path_metrics_i", "(", "i", ")", "\n", "metrics", "=", "pickle", ".", "load", "(", "open", "(", "read_path", ",", "\"rb\"", ")", ")", "\n", "\n", "return", "metrics", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.components_dump": [[93, 102], ["metaseg_io.get_save_path_components_i", "os.path.dirname", "pickle.dump", "os.path.exists", "os.makedirs", "open"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_components_i"], ["", "def", "components_dump", "(", "components", ",", "i", ")", ":", "\n", "\n", "  ", "dump_path", "=", "get_save_path_components_i", "(", "i", ")", "\n", "dump_dir", "=", "os", ".", "path", ".", "dirname", "(", "dump_path", ")", "\n", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "dump_dir", ")", ":", "\n", "    ", "os", ".", "makedirs", "(", "dump_dir", ")", "\n", "\n", "", "pickle", ".", "dump", "(", "components", ",", "open", "(", "dump_path", ",", "\"wb\"", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.components_load": [[105, 111], ["metaseg_io.get_save_path_components_i", "pickle.load", "open"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_components_i"], ["", "def", "components_load", "(", "i", ")", ":", "\n", "\n", "  ", "read_path", "=", "get_save_path_components_i", "(", "i", ")", "\n", "components", "=", "pickle", ".", "load", "(", "open", "(", "read_path", ",", "\"rb\"", ")", ")", "\n", "\n", "return", "components", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_metrics_i": [[114, 117], ["str", "metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "get_save_path_metrics_i", "(", "i", ")", ":", "\n", "\n", "  ", "return", "metaseg", ".", "get", "(", "\"METRICS_DIR\"", ")", "+", "\"metrics\"", "+", "str", "(", "i", ")", "+", "\".p\"", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_components_i": [[120, 123], ["str", "metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "get_save_path_components_i", "(", "i", ")", ":", "\n", "\n", "  ", "return", "metaseg", ".", "get", "(", "\"COMPONENTS_DIR\"", ")", "+", "\"components\"", "+", "str", "(", "i", ")", "+", "\".p\"", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_probs_i": [[126, 129], ["str", "metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "get_save_path_probs_i", "(", "i", ")", ":", "\n", "\n", "  ", "return", "metaseg", ".", "get", "(", "\"PROBS_DIR\"", ")", "+", "\"probs_\"", "+", "str", "(", "i", ")", "+", "\".hdf5\"", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_iou_seg_vis_path_i": [[132, 135], ["str", "metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "get_iou_seg_vis_path_i", "(", "i", ")", ":", "\n", "\n", "  ", "return", "metaseg", ".", "get", "(", "\"IOU_SEG_VIS_DIR\"", ")", "+", "\"img\"", "+", "str", "(", "i", ")", "+", "\".hdf5\"", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_stats": [[138, 141], ["metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "get_save_path_stats", "(", ")", ":", "\n", "\n", "  ", "return", "metaseg", ".", "get", "(", "\"STATS_DIR\"", ")", "+", "\"stats.p\"", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_img_path_fname": [[144, 157], ["os.walk", "metaseg.get", "print", "os.path.join"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "get_img_path_fname", "(", "filename", ")", ":", "\n", "\n", "  ", "path", "=", "[", "]", "\n", "for", "root", ",", "dirnames", ",", "filenames", "in", "os", ".", "walk", "(", "metaseg", ".", "get", "(", "\"IMG_DIR\"", ")", ")", ":", "\n", "    ", "for", "fn", "in", "filenames", ":", "\n", "      ", "if", "filename", "in", "fn", ":", "\n", "        ", "path", "=", "os", ".", "path", ".", "join", "(", "root", ",", "fn", ")", "\n", "break", "\n", "\n", "", "", "", "if", "path", "==", "[", "]", ":", "\n", "    ", "print", "(", "\"file\"", ",", "filename", ",", "\"not found.\"", ")", "\n", "\n", "", "return", "path", "\n", "", ""]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.__init__": [[37, 40], ["setattr"], "methods", ["None"], ["def", "__init__", "(", "self", ")", ":", "\n", "    ", "for", "m", "in", "self", ".", "METASEG", ":", "\n", "      ", "setattr", "(", "self", ",", "m", ",", "self", ".", "METASEG", "[", "m", "]", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get": [[43, 49], ["getattr", "print"], "methods", ["None"], ["", "", "def", "get", "(", "self", ",", "name", ")", ":", "\n", "    ", "try", ":", "\n", "      ", "return", "getattr", "(", "self", ",", "name", ")", "\n", "", "except", ":", "\n", "      ", "print", "(", "\"MetaSeg:\"", ",", "name", ",", "\"not found.\"", ")", "\n", "return", "0", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.set": [[52, 55], ["getattr", "setattr"], "methods", ["None"], ["", "", "def", "set", "(", "self", ",", "name", ",", "value", ")", ":", "\n", "    ", "if", "getattr", "(", "self", ",", "name", ")", ":", "\n", "      ", "setattr", "(", "self", ",", "name", ",", "value", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.print_attr": [[58, 61], ["sorted", "print", "getattr"], "methods", ["None"], ["", "", "def", "print_attr", "(", "self", ")", ":", "\n", "    ", "for", "m", "in", "sorted", "(", "self", ".", "METASEG", ")", ":", "\n", "      ", "print", "(", "m", ",", "\":\"", ",", "getattr", "(", "self", ",", "m", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.set_from_argv": [[64, 78], ["str", "range", "len", "str.split", "str", "global_defs.MetaSeg.get", "type", "global_defs.MetaSeg.set", "c.split", "c.split", "global_defs.MetaSeg.get", "type."], "methods", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.set", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "", "def", "set_from_argv", "(", "self", ",", "argv", ")", ":", "\n", "    ", "cline", "=", "str", "(", ")", "\n", "for", "i", "in", "range", "(", "len", "(", "argv", ")", ")", ":", "\n", "      ", "cline", "+=", "str", "(", "argv", "[", "i", "]", ")", "+", "\" \"", "\n", "\n", "", "if", "\"--\"", "in", "cline", ":", "\n", "      ", "commands", "=", "cline", ".", "split", "(", "\"--\"", ")", "\n", "\n", "for", "c", "in", "commands", "[", "1", ":", "]", ":", "\n", "        ", "c0", ",", "c1", "=", "c", ".", "split", "(", "\"=\"", ")", "[", "0", "]", ",", "c", ".", "split", "(", "\"=\"", ")", "[", "1", "]", "\n", "\n", "if", "self", ".", "get", "(", "c0", ")", ":", "\n", "          ", "dtype", "=", "type", "(", "self", ".", "get", "(", "c0", ")", ")", "\n", "self", ".", "set", "(", "c0", ",", "dtype", "(", "c1", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.main": [[46, 60], ["metaseg_io.metaseg.set_from_argv", "metaseg_io.metaseg.print_attr", "metaseg_io.metaseg.get", "metaseg_io.metaseg.get", "metaseg_io.metaseg.get", "metaseg_eval.compute_metrics_per_image", "metaseg_eval.visualize_metrics", "metaseg_eval.analyze_metrics"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.set_from_argv", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.print_attr", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.compute_metrics_per_image", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.visualize_metrics", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.analyze_metrics"], ["def", "main", "(", ")", ":", "\n", "\n", "  ", "metaseg", ".", "set_from_argv", "(", "sys", ".", "argv", ")", "\n", "\n", "metaseg", ".", "print_attr", "(", ")", "\n", "\n", "if", "metaseg", ".", "get", "(", "\"COMPUTE_METRICS\"", ")", ":", "\n", "    ", "compute_metrics_per_image", "(", ")", "\n", "\n", "", "if", "metaseg", ".", "get", "(", "\"VISUALIZE_METRICS\"", ")", ":", "\n", "    ", "visualize_metrics", "(", ")", "\n", "\n", "", "if", "metaseg", ".", "get", "(", "\"ANALYZE_METRICS\"", ")", ":", "\n", "    ", "analyze_metrics", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.label_as_onehot": [[63, 70], ["numpy.zeros", "range", "numpy.transpose", "np.transpose.astype"], "function", ["None"], ["", "", "def", "label_as_onehot", "(", "label", ",", "num_classes", ",", "shift_range", "=", "0", ")", ":", "\n", "\n", "  ", "y", "=", "np", ".", "zeros", "(", "(", "num_classes", ",", "label", ".", "shape", "[", "0", "]", ",", "label", ".", "shape", "[", "1", "]", ")", ")", "\n", "for", "c", "in", "range", "(", "shift_range", ",", "num_classes", "+", "shift_range", ")", ":", "\n", "          ", "y", "[", "c", "-", "shift_range", "]", "[", "label", "==", "c", "]", "=", "1", "\n", "", "y", "=", "np", ".", "transpose", "(", "y", ",", "(", "1", ",", "2", ",", "0", ")", ")", "# shape is (height, width, num_classes)", "\n", "return", "y", ".", "astype", "(", "'uint8'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.classes_to_categorical": [[73, 82], ["numpy.squeeze", "label_as_onehot().reshape", "numpy.asarray", "numpy.max", "metaseg_eval.label_as_onehot", "str", "range", "label_as_onehot().reshape.reshape"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.label_as_onehot"], ["", "def", "classes_to_categorical", "(", "classes", ",", "nc", "=", "None", ")", ":", "\n", "\n", "  ", "classes", "=", "np", ".", "squeeze", "(", "np", ".", "asarray", "(", "classes", ")", ")", "\n", "if", "nc", "==", "None", ":", "\n", "    ", "nc", "=", "np", ".", "max", "(", "classes", ")", "\n", "", "classes", "=", "label_as_onehot", "(", "classes", ".", "reshape", "(", "(", "classes", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ",", "nc", ")", ".", "reshape", "(", "(", "classes", ".", "shape", "[", "0", "]", ",", "nc", ")", ")", "\n", "names", "=", "[", "\"C_\"", "+", "str", "(", "i", ")", "for", "i", "in", "range", "(", "nc", ")", "]", "\n", "\n", "return", "classes", ",", "names", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.visualize_segments": [[85, 111], ["numpy.asarray", "numpy.asarray", "numpy.concatenate", "numpy.concatenate", "numpy.concatenate", "numpy.asarray", "len", "numpy.zeros", "range", "numpy.asarray().astype", "comp.copy", "len", "range", "numpy.asarray", "numpy.asarray", "numpy.asarray", "numpy.asarray", "numpy.asarray"], "function", ["None"], ["", "def", "visualize_segments", "(", "comp", ",", "metric", ")", ":", "\n", "\n", "  ", "R", "=", "np", ".", "asarray", "(", "metric", ")", "\n", "R", "=", "1", "-", "0.5", "*", "R", "\n", "G", "=", "np", ".", "asarray", "(", "metric", ")", "\n", "B", "=", "0.3", "+", "0.35", "*", "np", ".", "asarray", "(", "metric", ")", "\n", "\n", "R", "=", "np", ".", "concatenate", "(", "(", "R", ",", "np", ".", "asarray", "(", "[", "0", ",", "1", "]", ")", ")", ")", "\n", "G", "=", "np", ".", "concatenate", "(", "(", "G", ",", "np", ".", "asarray", "(", "[", "0", ",", "1", "]", ")", ")", ")", "\n", "B", "=", "np", ".", "concatenate", "(", "(", "B", ",", "np", ".", "asarray", "(", "[", "0", ",", "1", "]", ")", ")", ")", "\n", "\n", "components", "=", "np", ".", "asarray", "(", "comp", ".", "copy", "(", ")", ",", "dtype", "=", "'int16'", ")", "\n", "components", "[", "components", "<", "0", "]", "=", "len", "(", "R", ")", "-", "1", "\n", "components", "[", "components", "==", "0", "]", "=", "len", "(", "R", ")", "\n", "\n", "img", "=", "np", ".", "zeros", "(", "components", ".", "shape", "+", "(", "3", ",", ")", ")", "\n", "\n", "for", "x", "in", "range", "(", "img", ".", "shape", "[", "0", "]", ")", ":", "\n", "    ", "for", "y", "in", "range", "(", "img", ".", "shape", "[", "1", "]", ")", ":", "\n", "      ", "img", "[", "x", ",", "y", ",", "0", "]", "=", "R", "[", "components", "[", "x", ",", "y", "]", "-", "1", "]", "\n", "img", "[", "x", ",", "y", ",", "1", "]", "=", "G", "[", "components", "[", "x", ",", "y", "]", "-", "1", "]", "\n", "img", "[", "x", ",", "y", ",", "2", "]", "=", "B", "[", "components", "[", "x", ",", "y", "]", "-", "1", "]", "\n", "\n", "", "", "img", "=", "np", ".", "asarray", "(", "255", "*", "img", ")", ".", "astype", "(", "'uint8'", ")", "\n", "\n", "return", "img", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_nparray": [[114, 134], ["range", "numpy.asarray", "numpy.squeeze", "len", "np.squeeze.copy", "numpy.asarray", "range", "numpy.asarray", "numpy.asarray", "numpy.asarray", "numpy.asarray", "numpy.mean", "numpy.std"], "function", ["None"], ["", "def", "metrics_to_nparray", "(", "metrics", ",", "names", ",", "normalize", "=", "False", ",", "non_empty", "=", "False", ",", "all_metrics", "=", "[", "]", ")", ":", "\n", "\n", "  ", "I", "=", "range", "(", "len", "(", "metrics", "[", "'S_in'", "]", ")", ")", "\n", "if", "non_empty", "==", "True", ":", "\n", "    ", "I", "=", "np", ".", "asarray", "(", "metrics", "[", "'S_in'", "]", ")", ">", "0", "\n", "", "M", "=", "np", ".", "asarray", "(", "[", "np", ".", "asarray", "(", "metrics", "[", "m", "]", ")", "[", "I", "]", "for", "m", "in", "names", "]", ")", "\n", "MM", "=", "[", "]", "\n", "if", "all_metrics", "==", "[", "]", ":", "\n", "    ", "MM", "=", "M", ".", "copy", "(", ")", "\n", "", "else", ":", "\n", "    ", "MM", "=", "np", ".", "asarray", "(", "[", "np", ".", "asarray", "(", "all_metrics", "[", "m", "]", ")", "[", "I", "]", "for", "m", "in", "names", "]", ")", "\n", "\n", "", "if", "normalize", "==", "True", ":", "\n", "    ", "for", "i", "in", "range", "(", "M", ".", "shape", "[", "0", "]", ")", ":", "\n", "      ", "if", "names", "[", "i", "]", "!=", "\"class\"", ":", "\n", "        ", "M", "[", "i", "]", "=", "(", "np", ".", "asarray", "(", "M", "[", "i", "]", ")", "-", "np", ".", "mean", "(", "MM", "[", "i", "]", ",", "axis", "=", "-", "1", ")", ")", "/", "(", "np", ".", "std", "(", "MM", "[", "i", "]", ",", "axis", "=", "-", "1", ")", "+", "1e-10", ")", "\n", "\n", "", "", "", "M", "=", "np", ".", "squeeze", "(", "M", ".", "T", ")", "\n", "\n", "return", "M", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.compute_metrics_i": [[137, 150], ["os.path.isfile", "metaseg_io.get_save_path_probs_i", "time.time", "metaseg_io.probs_gt_load", "metrics.compute_metrics", "metaseg_io.metrics_dump", "metaseg_io.components_dump", "print", "round", "time.time"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_probs_i", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.probs_gt_load", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_dump", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.components_dump"], ["", "def", "compute_metrics_i", "(", "i", ")", ":", "\n", "\n", "  ", "if", "os", ".", "path", ".", "isfile", "(", "get_save_path_probs_i", "(", "i", ")", ")", ":", "\n", "\n", "    ", "start", "=", "time", ".", "time", "(", ")", "\n", "\n", "probs", ",", "gt", ",", "_", "=", "probs_gt_load", "(", "i", ")", "\n", "metrics", ",", "components", "=", "compute_metrics", "(", "probs", ",", "gt", ")", "\n", "\n", "metrics_dump", "(", "metrics", ",", "i", ")", "\n", "components_dump", "(", "components", ",", "i", ")", "\n", "\n", "print", "(", "\"image\"", ",", "i", ",", "\"processed in {}s\\r\"", ".", "format", "(", "round", "(", "time", ".", "time", "(", ")", "-", "start", ")", ")", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.visualize_metrics_i": [[153, 190], ["os.path.isfile", "metaseg_io.get_save_path_probs_i", "metaseg_io.probs_gt_load", "metaseg_io.get_img_path_fname", "numpy.asarray", "metaseg_io.components_load", "numpy.asarray", "numpy.asarray", "numpy.asarray", "predc.reshape.reshape", "gtc.reshape.reshape", "metaseg_eval.visualize_segments", "metaseg_eval.visualize_segments", "numpy.concatenate", "numpy.concatenate", "numpy.concatenate", "PIL.Image.fromarray", "metaseg_io.metaseg.get", "Image.fromarray.save", "print", "PIL.Image.open", "numpy.argmax", "np.concatenate.astype", "os.path.exists", "os.makedirs", "range", "range", "range", "range", "str", "str"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_probs_i", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.probs_gt_load", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_img_path_fname", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.components_load", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.visualize_segments", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.visualize_segments", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "", "def", "visualize_metrics_i", "(", "iou", ",", "iou_pred", ",", "i", ")", ":", "\n", "\n", "  ", "if", "os", ".", "path", ".", "isfile", "(", "get_save_path_probs_i", "(", "i", ")", ")", ":", "\n", "\n", "    ", "probs", ",", "gt", ",", "filename", "=", "probs_gt_load", "(", "i", ")", "\n", "\n", "path", "=", "get_img_path_fname", "(", "filename", ")", "\n", "\n", "input_image", "=", "np", ".", "asarray", "(", "Image", ".", "open", "(", "path", ")", ")", "\n", "components", "=", "components_load", "(", "i", ")", "\n", "\n", "pred", "=", "np", ".", "asarray", "(", "np", ".", "argmax", "(", "probs", ",", "axis", "=", "-", "1", ")", ",", "dtype", "=", "'int'", ")", "\n", "\n", "gt", "[", "gt", "==", "255", "]", "=", "0", "\n", "predc", "=", "np", ".", "asarray", "(", "[", "cs_labels", ".", "trainId2label", "[", "pred", "[", "p", ",", "q", "]", "]", ".", "color", "for", "p", "in", "range", "(", "pred", ".", "shape", "[", "0", "]", ")", "for", "q", "in", "range", "(", "pred", ".", "shape", "[", "1", "]", ")", "]", ")", "\n", "gtc", "=", "np", ".", "asarray", "(", "[", "cs_labels", ".", "trainId2label", "[", "gt", "[", "p", ",", "q", "]", "]", ".", "color", "for", "p", "in", "range", "(", "gt", ".", "shape", "[", "0", "]", ")", "for", "q", "in", "range", "(", "gt", ".", "shape", "[", "1", "]", ")", "]", ")", "\n", "predc", "=", "predc", ".", "reshape", "(", "input_image", ".", "shape", ")", "\n", "gtc", "=", "gtc", ".", "reshape", "(", "input_image", ".", "shape", ")", "\n", "\n", "img_iou", "=", "visualize_segments", "(", "components", ",", "iou", ")", "\n", "\n", "I4", "=", "predc", "/", "2.0", "+", "input_image", "/", "2.0", "\n", "I3", "=", "gtc", "/", "2.0", "+", "input_image", "/", "2.0", "\n", "\n", "img_pred", "=", "visualize_segments", "(", "components", ",", "iou_pred", ")", "\n", "\n", "img", "=", "np", ".", "concatenate", "(", "(", "img_iou", ",", "img_pred", ")", ",", "axis", "=", "1", ")", "\n", "img2", "=", "np", ".", "concatenate", "(", "(", "I3", ",", "I4", ")", ",", "axis", "=", "1", ")", "\n", "img", "=", "np", ".", "concatenate", "(", "(", "img", ",", "img2", ")", ",", "axis", "=", "0", ")", "\n", "image", "=", "Image", ".", "fromarray", "(", "img", ".", "astype", "(", "'uint8'", ")", ",", "'RGB'", ")", "\n", "\n", "seg_dir", "=", "metaseg", ".", "get", "(", "\"IOU_SEG_VIS_DIR\"", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "seg_dir", ")", ":", "\n", "      ", "os", ".", "makedirs", "(", "seg_dir", ")", "\n", "", "image", ".", "save", "(", "seg_dir", "+", "\"img\"", "+", "str", "(", "i", ")", "+", "\".png\"", ")", "\n", "\n", "print", "(", "\"stored:\"", ",", "seg_dir", "+", "\"img\"", "+", "str", "(", "i", ")", "+", "\".png\"", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.visualize_metrics": [[193, 229], ["metaseg_io.metaseg.get", "print", "metaseg_io.metrics_load", "list", "range", "metaseg_eval.metrics_to_dataset", "numpy.concatenate", "sklearn.linear_model.LinearRegression", "linear_model.LinearRegression.fit", "numpy.clip", "print", "print", "multiprocessing.Pool", "multiprocessing.Pool.starmap", "metaseg_io.metaseg.get", "metaseg_io.metrics_load", "numpy.max", "linear_model.LinearRegression.predict", "sklearn.metrics.r2_score", "len", "range", "len", "metaseg_io.metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_load", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_dataset", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_load", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "", "def", "visualize_metrics", "(", ")", ":", "\n", "\n", "  ", "num_cores", "=", "metaseg", ".", "get", "(", "\"NUM_CORES\"", ")", "\n", "\n", "print", "(", "\"visualization running\"", ")", "\n", "\n", "metrics", "=", "metrics_load", "(", "0", ")", "\n", "\n", "start", "=", "list", "(", "[", "0", ",", "len", "(", "metrics", "[", "\"S\"", "]", ")", "]", ")", "\n", "\n", "for", "i", "in", "range", "(", "1", ",", "metaseg", ".", "get", "(", "\"NUM_IMAGES\"", ")", ")", ":", "\n", "    ", "m", "=", "metrics_load", "(", "i", ")", "\n", "start", "+=", "[", "start", "[", "-", "1", "]", "+", "len", "(", "m", "[", "\"S\"", "]", ")", "]", "\n", "\n", "for", "j", "in", "metrics", ":", "\n", "      ", "metrics", "[", "j", "]", "+=", "m", "[", "j", "]", "\n", "\n", "", "", "nclasses", "=", "np", ".", "max", "(", "metrics", "[", "\"class\"", "]", ")", "+", "1", "\n", "\n", "Xa", ",", "classes", ",", "ya", ",", "_", ",", "X_names", ",", "class_names", "=", "metrics_to_dataset", "(", "metrics", ",", "nclasses", ",", "non_empty", "=", "False", ")", "\n", "Xa", "=", "np", ".", "concatenate", "(", "(", "Xa", ",", "classes", ")", ",", "axis", "=", "-", "1", ")", "\n", "X_names", "+=", "class_names", "\n", "\n", "lmr", "=", "linear_model", ".", "LinearRegression", "(", ")", "\n", "lmr", ".", "fit", "(", "Xa", ",", "ya", ")", "\n", "\n", "ya_pred", "=", "np", ".", "clip", "(", "lmr", ".", "predict", "(", "Xa", ")", ",", "0", ",", "1", ")", "\n", "\n", "print", "(", "\"model r2 score:\"", ",", "r2_score", "(", "ya", ",", "ya_pred", ")", ")", "\n", "print", "(", "\" \"", ")", "\n", "\n", "p", "=", "Pool", "(", "num_cores", ")", "\n", "\n", "p_args", "=", "[", "(", "ya", "[", "start", "[", "i", "]", ":", "start", "[", "i", "+", "1", "]", "]", ",", "ya_pred", "[", "start", "[", "i", "]", ":", "start", "[", "i", "+", "1", "]", "]", ",", "i", ")", "for", "i", "in", "range", "(", "metaseg", ".", "get", "(", "\"NUM_IMAGES\"", ")", ")", "]", "\n", "\n", "p", ".", "starmap", "(", "visualize_metrics_i", ",", "p_args", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.concatenate_metrics": [[232, 252], ["metaseg_io.metrics_load", "range", "print", "print", "print", "metaseg_io.metaseg.get", "sys.stdout.write", "metaseg_io.metrics_load", "len", "numpy.sum", "metaseg_io.metrics_dump", "metaseg_io.metaseg.get", "numpy.asarray"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_load", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_load", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.metrics_dump", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "concatenate_metrics", "(", "save", "=", "False", ")", ":", "\n", "\n", "  ", "metrics", "=", "metrics_load", "(", "0", ")", "\n", "\n", "for", "i", "in", "range", "(", "1", ",", "metaseg", ".", "get", "(", "\"NUM_IMAGES\"", ")", ")", ":", "\n", "    ", "sys", ".", "stdout", ".", "write", "(", "\"\\t concatenated file number {} / {}\\r\"", ".", "format", "(", "i", "+", "1", ",", "metaseg", ".", "get", "(", "\"NUM_IMAGES\"", ")", ")", ")", "\n", "\n", "m", "=", "metrics_load", "(", "i", ")", "\n", "\n", "for", "j", "in", "metrics", ":", "\n", "      ", "metrics", "[", "j", "]", "+=", "m", "[", "j", "]", "\n", "\n", "", "", "print", "(", "\" \"", ")", "\n", "print", "(", "\"connected components:\"", ",", "len", "(", "metrics", "[", "'iou'", "]", ")", ")", "\n", "print", "(", "\"non-empty connected components:\"", ",", "np", ".", "sum", "(", "np", ".", "asarray", "(", "metrics", "[", "'S_in'", "]", ")", "!=", "0", ")", ")", "\n", "\n", "if", "(", "save", "==", "True", ")", ":", "\n", "    ", "metrics_dump", "(", "metrics", ",", "\"_all\"", ")", "\n", "\n", "", "return", "metrics", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.compute_metrics_per_image": [[255, 268], ["metaseg_io.metaseg.get", "print", "multiprocessing.Pool", "multiprocessing.Pool.starmap", "metaseg_eval.concatenate_metrics", "range", "metaseg_io.metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.concatenate_metrics", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "compute_metrics_per_image", "(", ")", ":", "\n", "\n", "  ", "num_cores", "=", "metaseg", ".", "get", "(", "\"NUM_CORES\"", ")", "\n", "\n", "print", "(", "\"calculating statistics\"", ")", "\n", "\n", "p", "=", "Pool", "(", "num_cores", ")", "\n", "\n", "p_args", "=", "[", "(", "k", ",", ")", "for", "k", "in", "range", "(", "metaseg", ".", "get", "(", "\"NUM_IMAGES\"", ")", ")", "]", "\n", "\n", "p", ".", "starmap", "(", "compute_metrics_i", ",", "p_args", ")", "\n", "\n", "concatenate_metrics", "(", "save", "=", "True", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.adjusted_r2": [[271, 274], ["None"], "function", ["None"], ["", "def", "adjusted_r2", "(", "r2", ",", "num_dof", ",", "num_samples", ")", ":", "\n", "\n", "  ", "return", "1", "-", "(", "1", "-", "r2", ")", "*", "(", "num_samples", "-", "1", ")", "/", "(", "num_samples", "-", "num_dof", "-", "1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.fit_model_run": [[277, 412], ["print", "numpy.random.seed", "numpy.zeros", "range", "numpy.argmax", "best_lm.predict", "best_lm.predict", "range", "sklearn.linear_model.LogisticRegression", "linear_model.LogisticRegression.fit", "linear_model.LogisticRegression.score", "linear_model.LogisticRegression.score", "linear_model.LogisticRegression.predict_proba", "sklearn.metrics.roc_curve", "sklearn.metrics.auc", "linear_model.LogisticRegression.predict_proba", "sklearn.metrics.roc_curve", "sklearn.metrics.auc", "Xa_val.copy", "ya_val.copy", "Xa_train.copy", "ya_train.copy", "sklearn.linear_model.LinearRegression", "linear_model.LinearRegression.fit", "linear_model.LinearRegression.predict", "linear_model.LinearRegression.predict", "numpy.sqrt", "sklearn.metrics.r2_score", "numpy.sqrt", "sklearn.metrics.r2_score", "sklearn.linear_model.LinearRegression", "linear_model.LinearRegression.fit", "linear_model.LinearRegression.predict", "linear_model.LinearRegression.predict", "numpy.sqrt", "sklearn.metrics.r2_score", "numpy.sqrt", "sklearn.metrics.r2_score", "numpy.asarray", "numpy.random.rand", "len", "sklearn.linear_model.LogisticRegression", "linear_model.LogisticRegression.fit", "linear_model.LogisticRegression.score", "linear_model.LogisticRegression.score", "print", "print", "linear_model.LogisticRegression.predict_proba", "sklearn.metrics.roc_curve", "sklearn.metrics.auc", "linear_model.LogisticRegression.predict_proba", "sklearn.metrics.roc_curve", "sklearn.metrics.auc", "numpy.asarray", "print", "len", "Xa_train[].reshape", "Xa_val[].reshape", "Xa_train[].reshape", "Xa_val[].reshape", "Xa_train[].reshape", "best_lm.predict_proba", "metaseg_plot.plot_roc_curve", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "numpy.sum", "sklearn.metrics.mean_squared_error", "sklearn.metrics.mean_squared_error", "X2_train[].reshape", "X2_val[].reshape", "X2_train[].reshape", "sklearn.metrics.mean_squared_error", "sklearn.metrics.mean_squared_error", "metaseg_plot.plot_regression", "len", "numpy.logical_not", "numpy.logical_not", "numpy.logical_not", "len", "numpy.sum", "sklearn.linear_model.LogisticRegression", "linear_model.LogisticRegression.fit", "linear_model.LogisticRegression.score", "linear_model.LogisticRegression.score", "linear_model.LogisticRegression.predict_proba", "sklearn.metrics.roc_curve", "sklearn.metrics.auc", "linear_model.LogisticRegression.predict_proba", "sklearn.metrics.roc_curve", "sklearn.metrics.auc", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "numpy.logical_and", "metaseg_io.metaseg.get", "range", "numpy.abs", "str", "len", "numpy.abs", "numpy.abs", "numpy.abs", "numpy.abs", "numpy.abs", "numpy.abs"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.plot_roc_curve", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.plot_regression", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "fit_model_run", "(", "Xa", ",", "ya", ",", "y0a", ",", "alphas", ",", "X_names", ",", "stats", ",", "run", ")", ":", "\n", "\n", "  ", "print", "(", "\"run\"", ",", "run", ")", "\n", "\n", "np", ".", "random", ".", "seed", "(", "run", ")", "\n", "\n", "val_mask", "=", "np", ".", "random", ".", "rand", "(", "len", "(", "ya", ")", ")", "<", "3.0", "/", "6.0", "\n", "\n", "Xa_val", "=", "Xa", "[", "val_mask", "]", "\n", "ya_val", "=", "ya", "[", "val_mask", "]", "\n", "y0a_val", "=", "y0a", "[", "val_mask", "]", "\n", "\n", "Xa_train", "=", "Xa", "[", "np", ".", "logical_not", "(", "val_mask", ")", "]", "\n", "ya_train", "=", "ya", "[", "np", ".", "logical_not", "(", "val_mask", ")", "]", "\n", "y0a_train", "=", "y0a", "[", "np", ".", "logical_not", "(", "val_mask", ")", "]", "\n", "\n", "coefs", "=", "np", ".", "zeros", "(", "(", "len", "(", "alphas", ")", ",", "Xa", ".", "shape", "[", "1", "]", ")", ")", "\n", "\n", "max_acc", "=", "0", "\n", "best_lm", "=", "[", "]", "\n", "\n", "for", "i", "in", "range", "(", "len", "(", "alphas", ")", ")", ":", "\n", "    ", "lm", "=", "linear_model", ".", "LogisticRegression", "(", "C", "=", "alphas", "[", "i", "]", ",", "penalty", "=", "'l1'", ",", "solver", "=", "'saga'", ",", "max_iter", "=", "1000", ",", "tol", "=", "1e-3", ")", "#, class_weight='balanced')", "\n", "lm", ".", "fit", "(", "Xa_train", ",", "y0a_train", ")", "\n", "\n", "stats", "[", "'penalized_val_acc'", "]", "[", "run", ",", "i", "]", "=", "lm", ".", "score", "(", "Xa_val", ",", "y0a_val", ")", "\n", "stats", "[", "'penalized_train_acc'", "]", "[", "run", ",", "i", "]", "=", "lm", ".", "score", "(", "Xa_train", ",", "y0a_train", ")", "\n", "\n", "if", "stats", "[", "'penalized_val_acc'", "]", "[", "run", ",", "i", "]", ">", "max_acc", ":", "\n", "      ", "max_acc", "=", "stats", "[", "'penalized_val_acc'", "]", "[", "run", ",", "i", "]", "\n", "best_lm", "=", "lm", "\n", "\n", "", "print", "(", "\"step\"", "+", "str", "(", "i", ")", "+", "\", alpha={:.2E}\"", ".", "format", "(", "alphas", "[", "i", "]", ")", "+", "\", val. acc.: {:.2f}%\"", ".", "format", "(", "100", "*", "stats", "[", "'penalized_val_acc'", "]", "[", "run", ",", "i", "]", ")", ",", "end", "=", "\", \"", ")", "\n", "print", "(", "\"coefs non-zero:\"", ",", "end", "=", "\" \"", ")", "\n", "\n", "metapr", "=", "lm", ".", "predict_proba", "(", "Xa_val", ")", "\n", "fpr", ",", "tpr", ",", "_", "=", "roc_curve", "(", "y0a_val", ",", "metapr", "[", ":", ",", "1", "]", ")", "\n", "stats", "[", "'penalized_val_auroc'", "]", "[", "run", ",", "i", "]", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "\n", "metapr_t", "=", "lm", ".", "predict_proba", "(", "Xa_train", ")", "\n", "fpr", ",", "tpr", ",", "_", "=", "roc_curve", "(", "y0a_train", ",", "metapr_t", "[", ":", ",", "1", "]", ")", "\n", "stats", "[", "'penalized_train_auroc'", "]", "[", "run", ",", "i", "]", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "\n", "coefs", "[", "i", "]", "=", "np", ".", "asarray", "(", "lm", ".", "coef_", "[", "0", "]", ")", "\n", "print", "(", "[", "j", "for", "j", "in", "range", "(", "len", "(", "coefs", "[", "i", "]", ")", ")", "if", "np", ".", "abs", "(", "coefs", "[", "i", ",", "j", "]", ")", ">", "1e-6", "]", ")", "\n", "\n", "if", "np", ".", "sum", "(", "np", ".", "abs", "(", "coefs", "[", "i", "]", ")", ">", "1e-6", ")", ">", "0", ":", "\n", "      ", "lm2", "=", "linear_model", ".", "LogisticRegression", "(", "penalty", "=", "None", ",", "solver", "=", "'saga'", ",", "max_iter", "=", "1000", ",", "tol", "=", "1e-3", ")", "#, class_weight='balanced')", "\n", "lm2", ".", "fit", "(", "Xa_train", "[", ":", ",", "np", ".", "abs", "(", "coefs", "[", "i", "]", ")", ">", "1e-6", "]", ",", "y0a_train", ")", "\n", "\n", "stats", "[", "'plain_val_acc'", "]", "[", "run", ",", "i", "]", "=", "lm2", ".", "score", "(", "Xa_val", "[", ":", ",", "np", ".", "abs", "(", "coefs", "[", "i", "]", ")", ">", "1e-6", "]", ",", "y0a_val", ")", "\n", "stats", "[", "'plain_train_acc'", "]", "[", "run", ",", "i", "]", "=", "lm2", ".", "score", "(", "Xa_train", "[", ":", ",", "np", ".", "abs", "(", "coefs", "[", "i", "]", ")", ">", "1e-6", "]", ",", "y0a_train", ")", "\n", "\n", "metapr", "=", "lm2", ".", "predict_proba", "(", "Xa_val", "[", ":", ",", "np", ".", "abs", "(", "coefs", "[", "i", "]", ")", ">", "1e-6", "]", ")", "\n", "fpr", ",", "tpr", ",", "_", "=", "roc_curve", "(", "y0a_val", ",", "metapr", "[", ":", ",", "1", "]", ")", "\n", "stats", "[", "'plain_val_auroc'", "]", "[", "run", ",", "i", "]", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "\n", "metapr_t", "=", "lm2", ".", "predict_proba", "(", "Xa_train", "[", ":", ",", "np", ".", "abs", "(", "coefs", "[", "i", "]", ")", ">", "1e-6", "]", ")", "\n", "fpr", ",", "tpr", ",", "_", "=", "roc_curve", "(", "y0a_train", ",", "metapr_t", "[", ":", ",", "1", "]", ")", "\n", "stats", "[", "'plain_train_auroc'", "]", "[", "run", ",", "i", "]", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "", "else", ":", "\n", "      ", "stats", "[", "'plain_val_acc'", "]", "[", "run", ",", "i", "]", "=", "stats", "[", "'penalized_val_acc'", "]", "[", "run", ",", "i", "]", "\n", "stats", "[", "'plain_train_acc'", "]", "[", "run", ",", "i", "]", "=", "stats", "[", "'penalized_train_acc'", "]", "[", "run", ",", "i", "]", "\n", "\n", "stats", "[", "'plain_val_auroc'", "]", "[", "run", ",", "i", "]", "=", "stats", "[", "'penalized_val_auroc'", "]", "[", "run", ",", "i", "]", "\n", "stats", "[", "'plain_train_auroc'", "]", "[", "run", ",", "i", "]", "=", "stats", "[", "'penalized_train_auroc'", "]", "[", "run", ",", "i", "]", "\n", "\n", "\n", "", "", "max_acc", "=", "np", ".", "argmax", "(", "stats", "[", "'penalized_val_acc'", "]", "[", "run", "]", ")", "\n", "\n", "ypred", "=", "best_lm", ".", "predict", "(", "Xa_val", ")", "\n", "ypred_t", "=", "best_lm", ".", "predict", "(", "Xa_train", ")", "\n", "\n", "E_ind", "=", "0", "\n", "for", "E_ind", "in", "range", "(", "len", "(", "X_names", ")", ")", ":", "\n", "    ", "if", "X_names", "[", "E_ind", "]", "==", "\"E\"", ":", "\n", "      ", "break", "\n", "\n", "", "", "lme", "=", "linear_model", ".", "LogisticRegression", "(", "penalty", "=", "None", ",", "solver", "=", "'saga'", ")", "\n", "lme", ".", "fit", "(", "Xa_train", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "Xa_train", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ",", "y0a_train", ")", "\n", "\n", "stats", "[", "'entropy_val_acc'", "]", "[", "run", "]", "=", "lme", ".", "score", "(", "Xa_val", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "Xa_val", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ",", "y0a_val", ")", "\n", "stats", "[", "'entropy_train_acc'", "]", "[", "run", "]", "=", "lme", ".", "score", "(", "Xa_train", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "Xa_train", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ",", "y0a_train", ")", "\n", "\n", "metapr", "=", "lme", ".", "predict_proba", "(", "Xa_val", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "Xa_val", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ")", "\n", "fpr", ",", "tpr", ",", "_", "=", "roc_curve", "(", "y0a_val", ",", "metapr", "[", ":", ",", "1", "]", ")", "\n", "stats", "[", "'entropy_val_auroc'", "]", "[", "run", "]", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "\n", "metapr", "=", "lme", ".", "predict_proba", "(", "Xa_train", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "Xa_train", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ")", "\n", "fpr", ",", "tpr", ",", "_", "=", "roc_curve", "(", "y0a_train", ",", "metapr", "[", ":", ",", "1", "]", ")", "\n", "stats", "[", "'entropy_train_auroc'", "]", "[", "run", "]", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "\n", "if", "run", "==", "0", ":", "\n", "    ", "metapr", "=", "best_lm", ".", "predict_proba", "(", "Xa_val", ")", "\n", "plot_roc_curve", "(", "y0a_val", ",", "metapr", "[", ":", ",", "1", "]", ",", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'roccurve.pdf'", ")", "\n", "\n", "", "stats", "[", "'iou0_found'", "]", "[", "run", "]", "=", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred", "==", "1", ",", "y0a_val", "==", "1", ")", ")", "+", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred_t", "==", "1", ",", "y0a_train", "==", "1", ")", ")", "\n", "stats", "[", "'iou0_not_found'", "]", "[", "run", "]", "=", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred", "==", "0", ",", "y0a_val", "==", "1", ")", ")", "+", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred_t", "==", "0", ",", "y0a_train", "==", "1", ")", ")", "\n", "stats", "[", "'not_iou0_found'", "]", "[", "run", "]", "=", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred", "==", "0", ",", "y0a_val", "==", "0", ")", ")", "+", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred_t", "==", "0", ",", "y0a_train", "==", "0", ")", ")", "\n", "stats", "[", "'not_iou0_not_found'", "]", "[", "run", "]", "=", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred", "==", "1", ",", "y0a_val", "==", "0", ")", ")", "+", "np", ".", "sum", "(", "np", ".", "logical_and", "(", "ypred_t", "==", "1", ",", "y0a_train", "==", "0", ")", ")", "\n", "\n", "\n", "X2_train", "=", "Xa_val", ".", "copy", "(", ")", "\n", "y2_train", "=", "ya_val", ".", "copy", "(", ")", "\n", "X2_val", "=", "Xa_train", ".", "copy", "(", ")", "\n", "y2_val", "=", "ya_train", ".", "copy", "(", ")", "\n", "\n", "lmr", "=", "linear_model", ".", "LinearRegression", "(", ")", "\n", "lmr", ".", "fit", "(", "X2_train", ",", "y2_train", ")", "\n", "y2_pred", "=", "lmr", ".", "predict", "(", "X2_val", ")", "\n", "y2_pred_t", "=", "lmr", ".", "predict", "(", "X2_train", ")", "\n", "\n", "stats", "[", "'regr_val_mse'", "]", "[", "run", "]", "=", "np", ".", "sqrt", "(", "mean_squared_error", "(", "y2_val", ",", "y2_pred", ")", ")", "\n", "stats", "[", "'regr_val_r2'", "]", "[", "run", "]", "=", "r2_score", "(", "y2_val", ",", "y2_pred", ")", "\n", "stats", "[", "'regr_train_mse'", "]", "[", "run", "]", "=", "np", ".", "sqrt", "(", "mean_squared_error", "(", "y2_train", ",", "y2_pred_t", ")", ")", "\n", "stats", "[", "'regr_train_r2'", "]", "[", "run", "]", "=", "r2_score", "(", "y2_train", ",", "y2_pred_t", ")", "\n", "\n", "lmer", "=", "linear_model", ".", "LinearRegression", "(", ")", "\n", "lmer", ".", "fit", "(", "X2_train", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "X2_train", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ",", "y2_train", ")", "\n", "y2e_pred", "=", "lmer", ".", "predict", "(", "X2_val", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "X2_val", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ")", "\n", "y2e_pred_t", "=", "lmer", ".", "predict", "(", "X2_train", "[", ":", ",", "E_ind", "]", ".", "reshape", "(", "(", "X2_train", ".", "shape", "[", "0", "]", ",", "1", ")", ")", ")", "\n", "\n", "stats", "[", "'entropy_regr_val_mse'", "]", "[", "run", "]", "=", "np", ".", "sqrt", "(", "mean_squared_error", "(", "y2_val", ",", "y2e_pred", ")", ")", "\n", "stats", "[", "'entropy_regr_val_r2'", "]", "[", "run", "]", "=", "r2_score", "(", "y2_val", ",", "y2e_pred", ")", "\n", "stats", "[", "'entropy_regr_train_mse'", "]", "[", "run", "]", "=", "np", ".", "sqrt", "(", "mean_squared_error", "(", "y2_train", ",", "y2e_pred_t", ")", ")", "\n", "stats", "[", "'entropy_regr_train_r2'", "]", "[", "run", "]", "=", "r2_score", "(", "y2_train", ",", "y2e_pred_t", ")", "\n", "\n", "stats", "[", "'coefs'", "]", "[", "run", "]", "=", "np", ".", "asarray", "(", "coefs", ")", "\n", "\n", "\n", "if", "run", "==", "0", ":", "\n", "\n", "    ", "plot_regression", "(", "X2_val", ",", "y2_val", ",", "y2_pred", ",", "ya_val", ",", "ypred", ",", "X_names", ")", "\n", "\n", "", "return", "stats", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.compute_correlations": [[415, 435], ["pandas.DataFrame", "df_full.copy().drop.copy().drop", "df_full.copy().drop.copy", "metaseg_plot.make_scatterplots", "print", "print", "metaseg_eval.metrics_to_nparray", "print", "print", "print", "df_full.copy().drop.copy().drop", "df_full.copy().drop.corr", "numpy.sum", "numpy.sum", "df_full.copy().drop.copy", "df_full.copy().drop.copy", "df_full.copy().drop.copy", "df_full[].nonzero"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.make_scatterplots", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_nparray"], ["", "def", "compute_correlations", "(", "metrics", ")", ":", "\n", "\n", "  ", "pd", ".", "options", ".", "display", ".", "float_format", "=", "'{:,.5f}'", ".", "format", "\n", "\n", "df_full", "=", "pd", ".", "DataFrame", "(", "data", "=", "metrics", ")", "\n", "df_full", "=", "df_full", ".", "copy", "(", ")", ".", "drop", "(", "[", "\"class\"", ",", "\"iou0\"", "]", ",", "axis", "=", "1", ")", "\n", "features", "=", "df_full", ".", "copy", "(", ")", ".", "drop", "(", "[", "\"iou\"", "]", ",", "axis", "=", "1", ")", ".", "columns", "\n", "df_all", "=", "df_full", ".", "copy", "(", ")", "\n", "df_full", "=", "df_full", ".", "copy", "(", ")", ".", "loc", "[", "df_full", "[", "'S_in'", "]", ".", "nonzero", "(", ")", "[", "0", "]", "]", "\n", "make_scatterplots", "(", "\"../\"", ",", "df_full", ",", "df_full", ")", "\n", "iou_corrs", "=", "df_full", ".", "corr", "(", ")", "[", "\"iou\"", "]", "\n", "print", "(", "\"\\n\\ncorrelations with iou (only non_empty in)\"", ")", "\n", "print", "(", "iou_corrs", ")", "\n", "\n", "y0a", "=", "metrics_to_nparray", "(", "metrics", ",", "[", "\"iou0\"", "]", ",", "normalize", "=", "False", ",", "non_empty", "=", "True", ")", "\n", "print", "(", "\" \"", ")", "\n", "print", "(", "\"IoU=0:\"", ",", "np", ".", "sum", "(", "y0a", "==", "1", ")", ",", "\"of\"", ",", "y0a", ".", "shape", "[", "0", "]", ")", "\n", "print", "(", "\"IoU>0:\"", ",", "np", ".", "sum", "(", "y0a", "==", "0", ")", ",", "\"of\"", ",", "y0a", ".", "shape", "[", "0", "]", ")", "\n", "\n", "return", "iou_corrs", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.get_alphas": [[438, 444], ["scipy.interpolate.interp1d", "scipy.interpolate.interp1d.item", "range", "scipy.interpolate.interp1d."], "function", ["None"], ["", "def", "get_alphas", "(", "n_steps", ",", "min_pow", ",", "max_pow", ")", ":", "\n", "\n", "  ", "m", "=", "interp1d", "(", "[", "0", ",", "n_steps", "-", "1", "]", ",", "[", "min_pow", ",", "max_pow", "]", ")", "\n", "alphas", "=", "[", "10", "**", "m", "(", "i", ")", ".", "item", "(", ")", "for", "i", "in", "range", "(", "n_steps", ")", "]", "\n", "\n", "return", "alphas", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.init_stats": [[447, 473], ["len", "len", "dict", "numpy.zeros", "numpy.zeros", "numpy.ones"], "function", ["None"], ["", "def", "init_stats", "(", "n_av", ",", "alphas", ",", "X_names", ")", ":", "\n", "\n", "  ", "n_steps", "=", "len", "(", "alphas", ")", "\n", "n_metrics", "=", "len", "(", "X_names", ")", "\n", "stats", "=", "dict", "(", "{", "}", ")", "\n", "\n", "per_alphas_av_stats", "=", "[", "'penalized_val_acc'", ",", "'penalized_val_auroc'", ",", "'penalized_train_acc'", ",", "'penalized_train_auroc'", ",", "'plain_val_acc'", ",", "'plain_val_auroc'", ",", "'plain_train_acc'", ",", "'plain_train_auroc'", ",", "'coefs'", "]", "\n", "per_av_stats", "=", "[", "'entropy_val_acc'", ",", "'entropy_val_auroc'", ",", "'entropy_train_acc'", ",", "'entropy_train_auroc'", ",", "'regr_val_mse'", ",", "'regr_val_r2'", ",", "'regr_train_mse'", ",", "'regr_train_r2'", ",", "'entropy_regr_val_mse'", ",", "'entropy_regr_val_r2'", ",", "'entropy_regr_train_mse'", ",", "'entropy_regr_train_r2'", ",", "'iou0_found'", ",", "'iou0_not_found'", ",", "'not_iou0_found'", ",", "'not_iou0_not_found'", "]", "\n", "\n", "for", "s", "in", "per_alphas_av_stats", ":", "\n", "    ", "stats", "[", "s", "]", "=", "0.5", "*", "np", ".", "ones", "(", "(", "n_av", ",", "n_steps", ")", ")", "\n", "\n", "", "for", "s", "in", "per_av_stats", ":", "\n", "    ", "stats", "[", "s", "]", "=", "np", ".", "zeros", "(", "(", "n_av", ",", ")", ")", "\n", "\n", "", "stats", "[", "\"coefs\"", "]", "=", "np", ".", "zeros", "(", "(", "n_av", ",", "n_steps", ",", "n_metrics", ")", ")", "\n", "stats", "[", "\"alphas\"", "]", "=", "alphas", "\n", "stats", "[", "\"n_av\"", "]", "=", "n_av", "\n", "stats", "[", "\"n_metrics\"", "]", "=", "n_metrics", "\n", "stats", "[", "\"metric_names\"", "]", "=", "X_names", "\n", "\n", "return", "stats", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.merge_stats": [[476, 484], ["range"], "function", ["None"], ["", "def", "merge_stats", "(", "stats", ",", "single_run_stats", ",", "n_av", ")", ":", "\n", "\n", "  ", "for", "run", "in", "range", "(", "n_av", ")", ":", "\n", "    ", "for", "s", "in", "stats", ":", "\n", "      ", "if", "s", "not", "in", "[", "\"alphas\"", ",", "\"n_av\"", ",", "\"n_metrics\"", ",", "\"metric_names\"", "]", ":", "\n", "        ", "stats", "[", "s", "]", "[", "run", "]", "=", "single_run_stats", "[", "run", "]", "[", "s", "]", "[", "run", "]", "\n", "\n", "", "", "", "return", "stats", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.dump_stats": [[487, 576], ["metaseg_eval.compute_correlations", "metaseg_eval.metrics_to_nparray", "dict", "dict", "numpy.argmax", "numpy.argmax", "open", "print", "print", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "sorted", "print", "print", "print", "sorted", "print", "print", "print", "print", "metaseg_io.get_save_path_stats", "os.path.dirname", "pickle.dump", "numpy.mean", "numpy.std", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "numpy.sum", "numpy.sum", "len", "os.path.exists", "os.makedirs", "open", "metaseg_io.metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.compute_correlations", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_nparray", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_io.get_save_path_stats", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "dump_stats", "(", "stats", ",", "metrics", ")", ":", "\n", "\n", "  ", "iou_corrs", "=", "compute_correlations", "(", "metrics", ")", "\n", "y0a", "=", "metrics_to_nparray", "(", "metrics", ",", "[", "\"iou0\"", "]", ",", "normalize", "=", "False", ",", "non_empty", "=", "True", ")", "\n", "\n", "mean_stats", "=", "dict", "(", "{", "}", ")", "\n", "std_stats", "=", "dict", "(", "{", "}", ")", "\n", "\n", "for", "s", "in", "stats", ":", "\n", "    ", "if", "s", "not", "in", "[", "\"alphas\"", ",", "\"n_av\"", ",", "\"n_metrics\"", ",", "\"metric_names\"", "]", ":", "\n", "      ", "mean_stats", "[", "s", "]", "=", "np", ".", "mean", "(", "stats", "[", "s", "]", ",", "axis", "=", "0", ")", "\n", "std_stats", "[", "s", "]", "=", "np", ".", "std", "(", "stats", "[", "s", "]", ",", "axis", "=", "0", ")", "\n", "\n", "", "", "best_pen_ind", "=", "np", ".", "argmax", "(", "mean_stats", "[", "'penalized_val_acc'", "]", ")", "\n", "best_plain_ind", "=", "np", ".", "argmax", "(", "mean_stats", "[", "'plain_val_acc'", "]", ")", "\n", "\n", "# dump stats latex ready", "\n", "with", "open", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'av_results.txt'", ",", "'wt'", ")", "as", "f", ":", "\n", "\n", "    ", "print", "(", "iou_corrs", ",", "file", "=", "f", ")", "\n", "print", "(", "\" \"", ",", "file", "=", "f", ")", "\n", "\n", "print", "(", "\"classification\"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"                             & train                &  val                 &    \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'penalized'", "in", "s", "and", "'acc'", "in", "s", "]", ")", "\n", "print", "(", "\"ACC penalized               \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'plain'", "in", "s", "and", "'acc'", "in", "s", "]", ")", "\n", "print", "(", "\"ACC unpenalized             \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'entropy'", "in", "s", "and", "'acc'", "in", "s", "]", ")", "\n", "print", "(", "\"ACC entropy baseline        \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'penalized'", "in", "s", "and", "'auroc'", "in", "s", "]", ")", "\n", "print", "(", "\"AUROC penalized             \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'plain'", "in", "s", "and", "'auroc'", "in", "s", "]", ")", "\n", "print", "(", "\"AUROC unpenalized           \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", "[", "best_pen_ind", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'entropy'", "in", "s", "and", "'auroc'", "in", "s", "]", ")", "\n", "print", "(", "\"AUROC entropy baseline      \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "\n", "print", "(", "\" \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"regression\"", ",", "file", "=", "f", ")", "\n", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'regr'", "in", "s", "and", "'mse'", "in", "s", "and", "'entropy'", "not", "in", "s", "]", ")", "\n", "print", "(", "\"$\\sigma$, all metrics       \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.3f}\"", ".", "format", "(", "mean_stats", "[", "s", "]", ")", "+", "\"(\\pm{:.3f})$\"", ".", "format", "(", "std_stats", "[", "s", "]", ")", ",", "end", "=", "\"    & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'regr'", "in", "s", "and", "'mse'", "in", "s", "and", "'entropy'", "in", "s", "]", ")", "\n", "print", "(", "\"$\\sigma$, entropy baseline  \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.3f}\"", ".", "format", "(", "mean_stats", "[", "s", "]", ")", "+", "\"(\\pm{:.3f})$\"", ".", "format", "(", "std_stats", "[", "s", "]", ")", ",", "end", "=", "\"    & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'regr'", "in", "s", "and", "'r2'", "in", "s", "and", "'entropy'", "not", "in", "s", "]", ")", "\n", "print", "(", "\"$R^2$, all metrics          \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'regr'", "in", "s", "and", "'r2'", "in", "s", "and", "'entropy'", "in", "s", "]", ")", "\n", "print", "(", "\"$R^2$, entropy baseline     \"", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "\"${:.2f}\\%\"", ".", "format", "(", "100", "*", "mean_stats", "[", "s", "]", ")", "+", "\"(\\pm{:.2f}\\%)$\"", ".", "format", "(", "100", "*", "std_stats", "[", "s", "]", ")", ",", "end", "=", "\" & \"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"   \\\\\\\\ \"", ",", "file", "=", "f", ")", "\n", "\n", "print", "(", "\" \"", ",", "file", "=", "f", ")", "\n", "M", "=", "sorted", "(", "[", "s", "for", "s", "in", "mean_stats", "if", "'iou'", "in", "s", "]", ")", "\n", "for", "s", "in", "M", ":", "print", "(", "s", ",", "\": {:.0f}\"", ".", "format", "(", "mean_stats", "[", "s", "]", ")", "+", "\"($\\pm${:.0f})\"", ".", "format", "(", "std_stats", "[", "s", "]", ")", ",", "file", "=", "f", ")", "\n", "print", "(", "\"IoU=0:\"", ",", "np", ".", "sum", "(", "y0a", "==", "1", ")", ",", "\"of\"", ",", "y0a", ".", "shape", "[", "0", "]", ",", "\"non-empty components\"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"IoU>0:\"", ",", "np", ".", "sum", "(", "y0a", "==", "0", ")", ",", "\"of\"", ",", "y0a", ".", "shape", "[", "0", "]", ",", "\"non-empty components\"", ",", "file", "=", "f", ")", "\n", "print", "(", "\"total number of components: \"", ",", "len", "(", "metrics", "[", "'S'", "]", ")", ",", "file", "=", "f", ")", "\n", "print", "(", "\" \"", ",", "file", "=", "f", ")", "\n", "\n", "dump_path", "=", "get_save_path_stats", "(", ")", "\n", "dump_dir", "=", "os", ".", "path", ".", "dirname", "(", "dump_path", ")", "\n", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "dump_dir", ")", ":", "\n", "      ", "os", ".", "makedirs", "(", "dump_dir", ")", "\n", "\n", "", "pickle", ".", "dump", "(", "stats", ",", "open", "(", "dump_path", ",", "\"wb\"", ")", ")", "\n", "\n", "\n", "", "return", "mean_stats", ",", "std_stats", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_dataset": [[579, 598], ["sorted", "metaseg_eval.metrics_to_nparray", "metaseg_eval.metrics_to_nparray", "metaseg_eval.metrics_to_nparray", "metaseg_eval.metrics_to_nparray", "metaseg_io.metaseg.get", "metaseg_io.metaseg.get", "metaseg_eval.classes_to_categorical", "metaseg_io.metaseg.get", "metaseg_io.metaseg.get", "metaseg_io.metaseg.get", "str", "range", "metaseg_io.metaseg.get", "str"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_nparray", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_nparray", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_nparray", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_nparray", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.classes_to_categorical", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "metrics_to_dataset", "(", "metrics", ",", "nclasses", ",", "non_empty", "=", "True", ",", "all_metrics", "=", "[", "]", ")", ":", "\n", "\n", "  ", "class_names", "=", "[", "]", "\n", "X_names", "=", "sorted", "(", "[", "m", "for", "m", "in", "metrics", "if", "m", "not", "in", "[", "\"class\"", ",", "\"iou\"", ",", "\"iou0\"", "]", "and", "\"cprob\"", "not", "in", "m", "]", ")", "\n", "\n", "if", "metaseg", ".", "get", "(", "\"CLASS_DTYPE\"", ")", "==", "metaseg", ".", "get", "(", "\"CLASS_DTYPES\"", ")", "[", "1", "]", ":", "\n", "    ", "class_names", "=", "[", "\"cprob\"", "+", "str", "(", "i", ")", "for", "i", "in", "range", "(", "nclasses", ")", "if", "\"cprob\"", "+", "str", "(", "i", ")", "in", "metrics", "]", "\n", "", "elif", "metaseg", ".", "get", "(", "\"CLASS_DTYPE\"", ")", "==", "metaseg", ".", "get", "(", "\"CLASS_DTYPES\"", ")", "[", "0", "]", ":", "\n", "    ", "class_names", "=", "[", "\"class\"", "]", "\n", "\n", "", "Xa", "=", "metrics_to_nparray", "(", "metrics", ",", "X_names", ",", "normalize", "=", "True", ",", "non_empty", "=", "non_empty", ",", "all_metrics", "=", "all_metrics", ")", "\n", "classes", "=", "metrics_to_nparray", "(", "metrics", ",", "class_names", ",", "normalize", "=", "True", ",", "non_empty", "=", "non_empty", ",", "all_metrics", "=", "all_metrics", ")", "\n", "ya", "=", "metrics_to_nparray", "(", "metrics", ",", "[", "\"iou\"", "]", ",", "normalize", "=", "False", ",", "non_empty", "=", "non_empty", ")", "\n", "y0a", "=", "metrics_to_nparray", "(", "metrics", ",", "[", "\"iou0\"", "]", ",", "normalize", "=", "False", ",", "non_empty", "=", "non_empty", ")", "\n", "\n", "if", "metaseg", ".", "get", "(", "\"CLASS_DTYPE\"", ")", "==", "metaseg", ".", "get", "(", "\"CLASS_DTYPES\"", ")", "[", "0", "]", ":", "\n", "    ", "classes", ",", "class_names", "=", "classes_to_categorical", "(", "classes", ",", "nclasses", ")", "\n", "\n", "", "return", "Xa", ",", "classes", ",", "ya", ",", "y0a", ",", "X_names", ",", "class_names", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.analyze_metrics": [[601, 628], ["metaseg_io.metaseg.get", "metaseg_io.metaseg.get", "min", "metaseg_eval.concatenate_metrics", "metaseg_eval.metrics_to_dataset", "numpy.concatenate", "metaseg_eval.get_alphas", "metaseg_eval.init_stats", "metaseg_eval.init_stats", "multiprocessing.Pool", "multiprocessing.Pool.starmap", "metaseg_eval.merge_stats", "metaseg_eval.dump_stats", "metaseg_plot.generate_lasso_plots", "metaseg_io.metaseg.get", "numpy.max", "range"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.concatenate_metrics", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.metrics_to_dataset", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.get_alphas", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.init_stats", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.init_stats", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.merge_stats", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_eval.dump_stats", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.generate_lasso_plots", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "analyze_metrics", "(", ")", ":", "\n", "\n", "  ", "n_av", "=", "metaseg", ".", "get", "(", "\"NUM_LASSO_AVERAGES\"", ")", "\n", "n_steps", "=", "metaseg", ".", "get", "(", "\"NUM_LASSO_LAMBDAS\"", ")", "\n", "num_cores", "=", "min", "(", "n_av", ",", "metaseg", ".", "get", "(", "\"NUM_CORES\"", ")", ")", "\n", "\n", "metrics", "=", "concatenate_metrics", "(", "save", "=", "False", ")", "\n", "nclasses", "=", "np", ".", "max", "(", "metrics", "[", "\"class\"", "]", ")", "+", "1", "\n", "\n", "Xa", ",", "classes", ",", "ya", ",", "y0a", ",", "X_names", ",", "class_names", "=", "metrics_to_dataset", "(", "metrics", ",", "nclasses", ")", "\n", "\n", "Xa", "=", "np", ".", "concatenate", "(", "(", "Xa", ",", "classes", ")", ",", "axis", "=", "-", "1", ")", "\n", "X_names", "+=", "class_names", "\n", "\n", "alphas", "=", "get_alphas", "(", "n_steps", ",", "min_pow", "=", "-", "4.2", ",", "max_pow", "=", "0.8", ")", "\n", "stats", "=", "init_stats", "(", "n_av", ",", "alphas", ",", "X_names", ")", "\n", "single_run_stats", "=", "init_stats", "(", "n_av", ",", "alphas", ",", "X_names", ")", "\n", "\n", "p", "=", "Pool", "(", "num_cores", ")", "\n", "p_args", "=", "[", "(", "Xa", ",", "ya", ",", "y0a", ",", "alphas", ",", "X_names", ",", "single_run_stats", ",", "run", ")", "for", "run", "in", "range", "(", "n_av", ")", "]", "\n", "single_run_stats", "=", "p", ".", "starmap", "(", "fit_model_run", ",", "p_args", ")", "\n", "\n", "stats", "=", "merge_stats", "(", "stats", ",", "single_run_stats", ",", "n_av", ")", "\n", "\n", "mean_stats", ",", "_", "=", "dump_stats", "(", "stats", ",", "metrics", ")", "\n", "\n", "generate_lasso_plots", "(", "stats", ",", "mean_stats", ",", "X_names", ",", "class_names", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou": [[14, 25], ["matplotlib.get_cmap", "scipy.stats.pearsonr", "matplotlib.title", "matplotlib.scatter", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.ylim", "matplotlib.xticks", "matplotlib.yticks", "plt.get_cmap.", "plt.get_cmap.", "numpy.max"], "function", ["None"], ["def", "add_scatterplot_vs_iou", "(", "ious", ",", "sizes", ",", "dataset", ",", "shortname", ",", "size_fac", ",", "scale", ",", "setylim", "=", "True", ")", ":", "\n", "\n", "  ", "cmap", "=", "plt", ".", "get_cmap", "(", "'tab20'", ")", "\n", "rho", "=", "pearsonr", "(", "ious", ",", "dataset", ")", "\n", "plt", ".", "title", "(", "r\"$\\rho = {:.05f}$\"", ".", "format", "(", "rho", "[", "0", "]", ")", ")", "\n", "plt", ".", "scatter", "(", "ious", ",", "dataset", ",", "s", "=", "sizes", "/", "np", ".", "max", "(", "sizes", ")", "*", "size_fac", ",", "linewidth", "=", ".5", ",", "c", "=", "cmap", "(", "0", ")", ",", "edgecolors", "=", "cmap", "(", "1", ")", ",", "alpha", "=", "0.25", ")", "#, edgecolor='black' c='#1f77b480'", "\n", "plt", ".", "xlabel", "(", "'$\\mathit{IoU}_\\mathrm{adj}$'", ",", "labelpad", "=", "-", "10", ")", "\n", "plt", ".", "ylabel", "(", "shortname", ",", "labelpad", "=", "-", "8", ")", "\n", "plt", ".", "ylim", "(", "-", ".05", ",", "1.05", ")", "\n", "plt", ".", "xticks", "(", "(", "0", ",", "1", ")", ",", "fontsize", "=", "10", "*", "scale", ")", "\n", "plt", ".", "yticks", "(", "(", "0", ",", "1", ")", ",", "fontsize", "=", "10", "*", "scale", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.make_scatterplots": [[28, 78], ["print", "print", "matplotlib.rc", "matplotlib.rc", "matplotlib.rc", "matplotlib.rc", "matplotlib.figure", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.subplot", "metaseg_plot.add_scatterplot_vs_iou", "matplotlib.tight_layout", "os.path.join", "matplotlib.savefig", "print", "metaseg_io.metaseg.get", "df_full[].max", "df_full_nei[].max", "df_full[].max", "df_full[].max", "df_full[].max", "df_full[].max", "df_full_nei[].max", "df_full_nei[].max", "df_full_nei[].max"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.add_scatterplot_vs_iou", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "make_scatterplots", "(", "save_dir", ",", "df_full", ",", "df_full_nei", ",", "filename", "=", "'iou_vs_ucm_allcls.png'", ")", ":", "\n", "# nei = only cc with non-empty interior", "\n", "\n", "  ", "print", "(", "\"\"", ")", "\n", "print", "(", "\"making iou scatterplots ...\"", ")", "\n", "scale", "=", ".75", "\n", "size_fac", "=", "50", "*", "scale", "\n", "\n", "os", ".", "environ", "[", "'PATH'", "]", "=", "os", ".", "environ", "[", "'PATH'", "]", "+", "':/Library/TeX/texbin'", "# for tex in matplotlib", "\n", "plt", ".", "rc", "(", "'font'", ",", "size", "=", "10", ",", "family", "=", "'serif'", ")", "\n", "plt", ".", "rc", "(", "'axes'", ",", "titlesize", "=", "10", ")", "\n", "plt", ".", "rc", "(", "'figure'", ",", "titlesize", "=", "10", "*", "scale", ")", "\n", "plt", ".", "rc", "(", "'text'", ",", "usetex", "=", "True", ")", "\n", "plt", ".", "figure", "(", "figsize", "=", "(", "9", "*", "scale", ",", "13", "*", "scale", ")", ",", "dpi", "=", "300", ")", "\n", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "1", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "df_full", "[", "'S'", "]", ",", "df_full", "[", "'E'", "]", ",", "\"$\\\\bar E$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "2", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "df_full", "[", "'S'", "]", ",", "df_full", "[", "'D'", "]", ",", "\"$\\\\bar D$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "3", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "1", ",", "df_full", "[", "'S'", "]", "/", "df_full", "[", "'S'", "]", ".", "max", "(", ")", ",", "\"$S/S_{max}$\"", ",", ".5", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "4", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full_nei", "[", "'iou'", "]", ",", "df_full_nei", "[", "'S'", "]", ",", "df_full_nei", "[", "'E_in'", "]", ",", "\"$\\\\bar E_{in}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "5", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full_nei", "[", "'iou'", "]", ",", "df_full_nei", "[", "'S'", "]", ",", "df_full_nei", "[", "'D_in'", "]", ",", "\"$\\\\bar D_{in}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "6", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full_nei", "[", "'iou'", "]", ",", "1", ",", "df_full_nei", "[", "'S_in'", "]", "/", "df_full_nei", "[", "'S_in'", "]", ".", "max", "(", ")", ",", "\"$S_{in}/S_{in,max}$\"", ",", ".5", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "7", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "df_full", "[", "'S'", "]", ",", "df_full", "[", "'E_bd'", "]", ",", "\"$\\\\bar E_{bd}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "8", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "df_full", "[", "'S'", "]", ",", "df_full", "[", "'D_bd'", "]", ",", "\"$\\\\bar D_{bd}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "9", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "1", ",", "df_full", "[", "'S_bd'", "]", "/", "df_full", "[", "'S_bd'", "]", ".", "max", "(", ")", ",", "\"$S_{bd}/S_{bd,max}$\"", ",", ".5", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "10", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "df_full", "[", "'S'", "]", ",", "df_full", "[", "'E_rel'", "]", "/", "df_full", "[", "'E_rel'", "]", ".", "max", "(", ")", ",", "\"$\\\\tilde{\\\\bar E}/\\\\tilde{\\\\bar E}_{max}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "11", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "df_full", "[", "'S'", "]", ",", "df_full", "[", "'D_rel'", "]", "/", "df_full", "[", "'D_rel'", "]", ".", "max", "(", ")", ",", "\"$\\\\tilde{\\\\bar D}/\\\\tilde{\\\\bar D}_{max}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "12", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full", "[", "'iou'", "]", ",", "1", ",", "df_full", "[", "'S_rel'", "]", "/", "df_full", "[", "'S_rel'", "]", ".", "max", "(", ")", ",", "\"$\\\\tilde{S}/\\\\tilde{S}_{max}$\"", ",", ".5", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "13", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full_nei", "[", "'iou'", "]", ",", "df_full_nei", "[", "'S'", "]", ",", "df_full_nei", "[", "'E_rel_in'", "]", "/", "df_full_nei", "[", "'E_rel_in'", "]", ".", "max", "(", ")", ",", "\"$\\\\tilde{\\\\bar E}_{in}/\\\\tilde{\\\\bar E}_{in,max}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "14", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full_nei", "[", "'iou'", "]", ",", "df_full_nei", "[", "'S'", "]", ",", "df_full_nei", "[", "'D_rel_in'", "]", "/", "df_full_nei", "[", "'D_rel_in'", "]", ".", "max", "(", ")", ",", "\"$\\\\tilde{\\\\bar D}_{in}/\\\\tilde{\\\\bar D}_{in,max}$\"", ",", "size_fac", ",", "scale", ")", "\n", "plt", ".", "subplot", "(", "5", ",", "3", ",", "15", ",", "aspect", "=", "'equal'", ")", "\n", "add_scatterplot_vs_iou", "(", "df_full_nei", "[", "'iou'", "]", ",", "1", ",", "df_full_nei", "[", "'S_rel_in'", "]", "/", "df_full_nei", "[", "'S_rel_in'", "]", ".", "max", "(", ")", ",", "\"$\\\\tilde{S}_{in}/\\\\tilde{S}_{in,max}$\"", ",", ".5", ",", "scale", ")", "\n", "\n", "plt", ".", "tight_layout", "(", "pad", "=", "1.0", "*", "scale", ",", "w_pad", "=", "0.5", "*", "scale", ",", "h_pad", "=", "1.5", "*", "scale", ")", "\n", "save_path", "=", "os", ".", "path", ".", "join", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", ",", "filename", ")", "\n", "plt", ".", "savefig", "(", "save_path", ")", "\n", "print", "(", "\"scatterplots saved to \"", "+", "save_path", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.plot_roc_curve": [[81, 106], ["sklearn.metrics.roc_curve", "sklearn.metrics.auc", "print", "matplotlib.figure", "matplotlib.plot", "matplotlib.plot", "matplotlib.xlim", "matplotlib.ylim", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.title", "matplotlib.legend", "os.path.dirname", "matplotlib.savefig", "print", "os.path.exists", "os.makedirs"], "function", ["None"], ["", "def", "plot_roc_curve", "(", "Y", ",", "probs", ",", "roc_path", ")", ":", "\n", "# roc curve", "\n", "  ", "fpr", ",", "tpr", ",", "_", "=", "roc_curve", "(", "Y", ",", "probs", ")", "\n", "roc_auc", "=", "auc", "(", "fpr", ",", "tpr", ")", "\n", "print", "(", "\"auc\"", ",", "roc_auc", ")", "\n", "plt", ".", "figure", "(", ")", "\n", "lw", "=", "2", "\n", "plt", ".", "plot", "(", "fpr", ",", "tpr", ",", "color", "=", "'red'", ",", "\n", "lw", "=", "lw", ",", "label", "=", "'ROC curve (area = %0.2f)'", "%", "roc_auc", ")", "\n", "plt", ".", "plot", "(", "[", "0", ",", "1", "]", ",", "[", "0", ",", "1", "]", ",", "color", "=", "'black'", ",", "lw", "=", "lw", ",", "linestyle", "=", "'--'", ")", "\n", "plt", ".", "xlim", "(", "[", "0.0", ",", "1.0", "]", ")", "\n", "plt", ".", "ylim", "(", "[", "0.0", ",", "1.05", "]", ")", "\n", "plt", ".", "xlabel", "(", "'False Positive Rate'", ")", "\n", "plt", ".", "ylabel", "(", "'True Positive Rate'", ")", "\n", "plt", ".", "title", "(", "'Receiver operating characteristic curve'", ")", "\n", "plt", ".", "legend", "(", "loc", "=", "\"lower right\"", ")", "\n", "\n", "roc_dir", "=", "os", ".", "path", ".", "dirname", "(", "roc_path", ")", "\n", "if", "not", "os", ".", "path", ".", "exists", "(", "roc_dir", ")", ":", "\n", "    ", "os", ".", "makedirs", "(", "roc_dir", ")", "\n", "\n", "", "plt", ".", "savefig", "(", "roc_path", ")", "\n", "print", "(", "\"roc curve saved to \"", "+", "roc_path", ")", "\n", "\n", "return", "roc_auc", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.name_to_latex": [[109, 134], ["range", "str", "str", "str", "str", "str"], "function", ["None"], ["", "def", "name_to_latex", "(", "name", ")", ":", "\n", "\n", "  ", "for", "i", "in", "range", "(", "100", ")", ":", "\n", "    ", "if", "name", "==", "\"cprob\"", "+", "str", "(", "i", ")", ":", "\n", "      ", "return", "\"$C_{\"", "+", "str", "(", "i", ")", "+", "\"}$\"", "\n", "\n", "", "", "mapping", "=", "{", "'E'", ":", "'$\\\\bar E$'", ",", "\n", "'E_bd'", ":", "'${\\\\bar E}_{bd}$'", ",", "\n", "'E_in'", ":", "'${\\\\bar E}_{in}$'", ",", "\n", "'E_rel_in'", ":", "'$\\\\tilde{\\\\bar E}_{in}$'", ",", "\n", "'E_rel'", ":", "'$\\\\tilde{\\\\bar E}$'", ",", "\n", "'D'", ":", "'$\\\\bar D$'", ",", "\n", "'D_bd'", ":", "'${\\\\bar D}_{bd}$'", ",", "\n", "'D_in'", ":", "'${\\\\bar D}_{in}$'", ",", "\n", "'D_rel_in'", ":", "'$\\\\tilde{\\\\bar D}_{in}$'", ",", "\n", "'D_rel'", ":", "'$\\\\tilde{\\\\bar D}$'", ",", "\n", "'S'", ":", "'$S$'", ",", "\n", "'S_bd'", ":", "'${S}_{bd}$'", ",", "\n", "'S_in'", ":", "'${S}_{in}$'", ",", "\n", "'S_rel_in'", ":", "'$\\\\tilde{S}_{in}$'", ",", "\n", "'S_rel'", ":", "'$\\\\tilde{S}$'", "}", "\n", "if", "str", "(", "name", ")", "in", "mapping", ":", "\n", "    ", "return", "mapping", "[", "str", "(", "name", ")", "]", "\n", "", "else", ":", "\n", "    ", "return", "str", "(", "name", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.generate_lasso_plots": [[137, 201], ["numpy.squeeze", "numpy.squeeze", "numpy.concatenate", "numpy.argmax", "matplotlib.get_cmap", "matplotlib.rc", "matplotlib.rc", "matplotlib.rc", "matplotlib.rc", "matplotlib.figure", "matplotlib.clf", "range", "matplotlib.ylim", "matplotlib.vlines", "matplotlib.legend", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.axis", "matplotlib.savefig", "matplotlib.clf", "range", "matplotlib.vlines", "matplotlib.legend", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.axis", "matplotlib.savefig", "matplotlib.clf", "matplotlib.semilogx", "matplotlib.semilogx", "matplotlib.semilogx", "matplotlib.ylim", "matplotlib.vlines", "matplotlib.legend", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.axis", "matplotlib.savefig", "matplotlib.clf", "matplotlib.semilogx", "matplotlib.semilogx", "matplotlib.semilogx", "matplotlib.ylim", "matplotlib.vlines", "matplotlib.legend", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.axis", "matplotlib.savefig", "len", "len", "matplotlib.semilogx", "matplotlib.semilogx", "numpy.max().reshape", "metaseg_io.metaseg.get", "metaseg_io.metaseg.get", "plt.get_cmap.", "plt.get_cmap.", "numpy.ones", "metaseg_io.metaseg.get", "plt.get_cmap.", "plt.get_cmap.", "numpy.ones", "metaseg_io.metaseg.get", "metaseg_plot.name_to_latex", "plt.get_cmap.", "plt.get_cmap.", "numpy.max", "len", "len", "numpy.abs", "str"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.name_to_latex"], ["", "", "def", "generate_lasso_plots", "(", "stats", ",", "mean_stats", ",", "X_names", ",", "class_names", ")", ":", "\n", "\n", "  ", "nc", "=", "len", "(", "X_names", ")", "-", "len", "(", "class_names", ")", "\n", "coefs", "=", "np", ".", "squeeze", "(", "stats", "[", "'coefs'", "]", "[", "0", ",", ":", ",", ":", "]", ")", "\n", "classcoefs", "=", "np", ".", "squeeze", "(", "stats", "[", "'coefs'", "]", "[", "0", ",", ":", ",", "nc", ":", "]", ")", "\n", "coefs", "=", "np", ".", "concatenate", "(", "[", "coefs", "[", ":", ",", "0", ":", "nc", "]", ",", "np", ".", "max", "(", "np", ".", "abs", "(", "coefs", "[", ":", ",", "nc", ":", "]", ")", ",", "axis", "=", "1", ")", ".", "reshape", "(", "(", "coefs", ".", "shape", "[", "0", "]", ",", "1", ")", ")", "]", ",", "axis", "=", "1", ")", "\n", "max_acc", "=", "np", ".", "argmax", "(", "stats", "[", "'penalized_val_acc'", "]", "[", "0", "]", ",", "axis", "=", "-", "1", ")", "\n", "alphas", "=", "stats", "[", "\"alphas\"", "]", "\n", "\n", "cmap", "=", "plt", ".", "get_cmap", "(", "'tab20'", ")", "\n", "figsize", "=", "(", "8.75", ",", "5.25", ")", "\n", "\n", "os", ".", "environ", "[", "'PATH'", "]", "=", "os", ".", "environ", "[", "'PATH'", "]", "+", "':/Library/TeX/texbin'", "# for tex in matplotlib", "\n", "plt", ".", "rc", "(", "'font'", ",", "size", "=", "10", ",", "family", "=", "'serif'", ")", "\n", "plt", ".", "rc", "(", "'axes'", ",", "titlesize", "=", "10", ")", "\n", "plt", ".", "rc", "(", "'figure'", ",", "titlesize", "=", "10", ")", "\n", "plt", ".", "rc", "(", "'text'", ",", "usetex", "=", "True", ")", "\n", "\n", "plot_names", "=", "X_names", "[", "0", ":", "nc", "]", "+", "[", "\"$C_p$\"", "]", "\n", "plt", ".", "figure", "(", "figsize", "=", "figsize", ")", "\n", "plt", ".", "clf", "(", ")", "\n", "for", "i", "in", "range", "(", "coefs", ".", "shape", "[", "1", "]", ")", ":", "\n", "    ", "plt", ".", "semilogx", "(", "alphas", ",", "coefs", "[", ":", ",", "i", "]", ",", "label", "=", "name_to_latex", "(", "plot_names", "[", "i", "]", ")", ",", "color", "=", "cmap", "(", "i", "/", "20", ")", ")", "\n", "", "ymin", ",", "ymax", "=", "plt", ".", "ylim", "(", ")", "\n", "plt", ".", "vlines", "(", "alphas", "[", "max_acc", "]", ",", "ymin", ",", "ymax", ",", "linestyle", "=", "'dashed'", ",", "linewidth", "=", "0.5", ",", "color", "=", "'grey'", ")", "\n", "legend", "=", "plt", ".", "legend", "(", "loc", "=", "'upper right'", ")", "\n", "plt", ".", "xlabel", "(", "'$\\lambda^{-1}$'", ")", "\n", "plt", ".", "ylabel", "(", "'coefficients $c_i$'", ")", "\n", "plt", ".", "axis", "(", "'tight'", ")", "\n", "plt", ".", "savefig", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'lasso1.pdf'", ",", "bbox_inches", "=", "'tight'", ")", "\n", "\n", "plt", ".", "clf", "(", ")", "\n", "for", "i", "in", "range", "(", "classcoefs", ".", "shape", "[", "1", "]", ")", ":", "\n", "    ", "plt", ".", "semilogx", "(", "alphas", ",", "classcoefs", "[", ":", ",", "i", "]", ",", "label", "=", "\"$C_{\"", "+", "str", "(", "i", ")", "+", "\"}$\"", ",", "color", "=", "cmap", "(", "i", "/", "20", ")", ")", "\n", "", "plt", ".", "vlines", "(", "alphas", "[", "max_acc", "]", ",", "ymin", ",", "ymax", ",", "linestyle", "=", "'dashed'", ",", "linewidth", "=", "0.5", ",", "color", "=", "'grey'", ")", "\n", "legend", "=", "plt", ".", "legend", "(", "loc", "=", "'upper right'", ")", "\n", "plt", ".", "xlabel", "(", "'$\\lambda^{-1}$'", ")", "\n", "plt", ".", "ylabel", "(", "'coefficients $c_i$'", ")", "\n", "plt", ".", "axis", "(", "'tight'", ")", "\n", "plt", ".", "savefig", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'lasso2.pdf'", ",", "bbox_inches", "=", "'tight'", ")", "\n", "\n", "plt", ".", "clf", "(", ")", "\n", "plt", ".", "semilogx", "(", "alphas", ",", "stats", "[", "'plain_val_acc'", "]", "[", "0", "]", ",", "label", "=", "\"unpenalized model\"", ",", "color", "=", "cmap", "(", "2", ")", ")", "\n", "plt", ".", "semilogx", "(", "alphas", ",", "stats", "[", "'penalized_val_acc'", "]", "[", "0", "]", ",", "label", "=", "\"penalized model\"", ",", "color", "=", "cmap", "(", "0", ")", ")", "\n", "plt", ".", "semilogx", "(", "alphas", ",", "mean_stats", "[", "'entropy_val_acc'", "]", "*", "np", ".", "ones", "(", "(", "len", "(", "alphas", ")", ",", ")", ")", ",", "label", "=", "\"entropy baseline\"", ",", "color", "=", "'black'", ",", "linestyle", "=", "'dashed'", ")", "\n", "ymin", ",", "ymax", "=", "plt", ".", "ylim", "(", ")", "\n", "plt", ".", "vlines", "(", "alphas", "[", "max_acc", "]", ",", "ymin", ",", "ymax", ",", "linestyle", "=", "'dashed'", ",", "linewidth", "=", "0.5", ",", "color", "=", "'grey'", ")", "\n", "legend", "=", "plt", ".", "legend", "(", "loc", "=", "'lower right'", ")", "\n", "plt", ".", "xlabel", "(", "'$\\lambda^{-1}$'", ")", "\n", "plt", ".", "ylabel", "(", "'classification accuracy'", ")", "\n", "plt", ".", "axis", "(", "'tight'", ")", "\n", "plt", ".", "savefig", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'classif_perf.pdf'", ",", "bbox_inches", "=", "'tight'", ")", "\n", "\n", "plt", ".", "clf", "(", ")", "\n", "plt", ".", "semilogx", "(", "alphas", ",", "stats", "[", "'plain_val_auroc'", "]", "[", "0", "]", ",", "label", "=", "\"unpenalized model\"", ",", "color", "=", "cmap", "(", "2", ")", ")", "\n", "plt", ".", "semilogx", "(", "alphas", ",", "stats", "[", "'penalized_val_auroc'", "]", "[", "0", "]", ",", "label", "=", "\"penalized model\"", ",", "color", "=", "cmap", "(", "0", ")", ")", "\n", "plt", ".", "semilogx", "(", "alphas", ",", "mean_stats", "[", "'entropy_val_auroc'", "]", "*", "np", ".", "ones", "(", "(", "len", "(", "alphas", ")", ",", ")", ")", ",", "label", "=", "\"entropy baseline\"", ",", "color", "=", "'black'", ",", "linestyle", "=", "'dashed'", ")", "\n", "ymin", ",", "ymax", "=", "plt", ".", "ylim", "(", ")", "\n", "plt", ".", "vlines", "(", "alphas", "[", "max_acc", "]", ",", "ymin", ",", "ymax", ",", "linestyle", "=", "'dashed'", ",", "linewidth", "=", "0.5", ",", "color", "=", "'grey'", ")", "\n", "legend", "=", "plt", ".", "legend", "(", "loc", "=", "'lower right'", ")", "\n", "plt", ".", "xlabel", "(", "'$\\lambda^{-1}$'", ")", "\n", "plt", ".", "ylabel", "(", "'AUROC'", ")", "\n", "plt", ".", "axis", "(", "'tight'", ")", "\n", "plt", ".", "savefig", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'classif_auroc.pdf'", ",", "bbox_inches", "=", "'tight'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.metaseg_plot.plot_regression": [[204, 254], ["matplotlib.rc", "matplotlib.rc", "matplotlib.rc", "matplotlib.rc", "matplotlib.get_cmap", "matplotlib.figure", "matplotlib.clf", "range", "numpy.squeeze", "numpy.arange", "matplotlib.plot", "matplotlib.scatter", "matplotlib.xlabel", "matplotlib.ylabel", "matplotlib.savefig", "matplotlib.clf", "scipy.stats.kde.gaussian_kde", "scipy.stats.kde.gaussian_kde", "kde.gaussian_kde.set_bandwidth", "kde.gaussian_kde.set_bandwidth", "numpy.arange", "matplotlib.clf", "matplotlib.figure", "matplotlib.plot", "matplotlib.plot", "matplotlib.hist", "matplotlib.hist", "matplotlib.legend", "matplotlib.xlabel", "matplotlib.savefig", "matplotlib.clf", "len", "numpy.min", "numpy.clip", "kde.gaussian_kde.", "kde.gaussian_kde.", "numpy.std", "numpy.max", "plt.get_cmap.", "plt.get_cmap.", "metaseg_io.metaseg.get", "metaseg_io.metaseg.get"], "function", ["home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get", "home.repos.pwc.inspect_result.mrottmann_MetaSeg.None.global_defs.MetaSeg.get"], ["", "def", "plot_regression", "(", "X2_val", ",", "y2_val", ",", "y2_pred", ",", "ya_val", ",", "ypred", ",", "X_names", ")", ":", "\n", "\n", "  ", "os", ".", "environ", "[", "'PATH'", "]", "=", "os", ".", "environ", "[", "'PATH'", "]", "+", "':/Library/TeX/texbin'", "# for tex in matplotlib", "\n", "plt", ".", "rc", "(", "'font'", ",", "size", "=", "10", ",", "family", "=", "'serif'", ")", "\n", "plt", ".", "rc", "(", "'axes'", ",", "titlesize", "=", "10", ")", "\n", "plt", ".", "rc", "(", "'figure'", ",", "titlesize", "=", "10", ")", "\n", "plt", ".", "rc", "(", "'text'", ",", "usetex", "=", "True", ")", "\n", "\n", "cmap", "=", "plt", ".", "get_cmap", "(", "'tab20'", ")", "\n", "\n", "figsize", "=", "(", "3.0", ",", "13.0", "/", "5.0", ")", "\n", "plt", ".", "figure", "(", "figsize", "=", "figsize", ",", "dpi", "=", "300", ")", "\n", "plt", ".", "clf", "(", ")", "\n", "S_ind", "=", "0", "\n", "for", "S_ind", "in", "range", "(", "len", "(", "X_names", ")", ")", ":", "\n", "    ", "if", "X_names", "[", "S_ind", "]", "==", "\"S\"", ":", "\n", "      ", "break", "\n", "\n", "", "", "sizes", "=", "np", ".", "squeeze", "(", "X2_val", "[", ":", ",", "S_ind", "]", "*", "np", ".", "std", "(", "X2_val", "[", ":", ",", "S_ind", "]", ")", ")", "\n", "sizes", "=", "sizes", "-", "np", ".", "min", "(", "sizes", ")", "\n", "sizes", "=", "sizes", "/", "np", ".", "max", "(", "sizes", ")", "*", "50", "#+ 1.5      ", "\n", "x", "=", "np", ".", "arange", "(", "0.", ",", "1", ",", ".01", ")", "\n", "plt", ".", "plot", "(", "x", ",", "x", ",", "color", "=", "'black'", ",", "alpha", "=", "0.5", ",", "linestyle", "=", "'dashed'", ")", "\n", "plt", ".", "scatter", "(", "y2_val", ",", "np", ".", "clip", "(", "y2_pred", ",", "0", ",", "1", ")", ",", "s", "=", "sizes", ",", "linewidth", "=", ".5", ",", "c", "=", "cmap", "(", "0", ")", ",", "edgecolors", "=", "cmap", "(", "1", ")", ",", "alpha", "=", "0.25", ")", "\n", "plt", ".", "xlabel", "(", "'$\\mathit{IoU}_\\mathrm{adj}$'", ")", "\n", "plt", ".", "ylabel", "(", "'predicted $\\mathit{IoU}_\\mathrm{adj}$'", ")", "\n", "plt", ".", "savefig", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'regression1.png'", ",", "bbox_inches", "=", "'tight'", ")", "\n", "\n", "figsize", "=", "(", "8.75", ",", "5.25", ")", "\n", "plt", ".", "clf", "(", ")", "\n", "\n", "density1", "=", "kde", ".", "gaussian_kde", "(", "ya_val", "[", "ypred", "==", "1", "]", ")", "\n", "density2", "=", "kde", ".", "gaussian_kde", "(", "ya_val", "[", "ypred", "==", "0", "]", ")", "\n", "\n", "density1", ".", "set_bandwidth", "(", "bw_method", "=", "density1", ".", "factor", "/", "2.", ")", "\n", "density2", ".", "set_bandwidth", "(", "bw_method", "=", "density2", ".", "factor", "/", "2.", ")", "\n", "\n", "x", "=", "np", ".", "arange", "(", "0.", ",", "1", ",", ".01", ")", "\n", "\n", "plt", ".", "clf", "(", ")", "\n", "plt", ".", "figure", "(", "figsize", "=", "figsize", ")", "\n", "plt", ".", "plot", "(", "x", ",", "density1", "(", "x", ")", ",", "color", "=", "'red'", ",", "alpha", "=", "0.66", ",", "label", "=", "\"pred. $IoU = 0$\"", ")", "\n", "plt", ".", "plot", "(", "x", ",", "density2", "(", "x", ")", ",", "color", "=", "'blue'", ",", "alpha", "=", "0.66", ",", "label", "=", "\"pred. $IoU > 0$\"", ")", "\n", "plt", ".", "hist", "(", "ya_val", "[", "ypred", "==", "1", "]", ",", "bins", "=", "20", ",", "color", "=", "'red'", ",", "alpha", "=", "0.1", ",", "normed", "=", "True", ")", "\n", "plt", ".", "hist", "(", "ya_val", "[", "ypred", "==", "0", "]", ",", "bins", "=", "20", ",", "color", "=", "'blue'", ",", "alpha", "=", "0.1", ",", "normed", "=", "True", ")", "\n", "legend", "=", "plt", ".", "legend", "(", "loc", "=", "'upper right'", ")", "\n", "plt", ".", "xlabel", "(", "'$\\mathit{IoU}_\\mathrm{adj}$'", ")", "\n", "plt", ".", "savefig", "(", "metaseg", ".", "get", "(", "\"RESULTS_DIR\"", ")", "+", "'classif_hist.pdf'", ",", "bbox_inches", "=", "'tight'", ")", "\n", "\n", "plt", ".", "clf", "(", ")", "\n", "\n"]]}