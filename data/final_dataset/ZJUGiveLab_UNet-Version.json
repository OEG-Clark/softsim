{"home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_3Plus.UNet_3Plus.__init__": [[12, 190], ["torch.Module.__init__", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "UNet_3Plus.UNet_3Plus.modules", "isinstance", "init_weights.init_weights.init_weights", "isinstance", "init_weights.init_weights.init_weights"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "n_classes", "=", "1", ",", "feature_scale", "=", "4", ",", "is_deconv", "=", "True", ",", "is_batchnorm", "=", "True", ")", ":", "\n", "        ", "super", "(", "UNet_3Plus", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "is_deconv", "=", "is_deconv", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "is_batchnorm", "=", "is_batchnorm", "\n", "self", ".", "feature_scale", "=", "feature_scale", "\n", "\n", "filters", "=", "[", "64", ",", "128", ",", "256", ",", "512", ",", "1024", "]", "\n", "\n", "## -------------Encoder--------------", "\n", "self", ".", "conv1", "=", "unetConv2", "(", "self", ".", "in_channels", ",", "filters", "[", "0", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool1", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv2", "=", "unetConv2", "(", "filters", "[", "0", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool2", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv3", "=", "unetConv2", "(", "filters", "[", "1", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool3", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv4", "=", "unetConv2", "(", "filters", "[", "2", "]", ",", "filters", "[", "3", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool4", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv5", "=", "unetConv2", "(", "filters", "[", "3", "]", ",", "filters", "[", "4", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "\n", "## -------------Decoder--------------", "\n", "self", ".", "CatChannels", "=", "filters", "[", "0", "]", "\n", "self", ".", "CatBlocks", "=", "5", "\n", "self", ".", "UpChannels", "=", "self", ".", "CatChannels", "*", "self", ".", "CatBlocks", "\n", "\n", "'''stage 4d'''", "\n", "# h1->320*320, hd4->40*40, Pooling 8 times", "\n", "self", ".", "h1_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "8", ",", "8", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd4->40*40, Pooling 4 times", "\n", "self", ".", "h2_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h2_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h3->80*80, hd4->40*40, Pooling 2 times", "\n", "self", ".", "h3_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h3_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "2", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h3_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h3_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h4->40*40, hd4->40*40, Concatenation", "\n", "self", ".", "h4_Cat_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "3", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h4_Cat_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h4_Cat_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd4->40*40, Upsample 2 times", "\n", "self", ".", "hd5_UT_hd4", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd4, h2_PT_hd4, h3_PT_hd4, h4_Cat_hd4, hd5_UT_hd4)", "\n", "self", ".", "conv4d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn4d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu4d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 3d'''", "\n", "# h1->320*320, hd3->80*80, Pooling 4 times", "\n", "self", ".", "h1_PT_hd3", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd3->80*80, Pooling 2 times", "\n", "self", ".", "h2_PT_hd3", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h2_PT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_PT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_PT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h3->80*80, hd3->80*80, Concatenation", "\n", "self", ".", "h3_Cat_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "2", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h3_Cat_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h3_Cat_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd4->80*80, Upsample 2 times", "\n", "self", ".", "hd4_UT_hd3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd4->80*80, Upsample 4 times", "\n", "self", ".", "hd5_UT_hd3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd3, h2_PT_hd3, h3_Cat_hd3, hd4_UT_hd3, hd5_UT_hd3)", "\n", "self", ".", "conv3d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn3d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu3d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 2d '''", "\n", "# h1->320*320, hd2->160*160, Pooling 2 times", "\n", "self", ".", "h1_PT_hd2", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd2->160*160, Concatenation", "\n", "self", ".", "h2_Cat_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_Cat_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_Cat_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd3->80*80, hd2->160*160, Upsample 2 times", "\n", "self", ".", "hd3_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd3_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd3_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd3_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd2->160*160, Upsample 4 times", "\n", "self", ".", "hd4_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd2->160*160, Upsample 8 times", "\n", "self", ".", "hd5_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd2, h2_Cat_hd2, hd3_UT_hd2, hd4_UT_hd2, hd5_UT_hd2)", "\n", "self", ".", "conv2d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn2d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu2d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 1d'''", "\n", "# h1->320*320, hd1->320*320, Concatenation", "\n", "self", ".", "h1_Cat_hd1_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_Cat_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_Cat_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd2->160*160, hd1->320*320, Upsample 2 times", "\n", "self", ".", "hd2_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd2_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd2_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd2_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd3->80*80, hd1->320*320, Upsample 4 times", "\n", "self", ".", "hd3_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd3_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd3_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd3_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd1->320*320, Upsample 8 times", "\n", "self", ".", "hd4_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd1->320*320, Upsample 16 times", "\n", "self", ".", "hd5_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "16", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_Cat_hd1, hd2_UT_hd1, hd3_UT_hd1, hd4_UT_hd1, hd5_UT_hd1)", "\n", "self", ".", "conv1d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn1d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu1d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# output", "\n", "self", ".", "outconv1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "# initialise weights", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_3Plus.UNet_3Plus.forward": [[191, 242], ["UNet_3Plus.UNet_3Plus.conv1", "UNet_3Plus.UNet_3Plus.maxpool1", "UNet_3Plus.UNet_3Plus.conv2", "UNet_3Plus.UNet_3Plus.maxpool2", "UNet_3Plus.UNet_3Plus.conv3", "UNet_3Plus.UNet_3Plus.maxpool3", "UNet_3Plus.UNet_3Plus.conv4", "UNet_3Plus.UNet_3Plus.maxpool4", "UNet_3Plus.UNet_3Plus.conv5", "UNet_3Plus.UNet_3Plus.h1_PT_hd4_relu", "UNet_3Plus.UNet_3Plus.h2_PT_hd4_relu", "UNet_3Plus.UNet_3Plus.h3_PT_hd4_relu", "UNet_3Plus.UNet_3Plus.h4_Cat_hd4_relu", "UNet_3Plus.UNet_3Plus.hd5_UT_hd4_relu", "UNet_3Plus.UNet_3Plus.relu4d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd3_relu", "UNet_3Plus.UNet_3Plus.h2_PT_hd3_relu", "UNet_3Plus.UNet_3Plus.h3_Cat_hd3_relu", "UNet_3Plus.UNet_3Plus.hd4_UT_hd3_relu", "UNet_3Plus.UNet_3Plus.hd5_UT_hd3_relu", "UNet_3Plus.UNet_3Plus.relu3d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd2_relu", "UNet_3Plus.UNet_3Plus.h2_Cat_hd2_relu", "UNet_3Plus.UNet_3Plus.hd3_UT_hd2_relu", "UNet_3Plus.UNet_3Plus.hd4_UT_hd2_relu", "UNet_3Plus.UNet_3Plus.hd5_UT_hd2_relu", "UNet_3Plus.UNet_3Plus.relu2d_1", "UNet_3Plus.UNet_3Plus.h1_Cat_hd1_relu", "UNet_3Plus.UNet_3Plus.hd2_UT_hd1_relu", "UNet_3Plus.UNet_3Plus.hd3_UT_hd1_relu", "UNet_3Plus.UNet_3Plus.hd4_UT_hd1_relu", "UNet_3Plus.UNet_3Plus.hd5_UT_hd1_relu", "UNet_3Plus.UNet_3Plus.relu1d_1", "UNet_3Plus.UNet_3Plus.outconv1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "UNet_3Plus.UNet_3Plus.h1_PT_hd4_bn", "UNet_3Plus.UNet_3Plus.h2_PT_hd4_bn", "UNet_3Plus.UNet_3Plus.h3_PT_hd4_bn", "UNet_3Plus.UNet_3Plus.h4_Cat_hd4_bn", "UNet_3Plus.UNet_3Plus.hd5_UT_hd4_bn", "UNet_3Plus.UNet_3Plus.bn4d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd3_bn", "UNet_3Plus.UNet_3Plus.h2_PT_hd3_bn", "UNet_3Plus.UNet_3Plus.h3_Cat_hd3_bn", "UNet_3Plus.UNet_3Plus.hd4_UT_hd3_bn", "UNet_3Plus.UNet_3Plus.hd5_UT_hd3_bn", "UNet_3Plus.UNet_3Plus.bn3d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd2_bn", "UNet_3Plus.UNet_3Plus.h2_Cat_hd2_bn", "UNet_3Plus.UNet_3Plus.hd3_UT_hd2_bn", "UNet_3Plus.UNet_3Plus.hd4_UT_hd2_bn", "UNet_3Plus.UNet_3Plus.hd5_UT_hd2_bn", "UNet_3Plus.UNet_3Plus.bn2d_1", "UNet_3Plus.UNet_3Plus.h1_Cat_hd1_bn", "UNet_3Plus.UNet_3Plus.hd2_UT_hd1_bn", "UNet_3Plus.UNet_3Plus.hd3_UT_hd1_bn", "UNet_3Plus.UNet_3Plus.hd4_UT_hd1_bn", "UNet_3Plus.UNet_3Plus.hd5_UT_hd1_bn", "UNet_3Plus.UNet_3Plus.bn1d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd4_conv", "UNet_3Plus.UNet_3Plus.h2_PT_hd4_conv", "UNet_3Plus.UNet_3Plus.h3_PT_hd4_conv", "UNet_3Plus.UNet_3Plus.h4_Cat_hd4_conv", "UNet_3Plus.UNet_3Plus.hd5_UT_hd4_conv", "UNet_3Plus.UNet_3Plus.conv4d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd3_conv", "UNet_3Plus.UNet_3Plus.h2_PT_hd3_conv", "UNet_3Plus.UNet_3Plus.h3_Cat_hd3_conv", "UNet_3Plus.UNet_3Plus.hd4_UT_hd3_conv", "UNet_3Plus.UNet_3Plus.hd5_UT_hd3_conv", "UNet_3Plus.UNet_3Plus.conv3d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd2_conv", "UNet_3Plus.UNet_3Plus.h2_Cat_hd2_conv", "UNet_3Plus.UNet_3Plus.hd3_UT_hd2_conv", "UNet_3Plus.UNet_3Plus.hd4_UT_hd2_conv", "UNet_3Plus.UNet_3Plus.hd5_UT_hd2_conv", "UNet_3Plus.UNet_3Plus.conv2d_1", "UNet_3Plus.UNet_3Plus.h1_Cat_hd1_conv", "UNet_3Plus.UNet_3Plus.hd2_UT_hd1_conv", "UNet_3Plus.UNet_3Plus.hd3_UT_hd1_conv", "UNet_3Plus.UNet_3Plus.hd4_UT_hd1_conv", "UNet_3Plus.UNet_3Plus.hd5_UT_hd1_conv", "UNet_3Plus.UNet_3Plus.conv1d_1", "UNet_3Plus.UNet_3Plus.h1_PT_hd4", "UNet_3Plus.UNet_3Plus.h2_PT_hd4", "UNet_3Plus.UNet_3Plus.h3_PT_hd4", "UNet_3Plus.UNet_3Plus.hd5_UT_hd4", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus.h1_PT_hd3", "UNet_3Plus.UNet_3Plus.h2_PT_hd3", "UNet_3Plus.UNet_3Plus.hd4_UT_hd3", "UNet_3Plus.UNet_3Plus.hd5_UT_hd3", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus.h1_PT_hd2", "UNet_3Plus.UNet_3Plus.hd3_UT_hd2", "UNet_3Plus.UNet_3Plus.hd4_UT_hd2", "UNet_3Plus.UNet_3Plus.hd5_UT_hd2", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus.hd2_UT_hd1", "UNet_3Plus.UNet_3Plus.hd3_UT_hd1", "UNet_3Plus.UNet_3Plus.hd4_UT_hd1", "UNet_3Plus.UNet_3Plus.hd5_UT_hd1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "## -------------Encoder-------------", "\n", "        ", "h1", "=", "self", ".", "conv1", "(", "inputs", ")", "# h1->320*320*64", "\n", "\n", "h2", "=", "self", ".", "maxpool1", "(", "h1", ")", "\n", "h2", "=", "self", ".", "conv2", "(", "h2", ")", "# h2->160*160*128", "\n", "\n", "h3", "=", "self", ".", "maxpool2", "(", "h2", ")", "\n", "h3", "=", "self", ".", "conv3", "(", "h3", ")", "# h3->80*80*256", "\n", "\n", "h4", "=", "self", ".", "maxpool3", "(", "h3", ")", "\n", "h4", "=", "self", ".", "conv4", "(", "h4", ")", "# h4->40*40*512", "\n", "\n", "h5", "=", "self", ".", "maxpool4", "(", "h4", ")", "\n", "hd5", "=", "self", ".", "conv5", "(", "h5", ")", "# h5->20*20*1024", "\n", "\n", "## -------------Decoder-------------", "\n", "h1_PT_hd4", "=", "self", ".", "h1_PT_hd4_relu", "(", "self", ".", "h1_PT_hd4_bn", "(", "self", ".", "h1_PT_hd4_conv", "(", "self", ".", "h1_PT_hd4", "(", "h1", ")", ")", ")", ")", "\n", "h2_PT_hd4", "=", "self", ".", "h2_PT_hd4_relu", "(", "self", ".", "h2_PT_hd4_bn", "(", "self", ".", "h2_PT_hd4_conv", "(", "self", ".", "h2_PT_hd4", "(", "h2", ")", ")", ")", ")", "\n", "h3_PT_hd4", "=", "self", ".", "h3_PT_hd4_relu", "(", "self", ".", "h3_PT_hd4_bn", "(", "self", ".", "h3_PT_hd4_conv", "(", "self", ".", "h3_PT_hd4", "(", "h3", ")", ")", ")", ")", "\n", "h4_Cat_hd4", "=", "self", ".", "h4_Cat_hd4_relu", "(", "self", ".", "h4_Cat_hd4_bn", "(", "self", ".", "h4_Cat_hd4_conv", "(", "h4", ")", ")", ")", "\n", "hd5_UT_hd4", "=", "self", ".", "hd5_UT_hd4_relu", "(", "self", ".", "hd5_UT_hd4_bn", "(", "self", ".", "hd5_UT_hd4_conv", "(", "self", ".", "hd5_UT_hd4", "(", "hd5", ")", ")", ")", ")", "\n", "hd4", "=", "self", ".", "relu4d_1", "(", "self", ".", "bn4d_1", "(", "self", ".", "conv4d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd4", ",", "h2_PT_hd4", ",", "h3_PT_hd4", ",", "h4_Cat_hd4", ",", "hd5_UT_hd4", ")", ",", "1", ")", ")", ")", ")", "# hd4->40*40*UpChannels", "\n", "\n", "h1_PT_hd3", "=", "self", ".", "h1_PT_hd3_relu", "(", "self", ".", "h1_PT_hd3_bn", "(", "self", ".", "h1_PT_hd3_conv", "(", "self", ".", "h1_PT_hd3", "(", "h1", ")", ")", ")", ")", "\n", "h2_PT_hd3", "=", "self", ".", "h2_PT_hd3_relu", "(", "self", ".", "h2_PT_hd3_bn", "(", "self", ".", "h2_PT_hd3_conv", "(", "self", ".", "h2_PT_hd3", "(", "h2", ")", ")", ")", ")", "\n", "h3_Cat_hd3", "=", "self", ".", "h3_Cat_hd3_relu", "(", "self", ".", "h3_Cat_hd3_bn", "(", "self", ".", "h3_Cat_hd3_conv", "(", "h3", ")", ")", ")", "\n", "hd4_UT_hd3", "=", "self", ".", "hd4_UT_hd3_relu", "(", "self", ".", "hd4_UT_hd3_bn", "(", "self", ".", "hd4_UT_hd3_conv", "(", "self", ".", "hd4_UT_hd3", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd3", "=", "self", ".", "hd5_UT_hd3_relu", "(", "self", ".", "hd5_UT_hd3_bn", "(", "self", ".", "hd5_UT_hd3_conv", "(", "self", ".", "hd5_UT_hd3", "(", "hd5", ")", ")", ")", ")", "\n", "hd3", "=", "self", ".", "relu3d_1", "(", "self", ".", "bn3d_1", "(", "self", ".", "conv3d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd3", ",", "h2_PT_hd3", ",", "h3_Cat_hd3", ",", "hd4_UT_hd3", ",", "hd5_UT_hd3", ")", ",", "1", ")", ")", ")", ")", "# hd3->80*80*UpChannels", "\n", "\n", "h1_PT_hd2", "=", "self", ".", "h1_PT_hd2_relu", "(", "self", ".", "h1_PT_hd2_bn", "(", "self", ".", "h1_PT_hd2_conv", "(", "self", ".", "h1_PT_hd2", "(", "h1", ")", ")", ")", ")", "\n", "h2_Cat_hd2", "=", "self", ".", "h2_Cat_hd2_relu", "(", "self", ".", "h2_Cat_hd2_bn", "(", "self", ".", "h2_Cat_hd2_conv", "(", "h2", ")", ")", ")", "\n", "hd3_UT_hd2", "=", "self", ".", "hd3_UT_hd2_relu", "(", "self", ".", "hd3_UT_hd2_bn", "(", "self", ".", "hd3_UT_hd2_conv", "(", "self", ".", "hd3_UT_hd2", "(", "hd3", ")", ")", ")", ")", "\n", "hd4_UT_hd2", "=", "self", ".", "hd4_UT_hd2_relu", "(", "self", ".", "hd4_UT_hd2_bn", "(", "self", ".", "hd4_UT_hd2_conv", "(", "self", ".", "hd4_UT_hd2", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd2", "=", "self", ".", "hd5_UT_hd2_relu", "(", "self", ".", "hd5_UT_hd2_bn", "(", "self", ".", "hd5_UT_hd2_conv", "(", "self", ".", "hd5_UT_hd2", "(", "hd5", ")", ")", ")", ")", "\n", "hd2", "=", "self", ".", "relu2d_1", "(", "self", ".", "bn2d_1", "(", "self", ".", "conv2d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd2", ",", "h2_Cat_hd2", ",", "hd3_UT_hd2", ",", "hd4_UT_hd2", ",", "hd5_UT_hd2", ")", ",", "1", ")", ")", ")", ")", "# hd2->160*160*UpChannels", "\n", "\n", "h1_Cat_hd1", "=", "self", ".", "h1_Cat_hd1_relu", "(", "self", ".", "h1_Cat_hd1_bn", "(", "self", ".", "h1_Cat_hd1_conv", "(", "h1", ")", ")", ")", "\n", "hd2_UT_hd1", "=", "self", ".", "hd2_UT_hd1_relu", "(", "self", ".", "hd2_UT_hd1_bn", "(", "self", ".", "hd2_UT_hd1_conv", "(", "self", ".", "hd2_UT_hd1", "(", "hd2", ")", ")", ")", ")", "\n", "hd3_UT_hd1", "=", "self", ".", "hd3_UT_hd1_relu", "(", "self", ".", "hd3_UT_hd1_bn", "(", "self", ".", "hd3_UT_hd1_conv", "(", "self", ".", "hd3_UT_hd1", "(", "hd3", ")", ")", ")", ")", "\n", "hd4_UT_hd1", "=", "self", ".", "hd4_UT_hd1_relu", "(", "self", ".", "hd4_UT_hd1_bn", "(", "self", ".", "hd4_UT_hd1_conv", "(", "self", ".", "hd4_UT_hd1", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd1", "=", "self", ".", "hd5_UT_hd1_relu", "(", "self", ".", "hd5_UT_hd1_bn", "(", "self", ".", "hd5_UT_hd1_conv", "(", "self", ".", "hd5_UT_hd1", "(", "hd5", ")", ")", ")", ")", "\n", "hd1", "=", "self", ".", "relu1d_1", "(", "self", ".", "bn1d_1", "(", "self", ".", "conv1d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_Cat_hd1", ",", "hd2_UT_hd1", ",", "hd3_UT_hd1", ",", "hd4_UT_hd1", ",", "hd5_UT_hd1", ")", ",", "1", ")", ")", ")", ")", "# hd1->320*320*UpChannels", "\n", "\n", "d1", "=", "self", ".", "outconv1", "(", "hd1", ")", "# d1->320*320*n_classes", "\n", "return", "F", ".", "sigmoid", "(", "d1", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_3Plus.UNet_3Plus_DeepSup.__init__": [[247, 436], ["torch.Module.__init__", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "UNet_3Plus.UNet_3Plus_DeepSup.modules", "isinstance", "init_weights.init_weights.init_weights", "isinstance", "init_weights.init_weights.init_weights"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "n_classes", "=", "1", ",", "feature_scale", "=", "4", ",", "is_deconv", "=", "True", ",", "is_batchnorm", "=", "True", ")", ":", "\n", "        ", "super", "(", "UNet_3Plus_DeepSup", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "is_deconv", "=", "is_deconv", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "is_batchnorm", "=", "is_batchnorm", "\n", "self", ".", "feature_scale", "=", "feature_scale", "\n", "\n", "filters", "=", "[", "64", ",", "128", ",", "256", ",", "512", ",", "1024", "]", "\n", "\n", "## -------------Encoder--------------", "\n", "self", ".", "conv1", "=", "unetConv2", "(", "self", ".", "in_channels", ",", "filters", "[", "0", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool1", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv2", "=", "unetConv2", "(", "filters", "[", "0", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool2", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv3", "=", "unetConv2", "(", "filters", "[", "1", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool3", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv4", "=", "unetConv2", "(", "filters", "[", "2", "]", ",", "filters", "[", "3", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool4", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv5", "=", "unetConv2", "(", "filters", "[", "3", "]", ",", "filters", "[", "4", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "\n", "## -------------Decoder--------------", "\n", "self", ".", "CatChannels", "=", "filters", "[", "0", "]", "\n", "self", ".", "CatBlocks", "=", "5", "\n", "self", ".", "UpChannels", "=", "self", ".", "CatChannels", "*", "self", ".", "CatBlocks", "\n", "\n", "'''stage 4d'''", "\n", "# h1->320*320, hd4->40*40, Pooling 8 times", "\n", "self", ".", "h1_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "8", ",", "8", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd4->40*40, Pooling 4 times", "\n", "self", ".", "h2_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h2_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h3->80*80, hd4->40*40, Pooling 2 times", "\n", "self", ".", "h3_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h3_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "2", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h3_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h3_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h4->40*40, hd4->40*40, Concatenation", "\n", "self", ".", "h4_Cat_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "3", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h4_Cat_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h4_Cat_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd4->40*40, Upsample 2 times", "\n", "self", ".", "hd5_UT_hd4", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd4, h2_PT_hd4, h3_PT_hd4, h4_Cat_hd4, hd5_UT_hd4)", "\n", "self", ".", "conv4d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn4d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu4d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 3d'''", "\n", "# h1->320*320, hd3->80*80, Pooling 4 times", "\n", "self", ".", "h1_PT_hd3", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd3->80*80, Pooling 2 times", "\n", "self", ".", "h2_PT_hd3", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h2_PT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_PT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_PT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h3->80*80, hd3->80*80, Concatenation", "\n", "self", ".", "h3_Cat_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "2", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h3_Cat_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h3_Cat_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd4->80*80, Upsample 2 times", "\n", "self", ".", "hd4_UT_hd3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd4->80*80, Upsample 4 times", "\n", "self", ".", "hd5_UT_hd3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd3, h2_PT_hd3, h3_Cat_hd3, hd4_UT_hd3, hd5_UT_hd3)", "\n", "self", ".", "conv3d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn3d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu3d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 2d '''", "\n", "# h1->320*320, hd2->160*160, Pooling 2 times", "\n", "self", ".", "h1_PT_hd2", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd2->160*160, Concatenation", "\n", "self", ".", "h2_Cat_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_Cat_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_Cat_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd3->80*80, hd2->160*160, Upsample 2 times", "\n", "self", ".", "hd3_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd3_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd3_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd3_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd2->160*160, Upsample 4 times", "\n", "self", ".", "hd4_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd2->160*160, Upsample 8 times", "\n", "self", ".", "hd5_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd2, h2_Cat_hd2, hd3_UT_hd2, hd4_UT_hd2, hd5_UT_hd2)", "\n", "self", ".", "conv2d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn2d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu2d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 1d'''", "\n", "# h1->320*320, hd1->320*320, Concatenation", "\n", "self", ".", "h1_Cat_hd1_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_Cat_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_Cat_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd2->160*160, hd1->320*320, Upsample 2 times", "\n", "self", ".", "hd2_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd2_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd2_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd2_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd3->80*80, hd1->320*320, Upsample 4 times", "\n", "self", ".", "hd3_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd3_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd3_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd3_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd1->320*320, Upsample 8 times", "\n", "self", ".", "hd4_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd1->320*320, Upsample 16 times", "\n", "self", ".", "hd5_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "16", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_Cat_hd1, hd2_UT_hd1, hd3_UT_hd1, hd4_UT_hd1, hd5_UT_hd1)", "\n", "self", ".", "conv1d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn1d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu1d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# -------------Bilinear Upsampling--------------", "\n", "self", ".", "upscore6", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "32", ",", "mode", "=", "'bilinear'", ")", "###", "\n", "self", ".", "upscore5", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "16", ",", "mode", "=", "'bilinear'", ")", "\n", "self", ".", "upscore4", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "\n", "self", ".", "upscore3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "\n", "self", ".", "upscore2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "\n", "\n", "# DeepSup", "\n", "self", ".", "outconv1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv2", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv3", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv4", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv5", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "# initialise weights", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_3Plus.UNet_3Plus_DeepSup.forward": [[437, 500], ["UNet_3Plus.UNet_3Plus_DeepSup.conv1", "UNet_3Plus.UNet_3Plus_DeepSup.maxpool1", "UNet_3Plus.UNet_3Plus_DeepSup.conv2", "UNet_3Plus.UNet_3Plus_DeepSup.maxpool2", "UNet_3Plus.UNet_3Plus_DeepSup.conv3", "UNet_3Plus.UNet_3Plus_DeepSup.maxpool3", "UNet_3Plus.UNet_3Plus_DeepSup.conv4", "UNet_3Plus.UNet_3Plus_DeepSup.maxpool4", "UNet_3Plus.UNet_3Plus_DeepSup.conv5", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup.h3_PT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup.h4_Cat_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup.relu4d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup.h3_Cat_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup.relu3d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup.h2_Cat_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup.relu2d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_Cat_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd2_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup.relu1d_1", "UNet_3Plus.UNet_3Plus_DeepSup.outconv5", "UNet_3Plus.UNet_3Plus_DeepSup.upscore5", "UNet_3Plus.UNet_3Plus_DeepSup.outconv4", "UNet_3Plus.UNet_3Plus_DeepSup.upscore4", "UNet_3Plus.UNet_3Plus_DeepSup.outconv3", "UNet_3Plus.UNet_3Plus_DeepSup.upscore3", "UNet_3Plus.UNet_3Plus_DeepSup.outconv2", "UNet_3Plus.UNet_3Plus_DeepSup.upscore2", "UNet_3Plus.UNet_3Plus_DeepSup.outconv1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup.h3_PT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup.h4_Cat_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup.bn4d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup.h3_Cat_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup.bn3d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup.h2_Cat_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup.bn2d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_Cat_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd2_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup.bn1d_1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup.h3_PT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup.h4_Cat_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup.conv4d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup.h3_Cat_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup.conv3d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup.h2_Cat_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup.conv2d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_Cat_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd2_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup.conv1d_1", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd4", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd4", "UNet_3Plus.UNet_3Plus_DeepSup.h3_PT_hd4", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd4", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd3", "UNet_3Plus.UNet_3Plus_DeepSup.h2_PT_hd3", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd3", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd3", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus_DeepSup.h1_PT_hd2", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd2", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd2", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd2", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus_DeepSup.hd2_UT_hd1", "UNet_3Plus.UNet_3Plus_DeepSup.hd3_UT_hd1", "UNet_3Plus.UNet_3Plus_DeepSup.hd4_UT_hd1", "UNet_3Plus.UNet_3Plus_DeepSup.hd5_UT_hd1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "## -------------Encoder-------------", "\n", "        ", "h1", "=", "self", ".", "conv1", "(", "inputs", ")", "# h1->320*320*64", "\n", "\n", "h2", "=", "self", ".", "maxpool1", "(", "h1", ")", "\n", "h2", "=", "self", ".", "conv2", "(", "h2", ")", "# h2->160*160*128", "\n", "\n", "h3", "=", "self", ".", "maxpool2", "(", "h2", ")", "\n", "h3", "=", "self", ".", "conv3", "(", "h3", ")", "# h3->80*80*256", "\n", "\n", "h4", "=", "self", ".", "maxpool3", "(", "h3", ")", "\n", "h4", "=", "self", ".", "conv4", "(", "h4", ")", "# h4->40*40*512", "\n", "\n", "h5", "=", "self", ".", "maxpool4", "(", "h4", ")", "\n", "hd5", "=", "self", ".", "conv5", "(", "h5", ")", "# h5->20*20*1024", "\n", "\n", "## -------------Decoder-------------", "\n", "h1_PT_hd4", "=", "self", ".", "h1_PT_hd4_relu", "(", "self", ".", "h1_PT_hd4_bn", "(", "self", ".", "h1_PT_hd4_conv", "(", "self", ".", "h1_PT_hd4", "(", "h1", ")", ")", ")", ")", "\n", "h2_PT_hd4", "=", "self", ".", "h2_PT_hd4_relu", "(", "self", ".", "h2_PT_hd4_bn", "(", "self", ".", "h2_PT_hd4_conv", "(", "self", ".", "h2_PT_hd4", "(", "h2", ")", ")", ")", ")", "\n", "h3_PT_hd4", "=", "self", ".", "h3_PT_hd4_relu", "(", "self", ".", "h3_PT_hd4_bn", "(", "self", ".", "h3_PT_hd4_conv", "(", "self", ".", "h3_PT_hd4", "(", "h3", ")", ")", ")", ")", "\n", "h4_Cat_hd4", "=", "self", ".", "h4_Cat_hd4_relu", "(", "self", ".", "h4_Cat_hd4_bn", "(", "self", ".", "h4_Cat_hd4_conv", "(", "h4", ")", ")", ")", "\n", "hd5_UT_hd4", "=", "self", ".", "hd5_UT_hd4_relu", "(", "self", ".", "hd5_UT_hd4_bn", "(", "self", ".", "hd5_UT_hd4_conv", "(", "self", ".", "hd5_UT_hd4", "(", "hd5", ")", ")", ")", ")", "\n", "hd4", "=", "self", ".", "relu4d_1", "(", "self", ".", "bn4d_1", "(", "self", ".", "conv4d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd4", ",", "h2_PT_hd4", ",", "h3_PT_hd4", ",", "h4_Cat_hd4", ",", "hd5_UT_hd4", ")", ",", "1", ")", ")", ")", ")", "# hd4->40*40*UpChannels", "\n", "\n", "h1_PT_hd3", "=", "self", ".", "h1_PT_hd3_relu", "(", "self", ".", "h1_PT_hd3_bn", "(", "self", ".", "h1_PT_hd3_conv", "(", "self", ".", "h1_PT_hd3", "(", "h1", ")", ")", ")", ")", "\n", "h2_PT_hd3", "=", "self", ".", "h2_PT_hd3_relu", "(", "self", ".", "h2_PT_hd3_bn", "(", "self", ".", "h2_PT_hd3_conv", "(", "self", ".", "h2_PT_hd3", "(", "h2", ")", ")", ")", ")", "\n", "h3_Cat_hd3", "=", "self", ".", "h3_Cat_hd3_relu", "(", "self", ".", "h3_Cat_hd3_bn", "(", "self", ".", "h3_Cat_hd3_conv", "(", "h3", ")", ")", ")", "\n", "hd4_UT_hd3", "=", "self", ".", "hd4_UT_hd3_relu", "(", "self", ".", "hd4_UT_hd3_bn", "(", "self", ".", "hd4_UT_hd3_conv", "(", "self", ".", "hd4_UT_hd3", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd3", "=", "self", ".", "hd5_UT_hd3_relu", "(", "self", ".", "hd5_UT_hd3_bn", "(", "self", ".", "hd5_UT_hd3_conv", "(", "self", ".", "hd5_UT_hd3", "(", "hd5", ")", ")", ")", ")", "\n", "hd3", "=", "self", ".", "relu3d_1", "(", "self", ".", "bn3d_1", "(", "self", ".", "conv3d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd3", ",", "h2_PT_hd3", ",", "h3_Cat_hd3", ",", "hd4_UT_hd3", ",", "hd5_UT_hd3", ")", ",", "1", ")", ")", ")", ")", "# hd3->80*80*UpChannels", "\n", "\n", "h1_PT_hd2", "=", "self", ".", "h1_PT_hd2_relu", "(", "self", ".", "h1_PT_hd2_bn", "(", "self", ".", "h1_PT_hd2_conv", "(", "self", ".", "h1_PT_hd2", "(", "h1", ")", ")", ")", ")", "\n", "h2_Cat_hd2", "=", "self", ".", "h2_Cat_hd2_relu", "(", "self", ".", "h2_Cat_hd2_bn", "(", "self", ".", "h2_Cat_hd2_conv", "(", "h2", ")", ")", ")", "\n", "hd3_UT_hd2", "=", "self", ".", "hd3_UT_hd2_relu", "(", "self", ".", "hd3_UT_hd2_bn", "(", "self", ".", "hd3_UT_hd2_conv", "(", "self", ".", "hd3_UT_hd2", "(", "hd3", ")", ")", ")", ")", "\n", "hd4_UT_hd2", "=", "self", ".", "hd4_UT_hd2_relu", "(", "self", ".", "hd4_UT_hd2_bn", "(", "self", ".", "hd4_UT_hd2_conv", "(", "self", ".", "hd4_UT_hd2", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd2", "=", "self", ".", "hd5_UT_hd2_relu", "(", "self", ".", "hd5_UT_hd2_bn", "(", "self", ".", "hd5_UT_hd2_conv", "(", "self", ".", "hd5_UT_hd2", "(", "hd5", ")", ")", ")", ")", "\n", "hd2", "=", "self", ".", "relu2d_1", "(", "self", ".", "bn2d_1", "(", "self", ".", "conv2d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd2", ",", "h2_Cat_hd2", ",", "hd3_UT_hd2", ",", "hd4_UT_hd2", ",", "hd5_UT_hd2", ")", ",", "1", ")", ")", ")", ")", "# hd2->160*160*UpChannels", "\n", "\n", "h1_Cat_hd1", "=", "self", ".", "h1_Cat_hd1_relu", "(", "self", ".", "h1_Cat_hd1_bn", "(", "self", ".", "h1_Cat_hd1_conv", "(", "h1", ")", ")", ")", "\n", "hd2_UT_hd1", "=", "self", ".", "hd2_UT_hd1_relu", "(", "self", ".", "hd2_UT_hd1_bn", "(", "self", ".", "hd2_UT_hd1_conv", "(", "self", ".", "hd2_UT_hd1", "(", "hd2", ")", ")", ")", ")", "\n", "hd3_UT_hd1", "=", "self", ".", "hd3_UT_hd1_relu", "(", "self", ".", "hd3_UT_hd1_bn", "(", "self", ".", "hd3_UT_hd1_conv", "(", "self", ".", "hd3_UT_hd1", "(", "hd3", ")", ")", ")", ")", "\n", "hd4_UT_hd1", "=", "self", ".", "hd4_UT_hd1_relu", "(", "self", ".", "hd4_UT_hd1_bn", "(", "self", ".", "hd4_UT_hd1_conv", "(", "self", ".", "hd4_UT_hd1", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd1", "=", "self", ".", "hd5_UT_hd1_relu", "(", "self", ".", "hd5_UT_hd1_bn", "(", "self", ".", "hd5_UT_hd1_conv", "(", "self", ".", "hd5_UT_hd1", "(", "hd5", ")", ")", ")", ")", "\n", "hd1", "=", "self", ".", "relu1d_1", "(", "self", ".", "bn1d_1", "(", "self", ".", "conv1d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_Cat_hd1", ",", "hd2_UT_hd1", ",", "hd3_UT_hd1", ",", "hd4_UT_hd1", ",", "hd5_UT_hd1", ")", ",", "1", ")", ")", ")", ")", "# hd1->320*320*UpChannels", "\n", "\n", "d5", "=", "self", ".", "outconv5", "(", "hd5", ")", "\n", "d5", "=", "self", ".", "upscore5", "(", "d5", ")", "# 16->256", "\n", "\n", "d4", "=", "self", ".", "outconv4", "(", "hd4", ")", "\n", "d4", "=", "self", ".", "upscore4", "(", "d4", ")", "# 32->256", "\n", "\n", "d3", "=", "self", ".", "outconv3", "(", "hd3", ")", "\n", "d3", "=", "self", ".", "upscore3", "(", "d3", ")", "# 64->256", "\n", "\n", "d2", "=", "self", ".", "outconv2", "(", "hd2", ")", "\n", "d2", "=", "self", ".", "upscore2", "(", "d2", ")", "# 128->256", "\n", "\n", "d1", "=", "self", ".", "outconv1", "(", "hd1", ")", "# 256", "\n", "return", "F", ".", "sigmoid", "(", "d1", ")", ",", "F", ".", "sigmoid", "(", "d2", ")", ",", "F", ".", "sigmoid", "(", "d3", ")", ",", "F", ".", "sigmoid", "(", "d4", ")", ",", "F", ".", "sigmoid", "(", "d5", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_3Plus.UNet_3Plus_DeepSup_CGM.__init__": [[506, 701], ["torch.Module.__init__", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Upsample", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Sequential", "torch.Sequential", "torch.Sequential", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.modules", "torch.Dropout", "torch.Dropout", "torch.Dropout", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.AdaptiveMaxPool2d", "torch.AdaptiveMaxPool2d", "torch.AdaptiveMaxPool2d", "torch.Sigmoid", "torch.Sigmoid", "torch.Sigmoid", "isinstance", "init_weights.init_weights.init_weights", "isinstance", "init_weights.init_weights.init_weights"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "n_classes", "=", "1", ",", "feature_scale", "=", "4", ",", "is_deconv", "=", "True", ",", "is_batchnorm", "=", "True", ")", ":", "\n", "        ", "super", "(", "UNet_3Plus_DeepSup_CGM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "is_deconv", "=", "is_deconv", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "is_batchnorm", "=", "is_batchnorm", "\n", "self", ".", "feature_scale", "=", "feature_scale", "\n", "\n", "filters", "=", "[", "64", ",", "128", ",", "256", ",", "512", ",", "1024", "]", "\n", "\n", "## -------------Encoder--------------", "\n", "self", ".", "conv1", "=", "unetConv2", "(", "self", ".", "in_channels", ",", "filters", "[", "0", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool1", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv2", "=", "unetConv2", "(", "filters", "[", "0", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool2", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv3", "=", "unetConv2", "(", "filters", "[", "1", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool3", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv4", "=", "unetConv2", "(", "filters", "[", "2", "]", ",", "filters", "[", "3", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool4", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv5", "=", "unetConv2", "(", "filters", "[", "3", "]", ",", "filters", "[", "4", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "\n", "## -------------Decoder--------------", "\n", "self", ".", "CatChannels", "=", "filters", "[", "0", "]", "\n", "self", ".", "CatBlocks", "=", "5", "\n", "self", ".", "UpChannels", "=", "self", ".", "CatChannels", "*", "self", ".", "CatBlocks", "\n", "\n", "'''stage 4d'''", "\n", "# h1->320*320, hd4->40*40, Pooling 8 times", "\n", "self", ".", "h1_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "8", ",", "8", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd4->40*40, Pooling 4 times", "\n", "self", ".", "h2_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h2_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h3->80*80, hd4->40*40, Pooling 2 times", "\n", "self", ".", "h3_PT_hd4", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h3_PT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "2", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h3_PT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h3_PT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h4->40*40, hd4->40*40, Concatenation", "\n", "self", ".", "h4_Cat_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "3", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h4_Cat_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h4_Cat_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd4->40*40, Upsample 2 times", "\n", "self", ".", "hd5_UT_hd4", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd4_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd4_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd4_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd4, h2_PT_hd4, h3_PT_hd4, h4_Cat_hd4, hd5_UT_hd4)", "\n", "self", ".", "conv4d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn4d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu4d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 3d'''", "\n", "# h1->320*320, hd3->80*80, Pooling 4 times", "\n", "self", ".", "h1_PT_hd3", "=", "nn", ".", "MaxPool2d", "(", "4", ",", "4", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd3->80*80, Pooling 2 times", "\n", "self", ".", "h2_PT_hd3", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h2_PT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_PT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_PT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h3->80*80, hd3->80*80, Concatenation", "\n", "self", ".", "h3_Cat_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "2", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h3_Cat_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h3_Cat_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd4->80*80, Upsample 2 times", "\n", "self", ".", "hd4_UT_hd3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd4->80*80, Upsample 4 times", "\n", "self", ".", "hd5_UT_hd3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd3_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd3_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd3_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd3, h2_PT_hd3, h3_Cat_hd3, hd4_UT_hd3, hd5_UT_hd3)", "\n", "self", ".", "conv3d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn3d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu3d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 2d '''", "\n", "# h1->320*320, hd2->160*160, Pooling 2 times", "\n", "self", ".", "h1_PT_hd2", "=", "nn", ".", "MaxPool2d", "(", "2", ",", "2", ",", "ceil_mode", "=", "True", ")", "\n", "self", ".", "h1_PT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_PT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_PT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# h2->160*160, hd2->160*160, Concatenation", "\n", "self", ".", "h2_Cat_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "1", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h2_Cat_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h2_Cat_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd3->80*80, hd2->160*160, Upsample 2 times", "\n", "self", ".", "hd3_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd3_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd3_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd3_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd2->160*160, Upsample 4 times", "\n", "self", ".", "hd4_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd2->160*160, Upsample 8 times", "\n", "self", ".", "hd5_UT_hd2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd2_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd2_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd2_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_PT_hd2, h2_Cat_hd2, hd3_UT_hd2, hd4_UT_hd2, hd5_UT_hd2)", "\n", "self", ".", "conv2d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn2d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu2d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "'''stage 1d'''", "\n", "# h1->320*320, hd1->320*320, Concatenation", "\n", "self", ".", "h1_Cat_hd1_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "h1_Cat_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "h1_Cat_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd2->160*160, hd1->320*320, Upsample 2 times", "\n", "self", ".", "hd2_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd2_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd2_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd2_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd3->80*80, hd1->320*320, Upsample 4 times", "\n", "self", ".", "hd3_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd3_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd3_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd3_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd4->40*40, hd1->320*320, Upsample 8 times", "\n", "self", ".", "hd4_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd4_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd4_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd4_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# hd5->20*20, hd1->320*320, Upsample 16 times", "\n", "self", ".", "hd5_UT_hd1", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "16", ",", "mode", "=", "'bilinear'", ")", "# 14*14", "\n", "self", ".", "hd5_UT_hd1_conv", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "self", ".", "CatChannels", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "hd5_UT_hd1_bn", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "CatChannels", ")", "\n", "self", ".", "hd5_UT_hd1_relu", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# fusion(h1_Cat_hd1, hd2_UT_hd1, hd3_UT_hd1, hd4_UT_hd1, hd5_UT_hd1)", "\n", "self", ".", "conv1d_1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "self", ".", "UpChannels", ",", "3", ",", "padding", "=", "1", ")", "# 16", "\n", "self", ".", "bn1d_1", "=", "nn", ".", "BatchNorm2d", "(", "self", ".", "UpChannels", ")", "\n", "self", ".", "relu1d_1", "=", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", "\n", "\n", "# -------------Bilinear Upsampling--------------", "\n", "self", ".", "upscore6", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "32", ",", "mode", "=", "'bilinear'", ")", "###", "\n", "self", ".", "upscore5", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "16", ",", "mode", "=", "'bilinear'", ")", "\n", "self", ".", "upscore4", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "8", ",", "mode", "=", "'bilinear'", ")", "\n", "self", ".", "upscore3", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "4", ",", "mode", "=", "'bilinear'", ")", "\n", "self", ".", "upscore2", "=", "nn", ".", "Upsample", "(", "scale_factor", "=", "2", ",", "mode", "=", "'bilinear'", ")", "\n", "\n", "# DeepSup", "\n", "self", ".", "outconv1", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv2", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv3", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv4", "=", "nn", ".", "Conv2d", "(", "self", ".", "UpChannels", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "self", ".", "outconv5", "=", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "n_classes", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "self", ".", "cls", "=", "nn", ".", "Sequential", "(", "\n", "nn", ".", "Dropout", "(", "p", "=", "0.5", ")", ",", "\n", "nn", ".", "Conv2d", "(", "filters", "[", "4", "]", ",", "2", ",", "1", ")", ",", "\n", "nn", ".", "AdaptiveMaxPool2d", "(", "1", ")", ",", "\n", "nn", ".", "Sigmoid", "(", ")", ")", "\n", "\n", "# initialise weights", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_3Plus.UNet_3Plus_DeepSup_CGM.dotProduct": [[702, 708], ["seg.view.view.size", "seg.view.view.view", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "final.view.view.view"], "methods", ["None"], ["", "", "", "def", "dotProduct", "(", "self", ",", "seg", ",", "cls", ")", ":", "\n", "        ", "B", ",", "N", ",", "H", ",", "W", "=", "seg", ".", "size", "(", ")", "\n", "seg", "=", "seg", ".", "view", "(", "B", ",", "N", ",", "H", "*", "W", ")", "\n", "final", "=", "torch", ".", "einsum", "(", "\"ijk,ij->ijk\"", ",", "[", "seg", ",", "cls", "]", ")", "\n", "final", "=", "final", ".", "view", "(", "B", ",", "N", ",", "H", ",", "W", ")", "\n", "return", "final", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_3Plus.UNet_3Plus_DeepSup_CGM.forward": [[709, 784], ["UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.maxpool1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv2", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.maxpool2", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv3", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.maxpool3", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv4", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.maxpool4", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv5", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.cls().squeeze().squeeze", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.argmax", "cls_branch_max[].float", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h3_PT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h4_Cat_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd4_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.relu4d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h3_Cat_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd3_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.relu3d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_Cat_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd2_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.relu2d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_Cat_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd2_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd1_relu", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.relu1d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.outconv5", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.upscore5", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.outconv4", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.upscore4", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.outconv3", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.upscore3", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.outconv2", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.upscore2", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.outconv1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.dotProduct", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.dotProduct", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.dotProduct", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.dotProduct", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.dotProduct", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h3_PT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h4_Cat_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd4_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.bn4d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h3_Cat_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd3_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.bn3d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_Cat_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd2_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.bn2d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_Cat_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd2_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd1_bn", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.bn1d_1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.cls().squeeze", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h3_PT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h4_Cat_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd4_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv4d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h3_Cat_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd3_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv3d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_Cat_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd2_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv2d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_Cat_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd2_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd1_conv", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.conv1d_1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd4", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd4", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h3_PT_hd4", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd4", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd3", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h2_PT_hd3", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd3", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd3", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.h1_PT_hd2", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd2", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd2", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd2", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd2_UT_hd1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd3_UT_hd1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd4_UT_hd1", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.hd5_UT_hd1", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "UNet_3Plus.UNet_3Plus_DeepSup_CGM.cls"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.dotProduct", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.dotProduct", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.dotProduct", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.dotProduct", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.dotProduct"], ["", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "## -------------Encoder-------------", "\n", "        ", "h1", "=", "self", ".", "conv1", "(", "inputs", ")", "# h1->320*320*64", "\n", "\n", "h2", "=", "self", ".", "maxpool1", "(", "h1", ")", "\n", "h2", "=", "self", ".", "conv2", "(", "h2", ")", "# h2->160*160*128", "\n", "\n", "h3", "=", "self", ".", "maxpool2", "(", "h2", ")", "\n", "h3", "=", "self", ".", "conv3", "(", "h3", ")", "# h3->80*80*256", "\n", "\n", "h4", "=", "self", ".", "maxpool3", "(", "h3", ")", "\n", "h4", "=", "self", ".", "conv4", "(", "h4", ")", "# h4->40*40*512", "\n", "\n", "h5", "=", "self", ".", "maxpool4", "(", "h4", ")", "\n", "hd5", "=", "self", ".", "conv5", "(", "h5", ")", "# h5->20*20*1024", "\n", "\n", "# -------------Classification-------------", "\n", "cls_branch", "=", "self", ".", "cls", "(", "hd5", ")", ".", "squeeze", "(", "3", ")", ".", "squeeze", "(", "2", ")", "# (B,N,1,1)->(B,N)", "\n", "cls_branch_max", "=", "cls_branch", ".", "argmax", "(", "dim", "=", "1", ")", "\n", "cls_branch_max", "=", "cls_branch_max", "[", ":", ",", "np", ".", "newaxis", "]", ".", "float", "(", ")", "\n", "\n", "## -------------Decoder-------------", "\n", "h1_PT_hd4", "=", "self", ".", "h1_PT_hd4_relu", "(", "self", ".", "h1_PT_hd4_bn", "(", "self", ".", "h1_PT_hd4_conv", "(", "self", ".", "h1_PT_hd4", "(", "h1", ")", ")", ")", ")", "\n", "h2_PT_hd4", "=", "self", ".", "h2_PT_hd4_relu", "(", "self", ".", "h2_PT_hd4_bn", "(", "self", ".", "h2_PT_hd4_conv", "(", "self", ".", "h2_PT_hd4", "(", "h2", ")", ")", ")", ")", "\n", "h3_PT_hd4", "=", "self", ".", "h3_PT_hd4_relu", "(", "self", ".", "h3_PT_hd4_bn", "(", "self", ".", "h3_PT_hd4_conv", "(", "self", ".", "h3_PT_hd4", "(", "h3", ")", ")", ")", ")", "\n", "h4_Cat_hd4", "=", "self", ".", "h4_Cat_hd4_relu", "(", "self", ".", "h4_Cat_hd4_bn", "(", "self", ".", "h4_Cat_hd4_conv", "(", "h4", ")", ")", ")", "\n", "hd5_UT_hd4", "=", "self", ".", "hd5_UT_hd4_relu", "(", "self", ".", "hd5_UT_hd4_bn", "(", "self", ".", "hd5_UT_hd4_conv", "(", "self", ".", "hd5_UT_hd4", "(", "hd5", ")", ")", ")", ")", "\n", "hd4", "=", "self", ".", "relu4d_1", "(", "self", ".", "bn4d_1", "(", "self", ".", "conv4d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd4", ",", "h2_PT_hd4", ",", "h3_PT_hd4", ",", "h4_Cat_hd4", ",", "hd5_UT_hd4", ")", ",", "1", ")", ")", ")", ")", "# hd4->40*40*UpChannels", "\n", "\n", "h1_PT_hd3", "=", "self", ".", "h1_PT_hd3_relu", "(", "self", ".", "h1_PT_hd3_bn", "(", "self", ".", "h1_PT_hd3_conv", "(", "self", ".", "h1_PT_hd3", "(", "h1", ")", ")", ")", ")", "\n", "h2_PT_hd3", "=", "self", ".", "h2_PT_hd3_relu", "(", "self", ".", "h2_PT_hd3_bn", "(", "self", ".", "h2_PT_hd3_conv", "(", "self", ".", "h2_PT_hd3", "(", "h2", ")", ")", ")", ")", "\n", "h3_Cat_hd3", "=", "self", ".", "h3_Cat_hd3_relu", "(", "self", ".", "h3_Cat_hd3_bn", "(", "self", ".", "h3_Cat_hd3_conv", "(", "h3", ")", ")", ")", "\n", "hd4_UT_hd3", "=", "self", ".", "hd4_UT_hd3_relu", "(", "self", ".", "hd4_UT_hd3_bn", "(", "self", ".", "hd4_UT_hd3_conv", "(", "self", ".", "hd4_UT_hd3", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd3", "=", "self", ".", "hd5_UT_hd3_relu", "(", "self", ".", "hd5_UT_hd3_bn", "(", "self", ".", "hd5_UT_hd3_conv", "(", "self", ".", "hd5_UT_hd3", "(", "hd5", ")", ")", ")", ")", "\n", "hd3", "=", "self", ".", "relu3d_1", "(", "self", ".", "bn3d_1", "(", "self", ".", "conv3d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd3", ",", "h2_PT_hd3", ",", "h3_Cat_hd3", ",", "hd4_UT_hd3", ",", "hd5_UT_hd3", ")", ",", "1", ")", ")", ")", ")", "# hd3->80*80*UpChannels", "\n", "\n", "h1_PT_hd2", "=", "self", ".", "h1_PT_hd2_relu", "(", "self", ".", "h1_PT_hd2_bn", "(", "self", ".", "h1_PT_hd2_conv", "(", "self", ".", "h1_PT_hd2", "(", "h1", ")", ")", ")", ")", "\n", "h2_Cat_hd2", "=", "self", ".", "h2_Cat_hd2_relu", "(", "self", ".", "h2_Cat_hd2_bn", "(", "self", ".", "h2_Cat_hd2_conv", "(", "h2", ")", ")", ")", "\n", "hd3_UT_hd2", "=", "self", ".", "hd3_UT_hd2_relu", "(", "self", ".", "hd3_UT_hd2_bn", "(", "self", ".", "hd3_UT_hd2_conv", "(", "self", ".", "hd3_UT_hd2", "(", "hd3", ")", ")", ")", ")", "\n", "hd4_UT_hd2", "=", "self", ".", "hd4_UT_hd2_relu", "(", "self", ".", "hd4_UT_hd2_bn", "(", "self", ".", "hd4_UT_hd2_conv", "(", "self", ".", "hd4_UT_hd2", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd2", "=", "self", ".", "hd5_UT_hd2_relu", "(", "self", ".", "hd5_UT_hd2_bn", "(", "self", ".", "hd5_UT_hd2_conv", "(", "self", ".", "hd5_UT_hd2", "(", "hd5", ")", ")", ")", ")", "\n", "hd2", "=", "self", ".", "relu2d_1", "(", "self", ".", "bn2d_1", "(", "self", ".", "conv2d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_PT_hd2", ",", "h2_Cat_hd2", ",", "hd3_UT_hd2", ",", "hd4_UT_hd2", ",", "hd5_UT_hd2", ")", ",", "1", ")", ")", ")", ")", "# hd2->160*160*UpChannels", "\n", "\n", "h1_Cat_hd1", "=", "self", ".", "h1_Cat_hd1_relu", "(", "self", ".", "h1_Cat_hd1_bn", "(", "self", ".", "h1_Cat_hd1_conv", "(", "h1", ")", ")", ")", "\n", "hd2_UT_hd1", "=", "self", ".", "hd2_UT_hd1_relu", "(", "self", ".", "hd2_UT_hd1_bn", "(", "self", ".", "hd2_UT_hd1_conv", "(", "self", ".", "hd2_UT_hd1", "(", "hd2", ")", ")", ")", ")", "\n", "hd3_UT_hd1", "=", "self", ".", "hd3_UT_hd1_relu", "(", "self", ".", "hd3_UT_hd1_bn", "(", "self", ".", "hd3_UT_hd1_conv", "(", "self", ".", "hd3_UT_hd1", "(", "hd3", ")", ")", ")", ")", "\n", "hd4_UT_hd1", "=", "self", ".", "hd4_UT_hd1_relu", "(", "self", ".", "hd4_UT_hd1_bn", "(", "self", ".", "hd4_UT_hd1_conv", "(", "self", ".", "hd4_UT_hd1", "(", "hd4", ")", ")", ")", ")", "\n", "hd5_UT_hd1", "=", "self", ".", "hd5_UT_hd1_relu", "(", "self", ".", "hd5_UT_hd1_bn", "(", "self", ".", "hd5_UT_hd1_conv", "(", "self", ".", "hd5_UT_hd1", "(", "hd5", ")", ")", ")", ")", "\n", "hd1", "=", "self", ".", "relu1d_1", "(", "self", ".", "bn1d_1", "(", "self", ".", "conv1d_1", "(", "\n", "torch", ".", "cat", "(", "(", "h1_Cat_hd1", ",", "hd2_UT_hd1", ",", "hd3_UT_hd1", ",", "hd4_UT_hd1", ",", "hd5_UT_hd1", ")", ",", "1", ")", ")", ")", ")", "# hd1->320*320*UpChannels", "\n", "\n", "d5", "=", "self", ".", "outconv5", "(", "hd5", ")", "\n", "d5", "=", "self", ".", "upscore5", "(", "d5", ")", "# 16->256", "\n", "\n", "d4", "=", "self", ".", "outconv4", "(", "hd4", ")", "\n", "d4", "=", "self", ".", "upscore4", "(", "d4", ")", "# 32->256", "\n", "\n", "d3", "=", "self", ".", "outconv3", "(", "hd3", ")", "\n", "d3", "=", "self", ".", "upscore3", "(", "d3", ")", "# 64->256", "\n", "\n", "d2", "=", "self", ".", "outconv2", "(", "hd2", ")", "\n", "d2", "=", "self", ".", "upscore2", "(", "d2", ")", "# 128->256", "\n", "\n", "d1", "=", "self", ".", "outconv1", "(", "hd1", ")", "# 256", "\n", "\n", "d1", "=", "self", ".", "dotProduct", "(", "d1", ",", "cls_branch_max", ")", "\n", "d2", "=", "self", ".", "dotProduct", "(", "d2", ",", "cls_branch_max", ")", "\n", "d3", "=", "self", ".", "dotProduct", "(", "d3", ",", "cls_branch_max", ")", "\n", "d4", "=", "self", ".", "dotProduct", "(", "d4", ",", "cls_branch_max", ")", "\n", "d5", "=", "self", ".", "dotProduct", "(", "d5", ",", "cls_branch_max", ")", "\n", "\n", "return", "F", ".", "sigmoid", "(", "d1", ")", ",", "F", ".", "sigmoid", "(", "d2", ")", ",", "F", ".", "sigmoid", "(", "d3", ")", ",", "F", ".", "sigmoid", "(", "d4", ")", ",", "F", ".", "sigmoid", "(", "d5", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_2Plus.UNet_2Plus.__init__": [[11, 62], ["torch.Module.__init__", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "layers.unetUp_origin", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "UNet_2Plus.UNet_2Plus.modules", "isinstance", "init_weights.init_weights.init_weights", "isinstance", "init_weights.init_weights.init_weights"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "n_classes", "=", "1", ",", "feature_scale", "=", "4", ",", "is_deconv", "=", "True", ",", "is_batchnorm", "=", "True", ",", "is_ds", "=", "True", ")", ":", "\n", "        ", "super", "(", "UNet_2Plus", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "is_deconv", "=", "is_deconv", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "is_batchnorm", "=", "is_batchnorm", "\n", "self", ".", "is_ds", "=", "is_ds", "\n", "self", ".", "feature_scale", "=", "feature_scale", "\n", "\n", "# filters = [32, 64, 128, 256, 512]", "\n", "filters", "=", "[", "64", ",", "128", ",", "256", ",", "512", ",", "1024", "]", "\n", "# filters = [int(x / self.feature_scale) for x in filters]", "\n", "\n", "# downsampling", "\n", "self", ".", "conv00", "=", "unetConv2", "(", "self", ".", "in_channels", ",", "filters", "[", "0", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool0", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "self", ".", "conv10", "=", "unetConv2", "(", "filters", "[", "0", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool1", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "self", ".", "conv20", "=", "unetConv2", "(", "filters", "[", "1", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool2", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "self", ".", "conv30", "=", "unetConv2", "(", "filters", "[", "2", "]", ",", "filters", "[", "3", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool3", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "self", ".", "conv40", "=", "unetConv2", "(", "filters", "[", "3", "]", ",", "filters", "[", "4", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "\n", "\n", "# upsampling", "\n", "self", ".", "up_concat01", "=", "unetUp_origin", "(", "filters", "[", "1", "]", ",", "filters", "[", "0", "]", ",", "self", ".", "is_deconv", ")", "\n", "self", ".", "up_concat11", "=", "unetUp_origin", "(", "filters", "[", "2", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_deconv", ")", "\n", "self", ".", "up_concat21", "=", "unetUp_origin", "(", "filters", "[", "3", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_deconv", ")", "\n", "self", ".", "up_concat31", "=", "unetUp_origin", "(", "filters", "[", "4", "]", ",", "filters", "[", "3", "]", ",", "self", ".", "is_deconv", ")", "\n", "\n", "self", ".", "up_concat02", "=", "unetUp_origin", "(", "filters", "[", "1", "]", ",", "filters", "[", "0", "]", ",", "self", ".", "is_deconv", ",", "3", ")", "\n", "self", ".", "up_concat12", "=", "unetUp_origin", "(", "filters", "[", "2", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_deconv", ",", "3", ")", "\n", "self", ".", "up_concat22", "=", "unetUp_origin", "(", "filters", "[", "3", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_deconv", ",", "3", ")", "\n", "\n", "self", ".", "up_concat03", "=", "unetUp_origin", "(", "filters", "[", "1", "]", ",", "filters", "[", "0", "]", ",", "self", ".", "is_deconv", ",", "4", ")", "\n", "self", ".", "up_concat13", "=", "unetUp_origin", "(", "filters", "[", "2", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_deconv", ",", "4", ")", "\n", "\n", "self", ".", "up_concat04", "=", "unetUp_origin", "(", "filters", "[", "1", "]", ",", "filters", "[", "0", "]", ",", "self", ".", "is_deconv", ",", "5", ")", "\n", "\n", "# final conv (without any concat)", "\n", "self", ".", "final_1", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "n_classes", ",", "1", ")", "\n", "self", ".", "final_2", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "n_classes", ",", "1", ")", "\n", "self", ".", "final_3", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "n_classes", ",", "1", ")", "\n", "self", ".", "final_4", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "n_classes", ",", "1", ")", "\n", "\n", "# initialise weights", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet_2Plus.UNet_2Plus.forward": [[63, 102], ["UNet_2Plus.UNet_2Plus.conv00", "UNet_2Plus.UNet_2Plus.maxpool0", "UNet_2Plus.UNet_2Plus.conv10", "UNet_2Plus.UNet_2Plus.maxpool1", "UNet_2Plus.UNet_2Plus.conv20", "UNet_2Plus.UNet_2Plus.maxpool2", "UNet_2Plus.UNet_2Plus.conv30", "UNet_2Plus.UNet_2Plus.maxpool3", "UNet_2Plus.UNet_2Plus.conv40", "UNet_2Plus.UNet_2Plus.up_concat01", "UNet_2Plus.UNet_2Plus.up_concat11", "UNet_2Plus.UNet_2Plus.up_concat21", "UNet_2Plus.UNet_2Plus.up_concat31", "UNet_2Plus.UNet_2Plus.up_concat02", "UNet_2Plus.UNet_2Plus.up_concat12", "UNet_2Plus.UNet_2Plus.up_concat22", "UNet_2Plus.UNet_2Plus.up_concat03", "UNet_2Plus.UNet_2Plus.up_concat13", "UNet_2Plus.UNet_2Plus.up_concat04", "UNet_2Plus.UNet_2Plus.final_1", "UNet_2Plus.UNet_2Plus.final_2", "UNet_2Plus.UNet_2Plus.final_3", "UNet_2Plus.UNet_2Plus.final_4", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid"], "methods", ["None"], ["", "", "", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "# column : 0", "\n", "        ", "X_00", "=", "self", ".", "conv00", "(", "inputs", ")", "\n", "maxpool0", "=", "self", ".", "maxpool0", "(", "X_00", ")", "\n", "X_10", "=", "self", ".", "conv10", "(", "maxpool0", ")", "\n", "maxpool1", "=", "self", ".", "maxpool1", "(", "X_10", ")", "\n", "X_20", "=", "self", ".", "conv20", "(", "maxpool1", ")", "\n", "maxpool2", "=", "self", ".", "maxpool2", "(", "X_20", ")", "\n", "X_30", "=", "self", ".", "conv30", "(", "maxpool2", ")", "\n", "maxpool3", "=", "self", ".", "maxpool3", "(", "X_30", ")", "\n", "X_40", "=", "self", ".", "conv40", "(", "maxpool3", ")", "\n", "\n", "# column : 1", "\n", "X_01", "=", "self", ".", "up_concat01", "(", "X_10", ",", "X_00", ")", "\n", "X_11", "=", "self", ".", "up_concat11", "(", "X_20", ",", "X_10", ")", "\n", "X_21", "=", "self", ".", "up_concat21", "(", "X_30", ",", "X_20", ")", "\n", "X_31", "=", "self", ".", "up_concat31", "(", "X_40", ",", "X_30", ")", "\n", "# column : 2", "\n", "X_02", "=", "self", ".", "up_concat02", "(", "X_11", ",", "X_00", ",", "X_01", ")", "\n", "X_12", "=", "self", ".", "up_concat12", "(", "X_21", ",", "X_10", ",", "X_11", ")", "\n", "X_22", "=", "self", ".", "up_concat22", "(", "X_31", ",", "X_20", ",", "X_21", ")", "\n", "# column : 3", "\n", "X_03", "=", "self", ".", "up_concat03", "(", "X_12", ",", "X_00", ",", "X_01", ",", "X_02", ")", "\n", "X_13", "=", "self", ".", "up_concat13", "(", "X_22", ",", "X_10", ",", "X_11", ",", "X_12", ")", "\n", "# column : 4", "\n", "X_04", "=", "self", ".", "up_concat04", "(", "X_13", ",", "X_00", ",", "X_01", ",", "X_02", ",", "X_03", ")", "\n", "\n", "# final layer", "\n", "final_1", "=", "self", ".", "final_1", "(", "X_01", ")", "\n", "final_2", "=", "self", ".", "final_2", "(", "X_02", ")", "\n", "final_3", "=", "self", ".", "final_3", "(", "X_03", ")", "\n", "final_4", "=", "self", ".", "final_4", "(", "X_04", ")", "\n", "\n", "final", "=", "(", "final_1", "+", "final_2", "+", "final_3", "+", "final_4", ")", "/", "4", "\n", "\n", "if", "self", ".", "is_ds", ":", "\n", "            ", "return", "F", ".", "sigmoid", "(", "final", ")", "\n", "", "else", ":", "\n", "            ", "return", "F", ".", "sigmoid", "(", "final_4", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.layers.unetConv2.__init__": [[8, 34], ["torch.Module.__init__", "layers.unetConv2.children", "range", "range", "init_weights.init_weights.init_weights", "torch.Sequential", "torch.Sequential", "torch.Sequential", "setattr", "torch.Sequential", "torch.Sequential", "torch.Sequential", "setattr", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.BatchNorm2d", "torch.ReLU", "torch.ReLU", "torch.ReLU", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "torch.ReLU", "torch.ReLU", "torch.ReLU"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "is_batchnorm", ",", "n", "=", "2", ",", "ks", "=", "3", ",", "stride", "=", "1", ",", "padding", "=", "1", ")", ":", "\n", "        ", "super", "(", "unetConv2", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "n", "=", "n", "\n", "self", ".", "ks", "=", "ks", "\n", "self", ".", "stride", "=", "stride", "\n", "self", ".", "padding", "=", "padding", "\n", "s", "=", "stride", "\n", "p", "=", "padding", "\n", "if", "is_batchnorm", ":", "\n", "            ", "for", "i", "in", "range", "(", "1", ",", "n", "+", "1", ")", ":", "\n", "                ", "conv", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "ks", ",", "s", ",", "p", ")", ",", "\n", "nn", ".", "BatchNorm2d", "(", "out_size", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", ")", "\n", "setattr", "(", "self", ",", "'conv%d'", "%", "i", ",", "conv", ")", "\n", "in_size", "=", "out_size", "\n", "\n", "", "", "else", ":", "\n", "            ", "for", "i", "in", "range", "(", "1", ",", "n", "+", "1", ")", ":", "\n", "                ", "conv", "=", "nn", ".", "Sequential", "(", "nn", ".", "Conv2d", "(", "in_size", ",", "out_size", ",", "ks", ",", "s", ",", "p", ")", ",", "\n", "nn", ".", "ReLU", "(", "inplace", "=", "True", ")", ",", ")", "\n", "setattr", "(", "self", ",", "'conv%d'", "%", "i", ",", "conv", ")", "\n", "in_size", "=", "out_size", "\n", "\n", "# initialise the blocks", "\n", "", "", "for", "m", "in", "self", ".", "children", "(", ")", ":", "\n", "            ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.layers.unetConv2.forward": [[35, 42], ["range", "getattr", "getattr."], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "        ", "x", "=", "inputs", "\n", "for", "i", "in", "range", "(", "1", ",", "self", ".", "n", "+", "1", ")", ":", "\n", "            ", "conv", "=", "getattr", "(", "self", ",", "'conv%d'", "%", "i", ")", "\n", "x", "=", "conv", "(", "x", ")", "\n", "\n", "", "return", "x", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.layers.unetUp.__init__": [[44, 57], ["torch.Module.__init__", "layers.unetConv2", "layers.unetUp.children", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.UpsamplingBilinear2d", "torch.UpsamplingBilinear2d", "torch.UpsamplingBilinear2d", "init_weights.init_weights.init_weights", "m.__class__.__name__.find"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "is_deconv", ",", "n_concat", "=", "2", ")", ":", "\n", "        ", "super", "(", "unetUp", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# self.conv = unetConv2(in_size + (n_concat - 2) * out_size, out_size, False)", "\n", "self", ".", "conv", "=", "unetConv2", "(", "out_size", "*", "2", ",", "out_size", ",", "False", ")", "\n", "if", "is_deconv", ":", "\n", "            ", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "up", "=", "nn", ".", "UpsamplingBilinear2d", "(", "scale_factor", "=", "2", ")", "\n", "\n", "# initialise the blocks", "\n", "", "for", "m", "in", "self", ".", "children", "(", ")", ":", "\n", "            ", "if", "m", ".", "__class__", ".", "__name__", ".", "find", "(", "'unetConv2'", ")", "!=", "-", "1", ":", "continue", "\n", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.layers.unetUp.forward": [[58, 65], ["layers.unetUp.up", "range", "layers.unetUp.conv", "len", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "inputs0", ",", "*", "input", ")", ":", "\n", "# print(self.n_concat)", "\n", "# print(input)", "\n", "        ", "outputs0", "=", "self", ".", "up", "(", "inputs0", ")", "\n", "for", "i", "in", "range", "(", "len", "(", "input", ")", ")", ":", "\n", "            ", "outputs0", "=", "torch", ".", "cat", "(", "[", "outputs0", ",", "input", "[", "i", "]", "]", ",", "1", ")", "\n", "", "return", "self", ".", "conv", "(", "outputs0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.layers.unetUp_origin.__init__": [[67, 81], ["torch.Module.__init__", "layers.unetUp_origin.children", "layers.unetConv2", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "torch.ConvTranspose2d", "layers.unetConv2", "torch.UpsamplingBilinear2d", "torch.UpsamplingBilinear2d", "torch.UpsamplingBilinear2d", "init_weights.init_weights.init_weights", "m.__class__.__name__.find"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_size", ",", "out_size", ",", "is_deconv", ",", "n_concat", "=", "2", ")", ":", "\n", "        ", "super", "(", "unetUp_origin", ",", "self", ")", ".", "__init__", "(", ")", "\n", "# self.conv = unetConv2(out_size*2, out_size, False)", "\n", "if", "is_deconv", ":", "\n", "            ", "self", ".", "conv", "=", "unetConv2", "(", "in_size", "+", "(", "n_concat", "-", "2", ")", "*", "out_size", ",", "out_size", ",", "False", ")", "\n", "self", ".", "up", "=", "nn", ".", "ConvTranspose2d", "(", "in_size", ",", "out_size", ",", "kernel_size", "=", "4", ",", "stride", "=", "2", ",", "padding", "=", "1", ")", "\n", "", "else", ":", "\n", "            ", "self", ".", "conv", "=", "unetConv2", "(", "in_size", "+", "(", "n_concat", "-", "2", ")", "*", "out_size", ",", "out_size", ",", "False", ")", "\n", "self", ".", "up", "=", "nn", ".", "UpsamplingBilinear2d", "(", "scale_factor", "=", "2", ")", "\n", "\n", "# initialise the blocks", "\n", "", "for", "m", "in", "self", ".", "children", "(", ")", ":", "\n", "            ", "if", "m", ".", "__class__", ".", "__name__", ".", "find", "(", "'unetConv2'", ")", "!=", "-", "1", ":", "continue", "\n", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.layers.unetUp_origin.forward": [[82, 89], ["layers.unetUp_origin.up", "range", "layers.unetUp_origin.conv", "len", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat", "torch.cat"], "methods", ["None"], ["", "", "def", "forward", "(", "self", ",", "inputs0", ",", "*", "input", ")", ":", "\n", "# print(self.n_concat)", "\n", "# print(input)", "\n", "        ", "outputs0", "=", "self", ".", "up", "(", "inputs0", ")", "\n", "for", "i", "in", "range", "(", "len", "(", "input", ")", ")", ":", "\n", "            ", "outputs0", "=", "torch", ".", "cat", "(", "[", "outputs0", ",", "input", "[", "i", "]", "]", ",", "1", ")", "\n", "", "return", "self", ".", "conv", "(", "outputs0", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.weights_init_normal": [[5, 15], ["classname.find", "torch.nn.init.normal_", "classname.find", "torch.nn.init.normal_", "classname.find", "torch.nn.init.normal_", "torch.nn.init.constant_"], "function", ["None"], ["def", "weights_init_normal", "(", "m", ")", ":", "\n", "    ", "classname", "=", "m", ".", "__class__", ".", "__name__", "\n", "#print(classname)", "\n", "if", "classname", ".", "find", "(", "'Conv'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "normal_", "(", "m", ".", "weight", ".", "data", ",", "0.0", ",", "0.02", ")", "\n", "", "elif", "classname", ".", "find", "(", "'Linear'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "normal_", "(", "m", ".", "weight", ".", "data", ",", "0.0", ",", "0.02", ")", "\n", "", "elif", "classname", ".", "find", "(", "'BatchNorm'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "normal_", "(", "m", ".", "weight", ".", "data", ",", "1.0", ",", "0.02", ")", "\n", "init", ".", "constant_", "(", "m", ".", "bias", ".", "data", ",", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.weights_init_xavier": [[17, 27], ["classname.find", "torch.nn.init.xavier_normal_", "classname.find", "torch.nn.init.xavier_normal_", "classname.find", "torch.nn.init.normal_", "torch.nn.init.constant_"], "function", ["None"], ["", "", "def", "weights_init_xavier", "(", "m", ")", ":", "\n", "    ", "classname", "=", "m", ".", "__class__", ".", "__name__", "\n", "#print(classname)", "\n", "if", "classname", ".", "find", "(", "'Conv'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "xavier_normal_", "(", "m", ".", "weight", ".", "data", ",", "gain", "=", "1", ")", "\n", "", "elif", "classname", ".", "find", "(", "'Linear'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "xavier_normal_", "(", "m", ".", "weight", ".", "data", ",", "gain", "=", "1", ")", "\n", "", "elif", "classname", ".", "find", "(", "'BatchNorm'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "normal_", "(", "m", ".", "weight", ".", "data", ",", "1.0", ",", "0.02", ")", "\n", "init", ".", "constant_", "(", "m", ".", "bias", ".", "data", ",", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.weights_init_kaiming": [[29, 39], ["classname.find", "torch.nn.init.kaiming_normal_", "classname.find", "torch.nn.init.kaiming_normal_", "classname.find", "torch.nn.init.normal_", "torch.nn.init.constant_"], "function", ["None"], ["", "", "def", "weights_init_kaiming", "(", "m", ")", ":", "\n", "    ", "classname", "=", "m", ".", "__class__", ".", "__name__", "\n", "#print(classname)", "\n", "if", "classname", ".", "find", "(", "'Conv'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "kaiming_normal_", "(", "m", ".", "weight", ".", "data", ",", "a", "=", "0", ",", "mode", "=", "'fan_in'", ")", "\n", "", "elif", "classname", ".", "find", "(", "'Linear'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "kaiming_normal_", "(", "m", ".", "weight", ".", "data", ",", "a", "=", "0", ",", "mode", "=", "'fan_in'", ")", "\n", "", "elif", "classname", ".", "find", "(", "'BatchNorm'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "normal_", "(", "m", ".", "weight", ".", "data", ",", "1.0", ",", "0.02", ")", "\n", "init", ".", "constant_", "(", "m", ".", "bias", ".", "data", ",", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.weights_init_orthogonal": [[41, 51], ["classname.find", "torch.nn.init.orthogonal_", "classname.find", "torch.nn.init.orthogonal_", "classname.find", "torch.nn.init.normal_", "torch.nn.init.constant_"], "function", ["None"], ["", "", "def", "weights_init_orthogonal", "(", "m", ")", ":", "\n", "    ", "classname", "=", "m", ".", "__class__", ".", "__name__", "\n", "#print(classname)", "\n", "if", "classname", ".", "find", "(", "'Conv'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "orthogonal_", "(", "m", ".", "weight", ".", "data", ",", "gain", "=", "1", ")", "\n", "", "elif", "classname", ".", "find", "(", "'Linear'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "orthogonal_", "(", "m", ".", "weight", ".", "data", ",", "gain", "=", "1", ")", "\n", "", "elif", "classname", ".", "find", "(", "'BatchNorm'", ")", "!=", "-", "1", ":", "\n", "        ", "init", ".", "normal_", "(", "m", ".", "weight", ".", "data", ",", "1.0", ",", "0.02", ")", "\n", "init", ".", "constant_", "(", "m", ".", "bias", ".", "data", ",", "0.0", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights": [[53, 65], ["net.apply", "net.apply", "net.apply", "net.apply", "NotImplementedError"], "function", ["None"], ["", "", "def", "init_weights", "(", "net", ",", "init_type", "=", "'normal'", ")", ":", "\n", "#print('initialization method [%s]' % init_type)", "\n", "    ", "if", "init_type", "==", "'normal'", ":", "\n", "        ", "net", ".", "apply", "(", "weights_init_normal", ")", "\n", "", "elif", "init_type", "==", "'xavier'", ":", "\n", "        ", "net", ".", "apply", "(", "weights_init_xavier", ")", "\n", "", "elif", "init_type", "==", "'kaiming'", ":", "\n", "        ", "net", ".", "apply", "(", "weights_init_kaiming", ")", "\n", "", "elif", "init_type", "==", "'orthogonal'", ":", "\n", "        ", "net", ".", "apply", "(", "weights_init_orthogonal", ")", "\n", "", "else", ":", "\n", "        ", "raise", "NotImplementedError", "(", "'initialization method [%s] is not implemented'", "%", "init_type", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.__init__": [[12, 52], ["torch.Module.__init__", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "torch.MaxPool2d", "torch.MaxPool2d", "torch.MaxPool2d", "layers.unetConv2", "layers.unetUp", "layers.unetUp", "layers.unetUp", "layers.unetUp", "torch.Conv2d", "torch.Conv2d", "torch.Conv2d", "UNet.UNet.modules", "isinstance", "init_weights.init_weights.init_weights", "isinstance", "init_weights.init_weights.init_weights"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.init_weights.init_weights"], ["    ", "def", "__init__", "(", "self", ",", "in_channels", "=", "3", ",", "n_classes", "=", "1", ",", "feature_scale", "=", "4", ",", "is_deconv", "=", "True", ",", "is_batchnorm", "=", "True", ")", ":", "\n", "        ", "super", "(", "UNet", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "is_deconv", "=", "is_deconv", "\n", "self", ".", "in_channels", "=", "in_channels", "\n", "self", ".", "is_batchnorm", "=", "is_batchnorm", "\n", "self", ".", "feature_scale", "=", "feature_scale", "\n", "#", "\n", "# filters = [32, 64, 128, 256, 512]", "\n", "filters", "=", "[", "64", ",", "128", ",", "256", ",", "512", ",", "1024", "]", "\n", "# # filters = [int(x / self.feature_scale) for x in filters]", "\n", "\n", "# downsampling", "\n", "self", ".", "conv1", "=", "unetConv2", "(", "self", ".", "in_channels", ",", "filters", "[", "0", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool1", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv2", "=", "unetConv2", "(", "filters", "[", "0", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool2", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv3", "=", "unetConv2", "(", "filters", "[", "1", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool3", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "conv4", "=", "unetConv2", "(", "filters", "[", "2", "]", ",", "filters", "[", "3", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "self", ".", "maxpool4", "=", "nn", ".", "MaxPool2d", "(", "kernel_size", "=", "2", ")", "\n", "\n", "self", ".", "center", "=", "unetConv2", "(", "filters", "[", "3", "]", ",", "filters", "[", "4", "]", ",", "self", ".", "is_batchnorm", ")", "\n", "\n", "# upsampling", "\n", "self", ".", "up_concat4", "=", "unetUp", "(", "filters", "[", "4", "]", ",", "filters", "[", "3", "]", ",", "self", ".", "is_deconv", ")", "\n", "self", ".", "up_concat3", "=", "unetUp", "(", "filters", "[", "3", "]", ",", "filters", "[", "2", "]", ",", "self", ".", "is_deconv", ")", "\n", "self", ".", "up_concat2", "=", "unetUp", "(", "filters", "[", "2", "]", ",", "filters", "[", "1", "]", ",", "self", ".", "is_deconv", ")", "\n", "self", ".", "up_concat1", "=", "unetUp", "(", "filters", "[", "1", "]", ",", "filters", "[", "0", "]", ",", "self", ".", "is_deconv", ")", "\n", "#", "\n", "self", ".", "outconv1", "=", "nn", ".", "Conv2d", "(", "filters", "[", "0", "]", ",", "1", ",", "3", ",", "padding", "=", "1", ")", "\n", "\n", "# initialise weights", "\n", "for", "m", "in", "self", ".", "modules", "(", ")", ":", "\n", "            ", "if", "isinstance", "(", "m", ",", "nn", ".", "Conv2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "", "elif", "isinstance", "(", "m", ",", "nn", ".", "BatchNorm2d", ")", ":", "\n", "                ", "init_weights", "(", "m", ",", "init_type", "=", "'kaiming'", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.dotProduct": [[53, 59], ["seg.view.view.size", "seg.view.view.view", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "torch.einsum", "final.view.view.view"], "methods", ["None"], ["", "", "", "def", "dotProduct", "(", "self", ",", "seg", ",", "cls", ")", ":", "\n", "        ", "B", ",", "N", ",", "H", ",", "W", "=", "seg", ".", "size", "(", ")", "\n", "seg", "=", "seg", ".", "view", "(", "B", ",", "N", ",", "H", "*", "W", ")", "\n", "final", "=", "torch", ".", "einsum", "(", "\"ijk,ij->ijk\"", ",", "[", "seg", ",", "cls", "]", ")", "\n", "final", "=", "final", ".", "view", "(", "B", ",", "N", ",", "H", ",", "W", ")", "\n", "return", "final", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.models.UNet.UNet.forward": [[60, 83], ["UNet.UNet.conv1", "UNet.UNet.maxpool1", "UNet.UNet.conv2", "UNet.UNet.maxpool2", "UNet.UNet.conv3", "UNet.UNet.maxpool3", "UNet.UNet.conv4", "UNet.UNet.maxpool4", "UNet.UNet.center", "UNet.UNet.up_concat4", "UNet.UNet.up_concat3", "UNet.UNet.up_concat2", "UNet.UNet.up_concat1", "UNet.UNet.outconv1", "torch.sigmoid", "torch.sigmoid", "torch.sigmoid"], "methods", ["None"], ["", "def", "forward", "(", "self", ",", "inputs", ")", ":", "\n", "        ", "conv1", "=", "self", ".", "conv1", "(", "inputs", ")", "# 16*512*1024", "\n", "maxpool1", "=", "self", ".", "maxpool1", "(", "conv1", ")", "# 16*256*512", "\n", "\n", "conv2", "=", "self", ".", "conv2", "(", "maxpool1", ")", "# 32*256*512", "\n", "maxpool2", "=", "self", ".", "maxpool2", "(", "conv2", ")", "# 32*128*256", "\n", "\n", "conv3", "=", "self", ".", "conv3", "(", "maxpool2", ")", "# 64*128*256", "\n", "maxpool3", "=", "self", ".", "maxpool3", "(", "conv3", ")", "# 64*64*128", "\n", "\n", "conv4", "=", "self", ".", "conv4", "(", "maxpool3", ")", "# 128*64*128", "\n", "maxpool4", "=", "self", ".", "maxpool4", "(", "conv4", ")", "# 128*32*64", "\n", "\n", "center", "=", "self", ".", "center", "(", "maxpool4", ")", "# 256*32*64", "\n", "\n", "up4", "=", "self", ".", "up_concat4", "(", "center", ",", "conv4", ")", "# 128*64*128", "\n", "up3", "=", "self", ".", "up_concat3", "(", "up4", ",", "conv3", ")", "# 64*128*256", "\n", "up2", "=", "self", ".", "up_concat2", "(", "up3", ",", "conv2", ")", "# 32*256*512", "\n", "up1", "=", "self", ".", "up_concat1", "(", "up2", ",", "conv1", ")", "# 16*512*1024", "\n", "\n", "d1", "=", "self", ".", "outconv1", "(", "up1", ")", "# 256", "\n", "\n", "return", "F", ".", "sigmoid", "(", "d1", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.iouLoss.IOU.__init__": [[20, 23], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__"], ["    ", "def", "__init__", "(", "self", ",", "size_average", "=", "True", ")", ":", "\n", "        ", "super", "(", "IOU", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "size_average", "=", "size_average", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.iouLoss.IOU.forward": [[24, 27], ["iouLoss._iou"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.iouLoss._iou"], ["", "def", "forward", "(", "self", ",", "pred", ",", "target", ")", ":", "\n", "\n", "        ", "return", "_iou", "(", "pred", ",", "target", ",", "self", ".", "size_average", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.iouLoss._iou": [[3, 17], ["range", "torch.sum", "torch.sum", "torch.sum"], "function", ["None"], ["def", "_iou", "(", "pred", ",", "target", ",", "size_average", "=", "True", ")", ":", "\n", "\n", "    ", "b", "=", "pred", ".", "shape", "[", "0", "]", "\n", "IoU", "=", "0.0", "\n", "for", "i", "in", "range", "(", "0", ",", "b", ")", ":", "\n", "#compute the IoU of the foreground", "\n", "        ", "Iand1", "=", "torch", ".", "sum", "(", "target", "[", "i", ",", ":", ",", ":", ",", ":", "]", "*", "pred", "[", "i", ",", ":", ",", ":", ",", ":", "]", ")", "\n", "Ior1", "=", "torch", ".", "sum", "(", "target", "[", "i", ",", ":", ",", ":", ",", ":", "]", ")", "+", "torch", ".", "sum", "(", "pred", "[", "i", ",", ":", ",", ":", ",", ":", "]", ")", "-", "Iand1", "\n", "IoU1", "=", "Iand1", "/", "Ior1", "\n", "\n", "#IoU loss is (1-IoU1)", "\n", "IoU", "=", "IoU", "+", "(", "1", "-", "IoU1", ")", "\n", "\n", "", "return", "IoU", "/", "b", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.iouLoss.IOU_loss": [[28, 33], ["iouLoss.IOU", "IOU.", "print", "iou_loss.data.cpu().numpy", "iou_loss.data.cpu"], "function", ["None"], ["", "", "def", "IOU_loss", "(", "pred", ",", "label", ")", ":", "\n", "    ", "iou_loss", "=", "IOU", "(", "size_average", "=", "True", ")", "\n", "iou_out", "=", "iou_loss", "(", "pred", ",", "label", ")", "\n", "print", "(", "\"iou_loss:\"", ",", "iou_out", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ")", "\n", "return", "iou_out", "\n", "", ""]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.SSIM.__init__": [[104, 113], ["super().__init__", "msssimLoss.create_window"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.create_window"], ["    ", "def", "__init__", "(", "self", ",", "window_size", "=", "11", ",", "size_average", "=", "True", ",", "val_range", "=", "None", ")", ":", "\n", "        ", "super", "(", "SSIM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "window_size", "=", "window_size", "\n", "self", ".", "size_average", "=", "size_average", "\n", "self", ".", "val_range", "=", "val_range", "\n", "\n", "# Assume 1 channel for SSIM", "\n", "self", ".", "channel", "=", "1", "\n", "self", ".", "window", "=", "create_window", "(", "window_size", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.SSIM.forward": [[114, 125], ["img1.size", "msssimLoss.ssim", "create_window().to().type", "create_window().to", "msssimLoss.create_window"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.ssim", "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.create_window"], ["", "def", "forward", "(", "self", ",", "img1", ",", "img2", ")", ":", "\n", "        ", "(", "_", ",", "channel", ",", "_", ",", "_", ")", "=", "img1", ".", "size", "(", ")", "\n", "\n", "if", "channel", "==", "self", ".", "channel", "and", "self", ".", "window", ".", "dtype", "==", "img1", ".", "dtype", ":", "\n", "            ", "window", "=", "self", ".", "window", "\n", "", "else", ":", "\n", "            ", "window", "=", "create_window", "(", "self", ".", "window_size", ",", "channel", ")", ".", "to", "(", "img1", ".", "device", ")", ".", "type", "(", "img1", ".", "dtype", ")", "\n", "self", ".", "window", "=", "window", "\n", "self", ".", "channel", "=", "channel", "\n", "\n", "", "return", "ssim", "(", "img1", ",", "img2", ",", "window", "=", "window", ",", "window_size", "=", "self", ".", "window_size", ",", "size_average", "=", "self", ".", "size_average", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__": [[127, 132], ["super().__init__"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.__init__"], ["    ", "def", "__init__", "(", "self", ",", "window_size", "=", "11", ",", "size_average", "=", "True", ",", "channel", "=", "3", ")", ":", "\n", "        ", "super", "(", "MSSSIM", ",", "self", ")", ".", "__init__", "(", ")", "\n", "self", ".", "window_size", "=", "window_size", "\n", "self", ".", "size_average", "=", "size_average", "\n", "self", ".", "channel", "=", "channel", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.MSSSIM.forward": [[133, 137], ["msssimLoss.msssim"], "methods", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.msssim"], ["", "def", "forward", "(", "self", ",", "img1", ",", "img2", ")", ":", "\n", "# TODO: store window between calls if possible,", "\n", "# return msssim(img1, img2, window_size=self.window_size, size_average=self.size_average)", "\n", "        ", "return", "msssim", "(", "img1", ",", "img2", ",", "window_size", "=", "self", ".", "window_size", ",", "size_average", "=", "self", ".", "size_average", ",", "normalize", "=", "True", ")", "\n", "", "", ""]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.gaussian": [[7, 10], ["torch.Tensor", "torch.Tensor", "torch.Tensor.sum", "math.exp", "range", "float"], "function", ["None"], ["def", "gaussian", "(", "window_size", ",", "sigma", ")", ":", "\n", "    ", "gauss", "=", "torch", ".", "Tensor", "(", "[", "exp", "(", "-", "(", "x", "-", "window_size", "//", "2", ")", "**", "2", "/", "float", "(", "2", "*", "sigma", "**", "2", ")", ")", "for", "x", "in", "range", "(", "window_size", ")", "]", ")", "\n", "return", "gauss", "/", "gauss", ".", "sum", "(", ")", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.create_window": [[12, 17], ["gaussian().unsqueeze", "gaussian().unsqueeze.mm().float().unsqueeze().unsqueeze", "_1D_window.mm().float().unsqueeze().unsqueeze.expand().contiguous", "msssimLoss.gaussian", "gaussian().unsqueeze.mm().float().unsqueeze", "_1D_window.mm().float().unsqueeze().unsqueeze.expand", "gaussian().unsqueeze.mm().float", "gaussian().unsqueeze.mm", "gaussian().unsqueeze.t"], "function", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.gaussian"], ["", "def", "create_window", "(", "window_size", ",", "channel", "=", "1", ")", ":", "\n", "    ", "_1D_window", "=", "gaussian", "(", "window_size", ",", "1.5", ")", ".", "unsqueeze", "(", "1", ")", "\n", "_2D_window", "=", "_1D_window", ".", "mm", "(", "_1D_window", ".", "t", "(", ")", ")", ".", "float", "(", ")", ".", "unsqueeze", "(", "0", ")", ".", "unsqueeze", "(", "0", ")", "\n", "window", "=", "_2D_window", ".", "expand", "(", "channel", ",", "1", ",", "window_size", ",", "window_size", ")", ".", "contiguous", "(", ")", "\n", "return", "window", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.ssim": [[19, 69], ["img1.size", "torch.conv2d", "torch.conv2d", "F.conv2d.pow", "F.conv2d.pow", "torch.mean", "torch.mean", "min", "create_window().to", "torch.conv2d", "torch.conv2d", "torch.conv2d", "ssim_map.mean", "ssim_map.mean().mean().mean", "torch.max", "torch.max", "torch.min", "torch.min", "msssimLoss.create_window", "ssim_map.mean().mean", "ssim_map.mean"], "function", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.create_window"], ["", "def", "ssim", "(", "img1", ",", "img2", ",", "window_size", "=", "11", ",", "window", "=", "None", ",", "size_average", "=", "True", ",", "full", "=", "False", ",", "val_range", "=", "None", ")", ":", "\n", "# Value range can be different from 255. Other common ranges are 1 (sigmoid) and 2 (tanh).", "\n", "    ", "if", "val_range", "is", "None", ":", "\n", "        ", "if", "torch", ".", "max", "(", "img1", ")", ">", "128", ":", "\n", "            ", "max_val", "=", "255", "\n", "", "else", ":", "\n", "            ", "max_val", "=", "1", "\n", "\n", "", "if", "torch", ".", "min", "(", "img1", ")", "<", "-", "0.5", ":", "\n", "            ", "min_val", "=", "-", "1", "\n", "", "else", ":", "\n", "            ", "min_val", "=", "0", "\n", "", "L", "=", "max_val", "-", "min_val", "\n", "", "else", ":", "\n", "        ", "L", "=", "val_range", "\n", "\n", "", "padd", "=", "0", "\n", "(", "_", ",", "channel", ",", "height", ",", "width", ")", "=", "img1", ".", "size", "(", ")", "\n", "if", "window", "is", "None", ":", "\n", "        ", "real_size", "=", "min", "(", "window_size", ",", "height", ",", "width", ")", "\n", "window", "=", "create_window", "(", "real_size", ",", "channel", "=", "channel", ")", ".", "to", "(", "img1", ".", "device", ")", "\n", "\n", "", "mu1", "=", "F", ".", "conv2d", "(", "img1", ",", "window", ",", "padding", "=", "padd", ",", "groups", "=", "channel", ")", "\n", "mu2", "=", "F", ".", "conv2d", "(", "img2", ",", "window", ",", "padding", "=", "padd", ",", "groups", "=", "channel", ")", "\n", "\n", "mu1_sq", "=", "mu1", ".", "pow", "(", "2", ")", "\n", "mu2_sq", "=", "mu2", ".", "pow", "(", "2", ")", "\n", "mu1_mu2", "=", "mu1", "*", "mu2", "\n", "\n", "sigma1_sq", "=", "F", ".", "conv2d", "(", "img1", "*", "img1", ",", "window", ",", "padding", "=", "padd", ",", "groups", "=", "channel", ")", "-", "mu1_sq", "\n", "sigma2_sq", "=", "F", ".", "conv2d", "(", "img2", "*", "img2", ",", "window", ",", "padding", "=", "padd", ",", "groups", "=", "channel", ")", "-", "mu2_sq", "\n", "sigma12", "=", "F", ".", "conv2d", "(", "img1", "*", "img2", ",", "window", ",", "padding", "=", "padd", ",", "groups", "=", "channel", ")", "-", "mu1_mu2", "\n", "\n", "C1", "=", "(", "0.01", "*", "L", ")", "**", "2", "\n", "C2", "=", "(", "0.03", "*", "L", ")", "**", "2", "\n", "\n", "v1", "=", "2.0", "*", "sigma12", "+", "C2", "\n", "v2", "=", "sigma1_sq", "+", "sigma2_sq", "+", "C2", "\n", "cs", "=", "torch", ".", "mean", "(", "v1", "/", "v2", ")", "# contrast sensitivity", "\n", "\n", "ssim_map", "=", "(", "(", "2", "*", "mu1_mu2", "+", "C1", ")", "*", "v1", ")", "/", "(", "(", "mu1_sq", "+", "mu2_sq", "+", "C1", ")", "*", "v2", ")", "\n", "\n", "if", "size_average", ":", "\n", "        ", "ret", "=", "ssim_map", ".", "mean", "(", ")", "\n", "", "else", ":", "\n", "        ", "ret", "=", "ssim_map", ".", "mean", "(", "1", ")", ".", "mean", "(", "1", ")", ".", "mean", "(", "1", ")", "\n", "\n", "", "if", "full", ":", "\n", "        ", "return", "ret", ",", "cs", "\n", "", "return", "ret", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.msssim": [[71, 100], ["torch.FloatTensor().to", "torch.FloatTensor().to", "range", "torch.stack", "torch.stack", "torch.stack", "torch.stack", "torch.prod", "torch.prod", "torch.FloatTensor().to.size", "msssimLoss.ssim", "print", "torch.stack.append", "torch.stack.append", "torch.avg_pool2d", "torch.avg_pool2d", "torch.FloatTensor", "torch.FloatTensor"], "function", ["home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.msssimLoss.ssim"], ["", "def", "msssim", "(", "img1", ",", "img2", ",", "window_size", "=", "11", ",", "size_average", "=", "True", ",", "val_range", "=", "None", ",", "normalize", "=", "False", ")", ":", "\n", "    ", "device", "=", "img1", ".", "device", "\n", "weights", "=", "torch", ".", "FloatTensor", "(", "[", "0.0448", ",", "0.2856", ",", "0.3001", ",", "0.2363", ",", "0.1333", "]", ")", ".", "to", "(", "device", ")", "\n", "# weights = torch.FloatTensor([0.0448, 0.2856, 0.3001, 0.2363, 0.1333])", "\n", "levels", "=", "weights", ".", "size", "(", ")", "[", "0", "]", "\n", "mssim", "=", "[", "]", "\n", "mcs", "=", "[", "]", "\n", "for", "_", "in", "range", "(", "levels", ")", ":", "\n", "        ", "sim", ",", "cs", "=", "ssim", "(", "img1", ",", "img2", ",", "window_size", "=", "window_size", ",", "size_average", "=", "size_average", ",", "full", "=", "True", ",", "val_range", "=", "val_range", ")", "\n", "print", "(", "\"sim\"", ",", "sim", ")", "\n", "mssim", ".", "append", "(", "sim", ")", "\n", "mcs", ".", "append", "(", "cs", ")", "\n", "\n", "img1", "=", "F", ".", "avg_pool2d", "(", "img1", ",", "(", "2", ",", "2", ")", ")", "\n", "img2", "=", "F", ".", "avg_pool2d", "(", "img2", ",", "(", "2", ",", "2", ")", ")", "\n", "\n", "", "mssim", "=", "torch", ".", "stack", "(", "mssim", ")", "\n", "mcs", "=", "torch", ".", "stack", "(", "mcs", ")", "\n", "\n", "# Normalize (to avoid NaNs during training unstable models, not compliant with original definition)", "\n", "if", "normalize", ":", "\n", "        ", "mssim", "=", "(", "mssim", "+", "1", ")", "/", "2", "\n", "mcs", "=", "(", "mcs", "+", "1", ")", "/", "2", "\n", "\n", "", "pow1", "=", "mcs", "**", "weights", "\n", "pow2", "=", "mssim", "**", "weights", "\n", "# From Matlab implementation https://ece.uwaterloo.ca/~z70wang/research/iwssim/", "\n", "output", "=", "torch", ".", "prod", "(", "pow1", "[", ":", "-", "1", "]", "*", "pow2", "[", "-", "1", "]", ")", "\n", "return", "output", "\n", "\n"]], "home.repos.pwc.inspect_result.ZJUGiveLab_UNet-Version.loss.bceLoss.BCE_loss": [[4, 9], ["torch.BCELoss", "nn.BCELoss.", "print", "bce_loss.data.cpu().numpy", "bce_loss.data.cpu"], "function", ["None"], ["def", "BCE_loss", "(", "pred", ",", "label", ")", ":", "\n", "    ", "bce_loss", "=", "nn", ".", "BCELoss", "(", "size_average", "=", "True", ")", "\n", "bce_out", "=", "bce_loss", "(", "pred", ",", "label", ")", "\n", "print", "(", "\"bce_loss:\"", ",", "bce_out", ".", "data", ".", "cpu", "(", ")", ".", "numpy", "(", ")", ")", "\n", "return", "bce_out", "\n", "", ""]]}